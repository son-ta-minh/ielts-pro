const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-BPzBMppB.js","assets/list-todo-DEvD4uXK.js","assets/file-clock-DCgnN_bb.js","assets/split-DryyiXzt.js","assets/keyboard-DoFjp6kM.js","assets/ReviewSession-BwtzX9Xt.js","assets/trophy-CRUW2O-M.js","assets/WordList-B8NQ7dEy.js","assets/WordTable-CHoVuvjV.js","assets/WordTable_UI-CBBxYSbW.js","assets/TagBrowser-Ws-IX7CV.js","assets/tag-w8R86B_o.js","assets/columns-2-9Z16jsib.js","assets/calendar-D7M-PCrl.js","assets/square-check-big-NsW8rF3i.js","assets/chevron-left-CzkttjmO.js","assets/ReadingUnitPage-D_8ofh4F.js","assets/minus-mbDkKR8t.js","assets/ResourceActions-CS90vDaR.js","assets/ViewMenu-B5ogEUUn.js","assets/filter-o1_4U50U.js","assets/UniversalCard-em1Y3rHk.js","assets/FileSelector-B73vmT-t.js","assets/server-S3zdXrr8.js","assets/music-JMzJrvdi.js","assets/SettingsView-7YEAhN9z.js","assets/AvatarSelectionModal-Bb52raYF.js","assets/palette-BdBQ5cmI.js","assets/Discover-f8wSngWN.js","assets/layout-grid-CfyhTjZn.js","assets/WritingStudioPage-CO-tVnSF.js","assets/chart-no-axes-column-increasing-37yFc43x.js","assets/IrregularVerbs-Cpx74j0P.js","assets/library-B6ToWs5r.js","assets/MimicPractice-aSl2KjRH.js","assets/ear-H_RXGXfu.js","assets/LessonLibraryV2-ZPzesHw2.js","assets/headphones-BLPIV3eX.js","assets/PlanningPage-CC9WF24J.js","assets/grip-vertical-hK5wwPyq.js","assets/SpeakingCardPage-NnWHldnB.js","assets/WordBookPage-BmQ_Jqut.js","assets/CourseList-CXg72ts2.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}})();function TE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var zp={exports:{}},Oc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tv;function N2(){if(tv)return Oc;tv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function s(a,o,l){var d=null;if(l!==void 0&&(d=""+l),o.key!==void 0&&(d=""+o.key),"key"in o){l={};for(var p in o)p!=="key"&&(l[p]=o[p])}else l=o;return o=l.ref,{$$typeof:n,type:a,key:d,ref:o!==void 0?o:null,props:l}}return Oc.Fragment=e,Oc.jsx=s,Oc.jsxs=s,Oc}var nv;function C2(){return nv||(nv=1,zp.exports=N2()),zp.exports}var u=C2(),Bp={exports:{}},nt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sv;function R2(){if(sv)return nt;sv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),S=Symbol.iterator;function N(A){return A===null||typeof A!="object"?null:(A=S&&A[S]||A["@@iterator"],typeof A=="function"?A:null)}var z={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,j={};function P(A,V,q){this.props=A,this.context=V,this.refs=j,this.updater=q||z}P.prototype.isReactComponent={},P.prototype.setState=function(A,V){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,V,"setState")},P.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function F(){}F.prototype=P.prototype;function G(A,V,q){this.props=A,this.context=V,this.refs=j,this.updater=q||z}var H=G.prototype=new F;H.constructor=G,D(H,P.prototype),H.isPureReactComponent=!0;var W=Array.isArray;function Q(){}var I={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function _(A,V,q){var X=q.ref;return{$$typeof:n,type:A,key:V,ref:X!==void 0?X:null,props:q}}function C(A,V){return _(A.type,V,A.props)}function R(A){return typeof A=="object"&&A!==null&&A.$$typeof===n}function L(A){var V={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(q){return V[q]})}var O=/\/+/g;function _e(A,V){return typeof A=="object"&&A!==null&&A.key!=null?L(""+A.key):V.toString(36)}function ye(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(Q,Q):(A.status="pending",A.then(function(V){A.status==="pending"&&(A.status="fulfilled",A.value=V)},function(V){A.status==="pending"&&(A.status="rejected",A.reason=V)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function B(A,V,q,X,de){var ce=typeof A;(ce==="undefined"||ce==="boolean")&&(A=null);var fe=!1;if(A===null)fe=!0;else switch(ce){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(A.$$typeof){case n:case e:fe=!0;break;case x:return fe=A._init,B(fe(A._payload),V,q,X,de)}}if(fe)return de=de(A),fe=X===""?"."+_e(A,0):X,W(de)?(q="",fe!=null&&(q=fe.replace(O,"$&/")+"/"),B(de,V,q,"",function(he){return he})):de!=null&&(R(de)&&(de=C(de,q+(de.key==null||A&&A.key===de.key?"":(""+de.key).replace(O,"$&/")+"/")+fe)),V.push(de)),1;fe=0;var ie=X===""?".":X+":";if(W(A))for(var Ae=0;Ae<A.length;Ae++)X=A[Ae],ce=ie+_e(X,Ae),fe+=B(X,V,q,ce,de);else if(Ae=N(A),typeof Ae=="function")for(A=Ae.call(A),Ae=0;!(X=A.next()).done;)X=X.value,ce=ie+_e(X,Ae++),fe+=B(X,V,q,ce,de);else if(ce==="object"){if(typeof A.then=="function")return B(ye(A),V,q,X,de);throw V=String(A),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return fe}function le(A,V,q){if(A==null)return A;var X=[],de=0;return B(A,X,"","",function(ce){return V.call(q,ce,de++)}),X}function se(A){if(A._status===-1){var V=A._result;V=V(),V.then(function(q){(A._status===0||A._status===-1)&&(A._status=1,A._result=q)},function(q){(A._status===0||A._status===-1)&&(A._status=2,A._result=q)}),A._status===-1&&(A._status=0,A._result=V)}if(A._status===1)return A._result.default;throw A._result}var Z=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)},Y={map:le,forEach:function(A,V,q){le(A,function(){V.apply(this,arguments)},q)},count:function(A){var V=0;return le(A,function(){V++}),V},toArray:function(A){return le(A,function(V){return V})||[]},only:function(A){if(!R(A))throw Error("React.Children.only expected to receive a single React element child.");return A}};return nt.Activity=v,nt.Children=Y,nt.Component=P,nt.Fragment=s,nt.Profiler=o,nt.PureComponent=G,nt.StrictMode=a,nt.Suspense=m,nt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,nt.__COMPILER_RUNTIME={__proto__:null,c:function(A){return I.H.useMemoCache(A)}},nt.cache=function(A){return function(){return A.apply(null,arguments)}},nt.cacheSignal=function(){return null},nt.cloneElement=function(A,V,q){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var X=D({},A.props),de=A.key;if(V!=null)for(ce in V.key!==void 0&&(de=""+V.key),V)!T.call(V,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&V.ref===void 0||(X[ce]=V[ce]);var ce=arguments.length-2;if(ce===1)X.children=q;else if(1<ce){for(var fe=Array(ce),ie=0;ie<ce;ie++)fe[ie]=arguments[ie+2];X.children=fe}return _(A.type,de,X)},nt.createContext=function(A){return A={$$typeof:d,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:l,_context:A},A},nt.createElement=function(A,V,q){var X,de={},ce=null;if(V!=null)for(X in V.key!==void 0&&(ce=""+V.key),V)T.call(V,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(de[X]=V[X]);var fe=arguments.length-2;if(fe===1)de.children=q;else if(1<fe){for(var ie=Array(fe),Ae=0;Ae<fe;Ae++)ie[Ae]=arguments[Ae+2];de.children=ie}if(A&&A.defaultProps)for(X in fe=A.defaultProps,fe)de[X]===void 0&&(de[X]=fe[X]);return _(A,ce,de)},nt.createRef=function(){return{current:null}},nt.forwardRef=function(A){return{$$typeof:p,render:A}},nt.isValidElement=R,nt.lazy=function(A){return{$$typeof:x,_payload:{_status:-1,_result:A},_init:se}},nt.memo=function(A,V){return{$$typeof:y,type:A,compare:V===void 0?null:V}},nt.startTransition=function(A){var V=I.T,q={};I.T=q;try{var X=A(),de=I.S;de!==null&&de(q,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(Q,Z)}catch(ce){Z(ce)}finally{V!==null&&q.types!==null&&(V.types=q.types),I.T=V}},nt.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},nt.use=function(A){return I.H.use(A)},nt.useActionState=function(A,V,q){return I.H.useActionState(A,V,q)},nt.useCallback=function(A,V){return I.H.useCallback(A,V)},nt.useContext=function(A){return I.H.useContext(A)},nt.useDebugValue=function(){},nt.useDeferredValue=function(A,V){return I.H.useDeferredValue(A,V)},nt.useEffect=function(A,V){return I.H.useEffect(A,V)},nt.useEffectEvent=function(A){return I.H.useEffectEvent(A)},nt.useId=function(){return I.H.useId()},nt.useImperativeHandle=function(A,V,q){return I.H.useImperativeHandle(A,V,q)},nt.useInsertionEffect=function(A,V){return I.H.useInsertionEffect(A,V)},nt.useLayoutEffect=function(A,V){return I.H.useLayoutEffect(A,V)},nt.useMemo=function(A,V){return I.H.useMemo(A,V)},nt.useOptimistic=function(A,V){return I.H.useOptimistic(A,V)},nt.useReducer=function(A,V,q){return I.H.useReducer(A,V,q)},nt.useRef=function(A){return I.H.useRef(A)},nt.useState=function(A){return I.H.useState(A)},nt.useSyncExternalStore=function(A,V,q){return I.H.useSyncExternalStore(A,V,q)},nt.useTransition=function(){return I.H.useTransition()},nt.version="19.2.4",nt}var rv;function Tg(){return rv||(rv=1,Bp.exports=R2()),Bp.exports}var M=Tg();const Fn=TE(M);var Fp={exports:{}},jc={},Hp={exports:{}},Gp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var av;function O2(){return av||(av=1,(function(n){function e(B,le){var se=B.length;B.push(le);e:for(;0<se;){var Z=se-1>>>1,Y=B[Z];if(0<o(Y,le))B[Z]=le,B[se]=Y,se=Z;else break e}}function s(B){return B.length===0?null:B[0]}function a(B){if(B.length===0)return null;var le=B[0],se=B.pop();if(se!==le){B[0]=se;e:for(var Z=0,Y=B.length,A=Y>>>1;Z<A;){var V=2*(Z+1)-1,q=B[V],X=V+1,de=B[X];if(0>o(q,se))X<Y&&0>o(de,q)?(B[Z]=de,B[X]=se,Z=X):(B[Z]=q,B[V]=se,Z=V);else if(X<Y&&0>o(de,se))B[Z]=de,B[X]=se,Z=X;else break e}}return le}function o(B,le){var se=B.sortIndex-le.sortIndex;return se!==0?se:B.id-le.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var m=[],y=[],x=1,v=null,S=3,N=!1,z=!1,D=!1,j=!1,P=typeof setTimeout=="function"?setTimeout:null,F=typeof clearTimeout=="function"?clearTimeout:null,G=typeof setImmediate<"u"?setImmediate:null;function H(B){for(var le=s(y);le!==null;){if(le.callback===null)a(y);else if(le.startTime<=B)a(y),le.sortIndex=le.expirationTime,e(m,le);else break;le=s(y)}}function W(B){if(D=!1,H(B),!z)if(s(m)!==null)z=!0,Q||(Q=!0,L());else{var le=s(y);le!==null&&ye(W,le.startTime-B)}}var Q=!1,I=-1,T=5,_=-1;function C(){return j?!0:!(n.unstable_now()-_<T)}function R(){if(j=!1,Q){var B=n.unstable_now();_=B;var le=!0;try{e:{z=!1,D&&(D=!1,F(I),I=-1),N=!0;var se=S;try{t:{for(H(B),v=s(m);v!==null&&!(v.expirationTime>B&&C());){var Z=v.callback;if(typeof Z=="function"){v.callback=null,S=v.priorityLevel;var Y=Z(v.expirationTime<=B);if(B=n.unstable_now(),typeof Y=="function"){v.callback=Y,H(B),le=!0;break t}v===s(m)&&a(m),H(B)}else a(m);v=s(m)}if(v!==null)le=!0;else{var A=s(y);A!==null&&ye(W,A.startTime-B),le=!1}}break e}finally{v=null,S=se,N=!1}le=void 0}}finally{le?L():Q=!1}}}var L;if(typeof G=="function")L=function(){G(R)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,_e=O.port2;O.port1.onmessage=R,L=function(){_e.postMessage(null)}}else L=function(){P(R,0)};function ye(B,le){I=P(function(){B(n.unstable_now())},le)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_next=function(B){switch(S){case 1:case 2:case 3:var le=3;break;default:le=S}var se=S;S=le;try{return B()}finally{S=se}},n.unstable_requestPaint=function(){j=!0},n.unstable_runWithPriority=function(B,le){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var se=S;S=B;try{return le()}finally{S=se}},n.unstable_scheduleCallback=function(B,le,se){var Z=n.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?Z+se:Z):se=Z,B){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=se+Y,B={id:x++,callback:le,priorityLevel:B,startTime:se,expirationTime:Y,sortIndex:-1},se>Z?(B.sortIndex=se,e(y,B),s(m)===null&&B===s(y)&&(D?(F(I),I=-1):D=!0,ye(W,se-Z))):(B.sortIndex=Y,e(m,B),z||N||(z=!0,Q||(Q=!0,L()))),B},n.unstable_shouldYield=C,n.unstable_wrapCallback=function(B){var le=S;return function(){var se=S;S=le;try{return B.apply(this,arguments)}finally{S=se}}}})(Gp)),Gp}var iv;function j2(){return iv||(iv=1,Hp.exports=O2()),Hp.exports}var qp={exports:{}},Jn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ov;function k2(){if(ov)return Jn;ov=1;var n=Tg();function e(m){var y="https://react.dev/errors/"+m;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+m+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var a={d:{f:s,r:function(){throw Error(e(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(m,y,x){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:v==null?null:""+v,children:m,containerInfo:y,implementation:x}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(m,y){if(m==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return Jn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Jn.createPortal=function(m,y){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return l(m,y,null,x)},Jn.flushSync=function(m){var y=d.T,x=a.p;try{if(d.T=null,a.p=2,m)return m()}finally{d.T=y,a.p=x,a.d.f()}},Jn.preconnect=function(m,y){typeof m=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,a.d.C(m,y))},Jn.prefetchDNS=function(m){typeof m=="string"&&a.d.D(m)},Jn.preinit=function(m,y){if(typeof m=="string"&&y&&typeof y.as=="string"){var x=y.as,v=p(x,y.crossOrigin),S=typeof y.integrity=="string"?y.integrity:void 0,N=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;x==="style"?a.d.S(m,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:v,integrity:S,fetchPriority:N}):x==="script"&&a.d.X(m,{crossOrigin:v,integrity:S,fetchPriority:N,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},Jn.preinitModule=function(m,y){if(typeof m=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var x=p(y.as,y.crossOrigin);a.d.M(m,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&a.d.M(m)},Jn.preload=function(m,y){if(typeof m=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var x=y.as,v=p(x,y.crossOrigin);a.d.L(m,x,{crossOrigin:v,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},Jn.preloadModule=function(m,y){if(typeof m=="string")if(y){var x=p(y.as,y.crossOrigin);a.d.m(m,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else a.d.m(m)},Jn.requestFormReset=function(m){a.d.r(m)},Jn.unstable_batchedUpdates=function(m,y){return m(y)},Jn.useFormState=function(m,y,x){return d.H.useFormState(m,y,x)},Jn.useFormStatus=function(){return d.H.useHostTransitionStatus()},Jn.version="19.2.4",Jn}var lv;function L2(){if(lv)return qp.exports;lv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qp.exports=k2(),qp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cv;function M2(){if(cv)return jc;cv=1;var n=j2(),e=Tg(),s=L2();function a(t){var r="https://react.dev/errors/"+t;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)r+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function l(t){var r=t,i=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,(r.flags&4098)!==0&&(i=r.return),t=r.return;while(t)}return r.tag===3?i:null}function d(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function p(t){if(t.tag===31){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function m(t){if(l(t)!==t)throw Error(a(188))}function y(t){var r=t.alternate;if(!r){if(r=l(t),r===null)throw Error(a(188));return r!==t?null:t}for(var i=t,c=r;;){var h=i.return;if(h===null)break;var g=h.alternate;if(g===null){if(c=h.return,c!==null){i=c;continue}break}if(h.child===g.child){for(g=h.child;g;){if(g===i)return m(h),t;if(g===c)return m(h),r;g=g.sibling}throw Error(a(188))}if(i.return!==c.return)i=h,c=g;else{for(var E=!1,k=h.child;k;){if(k===i){E=!0,i=h,c=g;break}if(k===c){E=!0,c=h,i=g;break}k=k.sibling}if(!E){for(k=g.child;k;){if(k===i){E=!0,i=g,c=h;break}if(k===c){E=!0,c=g,i=h;break}k=k.sibling}if(!E)throw Error(a(189))}}if(i.alternate!==c)throw Error(a(190))}if(i.tag!==3)throw Error(a(188));return i.stateNode.current===i?t:r}function x(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t;for(t=t.child;t!==null;){if(r=x(t),r!==null)return r;t=t.sibling}return null}var v=Object.assign,S=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),z=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),F=Symbol.for("react.consumer"),G=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),W=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),C=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function L(t){return t===null||typeof t!="object"?null:(t=R&&t[R]||t["@@iterator"],typeof t=="function"?t:null)}var O=Symbol.for("react.client.reference");function _e(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===O?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case D:return"Fragment";case P:return"Profiler";case j:return"StrictMode";case W:return"Suspense";case Q:return"SuspenseList";case _:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case z:return"Portal";case G:return t.displayName||"Context";case F:return(t._context.displayName||"Context")+".Consumer";case H:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case I:return r=t.displayName||null,r!==null?r:_e(t.type)||"Memo";case T:r=t._payload,t=t._init;try{return _e(t(r))}catch{}}return null}var ye=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se={pending:!1,data:null,method:null,action:null},Z=[],Y=-1;function A(t){return{current:t}}function V(t){0>Y||(t.current=Z[Y],Z[Y]=null,Y--)}function q(t,r){Y++,Z[Y]=t.current,t.current=r}var X=A(null),de=A(null),ce=A(null),fe=A(null);function ie(t,r){switch(q(ce,r),q(de,t),q(X,null),r.nodeType){case 9:case 11:t=(t=r.documentElement)&&(t=t.namespaceURI)?Sb(t):0;break;default:if(t=r.tagName,r=r.namespaceURI)r=Sb(r),t=Tb(r,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}V(X),q(X,t)}function Ae(){V(X),V(de),V(ce)}function he(t){t.memoizedState!==null&&q(fe,t);var r=X.current,i=Tb(r,t.type);r!==i&&(q(de,t),q(X,i))}function xe(t){de.current===t&&(V(X),V(de)),fe.current===t&&(V(fe),Ic._currentValue=se)}var je,pe;function Ie(t){if(je===void 0)try{throw Error()}catch(i){var r=i.stack.trim().match(/\n( *(at )?)/);je=r&&r[1]||"",pe=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+je+t+pe}var Le=!1;function Te(t,r){if(!t||Le)return"";Le=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(ue){var ae=ue}Reflect.construct(t,[],Ee)}else{try{Ee.call()}catch(ue){ae=ue}t.call(Ee.prototype)}}else{try{throw Error()}catch(ue){ae=ue}(Ee=t())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(ue){if(ue&&ae&&typeof ue.stack=="string")return[ue.stack,ae.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),E=g[0],k=g[1];if(E&&k){var $=E.split(`
`),ne=k.split(`
`);for(h=c=0;c<$.length&&!$[c].includes("DetermineComponentFrameRoot");)c++;for(;h<ne.length&&!ne[h].includes("DetermineComponentFrameRoot");)h++;if(c===$.length||h===ne.length)for(c=$.length-1,h=ne.length-1;1<=c&&0<=h&&$[c]!==ne[h];)h--;for(;1<=c&&0<=h;c--,h--)if($[c]!==ne[h]){if(c!==1||h!==1)do if(c--,h--,0>h||$[c]!==ne[h]){var ge=`
`+$[c].replace(" at new "," at ");return t.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",t.displayName)),ge}while(1<=c&&0<=h);break}}}finally{Le=!1,Error.prepareStackTrace=i}return(i=t?t.displayName||t.name:"")?Ie(i):""}function me(t,r){switch(t.tag){case 26:case 27:case 5:return Ie(t.type);case 16:return Ie("Lazy");case 13:return t.child!==r&&r!==null?Ie("Suspense Fallback"):Ie("Suspense");case 19:return Ie("SuspenseList");case 0:case 15:return Te(t.type,!1);case 11:return Te(t.type.render,!1);case 1:return Te(t.type,!0);case 31:return Ie("Activity");default:return""}}function et(t){try{var r="",i=null;do r+=me(t,i),i=t,t=t.return;while(t);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Xe=Object.prototype.hasOwnProperty,re=n.unstable_scheduleCallback,Fe=n.unstable_cancelCallback,rt=n.unstable_shouldYield,Tt=n.unstable_requestPaint,Ze=n.unstable_now,tt=n.unstable_getCurrentPriorityLevel,ut=n.unstable_ImmediatePriority,At=n.unstable_UserBlockingPriority,Ht=n.unstable_NormalPriority,fr=n.unstable_LowPriority,hr=n.unstable_IdlePriority,Cs=n.log,ys=n.unstable_setDisableYieldValue,pn=null,be=null;function De(t){if(typeof Cs=="function"&&ys(t),be&&typeof be.setStrictMode=="function")try{be.setStrictMode(pn,t)}catch{}}var Ne=Math.clz32?Math.clz32:Ge,bt=Math.log,it=Math.LN2;function Ge(t){return t>>>=0,t===0?32:31-(bt(t)/it|0)|0}var It=256,dt=262144,Je=4194304;function Qt(t){var r=t&42;if(r!==0)return r;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function gt(t,r,i){var c=t.pendingLanes;if(c===0)return 0;var h=0,g=t.suspendedLanes,E=t.pingedLanes;t=t.warmLanes;var k=c&134217727;return k!==0?(c=k&~g,c!==0?h=Qt(c):(E&=k,E!==0?h=Qt(E):i||(i=k&~t,i!==0&&(h=Qt(i))))):(k=c&~g,k!==0?h=Qt(k):E!==0?h=Qt(E):i||(i=c&~t,i!==0&&(h=Qt(i)))),h===0?0:r!==0&&r!==h&&(r&g)===0&&(g=h&-h,i=r&-r,g>=i||g===32&&(i&4194048)!==0)?r:h}function rn(t,r){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&r)===0}function xs(t,r){switch(t){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bs(){var t=Je;return Je<<=1,(Je&62914560)===0&&(Je=4194304),t}function Wt(t){for(var r=[],i=0;31>i;i++)r.push(t);return r}function Hn(t,r){t.pendingLanes|=r,r!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function ta(t,r,i,c,h,g){var E=t.pendingLanes;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=i,t.entangledLanes&=i,t.errorRecoveryDisabledLanes&=i,t.shellSuspendCounter=0;var k=t.entanglements,$=t.expirationTimes,ne=t.hiddenUpdates;for(i=E&~i;0<i;){var ge=31-Ne(i),Ee=1<<ge;k[ge]=0,$[ge]=-1;var ae=ne[ge];if(ae!==null)for(ne[ge]=null,ge=0;ge<ae.length;ge++){var ue=ae[ge];ue!==null&&(ue.lane&=-536870913)}i&=~Ee}c!==0&&Hs(t,c,0),g!==0&&h===0&&t.tag!==0&&(t.suspendedLanes|=g&~(E&~r))}function Hs(t,r,i){t.pendingLanes|=r,t.suspendedLanes&=~r;var c=31-Ne(r);t.entangledLanes|=r,t.entanglements[c]=t.entanglements[c]|1073741824|i&261930}function na(t,r){var i=t.entangledLanes|=r;for(t=t.entanglements;i;){var c=31-Ne(i),h=1<<c;h&r|t[c]&r&&(t[c]|=r),i&=~h}}function Lr(t,r){var i=r&-r;return i=(i&42)!==0?1:sa(i),(i&(t.suspendedLanes|r))!==0?0:i}function sa(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function pr(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function Rs(){var t=le.p;return t!==0?t:(t=window.event,t===void 0?32:Qb(t.type))}function mn(t,r){var i=le.p;try{return le.p=t,r()}finally{le.p=i}}var is=Math.random().toString(36).slice(2),an="__reactFiber$"+is,_n="__reactProps$"+is,Gs="__reactContainer$"+is,ra="__reactEvents$"+is,Fl="__reactListeners$"+is,Ti="__reactHandles$"+is,Ai="__reactResources$"+is,Os="__reactMarker$"+is;function aa(t){delete t[an],delete t[_n],delete t[ra],delete t[Fl],delete t[Ti]}function qs(t){var r=t[an];if(r)return r;for(var i=t.parentNode;i;){if(r=i[Gs]||i[an]){if(i=r.alternate,r.child!==null||i!==null&&i.child!==null)for(t=jb(t);t!==null;){if(i=t[an])return i;t=jb(t)}return r}t=i,i=t.parentNode}return null}function vs(t){if(t=t[an]||t[Gs]){var r=t.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return t}return null}function os(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t.stateNode;throw Error(a(33))}function $s(t){var r=t[Ai];return r||(r=t[Ai]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function on(t){t[Os]=!0}var Ii=new Set,Ni={};function Ys(t,r){Qs(t,r),Qs(t+"Capture",r)}function Qs(t,r){for(Ni[t]=r,t=0;t<r.length;t++)Ii.add(r[t])}var Ci=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ri={},Oi={};function ji(t){return Xe.call(Oi,t)?!0:Xe.call(Ri,t)?!1:Ci.test(t)?Oi[t]=!0:(Ri[t]=!0,!1)}function Ma(t,r,i){if(ji(r))if(i===null)t.removeAttribute(r);else{switch(typeof i){case"undefined":case"function":case"symbol":t.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(r);return}}t.setAttribute(r,""+i)}}function ls(t,r,i){if(i===null)t.removeAttribute(r);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttribute(r,""+i)}}function ln(t,r,i,c){if(c===null)t.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(i);return}t.setAttributeNS(r,i,""+c)}}function En(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Mr(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function ki(t,r,i){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,r);if(!t.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var h=c.get,g=c.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return h.call(this)},set:function(E){i=""+E,g.call(this,E)}}),Object.defineProperty(t,r,{enumerable:c.enumerable}),{getValue:function(){return i},setValue:function(E){i=""+E},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function Rt(t){if(!t._valueTracker){var r=Mr(t)?"checked":"value";t._valueTracker=ki(t,r,""+t[r])}}function ia(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var i=r.getValue(),c="";return t&&(c=Mr(t)?t.checked?"true":"false":t.value),t=c,t!==i?(r.setValue(t),!0):!1}function Ws(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Ks=/[\n"\\]/g;function Xn(t){return t.replace(Ks,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function oa(t,r,i,c,h,g,E,k){t.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?t.type=E:t.removeAttribute("type"),r!=null?E==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+En(r)):t.value!==""+En(r)&&(t.value=""+En(r)):E!=="submit"&&E!=="reset"||t.removeAttribute("value"),r!=null?No(t,E,En(r)):i!=null?No(t,E,En(i)):c!=null&&t.removeAttribute("value"),h==null&&g!=null&&(t.defaultChecked=!!g),h!=null&&(t.checked=h&&typeof h!="function"&&typeof h!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?t.name=""+En(k):t.removeAttribute("name")}function Li(t,r,i,c,h,g,E,k){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(t.type=g),r!=null||i!=null){if(!(g!=="submit"&&g!=="reset"||r!=null)){Rt(t);return}i=i!=null?""+En(i):"",r=r!=null?""+En(r):i,k||r===t.value||(t.value=r),t.defaultValue=r}c=c??h,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=k?t.checked:!!c,t.defaultChecked=!!c,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(t.name=E),Rt(t)}function No(t,r,i){r==="number"&&Ws(t.ownerDocument)===t||t.defaultValue===""+i||(t.defaultValue=""+i)}function la(t,r,i,c){if(t=t.options,r){r={};for(var h=0;h<i.length;h++)r["$"+i[h]]=!0;for(i=0;i<t.length;i++)h=r.hasOwnProperty("$"+t[i].value),t[i].selected!==h&&(t[i].selected=h),h&&c&&(t[i].defaultSelected=!0)}else{for(i=""+En(i),r=null,h=0;h<t.length;h++){if(t[h].value===i){t[h].selected=!0,c&&(t[h].defaultSelected=!0);return}r!==null||t[h].disabled||(r=t[h])}r!==null&&(r.selected=!0)}}function Hl(t,r,i){if(r!=null&&(r=""+En(r),r!==t.value&&(t.value=r),i==null)){t.defaultValue!==r&&(t.defaultValue=r);return}t.defaultValue=i!=null?""+En(i):""}function ca(t,r,i,c){if(r==null){if(c!=null){if(i!=null)throw Error(a(92));if(ye(c)){if(1<c.length)throw Error(a(93));c=c[0]}i=c}i==null&&(i=""),r=i}i=En(r),t.defaultValue=i,c=t.textContent,c===i&&c!==""&&c!==null&&(t.value=c),Rt(t)}function cs(t,r){if(r){var i=t.firstChild;if(i&&i===t.lastChild&&i.nodeType===3){i.nodeValue=r;return}}t.textContent=r}var Oe=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ke(t,r,i){var c=r.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?c?t.setProperty(r,""):r==="float"?t.cssFloat="":t[r]="":c?t.setProperty(r,i):typeof i!="number"||i===0||Oe.has(r)?r==="float"?t.cssFloat=i:t[r]=(""+i).trim():t[r]=i+"px"}function Be(t,r,i){if(r!=null&&typeof r!="object")throw Error(a(62));if(t=t.style,i!=null){for(var c in i)!i.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var h in r)c=r[h],r.hasOwnProperty(h)&&i[h]!==c&&ke(t,h,c)}else for(var g in r)r.hasOwnProperty(g)&&ke(t,g,r[g])}function Ve(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ye=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$e=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qe(t){return $e.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function kt(){}var On=null;function Gt(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var cn=null,Un=null;function Mi(t){var r=vs(t);if(r&&(t=r.stateNode)){var i=t[_n]||null;e:switch(t=r.stateNode,r.type){case"input":if(oa(t,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),r=i.name,i.type==="radio"&&r!=null){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+Xn(""+r)+'"][type="radio"]'),r=0;r<i.length;r++){var c=i[r];if(c!==t&&c.form===t.form){var h=c[_n]||null;if(!h)throw Error(a(90));oa(c,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(r=0;r<i.length;r++)c=i[r],c.form===t.form&&ia(c)}break e;case"textarea":Hl(t,i.value,i.defaultValue);break e;case"select":r=i.value,r!=null&&la(t,!!i.multiple,r,!1)}}}var Co=!1;function Da(t,r,i){if(Co)return t(r,i);Co=!0;try{var c=t(r);return c}finally{if(Co=!1,(cn!==null||Un!==null)&&(md(),cn&&(r=cn,t=Un,Un=cn=null,Mi(r),t)))for(r=0;r<t.length;r++)Mi(t[r])}}function mr(t,r){var i=t.stateNode;if(i===null)return null;var c=i[_n]||null;if(c===null)return null;i=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(i&&typeof i!="function")throw Error(a(231,r,typeof i));return i}var Zs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Di=!1;if(Zs)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){Di=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch{Di=!1}var Dr=null,Gl=null,Ui=null;function ql(){if(Ui)return Ui;var t,r=Gl,i=r.length,c,h="value"in Dr?Dr.value:Dr.textContent,g=h.length;for(t=0;t<i&&r[t]===h[t];t++);var E=i-t;for(c=1;c<=E&&r[i-c]===h[g-c];c++);return Ui=h.slice(t,1<c?1-c:void 0)}function Pi(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function ua(){return!0}function gr(){return!1}function Gn(t){function r(i,c,h,g,E){this._reactName=i,this._targetInst=h,this.type=c,this.nativeEvent=g,this.target=E,this.currentTarget=null;for(var k in t)t.hasOwnProperty(k)&&(i=t[k],this[k]=i?i(g):g[k]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?ua:gr,this.isPropagationStopped=gr,this}return v(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=ua)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=ua)},persist:function(){},isPersistent:ua}),r}var da={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ur=Gn(da),Ua=v({},da,{view:0,detail:0}),$l=Gn(Ua),Pa,Ro,Pr,Oo=v({},Ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Va,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Pr&&(Pr&&t.type==="mousemove"?(Pa=t.screenX-Pr.screenX,Ro=t.screenY-Pr.screenY):Ro=Pa=0,Pr=t),Pa)},movementY:function(t){return"movementY"in t?t.movementY:Ro}}),Yl=Gn(Oo),Vi=v({},Oo,{dataTransfer:0}),wu=Gn(Vi),Su=v({},Ua,{relatedTarget:0}),zi=Gn(Su),Ql=v({},da,{animationName:0,elapsedTime:0,pseudoElement:0}),Tu=Gn(Ql),jo=v({},da,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Au=Gn(jo),Iu=v({},da,{data:0}),Vr=Gn(Iu),Nu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ru={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ou(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=Ru[t])?!!r[t]:!1}function Va(){return Ou}var us=v({},Ua,{key:function(t){if(t.key){var r=Nu[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=Pi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Cu[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Va,charCode:function(t){return t.type==="keypress"?Pi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Pi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ju=Gn(us),ku=v({},Oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fa=Gn(ku),f=v({},Ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Va}),b=Gn(f),w=v({},da,{propertyName:0,elapsedTime:0,pseudoElement:0}),U=Gn(w),ee=v({},Oo,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),oe=Gn(ee),Ce=v({},da,{newState:0,oldState:0}),ot=Gn(Ce),gn=[9,13,27,32],Ot=Zs&&"CompositionEvent"in window,Kt=null;Zs&&"documentMode"in document&&(Kt=document.documentMode);var Xs=Zs&&"TextEvent"in window&&!Kt,zr=Zs&&(!Ot||Kt&&8<Kt&&11>=Kt),yr=" ",xr=!1;function Bi(t,r){switch(t){case"keyup":return gn.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ko(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Lo=!1;function XT(t,r){switch(t){case"compositionend":return ko(r);case"keypress":return r.which!==32?null:(xr=!0,yr);case"textInput":return t=r.data,t===yr&&xr?null:t;default:return null}}function JT(t,r){if(Lo)return t==="compositionend"||!Ot&&Bi(t,r)?(t=ql(),Ui=Gl=Dr=null,Lo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return zr&&r.locale!=="ko"?null:r.data;default:return null}}var eA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function M0(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!eA[t.type]:r==="textarea"}function D0(t,r,i,c){cn?Un?Un.push(c):Un=[c]:cn=c,r=Ed(r,"onChange"),0<r.length&&(i=new Ur("onChange","change",null,i,c),t.push({event:i,listeners:r}))}var Wl=null,Kl=null;function tA(t){xb(t,0)}function Lu(t){var r=os(t);if(ia(r))return t}function U0(t,r){if(t==="change")return r}var P0=!1;if(Zs){var Yf;if(Zs){var Qf="oninput"in document;if(!Qf){var V0=document.createElement("div");V0.setAttribute("oninput","return;"),Qf=typeof V0.oninput=="function"}Yf=Qf}else Yf=!1;P0=Yf&&(!document.documentMode||9<document.documentMode)}function z0(){Wl&&(Wl.detachEvent("onpropertychange",B0),Kl=Wl=null)}function B0(t){if(t.propertyName==="value"&&Lu(Kl)){var r=[];D0(r,Kl,t,Gt(t)),Da(tA,r)}}function nA(t,r,i){t==="focusin"?(z0(),Wl=r,Kl=i,Wl.attachEvent("onpropertychange",B0)):t==="focusout"&&z0()}function sA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Lu(Kl)}function rA(t,r){if(t==="click")return Lu(r)}function aA(t,r){if(t==="input"||t==="change")return Lu(r)}function iA(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var js=typeof Object.is=="function"?Object.is:iA;function Zl(t,r){if(js(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var i=Object.keys(t),c=Object.keys(r);if(i.length!==c.length)return!1;for(c=0;c<i.length;c++){var h=i[c];if(!Xe.call(r,h)||!js(t[h],r[h]))return!1}return!0}function F0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function H0(t,r){var i=F0(t);t=0;for(var c;i;){if(i.nodeType===3){if(c=t+i.textContent.length,t<=r&&c>=r)return{node:i,offset:r-t};t=c}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=F0(i)}}function G0(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?G0(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function q0(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var r=Ws(t.document);r instanceof t.HTMLIFrameElement;){try{var i=typeof r.contentWindow.location.href=="string"}catch{i=!1}if(i)t=r.contentWindow;else break;r=Ws(t.document)}return r}function Wf(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}var oA=Zs&&"documentMode"in document&&11>=document.documentMode,Mo=null,Kf=null,Xl=null,Zf=!1;function $0(t,r,i){var c=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Zf||Mo==null||Mo!==Ws(c)||(c=Mo,"selectionStart"in c&&Wf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Xl&&Zl(Xl,c)||(Xl=c,c=Ed(Kf,"onSelect"),0<c.length&&(r=new Ur("onSelect","select",null,r,i),t.push({event:r,listeners:c}),r.target=Mo)))}function Fi(t,r){var i={};return i[t.toLowerCase()]=r.toLowerCase(),i["Webkit"+t]="webkit"+r,i["Moz"+t]="moz"+r,i}var Do={animationend:Fi("Animation","AnimationEnd"),animationiteration:Fi("Animation","AnimationIteration"),animationstart:Fi("Animation","AnimationStart"),transitionrun:Fi("Transition","TransitionRun"),transitionstart:Fi("Transition","TransitionStart"),transitioncancel:Fi("Transition","TransitionCancel"),transitionend:Fi("Transition","TransitionEnd")},Xf={},Y0={};Zs&&(Y0=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function Hi(t){if(Xf[t])return Xf[t];if(!Do[t])return t;var r=Do[t],i;for(i in r)if(r.hasOwnProperty(i)&&i in Y0)return Xf[t]=r[i];return t}var Q0=Hi("animationend"),W0=Hi("animationiteration"),K0=Hi("animationstart"),lA=Hi("transitionrun"),cA=Hi("transitionstart"),uA=Hi("transitioncancel"),Z0=Hi("transitionend"),X0=new Map,Jf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Jf.push("scrollEnd");function br(t,r){X0.set(t,r),Ys(r,[t])}var Mu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},Js=[],Uo=0,eh=0;function Du(){for(var t=Uo,r=eh=Uo=0;r<t;){var i=Js[r];Js[r++]=null;var c=Js[r];Js[r++]=null;var h=Js[r];Js[r++]=null;var g=Js[r];if(Js[r++]=null,c!==null&&h!==null){var E=c.pending;E===null?h.next=h:(h.next=E.next,E.next=h),c.pending=h}g!==0&&J0(i,h,g)}}function Uu(t,r,i,c){Js[Uo++]=t,Js[Uo++]=r,Js[Uo++]=i,Js[Uo++]=c,eh|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function th(t,r,i,c){return Uu(t,r,i,c),Pu(t)}function Gi(t,r){return Uu(t,null,null,r),Pu(t)}function J0(t,r,i){t.lanes|=i;var c=t.alternate;c!==null&&(c.lanes|=i);for(var h=!1,g=t.return;g!==null;)g.childLanes|=i,c=g.alternate,c!==null&&(c.childLanes|=i),g.tag===22&&(t=g.stateNode,t===null||t._visibility&1||(h=!0)),t=g,g=g.return;return t.tag===3?(g=t.stateNode,h&&r!==null&&(h=31-Ne(i),t=g.hiddenUpdates,c=t[h],c===null?t[h]=[r]:c.push(r),r.lane=i|536870912),g):null}function Pu(t){if(50<vc)throw vc=0,up=null,Error(a(185));for(var r=t.return;r!==null;)t=r,r=t.return;return t.tag===3?t.stateNode:null}var Po={};function dA(t,r,i,c){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ks(t,r,i,c){return new dA(t,r,i,c)}function nh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ha(t,r){var i=t.alternate;return i===null?(i=ks(t.tag,r,t.key,t.mode),i.elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=r,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=t.flags&65011712,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,r=t.dependencies,i.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i.refCleanup=t.refCleanup,i}function ey(t,r){t.flags&=65011714;var i=t.alternate;return i===null?(t.childLanes=0,t.lanes=r,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,t.type=i.type,r=i.dependencies,t.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t}function Vu(t,r,i,c,h,g){var E=0;if(c=t,typeof t=="function")nh(t)&&(E=1);else if(typeof t=="string")E=g2(t,i,X.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case _:return t=ks(31,i,r,h),t.elementType=_,t.lanes=g,t;case D:return qi(i.children,h,g,r);case j:E=8,h|=24;break;case P:return t=ks(12,i,r,h|2),t.elementType=P,t.lanes=g,t;case W:return t=ks(13,i,r,h),t.elementType=W,t.lanes=g,t;case Q:return t=ks(19,i,r,h),t.elementType=Q,t.lanes=g,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case G:E=10;break e;case F:E=9;break e;case H:E=11;break e;case I:E=14;break e;case T:E=16,c=null;break e}E=29,i=Error(a(130,t===null?"null":typeof t,"")),c=null}return r=ks(E,i,r,h),r.elementType=t,r.type=c,r.lanes=g,r}function qi(t,r,i,c){return t=ks(7,t,c,r),t.lanes=i,t}function sh(t,r,i){return t=ks(6,t,null,r),t.lanes=i,t}function ty(t){var r=ks(18,null,null,0);return r.stateNode=t,r}function rh(t,r,i){return r=ks(4,t.children!==null?t.children:[],t.key,r),r.lanes=i,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}var ny=new WeakMap;function er(t,r){if(typeof t=="object"&&t!==null){var i=ny.get(t);return i!==void 0?i:(r={value:t,source:r,stack:et(r)},ny.set(t,r),r)}return{value:t,source:r,stack:et(r)}}var Vo=[],zo=0,zu=null,Jl=0,tr=[],nr=0,za=null,Br=1,Fr="";function pa(t,r){Vo[zo++]=Jl,Vo[zo++]=zu,zu=t,Jl=r}function sy(t,r,i){tr[nr++]=Br,tr[nr++]=Fr,tr[nr++]=za,za=t;var c=Br;t=Fr;var h=32-Ne(c)-1;c&=~(1<<h),i+=1;var g=32-Ne(r)+h;if(30<g){var E=h-h%5;g=(c&(1<<E)-1).toString(32),c>>=E,h-=E,Br=1<<32-Ne(r)+h|i<<h|c,Fr=g+t}else Br=1<<g|i<<h|c,Fr=t}function ah(t){t.return!==null&&(pa(t,1),sy(t,1,0))}function ih(t){for(;t===zu;)zu=Vo[--zo],Vo[zo]=null,Jl=Vo[--zo],Vo[zo]=null;for(;t===za;)za=tr[--nr],tr[nr]=null,Fr=tr[--nr],tr[nr]=null,Br=tr[--nr],tr[nr]=null}function ry(t,r){tr[nr++]=Br,tr[nr++]=Fr,tr[nr++]=za,Br=r.id,Fr=r.overflow,za=t}var qn=null,qt=null,yt=!1,Ba=null,sr=!1,oh=Error(a(519));function Fa(t){var r=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw ec(er(r,t)),oh}function ay(t){var r=t.stateNode,i=t.type,c=t.memoizedProps;switch(r[an]=t,r[_n]=c,i){case"dialog":ht("cancel",r),ht("close",r);break;case"iframe":case"object":case"embed":ht("load",r);break;case"video":case"audio":for(i=0;i<Ec.length;i++)ht(Ec[i],r);break;case"source":ht("error",r);break;case"img":case"image":case"link":ht("error",r),ht("load",r);break;case"details":ht("toggle",r);break;case"input":ht("invalid",r),Li(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":ht("invalid",r);break;case"textarea":ht("invalid",r),ca(r,c.value,c.defaultValue,c.children)}i=c.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||r.textContent===""+i||c.suppressHydrationWarning===!0||Eb(r.textContent,i)?(c.popover!=null&&(ht("beforetoggle",r),ht("toggle",r)),c.onScroll!=null&&ht("scroll",r),c.onScrollEnd!=null&&ht("scrollend",r),c.onClick!=null&&(r.onclick=kt),r=!0):r=!1,r||Fa(t,!0)}function iy(t){for(qn=t.return;qn;)switch(qn.tag){case 5:case 31:case 13:sr=!1;return;case 27:case 3:sr=!0;return;default:qn=qn.return}}function Bo(t){if(t!==qn)return!1;if(!yt)return iy(t),yt=!0,!1;var r=t.tag,i;if((i=r!==3&&r!==27)&&((i=r===5)&&(i=t.type,i=!(i!=="form"&&i!=="button")||Tp(t.type,t.memoizedProps)),i=!i),i&&qt&&Fa(t),iy(t),r===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(a(317));qt=Ob(t)}else if(r===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(a(317));qt=Ob(t)}else r===27?(r=qt,ni(t.type)?(t=Rp,Rp=null,qt=t):qt=r):qt=qn?ar(t.stateNode.nextSibling):null;return!0}function $i(){qt=qn=null,yt=!1}function lh(){var t=Ba;return t!==null&&(Ss===null?Ss=t:Ss.push.apply(Ss,t),Ba=null),t}function ec(t){Ba===null?Ba=[t]:Ba.push(t)}var ch=A(null),Yi=null,ma=null;function Ha(t,r,i){q(ch,r._currentValue),r._currentValue=i}function ga(t){t._currentValue=ch.current,V(ch)}function uh(t,r,i){for(;t!==null;){var c=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),t===i)break;t=t.return}}function dh(t,r,i,c){var h=t.child;for(h!==null&&(h.return=t);h!==null;){var g=h.dependencies;if(g!==null){var E=h.child;g=g.firstContext;e:for(;g!==null;){var k=g;g=h;for(var $=0;$<r.length;$++)if(k.context===r[$]){g.lanes|=i,k=g.alternate,k!==null&&(k.lanes|=i),uh(g.return,i,t),c||(E=null);break e}g=k.next}}else if(h.tag===18){if(E=h.return,E===null)throw Error(a(341));E.lanes|=i,g=E.alternate,g!==null&&(g.lanes|=i),uh(E,i,t),E=null}else E=h.child;if(E!==null)E.return=h;else for(E=h;E!==null;){if(E===t){E=null;break}if(h=E.sibling,h!==null){h.return=E.return,E=h;break}E=E.return}h=E}}function Fo(t,r,i,c){t=null;for(var h=r,g=!1;h!==null;){if(!g){if((h.flags&524288)!==0)g=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var E=h.alternate;if(E===null)throw Error(a(387));if(E=E.memoizedProps,E!==null){var k=h.type;js(h.pendingProps.value,E.value)||(t!==null?t.push(k):t=[k])}}else if(h===fe.current){if(E=h.alternate,E===null)throw Error(a(387));E.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(t!==null?t.push(Ic):t=[Ic])}h=h.return}t!==null&&dh(r,t,i,c),r.flags|=262144}function Bu(t){for(t=t.firstContext;t!==null;){if(!js(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Qi(t){Yi=t,ma=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function $n(t){return oy(Yi,t)}function Fu(t,r){return Yi===null&&Qi(t),oy(t,r)}function oy(t,r){var i=r._currentValue;if(r={context:r,memoizedValue:i,next:null},ma===null){if(t===null)throw Error(a(308));ma=r,t.dependencies={lanes:0,firstContext:r},t.flags|=524288}else ma=ma.next=r;return i}var fA=typeof AbortController<"u"?AbortController:function(){var t=[],r=this.signal={aborted:!1,addEventListener:function(i,c){t.push(c)}};this.abort=function(){r.aborted=!0,t.forEach(function(i){return i()})}},hA=n.unstable_scheduleCallback,pA=n.unstable_NormalPriority,wn={$$typeof:G,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function fh(){return{controller:new fA,data:new Map,refCount:0}}function tc(t){t.refCount--,t.refCount===0&&hA(pA,function(){t.controller.abort()})}var nc=null,hh=0,Ho=0,Go=null;function mA(t,r){if(nc===null){var i=nc=[];hh=0,Ho=gp(),Go={status:"pending",value:void 0,then:function(c){i.push(c)}}}return hh++,r.then(ly,ly),r}function ly(){if(--hh===0&&nc!==null){Go!==null&&(Go.status="fulfilled");var t=nc;nc=null,Ho=0,Go=null;for(var r=0;r<t.length;r++)(0,t[r])()}}function gA(t,r){var i=[],c={status:"pending",value:null,reason:null,then:function(h){i.push(h)}};return t.then(function(){c.status="fulfilled",c.value=r;for(var h=0;h<i.length;h++)(0,i[h])(r)},function(h){for(c.status="rejected",c.reason=h,h=0;h<i.length;h++)(0,i[h])(void 0)}),c}var cy=B.S;B.S=function(t,r){$x=Ze(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&mA(t,r),cy!==null&&cy(t,r)};var Wi=A(null);function ph(){var t=Wi.current;return t!==null?t:Bt.pooledCache}function Hu(t,r){r===null?q(Wi,Wi.current):q(Wi,r.pool)}function uy(){var t=ph();return t===null?null:{parent:wn._currentValue,pool:t}}var qo=Error(a(460)),mh=Error(a(474)),Gu=Error(a(542)),qu={then:function(){}};function dy(t){return t=t.status,t==="fulfilled"||t==="rejected"}function fy(t,r,i){switch(i=t[i],i===void 0?t.push(r):i!==r&&(r.then(kt,kt),r=i),r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,py(t),t;default:if(typeof r.status=="string")r.then(kt,kt);else{if(t=Bt,t!==null&&100<t.shellSuspendCounter)throw Error(a(482));t=r,t.status="pending",t.then(function(c){if(r.status==="pending"){var h=r;h.status="fulfilled",h.value=c}},function(c){if(r.status==="pending"){var h=r;h.status="rejected",h.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,py(t),t}throw Zi=r,qo}}function Ki(t){try{var r=t._init;return r(t._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(Zi=i,qo):i}}var Zi=null;function hy(){if(Zi===null)throw Error(a(459));var t=Zi;return Zi=null,t}function py(t){if(t===qo||t===Gu)throw Error(a(483))}var $o=null,sc=0;function $u(t){var r=sc;return sc+=1,$o===null&&($o=[]),fy($o,t,r)}function rc(t,r){r=r.props.ref,t.ref=r!==void 0?r:null}function Yu(t,r){throw r.$$typeof===S?Error(a(525)):(t=Object.prototype.toString.call(r),Error(a(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t)))}function my(t){function r(J,K){if(t){var te=J.deletions;te===null?(J.deletions=[K],J.flags|=16):te.push(K)}}function i(J,K){if(!t)return null;for(;K!==null;)r(J,K),K=K.sibling;return null}function c(J){for(var K=new Map;J!==null;)J.key!==null?K.set(J.key,J):K.set(J.index,J),J=J.sibling;return K}function h(J,K){return J=ha(J,K),J.index=0,J.sibling=null,J}function g(J,K,te){return J.index=te,t?(te=J.alternate,te!==null?(te=te.index,te<K?(J.flags|=67108866,K):te):(J.flags|=67108866,K)):(J.flags|=1048576,K)}function E(J){return t&&J.alternate===null&&(J.flags|=67108866),J}function k(J,K,te,ve){return K===null||K.tag!==6?(K=sh(te,J.mode,ve),K.return=J,K):(K=h(K,te),K.return=J,K)}function $(J,K,te,ve){var qe=te.type;return qe===D?ge(J,K,te.props.children,ve,te.key):K!==null&&(K.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===T&&Ki(qe)===K.type)?(K=h(K,te.props),rc(K,te),K.return=J,K):(K=Vu(te.type,te.key,te.props,null,J.mode,ve),rc(K,te),K.return=J,K)}function ne(J,K,te,ve){return K===null||K.tag!==4||K.stateNode.containerInfo!==te.containerInfo||K.stateNode.implementation!==te.implementation?(K=rh(te,J.mode,ve),K.return=J,K):(K=h(K,te.children||[]),K.return=J,K)}function ge(J,K,te,ve,qe){return K===null||K.tag!==7?(K=qi(te,J.mode,ve,qe),K.return=J,K):(K=h(K,te),K.return=J,K)}function Ee(J,K,te){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return K=sh(""+K,J.mode,te),K.return=J,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case N:return te=Vu(K.type,K.key,K.props,null,J.mode,te),rc(te,K),te.return=J,te;case z:return K=rh(K,J.mode,te),K.return=J,K;case T:return K=Ki(K),Ee(J,K,te)}if(ye(K)||L(K))return K=qi(K,J.mode,te,null),K.return=J,K;if(typeof K.then=="function")return Ee(J,$u(K),te);if(K.$$typeof===G)return Ee(J,Fu(J,K),te);Yu(J,K)}return null}function ae(J,K,te,ve){var qe=K!==null?K.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return qe!==null?null:k(J,K,""+te,ve);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case N:return te.key===qe?$(J,K,te,ve):null;case z:return te.key===qe?ne(J,K,te,ve):null;case T:return te=Ki(te),ae(J,K,te,ve)}if(ye(te)||L(te))return qe!==null?null:ge(J,K,te,ve,null);if(typeof te.then=="function")return ae(J,K,$u(te),ve);if(te.$$typeof===G)return ae(J,K,Fu(J,te),ve);Yu(J,te)}return null}function ue(J,K,te,ve,qe){if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return J=J.get(te)||null,k(K,J,""+ve,qe);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case N:return J=J.get(ve.key===null?te:ve.key)||null,$(K,J,ve,qe);case z:return J=J.get(ve.key===null?te:ve.key)||null,ne(K,J,ve,qe);case T:return ve=Ki(ve),ue(J,K,te,ve,qe)}if(ye(ve)||L(ve))return J=J.get(te)||null,ge(K,J,ve,qe,null);if(typeof ve.then=="function")return ue(J,K,te,$u(ve),qe);if(ve.$$typeof===G)return ue(J,K,te,Fu(K,ve),qe);Yu(K,ve)}return null}function Ue(J,K,te,ve){for(var qe=null,Nt=null,ze=K,ct=K=0,mt=null;ze!==null&&ct<te.length;ct++){ze.index>ct?(mt=ze,ze=null):mt=ze.sibling;var Ct=ae(J,ze,te[ct],ve);if(Ct===null){ze===null&&(ze=mt);break}t&&ze&&Ct.alternate===null&&r(J,ze),K=g(Ct,K,ct),Nt===null?qe=Ct:Nt.sibling=Ct,Nt=Ct,ze=mt}if(ct===te.length)return i(J,ze),yt&&pa(J,ct),qe;if(ze===null){for(;ct<te.length;ct++)ze=Ee(J,te[ct],ve),ze!==null&&(K=g(ze,K,ct),Nt===null?qe=ze:Nt.sibling=ze,Nt=ze);return yt&&pa(J,ct),qe}for(ze=c(ze);ct<te.length;ct++)mt=ue(ze,J,ct,te[ct],ve),mt!==null&&(t&&mt.alternate!==null&&ze.delete(mt.key===null?ct:mt.key),K=g(mt,K,ct),Nt===null?qe=mt:Nt.sibling=mt,Nt=mt);return t&&ze.forEach(function(oi){return r(J,oi)}),yt&&pa(J,ct),qe}function We(J,K,te,ve){if(te==null)throw Error(a(151));for(var qe=null,Nt=null,ze=K,ct=K=0,mt=null,Ct=te.next();ze!==null&&!Ct.done;ct++,Ct=te.next()){ze.index>ct?(mt=ze,ze=null):mt=ze.sibling;var oi=ae(J,ze,Ct.value,ve);if(oi===null){ze===null&&(ze=mt);break}t&&ze&&oi.alternate===null&&r(J,ze),K=g(oi,K,ct),Nt===null?qe=oi:Nt.sibling=oi,Nt=oi,ze=mt}if(Ct.done)return i(J,ze),yt&&pa(J,ct),qe;if(ze===null){for(;!Ct.done;ct++,Ct=te.next())Ct=Ee(J,Ct.value,ve),Ct!==null&&(K=g(Ct,K,ct),Nt===null?qe=Ct:Nt.sibling=Ct,Nt=Ct);return yt&&pa(J,ct),qe}for(ze=c(ze);!Ct.done;ct++,Ct=te.next())Ct=ue(ze,J,ct,Ct.value,ve),Ct!==null&&(t&&Ct.alternate!==null&&ze.delete(Ct.key===null?ct:Ct.key),K=g(Ct,K,ct),Nt===null?qe=Ct:Nt.sibling=Ct,Nt=Ct);return t&&ze.forEach(function(I2){return r(J,I2)}),yt&&pa(J,ct),qe}function zt(J,K,te,ve){if(typeof te=="object"&&te!==null&&te.type===D&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case N:e:{for(var qe=te.key;K!==null;){if(K.key===qe){if(qe=te.type,qe===D){if(K.tag===7){i(J,K.sibling),ve=h(K,te.props.children),ve.return=J,J=ve;break e}}else if(K.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===T&&Ki(qe)===K.type){i(J,K.sibling),ve=h(K,te.props),rc(ve,te),ve.return=J,J=ve;break e}i(J,K);break}else r(J,K);K=K.sibling}te.type===D?(ve=qi(te.props.children,J.mode,ve,te.key),ve.return=J,J=ve):(ve=Vu(te.type,te.key,te.props,null,J.mode,ve),rc(ve,te),ve.return=J,J=ve)}return E(J);case z:e:{for(qe=te.key;K!==null;){if(K.key===qe)if(K.tag===4&&K.stateNode.containerInfo===te.containerInfo&&K.stateNode.implementation===te.implementation){i(J,K.sibling),ve=h(K,te.children||[]),ve.return=J,J=ve;break e}else{i(J,K);break}else r(J,K);K=K.sibling}ve=rh(te,J.mode,ve),ve.return=J,J=ve}return E(J);case T:return te=Ki(te),zt(J,K,te,ve)}if(ye(te))return Ue(J,K,te,ve);if(L(te)){if(qe=L(te),typeof qe!="function")throw Error(a(150));return te=qe.call(te),We(J,K,te,ve)}if(typeof te.then=="function")return zt(J,K,$u(te),ve);if(te.$$typeof===G)return zt(J,K,Fu(J,te),ve);Yu(J,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,K!==null&&K.tag===6?(i(J,K.sibling),ve=h(K,te),ve.return=J,J=ve):(i(J,K),ve=sh(te,J.mode,ve),ve.return=J,J=ve),E(J)):i(J,K)}return function(J,K,te,ve){try{sc=0;var qe=zt(J,K,te,ve);return $o=null,qe}catch(ze){if(ze===qo||ze===Gu)throw ze;var Nt=ks(29,ze,null,J.mode);return Nt.lanes=ve,Nt.return=J,Nt}finally{}}}var Xi=my(!0),gy=my(!1),Ga=!1;function gh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yh(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function qa(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function $a(t,r,i){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(jt&2)!==0){var h=c.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),c.pending=r,r=Pu(t),J0(t,null,i),r}return Uu(t,c,r,i),Pu(t)}function ac(t,r,i){if(r=r.updateQueue,r!==null&&(r=r.shared,(i&4194048)!==0)){var c=r.lanes;c&=t.pendingLanes,i|=c,r.lanes=i,na(t,i)}}function xh(t,r){var i=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,i===c)){var h=null,g=null;if(i=i.firstBaseUpdate,i!==null){do{var E={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};g===null?h=g=E:g=g.next=E,i=i.next}while(i!==null);g===null?h=g=r:g=g.next=r}else h=g=r;i={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},t.updateQueue=i;return}t=i.lastBaseUpdate,t===null?i.firstBaseUpdate=r:t.next=r,i.lastBaseUpdate=r}var bh=!1;function ic(){if(bh){var t=Go;if(t!==null)throw t}}function oc(t,r,i,c){bh=!1;var h=t.updateQueue;Ga=!1;var g=h.firstBaseUpdate,E=h.lastBaseUpdate,k=h.shared.pending;if(k!==null){h.shared.pending=null;var $=k,ne=$.next;$.next=null,E===null?g=ne:E.next=ne,E=$;var ge=t.alternate;ge!==null&&(ge=ge.updateQueue,k=ge.lastBaseUpdate,k!==E&&(k===null?ge.firstBaseUpdate=ne:k.next=ne,ge.lastBaseUpdate=$))}if(g!==null){var Ee=h.baseState;E=0,ge=ne=$=null,k=g;do{var ae=k.lane&-536870913,ue=ae!==k.lane;if(ue?(pt&ae)===ae:(c&ae)===ae){ae!==0&&ae===Ho&&(bh=!0),ge!==null&&(ge=ge.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Ue=t,We=k;ae=r;var zt=i;switch(We.tag){case 1:if(Ue=We.payload,typeof Ue=="function"){Ee=Ue.call(zt,Ee,ae);break e}Ee=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=We.payload,ae=typeof Ue=="function"?Ue.call(zt,Ee,ae):Ue,ae==null)break e;Ee=v({},Ee,ae);break e;case 2:Ga=!0}}ae=k.callback,ae!==null&&(t.flags|=64,ue&&(t.flags|=8192),ue=h.callbacks,ue===null?h.callbacks=[ae]:ue.push(ae))}else ue={lane:ae,tag:k.tag,payload:k.payload,callback:k.callback,next:null},ge===null?(ne=ge=ue,$=Ee):ge=ge.next=ue,E|=ae;if(k=k.next,k===null){if(k=h.shared.pending,k===null)break;ue=k,k=ue.next,ue.next=null,h.lastBaseUpdate=ue,h.shared.pending=null}}while(!0);ge===null&&($=Ee),h.baseState=$,h.firstBaseUpdate=ne,h.lastBaseUpdate=ge,g===null&&(h.shared.lanes=0),Za|=E,t.lanes=E,t.memoizedState=Ee}}function yy(t,r){if(typeof t!="function")throw Error(a(191,t));t.call(r)}function xy(t,r){var i=t.callbacks;if(i!==null)for(t.callbacks=null,t=0;t<i.length;t++)yy(i[t],r)}var Yo=A(null),Qu=A(0);function by(t,r){t=Ta,q(Qu,t),q(Yo,r),Ta=t|r.baseLanes}function vh(){q(Qu,Ta),q(Yo,Yo.current)}function _h(){Ta=Qu.current,V(Yo),V(Qu)}var Ls=A(null),rr=null;function Ya(t){var r=t.alternate;q(yn,yn.current&1),q(Ls,t),rr===null&&(r===null||Yo.current!==null||r.memoizedState!==null)&&(rr=t)}function Eh(t){q(yn,yn.current),q(Ls,t),rr===null&&(rr=t)}function vy(t){t.tag===22?(q(yn,yn.current),q(Ls,t),rr===null&&(rr=t)):Qa()}function Qa(){q(yn,yn.current),q(Ls,Ls.current)}function Ms(t){V(Ls),rr===t&&(rr=null),V(yn)}var yn=A(0);function Wu(t){for(var r=t;r!==null;){if(r.tag===13){var i=r.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||Np(i)||Cp(i)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var ya=0,lt=null,Pt=null,Sn=null,Ku=!1,Qo=!1,Ji=!1,Zu=0,lc=0,Wo=null,yA=0;function un(){throw Error(a(321))}function wh(t,r){if(r===null)return!1;for(var i=0;i<r.length&&i<t.length;i++)if(!js(t[i],r[i]))return!1;return!0}function Sh(t,r,i,c,h,g){return ya=g,lt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,B.H=t===null||t.memoizedState===null?sx:Vh,Ji=!1,g=i(c,h),Ji=!1,Qo&&(g=Ey(r,i,c,h)),_y(t),g}function _y(t){B.H=dc;var r=Pt!==null&&Pt.next!==null;if(ya=0,Sn=Pt=lt=null,Ku=!1,lc=0,Wo=null,r)throw Error(a(300));t===null||Tn||(t=t.dependencies,t!==null&&Bu(t)&&(Tn=!0))}function Ey(t,r,i,c){lt=t;var h=0;do{if(Qo&&(Wo=null),lc=0,Qo=!1,25<=h)throw Error(a(301));if(h+=1,Sn=Pt=null,t.updateQueue!=null){var g=t.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}B.H=rx,g=r(i,c)}while(Qo);return g}function xA(){var t=B.H,r=t.useState()[0];return r=typeof r.then=="function"?cc(r):r,t=t.useState()[0],(Pt!==null?Pt.memoizedState:null)!==t&&(lt.flags|=1024),r}function Th(){var t=Zu!==0;return Zu=0,t}function Ah(t,r,i){r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~i}function Ih(t){if(Ku){for(t=t.memoizedState;t!==null;){var r=t.queue;r!==null&&(r.pending=null),t=t.next}Ku=!1}ya=0,Sn=Pt=lt=null,Qo=!1,lc=Zu=0,Wo=null}function ds(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sn===null?lt.memoizedState=Sn=t:Sn=Sn.next=t,Sn}function xn(){if(Pt===null){var t=lt.alternate;t=t!==null?t.memoizedState:null}else t=Pt.next;var r=Sn===null?lt.memoizedState:Sn.next;if(r!==null)Sn=r,Pt=t;else{if(t===null)throw lt.alternate===null?Error(a(467)):Error(a(310));Pt=t,t={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Sn===null?lt.memoizedState=Sn=t:Sn=Sn.next=t}return Sn}function Xu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function cc(t){var r=lc;return lc+=1,Wo===null&&(Wo=[]),t=fy(Wo,t,r),r=lt,(Sn===null?r.memoizedState:Sn.next)===null&&(r=r.alternate,B.H=r===null||r.memoizedState===null?sx:Vh),t}function Ju(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return cc(t);if(t.$$typeof===G)return $n(t)}throw Error(a(438,String(t)))}function Nh(t){var r=null,i=lt.updateQueue;if(i!==null&&(r=i.memoCache),r==null){var c=lt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(h){return h.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),i===null&&(i=Xu(),lt.updateQueue=i),i.memoCache=r,i=r.data[r.index],i===void 0)for(i=r.data[r.index]=Array(t),c=0;c<t;c++)i[c]=C;return r.index++,i}function xa(t,r){return typeof r=="function"?r(t):r}function ed(t){var r=xn();return Ch(r,Pt,t)}function Ch(t,r,i){var c=t.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=i;var h=t.baseQueue,g=c.pending;if(g!==null){if(h!==null){var E=h.next;h.next=g.next,g.next=E}r.baseQueue=h=g,c.pending=null}if(g=t.baseState,h===null)t.memoizedState=g;else{r=h.next;var k=E=null,$=null,ne=r,ge=!1;do{var Ee=ne.lane&-536870913;if(Ee!==ne.lane?(pt&Ee)===Ee:(ya&Ee)===Ee){var ae=ne.revertLane;if(ae===0)$!==null&&($=$.next={lane:0,revertLane:0,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),Ee===Ho&&(ge=!0);else if((ya&ae)===ae){ne=ne.next,ae===Ho&&(ge=!0);continue}else Ee={lane:0,revertLane:ne.revertLane,gesture:null,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},$===null?(k=$=Ee,E=g):$=$.next=Ee,lt.lanes|=ae,Za|=ae;Ee=ne.action,Ji&&i(g,Ee),g=ne.hasEagerState?ne.eagerState:i(g,Ee)}else ae={lane:Ee,revertLane:ne.revertLane,gesture:ne.gesture,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},$===null?(k=$=ae,E=g):$=$.next=ae,lt.lanes|=Ee,Za|=Ee;ne=ne.next}while(ne!==null&&ne!==r);if($===null?E=g:$.next=k,!js(g,t.memoizedState)&&(Tn=!0,ge&&(i=Go,i!==null)))throw i;t.memoizedState=g,t.baseState=E,t.baseQueue=$,c.lastRenderedState=g}return h===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function Rh(t){var r=xn(),i=r.queue;if(i===null)throw Error(a(311));i.lastRenderedReducer=t;var c=i.dispatch,h=i.pending,g=r.memoizedState;if(h!==null){i.pending=null;var E=h=h.next;do g=t(g,E.action),E=E.next;while(E!==h);js(g,r.memoizedState)||(Tn=!0),r.memoizedState=g,r.baseQueue===null&&(r.baseState=g),i.lastRenderedState=g}return[g,c]}function wy(t,r,i){var c=lt,h=xn(),g=yt;if(g){if(i===void 0)throw Error(a(407));i=i()}else i=r();var E=!js((Pt||h).memoizedState,i);if(E&&(h.memoizedState=i,Tn=!0),h=h.queue,kh(Ay.bind(null,c,h,t),[t]),h.getSnapshot!==r||E||Sn!==null&&Sn.memoizedState.tag&1){if(c.flags|=2048,Ko(9,{destroy:void 0},Ty.bind(null,c,h,i,r),null),Bt===null)throw Error(a(349));g||(ya&127)!==0||Sy(c,r,i)}return i}function Sy(t,r,i){t.flags|=16384,t={getSnapshot:r,value:i},r=lt.updateQueue,r===null?(r=Xu(),lt.updateQueue=r,r.stores=[t]):(i=r.stores,i===null?r.stores=[t]:i.push(t))}function Ty(t,r,i,c){r.value=i,r.getSnapshot=c,Iy(r)&&Ny(t)}function Ay(t,r,i){return i(function(){Iy(r)&&Ny(t)})}function Iy(t){var r=t.getSnapshot;t=t.value;try{var i=r();return!js(t,i)}catch{return!0}}function Ny(t){var r=Gi(t,2);r!==null&&Ts(r,t,2)}function Oh(t){var r=ds();if(typeof t=="function"){var i=t;if(t=i(),Ji){De(!0);try{i()}finally{De(!1)}}}return r.memoizedState=r.baseState=t,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:t},r}function Cy(t,r,i,c){return t.baseState=i,Ch(t,Pt,typeof c=="function"?c:xa)}function bA(t,r,i,c,h){if(sd(t))throw Error(a(485));if(t=r.action,t!==null){var g={payload:h,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){g.listeners.push(E)}};B.T!==null?i(!0):g.isTransition=!1,c(g),i=r.pending,i===null?(g.next=r.pending=g,Ry(r,g)):(g.next=i.next,r.pending=i.next=g)}}function Ry(t,r){var i=r.action,c=r.payload,h=t.state;if(r.isTransition){var g=B.T,E={};B.T=E;try{var k=i(h,c),$=B.S;$!==null&&$(E,k),Oy(t,r,k)}catch(ne){jh(t,r,ne)}finally{g!==null&&E.types!==null&&(g.types=E.types),B.T=g}}else try{g=i(h,c),Oy(t,r,g)}catch(ne){jh(t,r,ne)}}function Oy(t,r,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(c){jy(t,r,c)},function(c){return jh(t,r,c)}):jy(t,r,i)}function jy(t,r,i){r.status="fulfilled",r.value=i,ky(r),t.state=i,r=t.pending,r!==null&&(i=r.next,i===r?t.pending=null:(i=i.next,r.next=i,Ry(t,i)))}function jh(t,r,i){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=i,ky(r),r=r.next;while(r!==c)}t.action=null}function ky(t){t=t.listeners;for(var r=0;r<t.length;r++)(0,t[r])()}function Ly(t,r){return r}function My(t,r){if(yt){var i=Bt.formState;if(i!==null){e:{var c=lt;if(yt){if(qt){t:{for(var h=qt,g=sr;h.nodeType!==8;){if(!g){h=null;break t}if(h=ar(h.nextSibling),h===null){h=null;break t}}g=h.data,h=g==="F!"||g==="F"?h:null}if(h){qt=ar(h.nextSibling),c=h.data==="F!";break e}}Fa(c)}c=!1}c&&(r=i[0])}}return i=ds(),i.memoizedState=i.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ly,lastRenderedState:r},i.queue=c,i=ex.bind(null,lt,c),c.dispatch=i,c=Oh(!1),g=Ph.bind(null,lt,!1,c.queue),c=ds(),h={state:r,dispatch:null,action:t,pending:null},c.queue=h,i=bA.bind(null,lt,h,g,i),h.dispatch=i,c.memoizedState=t,[r,i,!1]}function Dy(t){var r=xn();return Uy(r,Pt,t)}function Uy(t,r,i){if(r=Ch(t,r,Ly)[0],t=ed(xa)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=cc(r)}catch(E){throw E===qo?Gu:E}else c=r;r=xn();var h=r.queue,g=h.dispatch;return i!==r.memoizedState&&(lt.flags|=2048,Ko(9,{destroy:void 0},vA.bind(null,h,i),null)),[c,g,t]}function vA(t,r){t.action=r}function Py(t){var r=xn(),i=Pt;if(i!==null)return Uy(r,i,t);xn(),r=r.memoizedState,i=xn();var c=i.queue.dispatch;return i.memoizedState=t,[r,c,!1]}function Ko(t,r,i,c){return t={tag:t,create:i,deps:c,inst:r,next:null},r=lt.updateQueue,r===null&&(r=Xu(),lt.updateQueue=r),i=r.lastEffect,i===null?r.lastEffect=t.next=t:(c=i.next,i.next=t,t.next=c,r.lastEffect=t),t}function Vy(){return xn().memoizedState}function td(t,r,i,c){var h=ds();lt.flags|=t,h.memoizedState=Ko(1|r,{destroy:void 0},i,c===void 0?null:c)}function nd(t,r,i,c){var h=xn();c=c===void 0?null:c;var g=h.memoizedState.inst;Pt!==null&&c!==null&&wh(c,Pt.memoizedState.deps)?h.memoizedState=Ko(r,g,i,c):(lt.flags|=t,h.memoizedState=Ko(1|r,g,i,c))}function zy(t,r){td(8390656,8,t,r)}function kh(t,r){nd(2048,8,t,r)}function _A(t){lt.flags|=4;var r=lt.updateQueue;if(r===null)r=Xu(),lt.updateQueue=r,r.events=[t];else{var i=r.events;i===null?r.events=[t]:i.push(t)}}function By(t){var r=xn().memoizedState;return _A({ref:r,nextImpl:t}),function(){if((jt&2)!==0)throw Error(a(440));return r.impl.apply(void 0,arguments)}}function Fy(t,r){return nd(4,2,t,r)}function Hy(t,r){return nd(4,4,t,r)}function Gy(t,r){if(typeof r=="function"){t=t();var i=r(t);return function(){typeof i=="function"?i():r(null)}}if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function qy(t,r,i){i=i!=null?i.concat([t]):null,nd(4,4,Gy.bind(null,r,t),i)}function Lh(){}function $y(t,r){var i=xn();r=r===void 0?null:r;var c=i.memoizedState;return r!==null&&wh(r,c[1])?c[0]:(i.memoizedState=[t,r],t)}function Yy(t,r){var i=xn();r=r===void 0?null:r;var c=i.memoizedState;if(r!==null&&wh(r,c[1]))return c[0];if(c=t(),Ji){De(!0);try{t()}finally{De(!1)}}return i.memoizedState=[c,r],c}function Mh(t,r,i){return i===void 0||(ya&1073741824)!==0&&(pt&261930)===0?t.memoizedState=r:(t.memoizedState=i,t=Qx(),lt.lanes|=t,Za|=t,i)}function Qy(t,r,i,c){return js(i,r)?i:Yo.current!==null?(t=Mh(t,i,c),js(t,r)||(Tn=!0),t):(ya&42)===0||(ya&1073741824)!==0&&(pt&261930)===0?(Tn=!0,t.memoizedState=i):(t=Qx(),lt.lanes|=t,Za|=t,r)}function Wy(t,r,i,c,h){var g=le.p;le.p=g!==0&&8>g?g:8;var E=B.T,k={};B.T=k,Ph(t,!1,r,i);try{var $=h(),ne=B.S;if(ne!==null&&ne(k,$),$!==null&&typeof $=="object"&&typeof $.then=="function"){var ge=gA($,c);uc(t,r,ge,Ps(t))}else uc(t,r,c,Ps(t))}catch(Ee){uc(t,r,{then:function(){},status:"rejected",reason:Ee},Ps())}finally{le.p=g,E!==null&&k.types!==null&&(E.types=k.types),B.T=E}}function EA(){}function Dh(t,r,i,c){if(t.tag!==5)throw Error(a(476));var h=Ky(t).queue;Wy(t,h,r,se,i===null?EA:function(){return Zy(t),i(c)})}function Ky(t){var r=t.memoizedState;if(r!==null)return r;r={memoizedState:se,baseState:se,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:se},next:null};var i={};return r.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:xa,lastRenderedState:i},next:null},t.memoizedState=r,t=t.alternate,t!==null&&(t.memoizedState=r),r}function Zy(t){var r=Ky(t);r.next===null&&(r=t.alternate.memoizedState),uc(t,r.next.queue,{},Ps())}function Uh(){return $n(Ic)}function Xy(){return xn().memoizedState}function Jy(){return xn().memoizedState}function wA(t){for(var r=t.return;r!==null;){switch(r.tag){case 24:case 3:var i=Ps();t=qa(i);var c=$a(r,t,i);c!==null&&(Ts(c,r,i),ac(c,r,i)),r={cache:fh()},t.payload=r;return}r=r.return}}function SA(t,r,i){var c=Ps();i={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},sd(t)?tx(r,i):(i=th(t,r,i,c),i!==null&&(Ts(i,t,c),nx(i,r,c)))}function ex(t,r,i){var c=Ps();uc(t,r,i,c)}function uc(t,r,i,c){var h={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(sd(t))tx(r,h);else{var g=t.alternate;if(t.lanes===0&&(g===null||g.lanes===0)&&(g=r.lastRenderedReducer,g!==null))try{var E=r.lastRenderedState,k=g(E,i);if(h.hasEagerState=!0,h.eagerState=k,js(k,E))return Uu(t,r,h,0),Bt===null&&Du(),!1}catch{}finally{}if(i=th(t,r,h,c),i!==null)return Ts(i,t,c),nx(i,r,c),!0}return!1}function Ph(t,r,i,c){if(c={lane:2,revertLane:gp(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},sd(t)){if(r)throw Error(a(479))}else r=th(t,i,c,2),r!==null&&Ts(r,t,2)}function sd(t){var r=t.alternate;return t===lt||r!==null&&r===lt}function tx(t,r){Qo=Ku=!0;var i=t.pending;i===null?r.next=r:(r.next=i.next,i.next=r),t.pending=r}function nx(t,r,i){if((i&4194048)!==0){var c=r.lanes;c&=t.pendingLanes,i|=c,r.lanes=i,na(t,i)}}var dc={readContext:$n,use:Ju,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useLayoutEffect:un,useInsertionEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useSyncExternalStore:un,useId:un,useHostTransitionStatus:un,useFormState:un,useActionState:un,useOptimistic:un,useMemoCache:un,useCacheRefresh:un};dc.useEffectEvent=un;var sx={readContext:$n,use:Ju,useCallback:function(t,r){return ds().memoizedState=[t,r===void 0?null:r],t},useContext:$n,useEffect:zy,useImperativeHandle:function(t,r,i){i=i!=null?i.concat([t]):null,td(4194308,4,Gy.bind(null,r,t),i)},useLayoutEffect:function(t,r){return td(4194308,4,t,r)},useInsertionEffect:function(t,r){td(4,2,t,r)},useMemo:function(t,r){var i=ds();r=r===void 0?null:r;var c=t();if(Ji){De(!0);try{t()}finally{De(!1)}}return i.memoizedState=[c,r],c},useReducer:function(t,r,i){var c=ds();if(i!==void 0){var h=i(r);if(Ji){De(!0);try{i(r)}finally{De(!1)}}}else h=r;return c.memoizedState=c.baseState=h,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:h},c.queue=t,t=t.dispatch=SA.bind(null,lt,t),[c.memoizedState,t]},useRef:function(t){var r=ds();return t={current:t},r.memoizedState=t},useState:function(t){t=Oh(t);var r=t.queue,i=ex.bind(null,lt,r);return r.dispatch=i,[t.memoizedState,i]},useDebugValue:Lh,useDeferredValue:function(t,r){var i=ds();return Mh(i,t,r)},useTransition:function(){var t=Oh(!1);return t=Wy.bind(null,lt,t.queue,!0,!1),ds().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,r,i){var c=lt,h=ds();if(yt){if(i===void 0)throw Error(a(407));i=i()}else{if(i=r(),Bt===null)throw Error(a(349));(pt&127)!==0||Sy(c,r,i)}h.memoizedState=i;var g={value:i,getSnapshot:r};return h.queue=g,zy(Ay.bind(null,c,g,t),[t]),c.flags|=2048,Ko(9,{destroy:void 0},Ty.bind(null,c,g,i,r),null),i},useId:function(){var t=ds(),r=Bt.identifierPrefix;if(yt){var i=Fr,c=Br;i=(c&~(1<<32-Ne(c)-1)).toString(32)+i,r="_"+r+"R_"+i,i=Zu++,0<i&&(r+="H"+i.toString(32)),r+="_"}else i=yA++,r="_"+r+"r_"+i.toString(32)+"_";return t.memoizedState=r},useHostTransitionStatus:Uh,useFormState:My,useActionState:My,useOptimistic:function(t){var r=ds();r.memoizedState=r.baseState=t;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=i,r=Ph.bind(null,lt,!0,i),i.dispatch=r,[t,r]},useMemoCache:Nh,useCacheRefresh:function(){return ds().memoizedState=wA.bind(null,lt)},useEffectEvent:function(t){var r=ds(),i={impl:t};return r.memoizedState=i,function(){if((jt&2)!==0)throw Error(a(440));return i.impl.apply(void 0,arguments)}}},Vh={readContext:$n,use:Ju,useCallback:$y,useContext:$n,useEffect:kh,useImperativeHandle:qy,useInsertionEffect:Fy,useLayoutEffect:Hy,useMemo:Yy,useReducer:ed,useRef:Vy,useState:function(){return ed(xa)},useDebugValue:Lh,useDeferredValue:function(t,r){var i=xn();return Qy(i,Pt.memoizedState,t,r)},useTransition:function(){var t=ed(xa)[0],r=xn().memoizedState;return[typeof t=="boolean"?t:cc(t),r]},useSyncExternalStore:wy,useId:Xy,useHostTransitionStatus:Uh,useFormState:Dy,useActionState:Dy,useOptimistic:function(t,r){var i=xn();return Cy(i,Pt,t,r)},useMemoCache:Nh,useCacheRefresh:Jy};Vh.useEffectEvent=By;var rx={readContext:$n,use:Ju,useCallback:$y,useContext:$n,useEffect:kh,useImperativeHandle:qy,useInsertionEffect:Fy,useLayoutEffect:Hy,useMemo:Yy,useReducer:Rh,useRef:Vy,useState:function(){return Rh(xa)},useDebugValue:Lh,useDeferredValue:function(t,r){var i=xn();return Pt===null?Mh(i,t,r):Qy(i,Pt.memoizedState,t,r)},useTransition:function(){var t=Rh(xa)[0],r=xn().memoizedState;return[typeof t=="boolean"?t:cc(t),r]},useSyncExternalStore:wy,useId:Xy,useHostTransitionStatus:Uh,useFormState:Py,useActionState:Py,useOptimistic:function(t,r){var i=xn();return Pt!==null?Cy(i,Pt,t,r):(i.baseState=t,[t,i.queue.dispatch])},useMemoCache:Nh,useCacheRefresh:Jy};rx.useEffectEvent=By;function zh(t,r,i,c){r=t.memoizedState,i=i(c,r),i=i==null?r:v({},r,i),t.memoizedState=i,t.lanes===0&&(t.updateQueue.baseState=i)}var Bh={enqueueSetState:function(t,r,i){t=t._reactInternals;var c=Ps(),h=qa(c);h.payload=r,i!=null&&(h.callback=i),r=$a(t,h,c),r!==null&&(Ts(r,t,c),ac(r,t,c))},enqueueReplaceState:function(t,r,i){t=t._reactInternals;var c=Ps(),h=qa(c);h.tag=1,h.payload=r,i!=null&&(h.callback=i),r=$a(t,h,c),r!==null&&(Ts(r,t,c),ac(r,t,c))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var i=Ps(),c=qa(i);c.tag=2,r!=null&&(c.callback=r),r=$a(t,c,i),r!==null&&(Ts(r,t,i),ac(r,t,i))}};function ax(t,r,i,c,h,g,E){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,g,E):r.prototype&&r.prototype.isPureReactComponent?!Zl(i,c)||!Zl(h,g):!0}function ix(t,r,i,c){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(i,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(i,c),r.state!==t&&Bh.enqueueReplaceState(r,r.state,null)}function eo(t,r){var i=r;if("ref"in r){i={};for(var c in r)c!=="ref"&&(i[c]=r[c])}if(t=t.defaultProps){i===r&&(i=v({},i));for(var h in t)i[h]===void 0&&(i[h]=t[h])}return i}function ox(t){Mu(t)}function lx(t){console.error(t)}function cx(t){Mu(t)}function rd(t,r){try{var i=t.onUncaughtError;i(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function ux(t,r,i){try{var c=t.onCaughtError;c(i.value,{componentStack:i.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function Fh(t,r,i){return i=qa(i),i.tag=3,i.payload={element:null},i.callback=function(){rd(t,r)},i}function dx(t){return t=qa(t),t.tag=3,t}function fx(t,r,i,c){var h=i.type.getDerivedStateFromError;if(typeof h=="function"){var g=c.value;t.payload=function(){return h(g)},t.callback=function(){ux(r,i,c)}}var E=i.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(t.callback=function(){ux(r,i,c),typeof h!="function"&&(Xa===null?Xa=new Set([this]):Xa.add(this));var k=c.stack;this.componentDidCatch(c.value,{componentStack:k!==null?k:""})})}function TA(t,r,i,c,h){if(i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=i.alternate,r!==null&&Fo(r,i,h,!0),i=Ls.current,i!==null){switch(i.tag){case 31:case 13:return rr===null?gd():i.alternate===null&&dn===0&&(dn=3),i.flags&=-257,i.flags|=65536,i.lanes=h,c===qu?i.flags|=16384:(r=i.updateQueue,r===null?i.updateQueue=new Set([c]):r.add(c),hp(t,c,h)),!1;case 22:return i.flags|=65536,c===qu?i.flags|=16384:(r=i.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},i.updateQueue=r):(i=r.retryQueue,i===null?r.retryQueue=new Set([c]):i.add(c)),hp(t,c,h)),!1}throw Error(a(435,i.tag))}return hp(t,c,h),gd(),!1}if(yt)return r=Ls.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=h,c!==oh&&(t=Error(a(422),{cause:c}),ec(er(t,i)))):(c!==oh&&(r=Error(a(423),{cause:c}),ec(er(r,i))),t=t.current.alternate,t.flags|=65536,h&=-h,t.lanes|=h,c=er(c,i),h=Fh(t.stateNode,c,h),xh(t,h),dn!==4&&(dn=2)),!1;var g=Error(a(520),{cause:c});if(g=er(g,i),bc===null?bc=[g]:bc.push(g),dn!==4&&(dn=2),r===null)return!0;c=er(c,i),i=r;do{switch(i.tag){case 3:return i.flags|=65536,t=h&-h,i.lanes|=t,t=Fh(i.stateNode,c,t),xh(i,t),!1;case 1:if(r=i.type,g=i.stateNode,(i.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Xa===null||!Xa.has(g))))return i.flags|=65536,h&=-h,i.lanes|=h,h=dx(h),fx(h,t,i,c),xh(i,h),!1}i=i.return}while(i!==null);return!1}var Hh=Error(a(461)),Tn=!1;function Yn(t,r,i,c){r.child=t===null?gy(r,null,i,c):Xi(r,t.child,i,c)}function hx(t,r,i,c,h){i=i.render;var g=r.ref;if("ref"in c){var E={};for(var k in c)k!=="ref"&&(E[k]=c[k])}else E=c;return Qi(r),c=Sh(t,r,i,E,g,h),k=Th(),t!==null&&!Tn?(Ah(t,r,h),ba(t,r,h)):(yt&&k&&ah(r),r.flags|=1,Yn(t,r,c,h),r.child)}function px(t,r,i,c,h){if(t===null){var g=i.type;return typeof g=="function"&&!nh(g)&&g.defaultProps===void 0&&i.compare===null?(r.tag=15,r.type=g,mx(t,r,g,c,h)):(t=Vu(i.type,null,c,r,r.mode,h),t.ref=r.ref,t.return=r,r.child=t)}if(g=t.child,!Zh(t,h)){var E=g.memoizedProps;if(i=i.compare,i=i!==null?i:Zl,i(E,c)&&t.ref===r.ref)return ba(t,r,h)}return r.flags|=1,t=ha(g,c),t.ref=r.ref,t.return=r,r.child=t}function mx(t,r,i,c,h){if(t!==null){var g=t.memoizedProps;if(Zl(g,c)&&t.ref===r.ref)if(Tn=!1,r.pendingProps=c=g,Zh(t,h))(t.flags&131072)!==0&&(Tn=!0);else return r.lanes=t.lanes,ba(t,r,h)}return Gh(t,r,i,c,h)}function gx(t,r,i,c){var h=c.children,g=t!==null?t.memoizedState:null;if(t===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(g=g!==null?g.baseLanes|i:i,t!==null){for(c=r.child=t.child,h=0;c!==null;)h=h|c.lanes|c.childLanes,c=c.sibling;c=h&~g}else c=0,r.child=null;return yx(t,r,g,i,c)}if((i&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},t!==null&&Hu(r,g!==null?g.cachePool:null),g!==null?by(r,g):vh(),vy(r);else return c=r.lanes=536870912,yx(t,r,g!==null?g.baseLanes|i:i,i,c)}else g!==null?(Hu(r,g.cachePool),by(r,g),Qa(),r.memoizedState=null):(t!==null&&Hu(r,null),vh(),Qa());return Yn(t,r,h,i),r.child}function fc(t,r){return t!==null&&t.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function yx(t,r,i,c,h){var g=ph();return g=g===null?null:{parent:wn._currentValue,pool:g},r.memoizedState={baseLanes:i,cachePool:g},t!==null&&Hu(r,null),vh(),vy(r),t!==null&&Fo(t,r,c,!0),r.childLanes=h,null}function ad(t,r){return r=od({mode:r.mode,children:r.children},t.mode),r.ref=t.ref,t.child=r,r.return=t,r}function xx(t,r,i){return Xi(r,t.child,null,i),t=ad(r,r.pendingProps),t.flags|=2,Ms(r),r.memoizedState=null,t}function AA(t,r,i){var c=r.pendingProps,h=(r.flags&128)!==0;if(r.flags&=-129,t===null){if(yt){if(c.mode==="hidden")return t=ad(r,c),r.lanes=536870912,fc(null,t);if(Eh(r),(t=qt)?(t=Rb(t,sr),t=t!==null&&t.data==="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:za!==null?{id:Br,overflow:Fr}:null,retryLane:536870912,hydrationErrors:null},i=ty(t),i.return=r,r.child=i,qn=r,qt=null)):t=null,t===null)throw Fa(r);return r.lanes=536870912,null}return ad(r,c)}var g=t.memoizedState;if(g!==null){var E=g.dehydrated;if(Eh(r),h)if(r.flags&256)r.flags&=-257,r=xx(t,r,i);else if(r.memoizedState!==null)r.child=t.child,r.flags|=128,r=null;else throw Error(a(558));else if(Tn||Fo(t,r,i,!1),h=(i&t.childLanes)!==0,Tn||h){if(c=Bt,c!==null&&(E=Lr(c,i),E!==0&&E!==g.retryLane))throw g.retryLane=E,Gi(t,E),Ts(c,t,E),Hh;gd(),r=xx(t,r,i)}else t=g.treeContext,qt=ar(E.nextSibling),qn=r,yt=!0,Ba=null,sr=!1,t!==null&&ry(r,t),r=ad(r,c),r.flags|=4096;return r}return t=ha(t.child,{mode:c.mode,children:c.children}),t.ref=r.ref,r.child=t,t.return=r,t}function id(t,r){var i=r.ref;if(i===null)t!==null&&t.ref!==null&&(r.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(a(284));(t===null||t.ref!==i)&&(r.flags|=4194816)}}function Gh(t,r,i,c,h){return Qi(r),i=Sh(t,r,i,c,void 0,h),c=Th(),t!==null&&!Tn?(Ah(t,r,h),ba(t,r,h)):(yt&&c&&ah(r),r.flags|=1,Yn(t,r,i,h),r.child)}function bx(t,r,i,c,h,g){return Qi(r),r.updateQueue=null,i=Ey(r,c,i,h),_y(t),c=Th(),t!==null&&!Tn?(Ah(t,r,g),ba(t,r,g)):(yt&&c&&ah(r),r.flags|=1,Yn(t,r,i,g),r.child)}function vx(t,r,i,c,h){if(Qi(r),r.stateNode===null){var g=Po,E=i.contextType;typeof E=="object"&&E!==null&&(g=$n(E)),g=new i(c,g),r.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Bh,r.stateNode=g,g._reactInternals=r,g=r.stateNode,g.props=c,g.state=r.memoizedState,g.refs={},gh(r),E=i.contextType,g.context=typeof E=="object"&&E!==null?$n(E):Po,g.state=r.memoizedState,E=i.getDerivedStateFromProps,typeof E=="function"&&(zh(r,i,E,c),g.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(E=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),E!==g.state&&Bh.enqueueReplaceState(g,g.state,null),oc(r,c,g,h),ic(),g.state=r.memoizedState),typeof g.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(t===null){g=r.stateNode;var k=r.memoizedProps,$=eo(i,k);g.props=$;var ne=g.context,ge=i.contextType;E=Po,typeof ge=="object"&&ge!==null&&(E=$n(ge));var Ee=i.getDerivedStateFromProps;ge=typeof Ee=="function"||typeof g.getSnapshotBeforeUpdate=="function",k=r.pendingProps!==k,ge||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(k||ne!==E)&&ix(r,g,c,E),Ga=!1;var ae=r.memoizedState;g.state=ae,oc(r,c,g,h),ic(),ne=r.memoizedState,k||ae!==ne||Ga?(typeof Ee=="function"&&(zh(r,i,Ee,c),ne=r.memoizedState),($=Ga||ax(r,i,$,c,ae,ne,E))?(ge||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(r.flags|=4194308)):(typeof g.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=ne),g.props=c,g.state=ne,g.context=E,c=$):(typeof g.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{g=r.stateNode,yh(t,r),E=r.memoizedProps,ge=eo(i,E),g.props=ge,Ee=r.pendingProps,ae=g.context,ne=i.contextType,$=Po,typeof ne=="object"&&ne!==null&&($=$n(ne)),k=i.getDerivedStateFromProps,(ne=typeof k=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(E!==Ee||ae!==$)&&ix(r,g,c,$),Ga=!1,ae=r.memoizedState,g.state=ae,oc(r,c,g,h),ic();var ue=r.memoizedState;E!==Ee||ae!==ue||Ga||t!==null&&t.dependencies!==null&&Bu(t.dependencies)?(typeof k=="function"&&(zh(r,i,k,c),ue=r.memoizedState),(ge=Ga||ax(r,i,ge,c,ae,ue,$)||t!==null&&t.dependencies!==null&&Bu(t.dependencies))?(ne||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,ue,$),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,ue,$)),typeof g.componentDidUpdate=="function"&&(r.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof g.componentDidUpdate!="function"||E===t.memoizedProps&&ae===t.memoizedState||(r.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===t.memoizedProps&&ae===t.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=ue),g.props=c,g.state=ue,g.context=$,c=ge):(typeof g.componentDidUpdate!="function"||E===t.memoizedProps&&ae===t.memoizedState||(r.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===t.memoizedProps&&ae===t.memoizedState||(r.flags|=1024),c=!1)}return g=c,id(t,r),c=(r.flags&128)!==0,g||c?(g=r.stateNode,i=c&&typeof i.getDerivedStateFromError!="function"?null:g.render(),r.flags|=1,t!==null&&c?(r.child=Xi(r,t.child,null,h),r.child=Xi(r,null,i,h)):Yn(t,r,i,h),r.memoizedState=g.state,t=r.child):t=ba(t,r,h),t}function _x(t,r,i,c){return $i(),r.flags|=256,Yn(t,r,i,c),r.child}var qh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $h(t){return{baseLanes:t,cachePool:uy()}}function Yh(t,r,i){return t=t!==null?t.childLanes&~i:0,r&&(t|=Us),t}function Ex(t,r,i){var c=r.pendingProps,h=!1,g=(r.flags&128)!==0,E;if((E=g)||(E=t!==null&&t.memoizedState===null?!1:(yn.current&2)!==0),E&&(h=!0,r.flags&=-129),E=(r.flags&32)!==0,r.flags&=-33,t===null){if(yt){if(h?Ya(r):Qa(),(t=qt)?(t=Rb(t,sr),t=t!==null&&t.data!=="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:za!==null?{id:Br,overflow:Fr}:null,retryLane:536870912,hydrationErrors:null},i=ty(t),i.return=r,r.child=i,qn=r,qt=null)):t=null,t===null)throw Fa(r);return Cp(t)?r.lanes=32:r.lanes=536870912,null}var k=c.children;return c=c.fallback,h?(Qa(),h=r.mode,k=od({mode:"hidden",children:k},h),c=qi(c,h,i,null),k.return=r,c.return=r,k.sibling=c,r.child=k,c=r.child,c.memoizedState=$h(i),c.childLanes=Yh(t,E,i),r.memoizedState=qh,fc(null,c)):(Ya(r),Qh(r,k))}var $=t.memoizedState;if($!==null&&(k=$.dehydrated,k!==null)){if(g)r.flags&256?(Ya(r),r.flags&=-257,r=Wh(t,r,i)):r.memoizedState!==null?(Qa(),r.child=t.child,r.flags|=128,r=null):(Qa(),k=c.fallback,h=r.mode,c=od({mode:"visible",children:c.children},h),k=qi(k,h,i,null),k.flags|=2,c.return=r,k.return=r,c.sibling=k,r.child=c,Xi(r,t.child,null,i),c=r.child,c.memoizedState=$h(i),c.childLanes=Yh(t,E,i),r.memoizedState=qh,r=fc(null,c));else if(Ya(r),Cp(k)){if(E=k.nextSibling&&k.nextSibling.dataset,E)var ne=E.dgst;E=ne,c=Error(a(419)),c.stack="",c.digest=E,ec({value:c,source:null,stack:null}),r=Wh(t,r,i)}else if(Tn||Fo(t,r,i,!1),E=(i&t.childLanes)!==0,Tn||E){if(E=Bt,E!==null&&(c=Lr(E,i),c!==0&&c!==$.retryLane))throw $.retryLane=c,Gi(t,c),Ts(E,t,c),Hh;Np(k)||gd(),r=Wh(t,r,i)}else Np(k)?(r.flags|=192,r.child=t.child,r=null):(t=$.treeContext,qt=ar(k.nextSibling),qn=r,yt=!0,Ba=null,sr=!1,t!==null&&ry(r,t),r=Qh(r,c.children),r.flags|=4096);return r}return h?(Qa(),k=c.fallback,h=r.mode,$=t.child,ne=$.sibling,c=ha($,{mode:"hidden",children:c.children}),c.subtreeFlags=$.subtreeFlags&65011712,ne!==null?k=ha(ne,k):(k=qi(k,h,i,null),k.flags|=2),k.return=r,c.return=r,c.sibling=k,r.child=c,fc(null,c),c=r.child,k=t.child.memoizedState,k===null?k=$h(i):(h=k.cachePool,h!==null?($=wn._currentValue,h=h.parent!==$?{parent:$,pool:$}:h):h=uy(),k={baseLanes:k.baseLanes|i,cachePool:h}),c.memoizedState=k,c.childLanes=Yh(t,E,i),r.memoizedState=qh,fc(t.child,c)):(Ya(r),i=t.child,t=i.sibling,i=ha(i,{mode:"visible",children:c.children}),i.return=r,i.sibling=null,t!==null&&(E=r.deletions,E===null?(r.deletions=[t],r.flags|=16):E.push(t)),r.child=i,r.memoizedState=null,i)}function Qh(t,r){return r=od({mode:"visible",children:r},t.mode),r.return=t,t.child=r}function od(t,r){return t=ks(22,t,null,r),t.lanes=0,t}function Wh(t,r,i){return Xi(r,t.child,null,i),t=Qh(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function wx(t,r,i){t.lanes|=r;var c=t.alternate;c!==null&&(c.lanes|=r),uh(t.return,r,i)}function Kh(t,r,i,c,h,g){var E=t.memoizedState;E===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:i,tailMode:h,treeForkCount:g}:(E.isBackwards=r,E.rendering=null,E.renderingStartTime=0,E.last=c,E.tail=i,E.tailMode=h,E.treeForkCount=g)}function Sx(t,r,i){var c=r.pendingProps,h=c.revealOrder,g=c.tail;c=c.children;var E=yn.current,k=(E&2)!==0;if(k?(E=E&1|2,r.flags|=128):E&=1,q(yn,E),Yn(t,r,c,i),c=yt?Jl:0,!k&&t!==null&&(t.flags&128)!==0)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wx(t,i,r);else if(t.tag===19)wx(t,i,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(h){case"forwards":for(i=r.child,h=null;i!==null;)t=i.alternate,t!==null&&Wu(t)===null&&(h=i),i=i.sibling;i=h,i===null?(h=r.child,r.child=null):(h=i.sibling,i.sibling=null),Kh(r,!1,h,i,g,c);break;case"backwards":case"unstable_legacy-backwards":for(i=null,h=r.child,r.child=null;h!==null;){if(t=h.alternate,t!==null&&Wu(t)===null){r.child=h;break}t=h.sibling,h.sibling=i,i=h,h=t}Kh(r,!0,i,null,g,c);break;case"together":Kh(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function ba(t,r,i){if(t!==null&&(r.dependencies=t.dependencies),Za|=r.lanes,(i&r.childLanes)===0)if(t!==null){if(Fo(t,r,i,!1),(i&r.childLanes)===0)return null}else return null;if(t!==null&&r.child!==t.child)throw Error(a(153));if(r.child!==null){for(t=r.child,i=ha(t,t.pendingProps),r.child=i,i.return=r;t.sibling!==null;)t=t.sibling,i=i.sibling=ha(t,t.pendingProps),i.return=r;i.sibling=null}return r.child}function Zh(t,r){return(t.lanes&r)!==0?!0:(t=t.dependencies,!!(t!==null&&Bu(t)))}function IA(t,r,i){switch(r.tag){case 3:ie(r,r.stateNode.containerInfo),Ha(r,wn,t.memoizedState.cache),$i();break;case 27:case 5:he(r);break;case 4:ie(r,r.stateNode.containerInfo);break;case 10:Ha(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Eh(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Ya(r),r.flags|=128,null):(i&r.child.childLanes)!==0?Ex(t,r,i):(Ya(r),t=ba(t,r,i),t!==null?t.sibling:null);Ya(r);break;case 19:var h=(t.flags&128)!==0;if(c=(i&r.childLanes)!==0,c||(Fo(t,r,i,!1),c=(i&r.childLanes)!==0),h){if(c)return Sx(t,r,i);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),q(yn,yn.current),c)break;return null;case 22:return r.lanes=0,gx(t,r,i,r.pendingProps);case 24:Ha(r,wn,t.memoizedState.cache)}return ba(t,r,i)}function Tx(t,r,i){if(t!==null)if(t.memoizedProps!==r.pendingProps)Tn=!0;else{if(!Zh(t,i)&&(r.flags&128)===0)return Tn=!1,IA(t,r,i);Tn=(t.flags&131072)!==0}else Tn=!1,yt&&(r.flags&1048576)!==0&&sy(r,Jl,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(t=Ki(r.elementType),r.type=t,typeof t=="function")nh(t)?(c=eo(t,c),r.tag=1,r=vx(null,r,t,c,i)):(r.tag=0,r=Gh(null,r,t,c,i));else{if(t!=null){var h=t.$$typeof;if(h===H){r.tag=11,r=hx(null,r,t,c,i);break e}else if(h===I){r.tag=14,r=px(null,r,t,c,i);break e}}throw r=_e(t)||t,Error(a(306,r,""))}}return r;case 0:return Gh(t,r,r.type,r.pendingProps,i);case 1:return c=r.type,h=eo(c,r.pendingProps),vx(t,r,c,h,i);case 3:e:{if(ie(r,r.stateNode.containerInfo),t===null)throw Error(a(387));c=r.pendingProps;var g=r.memoizedState;h=g.element,yh(t,r),oc(r,c,null,i);var E=r.memoizedState;if(c=E.cache,Ha(r,wn,c),c!==g.cache&&dh(r,[wn],i,!0),ic(),c=E.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:E.cache},r.updateQueue.baseState=g,r.memoizedState=g,r.flags&256){r=_x(t,r,c,i);break e}else if(c!==h){h=er(Error(a(424)),r),ec(h),r=_x(t,r,c,i);break e}else{switch(t=r.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(qt=ar(t.firstChild),qn=r,yt=!0,Ba=null,sr=!0,i=gy(r,null,c,i),r.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling}else{if($i(),c===h){r=ba(t,r,i);break e}Yn(t,r,c,i)}r=r.child}return r;case 26:return id(t,r),t===null?(i=Db(r.type,null,r.pendingProps,null))?r.memoizedState=i:yt||(i=r.type,t=r.pendingProps,c=wd(ce.current).createElement(i),c[an]=r,c[_n]=t,Qn(c,i,t),on(c),r.stateNode=c):r.memoizedState=Db(r.type,t.memoizedProps,r.pendingProps,t.memoizedState),null;case 27:return he(r),t===null&&yt&&(c=r.stateNode=kb(r.type,r.pendingProps,ce.current),qn=r,sr=!0,h=qt,ni(r.type)?(Rp=h,qt=ar(c.firstChild)):qt=h),Yn(t,r,r.pendingProps.children,i),id(t,r),t===null&&(r.flags|=4194304),r.child;case 5:return t===null&&yt&&((h=c=qt)&&(c=s2(c,r.type,r.pendingProps,sr),c!==null?(r.stateNode=c,qn=r,qt=ar(c.firstChild),sr=!1,h=!0):h=!1),h||Fa(r)),he(r),h=r.type,g=r.pendingProps,E=t!==null?t.memoizedProps:null,c=g.children,Tp(h,g)?c=null:E!==null&&Tp(h,E)&&(r.flags|=32),r.memoizedState!==null&&(h=Sh(t,r,xA,null,null,i),Ic._currentValue=h),id(t,r),Yn(t,r,c,i),r.child;case 6:return t===null&&yt&&((t=i=qt)&&(i=r2(i,r.pendingProps,sr),i!==null?(r.stateNode=i,qn=r,qt=null,t=!0):t=!1),t||Fa(r)),null;case 13:return Ex(t,r,i);case 4:return ie(r,r.stateNode.containerInfo),c=r.pendingProps,t===null?r.child=Xi(r,null,c,i):Yn(t,r,c,i),r.child;case 11:return hx(t,r,r.type,r.pendingProps,i);case 7:return Yn(t,r,r.pendingProps,i),r.child;case 8:return Yn(t,r,r.pendingProps.children,i),r.child;case 12:return Yn(t,r,r.pendingProps.children,i),r.child;case 10:return c=r.pendingProps,Ha(r,r.type,c.value),Yn(t,r,c.children,i),r.child;case 9:return h=r.type._context,c=r.pendingProps.children,Qi(r),h=$n(h),c=c(h),r.flags|=1,Yn(t,r,c,i),r.child;case 14:return px(t,r,r.type,r.pendingProps,i);case 15:return mx(t,r,r.type,r.pendingProps,i);case 19:return Sx(t,r,i);case 31:return AA(t,r,i);case 22:return gx(t,r,i,r.pendingProps);case 24:return Qi(r),c=$n(wn),t===null?(h=ph(),h===null&&(h=Bt,g=fh(),h.pooledCache=g,g.refCount++,g!==null&&(h.pooledCacheLanes|=i),h=g),r.memoizedState={parent:c,cache:h},gh(r),Ha(r,wn,h)):((t.lanes&i)!==0&&(yh(t,r),oc(r,null,null,i),ic()),h=t.memoizedState,g=r.memoizedState,h.parent!==c?(h={parent:c,cache:c},r.memoizedState=h,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=h),Ha(r,wn,c)):(c=g.cache,Ha(r,wn,c),c!==h.cache&&dh(r,[wn],i,!0))),Yn(t,r,r.pendingProps.children,i),r.child;case 29:throw r.pendingProps}throw Error(a(156,r.tag))}function va(t){t.flags|=4}function Xh(t,r,i,c,h){if((r=(t.mode&32)!==0)&&(r=!1),r){if(t.flags|=16777216,(h&335544128)===h)if(t.stateNode.complete)t.flags|=8192;else if(Xx())t.flags|=8192;else throw Zi=qu,mh}else t.flags&=-16777217}function Ax(t,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!Bb(r))if(Xx())t.flags|=8192;else throw Zi=qu,mh}function ld(t,r){r!==null&&(t.flags|=4),t.flags&16384&&(r=t.tag!==22?bs():536870912,t.lanes|=r,el|=r)}function hc(t,r){if(!yt)switch(t.tailMode){case"hidden":r=t.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function $t(t){var r=t.alternate!==null&&t.alternate.child===t.child,i=0,c=0;if(r)for(var h=t.child;h!==null;)i|=h.lanes|h.childLanes,c|=h.subtreeFlags&65011712,c|=h.flags&65011712,h.return=t,h=h.sibling;else for(h=t.child;h!==null;)i|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=t,h=h.sibling;return t.subtreeFlags|=c,t.childLanes=i,r}function NA(t,r,i){var c=r.pendingProps;switch(ih(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $t(r),null;case 1:return $t(r),null;case 3:return i=r.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),ga(wn),Ae(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Bo(r)?va(r):t===null||t.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,lh())),$t(r),null;case 26:var h=r.type,g=r.memoizedState;return t===null?(va(r),g!==null?($t(r),Ax(r,g)):($t(r),Xh(r,h,null,c,i))):g?g!==t.memoizedState?(va(r),$t(r),Ax(r,g)):($t(r),r.flags&=-16777217):(t=t.memoizedProps,t!==c&&va(r),$t(r),Xh(r,h,t,c,i)),null;case 27:if(xe(r),i=ce.current,h=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==c&&va(r);else{if(!c){if(r.stateNode===null)throw Error(a(166));return $t(r),null}t=X.current,Bo(r)?ay(r):(t=kb(h,c,i),r.stateNode=t,va(r))}return $t(r),null;case 5:if(xe(r),h=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==c&&va(r);else{if(!c){if(r.stateNode===null)throw Error(a(166));return $t(r),null}if(g=X.current,Bo(r))ay(r);else{var E=wd(ce.current);switch(g){case 1:g=E.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:g=E.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":g=E.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":g=E.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":g=E.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof c.is=="string"?E.createElement("select",{is:c.is}):E.createElement("select"),c.multiple?g.multiple=!0:c.size&&(g.size=c.size);break;default:g=typeof c.is=="string"?E.createElement(h,{is:c.is}):E.createElement(h)}}g[an]=r,g[_n]=c;e:for(E=r.child;E!==null;){if(E.tag===5||E.tag===6)g.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===r)break e;for(;E.sibling===null;){if(E.return===null||E.return===r)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}r.stateNode=g;e:switch(Qn(g,h,c),h){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&va(r)}}return $t(r),Xh(r,r.type,t===null?null:t.memoizedProps,r.pendingProps,i),null;case 6:if(t&&r.stateNode!=null)t.memoizedProps!==c&&va(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(a(166));if(t=ce.current,Bo(r)){if(t=r.stateNode,i=r.memoizedProps,c=null,h=qn,h!==null)switch(h.tag){case 27:case 5:c=h.memoizedProps}t[an]=r,t=!!(t.nodeValue===i||c!==null&&c.suppressHydrationWarning===!0||Eb(t.nodeValue,i)),t||Fa(r,!0)}else t=wd(t).createTextNode(c),t[an]=r,r.stateNode=t}return $t(r),null;case 31:if(i=r.memoizedState,t===null||t.memoizedState!==null){if(c=Bo(r),i!==null){if(t===null){if(!c)throw Error(a(318));if(t=r.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(a(557));t[an]=r}else $i(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;$t(r),t=!1}else i=lh(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=i),t=!0;if(!t)return r.flags&256?(Ms(r),r):(Ms(r),null);if((r.flags&128)!==0)throw Error(a(558))}return $t(r),null;case 13:if(c=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(h=Bo(r),c!==null&&c.dehydrated!==null){if(t===null){if(!h)throw Error(a(318));if(h=r.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(a(317));h[an]=r}else $i(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;$t(r),h=!1}else h=lh(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=h),h=!0;if(!h)return r.flags&256?(Ms(r),r):(Ms(r),null)}return Ms(r),(r.flags&128)!==0?(r.lanes=i,r):(i=c!==null,t=t!==null&&t.memoizedState!==null,i&&(c=r.child,h=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(h=c.alternate.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==h&&(c.flags|=2048)),i!==t&&i&&(r.child.flags|=8192),ld(r,r.updateQueue),$t(r),null);case 4:return Ae(),t===null&&vp(r.stateNode.containerInfo),$t(r),null;case 10:return ga(r.type),$t(r),null;case 19:if(V(yn),c=r.memoizedState,c===null)return $t(r),null;if(h=(r.flags&128)!==0,g=c.rendering,g===null)if(h)hc(c,!1);else{if(dn!==0||t!==null&&(t.flags&128)!==0)for(t=r.child;t!==null;){if(g=Wu(t),g!==null){for(r.flags|=128,hc(c,!1),t=g.updateQueue,r.updateQueue=t,ld(r,t),r.subtreeFlags=0,t=i,i=r.child;i!==null;)ey(i,t),i=i.sibling;return q(yn,yn.current&1|2),yt&&pa(r,c.treeForkCount),r.child}t=t.sibling}c.tail!==null&&Ze()>hd&&(r.flags|=128,h=!0,hc(c,!1),r.lanes=4194304)}else{if(!h)if(t=Wu(g),t!==null){if(r.flags|=128,h=!0,t=t.updateQueue,r.updateQueue=t,ld(r,t),hc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!g.alternate&&!yt)return $t(r),null}else 2*Ze()-c.renderingStartTime>hd&&i!==536870912&&(r.flags|=128,h=!0,hc(c,!1),r.lanes=4194304);c.isBackwards?(g.sibling=r.child,r.child=g):(t=c.last,t!==null?t.sibling=g:r.child=g,c.last=g)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Ze(),t.sibling=null,i=yn.current,q(yn,h?i&1|2:i&1),yt&&pa(r,c.treeForkCount),t):($t(r),null);case 22:case 23:return Ms(r),_h(),c=r.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(i&536870912)!==0&&(r.flags&128)===0&&($t(r),r.subtreeFlags&6&&(r.flags|=8192)):$t(r),i=r.updateQueue,i!==null&&ld(r,i.retryQueue),i=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==i&&(r.flags|=2048),t!==null&&V(Wi),null;case 24:return i=null,t!==null&&(i=t.memoizedState.cache),r.memoizedState.cache!==i&&(r.flags|=2048),ga(wn),$t(r),null;case 25:return null;case 30:return null}throw Error(a(156,r.tag))}function CA(t,r){switch(ih(r),r.tag){case 1:return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return ga(wn),Ae(),t=r.flags,(t&65536)!==0&&(t&128)===0?(r.flags=t&-65537|128,r):null;case 26:case 27:case 5:return xe(r),null;case 31:if(r.memoizedState!==null){if(Ms(r),r.alternate===null)throw Error(a(340));$i()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 13:if(Ms(r),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(a(340));$i()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return V(yn),null;case 4:return Ae(),null;case 10:return ga(r.type),null;case 22:case 23:return Ms(r),_h(),t!==null&&V(Wi),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 24:return ga(wn),null;case 25:return null;default:return null}}function Ix(t,r){switch(ih(r),r.tag){case 3:ga(wn),Ae();break;case 26:case 27:case 5:xe(r);break;case 4:Ae();break;case 31:r.memoizedState!==null&&Ms(r);break;case 13:Ms(r);break;case 19:V(yn);break;case 10:ga(r.type);break;case 22:case 23:Ms(r),_h(),t!==null&&V(Wi);break;case 24:ga(wn)}}function pc(t,r){try{var i=r.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var h=c.next;i=h;do{if((i.tag&t)===t){c=void 0;var g=i.create,E=i.inst;c=g(),E.destroy=c}i=i.next}while(i!==h)}}catch(k){Dt(r,r.return,k)}}function Wa(t,r,i){try{var c=r.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&t)===t){var E=c.inst,k=E.destroy;if(k!==void 0){E.destroy=void 0,h=r;var $=i,ne=k;try{ne()}catch(ge){Dt(h,$,ge)}}}c=c.next}while(c!==g)}}catch(ge){Dt(r,r.return,ge)}}function Nx(t){var r=t.updateQueue;if(r!==null){var i=t.stateNode;try{xy(r,i)}catch(c){Dt(t,t.return,c)}}}function Cx(t,r,i){i.props=eo(t.type,t.memoizedProps),i.state=t.memoizedState;try{i.componentWillUnmount()}catch(c){Dt(t,r,c)}}function mc(t,r){try{var i=t.ref;if(i!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof i=="function"?t.refCleanup=i(c):i.current=c}}catch(h){Dt(t,r,h)}}function Hr(t,r){var i=t.ref,c=t.refCleanup;if(i!==null)if(typeof c=="function")try{c()}catch(h){Dt(t,r,h)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(h){Dt(t,r,h)}else i.current=null}function Rx(t){var r=t.type,i=t.memoizedProps,c=t.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":i.autoFocus&&c.focus();break e;case"img":i.src?c.src=i.src:i.srcSet&&(c.srcset=i.srcSet)}}catch(h){Dt(t,t.return,h)}}function Jh(t,r,i){try{var c=t.stateNode;ZA(c,t.type,i,r),c[_n]=r}catch(h){Dt(t,t.return,h)}}function Ox(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&ni(t.type)||t.tag===4}function ep(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Ox(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&ni(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function tp(t,r,i){var c=t.tag;if(c===5||c===6)t=t.stateNode,r?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(t,r):(r=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,r.appendChild(t),i=i._reactRootContainer,i!=null||r.onclick!==null||(r.onclick=kt));else if(c!==4&&(c===27&&ni(t.type)&&(i=t.stateNode,r=null),t=t.child,t!==null))for(tp(t,r,i),t=t.sibling;t!==null;)tp(t,r,i),t=t.sibling}function cd(t,r,i){var c=t.tag;if(c===5||c===6)t=t.stateNode,r?i.insertBefore(t,r):i.appendChild(t);else if(c!==4&&(c===27&&ni(t.type)&&(i=t.stateNode),t=t.child,t!==null))for(cd(t,r,i),t=t.sibling;t!==null;)cd(t,r,i),t=t.sibling}function jx(t){var r=t.stateNode,i=t.memoizedProps;try{for(var c=t.type,h=r.attributes;h.length;)r.removeAttributeNode(h[0]);Qn(r,c,i),r[an]=t,r[_n]=i}catch(g){Dt(t,t.return,g)}}var _a=!1,An=!1,np=!1,kx=typeof WeakSet=="function"?WeakSet:Set,Pn=null;function RA(t,r){if(t=t.containerInfo,wp=Rd,t=q0(t),Wf(t)){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else e:{i=(i=t.ownerDocument)&&i.defaultView||window;var c=i.getSelection&&i.getSelection();if(c&&c.rangeCount!==0){i=c.anchorNode;var h=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{i.nodeType,g.nodeType}catch{i=null;break e}var E=0,k=-1,$=-1,ne=0,ge=0,Ee=t,ae=null;t:for(;;){for(var ue;Ee!==i||h!==0&&Ee.nodeType!==3||(k=E+h),Ee!==g||c!==0&&Ee.nodeType!==3||($=E+c),Ee.nodeType===3&&(E+=Ee.nodeValue.length),(ue=Ee.firstChild)!==null;)ae=Ee,Ee=ue;for(;;){if(Ee===t)break t;if(ae===i&&++ne===h&&(k=E),ae===g&&++ge===c&&($=E),(ue=Ee.nextSibling)!==null)break;Ee=ae,ae=Ee.parentNode}Ee=ue}i=k===-1||$===-1?null:{start:k,end:$}}else i=null}i=i||{start:0,end:0}}else i=null;for(Sp={focusedElem:t,selectionRange:i},Rd=!1,Pn=r;Pn!==null;)if(r=Pn,t=r.child,(r.subtreeFlags&1028)!==0&&t!==null)t.return=r,Pn=t;else for(;Pn!==null;){switch(r=Pn,g=r.alternate,t=r.flags,r.tag){case 0:if((t&4)!==0&&(t=r.updateQueue,t=t!==null?t.events:null,t!==null))for(i=0;i<t.length;i++)h=t[i],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&g!==null){t=void 0,i=r,h=g.memoizedProps,g=g.memoizedState,c=i.stateNode;try{var Ue=eo(i.type,h);t=c.getSnapshotBeforeUpdate(Ue,g),c.__reactInternalSnapshotBeforeUpdate=t}catch(We){Dt(i,i.return,We)}}break;case 3:if((t&1024)!==0){if(t=r.stateNode.containerInfo,i=t.nodeType,i===9)Ip(t);else if(i===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Ip(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(a(163))}if(t=r.sibling,t!==null){t.return=r.return,Pn=t;break}Pn=r.return}}function Lx(t,r,i){var c=i.flags;switch(i.tag){case 0:case 11:case 15:wa(t,i),c&4&&pc(5,i);break;case 1:if(wa(t,i),c&4)if(t=i.stateNode,r===null)try{t.componentDidMount()}catch(E){Dt(i,i.return,E)}else{var h=eo(i.type,r.memoizedProps);r=r.memoizedState;try{t.componentDidUpdate(h,r,t.__reactInternalSnapshotBeforeUpdate)}catch(E){Dt(i,i.return,E)}}c&64&&Nx(i),c&512&&mc(i,i.return);break;case 3:if(wa(t,i),c&64&&(t=i.updateQueue,t!==null)){if(r=null,i.child!==null)switch(i.child.tag){case 27:case 5:r=i.child.stateNode;break;case 1:r=i.child.stateNode}try{xy(t,r)}catch(E){Dt(i,i.return,E)}}break;case 27:r===null&&c&4&&jx(i);case 26:case 5:wa(t,i),r===null&&c&4&&Rx(i),c&512&&mc(i,i.return);break;case 12:wa(t,i);break;case 31:wa(t,i),c&4&&Ux(t,i);break;case 13:wa(t,i),c&4&&Px(t,i),c&64&&(t=i.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(i=VA.bind(null,i),a2(t,i))));break;case 22:if(c=i.memoizedState!==null||_a,!c){r=r!==null&&r.memoizedState!==null||An,h=_a;var g=An;_a=c,(An=r)&&!g?Sa(t,i,(i.subtreeFlags&8772)!==0):wa(t,i),_a=h,An=g}break;case 30:break;default:wa(t,i)}}function Mx(t){var r=t.alternate;r!==null&&(t.alternate=null,Mx(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&aa(r)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Zt=null,_s=!1;function Ea(t,r,i){for(i=i.child;i!==null;)Dx(t,r,i),i=i.sibling}function Dx(t,r,i){if(be&&typeof be.onCommitFiberUnmount=="function")try{be.onCommitFiberUnmount(pn,i)}catch{}switch(i.tag){case 26:An||Hr(i,r),Ea(t,r,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:An||Hr(i,r);var c=Zt,h=_s;ni(i.type)&&(Zt=i.stateNode,_s=!1),Ea(t,r,i),Sc(i.stateNode),Zt=c,_s=h;break;case 5:An||Hr(i,r);case 6:if(c=Zt,h=_s,Zt=null,Ea(t,r,i),Zt=c,_s=h,Zt!==null)if(_s)try{(Zt.nodeType===9?Zt.body:Zt.nodeName==="HTML"?Zt.ownerDocument.body:Zt).removeChild(i.stateNode)}catch(g){Dt(i,r,g)}else try{Zt.removeChild(i.stateNode)}catch(g){Dt(i,r,g)}break;case 18:Zt!==null&&(_s?(t=Zt,Nb(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,i.stateNode),ll(t)):Nb(Zt,i.stateNode));break;case 4:c=Zt,h=_s,Zt=i.stateNode.containerInfo,_s=!0,Ea(t,r,i),Zt=c,_s=h;break;case 0:case 11:case 14:case 15:Wa(2,i,r),An||Wa(4,i,r),Ea(t,r,i);break;case 1:An||(Hr(i,r),c=i.stateNode,typeof c.componentWillUnmount=="function"&&Cx(i,r,c)),Ea(t,r,i);break;case 21:Ea(t,r,i);break;case 22:An=(c=An)||i.memoizedState!==null,Ea(t,r,i),An=c;break;default:Ea(t,r,i)}}function Ux(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{ll(t)}catch(i){Dt(r,r.return,i)}}}function Px(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{ll(t)}catch(i){Dt(r,r.return,i)}}function OA(t){switch(t.tag){case 31:case 13:case 19:var r=t.stateNode;return r===null&&(r=t.stateNode=new kx),r;case 22:return t=t.stateNode,r=t._retryCache,r===null&&(r=t._retryCache=new kx),r;default:throw Error(a(435,t.tag))}}function ud(t,r){var i=OA(t);r.forEach(function(c){if(!i.has(c)){i.add(c);var h=zA.bind(null,t,c);c.then(h,h)}})}function Es(t,r){var i=r.deletions;if(i!==null)for(var c=0;c<i.length;c++){var h=i[c],g=t,E=r,k=E;e:for(;k!==null;){switch(k.tag){case 27:if(ni(k.type)){Zt=k.stateNode,_s=!1;break e}break;case 5:Zt=k.stateNode,_s=!1;break e;case 3:case 4:Zt=k.stateNode.containerInfo,_s=!0;break e}k=k.return}if(Zt===null)throw Error(a(160));Dx(g,E,h),Zt=null,_s=!1,g=h.alternate,g!==null&&(g.return=null),h.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Vx(r,t),r=r.sibling}var vr=null;function Vx(t,r){var i=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Es(r,t),ws(t),c&4&&(Wa(3,t,t.return),pc(3,t),Wa(5,t,t.return));break;case 1:Es(r,t),ws(t),c&512&&(An||i===null||Hr(i,i.return)),c&64&&_a&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(i=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=i===null?c:i.concat(c))));break;case 26:var h=vr;if(Es(r,t),ws(t),c&512&&(An||i===null||Hr(i,i.return)),c&4){var g=i!==null?i.memoizedState:null;if(c=t.memoizedState,i===null)if(c===null)if(t.stateNode===null){e:{c=t.type,i=t.memoizedProps,h=h.ownerDocument||h;t:switch(c){case"title":g=h.getElementsByTagName("title")[0],(!g||g[Os]||g[an]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=h.createElement(c),h.head.insertBefore(g,h.querySelector("head > title"))),Qn(g,c,i),g[an]=t,on(g),c=g;break e;case"link":var E=Vb("link","href",h).get(c+(i.href||""));if(E){for(var k=0;k<E.length;k++)if(g=E[k],g.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&g.getAttribute("rel")===(i.rel==null?null:i.rel)&&g.getAttribute("title")===(i.title==null?null:i.title)&&g.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){E.splice(k,1);break t}}g=h.createElement(c),Qn(g,c,i),h.head.appendChild(g);break;case"meta":if(E=Vb("meta","content",h).get(c+(i.content||""))){for(k=0;k<E.length;k++)if(g=E[k],g.getAttribute("content")===(i.content==null?null:""+i.content)&&g.getAttribute("name")===(i.name==null?null:i.name)&&g.getAttribute("property")===(i.property==null?null:i.property)&&g.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&g.getAttribute("charset")===(i.charSet==null?null:i.charSet)){E.splice(k,1);break t}}g=h.createElement(c),Qn(g,c,i),h.head.appendChild(g);break;default:throw Error(a(468,c))}g[an]=t,on(g),c=g}t.stateNode=c}else zb(h,t.type,t.stateNode);else t.stateNode=Pb(h,c,t.memoizedProps);else g!==c?(g===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):g.count--,c===null?zb(h,t.type,t.stateNode):Pb(h,c,t.memoizedProps)):c===null&&t.stateNode!==null&&Jh(t,t.memoizedProps,i.memoizedProps)}break;case 27:Es(r,t),ws(t),c&512&&(An||i===null||Hr(i,i.return)),i!==null&&c&4&&Jh(t,t.memoizedProps,i.memoizedProps);break;case 5:if(Es(r,t),ws(t),c&512&&(An||i===null||Hr(i,i.return)),t.flags&32){h=t.stateNode;try{cs(h,"")}catch(Ue){Dt(t,t.return,Ue)}}c&4&&t.stateNode!=null&&(h=t.memoizedProps,Jh(t,h,i!==null?i.memoizedProps:h)),c&1024&&(np=!0);break;case 6:if(Es(r,t),ws(t),c&4){if(t.stateNode===null)throw Error(a(162));c=t.memoizedProps,i=t.stateNode;try{i.nodeValue=c}catch(Ue){Dt(t,t.return,Ue)}}break;case 3:if(Ad=null,h=vr,vr=Sd(r.containerInfo),Es(r,t),vr=h,ws(t),c&4&&i!==null&&i.memoizedState.isDehydrated)try{ll(r.containerInfo)}catch(Ue){Dt(t,t.return,Ue)}np&&(np=!1,zx(t));break;case 4:c=vr,vr=Sd(t.stateNode.containerInfo),Es(r,t),ws(t),vr=c;break;case 12:Es(r,t),ws(t);break;case 31:Es(r,t),ws(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,ud(t,c)));break;case 13:Es(r,t),ws(t),t.child.flags&8192&&t.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(fd=Ze()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,ud(t,c)));break;case 22:h=t.memoizedState!==null;var $=i!==null&&i.memoizedState!==null,ne=_a,ge=An;if(_a=ne||h,An=ge||$,Es(r,t),An=ge,_a=ne,ws(t),c&8192)e:for(r=t.stateNode,r._visibility=h?r._visibility&-2:r._visibility|1,h&&(i===null||$||_a||An||to(t)),i=null,r=t;;){if(r.tag===5||r.tag===26){if(i===null){$=i=r;try{if(g=$.stateNode,h)E=g.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{k=$.stateNode;var Ee=$.memoizedProps.style,ae=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;k.style.display=ae==null||typeof ae=="boolean"?"":(""+ae).trim()}}catch(Ue){Dt($,$.return,Ue)}}}else if(r.tag===6){if(i===null){$=r;try{$.stateNode.nodeValue=h?"":$.memoizedProps}catch(Ue){Dt($,$.return,Ue)}}}else if(r.tag===18){if(i===null){$=r;try{var ue=$.stateNode;h?Cb(ue,!0):Cb($.stateNode,!1)}catch(Ue){Dt($,$.return,Ue)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===t)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;i===r&&(i=null),r=r.return}i===r&&(i=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=t.updateQueue,c!==null&&(i=c.retryQueue,i!==null&&(c.retryQueue=null,ud(t,i))));break;case 19:Es(r,t),ws(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,ud(t,c)));break;case 30:break;case 21:break;default:Es(r,t),ws(t)}}function ws(t){var r=t.flags;if(r&2){try{for(var i,c=t.return;c!==null;){if(Ox(c)){i=c;break}c=c.return}if(i==null)throw Error(a(160));switch(i.tag){case 27:var h=i.stateNode,g=ep(t);cd(t,g,h);break;case 5:var E=i.stateNode;i.flags&32&&(cs(E,""),i.flags&=-33);var k=ep(t);cd(t,k,E);break;case 3:case 4:var $=i.stateNode.containerInfo,ne=ep(t);tp(t,ne,$);break;default:throw Error(a(161))}}catch(ge){Dt(t,t.return,ge)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function zx(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var r=t;zx(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),t=t.sibling}}function wa(t,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Lx(t,r.alternate,r),r=r.sibling}function to(t){for(t=t.child;t!==null;){var r=t;switch(r.tag){case 0:case 11:case 14:case 15:Wa(4,r,r.return),to(r);break;case 1:Hr(r,r.return);var i=r.stateNode;typeof i.componentWillUnmount=="function"&&Cx(r,r.return,i),to(r);break;case 27:Sc(r.stateNode);case 26:case 5:Hr(r,r.return),to(r);break;case 22:r.memoizedState===null&&to(r);break;case 30:to(r);break;default:to(r)}t=t.sibling}}function Sa(t,r,i){for(i=i&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,h=t,g=r,E=g.flags;switch(g.tag){case 0:case 11:case 15:Sa(h,g,i),pc(4,g);break;case 1:if(Sa(h,g,i),c=g,h=c.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(ne){Dt(c,c.return,ne)}if(c=g,h=c.updateQueue,h!==null){var k=c.stateNode;try{var $=h.shared.hiddenCallbacks;if($!==null)for(h.shared.hiddenCallbacks=null,h=0;h<$.length;h++)yy($[h],k)}catch(ne){Dt(c,c.return,ne)}}i&&E&64&&Nx(g),mc(g,g.return);break;case 27:jx(g);case 26:case 5:Sa(h,g,i),i&&c===null&&E&4&&Rx(g),mc(g,g.return);break;case 12:Sa(h,g,i);break;case 31:Sa(h,g,i),i&&E&4&&Ux(h,g);break;case 13:Sa(h,g,i),i&&E&4&&Px(h,g);break;case 22:g.memoizedState===null&&Sa(h,g,i),mc(g,g.return);break;case 30:break;default:Sa(h,g,i)}r=r.sibling}}function sp(t,r){var i=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),t=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(t=r.memoizedState.cachePool.pool),t!==i&&(t!=null&&t.refCount++,i!=null&&tc(i))}function rp(t,r){t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&tc(t))}function _r(t,r,i,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Bx(t,r,i,c),r=r.sibling}function Bx(t,r,i,c){var h=r.flags;switch(r.tag){case 0:case 11:case 15:_r(t,r,i,c),h&2048&&pc(9,r);break;case 1:_r(t,r,i,c);break;case 3:_r(t,r,i,c),h&2048&&(t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&tc(t)));break;case 12:if(h&2048){_r(t,r,i,c),t=r.stateNode;try{var g=r.memoizedProps,E=g.id,k=g.onPostCommit;typeof k=="function"&&k(E,r.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch($){Dt(r,r.return,$)}}else _r(t,r,i,c);break;case 31:_r(t,r,i,c);break;case 13:_r(t,r,i,c);break;case 23:break;case 22:g=r.stateNode,E=r.alternate,r.memoizedState!==null?g._visibility&2?_r(t,r,i,c):gc(t,r):g._visibility&2?_r(t,r,i,c):(g._visibility|=2,Zo(t,r,i,c,(r.subtreeFlags&10256)!==0||!1)),h&2048&&sp(E,r);break;case 24:_r(t,r,i,c),h&2048&&rp(r.alternate,r);break;default:_r(t,r,i,c)}}function Zo(t,r,i,c,h){for(h=h&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var g=t,E=r,k=i,$=c,ne=E.flags;switch(E.tag){case 0:case 11:case 15:Zo(g,E,k,$,h),pc(8,E);break;case 23:break;case 22:var ge=E.stateNode;E.memoizedState!==null?ge._visibility&2?Zo(g,E,k,$,h):gc(g,E):(ge._visibility|=2,Zo(g,E,k,$,h)),h&&ne&2048&&sp(E.alternate,E);break;case 24:Zo(g,E,k,$,h),h&&ne&2048&&rp(E.alternate,E);break;default:Zo(g,E,k,$,h)}r=r.sibling}}function gc(t,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var i=t,c=r,h=c.flags;switch(c.tag){case 22:gc(i,c),h&2048&&sp(c.alternate,c);break;case 24:gc(i,c),h&2048&&rp(c.alternate,c);break;default:gc(i,c)}r=r.sibling}}var yc=8192;function Xo(t,r,i){if(t.subtreeFlags&yc)for(t=t.child;t!==null;)Fx(t,r,i),t=t.sibling}function Fx(t,r,i){switch(t.tag){case 26:Xo(t,r,i),t.flags&yc&&t.memoizedState!==null&&y2(i,vr,t.memoizedState,t.memoizedProps);break;case 5:Xo(t,r,i);break;case 3:case 4:var c=vr;vr=Sd(t.stateNode.containerInfo),Xo(t,r,i),vr=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=yc,yc=16777216,Xo(t,r,i),yc=c):Xo(t,r,i));break;default:Xo(t,r,i)}}function Hx(t){var r=t.alternate;if(r!==null&&(t=r.child,t!==null)){r.child=null;do r=t.sibling,t.sibling=null,t=r;while(t!==null)}}function xc(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var i=0;i<r.length;i++){var c=r[i];Pn=c,qx(c,t)}Hx(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Gx(t),t=t.sibling}function Gx(t){switch(t.tag){case 0:case 11:case 15:xc(t),t.flags&2048&&Wa(9,t,t.return);break;case 3:xc(t);break;case 12:xc(t);break;case 22:var r=t.stateNode;t.memoizedState!==null&&r._visibility&2&&(t.return===null||t.return.tag!==13)?(r._visibility&=-3,dd(t)):xc(t);break;default:xc(t)}}function dd(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var i=0;i<r.length;i++){var c=r[i];Pn=c,qx(c,t)}Hx(t)}for(t=t.child;t!==null;){switch(r=t,r.tag){case 0:case 11:case 15:Wa(8,r,r.return),dd(r);break;case 22:i=r.stateNode,i._visibility&2&&(i._visibility&=-3,dd(r));break;default:dd(r)}t=t.sibling}}function qx(t,r){for(;Pn!==null;){var i=Pn;switch(i.tag){case 0:case 11:case 15:Wa(8,i,r);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var c=i.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:tc(i.memoizedState.cache)}if(c=i.child,c!==null)c.return=i,Pn=c;else e:for(i=t;Pn!==null;){c=Pn;var h=c.sibling,g=c.return;if(Mx(c),c===i){Pn=null;break e}if(h!==null){h.return=g,Pn=h;break e}Pn=g}}}var jA={getCacheForType:function(t){var r=$n(wn),i=r.data.get(t);return i===void 0&&(i=t(),r.data.set(t,i)),i},cacheSignal:function(){return $n(wn).controller.signal}},kA=typeof WeakMap=="function"?WeakMap:Map,jt=0,Bt=null,ft=null,pt=0,Mt=0,Ds=null,Ka=!1,Jo=!1,ap=!1,Ta=0,dn=0,Za=0,no=0,ip=0,Us=0,el=0,bc=null,Ss=null,op=!1,fd=0,$x=0,hd=1/0,pd=null,Xa=null,jn=0,Ja=null,tl=null,Aa=0,lp=0,cp=null,Yx=null,vc=0,up=null;function Ps(){return(jt&2)!==0&&pt!==0?pt&-pt:B.T!==null?gp():Rs()}function Qx(){if(Us===0)if((pt&536870912)===0||yt){var t=dt;dt<<=1,(dt&3932160)===0&&(dt=262144),Us=t}else Us=536870912;return t=Ls.current,t!==null&&(t.flags|=32),Us}function Ts(t,r,i){(t===Bt&&(Mt===2||Mt===9)||t.cancelPendingCommit!==null)&&(nl(t,0),ei(t,pt,Us,!1)),Hn(t,i),((jt&2)===0||t!==Bt)&&(t===Bt&&((jt&2)===0&&(no|=i),dn===4&&ei(t,pt,Us,!1)),Gr(t))}function Wx(t,r,i){if((jt&6)!==0)throw Error(a(327));var c=!i&&(r&127)===0&&(r&t.expiredLanes)===0||rn(t,r),h=c?DA(t,r):fp(t,r,!0),g=c;do{if(h===0){Jo&&!c&&ei(t,r,0,!1);break}else{if(i=t.current.alternate,g&&!LA(i)){h=fp(t,r,!1),g=!1;continue}if(h===2){if(g=r,t.errorRecoveryDisabledLanes&g)var E=0;else E=t.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){r=E;e:{var k=t;h=bc;var $=k.current.memoizedState.isDehydrated;if($&&(nl(k,E).flags|=256),E=fp(k,E,!1),E!==2){if(ap&&!$){k.errorRecoveryDisabledLanes|=g,no|=g,h=4;break e}g=Ss,Ss=h,g!==null&&(Ss===null?Ss=g:Ss.push.apply(Ss,g))}h=E}if(g=!1,h!==2)continue}}if(h===1){nl(t,0),ei(t,r,0,!0);break}e:{switch(c=t,g=h,g){case 0:case 1:throw Error(a(345));case 4:if((r&4194048)!==r)break;case 6:ei(c,r,Us,!Ka);break e;case 2:Ss=null;break;case 3:case 5:break;default:throw Error(a(329))}if((r&62914560)===r&&(h=fd+300-Ze(),10<h)){if(ei(c,r,Us,!Ka),gt(c,0,!0)!==0)break e;Aa=r,c.timeoutHandle=Ab(Kx.bind(null,c,i,Ss,pd,op,r,Us,no,el,Ka,g,"Throttled",-0,0),h);break e}Kx(c,i,Ss,pd,op,r,Us,no,el,Ka,g,null,-0,0)}}break}while(!0);Gr(t)}function Kx(t,r,i,c,h,g,E,k,$,ne,ge,Ee,ae,ue){if(t.timeoutHandle=-1,Ee=r.subtreeFlags,Ee&8192||(Ee&16785408)===16785408){Ee={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:kt},Fx(r,g,Ee);var Ue=(g&62914560)===g?fd-Ze():(g&4194048)===g?$x-Ze():0;if(Ue=x2(Ee,Ue),Ue!==null){Aa=g,t.cancelPendingCommit=Ue(rb.bind(null,t,r,g,i,c,h,E,k,$,ge,Ee,null,ae,ue)),ei(t,g,E,!ne);return}}rb(t,r,g,i,c,h,E,k,$)}function LA(t){for(var r=t;;){var i=r.tag;if((i===0||i===11||i===15)&&r.flags&16384&&(i=r.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var c=0;c<i.length;c++){var h=i[c],g=h.getSnapshot;h=h.value;try{if(!js(g(),h))return!1}catch{return!1}}if(i=r.child,r.subtreeFlags&16384&&i!==null)i.return=r,r=i;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function ei(t,r,i,c){r&=~ip,r&=~no,t.suspendedLanes|=r,t.pingedLanes&=~r,c&&(t.warmLanes|=r),c=t.expirationTimes;for(var h=r;0<h;){var g=31-Ne(h),E=1<<g;c[g]=-1,h&=~E}i!==0&&Hs(t,i,r)}function md(){return(jt&6)===0?(_c(0),!1):!0}function dp(){if(ft!==null){if(Mt===0)var t=ft.return;else t=ft,ma=Yi=null,Ih(t),$o=null,sc=0,t=ft;for(;t!==null;)Ix(t.alternate,t),t=t.return;ft=null}}function nl(t,r){var i=t.timeoutHandle;i!==-1&&(t.timeoutHandle=-1,e2(i)),i=t.cancelPendingCommit,i!==null&&(t.cancelPendingCommit=null,i()),Aa=0,dp(),Bt=t,ft=i=ha(t.current,null),pt=r,Mt=0,Ds=null,Ka=!1,Jo=rn(t,r),ap=!1,el=Us=ip=no=Za=dn=0,Ss=bc=null,op=!1,(r&8)!==0&&(r|=r&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=r;0<c;){var h=31-Ne(c),g=1<<h;r|=t[h],c&=~g}return Ta=r,Du(),i}function Zx(t,r){lt=null,B.H=dc,r===qo||r===Gu?(r=hy(),Mt=3):r===mh?(r=hy(),Mt=4):Mt=r===Hh?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ds=r,ft===null&&(dn=1,rd(t,er(r,t.current)))}function Xx(){var t=Ls.current;return t===null?!0:(pt&4194048)===pt?rr===null:(pt&62914560)===pt||(pt&536870912)!==0?t===rr:!1}function Jx(){var t=B.H;return B.H=dc,t===null?dc:t}function eb(){var t=B.A;return B.A=jA,t}function gd(){dn=4,Ka||(pt&4194048)!==pt&&Ls.current!==null||(Jo=!0),(Za&134217727)===0&&(no&134217727)===0||Bt===null||ei(Bt,pt,Us,!1)}function fp(t,r,i){var c=jt;jt|=2;var h=Jx(),g=eb();(Bt!==t||pt!==r)&&(pd=null,nl(t,r)),r=!1;var E=dn;e:do try{if(Mt!==0&&ft!==null){var k=ft,$=Ds;switch(Mt){case 8:dp(),E=6;break e;case 3:case 2:case 9:case 6:Ls.current===null&&(r=!0);var ne=Mt;if(Mt=0,Ds=null,sl(t,k,$,ne),i&&Jo){E=0;break e}break;default:ne=Mt,Mt=0,Ds=null,sl(t,k,$,ne)}}MA(),E=dn;break}catch(ge){Zx(t,ge)}while(!0);return r&&t.shellSuspendCounter++,ma=Yi=null,jt=c,B.H=h,B.A=g,ft===null&&(Bt=null,pt=0,Du()),E}function MA(){for(;ft!==null;)tb(ft)}function DA(t,r){var i=jt;jt|=2;var c=Jx(),h=eb();Bt!==t||pt!==r?(pd=null,hd=Ze()+500,nl(t,r)):Jo=rn(t,r);e:do try{if(Mt!==0&&ft!==null){r=ft;var g=Ds;t:switch(Mt){case 1:Mt=0,Ds=null,sl(t,r,g,1);break;case 2:case 9:if(dy(g)){Mt=0,Ds=null,nb(r);break}r=function(){Mt!==2&&Mt!==9||Bt!==t||(Mt=7),Gr(t)},g.then(r,r);break e;case 3:Mt=7;break e;case 4:Mt=5;break e;case 7:dy(g)?(Mt=0,Ds=null,nb(r)):(Mt=0,Ds=null,sl(t,r,g,7));break;case 5:var E=null;switch(ft.tag){case 26:E=ft.memoizedState;case 5:case 27:var k=ft;if(E?Bb(E):k.stateNode.complete){Mt=0,Ds=null;var $=k.sibling;if($!==null)ft=$;else{var ne=k.return;ne!==null?(ft=ne,yd(ne)):ft=null}break t}}Mt=0,Ds=null,sl(t,r,g,5);break;case 6:Mt=0,Ds=null,sl(t,r,g,6);break;case 8:dp(),dn=6;break e;default:throw Error(a(462))}}UA();break}catch(ge){Zx(t,ge)}while(!0);return ma=Yi=null,B.H=c,B.A=h,jt=i,ft!==null?0:(Bt=null,pt=0,Du(),dn)}function UA(){for(;ft!==null&&!rt();)tb(ft)}function tb(t){var r=Tx(t.alternate,t,Ta);t.memoizedProps=t.pendingProps,r===null?yd(t):ft=r}function nb(t){var r=t,i=r.alternate;switch(r.tag){case 15:case 0:r=bx(i,r,r.pendingProps,r.type,void 0,pt);break;case 11:r=bx(i,r,r.pendingProps,r.type.render,r.ref,pt);break;case 5:Ih(r);default:Ix(i,r),r=ft=ey(r,Ta),r=Tx(i,r,Ta)}t.memoizedProps=t.pendingProps,r===null?yd(t):ft=r}function sl(t,r,i,c){ma=Yi=null,Ih(r),$o=null,sc=0;var h=r.return;try{if(TA(t,h,r,i,pt)){dn=1,rd(t,er(i,t.current)),ft=null;return}}catch(g){if(h!==null)throw ft=h,g;dn=1,rd(t,er(i,t.current)),ft=null;return}r.flags&32768?(yt||c===1?t=!0:Jo||(pt&536870912)!==0?t=!1:(Ka=t=!0,(c===2||c===9||c===3||c===6)&&(c=Ls.current,c!==null&&c.tag===13&&(c.flags|=16384))),sb(r,t)):yd(r)}function yd(t){var r=t;do{if((r.flags&32768)!==0){sb(r,Ka);return}t=r.return;var i=NA(r.alternate,r,Ta);if(i!==null){ft=i;return}if(r=r.sibling,r!==null){ft=r;return}ft=r=t}while(r!==null);dn===0&&(dn=5)}function sb(t,r){do{var i=CA(t.alternate,t);if(i!==null){i.flags&=32767,ft=i;return}if(i=t.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!r&&(t=t.sibling,t!==null)){ft=t;return}ft=t=i}while(t!==null);dn=6,ft=null}function rb(t,r,i,c,h,g,E,k,$){t.cancelPendingCommit=null;do xd();while(jn!==0);if((jt&6)!==0)throw Error(a(327));if(r!==null){if(r===t.current)throw Error(a(177));if(g=r.lanes|r.childLanes,g|=eh,ta(t,i,g,E,k,$),t===Bt&&(ft=Bt=null,pt=0),tl=r,Ja=t,Aa=i,lp=g,cp=h,Yx=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,BA(Ht,function(){return cb(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=B.T,B.T=null,h=le.p,le.p=2,E=jt,jt|=4;try{RA(t,r,i)}finally{jt=E,le.p=h,B.T=c}}jn=1,ab(),ib(),ob()}}function ab(){if(jn===1){jn=0;var t=Ja,r=tl,i=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||i){i=B.T,B.T=null;var c=le.p;le.p=2;var h=jt;jt|=4;try{Vx(r,t);var g=Sp,E=q0(t.containerInfo),k=g.focusedElem,$=g.selectionRange;if(E!==k&&k&&k.ownerDocument&&G0(k.ownerDocument.documentElement,k)){if($!==null&&Wf(k)){var ne=$.start,ge=$.end;if(ge===void 0&&(ge=ne),"selectionStart"in k)k.selectionStart=ne,k.selectionEnd=Math.min(ge,k.value.length);else{var Ee=k.ownerDocument||document,ae=Ee&&Ee.defaultView||window;if(ae.getSelection){var ue=ae.getSelection(),Ue=k.textContent.length,We=Math.min($.start,Ue),zt=$.end===void 0?We:Math.min($.end,Ue);!ue.extend&&We>zt&&(E=zt,zt=We,We=E);var J=H0(k,We),K=H0(k,zt);if(J&&K&&(ue.rangeCount!==1||ue.anchorNode!==J.node||ue.anchorOffset!==J.offset||ue.focusNode!==K.node||ue.focusOffset!==K.offset)){var te=Ee.createRange();te.setStart(J.node,J.offset),ue.removeAllRanges(),We>zt?(ue.addRange(te),ue.extend(K.node,K.offset)):(te.setEnd(K.node,K.offset),ue.addRange(te))}}}}for(Ee=[],ue=k;ue=ue.parentNode;)ue.nodeType===1&&Ee.push({element:ue,left:ue.scrollLeft,top:ue.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<Ee.length;k++){var ve=Ee[k];ve.element.scrollLeft=ve.left,ve.element.scrollTop=ve.top}}Rd=!!wp,Sp=wp=null}finally{jt=h,le.p=c,B.T=i}}t.current=r,jn=2}}function ib(){if(jn===2){jn=0;var t=Ja,r=tl,i=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||i){i=B.T,B.T=null;var c=le.p;le.p=2;var h=jt;jt|=4;try{Lx(t,r.alternate,r)}finally{jt=h,le.p=c,B.T=i}}jn=3}}function ob(){if(jn===4||jn===3){jn=0,Tt();var t=Ja,r=tl,i=Aa,c=Yx;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?jn=5:(jn=0,tl=Ja=null,lb(t,t.pendingLanes));var h=t.pendingLanes;if(h===0&&(Xa=null),pr(i),r=r.stateNode,be&&typeof be.onCommitFiberRoot=="function")try{be.onCommitFiberRoot(pn,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=B.T,h=le.p,le.p=2,B.T=null;try{for(var g=t.onRecoverableError,E=0;E<c.length;E++){var k=c[E];g(k.value,{componentStack:k.stack})}}finally{B.T=r,le.p=h}}(Aa&3)!==0&&xd(),Gr(t),h=t.pendingLanes,(i&261930)!==0&&(h&42)!==0?t===up?vc++:(vc=0,up=t):vc=0,_c(0)}}function lb(t,r){(t.pooledCacheLanes&=r)===0&&(r=t.pooledCache,r!=null&&(t.pooledCache=null,tc(r)))}function xd(){return ab(),ib(),ob(),cb()}function cb(){if(jn!==5)return!1;var t=Ja,r=lp;lp=0;var i=pr(Aa),c=B.T,h=le.p;try{le.p=32>i?32:i,B.T=null,i=cp,cp=null;var g=Ja,E=Aa;if(jn=0,tl=Ja=null,Aa=0,(jt&6)!==0)throw Error(a(331));var k=jt;if(jt|=4,Gx(g.current),Bx(g,g.current,E,i),jt=k,_c(0,!1),be&&typeof be.onPostCommitFiberRoot=="function")try{be.onPostCommitFiberRoot(pn,g)}catch{}return!0}finally{le.p=h,B.T=c,lb(t,r)}}function ub(t,r,i){r=er(i,r),r=Fh(t.stateNode,r,2),t=$a(t,r,2),t!==null&&(Hn(t,2),Gr(t))}function Dt(t,r,i){if(t.tag===3)ub(t,t,i);else for(;r!==null;){if(r.tag===3){ub(r,t,i);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Xa===null||!Xa.has(c))){t=er(i,t),i=dx(2),c=$a(r,i,2),c!==null&&(fx(i,c,r,t),Hn(c,2),Gr(c));break}}r=r.return}}function hp(t,r,i){var c=t.pingCache;if(c===null){c=t.pingCache=new kA;var h=new Set;c.set(r,h)}else h=c.get(r),h===void 0&&(h=new Set,c.set(r,h));h.has(i)||(ap=!0,h.add(i),t=PA.bind(null,t,r,i),r.then(t,t))}function PA(t,r,i){var c=t.pingCache;c!==null&&c.delete(r),t.pingedLanes|=t.suspendedLanes&i,t.warmLanes&=~i,Bt===t&&(pt&i)===i&&(dn===4||dn===3&&(pt&62914560)===pt&&300>Ze()-fd?(jt&2)===0&&nl(t,0):ip|=i,el===pt&&(el=0)),Gr(t)}function db(t,r){r===0&&(r=bs()),t=Gi(t,r),t!==null&&(Hn(t,r),Gr(t))}function VA(t){var r=t.memoizedState,i=0;r!==null&&(i=r.retryLane),db(t,i)}function zA(t,r){var i=0;switch(t.tag){case 31:case 13:var c=t.stateNode,h=t.memoizedState;h!==null&&(i=h.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(a(314))}c!==null&&c.delete(r),db(t,i)}function BA(t,r){return re(t,r)}var bd=null,rl=null,pp=!1,vd=!1,mp=!1,ti=0;function Gr(t){t!==rl&&t.next===null&&(rl===null?bd=rl=t:rl=rl.next=t),vd=!0,pp||(pp=!0,HA())}function _c(t,r){if(!mp&&vd){mp=!0;do for(var i=!1,c=bd;c!==null;){if(t!==0){var h=c.pendingLanes;if(h===0)var g=0;else{var E=c.suspendedLanes,k=c.pingedLanes;g=(1<<31-Ne(42|t)+1)-1,g&=h&~(E&~k),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(i=!0,mb(c,g))}else g=pt,g=gt(c,c===Bt?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||rn(c,g)||(i=!0,mb(c,g));c=c.next}while(i);mp=!1}}function FA(){fb()}function fb(){vd=pp=!1;var t=0;ti!==0&&JA()&&(t=ti);for(var r=Ze(),i=null,c=bd;c!==null;){var h=c.next,g=hb(c,r);g===0?(c.next=null,i===null?bd=h:i.next=h,h===null&&(rl=i)):(i=c,(t!==0||(g&3)!==0)&&(vd=!0)),c=h}jn!==0&&jn!==5||_c(t),ti!==0&&(ti=0)}function hb(t,r){for(var i=t.suspendedLanes,c=t.pingedLanes,h=t.expirationTimes,g=t.pendingLanes&-62914561;0<g;){var E=31-Ne(g),k=1<<E,$=h[E];$===-1?((k&i)===0||(k&c)!==0)&&(h[E]=xs(k,r)):$<=r&&(t.expiredLanes|=k),g&=~k}if(r=Bt,i=pt,i=gt(t,t===r?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,i===0||t===r&&(Mt===2||Mt===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&Fe(c),t.callbackNode=null,t.callbackPriority=0;if((i&3)===0||rn(t,i)){if(r=i&-i,r===t.callbackPriority)return r;switch(c!==null&&Fe(c),pr(i)){case 2:case 8:i=At;break;case 32:i=Ht;break;case 268435456:i=hr;break;default:i=Ht}return c=pb.bind(null,t),i=re(i,c),t.callbackPriority=r,t.callbackNode=i,r}return c!==null&&c!==null&&Fe(c),t.callbackPriority=2,t.callbackNode=null,2}function pb(t,r){if(jn!==0&&jn!==5)return t.callbackNode=null,t.callbackPriority=0,null;var i=t.callbackNode;if(xd()&&t.callbackNode!==i)return null;var c=pt;return c=gt(t,t===Bt?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(Wx(t,c,r),hb(t,Ze()),t.callbackNode!=null&&t.callbackNode===i?pb.bind(null,t):null)}function mb(t,r){if(xd())return null;Wx(t,r,!0)}function HA(){t2(function(){(jt&6)!==0?re(ut,FA):fb()})}function gp(){if(ti===0){var t=Ho;t===0&&(t=It,It<<=1,(It&261888)===0&&(It=256)),ti=t}return ti}function gb(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:Qe(""+t)}function yb(t,r){var i=r.ownerDocument.createElement("input");return i.name=r.name,i.value=r.value,t.id&&i.setAttribute("form",t.id),r.parentNode.insertBefore(i,r),t=new FormData(t),i.parentNode.removeChild(i),t}function GA(t,r,i,c,h){if(r==="submit"&&i&&i.stateNode===h){var g=gb((h[_n]||null).action),E=c.submitter;E&&(r=(r=E[_n]||null)?gb(r.formAction):E.getAttribute("formAction"),r!==null&&(g=r,E=null));var k=new Ur("action","action",null,c,h);t.push({event:k,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(ti!==0){var $=E?yb(h,E):new FormData(h);Dh(i,{pending:!0,data:$,method:h.method,action:g},null,$)}}else typeof g=="function"&&(k.preventDefault(),$=E?yb(h,E):new FormData(h),Dh(i,{pending:!0,data:$,method:h.method,action:g},g,$))},currentTarget:h}]})}}for(var yp=0;yp<Jf.length;yp++){var xp=Jf[yp],qA=xp.toLowerCase(),$A=xp[0].toUpperCase()+xp.slice(1);br(qA,"on"+$A)}br(Q0,"onAnimationEnd"),br(W0,"onAnimationIteration"),br(K0,"onAnimationStart"),br("dblclick","onDoubleClick"),br("focusin","onFocus"),br("focusout","onBlur"),br(lA,"onTransitionRun"),br(cA,"onTransitionStart"),br(uA,"onTransitionCancel"),br(Z0,"onTransitionEnd"),Qs("onMouseEnter",["mouseout","mouseover"]),Qs("onMouseLeave",["mouseout","mouseover"]),Qs("onPointerEnter",["pointerout","pointerover"]),Qs("onPointerLeave",["pointerout","pointerover"]),Ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ys("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ec="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),YA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ec));function xb(t,r){r=(r&4)!==0;for(var i=0;i<t.length;i++){var c=t[i],h=c.event;c=c.listeners;e:{var g=void 0;if(r)for(var E=c.length-1;0<=E;E--){var k=c[E],$=k.instance,ne=k.currentTarget;if(k=k.listener,$!==g&&h.isPropagationStopped())break e;g=k,h.currentTarget=ne;try{g(h)}catch(ge){Mu(ge)}h.currentTarget=null,g=$}else for(E=0;E<c.length;E++){if(k=c[E],$=k.instance,ne=k.currentTarget,k=k.listener,$!==g&&h.isPropagationStopped())break e;g=k,h.currentTarget=ne;try{g(h)}catch(ge){Mu(ge)}h.currentTarget=null,g=$}}}}function ht(t,r){var i=r[ra];i===void 0&&(i=r[ra]=new Set);var c=t+"__bubble";i.has(c)||(bb(r,t,2,!1),i.add(c))}function bp(t,r,i){var c=0;r&&(c|=4),bb(i,t,c,r)}var _d="_reactListening"+Math.random().toString(36).slice(2);function vp(t){if(!t[_d]){t[_d]=!0,Ii.forEach(function(i){i!=="selectionchange"&&(YA.has(i)||bp(i,!1,t),bp(i,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[_d]||(r[_d]=!0,bp("selectionchange",!1,r))}}function bb(t,r,i,c){switch(Qb(r)){case 2:var h=_2;break;case 8:h=E2;break;default:h=Mp}i=h.bind(null,r,i,t),h=void 0,!Di||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),c?h!==void 0?t.addEventListener(r,i,{capture:!0,passive:h}):t.addEventListener(r,i,!0):h!==void 0?t.addEventListener(r,i,{passive:h}):t.addEventListener(r,i,!1)}function _p(t,r,i,c,h){var g=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var E=c.tag;if(E===3||E===4){var k=c.stateNode.containerInfo;if(k===h)break;if(E===4)for(E=c.return;E!==null;){var $=E.tag;if(($===3||$===4)&&E.stateNode.containerInfo===h)return;E=E.return}for(;k!==null;){if(E=qs(k),E===null)return;if($=E.tag,$===5||$===6||$===26||$===27){c=g=E;continue e}k=k.parentNode}}c=c.return}Da(function(){var ne=g,ge=Gt(i),Ee=[];e:{var ae=X0.get(t);if(ae!==void 0){var ue=Ur,Ue=t;switch(t){case"keypress":if(Pi(i)===0)break e;case"keydown":case"keyup":ue=ju;break;case"focusin":Ue="focus",ue=zi;break;case"focusout":Ue="blur",ue=zi;break;case"beforeblur":case"afterblur":ue=zi;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=Yl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=wu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=b;break;case Q0:case W0:case K0:ue=Tu;break;case Z0:ue=U;break;case"scroll":case"scrollend":ue=$l;break;case"wheel":ue=oe;break;case"copy":case"cut":case"paste":ue=Au;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=fa;break;case"toggle":case"beforetoggle":ue=ot}var We=(r&4)!==0,zt=!We&&(t==="scroll"||t==="scrollend"),J=We?ae!==null?ae+"Capture":null:ae;We=[];for(var K=ne,te;K!==null;){var ve=K;if(te=ve.stateNode,ve=ve.tag,ve!==5&&ve!==26&&ve!==27||te===null||J===null||(ve=mr(K,J),ve!=null&&We.push(wc(K,ve,te))),zt)break;K=K.return}0<We.length&&(ae=new ue(ae,Ue,null,i,ge),Ee.push({event:ae,listeners:We}))}}if((r&7)===0){e:{if(ae=t==="mouseover"||t==="pointerover",ue=t==="mouseout"||t==="pointerout",ae&&i!==On&&(Ue=i.relatedTarget||i.fromElement)&&(qs(Ue)||Ue[Gs]))break e;if((ue||ae)&&(ae=ge.window===ge?ge:(ae=ge.ownerDocument)?ae.defaultView||ae.parentWindow:window,ue?(Ue=i.relatedTarget||i.toElement,ue=ne,Ue=Ue?qs(Ue):null,Ue!==null&&(zt=l(Ue),We=Ue.tag,Ue!==zt||We!==5&&We!==27&&We!==6)&&(Ue=null)):(ue=null,Ue=ne),ue!==Ue)){if(We=Yl,ve="onMouseLeave",J="onMouseEnter",K="mouse",(t==="pointerout"||t==="pointerover")&&(We=fa,ve="onPointerLeave",J="onPointerEnter",K="pointer"),zt=ue==null?ae:os(ue),te=Ue==null?ae:os(Ue),ae=new We(ve,K+"leave",ue,i,ge),ae.target=zt,ae.relatedTarget=te,ve=null,qs(ge)===ne&&(We=new We(J,K+"enter",Ue,i,ge),We.target=te,We.relatedTarget=zt,ve=We),zt=ve,ue&&Ue)t:{for(We=QA,J=ue,K=Ue,te=0,ve=J;ve;ve=We(ve))te++;ve=0;for(var qe=K;qe;qe=We(qe))ve++;for(;0<te-ve;)J=We(J),te--;for(;0<ve-te;)K=We(K),ve--;for(;te--;){if(J===K||K!==null&&J===K.alternate){We=J;break t}J=We(J),K=We(K)}We=null}else We=null;ue!==null&&vb(Ee,ae,ue,We,!1),Ue!==null&&zt!==null&&vb(Ee,zt,Ue,We,!0)}}e:{if(ae=ne?os(ne):window,ue=ae.nodeName&&ae.nodeName.toLowerCase(),ue==="select"||ue==="input"&&ae.type==="file")var Nt=U0;else if(M0(ae))if(P0)Nt=aA;else{Nt=sA;var ze=nA}else ue=ae.nodeName,!ue||ue.toLowerCase()!=="input"||ae.type!=="checkbox"&&ae.type!=="radio"?ne&&Ve(ne.elementType)&&(Nt=U0):Nt=rA;if(Nt&&(Nt=Nt(t,ne))){D0(Ee,Nt,i,ge);break e}ze&&ze(t,ae,ne),t==="focusout"&&ne&&ae.type==="number"&&ne.memoizedProps.value!=null&&No(ae,"number",ae.value)}switch(ze=ne?os(ne):window,t){case"focusin":(M0(ze)||ze.contentEditable==="true")&&(Mo=ze,Kf=ne,Xl=null);break;case"focusout":Xl=Kf=Mo=null;break;case"mousedown":Zf=!0;break;case"contextmenu":case"mouseup":case"dragend":Zf=!1,$0(Ee,i,ge);break;case"selectionchange":if(oA)break;case"keydown":case"keyup":$0(Ee,i,ge)}var ct;if(Ot)e:{switch(t){case"compositionstart":var mt="onCompositionStart";break e;case"compositionend":mt="onCompositionEnd";break e;case"compositionupdate":mt="onCompositionUpdate";break e}mt=void 0}else Lo?Bi(t,i)&&(mt="onCompositionEnd"):t==="keydown"&&i.keyCode===229&&(mt="onCompositionStart");mt&&(zr&&i.locale!=="ko"&&(Lo||mt!=="onCompositionStart"?mt==="onCompositionEnd"&&Lo&&(ct=ql()):(Dr=ge,Gl="value"in Dr?Dr.value:Dr.textContent,Lo=!0)),ze=Ed(ne,mt),0<ze.length&&(mt=new Vr(mt,t,null,i,ge),Ee.push({event:mt,listeners:ze}),ct?mt.data=ct:(ct=ko(i),ct!==null&&(mt.data=ct)))),(ct=Xs?XT(t,i):JT(t,i))&&(mt=Ed(ne,"onBeforeInput"),0<mt.length&&(ze=new Vr("onBeforeInput","beforeinput",null,i,ge),Ee.push({event:ze,listeners:mt}),ze.data=ct)),GA(Ee,t,ne,i,ge)}xb(Ee,r)})}function wc(t,r,i){return{instance:t,listener:r,currentTarget:i}}function Ed(t,r){for(var i=r+"Capture",c=[];t!==null;){var h=t,g=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||g===null||(h=mr(t,i),h!=null&&c.unshift(wc(t,h,g)),h=mr(t,r),h!=null&&c.push(wc(t,h,g))),t.tag===3)return c;t=t.return}return[]}function QA(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function vb(t,r,i,c,h){for(var g=r._reactName,E=[];i!==null&&i!==c;){var k=i,$=k.alternate,ne=k.stateNode;if(k=k.tag,$!==null&&$===c)break;k!==5&&k!==26&&k!==27||ne===null||($=ne,h?(ne=mr(i,g),ne!=null&&E.unshift(wc(i,ne,$))):h||(ne=mr(i,g),ne!=null&&E.push(wc(i,ne,$)))),i=i.return}E.length!==0&&t.push({event:r,listeners:E})}var WA=/\r\n?/g,KA=/\u0000|\uFFFD/g;function _b(t){return(typeof t=="string"?t:""+t).replace(WA,`
`).replace(KA,"")}function Eb(t,r){return r=_b(r),_b(t)===r}function Vt(t,r,i,c,h,g){switch(i){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||cs(t,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&cs(t,""+c);break;case"className":ls(t,"class",c);break;case"tabIndex":ls(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ls(t,i,c);break;case"style":Be(t,c,g);break;case"data":if(r!=="object"){ls(t,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||i!=="href")){t.removeAttribute(i);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(i);break}c=Qe(""+c),t.setAttribute(i,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(i==="formAction"?(r!=="input"&&Vt(t,r,"name",h.name,h,null),Vt(t,r,"formEncType",h.formEncType,h,null),Vt(t,r,"formMethod",h.formMethod,h,null),Vt(t,r,"formTarget",h.formTarget,h,null)):(Vt(t,r,"encType",h.encType,h,null),Vt(t,r,"method",h.method,h,null),Vt(t,r,"target",h.target,h,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(i);break}c=Qe(""+c),t.setAttribute(i,c);break;case"onClick":c!=null&&(t.onclick=kt);break;case"onScroll":c!=null&&ht("scroll",t);break;case"onScrollEnd":c!=null&&ht("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(a(61));if(i=c.__html,i!=null){if(h.children!=null)throw Error(a(60));t.innerHTML=i}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}i=Qe(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(i,""+c):t.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(i,""):t.removeAttribute(i);break;case"capture":case"download":c===!0?t.setAttribute(i,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(i,c):t.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(i,c):t.removeAttribute(i);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(i):t.setAttribute(i,c);break;case"popover":ht("beforetoggle",t),ht("toggle",t),Ma(t,"popover",c);break;case"xlinkActuate":ln(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":ln(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":ln(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":ln(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":ln(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":ln(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":ln(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":ln(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":ln(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Ma(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=Ye.get(i)||i,Ma(t,i,c))}}function Ep(t,r,i,c,h,g){switch(i){case"style":Be(t,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(a(61));if(i=c.__html,i!=null){if(h.children!=null)throw Error(a(60));t.innerHTML=i}}break;case"children":typeof c=="string"?cs(t,c):(typeof c=="number"||typeof c=="bigint")&&cs(t,""+c);break;case"onScroll":c!=null&&ht("scroll",t);break;case"onScrollEnd":c!=null&&ht("scrollend",t);break;case"onClick":c!=null&&(t.onclick=kt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ni.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(h=i.endsWith("Capture"),r=i.slice(2,h?i.length-7:void 0),g=t[_n]||null,g=g!=null?g[i]:null,typeof g=="function"&&t.removeEventListener(r,g,h),typeof c=="function")){typeof g!="function"&&g!==null&&(i in t?t[i]=null:t.hasAttribute(i)&&t.removeAttribute(i)),t.addEventListener(r,c,h);break e}i in t?t[i]=c:c===!0?t.setAttribute(i,""):Ma(t,i,c)}}}function Qn(t,r,i){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ht("error",t),ht("load",t);var c=!1,h=!1,g;for(g in i)if(i.hasOwnProperty(g)){var E=i[g];if(E!=null)switch(g){case"src":c=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Vt(t,r,g,E,i,null)}}h&&Vt(t,r,"srcSet",i.srcSet,i,null),c&&Vt(t,r,"src",i.src,i,null);return;case"input":ht("invalid",t);var k=g=E=h=null,$=null,ne=null;for(c in i)if(i.hasOwnProperty(c)){var ge=i[c];if(ge!=null)switch(c){case"name":h=ge;break;case"type":E=ge;break;case"checked":$=ge;break;case"defaultChecked":ne=ge;break;case"value":g=ge;break;case"defaultValue":k=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(a(137,r));break;default:Vt(t,r,c,ge,i,null)}}Li(t,g,k,$,ne,E,h,!1);return;case"select":ht("invalid",t),c=E=g=null;for(h in i)if(i.hasOwnProperty(h)&&(k=i[h],k!=null))switch(h){case"value":g=k;break;case"defaultValue":E=k;break;case"multiple":c=k;default:Vt(t,r,h,k,i,null)}r=g,i=E,t.multiple=!!c,r!=null?la(t,!!c,r,!1):i!=null&&la(t,!!c,i,!0);return;case"textarea":ht("invalid",t),g=h=c=null;for(E in i)if(i.hasOwnProperty(E)&&(k=i[E],k!=null))switch(E){case"value":c=k;break;case"defaultValue":h=k;break;case"children":g=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(a(91));break;default:Vt(t,r,E,k,i,null)}ca(t,c,h,g);return;case"option":for($ in i)if(i.hasOwnProperty($)&&(c=i[$],c!=null))switch($){case"selected":t.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Vt(t,r,$,c,i,null)}return;case"dialog":ht("beforetoggle",t),ht("toggle",t),ht("cancel",t),ht("close",t);break;case"iframe":case"object":ht("load",t);break;case"video":case"audio":for(c=0;c<Ec.length;c++)ht(Ec[c],t);break;case"image":ht("error",t),ht("load",t);break;case"details":ht("toggle",t);break;case"embed":case"source":case"link":ht("error",t),ht("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in i)if(i.hasOwnProperty(ne)&&(c=i[ne],c!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Vt(t,r,ne,c,i,null)}return;default:if(Ve(r)){for(ge in i)i.hasOwnProperty(ge)&&(c=i[ge],c!==void 0&&Ep(t,r,ge,c,i,void 0));return}}for(k in i)i.hasOwnProperty(k)&&(c=i[k],c!=null&&Vt(t,r,k,c,i,null))}function ZA(t,r,i,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,g=null,E=null,k=null,$=null,ne=null,ge=null;for(ue in i){var Ee=i[ue];if(i.hasOwnProperty(ue)&&Ee!=null)switch(ue){case"checked":break;case"value":break;case"defaultValue":$=Ee;default:c.hasOwnProperty(ue)||Vt(t,r,ue,null,c,Ee)}}for(var ae in c){var ue=c[ae];if(Ee=i[ae],c.hasOwnProperty(ae)&&(ue!=null||Ee!=null))switch(ae){case"type":g=ue;break;case"name":h=ue;break;case"checked":ne=ue;break;case"defaultChecked":ge=ue;break;case"value":E=ue;break;case"defaultValue":k=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(a(137,r));break;default:ue!==Ee&&Vt(t,r,ae,ue,c,Ee)}}oa(t,E,k,$,ne,ge,g,h);return;case"select":ue=E=k=ae=null;for(g in i)if($=i[g],i.hasOwnProperty(g)&&$!=null)switch(g){case"value":break;case"multiple":ue=$;default:c.hasOwnProperty(g)||Vt(t,r,g,null,c,$)}for(h in c)if(g=c[h],$=i[h],c.hasOwnProperty(h)&&(g!=null||$!=null))switch(h){case"value":ae=g;break;case"defaultValue":k=g;break;case"multiple":E=g;default:g!==$&&Vt(t,r,h,g,c,$)}r=k,i=E,c=ue,ae!=null?la(t,!!i,ae,!1):!!c!=!!i&&(r!=null?la(t,!!i,r,!0):la(t,!!i,i?[]:"",!1));return;case"textarea":ue=ae=null;for(k in i)if(h=i[k],i.hasOwnProperty(k)&&h!=null&&!c.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:Vt(t,r,k,null,c,h)}for(E in c)if(h=c[E],g=i[E],c.hasOwnProperty(E)&&(h!=null||g!=null))switch(E){case"value":ae=h;break;case"defaultValue":ue=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(a(91));break;default:h!==g&&Vt(t,r,E,h,c,g)}Hl(t,ae,ue);return;case"option":for(var Ue in i)if(ae=i[Ue],i.hasOwnProperty(Ue)&&ae!=null&&!c.hasOwnProperty(Ue))switch(Ue){case"selected":t.selected=!1;break;default:Vt(t,r,Ue,null,c,ae)}for($ in c)if(ae=c[$],ue=i[$],c.hasOwnProperty($)&&ae!==ue&&(ae!=null||ue!=null))switch($){case"selected":t.selected=ae&&typeof ae!="function"&&typeof ae!="symbol";break;default:Vt(t,r,$,ae,c,ue)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var We in i)ae=i[We],i.hasOwnProperty(We)&&ae!=null&&!c.hasOwnProperty(We)&&Vt(t,r,We,null,c,ae);for(ne in c)if(ae=c[ne],ue=i[ne],c.hasOwnProperty(ne)&&ae!==ue&&(ae!=null||ue!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(a(137,r));break;default:Vt(t,r,ne,ae,c,ue)}return;default:if(Ve(r)){for(var zt in i)ae=i[zt],i.hasOwnProperty(zt)&&ae!==void 0&&!c.hasOwnProperty(zt)&&Ep(t,r,zt,void 0,c,ae);for(ge in c)ae=c[ge],ue=i[ge],!c.hasOwnProperty(ge)||ae===ue||ae===void 0&&ue===void 0||Ep(t,r,ge,ae,c,ue);return}}for(var J in i)ae=i[J],i.hasOwnProperty(J)&&ae!=null&&!c.hasOwnProperty(J)&&Vt(t,r,J,null,c,ae);for(Ee in c)ae=c[Ee],ue=i[Ee],!c.hasOwnProperty(Ee)||ae===ue||ae==null&&ue==null||Vt(t,r,Ee,ae,c,ue)}function wb(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function XA(){if(typeof performance.getEntriesByType=="function"){for(var t=0,r=0,i=performance.getEntriesByType("resource"),c=0;c<i.length;c++){var h=i[c],g=h.transferSize,E=h.initiatorType,k=h.duration;if(g&&k&&wb(E)){for(E=0,k=h.responseEnd,c+=1;c<i.length;c++){var $=i[c],ne=$.startTime;if(ne>k)break;var ge=$.transferSize,Ee=$.initiatorType;ge&&wb(Ee)&&($=$.responseEnd,E+=ge*($<k?1:(k-ne)/($-ne)))}if(--c,r+=8*(g+E)/(h.duration/1e3),t++,10<t)break}}if(0<t)return r/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var wp=null,Sp=null;function wd(t){return t.nodeType===9?t:t.ownerDocument}function Sb(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Tb(t,r){if(t===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&r==="foreignObject"?0:t}function Tp(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Ap=null;function JA(){var t=window.event;return t&&t.type==="popstate"?t===Ap?!1:(Ap=t,!0):(Ap=null,!1)}var Ab=typeof setTimeout=="function"?setTimeout:void 0,e2=typeof clearTimeout=="function"?clearTimeout:void 0,Ib=typeof Promise=="function"?Promise:void 0,t2=typeof queueMicrotask=="function"?queueMicrotask:typeof Ib<"u"?function(t){return Ib.resolve(null).then(t).catch(n2)}:Ab;function n2(t){setTimeout(function(){throw t})}function ni(t){return t==="head"}function Nb(t,r){var i=r,c=0;do{var h=i.nextSibling;if(t.removeChild(i),h&&h.nodeType===8)if(i=h.data,i==="/$"||i==="/&"){if(c===0){t.removeChild(h),ll(r);return}c--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")c++;else if(i==="html")Sc(t.ownerDocument.documentElement);else if(i==="head"){i=t.ownerDocument.head,Sc(i);for(var g=i.firstChild;g;){var E=g.nextSibling,k=g.nodeName;g[Os]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&g.rel.toLowerCase()==="stylesheet"||i.removeChild(g),g=E}}else i==="body"&&Sc(t.ownerDocument.body);i=h}while(i);ll(r)}function Cb(t,r){var i=t;t=0;do{var c=i.nextSibling;if(i.nodeType===1?r?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(r?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),c&&c.nodeType===8)if(i=c.data,i==="/$"){if(t===0)break;t--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||t++;i=c}while(i)}function Ip(t){var r=t.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var i=r;switch(r=r.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":Ip(i),aa(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}t.removeChild(i)}}function s2(t,r,i,c){for(;t.nodeType===1;){var h=i;if(t.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[Os])switch(r){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(g=t.getAttribute("rel"),g==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(g!==h.rel||t.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||t.getAttribute("title")!==(h.title==null?null:h.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(g=t.getAttribute("src"),(g!==(h.src==null?null:h.src)||t.getAttribute("type")!==(h.type==null?null:h.type)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&g&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(r==="input"&&t.type==="hidden"){var g=h.name==null?null:""+h.name;if(h.type==="hidden"&&t.getAttribute("name")===g)return t}else return t;if(t=ar(t.nextSibling),t===null)break}return null}function r2(t,r,i){if(r==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!i||(t=ar(t.nextSibling),t===null))return null;return t}function Rb(t,r){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=ar(t.nextSibling),t===null))return null;return t}function Np(t){return t.data==="$?"||t.data==="$~"}function Cp(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function a2(t,r){var i=t.ownerDocument;if(t.data==="$~")t._reactRetry=r;else if(t.data!=="$?"||i.readyState!=="loading")r();else{var c=function(){r(),i.removeEventListener("DOMContentLoaded",c)};i.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function ar(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return t}var Rp=null;function Ob(t){t=t.nextSibling;for(var r=0;t;){if(t.nodeType===8){var i=t.data;if(i==="/$"||i==="/&"){if(r===0)return ar(t.nextSibling);r--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||r++}t=t.nextSibling}return null}function jb(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var i=t.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(r===0)return t;r--}else i!=="/$"&&i!=="/&"||r++}t=t.previousSibling}return null}function kb(t,r,i){switch(r=wd(i),t){case"html":if(t=r.documentElement,!t)throw Error(a(452));return t;case"head":if(t=r.head,!t)throw Error(a(453));return t;case"body":if(t=r.body,!t)throw Error(a(454));return t;default:throw Error(a(451))}}function Sc(t){for(var r=t.attributes;r.length;)t.removeAttributeNode(r[0]);aa(t)}var ir=new Map,Lb=new Set;function Sd(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Ia=le.d;le.d={f:i2,r:o2,D:l2,C:c2,L:u2,m:d2,X:h2,S:f2,M:p2};function i2(){var t=Ia.f(),r=md();return t||r}function o2(t){var r=vs(t);r!==null&&r.tag===5&&r.type==="form"?Zy(r):Ia.r(t)}var al=typeof document>"u"?null:document;function Mb(t,r,i){var c=al;if(c&&typeof r=="string"&&r){var h=Xn(r);h='link[rel="'+t+'"][href="'+h+'"]',typeof i=="string"&&(h+='[crossorigin="'+i+'"]'),Lb.has(h)||(Lb.add(h),t={rel:t,crossOrigin:i,href:r},c.querySelector(h)===null&&(r=c.createElement("link"),Qn(r,"link",t),on(r),c.head.appendChild(r)))}}function l2(t){Ia.D(t),Mb("dns-prefetch",t,null)}function c2(t,r){Ia.C(t,r),Mb("preconnect",t,r)}function u2(t,r,i){Ia.L(t,r,i);var c=al;if(c&&t&&r){var h='link[rel="preload"][as="'+Xn(r)+'"]';r==="image"&&i&&i.imageSrcSet?(h+='[imagesrcset="'+Xn(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(h+='[imagesizes="'+Xn(i.imageSizes)+'"]')):h+='[href="'+Xn(t)+'"]';var g=h;switch(r){case"style":g=il(t);break;case"script":g=ol(t)}ir.has(g)||(t=v({rel:"preload",href:r==="image"&&i&&i.imageSrcSet?void 0:t,as:r},i),ir.set(g,t),c.querySelector(h)!==null||r==="style"&&c.querySelector(Tc(g))||r==="script"&&c.querySelector(Ac(g))||(r=c.createElement("link"),Qn(r,"link",t),on(r),c.head.appendChild(r)))}}function d2(t,r){Ia.m(t,r);var i=al;if(i&&t){var c=r&&typeof r.as=="string"?r.as:"script",h='link[rel="modulepreload"][as="'+Xn(c)+'"][href="'+Xn(t)+'"]',g=h;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=ol(t)}if(!ir.has(g)&&(t=v({rel:"modulepreload",href:t},r),ir.set(g,t),i.querySelector(h)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(Ac(g)))return}c=i.createElement("link"),Qn(c,"link",t),on(c),i.head.appendChild(c)}}}function f2(t,r,i){Ia.S(t,r,i);var c=al;if(c&&t){var h=$s(c).hoistableStyles,g=il(t);r=r||"default";var E=h.get(g);if(!E){var k={loading:0,preload:null};if(E=c.querySelector(Tc(g)))k.loading=5;else{t=v({rel:"stylesheet",href:t,"data-precedence":r},i),(i=ir.get(g))&&Op(t,i);var $=E=c.createElement("link");on($),Qn($,"link",t),$._p=new Promise(function(ne,ge){$.onload=ne,$.onerror=ge}),$.addEventListener("load",function(){k.loading|=1}),$.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Td(E,r,c)}E={type:"stylesheet",instance:E,count:1,state:k},h.set(g,E)}}}function h2(t,r){Ia.X(t,r);var i=al;if(i&&t){var c=$s(i).hoistableScripts,h=ol(t),g=c.get(h);g||(g=i.querySelector(Ac(h)),g||(t=v({src:t,async:!0},r),(r=ir.get(h))&&jp(t,r),g=i.createElement("script"),on(g),Qn(g,"link",t),i.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(h,g))}}function p2(t,r){Ia.M(t,r);var i=al;if(i&&t){var c=$s(i).hoistableScripts,h=ol(t),g=c.get(h);g||(g=i.querySelector(Ac(h)),g||(t=v({src:t,async:!0,type:"module"},r),(r=ir.get(h))&&jp(t,r),g=i.createElement("script"),on(g),Qn(g,"link",t),i.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(h,g))}}function Db(t,r,i,c){var h=(h=ce.current)?Sd(h):null;if(!h)throw Error(a(446));switch(t){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(r=il(i.href),i=$s(h).hoistableStyles,c=i.get(r),c||(c={type:"style",instance:null,count:0,state:null},i.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){t=il(i.href);var g=$s(h).hoistableStyles,E=g.get(t);if(E||(h=h.ownerDocument||h,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(t,E),(g=h.querySelector(Tc(t)))&&!g._p&&(E.instance=g,E.state.loading=5),ir.has(t)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},ir.set(t,i),g||m2(h,t,i,E.state))),r&&c===null)throw Error(a(528,""));return E}if(r&&c!==null)throw Error(a(529,""));return null;case"script":return r=i.async,i=i.src,typeof i=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ol(i),i=$s(h).hoistableScripts,c=i.get(r),c||(c={type:"script",instance:null,count:0,state:null},i.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,t))}}function il(t){return'href="'+Xn(t)+'"'}function Tc(t){return'link[rel="stylesheet"]['+t+"]"}function Ub(t){return v({},t,{"data-precedence":t.precedence,precedence:null})}function m2(t,r,i,c){t.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=t.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Qn(r,"link",i),on(r),t.head.appendChild(r))}function ol(t){return'[src="'+Xn(t)+'"]'}function Ac(t){return"script[async]"+t}function Pb(t,r,i){if(r.count++,r.instance===null)switch(r.type){case"style":var c=t.querySelector('style[data-href~="'+Xn(i.href)+'"]');if(c)return r.instance=c,on(c),c;var h=v({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),on(c),Qn(c,"style",h),Td(c,i.precedence,t),r.instance=c;case"stylesheet":h=il(i.href);var g=t.querySelector(Tc(h));if(g)return r.state.loading|=4,r.instance=g,on(g),g;c=Ub(i),(h=ir.get(h))&&Op(c,h),g=(t.ownerDocument||t).createElement("link"),on(g);var E=g;return E._p=new Promise(function(k,$){E.onload=k,E.onerror=$}),Qn(g,"link",c),r.state.loading|=4,Td(g,i.precedence,t),r.instance=g;case"script":return g=ol(i.src),(h=t.querySelector(Ac(g)))?(r.instance=h,on(h),h):(c=i,(h=ir.get(g))&&(c=v({},i),jp(c,h)),t=t.ownerDocument||t,h=t.createElement("script"),on(h),Qn(h,"link",c),t.head.appendChild(h),r.instance=h);case"void":return null;default:throw Error(a(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Td(c,i.precedence,t));return r.instance}function Td(t,r,i){for(var c=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=c.length?c[c.length-1]:null,g=h,E=0;E<c.length;E++){var k=c[E];if(k.dataset.precedence===r)g=k;else if(g!==h)break}g?g.parentNode.insertBefore(t,g.nextSibling):(r=i.nodeType===9?i.head:i,r.insertBefore(t,r.firstChild))}function Op(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.title==null&&(t.title=r.title)}function jp(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.integrity==null&&(t.integrity=r.integrity)}var Ad=null;function Vb(t,r,i){if(Ad===null){var c=new Map,h=Ad=new Map;h.set(i,c)}else h=Ad,c=h.get(i),c||(c=new Map,h.set(i,c));if(c.has(t))return c;for(c.set(t,null),i=i.getElementsByTagName(t),h=0;h<i.length;h++){var g=i[h];if(!(g[Os]||g[an]||t==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var E=g.getAttribute(r)||"";E=t+E;var k=c.get(E);k?k.push(g):c.set(E,[g])}}return c}function zb(t,r,i){t=t.ownerDocument||t,t.head.insertBefore(i,r==="title"?t.querySelector("head > title"):null)}function g2(t,r,i){if(i===1||r.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return t=r.disabled,typeof r.precedence=="string"&&t==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Bb(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function y2(t,r,i,c){if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var h=il(c.href),g=r.querySelector(Tc(h));if(g){r=g._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(t.count++,t=Id.bind(t),r.then(t,t)),i.state.loading|=4,i.instance=g,on(g);return}g=r.ownerDocument||r,c=Ub(c),(h=ir.get(h))&&Op(c,h),g=g.createElement("link"),on(g);var E=g;E._p=new Promise(function(k,$){E.onload=k,E.onerror=$}),Qn(g,"link",c),i.instance=g}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(i,r),(r=i.state.preload)&&(i.state.loading&3)===0&&(t.count++,i=Id.bind(t),r.addEventListener("load",i),r.addEventListener("error",i))}}var kp=0;function x2(t,r){return t.stylesheets&&t.count===0&&Cd(t,t.stylesheets),0<t.count||0<t.imgCount?function(i){var c=setTimeout(function(){if(t.stylesheets&&Cd(t,t.stylesheets),t.unsuspend){var g=t.unsuspend;t.unsuspend=null,g()}},6e4+r);0<t.imgBytes&&kp===0&&(kp=62500*XA());var h=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Cd(t,t.stylesheets),t.unsuspend)){var g=t.unsuspend;t.unsuspend=null,g()}},(t.imgBytes>kp?50:800)+r);return t.unsuspend=i,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(h)}}:null}function Id(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Cd(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Nd=null;function Cd(t,r){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Nd=new Map,r.forEach(b2,t),Nd=null,Id.call(t))}function b2(t,r){if(!(r.state.loading&4)){var i=Nd.get(t);if(i)var c=i.get(null);else{i=new Map,Nd.set(t,i);for(var h=t.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<h.length;g++){var E=h[g];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(i.set(E.dataset.precedence,E),c=E)}c&&i.set(null,c)}h=r.instance,E=h.getAttribute("data-precedence"),g=i.get(E)||c,g===c&&i.set(null,h),i.set(E,h),this.count++,c=Id.bind(this),h.addEventListener("load",c),h.addEventListener("error",c),g?g.parentNode.insertBefore(h,g.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(h,t.firstChild)),r.state.loading|=4}}var Ic={$$typeof:G,Provider:null,Consumer:null,_currentValue:se,_currentValue2:se,_threadCount:0};function v2(t,r,i,c,h,g,E,k,$){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Wt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wt(0),this.hiddenUpdates=Wt(null),this.identifierPrefix=c,this.onUncaughtError=h,this.onCaughtError=g,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=$,this.incompleteTransitions=new Map}function Fb(t,r,i,c,h,g,E,k,$,ne,ge,Ee){return t=new v2(t,r,i,E,$,ne,ge,Ee,k),r=1,g===!0&&(r|=24),g=ks(3,null,null,r),t.current=g,g.stateNode=t,r=fh(),r.refCount++,t.pooledCache=r,r.refCount++,g.memoizedState={element:c,isDehydrated:i,cache:r},gh(g),t}function Hb(t){return t?(t=Po,t):Po}function Gb(t,r,i,c,h,g){h=Hb(h),c.context===null?c.context=h:c.pendingContext=h,c=qa(r),c.payload={element:i},g=g===void 0?null:g,g!==null&&(c.callback=g),i=$a(t,c,r),i!==null&&(Ts(i,t,r),ac(i,t,r))}function qb(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var i=t.retryLane;t.retryLane=i!==0&&i<r?i:r}}function Lp(t,r){qb(t,r),(t=t.alternate)&&qb(t,r)}function $b(t){if(t.tag===13||t.tag===31){var r=Gi(t,67108864);r!==null&&Ts(r,t,67108864),Lp(t,67108864)}}function Yb(t){if(t.tag===13||t.tag===31){var r=Ps();r=sa(r);var i=Gi(t,r);i!==null&&Ts(i,t,r),Lp(t,r)}}var Rd=!0;function _2(t,r,i,c){var h=B.T;B.T=null;var g=le.p;try{le.p=2,Mp(t,r,i,c)}finally{le.p=g,B.T=h}}function E2(t,r,i,c){var h=B.T;B.T=null;var g=le.p;try{le.p=8,Mp(t,r,i,c)}finally{le.p=g,B.T=h}}function Mp(t,r,i,c){if(Rd){var h=Dp(c);if(h===null)_p(t,r,c,Od,i),Wb(t,c);else if(S2(h,t,r,i,c))c.stopPropagation();else if(Wb(t,c),r&4&&-1<w2.indexOf(t)){for(;h!==null;){var g=vs(h);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var E=Qt(g.pendingLanes);if(E!==0){var k=g;for(k.pendingLanes|=2,k.entangledLanes|=2;E;){var $=1<<31-Ne(E);k.entanglements[1]|=$,E&=~$}Gr(g),(jt&6)===0&&(hd=Ze()+500,_c(0))}}break;case 31:case 13:k=Gi(g,2),k!==null&&Ts(k,g,2),md(),Lp(g,2)}if(g=Dp(c),g===null&&_p(t,r,c,Od,i),g===h)break;h=g}h!==null&&c.stopPropagation()}else _p(t,r,c,null,i)}}function Dp(t){return t=Gt(t),Up(t)}var Od=null;function Up(t){if(Od=null,t=qs(t),t!==null){var r=l(t);if(r===null)t=null;else{var i=r.tag;if(i===13){if(t=d(r),t!==null)return t;t=null}else if(i===31){if(t=p(r),t!==null)return t;t=null}else if(i===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null)}}return Od=t,null}function Qb(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(tt()){case ut:return 2;case At:return 8;case Ht:case fr:return 32;case hr:return 268435456;default:return 32}default:return 32}}var Pp=!1,si=null,ri=null,ai=null,Nc=new Map,Cc=new Map,ii=[],w2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Wb(t,r){switch(t){case"focusin":case"focusout":si=null;break;case"dragenter":case"dragleave":ri=null;break;case"mouseover":case"mouseout":ai=null;break;case"pointerover":case"pointerout":Nc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cc.delete(r.pointerId)}}function Rc(t,r,i,c,h,g){return t===null||t.nativeEvent!==g?(t={blockedOn:r,domEventName:i,eventSystemFlags:c,nativeEvent:g,targetContainers:[h]},r!==null&&(r=vs(r),r!==null&&$b(r)),t):(t.eventSystemFlags|=c,r=t.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),t)}function S2(t,r,i,c,h){switch(r){case"focusin":return si=Rc(si,t,r,i,c,h),!0;case"dragenter":return ri=Rc(ri,t,r,i,c,h),!0;case"mouseover":return ai=Rc(ai,t,r,i,c,h),!0;case"pointerover":var g=h.pointerId;return Nc.set(g,Rc(Nc.get(g)||null,t,r,i,c,h)),!0;case"gotpointercapture":return g=h.pointerId,Cc.set(g,Rc(Cc.get(g)||null,t,r,i,c,h)),!0}return!1}function Kb(t){var r=qs(t.target);if(r!==null){var i=l(r);if(i!==null){if(r=i.tag,r===13){if(r=d(i),r!==null){t.blockedOn=r,mn(t.priority,function(){Yb(i)});return}}else if(r===31){if(r=p(i),r!==null){t.blockedOn=r,mn(t.priority,function(){Yb(i)});return}}else if(r===3&&i.stateNode.current.memoizedState.isDehydrated){t.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}t.blockedOn=null}function jd(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var i=Dp(t.nativeEvent);if(i===null){i=t.nativeEvent;var c=new i.constructor(i.type,i);On=c,i.target.dispatchEvent(c),On=null}else return r=vs(i),r!==null&&$b(r),t.blockedOn=i,!1;r.shift()}return!0}function Zb(t,r,i){jd(t)&&i.delete(r)}function T2(){Pp=!1,si!==null&&jd(si)&&(si=null),ri!==null&&jd(ri)&&(ri=null),ai!==null&&jd(ai)&&(ai=null),Nc.forEach(Zb),Cc.forEach(Zb)}function kd(t,r){t.blockedOn===r&&(t.blockedOn=null,Pp||(Pp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,T2)))}var Ld=null;function Xb(t){Ld!==t&&(Ld=t,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Ld===t&&(Ld=null);for(var r=0;r<t.length;r+=3){var i=t[r],c=t[r+1],h=t[r+2];if(typeof c!="function"){if(Up(c||i)===null)continue;break}var g=vs(i);g!==null&&(t.splice(r,3),r-=3,Dh(g,{pending:!0,data:h,method:i.method,action:c},c,h))}}))}function ll(t){function r($){return kd($,t)}si!==null&&kd(si,t),ri!==null&&kd(ri,t),ai!==null&&kd(ai,t),Nc.forEach(r),Cc.forEach(r);for(var i=0;i<ii.length;i++){var c=ii[i];c.blockedOn===t&&(c.blockedOn=null)}for(;0<ii.length&&(i=ii[0],i.blockedOn===null);)Kb(i),i.blockedOn===null&&ii.shift();if(i=(t.ownerDocument||t).$$reactFormReplay,i!=null)for(c=0;c<i.length;c+=3){var h=i[c],g=i[c+1],E=h[_n]||null;if(typeof g=="function")E||Xb(i);else if(E){var k=null;if(g&&g.hasAttribute("formAction")){if(h=g,E=g[_n]||null)k=E.formAction;else if(Up(h)!==null)continue}else k=E.action;typeof k=="function"?i[c+1]=k:(i.splice(c,3),c-=3),Xb(i)}}}function Jb(){function t(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(E){return h=E})},focusReset:"manual",scroll:"manual"})}function r(){h!==null&&(h(),h=null),c||setTimeout(i,20)}function i(){if(!c&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,h=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(i,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),h!==null&&(h(),h=null)}}}function Vp(t){this._internalRoot=t}Md.prototype.render=Vp.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(a(409));var i=r.current,c=Ps();Gb(i,c,t,r,null,null)},Md.prototype.unmount=Vp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;Gb(t.current,2,null,t,null,null),md(),r[Gs]=null}};function Md(t){this._internalRoot=t}Md.prototype.unstable_scheduleHydration=function(t){if(t){var r=Rs();t={blockedOn:null,target:t,priority:r};for(var i=0;i<ii.length&&r!==0&&r<ii[i].priority;i++);ii.splice(i,0,t),i===0&&Kb(t)}};var ev=e.version;if(ev!=="19.2.4")throw Error(a(527,ev,"19.2.4"));le.findDOMNode=function(t){var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(a(188)):(t=Object.keys(t).join(","),Error(a(268,t)));return t=y(r),t=t!==null?x(t):null,t=t===null?null:t.stateNode,t};var A2={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dd.isDisabled&&Dd.supportsFiber)try{pn=Dd.inject(A2),be=Dd}catch{}}return jc.createRoot=function(t,r){if(!o(t))throw Error(a(299));var i=!1,c="",h=ox,g=lx,E=cx;return r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(h=r.onUncaughtError),r.onCaughtError!==void 0&&(g=r.onCaughtError),r.onRecoverableError!==void 0&&(E=r.onRecoverableError)),r=Fb(t,1,!1,null,null,i,c,null,h,g,E,Jb),t[Gs]=r.current,vp(t),new Vp(r)},jc.hydrateRoot=function(t,r,i){if(!o(t))throw Error(a(299));var c=!1,h="",g=ox,E=lx,k=cx,$=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(E=i.onCaughtError),i.onRecoverableError!==void 0&&(k=i.onRecoverableError),i.formState!==void 0&&($=i.formState)),r=Fb(t,1,!0,r,i??null,c,h,$,g,E,k,Jb),r.context=Hb(null),i=r.current,c=Ps(),c=sa(c),h=qa(c),h.callback=null,$a(i,h,c),i=c,r.current.lanes=i,Hn(r,i),Gr(r),t[Gs]=r.current,vp(t),new Md(r)},jc.version="19.2.4",jc}var uv;function D2(){if(uv)return Fp.exports;uv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Fp.exports=M2(),Fp.exports}var U2=D2();const P2=TE(U2);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AE=(...n)=>n.filter((e,s,a)=>!!e&&e.trim()!==""&&a.indexOf(e)===s).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var z2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=M.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,iconNode:d,...p},m)=>M.createElement("svg",{ref:m,...z2,width:e,height:e,stroke:n,strokeWidth:a?Number(s)*24/Number(e):s,className:AE("lucide",o),...p},[...d.map(([y,x])=>M.createElement(y,x)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=(n,e)=>{const s=M.forwardRef(({className:a,...o},l)=>M.createElement(B2,{ref:l,iconNode:e,className:AE(`lucide-${V2(n)}`,a),...o}));return s.displayName=`${n}`,s};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=Se("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IE=Se("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qc=Se("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ag=Se("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H2=Se("AudioLines",[["path",{d:"M2 10v3",key:"1fnikh"}],["path",{d:"M6 6v11",key:"11sgs0"}],["path",{d:"M10 3v18",key:"yhl04a"}],["path",{d:"M14 8v7",key:"3a1oy3"}],["path",{d:"M18 5v13",key:"123xd1"}],["path",{d:"M22 10v3",key:"154ddg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $p=Se("Binary",[["rect",{x:"14",y:"14",width:"4",height:"6",rx:"2",key:"p02svl"}],["rect",{x:"6",y:"4",width:"4",height:"6",rx:"2",key:"xm4xkj"}],["path",{d:"M6 20h4",key:"1i6q5t"}],["path",{d:"M14 10h4",key:"ru81e7"}],["path",{d:"M6 14h2v6",key:"16z9wg"}],["path",{d:"M14 4h2v6",key:"1idq9u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=Se("Bolt",[["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=Se("BookCopy",[["path",{d:"M2 16V4a2 2 0 0 1 2-2h11",key:"spzkk5"}],["path",{d:"M22 18H11a2 2 0 1 0 0 4h10.5a.5.5 0 0 0 .5-.5v-15a.5.5 0 0 0-.5-.5H11a2 2 0 0 0-2 2v12",key:"1wz07i"}],["path",{d:"M5 14H4a2 2 0 1 0 0 4h1",key:"16gqf9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=Se("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const af=Se("BookText",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=Se("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=Se("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=Se("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=Se("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=Se("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=Se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const of=Se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=Se("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W2=Se("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=Se("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K2=Se("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=Se("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=Se("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mm=Se("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=Se("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dv=Se("CloudDownload",[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fv=Se("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=Se("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=Se("Combine",[["path",{d:"M10 18H5a3 3 0 0 1-3-3v-1",key:"ru65g8"}],["path",{d:"M14 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"e30een"}],["path",{d:"M20 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"2ahx8o"}],["path",{d:"m7 21 3-3-3-3",key:"127cv2"}],["rect",{x:"14",y:"14",width:"8",height:"8",rx:"2",key:"1b0bso"}],["rect",{x:"2",y:"2",width:"8",height:"8",rx:"2",key:"1x09vl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=Se("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ig=Se("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=Se("CornerDownLeft",[["polyline",{points:"9 10 4 15 9 20",key:"r3jprv"}],["path",{d:"M20 4v7a4 4 0 0 1-4 4H4",key:"6o5b7l"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jE=Se("CornerLeftUp",[["polyline",{points:"14 9 9 4 4 9",key:"m9oyvo"}],["path",{d:"M20 20h-7a4 4 0 0 1-4-4V4",key:"1blwi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=Se("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=Se("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=Se("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dm=Se("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const su=Se("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=Se("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=Se("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=Se("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=Se("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=Se("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=Se("Ghost",[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=Se("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=Se("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=Se("Grid2x2",[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 12h18",key:"1i2n21"}],["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UE=Se("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=Se("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=Se("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hv=Se("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=Se("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ng=Se("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=Se("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=Se("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=Se("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=Se("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=Se("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=Se("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zE=Se("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rg=Se("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=Se("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=Se("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=Se("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=Se("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=Se("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=Se("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cl=Se("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=Se("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=Se("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yI=Se("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=Se("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yp=Se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=Se("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FE=Se("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=Se("ShieldX",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=Se("Shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rl=Se("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=Se("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=Se("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=Se("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=Se("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=Se("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kg=Se("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=Se("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=Se("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=Se("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AI=Se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=Se("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=Se("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=Se("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=Se("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pv=Se("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mv=Se("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=Se("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=Se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=Se("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);var Lt=(n=>(n.FORGOT="FORGOT",n.HARD="HARD",n.EASY="EASY",n.LEARNED="LEARNED",n))(Lt||{}),Ft=(n=>(n.RAW="RAW",n.REFINED="REFINED",n.VERIFIED="VERIFIED",n.FAILED="FAILED",n))(Ft||{}),Um=(n=>(n.VARIETY="VARIETY",n.MORE_ACADEMIC="MORE_ACADEMIC",n.LESS_ACADEMIC="LESS_ACADEMIC",n))(Um||{});const $c="u-vocab-master",CI="/data/data.json",RI=[],vl=[{id:"topic_family",title:"Family & Roots",description:"Relationships, upbringing, and the foundations of society.",backgroundTheme:"from-orange-100 to-rose-50",icon:"",segments:[{id:"seg_fam_1",title:"Family Ties",description:"The core units of human connection.",tagCriteria:"family",basicWords:["mother","father","brother","sister","child"],intermediateWords:["upbringing","nuclear family","sibling","guardian","relative"],advancedWords:["genealogy","consanguinity","authoritarian","matriarch","progeny"],visualIcon:"",boss:{name:"Family Elder",hp:20,dialogueIntro:"Do you truly know those you share your blood with?",dialogueWin:"The bonds of kinship are well understood.",dialogueLose:"You ignore your foundations.",image:"",dropBadgeId:"family_crest"}},{id:"seg_fam_2",title:"Modern Society",description:"How we live together in the 21st century.",tagCriteria:"society",basicWords:["people","city","house","friend","neighbor"],intermediateWords:["community","urbanization","demographics","infrastructure","diversity"],advancedWords:["egalitarian","stratification","cosmopolitan","secular","socioeconomic"],visualIcon:"",boss:{name:"The Architect",hp:20,dialogueIntro:"A city is more than stone and mortar. It is a collective mind.",dialogueWin:"You see the patterns in the crowd.",dialogueLose:"Lost in the concrete jungle.",image:"",dropBadgeId:"family_crest"}}]},{id:"topic_education",title:"The Academy",description:"Learning systems, pedagogy, and academic pursuits.",backgroundTheme:"from-yellow-100 to-amber-50",icon:"",segments:[{id:"seg_edu_1",title:"Primary School",description:"The beginning of the educational journey.",tagCriteria:"school",basicWords:["study","learn","teacher","book","class"],intermediateWords:["curriculum","assignment","literacy","discipline","tuition"],advancedWords:["pedagogy","didactic","erudition","rote learning","epistemology"],visualIcon:"",boss:{name:"The Headmaster",hp:20,dialogueIntro:"Class is in session. Don't be late.",dialogueWin:"A star student indeed.",dialogueLose:"Detention for you.",image:"",dropBadgeId:"education_scroll"}},{id:"seg_edu_2",title:"Higher Education",description:"University life and specialized research.",tagCriteria:"university",basicWords:["college","exam","paper","degree","lesson"],intermediateWords:["undergraduate","scholarship","dissertation","vocational","faculty"],advancedWords:["theoretical","specialization","prestigious","alumnus","doctoral"],visualIcon:"",boss:{name:"The Dean",hp:20,dialogueIntro:"Submit your thesis or fail the semester.",dialogueWin:"Your research is groundbreaking.",dialogueLose:"Insufficient evidence for your claims.",image:"",dropBadgeId:"education_scroll"}}]}],OI="IELTSVocabProDB_V2",Xt="vocabulary",Sr="users",zs="units",go="paraphrase_logs",yo="speaking_logs",xo="speaking_topics",Bs="writing_topics",Oa="writing_logs",Fs="irregular_verbs",Tr="lessons",bo="listening_items",Ar="native_speak_items",Ir="conversation_items",Nr="free_talk_items",Cr="compositions",Rr="word_books",vo="reading_books",Pm="lesson_books",Vm="listening_books",zm="speaking_books",Bm="writing_books",Or="planning_goals",jI=27;let or=null,Na=null;const $E=async()=>{if(navigator.storage&&navigator.storage.persist)try{await navigator.storage.persisted()||await navigator.storage.persist()}catch{}},fu=()=>or?Promise.resolve(or):Na||(Na=new Promise((n,e)=>{try{const s=indexedDB.open(OI,jI);s.onblocked=()=>{console.warn("[DB] Database upgrade blocked. Please close other tabs/windows of this app.")},s.onupgradeneeded=a=>{const o=a.target.result;if(!o){console.error("Database not available during onupgradeneeded");return}if(o.objectStoreNames.contains(Xt)){const l=s.transaction.objectStore(Xt);l.indexNames.contains("word")||l.createIndex("word","word",{unique:!1})}else{const l=o.createObjectStore(Xt,{keyPath:"id"});l.createIndex("userId","userId",{unique:!1}),l.createIndex("nextReview","nextReview",{unique:!1}),l.createIndex("userId_word",["userId","word"],{unique:!1}),l.createIndex("word","word",{unique:!1})}if(o.objectStoreNames.contains(Sr)||o.createObjectStore(Sr,{keyPath:"id"}),o.objectStoreNames.contains(zs)||o.createObjectStore(zs,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),!o.objectStoreNames.contains(go)){const l=o.createObjectStore(go,{keyPath:"id"});l.createIndex("userId","userId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1})}if(!o.objectStoreNames.contains(yo)){const l=o.createObjectStore(yo,{keyPath:"id"});l.createIndex("userId","userId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1})}if(a.oldVersion<9&&(o.objectStoreNames.contains(xo)||o.createObjectStore(xo,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<10&&(o.objectStoreNames.contains(Bs)||o.createObjectStore(Bs,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),!o.objectStoreNames.contains(Oa))){const l=o.createObjectStore(Oa,{keyPath:"id"});l.createIndex("userId","userId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1})}a.oldVersion<12&&o.objectStoreNames.contains("word_comparison_groups")&&o.deleteObjectStore("word_comparison_groups"),a.oldVersion<13&&(o.objectStoreNames.contains(Fs)||o.createObjectStore(Fs,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<14&&(o.objectStoreNames.contains(Tr)||o.createObjectStore(Tr,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<15&&(o.objectStoreNames.contains(bo)||o.createObjectStore(bo,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<16&&(o.objectStoreNames.contains(Ar)||o.createObjectStore(Ar,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<17&&(o.objectStoreNames.contains(Cr)||o.createObjectStore(Cr,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),o.objectStoreNames.contains("calendar_events")&&o.deleteObjectStore("calendar_events"),a.oldVersion<19&&(o.objectStoreNames.contains(Rr)||o.createObjectStore(Rr,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<20&&(o.objectStoreNames.contains(vo)||o.createObjectStore(vo,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<21&&(o.objectStoreNames.contains(Pm)||o.createObjectStore(Pm,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<22&&(o.objectStoreNames.contains(Vm)||o.createObjectStore(Vm,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),o.objectStoreNames.contains(zm)||o.createObjectStore(zm,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),o.objectStoreNames.contains(Bm)||o.createObjectStore(Bm,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<23&&(o.objectStoreNames.contains(Or)||o.createObjectStore(Or,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<24&&(o.objectStoreNames.contains(Ir)||o.createObjectStore(Ir,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<26&&(o.objectStoreNames.contains(Nr)||o.createObjectStore(Nr,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),o.objectStoreNames.contains("comparison_groups")&&o.deleteObjectStore("comparison_groups")},s.onsuccess=()=>{or=s.result,or.onclose=()=>{console.warn("[DB] Database connection closed unexpectedly."),or=null,Na=null,window.dispatchEvent(new CustomEvent("db-connection-lost"))},or.onversionchange=()=>{console.warn("[DB] Database version change detected. Closing connection."),or==null||or.close(),or=null,Na=null,window.location.reload()},n(or)},s.onerror=a=>{console.error("[DB] Open DB Error:",a.target.error),Na=null,e(a.target.error)}}catch(s){console.error("[DB] Open DB Exception:",s),Na=null,e(s)}}),Na),YE=async()=>If(async()=>{const n=await fu();return new Promise((e,s)=>{const a=[Sr,Xt,zs,go,yo,xo,Oa,Bs,Fs,Tr,bo,Ar,Ir,Nr,Cr,Rr,vo,Pm,Vm,zm,Bm,Or],o=n.transaction(a,"readwrite");a.forEach(l=>{n.objectStoreNames.contains(l)&&o.objectStore(l).clear()}),o.oncomplete=()=>{localStorage.removeItem("vocab_pro_mimic_practice_queue"),localStorage.removeItem("vocab_pro_db_marker"),localStorage.removeItem("vocab_pro_emergency_backup"),e()},o.onerror=()=>s(o.error)})}),If=async(n,e=3,s=200)=>{var a,o,l;for(let d=0;d<e;d++)try{return await n()}catch(p){if(console.warn(`[DB] Operation failed, retrying (${d+1}/${e}). Error:`,p),((p==null?void 0:p.name)==="InvalidStateError"||(a=p==null?void 0:p.message)!=null&&a.toLowerCase().includes("closed")||((l=(o=p==null?void 0:p.target)==null?void 0:o.error)==null?void 0:l.name)==="InvalidStateError")&&(or=null,Na=null),d===e-1)throw p;await new Promise(m=>setTimeout(m,s*Math.pow(2,d)))}throw new Error("Operation failed after retries")},Pe=async(n,e,s="readwrite")=>If(async()=>{const a=await fu();return new Promise((o,l)=>{try{const d=a.transaction(n,s),p=e(d);d.oncomplete=()=>o(p?p.result:void 0),d.onerror=()=>l(d.error),d.onabort=()=>l(new Error("Transaction aborted"))}catch(d){l(d)}})}),Mg=async(n=!1)=>{try{const e=await fu(),s=e.transaction(Sr,"readonly"),a=await new Promise((x,v)=>{const S=s.objectStore(Sr).getAll();S.onsuccess=()=>x(S.result||[]),S.onerror=()=>v(S.error)}),o=localStorage.getItem("vocab_pro_emergency_backup"),l=localStorage.getItem("vocab_pro_db_marker");if(a.length===0&&o)try{const x=JSON.parse(o);if(Array.isArray(x)&&x.length>0&&(await _o(x),a.length===0)){const v={id:x[0].userId||$c,name:"Recovered User",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Recovered",lastLogin:Date.now(),role:"Language Learner",experience:0,level:1,adventure:{currentNodeIndex:0,energy:5,energyShards:0,unlockedChapterIds:vl.map(S=>S.id),completedSegmentIds:[],segmentStars:{},badges:[],keys:1,keyFragments:0,map:[]}};return await ur(v),v}}catch(x){console.error("[DB]  Failed to restore from Emergency Backup:",x)}if(a.length===0&&l==="exists"&&!n)return console.error("[DB]  CRITICAL: LocalStorage marker found but IDB returned 0 users. Aborting auto-seed to prevent data loss."),null;const p=e.transaction(Xt,"readonly").objectStore(Xt).count(),m=await new Promise(x=>{p.onsuccess=()=>x(p.result>0),p.onerror=()=>{console.error("[DB] Failed to check for existing data. Assuming data exists to prevent overwrite."),x(!0)}});if(!n&&a.length>0&&(l!=="exists"&&localStorage.setItem("vocab_pro_db_marker","exists"),m||sessionStorage.getItem("ielts_pro_skip_seed")==="true"))return null;let y;if(a.length===0?(y={id:$c,name:"Vocab Master",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Master",lastLogin:Date.now(),role:"Language Learner",currentLevel:"Intermediate",target:"Advanced Fluency",experience:0,level:1,peakLevel:1,adventure:{currentNodeIndex:0,energy:5,energyShards:0,unlockedChapterIds:vl.map(x=>x.id),completedSegmentIds:[],segmentStars:{},badges:[],keys:1,keyFragments:0,map:[]}},await ur(y),localStorage.setItem("vocab_pro_db_marker","exists")):(y=a[0],y.experience===void 0&&(y.experience=0),y.level===void 0&&(y.level=1),y.peakLevel===void 0&&(y.peakLevel=y.level),y.adventure||(y.adventure={currentNodeIndex:0,energy:5,energyShards:0,unlockedChapterIds:vl.map(x=>x.id),completedSegmentIds:[],segmentStars:{},badges:[],keys:1,keyFragments:0,map:[]}),await ur(y)),!m){let x=[];try{const S=await fetch(CI);if(S.ok){const N=await S.json();x=Array.isArray(N)?N:N.vocabulary||[]}}catch(S){console.error("Failed to fetch local seed data:",S)}x.length===0&&(x=RI);const v=x.map(S=>({...S,nextReview:S.nextReview||Date.now(),lastXpEarnedTime:S.lastXpEarnedTime||void 0,quality:S.quality||Ft.VERIFIED,source:"app"}));await _o(v)}return y}catch(e){return console.error("[DB] Seed check failed completely:",e),null}},_l=async()=>Pe(Sr,n=>n.objectStore(Sr).getAll(),"readonly"),ur=async n=>(n&&n.id&&localStorage.setItem("vocab_pro_db_marker","exists"),Pe(Sr,e=>e.objectStore(Sr).put(n))),QE=async(n,e)=>If(async()=>{const s=await fu();return new Promise(a=>{const d=s.transaction(Xt,"readonly").objectStore(Xt).openCursor(),p=e.trim().toLowerCase();d.onsuccess=m=>{const y=m.target.result;y?y.value.userId===n&&y.value.word.trim().toLowerCase()===p?a(y.value):y.continue():a(null)},d.onerror=()=>{a(null)}})}),WE=async(n,e)=>If(async()=>{const s=await fu();return new Promise(a=>{const l=s.transaction(Xt,"readonly").objectStore(Xt).getAll();l.onsuccess=()=>{const d=l.result,p=["To express an idea or feeling","A state of great comfort and luxury","Happening or developing gradually","To influence or change someone or something","A formal meeting for discussion","Necessary for a particular purpose","The ability to do something well","A careful and detailed study of something","To make something new or original"],x=[...Array.from(new Set(d.filter(v=>v.id!==e&&v.quality===Ft.VERIFIED&&v.meaningVi&&v.meaningVi.trim().length>0&&v.meaningVi.length<150).map(v=>v.meaningVi.trim())))].sort(()=>Math.random()-.5).slice(0,n);if(x.length<n){const v=n-x.length,S=[...p].sort(()=>Math.random()-.5);for(let N=0;N<v;N++){const z=S[N%S.length];x.includes(z)||x.push(z)}}a([...x].sort(()=>Math.random()-.5))},l.onerror=()=>{a([])}})}),KE=(n,e,s,a,o,l,d="all",p=null,m="all",y=null,x="all",v=null)=>{var z;const S=e.toLowerCase().trim();if(S&&!(n.word.toLowerCase().includes(S)||n.meaningVi.toLowerCase().includes(S))||n.isPassive&&!s.includes("archive")||a!=="all"&&(a==="refined"&&n.quality!==Ft.REFINED||a==="verified"&&n.quality!==Ft.VERIFIED||a==="failed"&&n.quality!==Ft.FAILED||a==="raw"&&n.quality!==Ft.RAW||a==="not_refined"&&n.quality!==Ft.RAW))return!1;if(o!=="all"){const D=!n.lastReview,j=!!n.lastReview&&n.consecutiveCorrect===1&&n.lastGrade!==Lt.FORGOT,P=!!n.lastReview&&n.consecutiveCorrect>1&&n.lastGrade===Lt.EASY,F=!!n.lastReview&&n.consecutiveCorrect>1&&n.lastGrade===Lt.HARD,G=!!n.lastReview&&n.lastGrade===Lt.FORGOT;if(o==="new"&&!D||o==="learned"&&!j||o==="easy"&&!P||o==="hard"&&!F||o==="forgot"&&!G)return!1}if(l!=="all"&&(n.register||"raw")!==l||d!=="all"&&(n.source||"raw")!==d)return!1;if(p){if(p==="Uncategorized"){if(n.groups&&n.groups.length>0)return!1}else if(!((z=n.groups)!=null&&z.some(D=>D.startsWith(p))))return!1}if(m!=="all"&&y){const D=y.has(n.id);if(m==="composed"&&!D||m==="not_composed"&&D)return!1}if(x!=="all"&&v){const D=v.has(n.word.toLowerCase());if(x==="in_book"&&!D||x==="not_in_book"&&D)return!1}if(s.includes("all")||s.length===0)return!n.isPassive;for(const D of s)if(D==="archive"&&n.isPassive||D==="idiom"&&n.isIdiom||D==="phrasal"&&n.isPhrasalVerb||D==="colloc"&&n.isCollocation||D==="phrase"&&n.isStandardPhrase||D==="vocab"&&!n.isIdiom&&!n.isPhrasalVerb&&!n.isCollocation&&!n.isStandardPhrase)return!0;return!1},ZE=async(n,e)=>{e&&e.id&&localStorage.setItem("vocab_pro_db_marker","exists"),await Pe([Xt,Sr],s=>{s.objectStore(Xt).put(n),s.objectStore(Sr).put(e)})},XE=async(n,e)=>{await Pe([Xt,zs],s=>{n&&s.objectStore(Xt).put(n),s.objectStore(zs).put(e)})},JE=async n=>{n.updatedAt=Date.now(),await Pe(Xt,e=>e.objectStore(Xt).put(n))},ew=async n=>{await Pe(Xt,e=>e.objectStore(Xt).delete(n))},tw=async n=>{await Pe(Xt,e=>{const s=e.objectStore(Xt);n.forEach(a=>s.delete(a))})},_o=async n=>{n.length!==0&&await Pe(Xt,e=>{const s=e.objectStore(Xt);n.forEach(a=>s.put(a))})},Ol=async()=>await Pe(Xt,n=>n.objectStore(Xt).getAll(),"readonly"),nw=async n=>{n.updatedAt=Date.now(),await Pe(zs,e=>e.objectStore(zs).put(n))},kI=async n=>{await Pe(zs,e=>e.objectStore(zs).delete(n))},Nf=async()=>await Pe(zs,n=>n.objectStore(zs).getAll(),"readonly"),LI=async n=>(await Nf()).filter(s=>s.wordIds.includes(n)),sw=async n=>{await Pe(zs,e=>{const s=e.objectStore(zs);n.forEach(a=>s.put(a))})},Dg=async()=>(await Pe(go,e=>e.objectStore(go).getAll(),"readonly")).sort((e,s)=>s.timestamp-e.timestamp),rw=async n=>{await Pe(go,e=>{const s=e.objectStore(go);n.forEach(a=>s.put(a))})},Ug=async()=>await Pe(yo,n=>n.objectStore(yo).getAll(),"readonly"),aw=async n=>{await Pe(yo,e=>{const s=e.objectStore(yo);n.forEach(a=>s.put(a))})},Pg=async()=>await Pe(xo,n=>n.objectStore(xo).getAll(),"readonly"),iw=async n=>{await Pe(xo,e=>{const s=e.objectStore(xo);n.forEach(a=>s.put(a))})},ow=async n=>{n.updatedAt=Date.now(),await Pe(Ar,e=>e.objectStore(Ar).put(n))},Vg=async()=>await Pe(Ar,n=>n.objectStore(Ar).getAll(),"readonly"),lw=async n=>{await Pe(Ar,e=>e.objectStore(Ar).delete(n))},cw=async n=>{await Pe(Ar,e=>{const s=e.objectStore(Ar);n.forEach(a=>s.put(a))})},uw=async n=>{n.updatedAt=Date.now(),await Pe(Ir,e=>e.objectStore(Ir).put(n))},zg=async()=>await Pe(Ir,n=>n.objectStore(Ir).getAll(),"readonly"),dw=async n=>{await Pe(Ir,e=>e.objectStore(Ir).delete(n))},fw=async n=>{await Pe(Ir,e=>{const s=e.objectStore(Ir);n.forEach(a=>s.put(a))})},hw=async n=>{n.updatedAt=Date.now(),await Pe(Nr,e=>e.objectStore(Nr).put(n))},Bg=async()=>await Pe(Nr,n=>n.objectStore(Nr).getAll(),"readonly"),pw=async n=>{await Pe(Nr,e=>e.objectStore(Nr).delete(n))},mw=async n=>{await Pe(Nr,e=>{const s=e.objectStore(Nr);n.forEach(a=>s.put(a))})},MI=async n=>{await Pe(Oa,e=>e.objectStore(Oa).put(n))},Fg=async()=>await Pe(Oa,n=>n.objectStore(Oa).getAll(),"readonly"),gw=async n=>{await Pe(Oa,e=>{const s=e.objectStore(Oa);n.forEach(a=>s.put(a))})},yw=async n=>{n.updatedAt=Date.now(),await Pe(Bs,e=>e.objectStore(Bs).put(n))},xw=async n=>{await Pe(Bs,e=>e.objectStore(Bs).delete(n))},DI=async()=>await Pe(Bs,n=>n.objectStore(Bs).getAll(),"readonly"),Hg=async()=>await Pe(Bs,n=>n.objectStore(Bs).getAll(),"readonly"),bw=async n=>{await Pe(Bs,e=>{const s=e.objectStore(Bs);n.forEach(a=>s.put(a))})},UI=async n=>{n.updatedAt=Date.now(),await Pe(Fs,e=>e.objectStore(Fs).put(n))},Gg=async()=>await Pe(Fs,n=>n.objectStore(Fs).getAll(),"readonly"),PI=async n=>{await Pe(Fs,e=>e.objectStore(Fs).delete(n))},vw=async n=>{await Pe(Fs,e=>{const s=e.objectStore(Fs);n.forEach(a=>s.put(a))})},VI=async n=>{await Pe(Fs,e=>{const s=e.objectStore(Fs);n.forEach(a=>s.delete(a))})},_w=async n=>{n.updatedAt=Date.now(),await Pe(Tr,e=>e.objectStore(Tr).put(n))},qg=async()=>await Pe(Tr,n=>n.objectStore(Tr).getAll(),"readonly"),Ew=async n=>{await Pe(Tr,e=>e.objectStore(Tr).delete(n))},ww=async n=>{await Pe(Tr,e=>{const s=e.objectStore(Tr);n.forEach(a=>s.put(a))})},$g=async()=>await Pe(bo,n=>n.objectStore(bo).getAll(),"readonly"),Sw=async n=>{await Pe(bo,e=>{const s=e.objectStore(bo);n.forEach(a=>s.put(a))})},Tw=async n=>{n.updatedAt=Date.now(),await Pe(Cr,e=>e.objectStore(Cr).put(n))},hu=async()=>await Pe(Cr,n=>n.objectStore(Cr).getAll(),"readonly"),Aw=async n=>{await Pe(Cr,e=>e.objectStore(Cr).delete(n))},Iw=async n=>{await Pe(Cr,e=>{const s=e.objectStore(Cr);n.forEach(a=>s.put(a))})},Nw=async n=>{await Pe(Rr,e=>e.objectStore(Rr).put(n))},pu=async()=>await Pe(Rr,n=>n.objectStore(Rr).getAll(),"readonly"),zI=async n=>{await Pe(Rr,e=>e.objectStore(Rr).delete(n))},Cw=async n=>{await Pe(Rr,e=>{const s=e.objectStore(Rr);n.forEach(a=>s.put(a))})},Yg=async()=>await Pe(vo,n=>n.objectStore(vo).getAll(),"readonly"),Rw=async n=>{await Pe(vo,e=>{const s=e.objectStore(vo);n.forEach(a=>s.put(a))})},Ow=async n=>{await Pe(Or,e=>e.objectStore(Or).put(n))},Qg=async()=>await Pe(Or,n=>n.objectStore(Or).getAll(),"readonly"),jw=async n=>{await Pe(Or,e=>e.objectStore(Or).delete(n))},kw=async n=>{await Pe(Or,e=>{const s=e.objectStore(Or);n.forEach(a=>s.put(a))})},BI=Object.freeze(Object.defineProperty({__proto__:null,bulkDeleteIrregularVerbs:VI,bulkDeleteWords:tw,bulkSaveCompositions:Iw,bulkSaveConversationItems:fw,bulkSaveFreeTalkItems:mw,bulkSaveIrregularVerbs:vw,bulkSaveLessons:ww,bulkSaveListeningItems:Sw,bulkSaveNativeSpeakItems:cw,bulkSaveParaphraseLogs:rw,bulkSavePlanningGoals:kw,bulkSaveReadingBooks:Rw,bulkSaveSpeakingLogs:aw,bulkSaveSpeakingTopics:iw,bulkSaveUnits:sw,bulkSaveWordBooks:Cw,bulkSaveWords:_o,bulkSaveWritingLogs:gw,bulkSaveWritingTopics:bw,clearVocabularyOnly:YE,deleteComposition:Aw,deleteConversationItem:dw,deleteFreeTalkItem:pw,deleteIrregularVerb:PI,deleteLesson:Ew,deleteNativeSpeakItem:lw,deletePlanningGoal:jw,deleteUnit:kI,deleteWordBook:zI,deleteWordFromDB:ew,deleteWritingTopic:xw,filterItem:KE,findWordByText:QE,getAllSpeakingLogsForExport:Ug,getAllSpeakingTopicsForExport:Pg,getAllUsers:_l,getAllWordsForExport:Ol,getAllWritingLogsForExport:Fg,getAllWritingTopicsForExport:Hg,getCompositionsByUserId:hu,getConversationItemsByUserId:zg,getFreeTalkItemsByUserId:Bg,getIrregularVerbsByUserId:Gg,getLessonsByUserId:qg,getListeningItemsByUserId:$g,getNativeSpeakItemsByUserId:Vg,getParaphraseLogs:Dg,getPlanningGoalsByUserId:Qg,getRandomMeanings:WE,getReadingBooksByUserId:Yg,getUnitsByUserId:Nf,getUnitsContainingWord:LI,getWordBooksByUserId:pu,getWritingTopicsByUserId:DI,saveComposition:Tw,saveConversationItem:uw,saveFreeTalkItem:hw,saveIrregularVerb:UI,saveLesson:_w,saveNativeSpeakItem:ow,savePlanningGoal:Ow,saveUnit:nw,saveUser:ur,saveWord:JE,saveWordAndUnit:XE,saveWordAndUser:ZE,saveWordBook:Nw,saveWritingLog:MI,saveWritingTopic:yw,seedDatabaseIfEmpty:Mg,tryPersistStorage:$E},Symbol.toStringTag,{value:"Module"})),FI=["Vietnamese","Spanish","Chinese (Simplified)","Chinese (Traditional)","Japanese","Korean","French","German","Italian","Portuguese","Russian","Arabic","Hindi","Thai","Indonesian","Turkish"],HI=[{id:"learner",label:"General Learner",icon:NE},{id:"professional",label:"Professional",icon:Q2},{id:"student",label:"Student",icon:DE}],GI=({users:n,isCreating:e,setIsCreating:s,loading:a,hasApiKey:o,newName:l,setNewName:d,newRole:p,setNewRole:m,newLevel:y,setNewLevel:x,newTarget:v,setNewTarget:S,newLanguage:N,setNewLanguage:z,newAudience:D,setNewAudience:j,selectedPersona:P,handleSelectKey:F,handlePersonaSelect:G,handleCreateProfile:H,onLogin:W})=>a?u.jsx("div",{className:"h-screen flex items-center justify-center bg-neutral-50",children:u.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[u.jsx(fn,{className:"animate-spin text-neutral-300",size:40}),u.jsx("p",{className:"text-xs font-black text-neutral-400 uppercase tracking-widest",children:"Initializing Lab..."})]})}):u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-neutral-50 p-6",children:u.jsxs("div",{className:"max-w-md w-full space-y-10",children:[u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("div",{className:"inline-flex p-4 bg-white rounded-3xl shadow-sm border border-neutral-100 mb-4",children:u.jsx(Rl,{className:"text-neutral-900",size:32})}),u.jsx("h1",{className:"text-4xl font-black text-neutral-900 tracking-tight",children:"Vocab Pro"}),u.jsx("p",{className:"text-neutral-500 font-medium italic",children:"Your words. Your context. Your mastery."})]}),!o&&n.length===0&&u.jsxs("div",{className:"bg-amber-50 border-2 border-amber-100 p-6 rounded-[2rem] space-y-4 animate-in fade-in slide-in-from-top-4",children:[u.jsxs("div",{className:"flex items-start space-x-3 text-amber-800",children:[u.jsx(Ca,{size:24,className:"shrink-0 mt-1"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-black text-lg",children:"AI Configuration Required"}),u.jsx("p",{className:"text-sm font-medium mt-1 opacity-80",children:"To enable AI word analysis and suggestions, you must select a Gemini API key."})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("button",{onClick:F,className:"w-full py-4 bg-amber-600 text-white font-black rounded-2xl shadow-lg hover:bg-amber-700 transition-all flex items-center justify-center space-x-2 active:scale-95",children:[u.jsx(cI,{size:18}),u.jsx("span",{children:"CONNECT GEMINI API"})]}),u.jsxs("a",{href:"https://ai.google.dev/gemini-api/docs/billing",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center space-x-1.5 text-[10px] font-black text-amber-600 uppercase tracking-widest hover:underline",children:[u.jsx("span",{children:"Billing Documentation"}),u.jsx(sI,{size:10})]})]})]}),e?u.jsxs("form",{onSubmit:H,className:"bg-white p-8 rounded-[2.5rem] shadow-xl border border-neutral-200 animate-in zoom-in-95 duration-300 space-y-6",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center",children:[u.jsx(TI,{className:"mr-2",size:20})," Create Profile"]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2",children:"Display Name"}),u.jsx("input",{autoFocus:!0,type:"text",value:l,onChange:Q=>d(Q.target.value),placeholder:"Enter your name",className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-md font-bold focus:ring-2 focus:ring-neutral-900 focus:outline-none"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2 flex items-center gap-2",children:[u.jsx(ME,{size:14})," Language"]}),u.jsx("select",{value:N,onChange:Q=>z(Q.target.value),className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none appearance-none",children:FI.map(Q=>u.jsx("option",{value:Q,children:Q},Q))})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2 flex items-center gap-2",children:[u.jsx(GE,{size:14})," Audience"]}),u.jsxs("select",{value:D,onChange:Q=>j(Q.target.value),className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none appearance-none",children:[u.jsx("option",{value:"Kid",children:"Kid"}),u.jsx("option",{value:"Adult",children:"Adult"})]})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest",children:"About Me (Quick Start)"}),u.jsx("div",{className:"grid grid-cols-3 gap-2",children:HI.map(Q=>{const I=Q.icon;return u.jsxs("button",{type:"button",onClick:()=>G(Q.id),className:`p-3 border-2 rounded-2xl flex flex-col items-center justify-center space-y-1.5 transition-all text-center ${P===Q.id?"bg-neutral-900 border-neutral-900 text-white shadow-lg":"bg-white border-neutral-100 text-neutral-400 hover:border-neutral-200 hover:text-neutral-900"}`,children:[u.jsx(I,{size:20}),u.jsx("span",{className:"text-[10px] font-black uppercase tracking-tight",children:Q.label})]},Q.id)})})]}),u.jsxs("div",{className:"space-y-4 pt-4 border-t border-neutral-100",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2",children:"Starting Role"}),u.jsx("input",{type:"text",value:p,onChange:Q=>m(Q.target.value),placeholder:"e.g., Working Professional, Student",className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-md font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2",children:"Current Level"}),u.jsx("input",{type:"text",value:y,onChange:Q=>x(Q.target.value),placeholder:"e.g., Intermediate",className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-md font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none"})]})]}),u.jsxs("div",{className:"flex space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 py-4 text-neutral-500 font-bold hover:bg-neutral-50 rounded-2xl transition-colors",children:"Back"}),u.jsx("button",{type:"submit",disabled:!l.trim(),className:"flex-[2] py-4 bg-neutral-900 text-white font-bold rounded-2xl shadow-lg hover:scale-[1.02] active:scale-95 transition-all disabled:opacity-50",children:"Start Learning"})]})]}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"grid grid-cols-1 gap-3",children:n.map(Q=>u.jsxs("button",{onClick:()=>W(Q),className:"bg-white p-5 rounded-3xl border border-neutral-200 shadow-sm flex items-center justify-between hover:border-neutral-900 hover:shadow-md transition-all group",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("img",{src:Q.avatar,className:"w-12 h-12 rounded-2xl bg-neutral-100 p-1",alt:Q.name}),u.jsxs("div",{className:"text-left",children:[u.jsx("div",{className:"font-bold text-neutral-900",children:Q.name}),u.jsxs("div",{className:"text-xs text-neutral-400",children:[Q.role?Q.role:"Learner","  Last seen: ",new Date(Q.lastLogin).toLocaleDateString()]})]})]}),u.jsx(of,{size:20,className:"text-neutral-300 group-hover:text-neutral-900 transition-colors"})]},Q.id))}),u.jsxs("button",{onClick:()=>s(!0),className:"w-full p-5 bg-neutral-100 border border-dashed border-neutral-300 text-neutral-500 rounded-3xl font-bold flex items-center justify-center space-x-2 hover:bg-neutral-200 transition-all",children:[u.jsx(Kr,{size:20}),u.jsx("span",{children:"Add New User"})]})]})]})}),qI=({onLogin:n})=>{const[e,s]=M.useState([]),[a,o]=M.useState(!1),[l,d]=M.useState(""),[p,m]=M.useState(""),[y,x]=M.useState(""),[v,S]=M.useState(""),[N,z]=M.useState("English"),[D,j]=M.useState("Adult"),[P,F]=M.useState("learner"),[G,H]=M.useState(!0),[W,Q]=M.useState(!0),I=[{id:"learner",role:"Vocab Learner",level:"Intermediate English",target:"Expand active vocabulary"},{id:"professional",role:"Working Professional",level:"Intermediate English",target:"Fluent business communication"},{id:"student",role:"Primary Student",level:"Beginner English",target:"Build school vocabulary"}];M.useEffect(()=>{T()},[]),M.useEffect(()=>{a&&C("learner")},[a]);const T=async()=>{H(!0);try{if(window.aistudio){const O=await window.aistudio.hasSelectedApiKey();Q(O)}const L=(await _l()).filter(O=>!O.name.toLowerCase().includes("book"));s(L)}catch(L){console.error("Auth initialization error:",L)}finally{H(!1)}},_=async()=>{window.aistudio&&(await window.aistudio.openSelectKey(),Q(!0))},C=L=>{const O=I.find(_e=>_e.id===L);O&&(F(L),m(O.role),x(O.level),S(O.target),j(L==="student"?"Kid":"Adult"))},R=async L=>{if(L.preventDefault(),!l.trim())return;const O={id:"u-"+Date.now(),name:l.trim(),avatar:`https://api.dicebear.com/7.x/avataaars/svg?seed=${l}`,lastLogin:Date.now(),role:p.trim(),currentLevel:y.trim(),target:v.trim(),nativeLanguage:N,experience:0,level:1,peakLevel:1,adventure:{currentNodeIndex:0,energyShards:0,energy:5,keys:1,keyFragments:0,badges:[],unlockedChapterIds:vl.map(_e=>_e.id),completedSegmentIds:[],segmentStars:{}},lessonPreferences:{language:N,targetAudience:D,tone:D==="Kid"?"friendly_elementary":"professional_professor"}};await ur(O),n(O)};return u.jsx(GI,{users:e,isCreating:a,setIsCreating:o,loading:G,hasApiKey:W,newName:l,setNewName:d,newRole:p,setNewRole:m,newLevel:y,setNewLevel:x,newTarget:v,setNewTarget:S,newLanguage:N,setNewLanguage:z,newAudience:D,setNewAudience:j,selectedPersona:P,handleSelectKey:_,handlePersonaSelect:C,handleCreateProfile:R,onLogin:n})},Lw=M.createContext(void 0),$I=({children:n})=>{const[e,s]=M.useState([]),a=M.useCallback(l=>{s(d=>d.filter(p=>p.id!==l))},[]),o=M.useCallback((l,d="info",p=3e3)=>{const m=Date.now().toString()+Math.random(),y={id:m,type:d,message:l};s(x=>[...x,y]),p>0&&setTimeout(()=>{a(m)},p)},[a]);return u.jsxs(Lw.Provider,{value:{showToast:o},children:[n,u.jsx("div",{className:"fixed top-6 left-1/2 -translate-x-1/2 z-[9999] flex flex-col gap-2 w-full max-w-sm px-4 pointer-events-none",children:e.map(l=>u.jsxs("div",{className:`
              pointer-events-auto flex items-center justify-between p-4 rounded-2xl shadow-xl border backdrop-blur-md animate-in slide-in-from-top-2 fade-in duration-300
              ${l.type==="success"?"bg-neutral-900/90 text-white border-neutral-800":""}
              ${l.type==="error"?"bg-red-500/90 text-white border-red-600":""}
              ${l.type==="info"?"bg-white/90 text-neutral-900 border-neutral-200":""}
            `,children:[u.jsxs("div",{className:"flex items-center gap-3",children:[l.type==="success"&&u.jsx(Er,{size:20,className:"text-green-400"}),l.type==="error"&&u.jsx(Ca,{size:20,className:"text-white"}),l.type==="info"&&u.jsx(PE,{size:20,className:"text-blue-500"}),u.jsx("span",{className:"text-sm font-bold leading-tight",children:l.message})]}),u.jsx("button",{onClick:()=>a(l.id),className:"p-1 hover:opacity-70 transition-opacity ml-4",children:u.jsx(Rn,{size:16})})]},l.id))})]})},ea=()=>{const n=M.useContext(Lw);if(!n)throw new Error("useToast must be used within a ToastProvider");return n},R5={locked_chest:{name:"Locked Chest",icon:""},lucky_dice:{name:"Lucky Dice",icon:""},badge_of_courage:{name:"Badge of Courage",icon:""},badge_of_wisdom:{name:"Badge of Wisdom",icon:""},badge_of_strength:{name:"Badge of Strength",icon:""},badge_of_speed:{name:"Badge of Speed",icon:""},badge_of_endurance:{name:"Badge of Endurance",icon:""},badge_of_precision:{name:"Badge of Precision",icon:""},badge_of_focus:{name:"Badge of Focus",icon:""},badge_of_logic:{name:"Badge of Logic",icon:""},badge_of_creativity:{name:"Badge of Creativity",icon:""},badge_of_eloquence:{name:"Badge of Eloquence",icon:""},badge_of_resilience:{name:"Badge of Resilience",icon:""},badge_of_harmony:{name:"Badge of Harmony",icon:""},badge_of_vitality:{name:"Badge of Vitality",icon:""},badge_of_willpower:{name:"Badge of Willpower",icon:""},badge_of_serenity:{name:"Badge of Serenity",icon:""},badge_of_insight:{name:"Badge of Insight",icon:""},badge_of_mystery:{name:"Badge of Mystery",icon:""},badge_of_adventure:{name:"Badge of Adventure",icon:""},badge_of_fortune:{name:"Badge of Fortune",icon:""},badge_of_innovation:{name:"Badge of Innovation",icon:""}},gv=[{name:"Cyber Sentinel",image:"",hp:20,dialogueIntro:"Logic is absolute. Prove yours.",dialogueWin:"Error... System... Crash...",dialogueLose:"Your logic is flawed."},{name:"Inferno Dragon",image:"",hp:25,dialogueIntro:"I breathe fire. What do you breathe?",dialogueWin:"Your spirit burns brighter...",dialogueLose:"Burn to ash!"},{name:"Abyssal Kraken",image:"",hp:20,dialogueIntro:"The depths hold many secrets.",dialogueWin:"You have navigated the abyss.",dialogueLose:"Join the sunken ones."},{name:"Spectral Wraith",image:"",hp:15,dialogueIntro:"Can you touch what isn't there?",dialogueWin:"I fade into the light...",dialogueLose:"Your soul is mine."},{name:"Ancient Mummy",image:"",hp:20,dialogueIntro:"My curse is eternal.",dialogueWin:"Rest... finally...",dialogueLose:"Join my tomb."},{name:"Alien Warlord",image:"",hp:20,dialogueIntro:"Your language is primitive.",dialogueWin:"Acknowledged. You are superior.",dialogueLose:"Earth is ours."},{name:"Primal T-Rex",image:"",hp:25,dialogueIntro:"ROOOARRR! The earth shakes beneath me!",dialogueWin:"Extinction... comes for me...",dialogueLose:"You are merely prey."},{name:"Shadow Ninja",image:"",hp:18,dialogueIntro:"Silence is the loudest scream.",dialogueWin:"Honorable defeat...",dialogueLose:"Too slow."},{name:"Vampire Lord",image:"",hp:20,dialogueIntro:"The night is young.",dialogueWin:"The sun... it burns...",dialogueLose:"Delicious."},{name:"Oni Warlord",image:"",hp:22,dialogueIntro:"Face the demon within!",dialogueWin:"Your spirit is unbreakable.",dialogueLose:"Another soul for the mask."},{name:"Syntax Serpent",image:"",hp:20,dialogueIntro:"Untangle my sentences if you can.",dialogueWin:"Your logic is impeccable.",dialogueLose:"Your structure is flawed."},{name:"Dread Scorpion",image:"",hp:25,dialogueIntro:"One sting is all it takes.",dialogueWin:"My venom... ineffective?",dialogueLose:"Paralyzed by fear."}];function Yc(n){const e=[];let s=0;for(let a=0;a<n;a++){const o={id:a,type:"standard"};if((a+1)%10===0)o.type="boss",o.boss_details=gv[s%gv.length],s++;else{const l=Math.random();l<.1?o.type="treasure":l<.3&&(o.type="key_fragment")}e.push(o)}return e}Yc(100);const Is={userId:"uid",word:"w",ipaUs:"i_us",ipaUk:"i_uk",pronSim:"ps",ipaMistakes:"im",meaningVi:"m",example:"ex",collocationsArray:"col",idiomsList:"idm",note:"nt",tags:"tg",groups:"gr",createdAt:"ca",updatedAt:"ua",wordFamily:"fam",prepositions:"prp",paraphrases:"prph",register:"reg",isIdiom:"is_id",isPhrasalVerb:"is_pv",isCollocation:"is_col",isStandardPhrase:"is_phr",isIrregular:"is_irr",isExampleLocked:"is_exl",isPassive:"is_pas",quality:"q",source:"s",nextReview:"nr",interval:"iv",easeFactor:"ef",consecutiveCorrect:"cc",lastReview:"lr",lastGrade:"lg",forgotCount:"fc",lastTestResults:"ltr",lastXpEarnedTime:"lxp",gameEligibility:"ge",masteryScore:"ms",complexity:"cx",topic:"tp",icon:"ic",words:"wds",color:"clr",titleColor:"tc",titleSize:"ts",d:"ds",text:"x",isIgnored:"g",prep:"p",usage:"u",tone:"t",context:"c",anchor:"anch",sentence:"sent",nouns:"ns",verbs:"v",adjs:"j",advs:"d",standard:"std",answers:"ans",speakers:"spks",sentences:"snts",speakerName:"sn",voiceName:"vn",accentCode:"ac",sex:"sx",title:"tl",content:"ct",sentenceScores:"ss"},Wg=Object.fromEntries(Object.entries(Is).map(([n,e])=>[e,n])),Fm={name:"n",avatar:"av",lastLogin:"ll",role:"r",currentLevel:"cl",target:"t",nativeLanguage:"nl",experience:"xp",level:"lv",peakLevel:"pl",adventure:"adv",adventureLastDailyStar:"alds",unlockedChapterIds:"uc",completedSegmentIds:"cs",segmentStars:"ss",badges:"b",keys:"k",keyFragments:"kf",currentNodeIndex:"cni",energy:"e",energyShards:"es",map:"m"},yv=Object.fromEntries(Object.entries(Fm).map(([n,e])=>[e,n])),Mw={COLLO_CONNECT:"cc",MEANING_MATCH:"mm",IPA_SORTER:"is",SENTENCE_SCRAMBLE:"ss",PREPOSITION_POWER:"pp",WORD_TRANSFORMER:"wt",IDIOM_CONNECT:"ic",PARAPHRASE_CONTEXT:"pc"},YI=Object.fromEntries(Object.entries(Mw).map(([n,e])=>[e,n])),Dw={SPELLING:"sp",IPA_QUIZ:"iq",PREPOSITION_QUIZ:"pq",WORD_FAMILY:"wf",MEANING_QUIZ:"mq",PARAPHRASE_QUIZ:"prq",SENTENCE_SCRAMBLE:"sc",HETERONYM_QUIZ:"hq",PRONUNCIATION:"p",COLLOCATION_QUIZ:"cq",IDIOM_QUIZ:"idq",PARAPHRASE_CONTEXT_QUIZ:"pcq",WORD_FAMILY_NOUNS:"wf_n",WORD_FAMILY_VERBS:"wf_v",WORD_FAMILY_ADJS:"wf_j",WORD_FAMILY_ADVS:"wf_d"},QI=Object.fromEntries(Object.entries(Dw).map(([n,e])=>[e,n])),Uw={intensified:"int",softened:"sft",synonym:"syn",academic:"acd",casual:"cas",idiomatic:"idm"},WI=Object.fromEntries(Object.entries(Uw).map(([n,e])=>[e,n])),lf={user:!0,vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,mimic:!0,wordBook:!0,planning:!0};function Pw(n,e){return n&&(e==="paraphrases"?n.map(s=>{const a={[Is.word]:s.word,[Is.tone]:Uw[s.tone]||s.tone,[Is.context]:s.context};return s.isIgnored===!0&&(a[Is.isIgnored]=!0),a}):n.map(s=>{if(typeof s!="object"||s===null)return s;const a={};for(const o in s)if(Object.prototype.hasOwnProperty.call(s,o)){const l=s[o];if(l===!1)continue;a[Is[o]||o]=l}return a}))}function KI(n){if(!n)return n;const e={},s=["nouns","verbs","adjs","advs"];for(const a of s)if(n[a]){const o=Is[a]||a;e[o]=Pw(n[a],a)}return e}function Yr(n){const e={};for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s)||s==="tags"||s==="v2"||s==="v3"||s==="ipa"||s==="needsPronunciationFocus")continue;const a=n[s];if(a===!1)continue;const o=Is[s]||s;if(["collocationsArray","idiomsList","prepositions","paraphrases","words","speakers","sentences","answers"].includes(s))e[o]=Pw(a,s);else if(s==="wordFamily")e[o]=KI(a);else if(s==="lastTestResults"&&a){const l={},d=new Set(["WORD_FAMILY","WORD_FAMILY_NOUNS","WORD_FAMILY_VERBS","WORD_FAMILY_ADJS","WORD_FAMILY_ADVS","wf","wf_n","wf_v","wf_j","wf_d"]);for(const p in a)if(Object.prototype.hasOwnProperty.call(a,p)){if(d.has(p))continue;const m=p.split(":");if(m[0]==="WORD_FAMILY"&&m.length===2)continue;const y=m[0],v=[Dw[y]||y,...m.slice(1)].join(":");l[v]=a[p]}e[o]=l}else s==="gameEligibility"&&Array.isArray(a)?e[o]=a.map(l=>Mw[l]||l):e[o]=a}return e}function Vw(n){const e={};for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s))continue;const a=n[s],o=Fm[s]||s;if(s==="adventure"&&a){const l={};for(const d in a){if(!Object.prototype.hasOwnProperty.call(a,d))continue;const p=Fm[d]||d;l[p]=a[d]}e[o]=l}else e[o]=a}return e}function zw(n,e){return n&&(e==="paraphrases"?n.map(s=>{const a={word:s[Is.word],tone:WI[s[Is.tone]]||s[Is.tone],context:s[Is.context]};return s[Is.isIgnored]!==void 0?a.isIgnored=s[Is.isIgnored]:a.isIgnored=!1,a}):n.map(s=>{if(typeof s!="object"||s===null)return s;const a={};for(const o in s)if(Object.prototype.hasOwnProperty.call(s,o)){const l=Wg[o]||o;if(["nouns","verbs","adjs","advs"].includes(e)&&(l==="ipa"||l==="ipaUs"||l==="ipaUk"))continue;a[l]=s[o]}return a}))}function ZI(n){const e={};for(const s in n){const a=Wg[s]||s;e[a]=zw(n[s],a)}return e}function ul(n){const e={};for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s))continue;const a=n[s],o=Wg[s]||s;if(!(o==="tags"||o==="v2"||o==="v3"||o==="needsPronunciationFocus")){if(s==="i"&&!e.ipaUs){e.ipaUs=a;continue}if(o==="ipa"){e.ipaUs||(e.ipaUs=a);continue}if(["collocationsArray","idiomsList","prepositions","paraphrases","words","speakers","sentences","answers"].includes(o))e[o]=zw(a,o);else if(o==="wordFamily"&&a)e[o]=ZI(a);else if(o==="lastTestResults"&&a){const l={};for(const d in a)if(Object.prototype.hasOwnProperty.call(a,d)){const p=d.split(":"),m=p[0],x=[QI[m]||m,...p.slice(1)].join(":");l[x]=a[d]}e[o]=l}else o==="gameEligibility"&&Array.isArray(a)?e[o]=a.map(l=>YI[l]||l):e[o]=a}}return e}function XI(n){const e={};for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s))continue;const a=n[s],o=yv[s]||s;if(o==="adventure"&&a){const l={};for(const d in a){if(!Object.prototype.hasOwnProperty.call(a,d))continue;const p=yv[d]||d;l[p]=a[d]}e[o]=l}else e[o]=a}return e}function JI(n){if(!n)return n;const e={...n};if(e.ipa&&!e.ipaUs&&(e.ipaUs=e.ipa),delete e.v2,delete e.v3,delete e.tags,delete e.ipa,delete e.needsPronunciationFocus,e.isIdiom===void 0&&(e.isIdiom=!1),e.isPhrasalVerb===void 0&&(e.isPhrasalVerb=!1),e.isCollocation===void 0&&(e.isCollocation=!1),e.isStandardPhrase===void 0&&(e.isStandardPhrase=!1),e.isIrregular===void 0&&(e.isIrregular=!1),e.isPassive===void 0&&(e.isPassive=!1),e.wordFamily){const s=a=>Array.isArray(a)?a.map(o=>{const l={...o};return delete l.ipa,delete l.ipaUs,delete l.ipaUk,l}):a;e.wordFamily.nouns&&(e.wordFamily.nouns=s(e.wordFamily.nouns)),e.wordFamily.verbs&&(e.wordFamily.verbs=s(e.wordFamily.verbs)),e.wordFamily.adjs&&(e.wordFamily.adjs=s(e.wordFamily.adjs)),e.wordFamily.advs&&(e.wordFamily.advs=s(e.wordFamily.advs))}return e}const Bw=async(n,e,s=lf)=>new Promise(a=>{const o=s&&typeof s=="object"&&typeof s.vocabulary=="boolean"?s:lf,l=new FileReader;l.onload=async d=>{var p;try{const m=JSON.parse((p=d.target)==null?void 0:p.result),y=m.ca?new Date(m.ca).getTime():void 0,x=Array.isArray(m)?m:m.vocabulary||m.vocab||[];let S=x.length>0&&(x[0].uid||!x[0].userId)?x.map(ul):x;S=S.map(JI);const N=Array.isArray(m)?void 0:m.units||m.u,z=Array.isArray(m)?void 0:m.paraphraseLogs||m.pl,D=Array.isArray(m)?void 0:m.speakingTopics||m.st,j=Array.isArray(m)?void 0:m.speakingLogs||m.sl,P=Array.isArray(m)?void 0:m.writingTopics||m.wt,F=Array.isArray(m)?void 0:m.writingLogs||m.wl,G=Array.isArray(m)?void 0:m.irregularVerbs||m.iv,H=Array.isArray(m)?void 0:m.lessons,W=Array.isArray(m)?void 0:m.listeningItems,Q=Array.isArray(m)?void 0:m.nativeSpeakItems||m.nsi,I=Q?Q.map(ul):void 0,T=Array.isArray(m)?void 0:m.conversationItems||m.ci,_=T?T.map(ul):void 0,C=Array.isArray(m)?void 0:m.freeTalkItems||m.fti,R=C?C.map(ul):void 0,L=Array.isArray(m)?void 0:m.compositions,O=Array.isArray(m)?void 0:m.mimicQueue,_e=Array.isArray(m)?void 0:m.wordBooks||m.wb,ye=_e?_e.map(ul):void 0,B=Array.isArray(m)?void 0:m.readingShelves||m.rs,le=Array.isArray(m)?void 0:m.readingBooks||m.rb,se=Array.isArray(m)?void 0:m.planningGoals||m.pg,Z=Array.isArray(m)?void 0:m.user;let Y;Z&&(Y="n"in Z||"av"in Z?XI(Z):Z);const A=Y?Y.id:e,V=Array.isArray(m)?void 0:m.customAdventure||m.adv,q=Array.isArray(m)?void 0:m.settings||m.sys;if(!Array.isArray(S))throw new Error("Invalid JSON: 'vocabulary' array missing.");let X=0,de=0,ce=0;if(o.vocabulary){const ie=await Ol(e),Ae=new Map(ie.map(xe=>[xe.word.toLowerCase().trim(),xe])),he=[];for(const xe of S){if(!xe.word)continue;const je=Ae.get(xe.word.toLowerCase().trim());if(je)(xe.updatedAt||0)>(je.updatedAt||0)?(he.push({...je,...xe,id:je.id,userId:A,updatedAt:Date.now()}),de++):ce++;else{const pe=Date.now();he.push({...xe,id:xe.id||`w-${pe}-${Math.random()}`,userId:A,createdAt:xe.createdAt||pe,updatedAt:pe}),X++}}he.length>0&&await _o(he)}o.reading&&(N&&await sw(N.map(ie=>({...ie,userId:A}))),le&&await Rw(le.map(ie=>({...ie,userId:A}))),B&&localStorage.setItem("reading_books_shelves",JSON.stringify(B))),(o.lesson||o.writing)&&z&&await rw(z.map(ie=>({...ie,userId:A}))),o.speaking&&(D&&await iw(D.map(ie=>({...ie,userId:A}))),j&&await aw(j.map(ie=>({...ie,userId:A}))),I&&await cw(I.map(ie=>({...ie,userId:A}))),_&&await fw(_.map(ie=>({...ie,userId:A}))),R&&await mw(R.map(ie=>({...ie,userId:A})))),o.writing&&(P&&await bw(P.map(ie=>({...ie,userId:A}))),F&&await gw(F.map(ie=>({...ie,userId:A}))),L&&await Iw(L.map(ie=>({...ie,userId:A})))),o.lesson&&(G&&await vw(G.map(ie=>({...ie,userId:A}))),H&&await ww(H.map(ie=>({...ie,userId:A})))),o.listening&&W&&await Sw(W.map(ie=>({...ie,userId:A}))),o.mimic&&O&&localStorage.setItem("vocab_pro_mimic_practice_queue",JSON.stringify(O)),o.wordBook&&ye&&await Cw(ye.map(ie=>({...ie,userId:A}))),o.planning&&se&&await kw(se.map(ie=>({...ie,userId:A})));let fe;if(o.user&&Y){const ie={...Y,id:A};await ur(ie),fe=ie}V&&o.user&&(V.ch&&localStorage.setItem("vocab_pro_adventure_chapters",JSON.stringify(V.ch)),V.b&&localStorage.setItem("vocab_pro_custom_badges",JSON.stringify(V.b))),o.user&&q&&(localStorage.setItem("vocab_pro_system_config",JSON.stringify(q)),window.dispatchEvent(new Event("config-updated"))),a({type:"success",message:"Restore data successfully",detail:`Words: ${X} new, ${de} updated.`,updatedUser:fe,backupTimestamp:y})}catch(m){a({type:"error",message:"JSON Import Error",detail:m.message})}},l.readAsText(n)}),eN=async(n,e,s=lf)=>{const a=s&&typeof s=="object"&&typeof s.vocabulary=="boolean"?s:lf,[o,l,d,p,m,y,x,v,S,N,z,D,j,P,F,G,H]=await Promise.all([a.vocabulary?Ol():[],a.reading?Nf():[],a.reading?Yg():[],a.lesson||a.writing?Dg():[],a.speaking?Pg():[],a.speaking?Ug():[],a.speaking?Vg():[],a.speaking?zg():[],a.speaking?Bg():[],a.writing?Hg():[],a.writing?Fg():[],a.writing?hu():[],a.lesson?Gg():[],a.lesson?qg():[],a.listening?$g():[],a.wordBook?pu():[],a.planning?Qg():[]]),W=localStorage.getItem("vocab_pro_mimic_practice_queue"),Q=localStorage.getItem("vocab_pro_adventure_chapters"),I=localStorage.getItem("vocab_pro_custom_badges"),T=localStorage.getItem("reading_books_shelves"),_=localStorage.getItem("vocab_pro_system_config");return{v:8,ca:new Date().toISOString(),user:Vw(e),vocab:o.map(C=>Yr(C)),u:l,pl:p,st:m,sl:y,wt:N,wl:z,iv:j,lessons:P,listeningItems:F,nativeSpeakItems:x.map(C=>Yr(C)),conversationItems:v.map(C=>Yr(C)),freeTalkItems:S.map(C=>Yr(C)),compositions:D,mimicQueue:W?JSON.parse(W):[],wordBooks:G.map(C=>Yr(C)),readingBooks:d,pg:H,adv:{ch:Q?JSON.parse(Q):null,b:I?JSON.parse(I):null},readingShelves:T?JSON.parse(T):null,settings:_?JSON.parse(_):null}},O5=async(n,e)=>{const s={v:8,ca:new Date().toISOString(),u:n,user:{id:e}},a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download=`vocab-pro-units-${new Date().toISOString().split("T")[0]}.json`,l.click(),URL.revokeObjectURL(o)},tN={initialEasy:4,initialHard:1,easyEasy:2.5,hardEasy:2,hardHard:1.3,easyHardPenalty:.5,forgotInterval:1},nN={host:"localhost",port:3e3,useCustomUrl:!1,customUrl:"",backupPath:"backups"},sN={mode:"system",preferredSystemVoice:"",appliedAccent:"US"},rN={max_learn_per_day:10,max_review_per_day:10},aN={preferredTypes:[]},iN={topic1Options:["Grammar","Vocabulary","Pronunciation"],topic2Options:{Grammar:["Tenses","Conditionals","Passive Voice","Reported Speech"],Vocabulary:["Topic: Work","Topic: Environment","Collocations","Idioms"],Pronunciation:["Vowel Sounds","Consonant Sounds","Intonation"]}},oN={autoBackupEnabled:!1,autoBackupInterval:60,lastSyncTime:null},xv={server:nN,ai:{enableGeminiApi:!0,modelForComplexTasks:"gemini-3-pro-preview",modelForBasicTasks:"gemini-3-flash-preview",modelForTts:"gemini-2.5-flash-preview-tts"},srs:tN,audio:sN,audioCoach:{activeCoach:"female",coaches:{male:{name:"Victor",avatar:"man_teacher",persona:"professional_professor",enVoice:"",enAccent:"en_US",viVoice:"",viAccent:"vi_VN"},female:{name:"Sofia",avatar:"woman_teacher",persona:"friendly_elementary",enVoice:"",enAccent:"en_US",viVoice:"",viAccent:"vi_VN"}}},dailyGoals:rN,interface:{studyBuddyLanguage:"vi",buddyVoiceEnabled:!1,studyBuddyAvatar:"woman_teacher",junkTags:["ielts","general","common"],rightClickCommandEnabled:!0},test:aN,lesson:iN,sync:oN},Fw="vocab_pro_system_config";function Qp(n){return n&&typeof n=="object"&&!Array.isArray(n)}function Hw(n,e){const s={...n};if(Qp(n)&&Qp(e))for(const a of Object.keys(e))Qp(e[a])?a in n?s[a]=Hw(n[a],e[a]):Object.assign(s,{[a]:e[a]}):Object.assign(s,{[a]:e[a]});return s}const Bn=n=>n.server.useCustomUrl&&n.server.customUrl?n.server.customUrl.replace(/\/$/,""):`https://${n.server.host}:${n.server.port}`;function wt(){const n=localStorage.getItem(Fw),e=n?JSON.parse(n):null;if(!e)return xv;const s=Hw(xv,e);return e.audio&&e.audio.serverPort&&e.audio.serverUrl,s}function qr(n,e=!1){try{localStorage.setItem(Fw,JSON.stringify(n)),window.dispatchEvent(new Event("config-updated")),e||window.dispatchEvent(new Event("vocab-pro-trigger-backup"))}catch(s){console.error("Failed to save system config.",s)}}const lN=["i:","","u:","","","e","",":","",":","e","","s","","t","d","","","t","d","n","l","","v","w"],cN=n=>!n||n.length<2?!1:lN.some(e=>{if(e==="t"||e==="d")return n.includes(e);const s=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");let a;return e==="d"?a=new RegExp(`${s}(?!)`):e==="t"?a=new RegExp(`${s}(?!)`):e===""?a=new RegExp(`(?<!t)${s}`):e===""?a=new RegExp(`(?<!d)${s}`):e===""?a=new RegExp(`(?<![ae])${s}`):e===""?a=new RegExp(`(?<![a])${s}`):e==="e"?a=new RegExp(`${s}(?!)`):a=new RegExp(s),a.test(n)}),jr=n=>{if(n.quality!==Ft.VERIFIED||!n.lastReview)return[];const e=[];return n.collocationsArray&&n.collocationsArray.some(s=>!s.isIgnored)&&e.push("COLLO_CONNECT"),n.word&&n.meaningVi&&n.meaningVi.trim().length>0&&e.push("MEANING_MATCH"),n.ipaUs&&cN(n.ipaUs)&&e.push("IPA_SORTER"),n.example&&n.example.trim().split(/\s+/).filter(Boolean).length>=5&&e.push("SENTENCE_SCRAMBLE"),n.example&&n.example.trim().split(/\s+/).filter(Boolean).length>=4&&e.push("DICTATION"),n.example&&n.prepositions&&n.prepositions.some(s=>!s.isIgnored)&&e.push("PREPOSITION_POWER"),n.paraphrases&&n.paraphrases.filter(s=>!s.isIgnored&&s.context&&s.context.trim()).length>=2&&e.push("PARAPHRASE_CONTEXT"),e};function bv(n,e){const s=.95+Math.random()*.1,a=Math.max(1,e*s),o=new Date(n);return o.setHours(0,0,0,0),o.setDate(o.getDate()+Math.round(a)),o.getTime()}function Gw(n,e){const s=wt().srs,a={...n},o=Date.now();if(e===Lt.LEARNED)a.consecutiveCorrect=1,a.interval=s.initialHard,a.nextReview=bv(o,s.initialHard);else{let l=n.interval||0,d=1;const p=1440*60*1e3,m=n.lastReview||o,y=Math.max(0,(o-m)/p),x=y>l;if(e===Lt.FORGOT)d=s.forgotInterval,a.consecutiveCorrect=0,a.forgotCount+=1;else if(e===Lt.HARD)n.lastGrade===Lt.EASY?d=Math.max(1,Math.floor(l*s.easyHardPenalty)):d=l===0?s.initialHard:Math.max(1,Math.floor(l*s.hardHard)),a.consecutiveCorrect+=1;else if(e===Lt.EASY){let v=l;x&&(v=Math.max(l,y)),n.lastGrade===Lt.HARD?d=l===0?s.initialEasy:Math.max(s.initialEasy,Math.floor(v*s.hardEasy)):d=l===0?s.initialEasy:Math.max(s.initialEasy,Math.floor(v*s.easyEasy)),a.consecutiveCorrect+=1}a.interval=Math.round(d),a.nextReview=bv(o,a.interval)}return a.lastGrade=e,a.lastReview=o,a.updatedAt=o,a.complexity=kr(a),a.masteryScore=Ns(a),a.gameEligibility=jr(a),a}function qw(n){const e=Date.now(),s={...n,nextReview:e,interval:0,easeFactor:2.5,consecutiveCorrect:0,forgotCount:0,lastGrade:void 0,lastReview:void 0,updatedAt:e,lastXpEarnedTime:void 0,lastTestResults:n.lastTestResults??{},masteryScore:n.masteryScore};return s.complexity=kr(s),s.gameEligibility=jr(s),s}function uN(n){const e=Date.now(),s=n-e,a=1440*60*1e3;if(s<=0)return{label:"DUE",urgency:"due"};const o=Math.ceil(s/a);return{label:`${o}d`,urgency:o<=1?"soon":"later"}}function $w(n,e,s,a,o,l,d=!1,p=!1,m=!1,y=!1,x=!1,v="manual"){const S=Date.now(),N={id:crypto.randomUUID?crypto.randomUUID():"id-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),userId:"",word:n.trim(),ipaUs:e.trim(),meaningVi:s.trim(),example:a.trim(),note:o,groups:l,isIdiom:d,isPhrasalVerb:p,isCollocation:m,isStandardPhrase:y,isPassive:x,register:"raw",quality:Ft.RAW,source:v,isExampleLocked:!1,createdAt:S,updatedAt:S,nextReview:S,interval:0,easeFactor:2.5,consecutiveCorrect:0,forgotCount:0,lastTestResults:{}};return N.complexity=kr(N),N.masteryScore=Ns(N),N.gameEligibility=jr(N),N}function Kg(n){const e=[];if(e.push({key:"spelling",testKeys:["SPELLING"]}),n.ipaUs&&e.push({key:"pronunciation",testKeys:["PRONUNCIATION"]}),n.ipaUs&&n.ipaUs.trim()&&n.ipaMistakes&&n.ipaMistakes.length>0&&e.push({key:"ipa_recognition",testKeys:["IPA_QUIZ"]}),n.meaningVi&&n.meaningVi.trim()&&e.push({key:"meaning",testKeys:["MEANING_QUIZ"]}),n.example&&n.example.trim()&&e.push({key:"context",testKeys:["SENTENCE_SCRAMBLE"]}),n.collocationsArray&&n.collocationsArray.filter(s=>!s.isIgnored&&s.d&&s.d.trim()).forEach(s=>{const a=s.text;e.push({key:`colloc:${a}`,testKeys:[`COLLOCATION_QUIZ:${a}`,`COLLOCATION_MULTICHOICE_QUIZ:${a}`,`COLLOCATION_CONTEXT_QUIZ:${a}`]})}),n.idiomsList&&n.idiomsList.filter(s=>!s.isIgnored&&s.d&&s.d.trim()).forEach(s=>{const a=s.text;e.push({key:`idiom:${a}`,testKeys:[`IDIOM_QUIZ:${a}`,`IDIOM_CONTEXT_QUIZ:${a}`]})}),n.prepositions&&n.prepositions.filter(s=>!s.isIgnored).forEach(s=>{const a=s.prep;e.push({key:`prep:${a}`,testKeys:[`PREPOSITION_QUIZ:${a}`]})}),n.paraphrases&&n.paraphrases.filter(s=>!s.isIgnored&&s.context&&s.context.trim()).forEach(s=>{const a=s.word;e.push({key:`para:${a}`,testKeys:[`PARAPHRASE_QUIZ:${a}`,`PARAPHRASE_CONTEXT_QUIZ:${a}`]})}),n.wordFamily){const s=["nouns","verbs","adjs","advs"],a={nouns:"n",verbs:"v",adjs:"j",advs:"d"},o=n.word.toLowerCase(),l=s.flatMap(d=>{const p=n.wordFamily[d];return Array.isArray(p)?p.filter(m=>!m.isIgnored&&m.word):[]});l.length===1&&l[0].word.toLowerCase()===o||s.forEach(d=>{const p=n.wordFamily[d];Array.isArray(p)&&p.filter(m=>!m.isIgnored&&m.word).forEach(m=>{const y=m.word,x=a[d];e.push({key:`fam:${x}:${y}`,testKeys:[`WORD_FAMILY:${x}:${y}`]})})})}return e}function kr(n){return Kg(n).length}function Ns(n){const e=Kg(n);if(e.length===0)return 0;const s=n.lastTestResults||{};let a=0;const o=[],l=[];e.forEach(p=>{p.testKeys.length>0&&p.testKeys.some(y=>s[y]===!0)?(a++,o.push(p.key)):l.push({key:p.key,reason:`None of [${p.testKeys.join(", ")}] passed.`})});const d=Math.round(a/e.length*100);return Math.max(0,Math.min(100,d))}let El=!1,Zd=!1,as=new Map;const ja=new Set,xi=new Set,Eo=new Map;let Qc=null,Yw={reviewCounts:{total:0,due:0,new:0,learned:0,mastered:0,statusForgot:0,statusHard:0,statusEasy:0,statusLearned:0},dashboardStats:{categories:{vocab:{total:0,learned:0},idiom:{total:0,learned:0},phrasal:{total:0,learned:0},colloc:{total:0,learned:0},phrase:{total:0,learned:0},preposition:{total:0,learned:0}},refinedCount:0,rawCount:0},dayProgress:{learned:0,reviewed:0,learnedWords:[],reviewedWords:[]}};function hn(){localStorage.setItem("vocab_pro_local_last_modified",String(Date.now()))}let Ra=null,ui=null;async function vv(){Ra&&(clearTimeout(Ra),Ra=null),ui&&(clearTimeout(ui),ui=null);try{const n=Array.from(as.values()),e=JSON.stringify(n);if(localStorage.setItem("vocab_pro_emergency_backup",e),Qc){const s=(await _l()).find(a=>a.id===Qc);s&&await Xd(Qc,s)}}catch(n){console.warn("[DataStore] Backup failed:",n)}}function Hm(){Ra&&(clearTimeout(Ra),Ra=null),ui&&(clearTimeout(ui),ui=null),co&&(clearTimeout(co),co=null)}function nn(){if(window.isRestoring)return;const e=(wt().sync.autoBackupInterval||60)*1e3,s=Math.max(e*3,3e5);Ra&&clearTimeout(Ra);const a=Date.now()+e;window.dispatchEvent(new CustomEvent("backup-scheduled",{detail:{targetTime:a}})),Ra=window.setTimeout(vv,e),ui||(ui=window.setTimeout(()=>{vv()},s))}function Ao(n){const e=Date.now(),a=Array.from(as.values()).filter(W=>!W.isPassive&&W.userId===n),o=a.length,l=a.filter(W=>W.lastReview&&W.nextReview<=e&&W.quality!==Ft.FAILED).length,d=a.filter(W=>!W.lastReview&&W.quality===Ft.VERIFIED).length,p=a.filter(W=>W.interval>21).length,m=a.filter(W=>!!W.lastReview&&W.interval<=21),y=m.length,x=m.filter(W=>W.lastGrade===Lt.FORGOT).length,v=m.filter(W=>W.lastGrade===Lt.HARD).length,S=m.filter(W=>W.lastGrade===Lt.EASY).length,N=m.filter(W=>W.lastGrade===Lt.LEARNED).length,z=a.filter(W=>W.quality===Ft.REFINED).length,D=a.filter(W=>W.quality===Ft.RAW).length,j={vocab:{total:0,learned:0},idiom:{total:0,learned:0},phrasal:{total:0,learned:0},colloc:{total:0,learned:0},phrase:{total:0,learned:0},preposition:{total:0,learned:0}};a.forEach(W=>{const Q=!!W.lastReview,I=T=>{j[T].total++,Q&&j[T].learned++};W.isIdiom&&I("idiom"),W.isPhrasalVerb&&I("phrasal"),W.isCollocation&&I("colloc"),W.isStandardPhrase&&I("phrase"),W.prepositions&&W.prepositions.length>0&&!W.isPhrasalVerb&&I("preposition"),!W.isIdiom&&!W.isPhrasalVerb&&!W.isCollocation&&!W.isStandardPhrase&&I("vocab")});const P=new Date;P.setHours(0,0,0,0);const F=P.getTime(),G=[],H=[];a.forEach(W=>{W.lastReview&&W.lastReview>=F&&W.lastReviewSessionType!=="boss_battle"&&(W.lastGrade===Lt.LEARNED?G.push(W):H.push(W))}),Yw={reviewCounts:{total:o,due:l,new:d,learned:y,mastered:p,statusForgot:x,statusHard:v,statusEasy:S,statusLearned:N},dashboardStats:{categories:j,refinedCount:z,rawCount:D},dayProgress:{learned:G.length,reviewed:H.length,learnedWords:G,reviewedWords:H}}}let co=null;function sn(){co&&clearTimeout(co),co=window.setTimeout(()=>{window.dispatchEvent(new CustomEvent("datastore-updated")),co=null},100)}let _v=0;const Dn=()=>{const n=Date.now();return n-_v<1e3?(window.dispatchEvent(new CustomEvent("datastore-cooldown")),!1):(_v=n,!0)};typeof window<"u"&&window.addEventListener("vocab-pro-trigger-backup",()=>{El&&(sn(),nn())});async function Qw(n){if(!(El||Zd)){Zd=!0,Qc=n;try{let e=await Ol(n);if(e.length===0){const l=localStorage.getItem("vocab_pro_emergency_backup");if(l)try{const d=JSON.parse(l);Array.isArray(d)&&d.length>0&&(await _o(d),e=await Ol(n))}catch(d){console.error("[DataStore] Failed to restore from emergency backup:",d)}}const[s,a]=await Promise.all([hu(n),pu(n)]);ja.clear(),s.forEach(l=>{(l.linkedWordIds||[]).forEach(d=>ja.add(d))}),xi.clear(),Eo.clear(),a.forEach(l=>{const d=new Set;(l.words||[]).forEach(p=>{const m=p.word.toLowerCase();xi.add(m),d.add(m)}),Eo.set(l.id,d)});const o=[];for(const l of e){let d=!1;const p=l.ipa;p&&!l.ipaUs&&(l.ipaUs=p,delete l.ipa,d=!0),p&&l.ipaUs&&(delete l.ipa,d=!0),l.needsPronunciationFocus!==void 0&&(delete l.needsPronunciationFocus,d=!0);const m=kr(l),y=Ns(l),x=jr(l);l.complexity!==m&&(l.complexity=m,d=!0),l.masteryScore!==y&&(l.masteryScore=y,d=!0),JSON.stringify(l.gameEligibility)!==JSON.stringify(x)&&(l.gameEligibility=x,d=!0),typeof l.register>"u"&&(l.register="raw",d=!0),d&&o.push(l)}o.length>0&&await _o(o),as=new Map(e.map(l=>[l.id,l])),Ao(n),El=!0}catch(e){console.error("DataStore initialization failed:",e),El=!1}finally{Zd=!1}}}async function Gm(n){El=!1,Zd=!1,as.clear(),ja.clear(),xi.clear(),Eo.clear(),await Qw(n),sn()}async function Ww(){as.clear(),ja.clear(),xi.clear(),Eo.clear(),El=!1,Qc=null,await YE();const n=["vocab_pro_system_config","gemini_api_keys"],e=[];for(let s=0;s<localStorage.length;s++){const a=localStorage.key(s);a&&!n.includes(a)&&e.push(a)}e.forEach(s=>localStorage.removeItem(s)),sessionStorage.clear()}async function Kw(n){try{const e=await hu(n);ja.clear(),e.forEach(s=>{(s.linkedWordIds||[]).forEach(a=>ja.add(a))}),sn()}catch(e){console.error("Failed to refresh composition index",e)}}async function dN(n){try{const e=await pu(n);xi.clear(),Eo.clear(),e.forEach(s=>{const a=new Set;(s.words||[]).forEach(o=>{const l=o.word.toLowerCase();xi.add(l),a.add(l)}),Eo.set(s.id,a)}),sn()}catch(e){console.error("Failed to refresh word book index",e)}}function fN(n){return ja.has(n)}function j5(){return ja}function k5(){return xi}function Zw(){return Yw}function di(){return Array.from(as.values())}function Ev(n){return as.get(n)}function L5(n,e,s,a="",o=["all"],l="all",d="all",p="all",m="all",y=null,x="all",v="all",S=""){const N=Array.from(as.values()).filter(G=>G.userId===n);let z=N;if(o.includes("duplicate")){const G=new Map;N.forEach(W=>{const Q=W.word.toLowerCase().trim();G.set(Q,(G.get(Q)||0)+1)});const H=new Set;for(const[W,Q]of G.entries())Q>1&&H.add(W);z=z.filter(W=>H.has(W.word.toLowerCase().trim()))}const D=o.filter(G=>G!=="duplicate");let j=null;v==="specific"&&S&&(j=Eo.get(S)||null);const P=z.filter(G=>KE(G,a,D,l,d,p,m,y,x,ja,v==="specific"?"all":v,xi)?v==="specific"&&j?j.has(G.word.toLowerCase()):!0:!1);o.includes("duplicate")?P.sort((G,H)=>G.word.localeCompare(H.word)||G.createdAt-H.createdAt):P.sort((G,H)=>H.createdAt-G.createdAt);const F=e*s;return{words:P.slice(F,F+s),totalCount:P.length}}async function qm(n,e){return QE(n,e)}async function hN(n,e){Dn()&&(hn(),n.complexity=kr(n),n.masteryScore=Ns(n),n.gameEligibility=jr(n),await ZE(n,e),as.set(n.id,n),Ao(n.userId),nn(),sn())}async function M5(n,e){Dn()&&(hn(),n&&(n.complexity=kr(n),n.masteryScore=Ns(n),n.gameEligibility=jr(n)),await XE(n,e),n&&as.set(n.id,n),nn(),Ao(e.userId),sn())}async function Cf(n){Dn()&&(hn(),n.complexity=kr(n),n.masteryScore=Ns(n),n.gameEligibility=jr(n),await JE(n),as.set(n.id,n),Ao(n.userId),nn(),sn())}async function pN(n){n.length!==0&&(hn(),n.forEach(e=>{e.complexity=kr(e),e.masteryScore=Ns(e),e.gameEligibility=jr(e)}),await _o(n),n.forEach(e=>as.set(e.id,e)),n[0]&&Ao(n[0].userId),nn(),sn())}async function mN(n){const e=as.get(n);!e||!Dn()||(hn(),await ew(n),as.delete(n),Ao(e.userId),nn(),sn())}async function gN(n){if(n.length===0)return;const e=as.get(n[0]);e&&(hn(),await tw(n),n.forEach(s=>as.delete(s)),Ao(e.userId),nn(),sn())}async function D5(n){Dn()&&(hn(),await nw(n),nn(),sn())}async function U5(n){Dn()&&(hn(),await Tw(n),await Kw(n.userId),nn())}async function P5(n,e){hn(),await Aw(n),await Kw(e),nn()}async function V5(n){Dn()&&(hn(),await Nw(n),await dN(n.userId),nn())}async function z5(n){Dn()&&(hn(),await ow(n),nn(),sn())}async function B5(n){Dn()&&(hn(),await lw(n),nn(),sn())}async function F5(n){Dn()&&(hn(),await uw(n),nn(),sn())}async function H5(n){Dn()&&(hn(),await dw(n),nn(),sn())}async function G5(n){Dn()&&(hn(),await hw(n),nn(),sn())}async function q5(n){Dn()&&(hn(),await pw(n),nn(),sn())}async function $5(n){Dn()&&(hn(),await _w(n),nn(),sn())}async function Y5(n){Dn()&&(hn(),await Ew(n),nn(),sn())}async function Q5(n){Dn()&&(hn(),await yw(n),nn(),sn())}async function W5(n){Dn()&&(hn(),await xw(n),nn(),sn())}async function K5(n){Dn()&&(hn(),await Ow(n),nn(),sn())}async function Z5(n){Dn()&&(hn(),await jw(n),nn(),sn())}const{getUnitsContainingWord:yN,seedDatabaseIfEmpty:xN,clearVocabularyOnly:Xw,bulkSavePlanningGoals:X5}=BI,bN={user:!0,vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,mimic:!0,wordBook:!0,planning:!0};let Wp=!1;const Xd=async(n,e,s=!1)=>{if(window.isRestoring||Wp)return;const a=wt();if(!a.sync.autoBackupEnabled&&!s)return;Wp=!0;const o=Bn(a);try{const l=await _N(n,e),d=JSON.stringify(l),p=(new Blob([d]).size/(1024*1024)).toFixed(2),m=e.name?`&username=${encodeURIComponent(e.name)}`:"",y=await fetch(`${o}/api/backup?userId=${encodeURIComponent(n)}${m}&app=vocab`,{method:"POST",headers:{"Content-Type":"application/json"},body:d});if(!y.ok)throw new Error(`Server error: ${y.statusText}`);const x=Date.now(),v={...a};v.sync.lastSyncTime=x,qr(v,!0),localStorage.setItem("vocab_pro_local_last_modified",String(x)),window.dispatchEvent(new CustomEvent("backup-complete",{detail:{success:!0,size:p}}))}catch(l){console.warn("[Backup] Upload failed:",l),window.dispatchEvent(new CustomEvent("backup-complete",{detail:{success:!1}}))}finally{Wp=!1}},Ud=async()=>{try{const n=wt(),e=Bn(n),s=await fetch(`${e}/api/backups?app=vocab`);return s.ok?(await s.json()).backups||[]:[]}catch(n){return console.warn("[Backup] Failed to fetch list:",n),[]}},Jw=async n=>{try{const e=wt(),a=`${Bn(e)}/api/backup/${encodeURIComponent(n)}?t=${Date.now()}&app=vocab`,o=await fetch(a,{method:"GET",headers:{"Cache-Control":"no-cache"},mode:"cors"});if(!o.ok)return null;const l=await o.blob(),d=new File([l],"restore.json",{type:"application/json"}),p=await Bw(d,n,bN);return p.type==="success"&&p.updatedUser?(await Gm(p.updatedUser.id),p):null}catch(e){return console.error("[Backup] Restore exception:",e),null}},vN=async n=>{try{const e=wt(),s=Bn(e),a=await fetch(`${s}/api/library/lookup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({words:n})});if(a.ok){const o=await a.json();if(Array.isArray(o.found))return o.found.map(l=>ul(l))}return[]}catch(e){return console.warn("[Backup] Library lookup failed:",e),[]}};async function _N(n,e){const[s,a,o,l,d,p,m,y,x,v,S,N,z,D,j,P,F]=await Promise.all([Ol(),Nf(),Yg(),Dg(),Pg(),Ug(),Vg(),zg(),Bg(),Hg(),Fg(),hu(),Gg(),qg(),$g(),pu(),Qg()]),G=localStorage.getItem("vocab_pro_mimic_practice_queue"),H=localStorage.getItem("vocab_pro_adventure_chapters"),W=localStorage.getItem("vocab_pro_custom_badges"),Q=localStorage.getItem("reading_books_shelves"),I=localStorage.getItem("vocab_pro_system_config");return{v:8,ca:new Date().toISOString(),user:Vw(e),vocab:s.map(T=>Yr(T)),u:a,pl:l,st:d,sl:p,wt:v,wl:S,iv:z,lessons:D,listeningItems:j,nativeSpeakItems:m.map(T=>Yr(T)),conversationItems:y.map(T=>Yr(T)),freeTalkItems:x.map(T=>Yr(T)),compositions:N,mimicQueue:G?JSON.parse(G):[],wordBooks:P.map(T=>Yr(T)),readingBooks:o,pg:F,adv:{ch:H?JSON.parse(H):null,b:W?JSON.parse(W):null},readingShelves:Q?JSON.parse(Q):null,settings:I?JSON.parse(I):null}}const EN=()=>{const[n,e]=M.useState(null),[s,a]=M.useState(!1),[o,l]=M.useState(!1),d=M.useCallback(async()=>{a(!1),l(!1);const x=localStorage.getItem("vocab_pro_current_user_id"),v=localStorage.getItem("vocab_pro_current_user_name"),S=localStorage.getItem("vocab_pro_auto_restore");let N=(await _l()).filter(H=>!H.name.toLowerCase().includes("book"));const z=N.length===0,D=S==="true"||z,j=v||x||"Vocab Master";if(D){window.isRestoring=!0;try{const H=await Jw(j);H&&H.type==="success"&&(H.backupTimestamp&&localStorage.setItem("vocab_pro_last_backup_timestamp",String(H.backupTimestamp)),N=(await _l()).filter(W=>!W.name.toLowerCase().includes("book")),H.updatedUser&&(localStorage.setItem("vocab_pro_current_user_id",H.updatedUser.id),localStorage.setItem("vocab_pro_current_user_name",H.updatedUser.name)))}catch{}finally{setTimeout(()=>{window.isRestoring=!1},2e3)}S&&localStorage.removeItem("vocab_pro_auto_restore")}await Mg();const P=(await _l()).filter(H=>!H.name.toLowerCase().includes("book"));let F=null;const G=localStorage.getItem("vocab_pro_current_user_id");if(P.length===1?(F=P[0],l(!0)):G&&P.length>1&&(F=P.find(H=>H.id===G)||null,F&&l(!0)),F){let H=!1;F.adventure?(F.adventure.completedSegmentIds.length===0&&(F.adventure.keys===0||F.adventure.keys===void 0)&&(F.adventure.keys=1,H=!0),F.adventure.map||(F.adventure.map=Yc(100),H=!0)):(F.adventure={currentNodeIndex:0,energy:5,energyShards:0,unlockedChapterIds:vl.map(W=>W.id),completedSegmentIds:[],segmentStars:{},badges:[],keys:1,keyFragments:0,map:Yc(100)},H=!0),H&&await ur(F),e(F),localStorage.setItem("vocab_pro_current_user_id",F.id),localStorage.setItem("vocab_pro_current_user_name",F.name)}a(!0)},[]);return M.useEffect(()=>{d()},[d]),{currentUser:n,isLoaded:s,handleLogin:async x=>{x.adventure.map||(x.adventure.map=Yc(100),await ur(x)),e(x),localStorage.setItem("vocab_pro_current_user_id",x.id),localStorage.setItem("vocab_pro_current_user_name",x.name);const v={...x,lastLogin:Date.now()};ur(v)},handleLogout:()=>{e(null),localStorage.removeItem("vocab_pro_current_user_id")},handleUpdateUser:async x=>{await ur(x),e(x),x.id===localStorage.getItem("vocab_pro_current_user_id")&&localStorage.setItem("vocab_pro_current_user_name",x.name)},setCurrentUser:e,shouldSkipAuth:o}},wN=({setView:n,setIsSidebarOpen:e})=>{const[s,a]=M.useState(null),[o,l]=M.useState(null),[d,p]=M.useState(null);M.useEffect(()=>{try{const x=sessionStorage.getItem("vocab_pro_active_session");if(x){const{words:v,type:S}=JSON.parse(x);Array.isArray(v)&&v.length>0&&(a(v),p(S))}}catch(x){console.error("Failed to restore session",x),sessionStorage.removeItem("vocab_pro_active_session")}},[]);const m=M.useCallback((x,v,S=null)=>{if(x.length>0){const z=[...Array.from(new Map(x.map(D=>[D.id,D])).values())].sort(()=>Math.random()-.5);a(z),p(v),l(S),sessionStorage.setItem("vocab_pro_active_session",JSON.stringify({words:z,type:v})),sessionStorage.removeItem("vocab_pro_session_progress"),sessionStorage.removeItem("vocab_pro_session_outcomes"),n("REVIEW"),e(!1)}},[n,e]),y=M.useCallback(()=>{sessionStorage.removeItem("vocab_pro_active_session"),sessionStorage.removeItem("vocab_pro_session_progress"),sessionStorage.removeItem("vocab_pro_session_outcomes"),a(null),p(null),l(null)},[]);return{sessionWords:s,setSessionWords:a,sessionType:d,sessionFocus:o,startSession:m,clearSessionState:y}},dl=n=>n<1?0:n<=5?100+n*50:n<=10?350+(n-5)*100:850+(n-10)*200,SN=[{level:1,title:"Vocab Novice"},{level:5,title:"Word Apprentice"},{level:10,title:"Lexical Explorer"},{level:20,title:"Master Grammarian"},{level:30,title:"IELTS Wordsmith"},{level:50,title:"IELTS Luminary"}],Kp=n=>{let e="Vocab Novice";for(const s of SN)if(n>=s.level)e=s.title;else break;return e},wv=(n,e)=>{let s=0;for(let a=1;a<n;a++)s+=dl(a);return s+=e,s},TN=({currentUser:n,onUpdateUser:e,onSaveWordAndUser:s})=>{const[a,o]=M.useState(null),{showToast:l}=ea(),d=M.useRef(n);M.useEffect(()=>{d.current=n},[n]);const p=M.useCallback(async(x,v,S,N)=>{const z=d.current;if(!z)return 0;let D=x;if(v){const R=Date.now(),L=new Date(R).toDateString();if(v.lastXpEarnedTime&&new Date(v.lastXpEarnedTime).toDateString()===L)return 0;if(N&&N.tested>0){const O=N.correct/N.tested;D*=1+(O-.7)}S===Lt.EASY&&(D*=1.1),S===Lt.FORGOT&&(D*=.1),D=Math.round(Math.max(5,D)),v.lastXpEarnedTime=R}const P=wv(z.level,z.experience)+Math.round(D);let F=1,G=P,H=dl(F);for(;G>=H;)G-=H,F++,H=dl(F);const W=Math.floor(G),Q=z.level,I=F>Q,T=Kp(F),_={...z,experience:W,level:F,peakLevel:Math.max(z.peakLevel||Q,F),role:T};let C=!1;if(!v&&x>0&&Math.random()<.2){const R={..._.adventure};R.keyFragments=(R.keyFragments||0)+1,l("You found a Key Fragment! ","success",2e3),R.keyFragments>=3&&(R.keyFragments-=3,R.keys=(R.keys||0)+1,C=!0),_.adventure=R}return v?await s(v,_):await e(_),C&&l(" Key Fragments assembled into a Magic Key!","success",4e3),o({amount:Math.round(D),levelUp:I,newLevel:I?F:null}),setTimeout(()=>o(null),I?5e3:2e3),I&&l(` Level Up to ${F}! New title: "${T}"`,"success",5e3),Math.round(D)},[e,s,l]),m=M.useCallback(async x=>{const v=d.current;if(!v)return;const S=wv(v.level,v.experience),N=x-S;if(N===0)return;let z=1,D=x,j=dl(z);for(;D>=j;)D-=j,z++,j=dl(z);const P=Math.floor(D),F=v.level,G=v.peakLevel||F,H=Math.max(G,z),W=Kp(z),Q=z>F,I=z>G,T=W!==Kp(G),_={...v,experience:P,level:z,peakLevel:H,role:W};if(I){let C=1,R=!1,L=` New Peak Level: ${z}! +1 Key Fragment`;for(T&&(C++,L=`New Title: "${W}"! +2 Key Fragments`),_.adventure.keyFragments=(_.adventure.keyFragments||0)+C;_.adventure.keyFragments>=3;)_.adventure.keyFragments-=3,_.adventure.keys=(_.adventure.keys||0)+1,R=!0;l(L,"success",6e3),R&&l(" Key Fragments assembled into a Magic Key!","success",4e3)}else if(Q)l(` Level Up to ${z}!`,"success",4e3);else if(N!==0){const C=N>0?"+":"";l(`XP Recalculated: ${C}${N} XP`,"info",2e3)}await e(_),o({amount:N,levelUp:Q,newLevel:Q?z:null}),setTimeout(()=>o(null),Q?5e3:2e3)},[l,e]),y=M.useMemo(()=>n?dl(n.level):0,[n]);return{recalculateXpAndLevelUp:m,gainExperienceAndLevelUp:p,xpGained:a,xpToNextLevel:y}};function mu(n,e){try{const s=localStorage.getItem(n);if(s)return JSON.parse(s)}catch(s){console.error(`Error parsing JSON from localStorage for key "${n}":`,s)}return e}function Zg(n,e){try{localStorage.setItem(n,JSON.stringify(e))}catch(s){console.error(`Error saving JSON to localStorage for key "${n}":`,s)}}const AN="vocab_pro_adventure_chapters";function IN(){return mu(AN,vl)}const NN=({currentUser:n,onUpdateUser:e})=>{const[s,a]=M.useState({total:0,due:0,new:0,learned:0}),[o,l]=M.useState(null),[d,p]=M.useState(null),[m,y]=M.useState(!1),[x,v]=M.useState({count:0,date:""}),{showToast:S}=ea(),N=M.useCallback(async()=>{if(!n)return;await Qw(n.id);const j=Zw();a(j.reviewCounts);const P=di().filter(I=>I.userId===n.id),G=P.filter(I=>!I.isPassive).filter(I=>I.quality===Ft.VERIFIED);let H=null;if(d)H=d;else if(G.length>0){const I=new Date().toISOString().slice(0,10).replace(/-/g,""),T=n.id.length>4&&parseInt(n.id.substring(n.id.length-4),16)||1234,C=(parseInt(I)+T)%G.length;H=G[C]}l(H),y(H?fN(H.id):!1);const W=IN(),Q=n.adventure;if(Q){const I=new Map(P.map(L=>[L.word.toLowerCase(),L])),T={...Q};let _=!1,C=!1;const R=new Date().toISOString().split("T")[0];for(const L of W)for(const O of L.segments){if(!T.completedSegmentIds.includes(O.id))continue;let _e=T.segmentStars[O.id]||0;const ye=(B,le)=>{T.segmentStars[O.id]=B,T.keyFragments=(T.keyFragments||0)+1,_=!0,S(le,"success",5e3),!C&&n.adventureLastDailyStar!==R&&(T.keyFragments++,C=!0,S("Bonus: First star of the day! (+1 Key Fragment)","success",6e3))};_e<3&&(_e<1&&O.basicWords.length>0&&O.basicWords.every(B=>{var le;return(((le=I.get(B.toLowerCase()))==null?void 0:le.consecutiveCorrect)??0)>0})&&(ye(1,` 1-Star Mastery for "${O.title}"! (+1 Key Fragment)`),_e=1),_e===1&&O.intermediateWords.length>0&&O.intermediateWords.every(B=>{var le;return(((le=I.get(B.toLowerCase()))==null?void 0:le.consecutiveCorrect)??0)>0})&&(ye(2,` 2-Star Mastery for "${O.title}"! (+1 Key Fragment)`),_e=2),_e===2&&O.advancedWords.length>0&&O.advancedWords.every(B=>{var le;return(((le=I.get(B.toLowerCase()))==null?void 0:le.consecutiveCorrect)??0)>0})&&ye(3,` Boss unlocked for "${O.title}"! (+1 Key Fragment)`))}if(_){for(;T.keyFragments>=3;)T.keyFragments-=3,T.keys=(T.keys||0)+1,S(" Key Fragments assembled into a Magic Key!","success",4e3);const L={...n,adventure:T,adventureLastDailyStar:C?R:n.adventureLastDailyStar};e(L)}}},[n,S,e,d]);M.useEffect(()=>{d&&N()},[d]),M.useEffect(()=>{n&&N();const j=()=>{S("Saving too quickly. Please wait.","info",1500)};return window.addEventListener("datastore-updated",N),window.addEventListener("datastore-cooldown",j),()=>{window.removeEventListener("datastore-updated",N),window.removeEventListener("datastore-cooldown",j)}},[n,N,S]);const z=M.useCallback(()=>{const j=new Date().toISOString().split("T")[0];let P=mu("vocab_pro_api_usage",{count:0,date:"1970-01-01"});P.date!==j&&(P={count:0,date:j}),v(P)},[]);return M.useEffect(()=>(z(),window.addEventListener("apiUsageUpdated",z),()=>{window.removeEventListener("apiUsageUpdated",z)}),[z]),{stats:s,wotd:o,setWotd:l,apiUsage:x,refreshGlobalStats:N,isWotdComposed:m,randomizeWotd:()=>{if(!n)return;const P=di().filter(F=>F.userId===n.id).filter(F=>!F.isPassive&&F.quality===Ft.VERIFIED);if(P.length>0){const F=P[Math.floor(Math.random()*P.length)];p(F)}}}},CN=n=>{const{currentUser:e,setView:s,refreshGlobalStats:a,sessionWords:o,setSessionWords:l,globalViewWord:d,setGlobalViewWord:p,onUpdateUser:m}=n,{showToast:y}=ea(),x=()=>{var R;const I=Number(localStorage.getItem("vocab_pro_last_backup_timestamp"))||0,_=((R=wt().sync)==null?void 0:R.lastSyncTime)||0,C=Math.max(I,_);return C>0?C:null},[v,S]=M.useState(x()),N=M.useCallback(()=>{S(x())},[]),z=async I=>{if(!e)return;const T=I||{vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,wordBook:!0,planning:!0},_=await eN(e.id,e,T),C=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),R=URL.createObjectURL(C),L=document.createElement("a");L.href=R,L.download=`vocab-pro-backup-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(R);const O=Date.now();localStorage.setItem("vocab_pro_last_backup_timestamp",String(O)),localStorage.setItem("vocab_pro_local_last_modified",String(O)),N(),sessionStorage.removeItem("vocab_pro_just_restored"),y("Backup file downloaded.","success")},D=async(I,T,_)=>{var _e;Hm();const C=wt();if(T)try{const ye=JSON.parse(T),B={...C,server:ye.server};localStorage.setItem("vocab_pro_system_config",JSON.stringify(B)),window.dispatchEvent(new Event("config-updated"))}catch(ye){console.error("[Restore] Failed to merge config",ye)}sessionStorage.setItem("vocab_pro_just_restored","true");const R=_||I.backupTimestamp||Date.now();localStorage.setItem("vocab_pro_last_backup_timestamp",String(R)),localStorage.setItem("vocab_pro_local_last_modified",String(R));const L=wt();qr({...L,sync:{...L.sync,lastSyncTime:R}},!0);const O=((_e=I.updatedUser)==null?void 0:_e.id)||(e==null?void 0:e.id);O&&await Gm(O),I.updatedUser&&(localStorage.setItem("vocab_pro_current_user_id",I.updatedUser.id),localStorage.setItem("vocab_pro_current_user_name",I.updatedUser.name),await m(I.updatedUser)),y("Restore successful!","success",2e3),a(),window.dispatchEvent(new Event("vocab-pro-restore-complete")),window.dispatchEvent(new Event("vocab-pro-force-ui-reload")),setTimeout(()=>{window.isRestoring=!1},1e3)};return{lastBackupTime:v,refreshBackupTime:N,handleBackup:z,restoreFromServerAction:async(I,T)=>{const _=wt(),C=JSON.stringify(_);window.isRestoring=!0,Hm();try{const R=I||(e?e.name||e.id:null);if(!R){window.isRestoring=!1;return}await Ww(),C&&(localStorage.setItem("vocab_pro_system_config",C),window.dispatchEvent(new Event("config-updated")));const L=await Jw(R);L&&L.type==="success"?await D(L,C,T):(y("Server restore failed. Manual restore may be required.","error"),window.isRestoring=!1)}catch(R){console.error("[DataActions] Restore error:",R),y("Restore encountered a fatal error.","error"),window.isRestoring=!1}},triggerLocalRestore:()=>{const I=wt(),T=JSON.stringify(I),_=document.createElement("input");_.type="file",_.accept=".json",_.style.display="none",_.onchange=async C=>{var R;_.parentNode&&_.parentNode.removeChild(_);try{const L=(R=C.target.files)==null?void 0:R[0];if(!L)return;const O={user:!0,vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,mimic:!0,wordBook:!0,planning:!0};window.isRestoring=!0;const _e=e?e.id:"temp-restore",ye=await Bw(L,_e,O);ye.type==="success"?await D(ye,T):(y(`Restore failed: ${ye.message}`,"error",5e3),window.isRestoring=!1)}catch(L){console.error("Fatal error during local restore:",L),window.isRestoring=!1}},document.body.appendChild(_),_.click()},handleLibraryReset:async()=>{if(e)try{await Xw(),sessionStorage.removeItem("vocab_pro_skip_seed"),await xN(!0),await Gm(e.id),a(),s("DASHBOARD")}catch{window.location.reload()}},updateWord:async I=>{await Cf(I),o&&l(T=>(T||[]).map(_=>_.id===I.id?I:_)),d&&d.id===I.id&&(I.masteryScore=Ns(I),p(I))},deleteWord:async I=>{d&&d.id===I&&p(null),await mN(I)},bulkDeleteWords:async I=>{await gN(I)},bulkUpdateWords:async I=>{await pN(I)}}},RN=()=>{};var Sv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eS=function(n){const e=[];let s=0;for(let a=0;a<n.length;a++){let o=n.charCodeAt(a);o<128?e[s++]=o:o<2048?(e[s++]=o>>6|192,e[s++]=o&63|128):(o&64512)===55296&&a+1<n.length&&(n.charCodeAt(a+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++a)&1023),e[s++]=o>>18|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128,e[s++]=o&63|128):(e[s++]=o>>12|224,e[s++]=o>>6&63|128,e[s++]=o&63|128)}return e},ON=function(n){const e=[];let s=0,a=0;for(;s<n.length;){const o=n[s++];if(o<128)e[a++]=String.fromCharCode(o);else if(o>191&&o<224){const l=n[s++];e[a++]=String.fromCharCode((o&31)<<6|l&63)}else if(o>239&&o<365){const l=n[s++],d=n[s++],p=n[s++],m=((o&7)<<18|(l&63)<<12|(d&63)<<6|p&63)-65536;e[a++]=String.fromCharCode(55296+(m>>10)),e[a++]=String.fromCharCode(56320+(m&1023))}else{const l=n[s++],d=n[s++];e[a++]=String.fromCharCode((o&15)<<12|(l&63)<<6|d&63)}}return e.join("")},tS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let o=0;o<n.length;o+=3){const l=n[o],d=o+1<n.length,p=d?n[o+1]:0,m=o+2<n.length,y=m?n[o+2]:0,x=l>>2,v=(l&3)<<4|p>>4;let S=(p&15)<<2|y>>6,N=y&63;m||(N=64,d||(S=64)),a.push(s[x],s[v],s[S],s[N])}return a.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(eS(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):ON(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const s=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let o=0;o<n.length;){const l=s[n.charAt(o++)],p=o<n.length?s[n.charAt(o)]:0;++o;const y=o<n.length?s[n.charAt(o)]:64;++o;const v=o<n.length?s[n.charAt(o)]:64;if(++o,l==null||p==null||y==null||v==null)throw new jN;const S=l<<2|p>>4;if(a.push(S),y!==64){const N=p<<4&240|y>>2;if(a.push(N),v!==64){const z=y<<6&192|v;a.push(z)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class jN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const kN=function(n){const e=eS(n);return tS.encodeByteArray(e,!0)},cf=function(n){return kN(n).replace(/\./g,"")},LN=function(n){try{return tS.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DN=()=>MN().__FIREBASE_DEFAULTS__,UN=()=>{if(typeof process>"u"||typeof Sv>"u")return;const n=Sv.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},PN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&LN(n[1]);return e&&JSON.parse(e)},Xg=()=>{try{return RN()||DN()||UN()||PN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},VN=n=>{var e,s;return(s=(e=Xg())==null?void 0:e.emulatorHosts)==null?void 0:s[n]},zN=n=>{const e=VN(n);if(!e)return;const s=e.lastIndexOf(":");if(s<=0||s+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(s+1),10);return e[0]==="["?[e.substring(1,s-1),a]:[e.substring(0,s),a]},nS=()=>{var n;return(n=Xg())==null?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,s)=>{this.resolve=e,this.reject=s})}wrapCallback(e){return(s,a)=>{s?this.reject(s):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(s):e(s,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jg(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function FN(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HN(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s={alg:"none",type:"JWT"},a=e||"demo-project",o=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${a}`,aud:a,iat:o,exp:o+3600,auth_time:o,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[cf(JSON.stringify(s)),cf(JSON.stringify(d)),""].join(".")}const Wc={};function GN(){const n={prod:[],emulator:[]};for(const e of Object.keys(Wc))Wc[e]?n.emulator.push(e):n.prod.push(e);return n}function qN(n){let e=document.getElementById(n),s=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),s=!0),{created:s,element:e}}let Tv=!1;function $N(n,e){if(typeof window>"u"||typeof document>"u"||!Jg(window.location.host)||Wc[n]===e||Wc[n]||Tv)return;Wc[n]=e;function s(S){return`__firebase__banner__${S}`}const a="__firebase__banner",l=GN().prod.length>0;function d(){const S=document.getElementById(a);S&&S.remove()}function p(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function m(S,N){S.setAttribute("width","24"),S.setAttribute("id",N),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function y(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{Tv=!0,d()},S}function x(S,N){S.setAttribute("id",N),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function v(){const S=qN(a),N=s("text"),z=document.getElementById(N)||document.createElement("span"),D=s("learnmore"),j=document.getElementById(D)||document.createElement("a"),P=s("preprendIcon"),F=document.getElementById(P)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const G=S.element;p(G),x(j,D);const H=y();m(F,P),G.append(F,z,j,H),document.body.appendChild(G)}l?(z.innerText="Preview backend disconnected.",F.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(F.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,z.innerText="Preview backend running in this workspace."),z.setAttribute("id",N)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YN(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function QN(){var e;const n=(e=Xg())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function WN(){return!QN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function KN(){try{return typeof indexedDB=="object"}catch{return!1}}function ZN(){return new Promise((n,e)=>{try{let s=!0;const a="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(a);o.onsuccess=()=>{o.result.close(),s||self.indexedDB.deleteDatabase(a),n(!0)},o.onupgradeneeded=()=>{s=!1},o.onerror=()=>{var l;e(((l=o.error)==null?void 0:l.message)||"")}}catch(s){e(s)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XN="FirebaseError";class Pl extends Error{constructor(e,s,a){super(s),this.code=e,this.customData=a,this.name=XN,Object.setPrototypeOf(this,Pl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,sS.prototype.create)}}class sS{constructor(e,s,a){this.service=e,this.serviceName=s,this.errors=a}create(e,...s){const a=s[0]||{},o=`${this.service}/${e}`,l=this.errors[e],d=l?JN(l,a):"Error",p=`${this.serviceName}: ${d} (${o}).`;return new Pl(o,p,a)}}function JN(n,e){return n.replace(eC,(s,a)=>{const o=e[a];return o!=null?String(o):`<${a}?>`})}const eC=/\{\$([^}]+)}/g;function uf(n,e){if(n===e)return!0;const s=Object.keys(n),a=Object.keys(e);for(const o of s){if(!a.includes(o))return!1;const l=n[o],d=e[o];if(Av(l)&&Av(d)){if(!uf(l,d))return!1}else if(l!==d)return!1}for(const o of a)if(!s.includes(o))return!1;return!0}function Av(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(n){return n&&n._delegate?n._delegate:n}class ru{constructor(e,s,a){this.name=e,this.instanceFactory=s,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(e,s){this.name=e,this.container=s,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const s=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(s)){const a=new BN;if(this.instancesDeferred.set(s,a),this.isInitialized(s)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:s});o&&a.resolve(o)}catch{}}return this.instancesDeferred.get(s).promise}getImmediate(e){const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(e==null?void 0:e.optional)??!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(o){if(a)return null;throw o}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sC(e))try{this.getOrInitializeService({instanceIdentifier:so})}catch{}for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);try{const l=this.getOrInitializeService({instanceIdentifier:o});a.resolve(l)}catch{}}}}clearInstance(e=so){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(s=>"INTERNAL"in s).map(s=>s.INTERNAL.delete()),...e.filter(s=>"_delete"in s).map(s=>s._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=so){return this.instances.has(e)}getOptions(e=so){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:s={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:a,options:s});for(const[l,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(l);a===p&&d.resolve(o)}return o}onInit(e,s){const a=this.normalizeInstanceIdentifier(s),o=this.onInitCallbacks.get(a)??new Set;o.add(e),this.onInitCallbacks.set(a,o);const l=this.instances.get(a);return l&&e(l,a),()=>{o.delete(e)}}invokeOnInitCallbacks(e,s){const a=this.onInitCallbacks.get(s);if(a)for(const o of a)try{o(e,s)}catch{}}getOrInitializeService({instanceIdentifier:e,options:s={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:nC(e),options:s}),this.instances.set(e,a),this.instancesOptions.set(e,s),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=so){return this.component?this.component.multipleInstances?e:so:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function nC(n){return n===so?void 0:n}function sC(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const s=this.getProvider(e.name);if(s.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);s.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const s=new tC(e,this);return this.providers.set(e,s),s}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _t;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(_t||(_t={}));const aC={debug:_t.DEBUG,verbose:_t.VERBOSE,info:_t.INFO,warn:_t.WARN,error:_t.ERROR,silent:_t.SILENT},iC=_t.INFO,oC={[_t.DEBUG]:"log",[_t.VERBOSE]:"log",[_t.INFO]:"info",[_t.WARN]:"warn",[_t.ERROR]:"error"},lC=(n,e,...s)=>{if(e<n.logLevel)return;const a=new Date().toISOString(),o=oC[e];if(o)console[o](`[${a}]  ${n.name}:`,...s);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class aS{constructor(e){this.name=e,this._logLevel=iC,this._logHandler=lC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in _t))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?aC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,_t.DEBUG,...e),this._logHandler(this,_t.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,_t.VERBOSE,...e),this._logHandler(this,_t.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,_t.INFO,...e),this._logHandler(this,_t.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,_t.WARN,...e),this._logHandler(this,_t.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,_t.ERROR,...e),this._logHandler(this,_t.ERROR,...e)}}const cC=(n,e)=>e.some(s=>n instanceof s);let Iv,Nv;function uC(){return Iv||(Iv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function dC(){return Nv||(Nv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iS=new WeakMap,$m=new WeakMap,oS=new WeakMap,Zp=new WeakMap,e0=new WeakMap;function fC(n){const e=new Promise((s,a)=>{const o=()=>{n.removeEventListener("success",l),n.removeEventListener("error",d)},l=()=>{s(fi(n.result)),o()},d=()=>{a(n.error),o()};n.addEventListener("success",l),n.addEventListener("error",d)});return e.then(s=>{s instanceof IDBCursor&&iS.set(s,n)}).catch(()=>{}),e0.set(e,n),e}function hC(n){if($m.has(n))return;const e=new Promise((s,a)=>{const o=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",d),n.removeEventListener("abort",d)},l=()=>{s(),o()},d=()=>{a(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",l),n.addEventListener("error",d),n.addEventListener("abort",d)});$m.set(n,e)}let Ym={get(n,e,s){if(n instanceof IDBTransaction){if(e==="done")return $m.get(n);if(e==="objectStoreNames")return n.objectStoreNames||oS.get(n);if(e==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return fi(n[e])},set(n,e,s){return n[e]=s,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function pC(n){Ym=n(Ym)}function mC(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...s){const a=n.call(Xp(this),e,...s);return oS.set(a,e.sort?e.sort():[e]),fi(a)}:dC().includes(n)?function(...e){return n.apply(Xp(this),e),fi(iS.get(this))}:function(...e){return fi(n.apply(Xp(this),e))}}function gC(n){return typeof n=="function"?mC(n):(n instanceof IDBTransaction&&hC(n),cC(n,uC())?new Proxy(n,Ym):n)}function fi(n){if(n instanceof IDBRequest)return fC(n);if(Zp.has(n))return Zp.get(n);const e=gC(n);return e!==n&&(Zp.set(n,e),e0.set(e,n)),e}const Xp=n=>e0.get(n);function yC(n,e,{blocked:s,upgrade:a,blocking:o,terminated:l}={}){const d=indexedDB.open(n,e),p=fi(d);return a&&d.addEventListener("upgradeneeded",m=>{a(fi(d.result),m.oldVersion,m.newVersion,fi(d.transaction),m)}),s&&d.addEventListener("blocked",m=>s(m.oldVersion,m.newVersion,m)),p.then(m=>{l&&m.addEventListener("close",()=>l()),o&&m.addEventListener("versionchange",y=>o(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const xC=["get","getKey","getAll","getAllKeys","count"],bC=["put","add","delete","clear"],Jp=new Map;function Cv(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Jp.get(e))return Jp.get(e);const s=e.replace(/FromIndex$/,""),a=e!==s,o=bC.includes(s);if(!(s in(a?IDBIndex:IDBObjectStore).prototype)||!(o||xC.includes(s)))return;const l=async function(d,...p){const m=this.transaction(d,o?"readwrite":"readonly");let y=m.store;return a&&(y=y.index(p.shift())),(await Promise.all([y[s](...p),o&&m.done]))[0]};return Jp.set(e,l),l}pC(n=>({...n,get:(e,s,a)=>Cv(e,s)||n.get(e,s,a),has:(e,s)=>!!Cv(e,s)||n.has(e,s)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(s=>{if(_C(s)){const a=s.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(s=>s).join(" ")}}function _C(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Qm="@firebase/app",Rv="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ka=new aS("@firebase/app"),EC="@firebase/app-compat",wC="@firebase/analytics-compat",SC="@firebase/analytics",TC="@firebase/app-check-compat",AC="@firebase/app-check",IC="@firebase/auth",NC="@firebase/auth-compat",CC="@firebase/database",RC="@firebase/data-connect",OC="@firebase/database-compat",jC="@firebase/functions",kC="@firebase/functions-compat",LC="@firebase/installations",MC="@firebase/installations-compat",DC="@firebase/messaging",UC="@firebase/messaging-compat",PC="@firebase/performance",VC="@firebase/performance-compat",zC="@firebase/remote-config",BC="@firebase/remote-config-compat",FC="@firebase/storage",HC="@firebase/storage-compat",GC="@firebase/firestore",qC="@firebase/ai",$C="@firebase/firestore-compat",YC="firebase",QC="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wm="[DEFAULT]",WC={[Qm]:"fire-core",[EC]:"fire-core-compat",[SC]:"fire-analytics",[wC]:"fire-analytics-compat",[AC]:"fire-app-check",[TC]:"fire-app-check-compat",[IC]:"fire-auth",[NC]:"fire-auth-compat",[CC]:"fire-rtdb",[RC]:"fire-data-connect",[OC]:"fire-rtdb-compat",[jC]:"fire-fn",[kC]:"fire-fn-compat",[LC]:"fire-iid",[MC]:"fire-iid-compat",[DC]:"fire-fcm",[UC]:"fire-fcm-compat",[PC]:"fire-perf",[VC]:"fire-perf-compat",[zC]:"fire-rc",[BC]:"fire-rc-compat",[FC]:"fire-gcs",[HC]:"fire-gcs-compat",[GC]:"fire-fst",[$C]:"fire-fst-compat",[qC]:"fire-vertex","fire-js":"fire-js",[YC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const df=new Map,KC=new Map,Km=new Map;function Ov(n,e){try{n.container.addComponent(e)}catch(s){ka.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,s)}}function ff(n){const e=n.name;if(Km.has(e))return ka.debug(`There were multiple attempts to register component ${e}.`),!1;Km.set(e,n);for(const s of df.values())Ov(s,n);for(const s of KC.values())Ov(s,n);return!0}function ZC(n,e){const s=n.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),n.container.getProvider(e)}function XC(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},hi=new sS("app","Firebase",JC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(e,s,a){this._isDeleted=!1,this._options={...e},this._config={...s},this._name=s.name,this._automaticDataCollectionEnabled=s.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new ru("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw hi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR=QC;function lS(n,e={}){let s=n;typeof e!="object"&&(e={name:e});const a={name:Wm,automaticDataCollectionEnabled:!0,...e},o=a.name;if(typeof o!="string"||!o)throw hi.create("bad-app-name",{appName:String(o)});if(s||(s=nS()),!s)throw hi.create("no-options");const l=df.get(o);if(l){if(uf(s,l.options)&&uf(a,l.config))return l;throw hi.create("duplicate-app",{appName:o})}const d=new rC(o);for(const m of Km.values())d.addComponent(m);const p=new eR(s,a,d);return df.set(o,p),p}function nR(n=Wm){const e=df.get(n);if(!e&&n===Wm&&nS())return lS();if(!e)throw hi.create("no-app",{appName:n});return e}function wl(n,e,s){let a=WC[n]??n;s&&(a+=`-${s}`);const o=a.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const d=[`Unable to register library "${a}" with version "${e}":`];o&&d.push(`library name "${a}" contains illegal characters (whitespace or "/")`),o&&l&&d.push("and"),l&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ka.warn(d.join(" "));return}ff(new ru(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR="firebase-heartbeat-database",rR=1,au="firebase-heartbeat-store";let em=null;function cS(){return em||(em=yC(sR,rR,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(au)}catch(s){console.warn(s)}}}}).catch(n=>{throw hi.create("idb-open",{originalErrorMessage:n.message})})),em}async function aR(n){try{const s=(await cS()).transaction(au),a=await s.objectStore(au).get(uS(n));return await s.done,a}catch(e){if(e instanceof Pl)ka.warn(e.message);else{const s=hi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ka.warn(s.message)}}}async function jv(n,e){try{const a=(await cS()).transaction(au,"readwrite");await a.objectStore(au).put(e,uS(n)),await a.done}catch(s){if(s instanceof Pl)ka.warn(s.message);else{const a=hi.create("idb-set",{originalErrorMessage:s==null?void 0:s.message});ka.warn(a.message)}}}function uS(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iR=1024,oR=30;class lR{constructor(e){this.container=e,this._heartbeatsCache=null;const s=this.container.getProvider("app").getImmediate();this._storage=new uR(s),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,s;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=kv();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((s=this._heartbeatsCache)==null?void 0:s.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:o}),this._heartbeatsCache.heartbeats.length>oR){const d=dR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){ka.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const s=kv(),{heartbeatsToSend:a,unsentEntries:o}=cR(this._heartbeatsCache.heartbeats),l=cf(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=s,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(s){return ka.warn(s),""}}}function kv(){return new Date().toISOString().substring(0,10)}function cR(n,e=iR){const s=[];let a=n.slice();for(const o of n){const l=s.find(d=>d.agent===o.agent);if(l){if(l.dates.push(o.date),Lv(s)>e){l.dates.pop();break}}else if(s.push({agent:o.agent,dates:[o.date]}),Lv(s)>e){s.pop();break}a=a.slice(1)}return{heartbeatsToSend:s,unsentEntries:a}}class uR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return KN()?ZN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const s=await aR(this.app);return s!=null&&s.heartbeats?s:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return jv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return jv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function Lv(n){return cf(JSON.stringify({version:2,heartbeats:n})).length}function dR(n){if(n.length===0)return-1;let e=0,s=n[0].date;for(let a=1;a<n.length;a++)n[a].date<s&&(s=n[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fR(n){ff(new ru("platform-logger",e=>new vC(e),"PRIVATE")),ff(new ru("heartbeat",e=>new lR(e),"PRIVATE")),wl(Qm,Rv,n),wl(Qm,Rv,"esm2020"),wl("fire-js","")}fR("");var hR="firebase",pR="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */wl(hR,pR,"app");var Mv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var pi,dS;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,T){function _(){}_.prototype=T.prototype,I.F=T.prototype,I.prototype=new _,I.prototype.constructor=I,I.D=function(C,R,L){for(var O=Array(arguments.length-2),_e=2;_e<arguments.length;_e++)O[_e-2]=arguments[_e];return T.prototype[R].apply(C,O)}}function s(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(a,s),a.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(I,T,_){_||(_=0);const C=Array(16);if(typeof T=="string")for(var R=0;R<16;++R)C[R]=T.charCodeAt(_++)|T.charCodeAt(_++)<<8|T.charCodeAt(_++)<<16|T.charCodeAt(_++)<<24;else for(R=0;R<16;++R)C[R]=T[_++]|T[_++]<<8|T[_++]<<16|T[_++]<<24;T=I.g[0],_=I.g[1],R=I.g[2];let L=I.g[3],O;O=T+(L^_&(R^L))+C[0]+3614090360&4294967295,T=_+(O<<7&4294967295|O>>>25),O=L+(R^T&(_^R))+C[1]+3905402710&4294967295,L=T+(O<<12&4294967295|O>>>20),O=R+(_^L&(T^_))+C[2]+606105819&4294967295,R=L+(O<<17&4294967295|O>>>15),O=_+(T^R&(L^T))+C[3]+3250441966&4294967295,_=R+(O<<22&4294967295|O>>>10),O=T+(L^_&(R^L))+C[4]+4118548399&4294967295,T=_+(O<<7&4294967295|O>>>25),O=L+(R^T&(_^R))+C[5]+1200080426&4294967295,L=T+(O<<12&4294967295|O>>>20),O=R+(_^L&(T^_))+C[6]+2821735955&4294967295,R=L+(O<<17&4294967295|O>>>15),O=_+(T^R&(L^T))+C[7]+4249261313&4294967295,_=R+(O<<22&4294967295|O>>>10),O=T+(L^_&(R^L))+C[8]+1770035416&4294967295,T=_+(O<<7&4294967295|O>>>25),O=L+(R^T&(_^R))+C[9]+2336552879&4294967295,L=T+(O<<12&4294967295|O>>>20),O=R+(_^L&(T^_))+C[10]+4294925233&4294967295,R=L+(O<<17&4294967295|O>>>15),O=_+(T^R&(L^T))+C[11]+2304563134&4294967295,_=R+(O<<22&4294967295|O>>>10),O=T+(L^_&(R^L))+C[12]+1804603682&4294967295,T=_+(O<<7&4294967295|O>>>25),O=L+(R^T&(_^R))+C[13]+4254626195&4294967295,L=T+(O<<12&4294967295|O>>>20),O=R+(_^L&(T^_))+C[14]+2792965006&4294967295,R=L+(O<<17&4294967295|O>>>15),O=_+(T^R&(L^T))+C[15]+1236535329&4294967295,_=R+(O<<22&4294967295|O>>>10),O=T+(R^L&(_^R))+C[1]+4129170786&4294967295,T=_+(O<<5&4294967295|O>>>27),O=L+(_^R&(T^_))+C[6]+3225465664&4294967295,L=T+(O<<9&4294967295|O>>>23),O=R+(T^_&(L^T))+C[11]+643717713&4294967295,R=L+(O<<14&4294967295|O>>>18),O=_+(L^T&(R^L))+C[0]+3921069994&4294967295,_=R+(O<<20&4294967295|O>>>12),O=T+(R^L&(_^R))+C[5]+3593408605&4294967295,T=_+(O<<5&4294967295|O>>>27),O=L+(_^R&(T^_))+C[10]+38016083&4294967295,L=T+(O<<9&4294967295|O>>>23),O=R+(T^_&(L^T))+C[15]+3634488961&4294967295,R=L+(O<<14&4294967295|O>>>18),O=_+(L^T&(R^L))+C[4]+3889429448&4294967295,_=R+(O<<20&4294967295|O>>>12),O=T+(R^L&(_^R))+C[9]+568446438&4294967295,T=_+(O<<5&4294967295|O>>>27),O=L+(_^R&(T^_))+C[14]+3275163606&4294967295,L=T+(O<<9&4294967295|O>>>23),O=R+(T^_&(L^T))+C[3]+4107603335&4294967295,R=L+(O<<14&4294967295|O>>>18),O=_+(L^T&(R^L))+C[8]+1163531501&4294967295,_=R+(O<<20&4294967295|O>>>12),O=T+(R^L&(_^R))+C[13]+2850285829&4294967295,T=_+(O<<5&4294967295|O>>>27),O=L+(_^R&(T^_))+C[2]+4243563512&4294967295,L=T+(O<<9&4294967295|O>>>23),O=R+(T^_&(L^T))+C[7]+1735328473&4294967295,R=L+(O<<14&4294967295|O>>>18),O=_+(L^T&(R^L))+C[12]+2368359562&4294967295,_=R+(O<<20&4294967295|O>>>12),O=T+(_^R^L)+C[5]+4294588738&4294967295,T=_+(O<<4&4294967295|O>>>28),O=L+(T^_^R)+C[8]+2272392833&4294967295,L=T+(O<<11&4294967295|O>>>21),O=R+(L^T^_)+C[11]+1839030562&4294967295,R=L+(O<<16&4294967295|O>>>16),O=_+(R^L^T)+C[14]+4259657740&4294967295,_=R+(O<<23&4294967295|O>>>9),O=T+(_^R^L)+C[1]+2763975236&4294967295,T=_+(O<<4&4294967295|O>>>28),O=L+(T^_^R)+C[4]+1272893353&4294967295,L=T+(O<<11&4294967295|O>>>21),O=R+(L^T^_)+C[7]+4139469664&4294967295,R=L+(O<<16&4294967295|O>>>16),O=_+(R^L^T)+C[10]+3200236656&4294967295,_=R+(O<<23&4294967295|O>>>9),O=T+(_^R^L)+C[13]+681279174&4294967295,T=_+(O<<4&4294967295|O>>>28),O=L+(T^_^R)+C[0]+3936430074&4294967295,L=T+(O<<11&4294967295|O>>>21),O=R+(L^T^_)+C[3]+3572445317&4294967295,R=L+(O<<16&4294967295|O>>>16),O=_+(R^L^T)+C[6]+76029189&4294967295,_=R+(O<<23&4294967295|O>>>9),O=T+(_^R^L)+C[9]+3654602809&4294967295,T=_+(O<<4&4294967295|O>>>28),O=L+(T^_^R)+C[12]+3873151461&4294967295,L=T+(O<<11&4294967295|O>>>21),O=R+(L^T^_)+C[15]+530742520&4294967295,R=L+(O<<16&4294967295|O>>>16),O=_+(R^L^T)+C[2]+3299628645&4294967295,_=R+(O<<23&4294967295|O>>>9),O=T+(R^(_|~L))+C[0]+4096336452&4294967295,T=_+(O<<6&4294967295|O>>>26),O=L+(_^(T|~R))+C[7]+1126891415&4294967295,L=T+(O<<10&4294967295|O>>>22),O=R+(T^(L|~_))+C[14]+2878612391&4294967295,R=L+(O<<15&4294967295|O>>>17),O=_+(L^(R|~T))+C[5]+4237533241&4294967295,_=R+(O<<21&4294967295|O>>>11),O=T+(R^(_|~L))+C[12]+1700485571&4294967295,T=_+(O<<6&4294967295|O>>>26),O=L+(_^(T|~R))+C[3]+2399980690&4294967295,L=T+(O<<10&4294967295|O>>>22),O=R+(T^(L|~_))+C[10]+4293915773&4294967295,R=L+(O<<15&4294967295|O>>>17),O=_+(L^(R|~T))+C[1]+2240044497&4294967295,_=R+(O<<21&4294967295|O>>>11),O=T+(R^(_|~L))+C[8]+1873313359&4294967295,T=_+(O<<6&4294967295|O>>>26),O=L+(_^(T|~R))+C[15]+4264355552&4294967295,L=T+(O<<10&4294967295|O>>>22),O=R+(T^(L|~_))+C[6]+2734768916&4294967295,R=L+(O<<15&4294967295|O>>>17),O=_+(L^(R|~T))+C[13]+1309151649&4294967295,_=R+(O<<21&4294967295|O>>>11),O=T+(R^(_|~L))+C[4]+4149444226&4294967295,T=_+(O<<6&4294967295|O>>>26),O=L+(_^(T|~R))+C[11]+3174756917&4294967295,L=T+(O<<10&4294967295|O>>>22),O=R+(T^(L|~_))+C[2]+718787259&4294967295,R=L+(O<<15&4294967295|O>>>17),O=_+(L^(R|~T))+C[9]+3951481745&4294967295,I.g[0]=I.g[0]+T&4294967295,I.g[1]=I.g[1]+(R+(O<<21&4294967295|O>>>11))&4294967295,I.g[2]=I.g[2]+R&4294967295,I.g[3]=I.g[3]+L&4294967295}a.prototype.v=function(I,T){T===void 0&&(T=I.length);const _=T-this.blockSize,C=this.C;let R=this.h,L=0;for(;L<T;){if(R==0)for(;L<=_;)o(this,I,L),L+=this.blockSize;if(typeof I=="string"){for(;L<T;)if(C[R++]=I.charCodeAt(L++),R==this.blockSize){o(this,C),R=0;break}}else for(;L<T;)if(C[R++]=I[L++],R==this.blockSize){o(this,C),R=0;break}}this.h=R,this.o+=T},a.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var T=1;T<I.length-8;++T)I[T]=0;T=this.o*8;for(var _=I.length-8;_<I.length;++_)I[_]=T&255,T/=256;for(this.v(I),I=Array(16),T=0,_=0;_<4;++_)for(let C=0;C<32;C+=8)I[T++]=this.g[_]>>>C&255;return I};function l(I,T){var _=p;return Object.prototype.hasOwnProperty.call(_,I)?_[I]:_[I]=T(I)}function d(I,T){this.h=T;const _=[];let C=!0;for(let R=I.length-1;R>=0;R--){const L=I[R]|0;C&&L==T||(_[R]=L,C=!1)}this.g=_}var p={};function m(I){return-128<=I&&I<128?l(I,function(T){return new d([T|0],T<0?-1:0)}):new d([I|0],I<0?-1:0)}function y(I){if(isNaN(I)||!isFinite(I))return v;if(I<0)return j(y(-I));const T=[];let _=1;for(let C=0;I>=_;C++)T[C]=I/_|0,_*=4294967296;return new d(T,0)}function x(I,T){if(I.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(I.charAt(0)=="-")return j(x(I.substring(1),T));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const _=y(Math.pow(T,8));let C=v;for(let L=0;L<I.length;L+=8){var R=Math.min(8,I.length-L);const O=parseInt(I.substring(L,L+R),T);R<8?(R=y(Math.pow(T,R)),C=C.j(R).add(y(O))):(C=C.j(_),C=C.add(y(O)))}return C}var v=m(0),S=m(1),N=m(16777216);n=d.prototype,n.m=function(){if(D(this))return-j(this).m();let I=0,T=1;for(let _=0;_<this.g.length;_++){const C=this.i(_);I+=(C>=0?C:4294967296+C)*T,T*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(z(this))return"0";if(D(this))return"-"+j(this).toString(I);const T=y(Math.pow(I,6));var _=this;let C="";for(;;){const R=H(_,T).g;_=P(_,R.j(T));let L=((_.g.length>0?_.g[0]:_.h)>>>0).toString(I);if(_=R,z(_))return L+C;for(;L.length<6;)L="0"+L;C=L+C}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function z(I){if(I.h!=0)return!1;for(let T=0;T<I.g.length;T++)if(I.g[T]!=0)return!1;return!0}function D(I){return I.h==-1}n.l=function(I){return I=P(this,I),D(I)?-1:z(I)?0:1};function j(I){const T=I.g.length,_=[];for(let C=0;C<T;C++)_[C]=~I.g[C];return new d(_,~I.h).add(S)}n.abs=function(){return D(this)?j(this):this},n.add=function(I){const T=Math.max(this.g.length,I.g.length),_=[];let C=0;for(let R=0;R<=T;R++){let L=C+(this.i(R)&65535)+(I.i(R)&65535),O=(L>>>16)+(this.i(R)>>>16)+(I.i(R)>>>16);C=O>>>16,L&=65535,O&=65535,_[R]=O<<16|L}return new d(_,_[_.length-1]&-2147483648?-1:0)};function P(I,T){return I.add(j(T))}n.j=function(I){if(z(this)||z(I))return v;if(D(this))return D(I)?j(this).j(j(I)):j(j(this).j(I));if(D(I))return j(this.j(j(I)));if(this.l(N)<0&&I.l(N)<0)return y(this.m()*I.m());const T=this.g.length+I.g.length,_=[];for(var C=0;C<2*T;C++)_[C]=0;for(C=0;C<this.g.length;C++)for(let R=0;R<I.g.length;R++){const L=this.i(C)>>>16,O=this.i(C)&65535,_e=I.i(R)>>>16,ye=I.i(R)&65535;_[2*C+2*R]+=O*ye,F(_,2*C+2*R),_[2*C+2*R+1]+=L*ye,F(_,2*C+2*R+1),_[2*C+2*R+1]+=O*_e,F(_,2*C+2*R+1),_[2*C+2*R+2]+=L*_e,F(_,2*C+2*R+2)}for(I=0;I<T;I++)_[I]=_[2*I+1]<<16|_[2*I];for(I=T;I<2*T;I++)_[I]=0;return new d(_,0)};function F(I,T){for(;(I[T]&65535)!=I[T];)I[T+1]+=I[T]>>>16,I[T]&=65535,T++}function G(I,T){this.g=I,this.h=T}function H(I,T){if(z(T))throw Error("division by zero");if(z(I))return new G(v,v);if(D(I))return T=H(j(I),T),new G(j(T.g),j(T.h));if(D(T))return T=H(I,j(T)),new G(j(T.g),T.h);if(I.g.length>30){if(D(I)||D(T))throw Error("slowDivide_ only works with positive integers.");for(var _=S,C=T;C.l(I)<=0;)_=W(_),C=W(C);var R=Q(_,1),L=Q(C,1);for(C=Q(C,2),_=Q(_,2);!z(C);){var O=L.add(C);O.l(I)<=0&&(R=R.add(_),L=O),C=Q(C,1),_=Q(_,1)}return T=P(I,R.j(T)),new G(R,T)}for(R=v;I.l(T)>=0;){for(_=Math.max(1,Math.floor(I.m()/T.m())),C=Math.ceil(Math.log(_)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),L=y(_),O=L.j(T);D(O)||O.l(I)>0;)_-=C,L=y(_),O=L.j(T);z(L)&&(L=S),R=R.add(L),I=P(I,O)}return new G(R,I)}n.B=function(I){return H(this,I).h},n.and=function(I){const T=Math.max(this.g.length,I.g.length),_=[];for(let C=0;C<T;C++)_[C]=this.i(C)&I.i(C);return new d(_,this.h&I.h)},n.or=function(I){const T=Math.max(this.g.length,I.g.length),_=[];for(let C=0;C<T;C++)_[C]=this.i(C)|I.i(C);return new d(_,this.h|I.h)},n.xor=function(I){const T=Math.max(this.g.length,I.g.length),_=[];for(let C=0;C<T;C++)_[C]=this.i(C)^I.i(C);return new d(_,this.h^I.h)};function W(I){const T=I.g.length+1,_=[];for(let C=0;C<T;C++)_[C]=I.i(C)<<1|I.i(C-1)>>>31;return new d(_,I.h)}function Q(I,T){const _=T>>5;T%=32;const C=I.g.length-_,R=[];for(let L=0;L<C;L++)R[L]=T>0?I.i(L+_)>>>T|I.i(L+_+1)<<32-T:I.i(L+_);return new d(R,I.h)}a.prototype.digest=a.prototype.A,a.prototype.reset=a.prototype.u,a.prototype.update=a.prototype.v,dS=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,pi=d}).apply(typeof Mv<"u"?Mv:typeof self<"u"?self:typeof window<"u"?window:{});var Pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var fS,Dc,hS,Jd,Zm,pS,mS,gS;(function(){var n,e=Object.defineProperty;function s(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pd=="object"&&Pd];for(var b=0;b<f.length;++b){var w=f[b];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var a=s(this);function o(f,b){if(b)e:{var w=a;f=f.split(".");for(var U=0;U<f.length-1;U++){var ee=f[U];if(!(ee in w))break e;w=w[ee]}f=f[f.length-1],U=w[f],b=b(U),b!=U&&b!=null&&e(w,f,{configurable:!0,writable:!0,value:b})}}o("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(f){return f||function(b){var w=[],U;for(U in b)Object.prototype.hasOwnProperty.call(b,U)&&w.push([U,b[U]]);return w}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},d=this||self;function p(f){var b=typeof f;return b=="object"&&f!=null||b=="function"}function m(f,b,w){return f.call.apply(f.bind,arguments)}function y(f,b,w){return y=m,y.apply(null,arguments)}function x(f,b){var w=Array.prototype.slice.call(arguments,1);return function(){var U=w.slice();return U.push.apply(U,arguments),f.apply(this,U)}}function v(f,b){function w(){}w.prototype=b.prototype,f.Z=b.prototype,f.prototype=new w,f.prototype.constructor=f,f.Ob=function(U,ee,oe){for(var Ce=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)Ce[ot-2]=arguments[ot];return b.prototype[ee].apply(U,Ce)}}var S=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function N(f){const b=f.length;if(b>0){const w=Array(b);for(let U=0;U<b;U++)w[U]=f[U];return w}return[]}function z(f,b){for(let U=1;U<arguments.length;U++){const ee=arguments[U];var w=typeof ee;if(w=w!="object"?w:ee?Array.isArray(ee)?"array":w:"null",w=="array"||w=="object"&&typeof ee.length=="number"){w=f.length||0;const oe=ee.length||0;f.length=w+oe;for(let Ce=0;Ce<oe;Ce++)f[w+Ce]=ee[Ce]}else f.push(ee)}}class D{constructor(b,w){this.i=b,this.j=w,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function j(f){d.setTimeout(()=>{throw f},0)}function P(){var f=I;let b=null;return f.g&&(b=f.g,f.g=f.g.next,f.g||(f.h=null),b.next=null),b}class F{constructor(){this.h=this.g=null}add(b,w){const U=G.get();U.set(b,w),this.h?this.h.next=U:this.g=U,this.h=U}}var G=new D(()=>new H,f=>f.reset());class H{constructor(){this.next=this.g=this.h=null}set(b,w){this.h=b,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let W,Q=!1,I=new F,T=()=>{const f=Promise.resolve(void 0);W=()=>{f.then(_)}};function _(){for(var f;f=P();){try{f.h.call(f.g)}catch(w){j(w)}var b=G;b.j(f),b.h<100&&(b.h++,f.next=b.g,b.g=f)}Q=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function R(f,b){this.type=f,this.g=this.target=b,this.defaultPrevented=!1}R.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var f=!1,b=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const w=()=>{};d.addEventListener("test",w,b),d.removeEventListener("test",w,b)}catch{}return f})();function O(f){return/^[\s\xa0]*$/.test(f)}function _e(f,b){R.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,b)}v(_e,R),_e.prototype.init=function(f,b){const w=this.type=f.type,U=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=b,b=f.relatedTarget,b||(w=="mouseover"?b=f.fromElement:w=="mouseout"&&(b=f.toElement)),this.relatedTarget=b,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&_e.Z.h.call(this)},_e.prototype.h=function(){_e.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ye="closure_listenable_"+(Math.random()*1e6|0),B=0;function le(f,b,w,U,ee){this.listener=f,this.proxy=null,this.src=b,this.type=w,this.capture=!!U,this.ha=ee,this.key=++B,this.da=this.fa=!1}function se(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Z(f,b,w){for(const U in f)b.call(w,f[U],U,f)}function Y(f,b){for(const w in f)b.call(void 0,f[w],w,f)}function A(f){const b={};for(const w in f)b[w]=f[w];return b}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q(f,b){let w,U;for(let ee=1;ee<arguments.length;ee++){U=arguments[ee];for(w in U)f[w]=U[w];for(let oe=0;oe<V.length;oe++)w=V[oe],Object.prototype.hasOwnProperty.call(U,w)&&(f[w]=U[w])}}function X(f){this.src=f,this.g={},this.h=0}X.prototype.add=function(f,b,w,U,ee){const oe=f.toString();f=this.g[oe],f||(f=this.g[oe]=[],this.h++);const Ce=ce(f,b,U,ee);return Ce>-1?(b=f[Ce],w||(b.fa=!1)):(b=new le(b,this.src,oe,!!U,ee),b.fa=w,f.push(b)),b};function de(f,b){const w=b.type;if(w in f.g){var U=f.g[w],ee=Array.prototype.indexOf.call(U,b,void 0),oe;(oe=ee>=0)&&Array.prototype.splice.call(U,ee,1),oe&&(se(b),f.g[w].length==0&&(delete f.g[w],f.h--))}}function ce(f,b,w,U){for(let ee=0;ee<f.length;++ee){const oe=f[ee];if(!oe.da&&oe.listener==b&&oe.capture==!!w&&oe.ha==U)return ee}return-1}var fe="closure_lm_"+(Math.random()*1e6|0),ie={};function Ae(f,b,w,U,ee){if(Array.isArray(b)){for(let oe=0;oe<b.length;oe++)Ae(f,b[oe],w,U,ee);return null}return w=et(w),f&&f[ye]?f.J(b,w,p(U)?!!U.capture:!1,ee):he(f,b,w,!1,U,ee)}function he(f,b,w,U,ee,oe){if(!b)throw Error("Invalid event type");const Ce=p(ee)?!!ee.capture:!!ee;let ot=Te(f);if(ot||(f[fe]=ot=new X(f)),w=ot.add(b,w,U,Ce,oe),w.proxy)return w;if(U=xe(),w.proxy=U,U.src=f,U.listener=w,f.addEventListener)L||(ee=Ce),ee===void 0&&(ee=!1),f.addEventListener(b.toString(),U,ee);else if(f.attachEvent)f.attachEvent(Ie(b.toString()),U);else if(f.addListener&&f.removeListener)f.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return w}function xe(){function f(w){return b.call(f.src,f.listener,w)}const b=Le;return f}function je(f,b,w,U,ee){if(Array.isArray(b))for(var oe=0;oe<b.length;oe++)je(f,b[oe],w,U,ee);else U=p(U)?!!U.capture:!!U,w=et(w),f&&f[ye]?(f=f.i,oe=String(b).toString(),oe in f.g&&(b=f.g[oe],w=ce(b,w,U,ee),w>-1&&(se(b[w]),Array.prototype.splice.call(b,w,1),b.length==0&&(delete f.g[oe],f.h--)))):f&&(f=Te(f))&&(b=f.g[b.toString()],f=-1,b&&(f=ce(b,w,U,ee)),(w=f>-1?b[f]:null)&&pe(w))}function pe(f){if(typeof f!="number"&&f&&!f.da){var b=f.src;if(b&&b[ye])de(b.i,f);else{var w=f.type,U=f.proxy;b.removeEventListener?b.removeEventListener(w,U,f.capture):b.detachEvent?b.detachEvent(Ie(w),U):b.addListener&&b.removeListener&&b.removeListener(U),(w=Te(b))?(de(w,f),w.h==0&&(w.src=null,b[fe]=null)):se(f)}}}function Ie(f){return f in ie?ie[f]:ie[f]="on"+f}function Le(f,b){if(f.da)f=!0;else{b=new _e(b,this);const w=f.listener,U=f.ha||f.src;f.fa&&pe(f),f=w.call(U,b)}return f}function Te(f){return f=f[fe],f instanceof X?f:null}var me="__closure_events_fn_"+(Math.random()*1e9>>>0);function et(f){return typeof f=="function"?f:(f[me]||(f[me]=function(b){return f.handleEvent(b)}),f[me])}function Xe(){C.call(this),this.i=new X(this),this.M=this,this.G=null}v(Xe,C),Xe.prototype[ye]=!0,Xe.prototype.removeEventListener=function(f,b,w,U){je(this,f,b,w,U)};function re(f,b){var w,U=f.G;if(U)for(w=[];U;U=U.G)w.push(U);if(f=f.M,U=b.type||b,typeof b=="string")b=new R(b,f);else if(b instanceof R)b.target=b.target||f;else{var ee=b;b=new R(U,f),q(b,ee)}ee=!0;let oe,Ce;if(w)for(Ce=w.length-1;Ce>=0;Ce--)oe=b.g=w[Ce],ee=Fe(oe,U,!0,b)&&ee;if(oe=b.g=f,ee=Fe(oe,U,!0,b)&&ee,ee=Fe(oe,U,!1,b)&&ee,w)for(Ce=0;Ce<w.length;Ce++)oe=b.g=w[Ce],ee=Fe(oe,U,!1,b)&&ee}Xe.prototype.N=function(){if(Xe.Z.N.call(this),this.i){var f=this.i;for(const b in f.g){const w=f.g[b];for(let U=0;U<w.length;U++)se(w[U]);delete f.g[b],f.h--}}this.G=null},Xe.prototype.J=function(f,b,w,U){return this.i.add(String(f),b,!1,w,U)},Xe.prototype.K=function(f,b,w,U){return this.i.add(String(f),b,!0,w,U)};function Fe(f,b,w,U){if(b=f.i.g[String(b)],!b)return!0;b=b.concat();let ee=!0;for(let oe=0;oe<b.length;++oe){const Ce=b[oe];if(Ce&&!Ce.da&&Ce.capture==w){const ot=Ce.listener,gn=Ce.ha||Ce.src;Ce.fa&&de(f.i,Ce),ee=ot.call(gn,U)!==!1&&ee}}return ee&&!U.defaultPrevented}function rt(f,b){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=y(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(f,b||0)}function Tt(f){f.g=rt(()=>{f.g=null,f.i&&(f.i=!1,Tt(f))},f.l);const b=f.h;f.h=null,f.m.apply(null,b)}class Ze extends C{constructor(b,w){super(),this.m=b,this.l=w,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:Tt(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function tt(f){C.call(this),this.h=f,this.g={}}v(tt,C);var ut=[];function At(f){Z(f.g,function(b,w){this.g.hasOwnProperty(w)&&pe(b)},f),f.g={}}tt.prototype.N=function(){tt.Z.N.call(this),At(this)},tt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ht=d.JSON.stringify,fr=d.JSON.parse,hr=class{stringify(f){return d.JSON.stringify(f,void 0)}parse(f){return d.JSON.parse(f,void 0)}};function Cs(){}function ys(){}var pn={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function be(){R.call(this,"d")}v(be,R);function De(){R.call(this,"c")}v(De,R);var Ne={},bt=null;function it(){return bt=bt||new Xe}Ne.Ia="serverreachability";function Ge(f){R.call(this,Ne.Ia,f)}v(Ge,R);function It(f){const b=it();re(b,new Ge(b))}Ne.STAT_EVENT="statevent";function dt(f,b){R.call(this,Ne.STAT_EVENT,f),this.stat=b}v(dt,R);function Je(f){const b=it();re(b,new dt(b,f))}Ne.Ja="timingevent";function Qt(f,b){R.call(this,Ne.Ja,f),this.size=b}v(Qt,R);function gt(f,b){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){f()},b)}function rn(){this.g=!0}rn.prototype.ua=function(){this.g=!1};function xs(f,b,w,U,ee,oe){f.info(function(){if(f.g)if(oe){var Ce="",ot=oe.split("&");for(let Ot=0;Ot<ot.length;Ot++){var gn=ot[Ot].split("=");if(gn.length>1){const Kt=gn[0];gn=gn[1];const Xs=Kt.split("_");Ce=Xs.length>=2&&Xs[1]=="type"?Ce+(Kt+"="+gn+"&"):Ce+(Kt+"=redacted&")}}}else Ce=null;else Ce=oe;return"XMLHTTP REQ ("+U+") [attempt "+ee+"]: "+b+`
`+w+`
`+Ce})}function bs(f,b,w,U,ee,oe,Ce){f.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+ee+"]: "+b+`
`+w+`
`+oe+" "+Ce})}function Wt(f,b,w,U){f.info(function(){return"XMLHTTP TEXT ("+b+"): "+ta(f,w)+(U?" "+U:"")})}function Hn(f,b){f.info(function(){return"TIMEOUT: "+b})}rn.prototype.info=function(){};function ta(f,b){if(!f.g)return b;if(!b)return null;try{const oe=JSON.parse(b);if(oe){for(f=0;f<oe.length;f++)if(Array.isArray(oe[f])){var w=oe[f];if(!(w.length<2)){var U=w[1];if(Array.isArray(U)&&!(U.length<1)){var ee=U[0];if(ee!="noop"&&ee!="stop"&&ee!="close")for(let Ce=1;Ce<U.length;Ce++)U[Ce]=""}}}}return Ht(oe)}catch{return b}}var Hs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},na={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Lr;function sa(){}v(sa,Cs),sa.prototype.g=function(){return new XMLHttpRequest},Lr=new sa;function pr(f){return encodeURIComponent(String(f))}function Rs(f){var b=1;f=f.split(":");const w=[];for(;b>0&&f.length;)w.push(f.shift()),b--;return f.length&&w.push(f.join(":")),w}function mn(f,b,w,U){this.j=f,this.i=b,this.l=w,this.S=U||1,this.V=new tt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new is}function is(){this.i=null,this.g="",this.h=!1}var an={},_n={};function Gs(f,b,w){f.M=1,f.A=ia(ln(b)),f.u=w,f.R=!0,ra(f,null)}function ra(f,b){f.F=Date.now(),Os(f),f.B=ln(f.A);var w=f.B,U=f.S;Array.isArray(U)||(U=[String(U)]),Ve(w.i,"t",U),f.C=0,w=f.j.L,f.h=new is,f.g=Ru(f.j,w?b:null,!f.u),f.P>0&&(f.O=new Ze(y(f.Y,f,f.g),f.P)),b=f.V,w=f.g,U=f.ba;var ee="readystatechange";Array.isArray(ee)||(ee&&(ut[0]=ee.toString()),ee=ut);for(let oe=0;oe<ee.length;oe++){const Ce=Ae(w,ee[oe],U||b.handleEvent,!1,b.h||b);if(!Ce)break;b.g[Ce.key]=Ce}b=f.J?A(f.J):{},f.u?(f.v||(f.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,b)):(f.v="GET",f.g.ea(f.B,f.v,null,b)),It(),xs(f.i,f.v,f.B,f.l,f.S,f.u)}mn.prototype.ba=function(f){f=f.target;const b=this.O;b&&gr(f)==3?b.j():this.Y(f)},mn.prototype.Y=function(f){try{if(f==this.g)e:{const ot=gr(this.g),gn=this.g.ya(),Ot=this.g.ca();if(!(ot<3)&&(ot!=3||this.g&&(this.h.h||this.g.la()||Gn(this.g)))){this.K||ot!=4||gn==7||(gn==8||Ot<=0?It(3):It(2)),qs(this);var b=this.g.ca();this.X=b;var w=Fl(this);if(this.o=b==200,bs(this.i,this.v,this.B,this.l,this.S,ot,b),this.o){if(this.U&&!this.L){t:{if(this.g){var U,ee=this.g;if((U=ee.g?ee.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(U)){var oe=U;break t}}oe=null}if(f=oe)Wt(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,$s(this,f);else{this.o=!1,this.m=3,Je(12),os(this),vs(this);break e}}if(this.R){f=!0;let Kt;for(;!this.K&&this.C<w.length;)if(Kt=Ai(this,w),Kt==_n){ot==4&&(this.m=4,Je(14),f=!1),Wt(this.i,this.l,null,"[Incomplete Response]");break}else if(Kt==an){this.m=4,Je(15),Wt(this.i,this.l,w,"[Invalid Chunk]"),f=!1;break}else Wt(this.i,this.l,Kt,null),$s(this,Kt);if(Ti(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ot!=4||w.length!=0||this.h.h||(this.m=1,Je(16),f=!1),this.o=this.o&&f,!f)Wt(this.i,this.l,w,"[Invalid Chunked Response]"),os(this),vs(this);else if(w.length>0&&!this.W){this.W=!0;var Ce=this.j;Ce.g==this&&Ce.aa&&!Ce.P&&(Ce.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),Ql(Ce),Ce.P=!0,Je(11))}}else Wt(this.i,this.l,w,null),$s(this,w);ot==4&&os(this),this.o&&!this.K&&(ot==4?Au(this.j,this):(this.o=!1,Os(this)))}else da(this.g),b==400&&w.indexOf("Unknown SID")>0?(this.m=3,Je(12)):(this.m=0,Je(13)),os(this),vs(this)}}}catch{}finally{}};function Fl(f){if(!Ti(f))return f.g.la();const b=Gn(f.g);if(b==="")return"";let w="";const U=b.length,ee=gr(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return os(f),vs(f),"";f.h.i=new d.TextDecoder}for(let oe=0;oe<U;oe++)f.h.h=!0,w+=f.h.i.decode(b[oe],{stream:!(ee&&oe==U-1)});return b.length=0,f.h.g+=w,f.C=0,f.h.g}function Ti(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function Ai(f,b){var w=f.C,U=b.indexOf(`
`,w);return U==-1?_n:(w=Number(b.substring(w,U)),isNaN(w)?an:(U+=1,U+w>b.length?_n:(b=b.slice(U,U+w),f.C=U+w,b)))}mn.prototype.cancel=function(){this.K=!0,os(this)};function Os(f){f.T=Date.now()+f.H,aa(f,f.H)}function aa(f,b){if(f.D!=null)throw Error("WatchDog timer not null");f.D=gt(y(f.aa,f),b)}function qs(f){f.D&&(d.clearTimeout(f.D),f.D=null)}mn.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(Hn(this.i,this.B),this.M!=2&&(It(),Je(17)),os(this),this.m=2,vs(this)):aa(this,this.T-f)};function vs(f){f.j.I==0||f.K||Au(f.j,f)}function os(f){qs(f);var b=f.O;b&&typeof b.dispose=="function"&&b.dispose(),f.O=null,At(f.V),f.g&&(b=f.g,f.g=null,b.abort(),b.dispose())}function $s(f,b){try{var w=f.j;if(w.I!=0&&(w.g==f||Qs(w.h,f))){if(!f.L&&Qs(w.h,f)&&w.I==3){try{var U=w.Ba.g.parse(b)}catch{U=null}if(Array.isArray(U)&&U.length==3){var ee=U;if(ee[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<f.F)jo(w),Pa(w);else break e;zi(w),Je(18)}}else w.xa=ee[1],0<w.xa-w.K&&ee[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=gt(y(w.Va,w),6e3));Ys(w.h)<=1&&w.ta&&(w.ta=void 0)}else Vr(w,11)}else if((f.L||w.g==f)&&jo(w),!O(b))for(ee=w.Ba.g.parse(b),b=0;b<ee.length;b++){let Ot=ee[b];const Kt=Ot[0];if(!(Kt<=w.K))if(w.K=Kt,Ot=Ot[1],w.I==2)if(Ot[0]=="c"){w.M=Ot[1],w.ba=Ot[2];const Xs=Ot[3];Xs!=null&&(w.ka=Xs,w.j.info("VER="+w.ka));const zr=Ot[4];zr!=null&&(w.za=zr,w.j.info("SVER="+w.za));const yr=Ot[5];yr!=null&&typeof yr=="number"&&yr>0&&(U=1.5*yr,w.O=U,w.j.info("backChannelRequestTimeoutMs_="+U)),U=w;const xr=f.g;if(xr){const Bi=xr.g?xr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bi){var oe=U.h;oe.g||Bi.indexOf("spdy")==-1&&Bi.indexOf("quic")==-1&&Bi.indexOf("h2")==-1||(oe.j=oe.l,oe.g=new Set,oe.h&&(Ci(oe,oe.h),oe.h=null))}if(U.G){const ko=xr.g?xr.g.getResponseHeader("X-HTTP-Session-Id"):null;ko&&(U.wa=ko,Rt(U.J,U.G,ko))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-f.F,w.j.info("Handshake RTT: "+w.T+"ms")),U=w;var Ce=f;if(U.na=Cu(U,U.L?U.ba:null,U.W),Ce.L){Ri(U.h,Ce);var ot=Ce,gn=U.O;gn&&(ot.H=gn),ot.D&&(qs(ot),Os(ot)),U.g=Ce}else Su(U);w.i.length>0&&Pr(w)}else Ot[0]!="stop"&&Ot[0]!="close"||Vr(w,7);else w.I==3&&(Ot[0]=="stop"||Ot[0]=="close"?Ot[0]=="stop"?Vr(w,7):$l(w):Ot[0]!="noop"&&w.l&&w.l.qa(Ot),w.A=0)}}It(4)}catch{}}var on=class{constructor(f,b){this.g=f,this.map=b}};function Ii(f){this.l=f||10,d.PerformanceNavigationTiming?(f=d.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ni(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Ys(f){return f.h?1:f.g?f.g.size:0}function Qs(f,b){return f.h?f.h==b:f.g?f.g.has(b):!1}function Ci(f,b){f.g?f.g.add(b):f.h=b}function Ri(f,b){f.h&&f.h==b?f.h=null:f.g&&f.g.has(b)&&f.g.delete(b)}Ii.prototype.cancel=function(){if(this.i=Oi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function Oi(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let b=f.i;for(const w of f.g.values())b=b.concat(w.G);return b}return N(f.i)}var ji=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ma(f,b){if(f){f=f.split("&");for(let w=0;w<f.length;w++){const U=f[w].indexOf("=");let ee,oe=null;U>=0?(ee=f[w].substring(0,U),oe=f[w].substring(U+1)):ee=f[w],b(ee,oe?decodeURIComponent(oe.replace(/\+/g," ")):"")}}}function ls(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;f instanceof ls?(this.l=f.l,En(this,f.j),this.o=f.o,this.g=f.g,Mr(this,f.u),this.h=f.h,ki(this,Ye(f.i)),this.m=f.m):f&&(b=String(f).match(ji))?(this.l=!1,En(this,b[1]||"",!0),this.o=Ws(b[2]||""),this.g=Ws(b[3]||"",!0),Mr(this,b[4]),this.h=Ws(b[5]||"",!0),ki(this,b[6]||"",!0),this.m=Ws(b[7]||"")):(this.l=!1,this.i=new ca(null,this.l))}ls.prototype.toString=function(){const f=[];var b=this.j;b&&f.push(Ks(b,oa,!0),":");var w=this.g;return(w||b=="file")&&(f.push("//"),(b=this.o)&&f.push(Ks(b,oa,!0),"@"),f.push(pr(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&f.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&f.push("/"),f.push(Ks(w,w.charAt(0)=="/"?No:Li,!0))),(w=this.i.toString())&&f.push("?",w),(w=this.m)&&f.push("#",Ks(w,Hl)),f.join("")},ls.prototype.resolve=function(f){const b=ln(this);let w=!!f.j;w?En(b,f.j):w=!!f.o,w?b.o=f.o:w=!!f.g,w?b.g=f.g:w=f.u!=null;var U=f.h;if(w)Mr(b,f.u);else if(w=!!f.h){if(U.charAt(0)!="/")if(this.g&&!this.h)U="/"+U;else{var ee=b.h.lastIndexOf("/");ee!=-1&&(U=b.h.slice(0,ee+1)+U)}if(ee=U,ee==".."||ee==".")U="";else if(ee.indexOf("./")!=-1||ee.indexOf("/.")!=-1){U=ee.lastIndexOf("/",0)==0,ee=ee.split("/");const oe=[];for(let Ce=0;Ce<ee.length;){const ot=ee[Ce++];ot=="."?U&&Ce==ee.length&&oe.push(""):ot==".."?((oe.length>1||oe.length==1&&oe[0]!="")&&oe.pop(),U&&Ce==ee.length&&oe.push("")):(oe.push(ot),U=!0)}U=oe.join("/")}else U=ee}return w?b.h=U:w=f.i.toString()!=="",w?ki(b,Ye(f.i)):w=!!f.m,w&&(b.m=f.m),b};function ln(f){return new ls(f)}function En(f,b,w){f.j=w?Ws(b,!0):b,f.j&&(f.j=f.j.replace(/:$/,""))}function Mr(f,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);f.u=b}else f.u=null}function ki(f,b,w){b instanceof ca?(f.i=b,Qe(f.i,f.l)):(w||(b=Ks(b,la)),f.i=new ca(b,f.l))}function Rt(f,b,w){f.i.set(b,w)}function ia(f){return Rt(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function Ws(f,b){return f?b?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Ks(f,b,w){return typeof f=="string"?(f=encodeURI(f).replace(b,Xn),w&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Xn(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var oa=/[#\/\?@]/g,Li=/[#\?:]/g,No=/[#\?]/g,la=/[#\?@]/g,Hl=/#/g;function ca(f,b){this.h=this.g=null,this.i=f||null,this.j=!!b}function cs(f){f.g||(f.g=new Map,f.h=0,f.i&&Ma(f.i,function(b,w){f.add(decodeURIComponent(b.replace(/\+/g," ")),w)}))}n=ca.prototype,n.add=function(f,b){cs(this),this.i=null,f=$e(this,f);let w=this.g.get(f);return w||this.g.set(f,w=[]),w.push(b),this.h+=1,this};function Oe(f,b){cs(f),b=$e(f,b),f.g.has(b)&&(f.i=null,f.h-=f.g.get(b).length,f.g.delete(b))}function ke(f,b){return cs(f),b=$e(f,b),f.g.has(b)}n.forEach=function(f,b){cs(this),this.g.forEach(function(w,U){w.forEach(function(ee){f.call(b,ee,U,this)},this)},this)};function Be(f,b){cs(f);let w=[];if(typeof b=="string")ke(f,b)&&(w=w.concat(f.g.get($e(f,b))));else for(f=Array.from(f.g.values()),b=0;b<f.length;b++)w=w.concat(f[b]);return w}n.set=function(f,b){return cs(this),this.i=null,f=$e(this,f),ke(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[b]),this.h+=1,this},n.get=function(f,b){return f?(f=Be(this,f),f.length>0?String(f[0]):b):b};function Ve(f,b,w){Oe(f,b),w.length>0&&(f.i=null,f.g.set($e(f,b),N(w)),f.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],b=Array.from(this.g.keys());for(let U=0;U<b.length;U++){var w=b[U];const ee=pr(w);w=Be(this,w);for(let oe=0;oe<w.length;oe++){let Ce=ee;w[oe]!==""&&(Ce+="="+pr(w[oe])),f.push(Ce)}}return this.i=f.join("&")};function Ye(f){const b=new ca;return b.i=f.i,f.g&&(b.g=new Map(f.g),b.h=f.h),b}function $e(f,b){return b=String(b),f.j&&(b=b.toLowerCase()),b}function Qe(f,b){b&&!f.j&&(cs(f),f.i=null,f.g.forEach(function(w,U){const ee=U.toLowerCase();U!=ee&&(Oe(this,U),Ve(this,ee,w))},f)),f.j=b}function kt(f,b){const w=new rn;if(d.Image){const U=new Image;U.onload=x(Gt,w,"TestLoadImage: loaded",!0,b,U),U.onerror=x(Gt,w,"TestLoadImage: error",!1,b,U),U.onabort=x(Gt,w,"TestLoadImage: abort",!1,b,U),U.ontimeout=x(Gt,w,"TestLoadImage: timeout",!1,b,U),d.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=f}else b(!1)}function On(f,b){const w=new rn,U=new AbortController,ee=setTimeout(()=>{U.abort(),Gt(w,"TestPingServer: timeout",!1,b)},1e4);fetch(f,{signal:U.signal}).then(oe=>{clearTimeout(ee),oe.ok?Gt(w,"TestPingServer: ok",!0,b):Gt(w,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(ee),Gt(w,"TestPingServer: error",!1,b)})}function Gt(f,b,w,U,ee){try{ee&&(ee.onload=null,ee.onerror=null,ee.onabort=null,ee.ontimeout=null),U(w)}catch{}}function cn(){this.g=new hr}function Un(f){this.i=f.Sb||null,this.h=f.ab||!1}v(Un,Cs),Un.prototype.g=function(){return new Mi(this.i,this.h)};function Mi(f,b){Xe.call(this),this.H=f,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(Mi,Xe),n=Mi.prototype,n.open=function(f,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=b,this.readyState=1,mr(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(b.body=f),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Da(this)),this.readyState=0},n.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,mr(this)),this.g&&(this.readyState=3,mr(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Co(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function Co(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}n.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var b=f.value?f.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!f.done}))&&(this.response=this.responseText+=b)}f.done?Da(this):mr(this),this.readyState==3&&Co(this)}},n.Oa=function(f){this.g&&(this.response=this.responseText=f,Da(this))},n.Na=function(f){this.g&&(this.response=f,Da(this))},n.ga=function(){this.g&&Da(this)};function Da(f){f.readyState=4,f.l=null,f.j=null,f.B=null,mr(f)}n.setRequestHeader=function(f,b){this.A.append(f,b)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],b=this.h.entries();for(var w=b.next();!w.done;)w=w.value,f.push(w[0]+": "+w[1]),w=b.next();return f.join(`\r
`)};function mr(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Mi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Zs(f){let b="";return Z(f,function(w,U){b+=U,b+=":",b+=w,b+=`\r
`}),b}function Di(f,b,w){e:{for(U in w){var U=!1;break e}U=!0}U||(w=Zs(w),typeof f=="string"?w!=null&&pr(w):Rt(f,b,w))}function Ut(f){Xe.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(Ut,Xe);var Dr=/^https?$/i,Gl=["POST","PUT"];n=Ut.prototype,n.Fa=function(f){this.H=f},n.ea=function(f,b,w,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);b=b?b.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Lr.g(),this.g.onreadystatechange=S(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(f),!0),this.B=!1}catch(oe){Ui(this,oe);return}if(f=w||"",w=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var ee in U)w.set(ee,U[ee]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const oe of U.keys())w.set(oe,U.get(oe));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(w.keys()).find(oe=>oe.toLowerCase()=="content-type"),ee=d.FormData&&f instanceof d.FormData,!(Array.prototype.indexOf.call(Gl,b,void 0)>=0)||U||ee||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[oe,Ce]of w)this.g.setRequestHeader(oe,Ce);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(oe){Ui(this,oe)}};function Ui(f,b){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=b,f.o=5,ql(f),ua(f)}function ql(f){f.A||(f.A=!0,re(f,"complete"),re(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,re(this,"complete"),re(this,"abort"),ua(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ua(this,!0)),Ut.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Pi(this):this.Xa())},n.Xa=function(){Pi(this)};function Pi(f){if(f.h&&typeof l<"u"){if(f.v&&gr(f)==4)setTimeout(f.Ca.bind(f),0);else if(re(f,"readystatechange"),gr(f)==4){f.h=!1;try{const oe=f.ca();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var w;if(!(w=b)){var U;if(U=oe===0){let Ce=String(f.D).match(ji)[1]||null;!Ce&&d.self&&d.self.location&&(Ce=d.self.location.protocol.slice(0,-1)),U=!Dr.test(Ce?Ce.toLowerCase():"")}w=U}if(w)re(f,"complete"),re(f,"success");else{f.o=6;try{var ee=gr(f)>2?f.g.statusText:""}catch{ee=""}f.l=ee+" ["+f.ca()+"]",ql(f)}}finally{ua(f)}}}}function ua(f,b){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const w=f.g;f.g=null,b||re(f,"ready");try{w.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function gr(f){return f.g?f.g.readyState:0}n.ca=function(){try{return gr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(f){if(this.g){var b=this.g.responseText;return f&&b.indexOf(f)==0&&(b=b.substring(f.length)),fr(b)}};function Gn(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function da(f){const b={};f=(f.g&&gr(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<f.length;U++){if(O(f[U]))continue;var w=Rs(f[U]);const ee=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const oe=b[ee]||[];b[ee]=oe,oe.push(w)}Y(b,function(U){return U.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ur(f,b,w){return w&&w.internalChannelParams&&w.internalChannelParams[f]||b}function Ua(f){this.za=0,this.i=[],this.j=new rn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ur("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ur("baseRetryDelayMs",5e3,f),this.Za=Ur("retryDelaySeedMs",1e4,f),this.Ta=Ur("forwardChannelMaxRetries",2,f),this.va=Ur("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new Ii(f&&f.concurrentRequestLimit),this.Ba=new cn,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Ua.prototype,n.ka=8,n.I=1,n.connect=function(f,b,w,U){Je(0),this.W=f,this.H=b||{},w&&U!==void 0&&(this.H.OSID=w,this.H.OAID=U),this.F=this.X,this.J=Cu(this,null,this.W),Pr(this)};function $l(f){if(Ro(f),f.I==3){var b=f.V++,w=ln(f.J);if(Rt(w,"SID",f.M),Rt(w,"RID",b),Rt(w,"TYPE","terminate"),Vi(f,w),b=new mn(f,f.j,b),b.M=2,b.A=ia(ln(w)),w=!1,d.navigator&&d.navigator.sendBeacon)try{w=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!w&&d.Image&&(new Image().src=b.A,w=!0),w||(b.g=Ru(b.j,null),b.g.ea(b.A)),b.F=Date.now(),Os(b)}Nu(f)}function Pa(f){f.g&&(Ql(f),f.g.cancel(),f.g=null)}function Ro(f){Pa(f),f.v&&(d.clearTimeout(f.v),f.v=null),jo(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&d.clearTimeout(f.m),f.m=null)}function Pr(f){if(!Ni(f.h)&&!f.m){f.m=!0;var b=f.Ea;W||T(),Q||(W(),Q=!0),I.add(b,f),f.D=0}}function Oo(f,b){return Ys(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=b.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=gt(y(f.Ea,f,b),Iu(f,f.D)),f.D++,!0)}n.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const ee=new mn(this,this.j,f);let oe=this.o;if(this.U&&(oe?(oe=A(oe),q(oe,this.U)):oe=this.U),this.u!==null||this.R||(ee.J=oe,oe=null),this.S)e:{for(var b=0,w=0;w<this.i.length;w++){t:{var U=this.i[w];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(b+=U,b>4096){b=w;break e}if(b===4096||w===this.i.length-1){b=w+1;break e}}b=1e3}else b=1e3;b=wu(this,ee,b),w=ln(this.J),Rt(w,"RID",f),Rt(w,"CVER",22),this.G&&Rt(w,"X-HTTP-Session-Id",this.G),Vi(this,w),oe&&(this.R?b="headers="+pr(Zs(oe))+"&"+b:this.u&&Di(w,this.u,oe)),Ci(this.h,ee),this.Ra&&Rt(w,"TYPE","init"),this.S?(Rt(w,"$req",b),Rt(w,"SID","null"),ee.U=!0,Gs(ee,w,null)):Gs(ee,w,b),this.I=2}}else this.I==3&&(f?Yl(this,f):this.i.length==0||Ni(this.h)||Yl(this))};function Yl(f,b){var w;b?w=b.l:w=f.V++;const U=ln(f.J);Rt(U,"SID",f.M),Rt(U,"RID",w),Rt(U,"AID",f.K),Vi(f,U),f.u&&f.o&&Di(U,f.u,f.o),w=new mn(f,f.j,w,f.D+1),f.u===null&&(w.J=f.o),b&&(f.i=b.G.concat(f.i)),b=wu(f,w,1e3),w.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),Ci(f.h,w),Gs(w,U,b)}function Vi(f,b){f.H&&Z(f.H,function(w,U){Rt(b,U,w)}),f.l&&Z({},function(w,U){Rt(b,U,w)})}function wu(f,b,w){w=Math.min(f.i.length,w);const U=f.l?y(f.l.Ka,f.l,f):null;e:{var ee=f.i;let ot=-1;for(;;){const gn=["count="+w];ot==-1?w>0?(ot=ee[0].g,gn.push("ofs="+ot)):ot=0:gn.push("ofs="+ot);let Ot=!0;for(let Kt=0;Kt<w;Kt++){var oe=ee[Kt].g;const Xs=ee[Kt].map;if(oe-=ot,oe<0)ot=Math.max(0,ee[Kt].g-100),Ot=!1;else try{oe="req"+oe+"_"||"";try{var Ce=Xs instanceof Map?Xs:Object.entries(Xs);for(const[zr,yr]of Ce){let xr=yr;p(yr)&&(xr=Ht(yr)),gn.push(oe+zr+"="+encodeURIComponent(xr))}}catch(zr){throw gn.push(oe+"type="+encodeURIComponent("_badmap")),zr}}catch{U&&U(Xs)}}if(Ot){Ce=gn.join("&");break e}}Ce=void 0}return f=f.i.splice(0,w),b.G=f,Ce}function Su(f){if(!f.g&&!f.v){f.Y=1;var b=f.Da;W||T(),Q||(W(),Q=!0),I.add(b,f),f.A=0}}function zi(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=gt(y(f.Da,f),Iu(f,f.A)),f.A++,!0)}n.Da=function(){if(this.v=null,Tu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=gt(y(this.Wa,this),f)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Je(10),Pa(this),Tu(this))};function Ql(f){f.B!=null&&(d.clearTimeout(f.B),f.B=null)}function Tu(f){f.g=new mn(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var b=ln(f.na);Rt(b,"RID","rpc"),Rt(b,"SID",f.M),Rt(b,"AID",f.K),Rt(b,"CI",f.F?"0":"1"),!f.F&&f.ia&&Rt(b,"TO",f.ia),Rt(b,"TYPE","xmlhttp"),Vi(f,b),f.u&&f.o&&Di(b,f.u,f.o),f.O&&(f.g.H=f.O);var w=f.g;f=f.ba,w.M=1,w.A=ia(ln(b)),w.u=null,w.R=!0,ra(w,f)}n.Va=function(){this.C!=null&&(this.C=null,Pa(this),zi(this),Je(19))};function jo(f){f.C!=null&&(d.clearTimeout(f.C),f.C=null)}function Au(f,b){var w=null;if(f.g==b){jo(f),Ql(f),f.g=null;var U=2}else if(Qs(f.h,b))w=b.G,Ri(f.h,b),U=1;else return;if(f.I!=0){if(b.o)if(U==1){w=b.u?b.u.length:0,b=Date.now()-b.F;var ee=f.D;U=it(),re(U,new Qt(U,w)),Pr(f)}else Su(f);else if(ee=b.m,ee==3||ee==0&&b.X>0||!(U==1&&Oo(f,b)||U==2&&zi(f)))switch(w&&w.length>0&&(b=f.h,b.i=b.i.concat(w)),ee){case 1:Vr(f,5);break;case 4:Vr(f,10);break;case 3:Vr(f,6);break;default:Vr(f,2)}}}function Iu(f,b){let w=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(w*=2),w*b}function Vr(f,b){if(f.j.info("Error code "+b),b==2){var w=y(f.bb,f),U=f.Ua;const ee=!U;U=new ls(U||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||En(U,"https"),ia(U),ee?kt(U.toString(),w):On(U.toString(),w)}else Je(2);f.I=0,f.l&&f.l.pa(b),Nu(f),Ro(f)}n.bb=function(f){f?(this.j.info("Successfully pinged google.com"),Je(2)):(this.j.info("Failed to ping google.com"),Je(1))};function Nu(f){if(f.I=0,f.ja=[],f.l){const b=Oi(f.h);(b.length!=0||f.i.length!=0)&&(z(f.ja,b),z(f.ja,f.i),f.h.i.length=0,N(f.i),f.i.length=0),f.l.oa()}}function Cu(f,b,w){var U=w instanceof ls?ln(w):new ls(w);if(U.g!="")b&&(U.g=b+"."+U.g),Mr(U,U.u);else{var ee=d.location;U=ee.protocol,b=b?b+"."+ee.hostname:ee.hostname,ee=+ee.port;const oe=new ls(null);U&&En(oe,U),b&&(oe.g=b),ee&&Mr(oe,ee),w&&(oe.h=w),U=oe}return w=f.G,b=f.wa,w&&b&&Rt(U,w,b),Rt(U,"VER",f.ka),Vi(f,U),U}function Ru(f,b,w){if(b&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=f.Aa&&!f.ma?new Ut(new Un({ab:w})):new Ut(f.ma),b.Fa(f.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ou(){}n=Ou.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Va(){}Va.prototype.g=function(f,b){return new us(f,b)};function us(f,b){Xe.call(this),this.g=new Ua(b),this.l=f,this.h=b&&b.messageUrlParams||null,f=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(f?f["X-WebChannel-Content-Type"]=b.messageContentType:f={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(f?f["X-WebChannel-Client-Profile"]=b.sa:f={"X-WebChannel-Client-Profile":b.sa}),this.g.U=f,(f=b&&b.Qb)&&!O(f)&&(this.g.u=f),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!O(b)&&(this.g.G=b,f=this.h,f!==null&&b in f&&(f=this.h,b in f&&delete f[b])),this.j=new fa(this)}v(us,Xe),us.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},us.prototype.close=function(){$l(this.g)},us.prototype.o=function(f){var b=this.g;if(typeof f=="string"){var w={};w.__data__=f,f=w}else this.v&&(w={},w.__data__=Ht(f),f=w);b.i.push(new on(b.Ya++,f)),b.I==3&&Pr(b)},us.prototype.N=function(){this.g.l=null,delete this.j,$l(this.g),delete this.g,us.Z.N.call(this)};function ju(f){be.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var b=f.__sm__;if(b){e:{for(const w in b){f=w;break e}f=void 0}(this.i=f)&&(f=this.i,b=b!==null&&f in b?b[f]:void 0),this.data=b}else this.data=f}v(ju,be);function ku(){De.call(this),this.status=1}v(ku,De);function fa(f){this.g=f}v(fa,Ou),fa.prototype.ra=function(){re(this.g,"a")},fa.prototype.qa=function(f){re(this.g,new ju(f))},fa.prototype.pa=function(f){re(this.g,new ku)},fa.prototype.oa=function(){re(this.g,"b")},Va.prototype.createWebChannel=Va.prototype.g,us.prototype.send=us.prototype.o,us.prototype.open=us.prototype.m,us.prototype.close=us.prototype.close,gS=function(){return new Va},mS=function(){return it()},pS=Ne,Zm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Hs.NO_ERROR=0,Hs.TIMEOUT=8,Hs.HTTP_ERROR=6,Jd=Hs,na.COMPLETE="complete",hS=na,ys.EventType=pn,pn.OPEN="a",pn.CLOSE="b",pn.ERROR="c",pn.MESSAGE="d",Xe.prototype.listen=Xe.prototype.J,Dc=ys,Ut.prototype.listenOnce=Ut.prototype.K,Ut.prototype.getLastError=Ut.prototype.Ha,Ut.prototype.getLastErrorCode=Ut.prototype.ya,Ut.prototype.getStatus=Ut.prototype.ca,Ut.prototype.getResponseJson=Ut.prototype.La,Ut.prototype.getResponseText=Ut.prototype.la,Ut.prototype.send=Ut.prototype.ea,Ut.prototype.setWithCredentials=Ut.prototype.Fa,fS=Ut}).apply(typeof Pd<"u"?Pd:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ss.UNAUTHENTICATED=new ss(null),ss.GOOGLE_CREDENTIALS=new ss("google-credentials-uid"),ss.FIRST_PARTY=new ss("first-party-uid"),ss.MOCK_USER=new ss("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vl="12.9.0";function mR(n){Vl=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo=new aS("@firebase/firestore");function fl(){return wo.logLevel}function Me(n,...e){if(wo.logLevel<=_t.DEBUG){const s=e.map(t0);wo.debug(`Firestore (${Vl}): ${n}`,...s)}}function La(n,...e){if(wo.logLevel<=_t.ERROR){const s=e.map(t0);wo.error(`Firestore (${Vl}): ${n}`,...s)}}function So(n,...e){if(wo.logLevel<=_t.WARN){const s=e.map(t0);wo.warn(`Firestore (${Vl}): ${n}`,...s)}}function t0(n){if(typeof n=="string")return n;try{return(function(s){return JSON.stringify(s)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function at(n,e,s){let a="Unexpected state";typeof e=="string"?a=e:s=e,yS(n,a,s)}function yS(n,e,s){let a=`FIRESTORE (${Vl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(s!==void 0)try{a+=" CONTEXT: "+JSON.stringify(s)}catch{a+=" CONTEXT: "+s}throw La(a),new Error(a)}function tn(n,e,s,a){let o="Unexpected state";typeof s=="string"?o=s:a=s,n||yS(e,o,a)}function Et(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class He extends Pl{constructor(e,s){super(e,s),this.code=e,this.message=s,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(){this.promise=new Promise(((e,s)=>{this.resolve=e,this.reject=s}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,s){this.user=s,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,s){e.enqueueRetryable((()=>s(ss.UNAUTHENTICATED)))}shutdown(){}}class yR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,s){this.changeListener=s,e.enqueueRetryable((()=>s(this.token.user)))}shutdown(){this.changeListener=null}}class xR{constructor(e){this.t=e,this.currentUser=ss.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,s){tn(this.o===void 0,42304);let a=this.i;const o=m=>this.i!==a?(a=this.i,s(m)):Promise.resolve();let l=new fo;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new fo,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await o(this.currentUser)}))},p=m=>{Me("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>p(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?p(m):(Me("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new fo)}}),0),d()}getToken(){const e=this.i,s=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(s).then((a=>this.i!==e?(Me("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(tn(typeof a.accessToken=="string",31837,{l:a}),new xS(a.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return tn(e===null||typeof e=="string",2055,{h:e}),new ss(e)}}class bR{constructor(e,s,a){this.P=e,this.T=s,this.I=a,this.type="FirstParty",this.user=ss.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class vR{constructor(e,s,a){this.P=e,this.T=s,this.I=a}getToken(){return Promise.resolve(new bR(this.P,this.T,this.I))}start(e,s){e.enqueueRetryable((()=>s(ss.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Dv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class _R{constructor(e,s){this.V=s,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,XC(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,s){tn(this.o===void 0,3512);const a=l=>{l.error!=null&&Me("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,Me("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?s(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>a(l)))};const o=l=>{Me("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>o(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?o(l):Me("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Dv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((s=>s?(tn(typeof s.token=="string",44558,{tokenResult:s}),this.m=s.token,new Dv(s.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),s=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(s);else for(let a=0;a<n;a++)s[a]=Math.floor(256*Math.random());return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const o=ER(40);for(let l=0;l<o.length;++l)a.length<20&&o[l]<s&&(a+=e.charAt(o[l]%62))}return a}}function xt(n,e){return n<e?-1:n>e?1:0}function Xm(n,e){const s=Math.min(n.length,e.length);for(let a=0;a<s;a++){const o=n.charAt(a),l=e.charAt(a);if(o!==l)return tm(o)===tm(l)?xt(o,l):tm(o)?1:-1}return xt(n.length,e.length)}const wR=55296,SR=57343;function tm(n){const e=n.charCodeAt(0);return e>=wR&&e<=SR}function jl(n,e,s){return n.length===e.length&&n.every(((a,o)=>s(a,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uv="__name__";class $r{constructor(e,s,a){s===void 0?s=0:s>e.length&&at(637,{offset:s,range:e.length}),a===void 0?a=e.length-s:a>e.length-s&&at(1746,{length:a,range:e.length-s}),this.segments=e,this.offset=s,this.len=a}get length(){return this.len}isEqual(e){return $r.comparator(this,e)===0}child(e){const s=this.segments.slice(this.offset,this.limit());return e instanceof $r?e.forEach((a=>{s.push(a)})):s.push(e),this.construct(s)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}forEach(e){for(let s=this.offset,a=this.limit();s<a;s++)e(this.segments[s])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,s){const a=Math.min(e.length,s.length);for(let o=0;o<a;o++){const l=$r.compareSegments(e.get(o),s.get(o));if(l!==0)return l}return xt(e.length,s.length)}static compareSegments(e,s){const a=$r.isNumericId(e),o=$r.isNumericId(s);return a&&!o?-1:!a&&o?1:a&&o?$r.extractNumericId(e).compare($r.extractNumericId(s)):Xm(e,s)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return pi.fromString(e.substring(4,e.length-2))}}class en extends $r{construct(e,s,a){return new en(e,s,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const s=[];for(const a of e){if(a.indexOf("//")>=0)throw new He(Re.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);s.push(...a.split("/").filter((o=>o.length>0)))}return new en(s)}static emptyPath(){return new en([])}}const TR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hs extends $r{construct(e,s,a){return new hs(e,s,a)}static isValidIdentifier(e){return TR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Uv}static keyField(){return new hs([Uv])}static fromServerFormat(e){const s=[];let a="",o=0;const l=()=>{if(a.length===0)throw new He(Re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);s.push(a),a=""};let d=!1;for(;o<e.length;){const p=e[o];if(p==="\\"){if(o+1===e.length)throw new He(Re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[o+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new He(Re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=m,o+=2}else p==="`"?(d=!d,o++):p!=="."||d?(a+=p,o++):(l(),o++)}if(l(),d)throw new He(Re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new hs(s)}static emptyPath(){return new hs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.path=e}static fromPath(e){return new Ke(en.fromString(e))}static fromName(e){return new Ke(en.fromString(e).popFirst(5))}static empty(){return new Ke(en.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&en.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,s){return en.comparator(e.path,s.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ke(new en(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AR(n,e,s){if(!s)throw new He(Re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function IR(n,e,s,a){if(e===!0&&a===!0)throw new He(Re.INVALID_ARGUMENT,`${n} and ${s} cannot be used together.`)}function Pv(n){if(!Ke.isDocumentKey(n))throw new He(Re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function NR(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function CR(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(a){return a.constructor?a.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":at(12329,{type:typeof n})}function Jm(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new He(Re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const s=CR(n);throw new He(Re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${s}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cn(n,e){const s={typeString:n};return e&&(s.value=e),s}function gu(n,e){if(!NR(n))throw new He(Re.INVALID_ARGUMENT,"JSON must be an object");let s;for(const a in e)if(e[a]){const o=e[a].typeString,l="value"in e[a]?{value:e[a].value}:void 0;if(!(a in n)){s=`JSON missing required field: '${a}'`;break}const d=n[a];if(o&&typeof d!==o){s=`JSON field '${a}' must be a ${o}.`;break}if(l!==void 0&&d!==l.value){s=`Expected '${a}' field to equal '${l.value}'`;break}}if(s)throw new He(Re.INVALID_ARGUMENT,s);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv=-62135596800,zv=1e6;class Nn{static now(){return Nn.fromMillis(Date.now())}static fromDate(e){return Nn.fromMillis(e.getTime())}static fromMillis(e){const s=Math.floor(e/1e3),a=Math.floor((e-1e3*s)*zv);return new Nn(s,a)}constructor(e,s){if(this.seconds=e,this.nanoseconds=s,s<0)throw new He(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(s>=1e9)throw new He(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(e<Vv)throw new He(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new He(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/zv}_compareTo(e){return this.seconds===e.seconds?xt(this.nanoseconds,e.nanoseconds):xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Nn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(gu(e,Nn._jsonSchema))return new Nn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Vv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Nn._jsonSchemaVersion="firestore/timestamp/1.0",Nn._jsonSchema={type:Cn("string",Nn._jsonSchemaVersion),seconds:Cn("number"),nanoseconds:Cn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{static fromTimestamp(e){return new st(e)}static min(){return new st(new Nn(0,0))}static max(){return new st(new Nn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iu=-1;function RR(n,e){const s=n.toTimestamp().seconds,a=n.toTimestamp().nanoseconds+1,o=st.fromTimestamp(a===1e9?new Nn(s+1,0):new Nn(s,a));return new bi(o,Ke.empty(),e)}function OR(n){return new bi(n.readTime,n.key,iu)}class bi{constructor(e,s,a){this.readTime=e,this.documentKey=s,this.largestBatchId=a}static min(){return new bi(st.min(),Ke.empty(),iu)}static max(){return new bi(st.max(),Ke.empty(),iu)}}function jR(n,e){let s=n.readTime.compareTo(e.readTime);return s!==0?s:(s=Ke.comparator(n.documentKey,e.documentKey),s!==0?s:xt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class LR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rf(n){if(n.code!==Re.FAILED_PRECONDITION||n.message!==kR)throw n;Me("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((s=>{this.isDone=!0,this.result=s,this.nextCallback&&this.nextCallback(s)}),(s=>{this.isDone=!0,this.error=s,this.catchCallback&&this.catchCallback(s)}))}catch(e){return this.next(void 0,e)}next(e,s){return this.callbackAttached&&at(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(s,this.error):this.wrapSuccess(e,this.result):new we(((a,o)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(a,o)},this.catchCallback=l=>{this.wrapFailure(s,l).next(a,o)}}))}toPromise(){return new Promise(((e,s)=>{this.next(e,s)}))}wrapUserFunction(e){try{const s=e();return s instanceof we?s:we.resolve(s)}catch(s){return we.reject(s)}}wrapSuccess(e,s){return e?this.wrapUserFunction((()=>e(s))):we.resolve(s)}wrapFailure(e,s){return e?this.wrapUserFunction((()=>e(s))):we.reject(s)}static resolve(e){return new we(((s,a)=>{s(e)}))}static reject(e){return new we(((s,a)=>{a(e)}))}static waitFor(e){return new we(((s,a)=>{let o=0,l=0,d=!1;e.forEach((p=>{++o,p.next((()=>{++l,d&&l===o&&s()}),(m=>a(m)))})),d=!0,l===o&&s()}))}static or(e){let s=we.resolve(!1);for(const a of e)s=s.next((o=>o?we.resolve(o):a()));return s}static forEach(e,s){const a=[];return e.forEach(((o,l)=>{a.push(s.call(this,o,l))})),this.waitFor(a)}static mapArray(e,s){return new we(((a,o)=>{const l=e.length,d=new Array(l);let p=0;for(let m=0;m<l;m++){const y=m;s(e[y]).next((x=>{d[y]=x,++p,p===l&&a(d)}),(x=>o(x)))}}))}static doWhile(e,s){return new we(((a,o)=>{const l=()=>{e()===!0?s().next((()=>{l()}),o):a()};l()}))}}function MR(n){const e=n.match(/Android ([\d.]+)/i),s=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(s)}function zl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Of{constructor(e,s){this.previousValue=e,s&&(s.sequenceNumberHandler=a=>this.ae(a),this.ue=a=>s.writeSequenceNumber(a))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Of.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR=-1;function jf(n){return n==null}function eg(n){return n===0&&1/n==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS="";function UR(n){let e="";for(let s=0;s<n.length;s++)e.length>0&&(e=Bv(e)),e=PR(n.get(s),e);return Bv(e)}function PR(n,e){let s=e;const a=n.length;for(let o=0;o<a;o++){const l=n.charAt(o);switch(l){case"\0":s+="";break;case bS:s+="";break;default:s+=l}}return s}function Bv(n){return n+bS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fv(n){let e=0;for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&e++;return e}function yu(n,e){for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&e(s,n[s])}function VR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn{constructor(e,s){this.comparator=e,this.root=s||Wn.EMPTY}insert(e,s){return new vn(this.comparator,this.root.insert(e,s,this.comparator).copy(null,null,Wn.BLACK,null,null))}remove(e){return new vn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wn.BLACK,null,null))}get(e){let s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return s.value;a<0?s=s.left:a>0&&(s=s.right)}return null}indexOf(e){let s=0,a=this.root;for(;!a.isEmpty();){const o=this.comparator(e,a.key);if(o===0)return s+a.left.size;o<0?a=a.left:(s+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((s,a)=>(e(s,a),!1)))}toString(){const e=[];return this.inorderTraversal(((s,a)=>(e.push(`${s}:${a}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vd(this.root,e,this.comparator,!0)}}class Vd{constructor(e,s,a,o){this.isReverse=o,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=s?a(e.key,s):1,s&&o&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const s={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return s}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Wn{constructor(e,s,a,o,l){this.key=e,this.value=s,this.color=a??Wn.RED,this.left=o??Wn.EMPTY,this.right=l??Wn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,s,a,o,l){return new Wn(e??this.key,s??this.value,a??this.color,o??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,s,a){let o=this;const l=a(e,o.key);return o=l<0?o.copy(null,null,null,o.left.insert(e,s,a),null):l===0?o.copy(null,s,null,null,null):o.copy(null,null,null,null,o.right.insert(e,s,a)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Wn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,s){let a,o=this;if(s(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,s),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),s(e,o.key)===0){if(o.right.isEmpty())return Wn.EMPTY;a=o.right.min(),o=o.copy(a.key,a.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,s))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Wn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Wn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,s)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw at(43730,{key:this.key,value:this.value});if(this.right.isRed())throw at(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw at(27949);return e+(this.isRed()?0:1)}}Wn.EMPTY=null,Wn.RED=!0,Wn.BLACK=!1;Wn.EMPTY=new class{constructor(){this.size=0}get key(){throw at(57766)}get value(){throw at(16141)}get color(){throw at(16727)}get left(){throw at(29726)}get right(){throw at(36894)}copy(e,s,a,o,l){return this}insert(e,s,a){return new Wn(e,s)}remove(e,s){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.comparator=e,this.data=new vn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((s,a)=>(e(s),!1)))}forEachInRange(e,s){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const o=a.getNext();if(this.comparator(o.key,e[1])>=0)return;s(o.key)}}forEachWhile(e,s){let a;for(a=s!==void 0?this.data.getIteratorFrom(s):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const s=this.data.getIteratorFrom(e);return s.hasNext()?s.getNext().key:null}getIterator(){return new Hv(this.data.getIterator())}getIteratorFrom(e){return new Hv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let s=this;return s.size<e.size&&(s=e,e=this),e.forEach((a=>{s=s.add(a)})),s}isEqual(e){if(!(e instanceof Mn)||this.size!==e.size)return!1;const s=this.data.getIterator(),a=e.data.getIterator();for(;s.hasNext();){const o=s.getNext().key,l=a.getNext().key;if(this.comparator(o,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((s=>{e.push(s)})),e}toString(){const e=[];return this.forEach((s=>e.push(s))),"SortedSet("+e.toString()+")"}copy(e){const s=new Mn(this.comparator);return s.data=e,s}}class Hv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e){this.fields=e,e.sort(hs.comparator)}static empty(){return new li([])}unionWith(e){let s=new Mn(hs.comparator);for(const a of this.fields)s=s.add(a);for(const a of e)s=s.add(a);return new li(s.toArray())}covers(e){for(const s of this.fields)if(s.isPrefixOf(e))return!0;return!1}isEqual(e){return jl(this.fields,e.fields,((s,a)=>s.isEqual(a)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e){this.binaryString=e}static fromBase64String(e){const s=(function(o){try{return atob(o)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new vS("Invalid base64 string: "+l):l}})(e);return new Kn(s)}static fromUint8Array(e){const s=(function(o){let l="";for(let d=0;d<o.length;++d)l+=String.fromCharCode(o[d]);return l})(e);return new Kn(s)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(s){return btoa(s)})(this.binaryString)}toUint8Array(){return(function(s){const a=new Uint8Array(s.length);for(let o=0;o<s.length;o++)a[o]=s.charCodeAt(o);return a})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Kn.EMPTY_BYTE_STRING=new Kn("");const zR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vi(n){if(tn(!!n,39018),typeof n=="string"){let e=0;const s=zR.exec(n);if(tn(!!s,46558,{timestamp:n}),s[1]){let o=s[1];o=(o+"000000000").substr(0,9),e=Number(o)}const a=new Date(n);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:bn(n.seconds),nanos:bn(n.nanos)}}function bn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function _i(n){return typeof n=="string"?Kn.fromBase64String(n):Kn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S="server_timestamp",ES="__type__",wS="__previous_value__",SS="__local_write_time__";function s0(n){var s,a;return((a=(((s=n==null?void 0:n.mapValue)==null?void 0:s.fields)||{})[ES])==null?void 0:a.stringValue)===_S}function kf(n){const e=n.mapValue.fields[wS];return s0(e)?kf(e):e}function ou(n){const e=vi(n.mapValue.fields[SS].timestampValue);return new Nn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,s,a,o,l,d,p,m,y,x,v){this.databaseId=e,this.appId=s,this.persistenceKey=a,this.host=o,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=m,this.useFetchStreams=y,this.isUsingEmulator=x,this.apiKey=v}}const hf="(default)";class lu{constructor(e,s){this.projectId=e,this.database=s||hf}static empty(){return new lu("","")}get isDefaultDatabase(){return this.database===hf}isEqual(e){return e instanceof lu&&e.projectId===this.projectId&&e.database===this.database}}function FR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new He(Re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new lu(n.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HR="__type__",GR="__max__",zd={mapValue:{}},qR="__vector__",tg="value";function Ei(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?s0(n)?4:YR(n)?9007199254740991:$R(n)?10:11:at(28295,{value:n})}function Xr(n,e){if(n===e)return!0;const s=Ei(n);if(s!==Ei(e))return!1;switch(s){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ou(n).isEqual(ou(e));case 3:return(function(o,l){if(typeof o.timestampValue=="string"&&typeof l.timestampValue=="string"&&o.timestampValue.length===l.timestampValue.length)return o.timestampValue===l.timestampValue;const d=vi(o.timestampValue),p=vi(l.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,l){return _i(o.bytesValue).isEqual(_i(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,l){return bn(o.geoPointValue.latitude)===bn(l.geoPointValue.latitude)&&bn(o.geoPointValue.longitude)===bn(l.geoPointValue.longitude)})(n,e);case 2:return(function(o,l){if("integerValue"in o&&"integerValue"in l)return bn(o.integerValue)===bn(l.integerValue);if("doubleValue"in o&&"doubleValue"in l){const d=bn(o.doubleValue),p=bn(l.doubleValue);return d===p?eg(d)===eg(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return jl(n.arrayValue.values||[],e.arrayValue.values||[],Xr);case 10:case 11:return(function(o,l){const d=o.mapValue.fields||{},p=l.mapValue.fields||{};if(Fv(d)!==Fv(p))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(p[m]===void 0||!Xr(d[m],p[m])))return!1;return!0})(n,e);default:return at(52216,{left:n})}}function cu(n,e){return(n.values||[]).find((s=>Xr(s,e)))!==void 0}function kl(n,e){if(n===e)return 0;const s=Ei(n),a=Ei(e);if(s!==a)return xt(s,a);switch(s){case 0:case 9007199254740991:return 0;case 1:return xt(n.booleanValue,e.booleanValue);case 2:return(function(l,d){const p=bn(l.integerValue||l.doubleValue),m=bn(d.integerValue||d.doubleValue);return p<m?-1:p>m?1:p===m?0:isNaN(p)?isNaN(m)?0:-1:1})(n,e);case 3:return Gv(n.timestampValue,e.timestampValue);case 4:return Gv(ou(n),ou(e));case 5:return Xm(n.stringValue,e.stringValue);case 6:return(function(l,d){const p=_i(l),m=_i(d);return p.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(l,d){const p=l.split("/"),m=d.split("/");for(let y=0;y<p.length&&y<m.length;y++){const x=xt(p[y],m[y]);if(x!==0)return x}return xt(p.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,d){const p=xt(bn(l.latitude),bn(d.latitude));return p!==0?p:xt(bn(l.longitude),bn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return qv(n.arrayValue,e.arrayValue);case 10:return(function(l,d){var S,N,z,D;const p=l.fields||{},m=d.fields||{},y=(S=p[tg])==null?void 0:S.arrayValue,x=(N=m[tg])==null?void 0:N.arrayValue,v=xt(((z=y==null?void 0:y.values)==null?void 0:z.length)||0,((D=x==null?void 0:x.values)==null?void 0:D.length)||0);return v!==0?v:qv(y,x)})(n.mapValue,e.mapValue);case 11:return(function(l,d){if(l===zd.mapValue&&d===zd.mapValue)return 0;if(l===zd.mapValue)return 1;if(d===zd.mapValue)return-1;const p=l.fields||{},m=Object.keys(p),y=d.fields||{},x=Object.keys(y);m.sort(),x.sort();for(let v=0;v<m.length&&v<x.length;++v){const S=Xm(m[v],x[v]);if(S!==0)return S;const N=kl(p[m[v]],y[x[v]]);if(N!==0)return N}return xt(m.length,x.length)})(n.mapValue,e.mapValue);default:throw at(23264,{he:s})}}function Gv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return xt(n,e);const s=vi(n),a=vi(e),o=xt(s.seconds,a.seconds);return o!==0?o:xt(s.nanos,a.nanos)}function qv(n,e){const s=n.values||[],a=e.values||[];for(let o=0;o<s.length&&o<a.length;++o){const l=kl(s[o],a[o]);if(l)return l}return xt(s.length,a.length)}function Ll(n){return ng(n)}function ng(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(s){const a=vi(s);return`time(${a.seconds},${a.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(s){return _i(s).toBase64()})(n.bytesValue):"referenceValue"in n?(function(s){return Ke.fromName(s).toString()})(n.referenceValue):"geoPointValue"in n?(function(s){return`geo(${s.latitude},${s.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(s){let a="[",o=!0;for(const l of s.values||[])o?o=!1:a+=",",a+=ng(l);return a+"]"})(n.arrayValue):"mapValue"in n?(function(s){const a=Object.keys(s.fields||{}).sort();let o="{",l=!0;for(const d of a)l?l=!1:o+=",",o+=`${d}:${ng(s.fields[d])}`;return o+"}"})(n.mapValue):at(61005,{value:n})}function ef(n){switch(Ei(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=kf(n);return e?16+ef(e):16;case 5:return 2*n.stringValue.length;case 6:return _i(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(a){return(a.values||[]).reduce(((o,l)=>o+ef(l)),0)})(n.arrayValue);case 10:case 11:return(function(a){let o=0;return yu(a.fields,((l,d)=>{o+=l.length+ef(d)})),o})(n.mapValue);default:throw at(13486,{value:n})}}function sg(n){return!!n&&"integerValue"in n}function r0(n){return!!n&&"arrayValue"in n}function $v(n){return!!n&&"nullValue"in n}function Yv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function nm(n){return!!n&&"mapValue"in n}function $R(n){var s,a;return((a=(((s=n==null?void 0:n.mapValue)==null?void 0:s.fields)||{})[HR])==null?void 0:a.stringValue)===qR}function Kc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return yu(n.mapValue.fields,((s,a)=>e.mapValue.fields[s]=Kc(a))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let s=0;s<(n.arrayValue.values||[]).length;++s)e.arrayValue.values[s]=Kc(n.arrayValue.values[s]);return e}return{...n}}function YR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===GR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qr{constructor(e){this.value=e}static empty(){return new Qr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let s=this.value;for(let a=0;a<e.length-1;++a)if(s=(s.mapValue.fields||{})[e.get(a)],!nm(s))return null;return s=(s.mapValue.fields||{})[e.lastSegment()],s||null}}set(e,s){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kc(s)}setAll(e){let s=hs.emptyPath(),a={},o=[];e.forEach(((d,p)=>{if(!s.isImmediateParentOf(p)){const m=this.getFieldsMap(s);this.applyChanges(m,a,o),a={},o=[],s=p.popLast()}d?a[p.lastSegment()]=Kc(d):o.push(p.lastSegment())}));const l=this.getFieldsMap(s);this.applyChanges(l,a,o)}delete(e){const s=this.field(e.popLast());nm(s)&&s.mapValue.fields&&delete s.mapValue.fields[e.lastSegment()]}isEqual(e){return Xr(this.value,e.value)}getFieldsMap(e){let s=this.value;s.mapValue.fields||(s.mapValue={fields:{}});for(let a=0;a<e.length;++a){let o=s.mapValue.fields[e.get(a)];nm(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},s.mapValue.fields[e.get(a)]=o),s=o}return s.mapValue.fields}applyChanges(e,s,a){yu(s,((o,l)=>e[o]=l));for(const o of a)delete e[o]}clone(){return new Qr(Kc(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e,s,a,o,l,d,p){this.key=e,this.documentType=s,this.version=a,this.readTime=o,this.createTime=l,this.data=d,this.documentState=p}static newInvalidDocument(e){return new rs(e,0,st.min(),st.min(),st.min(),Qr.empty(),0)}static newFoundDocument(e,s,a,o){return new rs(e,1,s,st.min(),a,o,0)}static newNoDocument(e,s){return new rs(e,2,s,st.min(),st.min(),Qr.empty(),0)}static newUnknownDocument(e,s){return new rs(e,3,s,st.min(),st.min(),Qr.empty(),2)}convertToFoundDocument(e,s){return!this.createTime.isEqual(st.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=s,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=st.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof rs&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rs(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,s){this.position=e,this.inclusive=s}}function Qv(n,e,s){let a=0;for(let o=0;o<n.position.length;o++){const l=e[o],d=n.position[o];if(l.field.isKeyField()?a=Ke.comparator(Ke.fromName(d.referenceValue),s.key):a=kl(d,s.data.field(l.field)),l.dir==="desc"&&(a*=-1),a!==0)break}return a}function Wv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let s=0;s<n.position.length;s++)if(!Xr(n.position[s],e.position[s]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,s="asc"){this.field=e,this.dir=s}}function QR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{}class kn extends TS{constructor(e,s,a){super(),this.field=e,this.op=s,this.value=a}static create(e,s,a){return e.isKeyField()?s==="in"||s==="not-in"?this.createKeyFieldInFilter(e,s,a):new KR(e,s,a):s==="array-contains"?new JR(e,a):s==="in"?new eO(e,a):s==="not-in"?new tO(e,a):s==="array-contains-any"?new nO(e,a):new kn(e,s,a)}static createKeyFieldInFilter(e,s,a){return s==="in"?new ZR(e,a):new XR(e,a)}matches(e){const s=e.data.field(this.field);return this.op==="!="?s!==null&&s.nullValue===void 0&&this.matchesComparison(kl(s,this.value)):s!==null&&Ei(this.value)===Ei(s)&&this.matchesComparison(kl(s,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return at(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Jr extends TS{constructor(e,s){super(),this.filters=e,this.op=s,this.Pe=null}static create(e,s){return new Jr(e,s)}matches(e){return AS(this)?this.filters.find((s=>!s.matches(e)))===void 0:this.filters.find((s=>s.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,s)=>e.concat(s.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function AS(n){return n.op==="and"}function IS(n){return WR(n)&&AS(n)}function WR(n){for(const e of n.filters)if(e instanceof Jr)return!1;return!0}function rg(n){if(n instanceof kn)return n.field.canonicalString()+n.op.toString()+Ll(n.value);if(IS(n))return n.filters.map((e=>rg(e))).join(",");{const e=n.filters.map((s=>rg(s))).join(",");return`${n.op}(${e})`}}function NS(n,e){return n instanceof kn?(function(a,o){return o instanceof kn&&a.op===o.op&&a.field.isEqual(o.field)&&Xr(a.value,o.value)})(n,e):n instanceof Jr?(function(a,o){return o instanceof Jr&&a.op===o.op&&a.filters.length===o.filters.length?a.filters.reduce(((l,d,p)=>l&&NS(d,o.filters[p])),!0):!1})(n,e):void at(19439)}function CS(n){return n instanceof kn?(function(s){return`${s.field.canonicalString()} ${s.op} ${Ll(s.value)}`})(n):n instanceof Jr?(function(s){return s.op.toString()+" {"+s.getFilters().map(CS).join(" ,")+"}"})(n):"Filter"}class KR extends kn{constructor(e,s,a){super(e,s,a),this.key=Ke.fromName(a.referenceValue)}matches(e){const s=Ke.comparator(e.key,this.key);return this.matchesComparison(s)}}class ZR extends kn{constructor(e,s){super(e,"in",s),this.keys=RS("in",s)}matches(e){return this.keys.some((s=>s.isEqual(e.key)))}}class XR extends kn{constructor(e,s){super(e,"not-in",s),this.keys=RS("not-in",s)}matches(e){return!this.keys.some((s=>s.isEqual(e.key)))}}function RS(n,e){var s;return(((s=e.arrayValue)==null?void 0:s.values)||[]).map((a=>Ke.fromName(a.referenceValue)))}class JR extends kn{constructor(e,s){super(e,"array-contains",s)}matches(e){const s=e.data.field(this.field);return r0(s)&&cu(s.arrayValue,this.value)}}class eO extends kn{constructor(e,s){super(e,"in",s)}matches(e){const s=e.data.field(this.field);return s!==null&&cu(this.value.arrayValue,s)}}class tO extends kn{constructor(e,s){super(e,"not-in",s)}matches(e){if(cu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const s=e.data.field(this.field);return s!==null&&s.nullValue===void 0&&!cu(this.value.arrayValue,s)}}class nO extends kn{constructor(e,s){super(e,"array-contains-any",s)}matches(e){const s=e.data.field(this.field);return!(!r0(s)||!s.arrayValue.values)&&s.arrayValue.values.some((a=>cu(this.value.arrayValue,a)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e,s=null,a=[],o=[],l=null,d=null,p=null){this.path=e,this.collectionGroup=s,this.orderBy=a,this.filters=o,this.limit=l,this.startAt=d,this.endAt=p,this.Te=null}}function Kv(n,e=null,s=[],a=[],o=null,l=null,d=null){return new sO(n,e,s,a,o,l,d)}function a0(n){const e=Et(n);if(e.Te===null){let s=e.path.canonicalString();e.collectionGroup!==null&&(s+="|cg:"+e.collectionGroup),s+="|f:",s+=e.filters.map((a=>rg(a))).join(","),s+="|ob:",s+=e.orderBy.map((a=>(function(l){return l.field.canonicalString()+l.dir})(a))).join(","),jf(e.limit)||(s+="|l:",s+=e.limit),e.startAt&&(s+="|lb:",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map((a=>Ll(a))).join(",")),e.endAt&&(s+="|ub:",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map((a=>Ll(a))).join(",")),e.Te=s}return e.Te}function i0(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!QR(n.orderBy[s],e.orderBy[s]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if(!NS(n.filters[s],e.filters[s]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Wv(n.startAt,e.startAt)&&Wv(n.endAt,e.endAt)}function ag(n){return Ke.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e,s=null,a=[],o=[],l=null,d="F",p=null,m=null){this.path=e,this.collectionGroup=s,this.explicitOrderBy=a,this.filters=o,this.limit=l,this.limitType=d,this.startAt=p,this.endAt=m,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function rO(n,e,s,a,o,l,d,p){return new Lf(n,e,s,a,o,l,d,p)}function o0(n){return new Lf(n)}function Zv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function aO(n){return Ke.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function iO(n){return n.collectionGroup!==null}function Zc(n){const e=Et(n);if(e.Ie===null){e.Ie=[];const s=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),s.add(l.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new Mn(hs.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((l=>{s.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new mf(l,a))})),s.has(hs.keyField().canonicalString())||e.Ie.push(new mf(hs.keyField(),a))}return e.Ie}function Zr(n){const e=Et(n);return e.Ee||(e.Ee=oO(e,Zc(n))),e.Ee}function oO(n,e){if(n.limitType==="F")return Kv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const l=o.dir==="desc"?"asc":"desc";return new mf(o.field,l)}));const s=n.endAt?new pf(n.endAt.position,n.endAt.inclusive):null,a=n.startAt?new pf(n.startAt.position,n.startAt.inclusive):null;return Kv(n.path,n.collectionGroup,e,n.filters,n.limit,s,a)}}function ig(n,e,s){return new Lf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,s,n.startAt,n.endAt)}function Mf(n,e){return i0(Zr(n),Zr(e))&&n.limitType===e.limitType}function OS(n){return`${a0(Zr(n))}|lt:${n.limitType}`}function hl(n){return`Query(target=${(function(s){let a=s.path.canonicalString();return s.collectionGroup!==null&&(a+=" collectionGroup="+s.collectionGroup),s.filters.length>0&&(a+=`, filters: [${s.filters.map((o=>CS(o))).join(", ")}]`),jf(s.limit)||(a+=", limit: "+s.limit),s.orderBy.length>0&&(a+=`, orderBy: [${s.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),s.startAt&&(a+=", startAt: ",a+=s.startAt.inclusive?"b:":"a:",a+=s.startAt.position.map((o=>Ll(o))).join(",")),s.endAt&&(a+=", endAt: ",a+=s.endAt.inclusive?"a:":"b:",a+=s.endAt.position.map((o=>Ll(o))).join(",")),`Target(${a})`})(Zr(n))}; limitType=${n.limitType})`}function Df(n,e){return e.isFoundDocument()&&(function(a,o){const l=o.key.path;return a.collectionGroup!==null?o.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(l):Ke.isDocumentKey(a.path)?a.path.isEqual(l):a.path.isImmediateParentOf(l)})(n,e)&&(function(a,o){for(const l of Zc(a))if(!l.field.isKeyField()&&o.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(a,o){for(const l of a.filters)if(!l.matches(o))return!1;return!0})(n,e)&&(function(a,o){return!(a.startAt&&!(function(d,p,m){const y=Qv(d,p,m);return d.inclusive?y<=0:y<0})(a.startAt,Zc(a),o)||a.endAt&&!(function(d,p,m){const y=Qv(d,p,m);return d.inclusive?y>=0:y>0})(a.endAt,Zc(a),o))})(n,e)}function lO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function jS(n){return(e,s)=>{let a=!1;for(const o of Zc(n)){const l=cO(o,e,s);if(l!==0)return l;a=a||o.field.isKeyField()}return 0}}function cO(n,e,s){const a=n.field.isKeyField()?Ke.comparator(e.key,s.key):(function(l,d,p){const m=d.data.field(l),y=p.data.field(l);return m!==null&&y!==null?kl(m,y):at(42886)})(n.field,e,s);switch(n.dir){case"asc":return a;case"desc":return-1*a;default:return at(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,s){this.mapKeyFn=e,this.equalsFn=s,this.inner={},this.innerSize=0}get(e){const s=this.mapKeyFn(e),a=this.inner[s];if(a!==void 0){for(const[o,l]of a)if(this.equalsFn(o,e))return l}}has(e){return this.get(e)!==void 0}set(e,s){const a=this.mapKeyFn(e),o=this.inner[a];if(o===void 0)return this.inner[a]=[[e,s]],void this.innerSize++;for(let l=0;l<o.length;l++)if(this.equalsFn(o[l][0],e))return void(o[l]=[e,s]);o.push([e,s]),this.innerSize++}delete(e){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return!1;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return a.length===1?delete this.inner[s]:a.splice(o,1),this.innerSize--,!0;return!1}forEach(e){yu(this.inner,((s,a)=>{for(const[o,l]of a)e(o,l)}))}isEmpty(){return VR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uO=new vn(Ke.comparator);function wi(){return uO}const kS=new vn(Ke.comparator);function Uc(...n){let e=kS;for(const s of n)e=e.insert(s.key,s);return e}function dO(n){let e=kS;return n.forEach(((s,a)=>e=e.insert(s,a.overlayedDocument))),e}function uo(){return Xc()}function LS(){return Xc()}function Xc(){return new Io((n=>n.toString()),((n,e)=>n.isEqual(e)))}const fO=new Mn(Ke.comparator);function St(...n){let e=fO;for(const s of n)e=e.add(s);return e}const hO=new Mn(xt);function pO(){return hO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mO(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:eg(e)?"-0":e}}function gO(n){return{integerValue:""+n}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(){this._=void 0}}function yO(n,e,s){return n instanceof og?(function(o,l){const d={fields:{[ES]:{stringValue:_S},[SS]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return l&&s0(l)&&(l=kf(l)),l&&(d.fields[wS]=l),{mapValue:d}})(s,e):n instanceof gf?MS(n,e):n instanceof yf?DS(n,e):(function(o,l){const d=bO(o,l),p=Xv(d)+Xv(o.Ae);return sg(d)&&sg(o.Ae)?gO(p):mO(o.serializer,p)})(n,e)}function xO(n,e,s){return n instanceof gf?MS(n,e):n instanceof yf?DS(n,e):s}function bO(n,e){return n instanceof lg?(function(a){return sg(a)||(function(l){return!!l&&"doubleValue"in l})(a)})(e)?e:{integerValue:0}:null}class og extends Uf{}class gf extends Uf{constructor(e){super(),this.elements=e}}function MS(n,e){const s=US(e);for(const a of n.elements)s.some((o=>Xr(o,a)))||s.push(a);return{arrayValue:{values:s}}}class yf extends Uf{constructor(e){super(),this.elements=e}}function DS(n,e){let s=US(e);for(const a of n.elements)s=s.filter((o=>!Xr(o,a)));return{arrayValue:{values:s}}}class lg extends Uf{constructor(e,s){super(),this.serializer=e,this.Ae=s}}function Xv(n){return bn(n.integerValue||n.doubleValue)}function US(n){return r0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function vO(n,e){return n.field.isEqual(e.field)&&(function(a,o){return a instanceof gf&&o instanceof gf||a instanceof yf&&o instanceof yf?jl(a.elements,o.elements,Xr):a instanceof lg&&o instanceof lg?Xr(a.Ae,o.Ae):a instanceof og&&o instanceof og})(n.transform,e.transform)}class ho{constructor(e,s){this.updateTime=e,this.exists=s}static none(){return new ho}static exists(e){return new ho(void 0,e)}static updateTime(e){return new ho(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function tf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class l0{}function PS(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new EO(n.key,ho.none()):new c0(n.key,n.data,ho.none());{const s=n.data,a=Qr.empty();let o=new Mn(hs.comparator);for(let l of e.fields)if(!o.has(l)){let d=s.field(l);d===null&&l.length>1&&(l=l.popLast(),d=s.field(l)),d===null?a.delete(l):a.set(l,d),o=o.add(l)}return new Pf(n.key,a,new li(o.toArray()),ho.none())}}function _O(n,e,s){n instanceof c0?(function(o,l,d){const p=o.value.clone(),m=e1(o.fieldTransforms,l,d.transformResults);p.setAll(m),l.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,s):n instanceof Pf?(function(o,l,d){if(!tf(o.precondition,l))return void l.convertToUnknownDocument(d.version);const p=e1(o.fieldTransforms,l,d.transformResults),m=l.data;m.setAll(VS(o)),m.setAll(p),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,s):(function(o,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,s)}function Jc(n,e,s,a){return n instanceof c0?(function(l,d,p,m){if(!tf(l.precondition,d))return p;const y=l.value.clone(),x=t1(l.fieldTransforms,m,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,s,a):n instanceof Pf?(function(l,d,p,m){if(!tf(l.precondition,d))return p;const y=t1(l.fieldTransforms,m,d),x=d.data;return x.setAll(VS(l)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),p===null?null:p.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(n,e,s,a):(function(l,d,p){return tf(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,s)}function Jv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(a,o){return a===void 0&&o===void 0||!(!a||!o)&&jl(a,o,((l,d)=>vO(l,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class c0 extends l0{constructor(e,s,a,o=[]){super(),this.key=e,this.value=s,this.precondition=a,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Pf extends l0{constructor(e,s,a,o,l=[]){super(),this.key=e,this.data=s,this.fieldMask=a,this.precondition=o,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function VS(n){const e=new Map;return n.fieldMask.fields.forEach((s=>{if(!s.isEmpty()){const a=n.data.field(s);e.set(s,a)}})),e}function e1(n,e,s){const a=new Map;tn(n.length===s.length,32656,{Ve:s.length,de:n.length});for(let o=0;o<s.length;o++){const l=n[o],d=l.transform,p=e.data.field(l.field);a.set(l.field,xO(d,p,s[o]))}return a}function t1(n,e,s){const a=new Map;for(const o of n){const l=o.transform,d=s.data.field(o.field);a.set(o.field,yO(l,d,e))}return a}class EO extends l0{constructor(e,s){super(),this.key=e,this.precondition=s,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(e,s,a,o){this.batchId=e,this.localWriteTime=s,this.baseMutations=a,this.mutations=o}applyToRemoteDocument(e,s){const a=s.mutationResults;for(let o=0;o<this.mutations.length;o++){const l=this.mutations[o];l.key.isEqual(e.key)&&_O(l,e,a[o])}}applyToLocalView(e,s){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(s=Jc(a,e,s,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(s=Jc(a,e,s,this.localWriteTime));return s}applyToLocalDocumentSet(e,s){const a=LS();return this.mutations.forEach((o=>{const l=e.get(o.key),d=l.overlayedDocument;let p=this.applyToLocalView(d,l.mutatedFields);p=s.has(o.key)?null:p;const m=PS(d,p);m!==null&&a.set(o.key,m),d.isValidDocument()||d.convertToNoDocument(st.min())})),a}keys(){return this.mutations.reduce(((e,s)=>e.add(s.key)),St())}isEqual(e){return this.batchId===e.batchId&&jl(this.mutations,e.mutations,((s,a)=>Jv(s,a)))&&jl(this.baseMutations,e.baseMutations,((s,a)=>Jv(s,a)))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(e,s){this.largestBatchId=e,this.mutation=s}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(e,s){this.count=e,this.unchangedNames=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var In,vt;function zS(n){if(n===void 0)return La("GRPC error has no .code"),Re.UNKNOWN;switch(n){case In.OK:return Re.OK;case In.CANCELLED:return Re.CANCELLED;case In.UNKNOWN:return Re.UNKNOWN;case In.DEADLINE_EXCEEDED:return Re.DEADLINE_EXCEEDED;case In.RESOURCE_EXHAUSTED:return Re.RESOURCE_EXHAUSTED;case In.INTERNAL:return Re.INTERNAL;case In.UNAVAILABLE:return Re.UNAVAILABLE;case In.UNAUTHENTICATED:return Re.UNAUTHENTICATED;case In.INVALID_ARGUMENT:return Re.INVALID_ARGUMENT;case In.NOT_FOUND:return Re.NOT_FOUND;case In.ALREADY_EXISTS:return Re.ALREADY_EXISTS;case In.PERMISSION_DENIED:return Re.PERMISSION_DENIED;case In.FAILED_PRECONDITION:return Re.FAILED_PRECONDITION;case In.ABORTED:return Re.ABORTED;case In.OUT_OF_RANGE:return Re.OUT_OF_RANGE;case In.UNIMPLEMENTED:return Re.UNIMPLEMENTED;case In.DATA_LOSS:return Re.DATA_LOSS;default:return at(39323,{code:n})}}(vt=In||(In={}))[vt.OK=0]="OK",vt[vt.CANCELLED=1]="CANCELLED",vt[vt.UNKNOWN=2]="UNKNOWN",vt[vt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",vt[vt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",vt[vt.NOT_FOUND=5]="NOT_FOUND",vt[vt.ALREADY_EXISTS=6]="ALREADY_EXISTS",vt[vt.PERMISSION_DENIED=7]="PERMISSION_DENIED",vt[vt.UNAUTHENTICATED=16]="UNAUTHENTICATED",vt[vt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",vt[vt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",vt[vt.ABORTED=10]="ABORTED",vt[vt.OUT_OF_RANGE=11]="OUT_OF_RANGE",vt[vt.UNIMPLEMENTED=12]="UNIMPLEMENTED",vt[vt.INTERNAL=13]="INTERNAL",vt[vt.UNAVAILABLE=14]="UNAVAILABLE",vt[vt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IO=new pi([4294967295,4294967295],0);function n1(n){const e=AO().encode(n),s=new dS;return s.update(e),new Uint8Array(s.digest())}function s1(n){const e=new DataView(n.buffer),s=e.getUint32(0,!0),a=e.getUint32(4,!0),o=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new pi([s,a],0),new pi([o,l],0)]}class u0{constructor(e,s,a){if(this.bitmap=e,this.padding=s,this.hashCount=a,s<0||s>=8)throw new Pc(`Invalid padding: ${s}`);if(a<0)throw new Pc(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new Pc(`Invalid hash count: ${a}`);if(e.length===0&&s!==0)throw new Pc(`Invalid padding when bitmap length is 0: ${s}`);this.ge=8*e.length-s,this.pe=pi.fromNumber(this.ge)}ye(e,s,a){let o=e.add(s.multiply(pi.fromNumber(a)));return o.compare(IO)===1&&(o=new pi([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const s=n1(e),[a,o]=s1(s);for(let l=0;l<this.hashCount;l++){const d=this.ye(a,o,l);if(!this.we(d))return!1}return!0}static create(e,s,a){const o=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new u0(l,o,s);return a.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const s=n1(e),[a,o]=s1(s);for(let l=0;l<this.hashCount;l++){const d=this.ye(a,o,l);this.be(d)}}be(e){const s=Math.floor(e/8),a=e%8;this.bitmap[s]|=1<<a}}class Pc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(e,s,a,o,l){this.snapshotVersion=e,this.targetChanges=s,this.targetMismatches=a,this.documentUpdates=o,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,s,a){const o=new Map;return o.set(e,xu.createSynthesizedTargetChangeForCurrentChange(e,s,a)),new Vf(st.min(),o,new vn(xt),wi(),St())}}class xu{constructor(e,s,a,o,l){this.resumeToken=e,this.current=s,this.addedDocuments=a,this.modifiedDocuments=o,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,s,a){return new xu(a,s,St(),St(),St())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,s,a,o){this.Se=e,this.removedTargetIds=s,this.key=a,this.De=o}}class BS{constructor(e,s){this.targetId=e,this.Ce=s}}class FS{constructor(e,s,a=Kn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=s,this.resumeToken=a,this.cause=o}}class r1{constructor(){this.ve=0,this.Fe=a1(),this.Me=Kn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=St(),s=St(),a=St();return this.Fe.forEach(((o,l)=>{switch(l){case 0:e=e.add(o);break;case 2:s=s.add(o);break;case 1:a=a.add(o);break;default:at(38017,{changeType:l})}})),new xu(this.Me,this.xe,e,s,a)}Ke(){this.Oe=!1,this.Fe=a1()}qe(e,s){this.Oe=!0,this.Fe=this.Fe.insert(e,s)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,tn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class NO{constructor(e){this.Ge=e,this.ze=new Map,this.je=wi(),this.He=Bd(),this.Je=Bd(),this.Ze=new vn(xt)}Xe(e){for(const s of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(s,e.De):this.et(s,e.key,e.De);for(const s of e.removedTargetIds)this.et(s,e.key,e.De)}tt(e){this.forEachTarget(e,(s=>{const a=this.nt(s);switch(e.state){case 0:this.rt(s)&&a.Le(e.resumeToken);break;case 1:a.We(),a.Ne||a.Ke(),a.Le(e.resumeToken);break;case 2:a.We(),a.Ne||this.removeTarget(s);break;case 3:this.rt(s)&&(a.Qe(),a.Le(e.resumeToken));break;case 4:this.rt(s)&&(this.it(s),a.Le(e.resumeToken));break;default:at(56790,{state:e.state})}}))}forEachTarget(e,s){e.targetIds.length>0?e.targetIds.forEach(s):this.ze.forEach(((a,o)=>{this.rt(o)&&s(o)}))}st(e){const s=e.targetId,a=e.Ce.count,o=this.ot(s);if(o){const l=o.target;if(ag(l))if(a===0){const d=new Ke(l.path);this.et(s,d,rs.newNoDocument(d,st.min()))}else tn(a===1,20013,{expectedCount:a});else{const d=this._t(s);if(d!==a){const p=this.ut(e),m=p?this.ct(p,e,d):1;if(m!==0){this.it(s);const y=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(s,y)}}}}}ut(e){const s=e.Ce.unchangedNames;if(!s||!s.bits)return null;const{bits:{bitmap:a="",padding:o=0},hashCount:l=0}=s;let d,p;try{d=_i(a).toUint8Array()}catch(m){if(m instanceof vS)return So("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{p=new u0(d,o,l)}catch(m){return So(m instanceof Pc?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return p.ge===0?null:p}ct(e,s,a){return s.Ce.count===a-this.Pt(e,s.targetId)?0:2}Pt(e,s){const a=this.Ge.getRemoteKeysForTarget(s);let o=0;return a.forEach((l=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(p)||(this.et(s,l,null),o++)})),o}Tt(e){const s=new Map;this.ze.forEach(((l,d)=>{const p=this.ot(d);if(p){if(l.current&&ag(p.target)){const m=new Ke(p.target.path);this.It(m).has(d)||this.Et(d,m)||this.et(d,m,rs.newNoDocument(m,e))}l.Be&&(s.set(d,l.ke()),l.Ke())}}));let a=St();this.Je.forEach(((l,d)=>{let p=!0;d.forEachWhile((m=>{const y=this.ot(m);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(a=a.add(l))})),this.je.forEach(((l,d)=>d.setReadTime(e)));const o=new Vf(e,s,this.Ze,this.je,a);return this.je=wi(),this.He=Bd(),this.Je=Bd(),this.Ze=new vn(xt),o}Ye(e,s){if(!this.rt(e))return;const a=this.Et(e,s.key)?2:0;this.nt(e).qe(s.key,a),this.je=this.je.insert(s.key,s),this.He=this.He.insert(s.key,this.It(s.key).add(e)),this.Je=this.Je.insert(s.key,this.Rt(s.key).add(e))}et(e,s,a){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,s)?o.qe(s,1):o.Ue(s),this.Je=this.Je.insert(s,this.Rt(s).delete(e)),this.Je=this.Je.insert(s,this.Rt(s).add(e)),a&&(this.je=this.je.insert(s,a))}removeTarget(e){this.ze.delete(e)}_t(e){const s=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+s.addedDocuments.size-s.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let s=this.ze.get(e);return s||(s=new r1,this.ze.set(e,s)),s}Rt(e){let s=this.Je.get(e);return s||(s=new Mn(xt),this.Je=this.Je.insert(e,s)),s}It(e){let s=this.He.get(e);return s||(s=new Mn(xt),this.He=this.He.insert(e,s)),s}rt(e){const s=this.ot(e)!==null;return s||Me("WatchChangeAggregator","Detected inactive target",e),s}ot(e){const s=this.ze.get(e);return s&&s.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new r1),this.Ge.getRemoteKeysForTarget(e).forEach((s=>{this.et(e,s,null)}))}Et(e,s){return this.Ge.getRemoteKeysForTarget(e).has(s)}}function Bd(){return new vn(Ke.comparator)}function a1(){return new vn(Ke.comparator)}const CO={asc:"ASCENDING",desc:"DESCENDING"},RO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},OO={and:"AND",or:"OR"};class jO{constructor(e,s){this.databaseId=e,this.useProto3Json=s}}function cg(n,e){return n.useProto3Json||jf(e)?e:{value:e}}function kO(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function LO(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Sl(n){return tn(!!n,49232),st.fromTimestamp((function(s){const a=vi(s);return new Nn(a.seconds,a.nanos)})(n))}function MO(n,e){return ug(n,e).canonicalString()}function ug(n,e){const s=(function(o){return new en(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?s:s.child(e)}function HS(n){const e=en.fromString(n);return tn(QS(e),10190,{key:e.toString()}),e}function sm(n,e){const s=HS(e);if(s.get(1)!==n.databaseId.projectId)throw new He(Re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+s.get(1)+" vs "+n.databaseId.projectId);if(s.get(3)!==n.databaseId.database)throw new He(Re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+s.get(3)+" vs "+n.databaseId.database);return new Ke(qS(s))}function GS(n,e){return MO(n.databaseId,e)}function DO(n){const e=HS(n);return e.length===4?en.emptyPath():qS(e)}function i1(n){return new en(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function qS(n){return tn(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function UO(n,e){let s;if("targetChange"in e){e.targetChange;const a=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:at(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],l=(function(y,x){return y.useProto3Json?(tn(x===void 0||typeof x=="string",58123),Kn.fromBase64String(x||"")):(tn(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),Kn.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const x=y.code===void 0?Re.UNKNOWN:zS(y.code);return new He(x,y.message||"")})(d);s=new FS(a,o,l,p||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const o=sm(n,a.document.name),l=Sl(a.document.updateTime),d=a.document.createTime?Sl(a.document.createTime):st.min(),p=new Qr({mapValue:{fields:a.document.fields}}),m=rs.newFoundDocument(o,l,d,p),y=a.targetIds||[],x=a.removedTargetIds||[];s=new nf(y,x,m.key,m)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const o=sm(n,a.document),l=a.readTime?Sl(a.readTime):st.min(),d=rs.newNoDocument(o,l),p=a.removedTargetIds||[];s=new nf([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const o=sm(n,a.document),l=a.removedTargetIds||[];s=new nf([],l,o,null)}else{if(!("filter"in e))return at(11601,{Vt:e});{e.filter;const a=e.filter;a.targetId;const{count:o=0,unchangedNames:l}=a,d=new TO(o,l),p=a.targetId;s=new BS(p,d)}}return s}function PO(n,e){return{documents:[GS(n,e.path)]}}function VO(n,e){const s={structuredQuery:{}},a=e.path;let o;e.collectionGroup!==null?(o=a,s.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=a.popLast(),s.structuredQuery.from=[{collectionId:a.lastSegment()}]),s.parent=GS(n,o);const l=(function(y){if(y.length!==0)return YS(Jr.create(y,"and"))})(e.filters);l&&(s.structuredQuery.where=l);const d=(function(y){if(y.length!==0)return y.map((x=>(function(S){return{field:pl(S.field),direction:FO(S.dir)}})(x)))})(e.orderBy);d&&(s.structuredQuery.orderBy=d);const p=cg(n,e.limit);return p!==null&&(s.structuredQuery.limit=p),e.startAt&&(s.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(s.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:s,parent:o}}function zO(n){let e=DO(n.parent);const s=n.structuredQuery,a=s.from?s.from.length:0;let o=null;if(a>0){tn(a===1,65062);const x=s.from[0];x.allDescendants?o=x.collectionId:e=e.child(x.collectionId)}let l=[];s.where&&(l=(function(v){const S=$S(v);return S instanceof Jr&&IS(S)?S.getFilters():[S]})(s.where));let d=[];s.orderBy&&(d=(function(v){return v.map((S=>(function(z){return new mf(ml(z.field),(function(j){switch(j){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(z.direction))})(S)))})(s.orderBy));let p=null;s.limit&&(p=(function(v){let S;return S=typeof v=="object"?v.value:v,jf(S)?null:S})(s.limit));let m=null;s.startAt&&(m=(function(v){const S=!!v.before,N=v.values||[];return new pf(N,S)})(s.startAt));let y=null;return s.endAt&&(y=(function(v){const S=!v.before,N=v.values||[];return new pf(N,S)})(s.endAt)),rO(e,o,d,l,p,"F",m,y)}function BO(n,e){const s=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return at(28987,{purpose:o})}})(e.purpose);return s==null?null:{"goog-listen-tags":s}}function $S(n){return n.unaryFilter!==void 0?(function(s){switch(s.unaryFilter.op){case"IS_NAN":const a=ml(s.unaryFilter.field);return kn.create(a,"==",{doubleValue:NaN});case"IS_NULL":const o=ml(s.unaryFilter.field);return kn.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=ml(s.unaryFilter.field);return kn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=ml(s.unaryFilter.field);return kn.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return at(61313);default:return at(60726)}})(n):n.fieldFilter!==void 0?(function(s){return kn.create(ml(s.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return at(58110);default:return at(50506)}})(s.fieldFilter.op),s.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(s){return Jr.create(s.compositeFilter.filters.map((a=>$S(a))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return at(1026)}})(s.compositeFilter.op))})(n):at(30097,{filter:n})}function FO(n){return CO[n]}function HO(n){return RO[n]}function GO(n){return OO[n]}function pl(n){return{fieldPath:n.canonicalString()}}function ml(n){return hs.fromServerFormat(n.fieldPath)}function YS(n){return n instanceof kn?(function(s){if(s.op==="=="){if(Yv(s.value))return{unaryFilter:{field:pl(s.field),op:"IS_NAN"}};if($v(s.value))return{unaryFilter:{field:pl(s.field),op:"IS_NULL"}}}else if(s.op==="!="){if(Yv(s.value))return{unaryFilter:{field:pl(s.field),op:"IS_NOT_NAN"}};if($v(s.value))return{unaryFilter:{field:pl(s.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pl(s.field),op:HO(s.op),value:s.value}}})(n):n instanceof Jr?(function(s){const a=s.getFilters().map((o=>YS(o)));return a.length===1?a[0]:{compositeFilter:{op:GO(s.op),filters:a}}})(n):at(54877,{filter:n})}function QS(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,s,a,o,l=st.min(),d=st.min(),p=Kn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=s,this.purpose=a,this.sequenceNumber=o,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=m}withSequenceNumber(e){return new ci(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,s){return new ci(this.target,this.targetId,this.purpose,this.sequenceNumber,s,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ci(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ci(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(e){this.yt=e}}function $O(n){const e=zO({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ig(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(){this.Sn=new QO}addToCollectionParentIndex(e,s){return this.Sn.add(s),we.resolve()}getCollectionParents(e,s){return we.resolve(this.Sn.getEntries(s))}addFieldIndex(e,s){return we.resolve()}deleteFieldIndex(e,s){return we.resolve()}deleteAllFieldIndexes(e){return we.resolve()}createTargetIndexes(e,s){return we.resolve()}getDocumentsMatchingTarget(e,s){return we.resolve(null)}getIndexType(e,s){return we.resolve(0)}getFieldIndexes(e,s){return we.resolve([])}getNextCollectionGroupToUpdate(e){return we.resolve(null)}getMinOffset(e,s){return we.resolve(bi.min())}getMinOffsetFromCollectionGroup(e,s){return we.resolve(bi.min())}updateCollectionGroup(e,s,a){return we.resolve()}updateIndexEntries(e,s){return we.resolve()}}class QO{constructor(){this.index={}}add(e){const s=e.lastSegment(),a=e.popLast(),o=this.index[s]||new Mn(en.comparator),l=!o.has(a);return this.index[s]=o.add(a),l}has(e){const s=e.lastSegment(),a=e.popLast(),o=this.index[s];return o&&o.has(a)}getEntries(e){return(this.index[e]||new Mn(en.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},WS=41943040;class As{static withCacheSize(e){return new As(e,As.DEFAULT_COLLECTION_PERCENTILE,As.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,s,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=s,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */As.DEFAULT_COLLECTION_PERCENTILE=10,As.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,As.DEFAULT=new As(WS,As.DEFAULT_COLLECTION_PERCENTILE,As.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),As.DISABLED=new As(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Ml(0)}static ar(){return new Ml(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1="LruGarbageCollector",WO=1048576;function c1([n,e],[s,a]){const o=xt(n,s);return o===0?xt(e,a):o}class KO{constructor(e){this.Pr=e,this.buffer=new Mn(c1),this.Tr=0}Ir(){return++this.Tr}Er(e){const s=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(s);else{const a=this.buffer.last();c1(s,a)<0&&(this.buffer=this.buffer.delete(a).add(s))}}get maxValue(){return this.buffer.last()[0]}}class ZO{constructor(e,s,a){this.garbageCollector=e,this.asyncQueue=s,this.localStore=a,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Me(l1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(s){zl(s)?Me(l1,"Ignoring IndexedDB error during garbage collection: ",s):await Rf(s)}await this.Ar(3e5)}))}}class XO{constructor(e,s){this.Vr=e,this.params=s}calculateTargetCount(e,s){return this.Vr.dr(e).next((a=>Math.floor(s/100*a)))}nthSequenceNumber(e,s){if(s===0)return we.resolve(Of.ce);const a=new KO(s);return this.Vr.forEachTarget(e,(o=>a.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>a.Er(o))))).next((()=>a.maxValue))}removeTargets(e,s,a){return this.Vr.removeTargets(e,s,a)}removeOrphanedDocuments(e,s){return this.Vr.removeOrphanedDocuments(e,s)}collect(e,s){return this.params.cacheSizeCollectionThreshold===-1?(Me("LruGarbageCollector","Garbage collection skipped; disabled"),we.resolve(o1)):this.getCacheSize(e).next((a=>a<this.params.cacheSizeCollectionThreshold?(Me("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),o1):this.gr(e,s)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,s){let a,o,l,d,p,m,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Me("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),o=this.params.maximumSequenceNumbersToCollect):o=v,d=Date.now(),this.nthSequenceNumber(e,o)))).next((v=>(a=v,p=Date.now(),this.removeTargets(e,a,s)))).next((v=>(l=v,m=Date.now(),this.removeOrphanedDocuments(e,a)))).next((v=>(y=Date.now(),fl()<=_t.DEBUG&&Me("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${o} in `+(p-d)+`ms
	Removed ${l} targets in `+(m-p)+`ms
	Removed ${v} documents in `+(y-m)+`ms
Total Duration: ${y-x}ms`),we.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:l,documentsRemoved:v}))))}}function JO(n,e){return new XO(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(){this.changes=new Io((e=>e.toString()),((e,s)=>e.isEqual(s))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,s){this.assertNotApplied(),this.changes.set(e,rs.newInvalidDocument(e).setReadTime(s))}getEntry(e,s){this.assertNotApplied();const a=this.changes.get(s);return a!==void 0?we.resolve(a):this.getFromCache(e,s)}getEntries(e,s){return this.getAllFromCache(e,s)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tj{constructor(e,s){this.overlayedDocument=e,this.mutatedFields=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(e,s,a,o){this.remoteDocumentCache=e,this.mutationQueue=s,this.documentOverlayCache=a,this.indexManager=o}getDocument(e,s){let a=null;return this.documentOverlayCache.getOverlay(e,s).next((o=>(a=o,this.remoteDocumentCache.getEntry(e,s)))).next((o=>(a!==null&&Jc(a.mutation,o,li.empty(),Nn.now()),o)))}getDocuments(e,s){return this.remoteDocumentCache.getEntries(e,s).next((a=>this.getLocalViewOfDocuments(e,a,St()).next((()=>a))))}getLocalViewOfDocuments(e,s,a=St()){const o=uo();return this.populateOverlays(e,o,s).next((()=>this.computeViews(e,s,o,a).next((l=>{let d=Uc();return l.forEach(((p,m)=>{d=d.insert(p,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,s){const a=uo();return this.populateOverlays(e,a,s).next((()=>this.computeViews(e,s,a,St())))}populateOverlays(e,s,a){const o=[];return a.forEach((l=>{s.has(l)||o.push(l)})),this.documentOverlayCache.getOverlays(e,o).next((l=>{l.forEach(((d,p)=>{s.set(d,p)}))}))}computeViews(e,s,a,o){let l=wi();const d=Xc(),p=(function(){return Xc()})();return s.forEach(((m,y)=>{const x=a.get(y.key);o.has(y.key)&&(x===void 0||x.mutation instanceof Pf)?l=l.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),Jc(x.mutation,y,x.mutation.getFieldMask(),Nn.now())):d.set(y.key,li.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((y,x)=>d.set(y,x))),s.forEach(((y,x)=>p.set(y,new tj(x,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,s){const a=Xc();let o=new vn(((d,p)=>d-p)),l=St();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,s).next((d=>{for(const p of d)p.keys().forEach((m=>{const y=s.get(m);if(y===null)return;let x=a.get(m)||li.empty();x=p.applyToLocalView(y,x),a.set(m,x);const v=(o.get(p.batchId)||St()).add(m);o=o.insert(p.batchId,v)}))})).next((()=>{const d=[],p=o.getReverseIterator();for(;p.hasNext();){const m=p.getNext(),y=m.key,x=m.value,v=LS();x.forEach((S=>{if(!l.has(S)){const N=PS(s.get(S),a.get(S));N!==null&&v.set(S,N),l=l.add(S)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,v))}return we.waitFor(d)})).next((()=>a))}recalculateAndSaveOverlaysForDocumentKeys(e,s){return this.remoteDocumentCache.getEntries(e,s).next((a=>this.recalculateAndSaveOverlays(e,a)))}getDocumentsMatchingQuery(e,s,a,o){return aO(s)?this.getDocumentsMatchingDocumentQuery(e,s.path):iO(s)?this.getDocumentsMatchingCollectionGroupQuery(e,s,a,o):this.getDocumentsMatchingCollectionQuery(e,s,a,o)}getNextDocuments(e,s,a,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,s,a,o).next((l=>{const d=o-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,s,a.largestBatchId,o-l.size):we.resolve(uo());let p=iu,m=l;return d.next((y=>we.forEach(y,((x,v)=>(p<v.largestBatchId&&(p=v.largestBatchId),l.get(x)?we.resolve():this.remoteDocumentCache.getEntry(e,x).next((S=>{m=m.insert(x,S)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,m,y,St()))).next((x=>({batchId:p,changes:dO(x)})))))}))}getDocumentsMatchingDocumentQuery(e,s){return this.getDocument(e,new Ke(s)).next((a=>{let o=Uc();return a.isFoundDocument()&&(o=o.insert(a.key,a)),o}))}getDocumentsMatchingCollectionGroupQuery(e,s,a,o){const l=s.collectionGroup;let d=Uc();return this.indexManager.getCollectionParents(e,l).next((p=>we.forEach(p,(m=>{const y=(function(v,S){return new Lf(S,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(s,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,a,o).next((x=>{x.forEach(((v,S)=>{d=d.insert(v,S)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,s,a,o){let l;return this.documentOverlayCache.getOverlaysForCollection(e,s.path,a.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,s,a,l,o)))).next((d=>{l.forEach(((m,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,rs.newInvalidDocument(x)))}));let p=Uc();return d.forEach(((m,y)=>{const x=l.get(m);x!==void 0&&Jc(x.mutation,y,li.empty(),Nn.now()),Df(s,y)&&(p=p.insert(m,y))})),p}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,s){return we.resolve(this.Nr.get(s))}saveBundleMetadata(e,s){return this.Nr.set(s.id,(function(o){return{id:o.id,version:o.version,createTime:Sl(o.createTime)}})(s)),we.resolve()}getNamedQuery(e,s){return we.resolve(this.Br.get(s))}saveNamedQuery(e,s){return this.Br.set(s.name,(function(o){return{name:o.name,query:$O(o.bundledQuery),readTime:Sl(o.readTime)}})(s)),we.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(){this.overlays=new vn(Ke.comparator),this.Lr=new Map}getOverlay(e,s){return we.resolve(this.overlays.get(s))}getOverlays(e,s){const a=uo();return we.forEach(s,(o=>this.getOverlay(e,o).next((l=>{l!==null&&a.set(o,l)})))).next((()=>a))}saveOverlays(e,s,a){return a.forEach(((o,l)=>{this.bt(e,s,l)})),we.resolve()}removeOverlaysForBatchId(e,s,a){const o=this.Lr.get(a);return o!==void 0&&(o.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(a)),we.resolve()}getOverlaysForCollection(e,s,a){const o=uo(),l=s.length+1,d=new Ke(s.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const m=p.getNext().value,y=m.getKey();if(!s.isPrefixOf(y.path))break;y.path.length===l&&m.largestBatchId>a&&o.set(m.getKey(),m)}return we.resolve(o)}getOverlaysForCollectionGroup(e,s,a,o){let l=new vn(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===s&&y.largestBatchId>a){let x=l.get(y.largestBatchId);x===null&&(x=uo(),l=l.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const p=uo(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((y,x)=>p.set(y,x))),!(p.size()>=o)););return we.resolve(p)}bt(e,s,a){const o=this.overlays.get(a.key);if(o!==null){const d=this.Lr.get(o.largestBatchId).delete(a.key);this.Lr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(a.key,new SO(s,a));let l=this.Lr.get(s);l===void 0&&(l=St(),this.Lr.set(s,l)),this.Lr.set(s,l.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(){this.sessionToken=Kn.EMPTY_BYTE_STRING}getSessionToken(e){return we.resolve(this.sessionToken)}setSessionToken(e,s){return this.sessionToken=s,we.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d0{constructor(){this.kr=new Mn(Vn.Kr),this.qr=new Mn(Vn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,s){const a=new Vn(e,s);this.kr=this.kr.add(a),this.qr=this.qr.add(a)}$r(e,s){e.forEach((a=>this.addReference(a,s)))}removeReference(e,s){this.Wr(new Vn(e,s))}Qr(e,s){e.forEach((a=>this.removeReference(a,s)))}Gr(e){const s=new Ke(new en([])),a=new Vn(s,e),o=new Vn(s,e+1),l=[];return this.qr.forEachInRange([a,o],(d=>{this.Wr(d),l.push(d.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const s=new Ke(new en([])),a=new Vn(s,e),o=new Vn(s,e+1);let l=St();return this.qr.forEachInRange([a,o],(d=>{l=l.add(d.key)})),l}containsKey(e){const s=new Vn(e,0),a=this.kr.firstAfterOrEqual(s);return a!==null&&e.isEqual(a.key)}}class Vn{constructor(e,s){this.key=e,this.Hr=s}static Kr(e,s){return Ke.comparator(e.key,s.key)||xt(e.Hr,s.Hr)}static Ur(e,s){return xt(e.Hr,s.Hr)||Ke.comparator(e.key,s.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(e,s){this.indexManager=e,this.referenceDelegate=s,this.mutationQueue=[],this.Yn=1,this.Jr=new Mn(Vn.Kr)}checkEmpty(e){return we.resolve(this.mutationQueue.length===0)}addMutationBatch(e,s,a,o){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new wO(l,s,a,o);this.mutationQueue.push(d);for(const p of o)this.Jr=this.Jr.add(new Vn(p.key,l)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return we.resolve(d)}lookupMutationBatch(e,s){return we.resolve(this.Zr(s))}getNextMutationBatchAfterBatchId(e,s){const a=s+1,o=this.Xr(a),l=o<0?0:o;return we.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return we.resolve(this.mutationQueue.length===0?DR:this.Yn-1)}getAllMutationBatches(e){return we.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,s){const a=new Vn(s,0),o=new Vn(s,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([a,o],(d=>{const p=this.Zr(d.Hr);l.push(p)})),we.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,s){let a=new Mn(xt);return s.forEach((o=>{const l=new Vn(o,0),d=new Vn(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,d],(p=>{a=a.add(p.Hr)}))})),we.resolve(this.Yr(a))}getAllMutationBatchesAffectingQuery(e,s){const a=s.path,o=a.length+1;let l=a;Ke.isDocumentKey(l)||(l=l.child(""));const d=new Vn(new Ke(l),0);let p=new Mn(xt);return this.Jr.forEachWhile((m=>{const y=m.key.path;return!!a.isPrefixOf(y)&&(y.length===o&&(p=p.add(m.Hr)),!0)}),d),we.resolve(this.Yr(p))}Yr(e){const s=[];return e.forEach((a=>{const o=this.Zr(a);o!==null&&s.push(o)})),s}removeMutationBatch(e,s){tn(this.ei(s.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Jr;return we.forEach(s.mutations,(o=>{const l=new Vn(o.key,s.batchId);return a=a.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=a}))}nr(e){}containsKey(e,s){const a=new Vn(s,0),o=this.Jr.firstAfterOrEqual(a);return we.resolve(s.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,we.resolve()}ei(e,s){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const s=this.Xr(e);return s<0||s>=this.mutationQueue.length?null:this.mutationQueue[s]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e){this.ti=e,this.docs=(function(){return new vn(Ke.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,s){const a=s.key,o=this.docs.get(a),l=o?o.size:0,d=this.ti(s);return this.docs=this.docs.insert(a,{document:s.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const s=this.docs.get(e);s&&(this.docs=this.docs.remove(e),this.size-=s.size)}getEntry(e,s){const a=this.docs.get(s);return we.resolve(a?a.document.mutableCopy():rs.newInvalidDocument(s))}getEntries(e,s){let a=wi();return s.forEach((o=>{const l=this.docs.get(o);a=a.insert(o,l?l.document.mutableCopy():rs.newInvalidDocument(o))})),we.resolve(a)}getDocumentsMatchingQuery(e,s,a,o){let l=wi();const d=s.path,p=new Ke(d.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(p);for(;m.hasNext();){const{key:y,value:{document:x}}=m.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||jR(OR(x),a)<=0||(o.has(x.key)||Df(s,x))&&(l=l.insert(x.key,x.mutableCopy()))}return we.resolve(l)}getAllFromCollectionGroup(e,s,a,o){at(9500)}ni(e,s){return we.forEach(this.docs,(a=>s(a)))}newChangeBuffer(e){return new lj(this)}getSize(e){return we.resolve(this.size)}}class lj extends ej{constructor(e){super(),this.Mr=e}applyChanges(e){const s=[];return this.changes.forEach(((a,o)=>{o.isValidDocument()?s.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(a)})),we.waitFor(s)}getFromCache(e,s){return this.Mr.getEntry(e,s)}getAllFromCache(e,s){return this.Mr.getEntries(e,s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e){this.persistence=e,this.ri=new Io((s=>a0(s)),i0),this.lastRemoteSnapshotVersion=st.min(),this.highestTargetId=0,this.ii=0,this.si=new d0,this.targetCount=0,this.oi=Ml._r()}forEachTarget(e,s){return this.ri.forEach(((a,o)=>s(o))),we.resolve()}getLastRemoteSnapshotVersion(e){return we.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return we.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),we.resolve(this.highestTargetId)}setTargetsMetadata(e,s,a){return a&&(this.lastRemoteSnapshotVersion=a),s>this.ii&&(this.ii=s),we.resolve()}lr(e){this.ri.set(e.target,e);const s=e.targetId;s>this.highestTargetId&&(this.oi=new Ml(s),this.highestTargetId=s),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,s){return this.lr(s),this.targetCount+=1,we.resolve()}updateTargetData(e,s){return this.lr(s),we.resolve()}removeTargetData(e,s){return this.ri.delete(s.target),this.si.Gr(s.targetId),this.targetCount-=1,we.resolve()}removeTargets(e,s,a){let o=0;const l=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=s&&a.get(p.targetId)===null&&(this.ri.delete(d),l.push(this.removeMatchingKeysForTargetId(e,p.targetId)),o++)})),we.waitFor(l).next((()=>o))}getTargetCount(e){return we.resolve(this.targetCount)}getTargetData(e,s){const a=this.ri.get(s)||null;return we.resolve(a)}addMatchingKeys(e,s,a){return this.si.$r(s,a),we.resolve()}removeMatchingKeys(e,s,a){this.si.Qr(s,a);const o=this.persistence.referenceDelegate,l=[];return o&&s.forEach((d=>{l.push(o.markPotentiallyOrphaned(e,d))})),we.waitFor(l)}removeMatchingKeysForTargetId(e,s){return this.si.Gr(s),we.resolve()}getMatchingKeysForTargetId(e,s){const a=this.si.jr(s);return we.resolve(a)}containsKey(e,s){return we.resolve(this.si.containsKey(s))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e,s){this._i={},this.overlays={},this.ai=new Of(0),this.ui=!1,this.ui=!0,this.ci=new aj,this.referenceDelegate=e(this),this.li=new cj(this),this.indexManager=new YO,this.remoteDocumentCache=(function(o){return new oj(o)})((a=>this.referenceDelegate.hi(a))),this.serializer=new qO(s),this.Pi=new sj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let s=this.overlays[e.toKey()];return s||(s=new rj,this.overlays[e.toKey()]=s),s}getMutationQueue(e,s){let a=this._i[e.toKey()];return a||(a=new ij(s,this.referenceDelegate),this._i[e.toKey()]=a),a}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,s,a){Me("MemoryPersistence","Starting transaction:",e);const o=new uj(this.ai.next());return this.referenceDelegate.Ti(),a(o).next((l=>this.referenceDelegate.Ii(o).next((()=>l)))).toPromise().then((l=>(o.raiseOnCommittedEvent(),l)))}Ei(e,s){return we.or(Object.values(this._i).map((a=>()=>a.containsKey(e,s))))}}class uj extends LR{constructor(e){super(),this.currentSequenceNumber=e}}class f0{constructor(e){this.persistence=e,this.Ri=new d0,this.Ai=null}static Vi(e){return new f0(e)}get di(){if(this.Ai)return this.Ai;throw at(60996)}addReference(e,s,a){return this.Ri.addReference(a,s),this.di.delete(a.toString()),we.resolve()}removeReference(e,s,a){return this.Ri.removeReference(a,s),this.di.add(a.toString()),we.resolve()}markPotentiallyOrphaned(e,s){return this.di.add(s.toString()),we.resolve()}removeTarget(e,s){this.Ri.Gr(s.targetId).forEach((o=>this.di.add(o.toString())));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,s.targetId).next((o=>{o.forEach((l=>this.di.add(l.toString())))})).next((()=>a.removeTargetData(e,s)))}Ti(){this.Ai=new Set}Ii(e){const s=this.persistence.getRemoteDocumentCache().newChangeBuffer();return we.forEach(this.di,(a=>{const o=Ke.fromPath(a);return this.mi(e,o).next((l=>{l||s.removeEntry(o,st.min())}))})).next((()=>(this.Ai=null,s.apply(e))))}updateLimboDocument(e,s){return this.mi(e,s).next((a=>{a?this.di.delete(s.toString()):this.di.add(s.toString())}))}hi(e){return 0}mi(e,s){return we.or([()=>we.resolve(this.Ri.containsKey(s)),()=>this.persistence.getTargetCache().containsKey(e,s),()=>this.persistence.Ei(e,s)])}}class xf{constructor(e,s){this.persistence=e,this.fi=new Io((a=>UR(a.path)),((a,o)=>a.isEqual(o))),this.garbageCollector=JO(this,s)}static Vi(e,s){return new xf(e,s)}Ti(){}Ii(e){return we.resolve()}forEachTarget(e,s){return this.persistence.getTargetCache().forEachTarget(e,s)}dr(e){const s=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((a=>s.next((o=>a+o))))}pr(e){let s=0;return this.mr(e,(a=>{s++})).next((()=>s))}mr(e,s){return we.forEach(this.fi,((a,o)=>this.wr(e,a,o).next((l=>l?we.resolve():s(o)))))}removeTargets(e,s,a){return this.persistence.getTargetCache().removeTargets(e,s,a)}removeOrphanedDocuments(e,s){let a=0;const o=this.persistence.getRemoteDocumentCache(),l=o.newChangeBuffer();return o.ni(e,(d=>this.wr(e,d,s).next((p=>{p||(a++,l.removeEntry(d,st.min()))})))).next((()=>l.apply(e))).next((()=>a))}markPotentiallyOrphaned(e,s){return this.fi.set(s,e.currentSequenceNumber),we.resolve()}removeTarget(e,s){const a=s.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,s,a){return this.fi.set(a,e.currentSequenceNumber),we.resolve()}removeReference(e,s,a){return this.fi.set(a,e.currentSequenceNumber),we.resolve()}updateLimboDocument(e,s){return this.fi.set(s,e.currentSequenceNumber),we.resolve()}hi(e){let s=e.key.toString().length;return e.isFoundDocument()&&(s+=ef(e.data.value)),s}wr(e,s,a){return we.or([()=>this.persistence.Ei(e,s),()=>this.persistence.getTargetCache().containsKey(e,s),()=>{const o=this.fi.get(s);return we.resolve(o!==void 0&&o>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0{constructor(e,s,a,o){this.targetId=e,this.fromCache=s,this.Ts=a,this.Is=o}static Es(e,s){let a=St(),o=St();for(const l of s.docChanges)switch(l.type){case 0:a=a.add(l.doc.key);break;case 1:o=o.add(l.doc.key)}return new h0(e,s.fromCache,a,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return WN()?8:MR(YN())>0?6:4})()}initialize(e,s){this.fs=e,this.indexManager=s,this.Rs=!0}getDocumentsMatchingQuery(e,s,a,o){const l={result:null};return this.gs(e,s).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ps(e,s,o,a).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new dj;return this.ys(e,s,d).next((p=>{if(l.result=p,this.As)return this.ws(e,s,d,p.size)}))})).next((()=>l.result))}ws(e,s,a,o){return a.documentReadCount<this.Vs?(fl()<=_t.DEBUG&&Me("QueryEngine","SDK will not create cache indexes for query:",hl(s),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),we.resolve()):(fl()<=_t.DEBUG&&Me("QueryEngine","Query:",hl(s),"scans",a.documentReadCount,"local documents and returns",o,"documents as results."),a.documentReadCount>this.ds*o?(fl()<=_t.DEBUG&&Me("QueryEngine","The SDK decides to create cache indexes for query:",hl(s),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zr(s))):we.resolve())}gs(e,s){if(Zv(s))return we.resolve(null);let a=Zr(s);return this.indexManager.getIndexType(e,a).next((o=>o===0?null:(s.limit!==null&&o===1&&(s=ig(s,null,"F"),a=Zr(s)),this.indexManager.getDocumentsMatchingTarget(e,a).next((l=>{const d=St(...l);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,a).next((m=>{const y=this.bs(s,p);return this.Ss(s,y,d,m.readTime)?this.gs(e,ig(s,null,"F")):this.Ds(e,y,s,m)}))))})))))}ps(e,s,a,o){return Zv(s)||o.isEqual(st.min())?we.resolve(null):this.fs.getDocuments(e,a).next((l=>{const d=this.bs(s,l);return this.Ss(s,d,a,o)?we.resolve(null):(fl()<=_t.DEBUG&&Me("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),hl(s)),this.Ds(e,d,s,RR(o,iu)).next((p=>p)))}))}bs(e,s){let a=new Mn(jS(e));return s.forEach(((o,l)=>{Df(e,l)&&(a=a.add(l))})),a}Ss(e,s,a,o){if(e.limit===null)return!1;if(a.size!==s.size)return!0;const l=e.limitType==="F"?s.last():s.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(o)>0)}ys(e,s,a){return fl()<=_t.DEBUG&&Me("QueryEngine","Using full collection scan to execute query:",hl(s)),this.fs.getDocumentsMatchingQuery(e,s,bi.min(),a)}Ds(e,s,a,o){return this.fs.getDocumentsMatchingQuery(e,a,o).next((l=>(s.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p0="LocalStore",hj=3e8;class pj{constructor(e,s,a,o){this.persistence=e,this.Cs=s,this.serializer=o,this.vs=new vn(xt),this.Fs=new Io((l=>a0(l)),i0),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(a)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nj(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(s=>e.collect(s,this.vs)))}}function mj(n,e,s,a){return new pj(n,e,s,a)}async function ZS(n,e){const s=Et(n);return await s.persistence.runTransaction("Handle user change","readonly",(a=>{let o;return s.mutationQueue.getAllMutationBatches(a).next((l=>(o=l,s.Os(e),s.mutationQueue.getAllMutationBatches(a)))).next((l=>{const d=[],p=[];let m=St();for(const y of o){d.push(y.batchId);for(const x of y.mutations)m=m.add(x.key)}for(const y of l){p.push(y.batchId);for(const x of y.mutations)m=m.add(x.key)}return s.localDocuments.getDocuments(a,m).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function XS(n){const e=Et(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(s=>e.li.getLastRemoteSnapshotVersion(s)))}function gj(n,e){const s=Et(n),a=e.snapshotVersion;let o=s.vs;return s.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=s.xs.newChangeBuffer({trackRemovals:!0});o=s.vs;const p=[];e.targetChanges.forEach(((x,v)=>{const S=o.get(v);if(!S)return;p.push(s.li.removeMatchingKeys(l,x.removedDocuments,v).next((()=>s.li.addMatchingKeys(l,x.addedDocuments,v))));let N=S.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?N=N.withResumeToken(Kn.EMPTY_BYTE_STRING,st.min()).withLastLimboFreeSnapshotVersion(st.min()):x.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(x.resumeToken,a)),o=o.insert(v,N),(function(D,j,P){return D.resumeToken.approximateByteSize()===0||j.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=hj?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0})(S,N,x)&&p.push(s.li.updateTargetData(l,N))}));let m=wi(),y=St();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&p.push(s.persistence.referenceDelegate.updateLimboDocument(l,x))})),p.push(yj(l,d,e.documentUpdates).next((x=>{m=x.Bs,y=x.Ls}))),!a.isEqual(st.min())){const x=s.li.getLastRemoteSnapshotVersion(l).next((v=>s.li.setTargetsMetadata(l,l.currentSequenceNumber,a)));p.push(x)}return we.waitFor(p).next((()=>d.apply(l))).next((()=>s.localDocuments.getLocalViewOfDocuments(l,m,y))).next((()=>m))})).then((l=>(s.vs=o,l)))}function yj(n,e,s){let a=St(),o=St();return s.forEach((l=>a=a.add(l))),e.getEntries(n,a).next((l=>{let d=wi();return s.forEach(((p,m)=>{const y=l.get(p);m.isFoundDocument()!==y.isFoundDocument()&&(o=o.add(p)),m.isNoDocument()&&m.version.isEqual(st.min())?(e.removeEntry(p,m.readTime),d=d.insert(p,m)):!y.isValidDocument()||m.version.compareTo(y.version)>0||m.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(m),d=d.insert(p,m)):Me(p0,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",m.version)})),{Bs:d,Ls:o}}))}function xj(n,e){const s=Et(n);return s.persistence.runTransaction("Allocate target","readwrite",(a=>{let o;return s.li.getTargetData(a,e).next((l=>l?(o=l,we.resolve(o)):s.li.allocateTargetId(a).next((d=>(o=new ci(e,d,"TargetPurposeListen",a.currentSequenceNumber),s.li.addTargetData(a,o).next((()=>o)))))))})).then((a=>{const o=s.vs.get(a.targetId);return(o===null||a.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(s.vs=s.vs.insert(a.targetId,a),s.Fs.set(e,a.targetId)),a}))}async function dg(n,e,s){const a=Et(n),o=a.vs.get(e),l=s?"readwrite":"readwrite-primary";try{s||await a.persistence.runTransaction("Release target",l,(d=>a.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!zl(d))throw d;Me(p0,`Failed to update sequence numbers for target ${e}: ${d}`)}a.vs=a.vs.remove(e),a.Fs.delete(o.target)}function u1(n,e,s){const a=Et(n);let o=st.min(),l=St();return a.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,y,x){const v=Et(m),S=v.Fs.get(x);return S!==void 0?we.resolve(v.vs.get(S)):v.li.getTargetData(y,x)})(a,d,Zr(e)).next((p=>{if(p)return o=p.lastLimboFreeSnapshotVersion,a.li.getMatchingKeysForTargetId(d,p.targetId).next((m=>{l=m}))})).next((()=>a.Cs.getDocumentsMatchingQuery(d,e,s?o:st.min(),s?l:St()))).next((p=>(bj(a,lO(e),p),{documents:p,ks:l})))))}function bj(n,e,s){let a=n.Ms.get(e)||st.min();s.forEach(((o,l)=>{l.readTime.compareTo(a)>0&&(a=l.readTime)})),n.Ms.set(e,a)}class d1{constructor(){this.activeTargetIds=pO()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vj{constructor(){this.vo=new d1,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,s,a){}addLocalQueryTarget(e,s=!0){return s&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,s,a){this.Fo[e]=s}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new d1,Promise.resolve()}handleUserChange(e,s,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f1="ConnectivityMonitor";class h1{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Me(f1,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Me(f1,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fd=null;function fg(){return Fd===null?Fd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Fd++,"0x"+Fd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rm="RestConnection",Ej={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class wj{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const s=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=s+"://"+e.host,this.Uo=`projects/${a}/databases/${o}`,this.$o=this.databaseId.database===hf?`project_id=${a}`:`project_id=${a}&database_id=${o}`}Wo(e,s,a,o,l){const d=fg(),p=this.Qo(e,s.toUriEncodedString());Me(rm,`Sending RPC '${e}' ${d}:`,p,a);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(m,o,l);const{host:y}=new URL(p),x=Jg(y);return this.zo(e,p,m,a,x).then((v=>(Me(rm,`Received RPC '${e}' ${d}: `,v),v)),(v=>{throw So(rm,`RPC '${e}' ${d} failed with error: `,v,"url: ",p,"request:",a),v}))}jo(e,s,a,o,l,d){return this.Wo(e,s,a,o,l)}Go(e,s,a){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Vl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach(((o,l)=>e[l]=o)),a&&a.headers.forEach(((o,l)=>e[l]=o))}Qo(e,s){const a=Ej[e];let o=`${this.qo}/v1/${s}:${a}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es="WebChannelConnection",kc=(n,e,s)=>{n.listen(e,(a=>{try{s(a)}catch(o){setTimeout((()=>{throw o}),0)}}))};class Tl extends wj{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Tl.c_){const e=mS();kc(e,pS.STAT_EVENT,(s=>{s.stat===Zm.PROXY?Me(es,"STAT_EVENT: detected buffering proxy"):s.stat===Zm.NOPROXY&&Me(es,"STAT_EVENT: detected no buffering proxy")})),Tl.c_=!0}}zo(e,s,a,o,l){const d=fg();return new Promise(((p,m)=>{const y=new fS;y.setWithCredentials(!0),y.listenOnce(hS.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Jd.NO_ERROR:const v=y.getResponseJson();Me(es,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(v)),p(v);break;case Jd.TIMEOUT:Me(es,`RPC '${e}' ${d} timed out`),m(new He(Re.DEADLINE_EXCEEDED,"Request time out"));break;case Jd.HTTP_ERROR:const S=y.getStatus();if(Me(es,`RPC '${e}' ${d} failed with status:`,S,"response text:",y.getResponseText()),S>0){let N=y.getResponseJson();Array.isArray(N)&&(N=N[0]);const z=N==null?void 0:N.error;if(z&&z.status&&z.message){const D=(function(P){const F=P.toLowerCase().replace(/_/g,"-");return Object.values(Re).indexOf(F)>=0?F:Re.UNKNOWN})(z.status);m(new He(D,z.message))}else m(new He(Re.UNKNOWN,"Server responded with status "+y.getStatus()))}else m(new He(Re.UNAVAILABLE,"Connection failed."));break;default:at(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{Me(es,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(o);Me(es,`RPC '${e}' ${d} sending request:`,o),y.send(s,"POST",x,a,15)}))}T_(e,s,a){const o=fg(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(p.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,s,a),p.encodeInitMessageHeaders=!0;const y=l.join("");Me(es,`Creating RPC '${e}' stream ${o}: ${y}`,p);const x=d.createWebChannel(y,p);this.I_(x);let v=!1,S=!1;const N=new Sj({Ho:z=>{S?Me(es,`Not sending because RPC '${e}' stream ${o} is closed:`,z):(v||(Me(es,`Opening RPC '${e}' stream ${o} transport.`),x.open(),v=!0),Me(es,`RPC '${e}' stream ${o} sending:`,z),x.send(z))},Jo:()=>x.close()});return kc(x,Dc.EventType.OPEN,(()=>{S||(Me(es,`RPC '${e}' stream ${o} transport opened.`),N.i_())})),kc(x,Dc.EventType.CLOSE,(()=>{S||(S=!0,Me(es,`RPC '${e}' stream ${o} transport closed`),N.o_(),this.E_(x))})),kc(x,Dc.EventType.ERROR,(z=>{S||(S=!0,So(es,`RPC '${e}' stream ${o} transport errored. Name:`,z.name,"Message:",z.message),N.o_(new He(Re.UNAVAILABLE,"The operation could not be completed")))})),kc(x,Dc.EventType.MESSAGE,(z=>{var D;if(!S){const j=z.data[0];tn(!!j,16349);const P=j,F=(P==null?void 0:P.error)||((D=P[0])==null?void 0:D.error);if(F){Me(es,`RPC '${e}' stream ${o} received error:`,F);const G=F.status;let H=(function(I){const T=In[I];if(T!==void 0)return zS(T)})(G),W=F.message;G==="NOT_FOUND"&&W.includes("database")&&W.includes("does not exist")&&W.includes(this.databaseId.database)&&So(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),H===void 0&&(H=Re.INTERNAL,W="Unknown error status: "+G+" with message "+F.message),S=!0,N.o_(new He(H,W)),x.close()}else Me(es,`RPC '${e}' stream ${o} received:`,j),N.__(j)}})),Tl.u_(),setTimeout((()=>{N.s_()}),0),N}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((s=>s===e))}Go(e,s,a){super.Go(e,s,a),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return gS()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tj(n){return new Tl(n)}function am(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JS(n){return new jO(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tl.c_=!1;class eT{constructor(e,s,a=1e3,o=1.5,l=6e4){this.Ci=e,this.timerId=s,this.R_=a,this.A_=o,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const s=Math.floor(this.d_+this.y_()),a=Math.max(0,Date.now()-this.f_),o=Math.max(0,s-a);o>0&&Me("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${s} ms, last attempt: ${a} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1="PersistentStream";class Aj{constructor(e,s,a,o,l,d,p,m){this.Ci=e,this.b_=a,this.S_=o,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new eT(e,s)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,s){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():s&&s.code===Re.RESOURCE_EXHAUSTED?(La(s.toString()),La("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):s&&s.code===Re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(s)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),s=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([a,o])=>{this.D_===s&&this.G_(a,o)}),(a=>{e((()=>{const o=new He(Re.UNKNOWN,"Fetching auth token failed: "+a.message);return this.z_(o)}))}))}G_(e,s){const a=this.Q_(this.D_);this.stream=this.j_(e,s),this.stream.Zo((()=>{a((()=>this.listener.Zo()))})),this.stream.Yo((()=>{a((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{a((()=>this.z_(o)))})),this.stream.onMessage((o=>{a((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Me(p1,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return s=>{this.Ci.enqueueAndForget((()=>this.D_===e?s():(Me(p1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Ij extends Aj{constructor(e,s,a,o,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",s,a,o,d),this.serializer=l}j_(e,s){return this.connection.T_("Listen",e,s)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const s=UO(this.serializer,e),a=(function(l){if(!("targetChange"in l))return st.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?st.min():d.readTime?Sl(d.readTime):st.min()})(e);return this.listener.J_(s,a)}Z_(e){const s={};s.database=i1(this.serializer),s.addTarget=(function(l,d){let p;const m=d.target;if(p=ag(m)?{documents:PO(l,m)}:{query:VO(l,m).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=LO(l,d.resumeToken);const y=cg(l,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(st.min())>0){p.readTime=kO(l,d.snapshotVersion.toTimestamp());const y=cg(l,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const a=BO(this.serializer,e);a&&(s.labels=a),this.K_(s)}X_(e){const s={};s.database=i1(this.serializer),s.removeTarget=e,this.K_(s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{}class Cj extends Nj{constructor(e,s,a,o){super(),this.authCredentials=e,this.appCheckCredentials=s,this.connection=a,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new He(Re.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,s,a,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,ug(s,a),o,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new He(Re.UNKNOWN,l.toString())}))}jo(e,s,a,o,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,ug(s,a),o,d,p,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new He(Re.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function Rj(n,e,s,a){return new Cj(n,e,s,a)}class Oj{constructor(e,s){this.asyncQueue=e,this.onlineStateHandler=s,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const s=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(La(s),this.aa=!1):Me("OnlineStateTracker",s)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dl="RemoteStore";class jj{constructor(e,s,a,o,l){this.localStore=e,this.datastore=s,this.asyncQueue=a,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((d=>{a.enqueueAndForget((async()=>{vu(this)&&(Me(Dl,"Restarting streams for network reachability change."),await(async function(m){const y=Et(m);y.Ea.add(4),await bu(y),y.Va.set("Unknown"),y.Ea.delete(4),await zf(y)})(this))}))})),this.Va=new Oj(a,o)}}async function zf(n){if(vu(n))for(const e of n.Ra)await e(!0)}async function bu(n){for(const e of n.Ra)await e(!1)}function tT(n,e){const s=Et(n);s.Ia.has(e.targetId)||(s.Ia.set(e.targetId,e),x0(s)?y0(s):Bl(s).O_()&&g0(s,e))}function m0(n,e){const s=Et(n),a=Bl(s);s.Ia.delete(e),a.O_()&&nT(s,e),s.Ia.size===0&&(a.O_()?a.L_():vu(s)&&s.Va.set("Unknown"))}function g0(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(st.min())>0){const s=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(s)}Bl(n).Z_(e)}function nT(n,e){n.da.$e(e),Bl(n).X_(e)}function y0(n){n.da=new NO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Bl(n).start(),n.Va.ua()}function x0(n){return vu(n)&&!Bl(n).x_()&&n.Ia.size>0}function vu(n){return Et(n).Ea.size===0}function sT(n){n.da=void 0}async function kj(n){n.Va.set("Online")}async function Lj(n){n.Ia.forEach(((e,s)=>{g0(n,e)}))}async function Mj(n,e){sT(n),x0(n)?(n.Va.ha(e),y0(n)):n.Va.set("Unknown")}async function Dj(n,e,s){if(n.Va.set("Online"),e instanceof FS&&e.state===2&&e.cause)try{await(async function(o,l){const d=l.cause;for(const p of l.targetIds)o.Ia.has(p)&&(await o.remoteSyncer.rejectListen(p,d),o.Ia.delete(p),o.da.removeTarget(p))})(n,e)}catch(a){Me(Dl,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await m1(n,a)}else if(e instanceof nf?n.da.Xe(e):e instanceof BS?n.da.st(e):n.da.tt(e),!s.isEqual(st.min()))try{const a=await XS(n.localStore);s.compareTo(a)>=0&&await(function(l,d){const p=l.da.Tt(d);return p.targetChanges.forEach(((m,y)=>{if(m.resumeToken.approximateByteSize()>0){const x=l.Ia.get(y);x&&l.Ia.set(y,x.withResumeToken(m.resumeToken,d))}})),p.targetMismatches.forEach(((m,y)=>{const x=l.Ia.get(m);if(!x)return;l.Ia.set(m,x.withResumeToken(Kn.EMPTY_BYTE_STRING,x.snapshotVersion)),nT(l,m);const v=new ci(x.target,m,y,x.sequenceNumber);g0(l,v)})),l.remoteSyncer.applyRemoteEvent(p)})(n,s)}catch(a){Me(Dl,"Failed to raise snapshot:",a),await m1(n,a)}}async function m1(n,e,s){if(!zl(e))throw e;n.Ea.add(1),await bu(n),n.Va.set("Offline"),s||(s=()=>XS(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Me(Dl,"Retrying IndexedDB access"),await s(),n.Ea.delete(1),await zf(n)}))}async function g1(n,e){const s=Et(n);s.asyncQueue.verifyOperationInProgress(),Me(Dl,"RemoteStore received new credentials");const a=vu(s);s.Ea.add(3),await bu(s),a&&s.Va.set("Unknown"),await s.remoteSyncer.handleCredentialChange(e),s.Ea.delete(3),await zf(s)}async function Uj(n,e){const s=Et(n);e?(s.Ea.delete(2),await zf(s)):e||(s.Ea.add(2),await bu(s),s.Va.set("Unknown"))}function Bl(n){return n.ma||(n.ma=(function(s,a,o){const l=Et(s);return l.sa(),new Ij(a,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Zo:kj.bind(null,n),Yo:Lj.bind(null,n),t_:Mj.bind(null,n),J_:Dj.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),x0(n)?y0(n):n.Va.set("Unknown")):(await n.ma.stop(),sT(n))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b0{constructor(e,s,a,o,l){this.asyncQueue=e,this.timerId=s,this.targetTimeMs=a,this.op=o,this.removalCallback=l,this.deferred=new fo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,s,a,o,l){const d=Date.now()+a,p=new b0(e,s,d,o,l);return p.start(a),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new He(Re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rT(n,e){if(La("AsyncQueue",`${e}: ${n}`),zl(n))return new He(Re.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{static emptySet(e){return new Al(e.comparator)}constructor(e){this.comparator=e?(s,a)=>e(s,a)||Ke.comparator(s.key,a.key):(s,a)=>Ke.comparator(s.key,a.key),this.keyedMap=Uc(),this.sortedSet=new vn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const s=this.keyedMap.get(e);return s?this.sortedSet.indexOf(s):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((s,a)=>(e(s),!1)))}add(e){const s=this.delete(e.key);return s.copy(s.keyedMap.insert(e.key,e),s.sortedSet.insert(e,null))}delete(e){const s=this.get(e);return s?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(s)):this}isEqual(e){if(!(e instanceof Al)||this.size!==e.size)return!1;const s=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;s.hasNext();){const o=s.getNext().key,l=a.getNext().key;if(!o.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((s=>{e.push(s.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,s){const a=new Al;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=s,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(){this.ga=new vn(Ke.comparator)}track(e){const s=e.doc.key,a=this.ga.get(s);a?e.type!==0&&a.type===3?this.ga=this.ga.insert(s,e):e.type===3&&a.type!==1?this.ga=this.ga.insert(s,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.ga=this.ga.insert(s,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.ga=this.ga.insert(s,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.ga=this.ga.remove(s):e.type===1&&a.type===2?this.ga=this.ga.insert(s,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.ga=this.ga.insert(s,{type:2,doc:e.doc}):at(63341,{Vt:e,pa:a}):this.ga=this.ga.insert(s,e)}ya(){const e=[];return this.ga.inorderTraversal(((s,a)=>{e.push(a)})),e}}class Ul{constructor(e,s,a,o,l,d,p,m,y){this.query=e,this.docs=s,this.oldDocs=a,this.docChanges=o,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=m,this.hasCachedResults=y}static fromInitialDocuments(e,s,a,o,l){const d=[];return s.forEach((p=>{d.push({type:0,doc:p})})),new Ul(e,s,Al.emptySet(s),d,a,o,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Mf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const s=this.docChanges,a=e.docChanges;if(s.length!==a.length)return!1;for(let o=0;o<s.length;o++)if(s[o].type!==a[o].type||!s[o].doc.isEqual(a[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pj{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class Vj{constructor(){this.queries=x1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(s,a){const o=Et(s),l=o.queries;o.queries=x1(),l.forEach(((d,p)=>{for(const m of p.ba)m.onError(a)}))})(this,new He(Re.ABORTED,"Firestore shutting down"))}}function x1(){return new Io((n=>OS(n)),Mf)}async function zj(n,e){const s=Et(n);let a=3;const o=e.query;let l=s.queries.get(o);l?!l.Sa()&&e.Da()&&(a=2):(l=new Pj,a=e.Da()?0:1);try{switch(a){case 0:l.wa=await s.onListen(o,!0);break;case 1:l.wa=await s.onListen(o,!1);break;case 2:await s.onFirstRemoteStoreListen(o)}}catch(d){const p=rT(d,`Initialization of query '${hl(e.query)}' failed`);return void e.onError(p)}s.queries.set(o,l),l.ba.push(e),e.va(s.onlineState),l.wa&&e.Fa(l.wa)&&v0(s)}async function Bj(n,e){const s=Et(n),a=e.query;let o=3;const l=s.queries.get(a);if(l){const d=l.ba.indexOf(e);d>=0&&(l.ba.splice(d,1),l.ba.length===0?o=e.Da()?0:1:!l.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return s.queries.delete(a),s.onUnlisten(a,!0);case 1:return s.queries.delete(a),s.onUnlisten(a,!1);case 2:return s.onLastRemoteStoreUnlisten(a);default:return}}function Fj(n,e){const s=Et(n);let a=!1;for(const o of e){const l=o.query,d=s.queries.get(l);if(d){for(const p of d.ba)p.Fa(o)&&(a=!0);d.wa=o}}a&&v0(s)}function Hj(n,e,s){const a=Et(n),o=a.queries.get(e);if(o)for(const l of o.ba)l.onError(s);a.queries.delete(e)}function v0(n){n.Ca.forEach((e=>{e.next()}))}var hg,b1;(b1=hg||(hg={})).Ma="default",b1.Cache="cache";class Gj{constructor(e,s,a){this.query=e,this.xa=s,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=a||{}}Fa(e){if(!this.options.includeMetadataChanges){const a=[];for(const o of e.docChanges)o.type!==3&&a.push(o);e=new Ul(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let s=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),s=!0):this.La(e,this.onlineState)&&(this.ka(e),s=!0),this.Na=e,s}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let s=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),s=!0),s}La(e,s){if(!e.fromCache||!this.Da())return!0;const a=s!=="Offline";return(!this.options.Ka||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||s==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const s=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!s)&&this.options.includeMetadataChanges===!0}ka(e){e=Ul.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==hg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aT{constructor(e){this.key=e}}class iT{constructor(e){this.key=e}}class qj{constructor(e,s){this.query=e,this.Za=s,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=St(),this.mutatedKeys=St(),this.eu=jS(e),this.tu=new Al(this.eu)}get nu(){return this.Za}ru(e,s){const a=s?s.iu:new y1,o=s?s.tu:this.tu;let l=s?s.mutatedKeys:this.mutatedKeys,d=o,p=!1;const m=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,y=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((x,v)=>{const S=o.get(x),N=Df(this.query,v)?v:null,z=!!S&&this.mutatedKeys.has(S.key),D=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let j=!1;S&&N?S.data.isEqual(N.data)?z!==D&&(a.track({type:3,doc:N}),j=!0):this.su(S,N)||(a.track({type:2,doc:N}),j=!0,(m&&this.eu(N,m)>0||y&&this.eu(N,y)<0)&&(p=!0)):!S&&N?(a.track({type:0,doc:N}),j=!0):S&&!N&&(a.track({type:1,doc:S}),j=!0,(m||y)&&(p=!0)),j&&(N?(d=d.add(N),l=D?l.add(x):l.delete(x)):(d=d.delete(x),l=l.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),l=l.delete(x.key),a.track({type:1,doc:x})}return{tu:d,iu:a,Ss:p,mutatedKeys:l}}su(e,s){return e.hasLocalMutations&&s.hasCommittedMutations&&!s.hasLocalMutations}applyChanges(e,s,a,o){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((x,v)=>(function(N,z){const D=j=>{switch(j){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return at(20277,{Vt:j})}};return D(N)-D(z)})(x.type,v.type)||this.eu(x.doc,v.doc))),this.ou(a),o=o??!1;const p=s&&!o?this._u():[],m=this.Ya.size===0&&this.current&&!o?1:0,y=m!==this.Xa;return this.Xa=m,d.length!==0||y?{snapshot:new Ul(this.query,e.tu,l,d,e.mutatedKeys,m===0,y,!1,!!a&&a.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new y1,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((s=>this.Za=this.Za.add(s))),e.modifiedDocuments.forEach((s=>{})),e.removedDocuments.forEach((s=>this.Za=this.Za.delete(s))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=St(),this.tu.forEach((a=>{this.uu(a.key)&&(this.Ya=this.Ya.add(a.key))}));const s=[];return e.forEach((a=>{this.Ya.has(a)||s.push(new iT(a))})),this.Ya.forEach((a=>{e.has(a)||s.push(new aT(a))})),s}cu(e){this.Za=e.ks,this.Ya=St();const s=this.ru(e.documents);return this.applyChanges(s,!0)}lu(){return Ul.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const _0="SyncEngine";class $j{constructor(e,s,a){this.query=e,this.targetId=s,this.view=a}}class Yj{constructor(e){this.key=e,this.hu=!1}}class Qj{constructor(e,s,a,o,l,d){this.localStore=e,this.remoteStore=s,this.eventManager=a,this.sharedClientState=o,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new Io((p=>OS(p)),Mf),this.Iu=new Map,this.Eu=new Set,this.Ru=new vn(Ke.comparator),this.Au=new Map,this.Vu=new d0,this.du={},this.mu=new Map,this.fu=Ml.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Wj(n,e,s=!0){const a=dT(n);let o;const l=a.Tu.get(e);return l?(a.sharedClientState.addLocalQueryTarget(l.targetId),o=l.view.lu()):o=await oT(a,e,s,!0),o}async function Kj(n,e){const s=dT(n);await oT(s,e,!0,!1)}async function oT(n,e,s,a){const o=await xj(n.localStore,Zr(e)),l=o.targetId,d=n.sharedClientState.addLocalQueryTarget(l,s);let p;return a&&(p=await Zj(n,e,l,d==="current",o.resumeToken)),n.isPrimaryClient&&s&&tT(n.remoteStore,o),p}async function Zj(n,e,s,a,o){n.pu=(v,S,N)=>(async function(D,j,P,F){let G=j.view.ru(P);G.Ss&&(G=await u1(D.localStore,j.query,!1).then((({documents:I})=>j.view.ru(I,G))));const H=F&&F.targetChanges.get(j.targetId),W=F&&F.targetMismatches.get(j.targetId)!=null,Q=j.view.applyChanges(G,D.isPrimaryClient,H,W);return _1(D,j.targetId,Q.au),Q.snapshot})(n,v,S,N);const l=await u1(n.localStore,e,!0),d=new qj(e,l.ks),p=d.ru(l.documents),m=xu.createSynthesizedTargetChangeForCurrentChange(s,a&&n.onlineState!=="Offline",o),y=d.applyChanges(p,n.isPrimaryClient,m);_1(n,s,y.au);const x=new $j(e,s,d);return n.Tu.set(e,x),n.Iu.has(s)?n.Iu.get(s).push(e):n.Iu.set(s,[e]),y.snapshot}async function Xj(n,e,s){const a=Et(n),o=a.Tu.get(e),l=a.Iu.get(o.targetId);if(l.length>1)return a.Iu.set(o.targetId,l.filter((d=>!Mf(d,e)))),void a.Tu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(o.targetId),a.sharedClientState.isActiveQueryTarget(o.targetId)||await dg(a.localStore,o.targetId,!1).then((()=>{a.sharedClientState.clearQueryState(o.targetId),s&&m0(a.remoteStore,o.targetId),pg(a,o.targetId)})).catch(Rf)):(pg(a,o.targetId),await dg(a.localStore,o.targetId,!0))}async function Jj(n,e){const s=Et(n),a=s.Tu.get(e),o=s.Iu.get(a.targetId);s.isPrimaryClient&&o.length===1&&(s.sharedClientState.removeLocalQueryTarget(a.targetId),m0(s.remoteStore,a.targetId))}async function lT(n,e){const s=Et(n);try{const a=await gj(s.localStore,e);e.targetChanges.forEach(((o,l)=>{const d=s.Au.get(l);d&&(tn(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?tn(d.hu,14607):o.removedDocuments.size>0&&(tn(d.hu,42227),d.hu=!1))})),await uT(s,a,e)}catch(a){await Rf(a)}}function v1(n,e,s){const a=Et(n);if(a.isPrimaryClient&&s===0||!a.isPrimaryClient&&s===1){const o=[];a.Tu.forEach(((l,d)=>{const p=d.view.va(e);p.snapshot&&o.push(p.snapshot)})),(function(d,p){const m=Et(d);m.onlineState=p;let y=!1;m.queries.forEach(((x,v)=>{for(const S of v.ba)S.va(p)&&(y=!0)})),y&&v0(m)})(a.eventManager,e),o.length&&a.Pu.J_(o),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function ek(n,e,s){const a=Et(n);a.sharedClientState.updateQueryState(e,"rejected",s);const o=a.Au.get(e),l=o&&o.key;if(l){let d=new vn(Ke.comparator);d=d.insert(l,rs.newNoDocument(l,st.min()));const p=St().add(l),m=new Vf(st.min(),new Map,new vn(xt),d,p);await lT(a,m),a.Ru=a.Ru.remove(l),a.Au.delete(e),E0(a)}else await dg(a.localStore,e,!1).then((()=>pg(a,e,s))).catch(Rf)}function pg(n,e,s=null){n.sharedClientState.removeLocalQueryTarget(e);for(const a of n.Iu.get(e))n.Tu.delete(a),s&&n.Pu.yu(a,s);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((a=>{n.Vu.containsKey(a)||cT(n,a)}))}function cT(n,e){n.Eu.delete(e.path.canonicalString());const s=n.Ru.get(e);s!==null&&(m0(n.remoteStore,s),n.Ru=n.Ru.remove(e),n.Au.delete(s),E0(n))}function _1(n,e,s){for(const a of s)a instanceof aT?(n.Vu.addReference(a.key,e),tk(n,a)):a instanceof iT?(Me(_0,"Document no longer in limbo: "+a.key),n.Vu.removeReference(a.key,e),n.Vu.containsKey(a.key)||cT(n,a.key)):at(19791,{wu:a})}function tk(n,e){const s=e.key,a=s.path.canonicalString();n.Ru.get(s)||n.Eu.has(a)||(Me(_0,"New document in limbo: "+s),n.Eu.add(a),E0(n))}function E0(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const s=new Ke(en.fromString(e)),a=n.fu.next();n.Au.set(a,new Yj(s)),n.Ru=n.Ru.insert(s,a),tT(n.remoteStore,new ci(Zr(o0(s.path)),a,"TargetPurposeLimboResolution",Of.ce))}}async function uT(n,e,s){const a=Et(n),o=[],l=[],d=[];a.Tu.isEmpty()||(a.Tu.forEach(((p,m)=>{d.push(a.pu(m,e,s).then((y=>{var x;if((y||s)&&a.isPrimaryClient){const v=y?!y.fromCache:(x=s==null?void 0:s.targetChanges.get(m.targetId))==null?void 0:x.current;a.sharedClientState.updateQueryState(m.targetId,v?"current":"not-current")}if(y){o.push(y);const v=h0.Es(m.targetId,y);l.push(v)}})))})),await Promise.all(d),a.Pu.J_(o),await(async function(m,y){const x=Et(m);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>we.forEach(y,(S=>we.forEach(S.Ts,(N=>x.persistence.referenceDelegate.addReference(v,S.targetId,N))).next((()=>we.forEach(S.Is,(N=>x.persistence.referenceDelegate.removeReference(v,S.targetId,N)))))))))}catch(v){if(!zl(v))throw v;Me(p0,"Failed to update sequence numbers: "+v)}for(const v of y){const S=v.targetId;if(!v.fromCache){const N=x.vs.get(S),z=N.snapshotVersion,D=N.withLastLimboFreeSnapshotVersion(z);x.vs=x.vs.insert(S,D)}}})(a.localStore,l))}async function nk(n,e){const s=Et(n);if(!s.currentUser.isEqual(e)){Me(_0,"User change. New user:",e.toKey());const a=await ZS(s.localStore,e);s.currentUser=e,(function(l,d){l.mu.forEach((p=>{p.forEach((m=>{m.reject(new He(Re.CANCELLED,d))}))})),l.mu.clear()})(s,"'waitForPendingWrites' promise is rejected due to a user change."),s.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await uT(s,a.Ns)}}function sk(n,e){const s=Et(n),a=s.Au.get(e);if(a&&a.hu)return St().add(a.key);{let o=St();const l=s.Iu.get(e);if(!l)return o;for(const d of l){const p=s.Tu.get(d);o=o.unionWith(p.view.nu)}return o}}function dT(n){const e=Et(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=lT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=sk.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ek.bind(null,e),e.Pu.J_=Fj.bind(null,e.eventManager),e.Pu.yu=Hj.bind(null,e.eventManager),e}class bf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=JS(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,s){return null}Mu(e,s){return null}vu(e){return mj(this.persistence,new fj,e.initialUser,this.serializer)}Cu(e){return new KS(f0.Vi,this.serializer)}Du(e){return new vj}async terminate(){var e,s;(e=this.gcScheduler)==null||e.stop(),(s=this.indexBackfillerScheduler)==null||s.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bf.provider={build:()=>new bf};class rk extends bf{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,s){tn(this.persistence.referenceDelegate instanceof xf,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new ZO(a,e.asyncQueue,s)}Cu(e){const s=this.cacheSizeBytes!==void 0?As.withCacheSize(this.cacheSizeBytes):As.DEFAULT;return new KS((a=>xf.Vi(a,s)),this.serializer)}}class mg{async initialize(e,s){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(s),this.remoteStore=this.createRemoteStore(s),this.eventManager=this.createEventManager(s),this.syncEngine=this.createSyncEngine(s,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>v1(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=nk.bind(null,this.syncEngine),await Uj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Vj})()}createDatastore(e){const s=JS(e.databaseInfo.databaseId),a=Tj(e.databaseInfo);return Rj(e.authCredentials,e.appCheckCredentials,a,s)}createRemoteStore(e){return(function(a,o,l,d,p){return new jj(a,o,l,d,p)})(this.localStore,this.datastore,e.asyncQueue,(s=>v1(this.syncEngine,s,0)),(function(){return h1.v()?new h1:new _j})())}createSyncEngine(e,s){return(function(o,l,d,p,m,y,x){const v=new Qj(o,l,d,p,m,y);return x&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,s)}async terminate(){var e,s;await(async function(o){const l=Et(o);Me(Dl,"RemoteStore shutting down."),l.Ea.add(5),await bu(l),l.Aa.shutdown(),l.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(s=this.eventManager)==null||s.terminate()}}mg.provider={build:()=>new mg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):La("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,s){setTimeout((()=>{this.muted||e(s)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Si="FirestoreClient";class ik{constructor(e,s,a,o,l){this.authCredentials=e,this.appCheckCredentials=s,this.asyncQueue=a,this._databaseInfo=o,this.user=ss.UNAUTHENTICATED,this.clientId=n0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(a,(async d=>{Me(Si,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(a,(d=>(Me(Si,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(s){const a=rT(s,"Failed to shutdown persistence");e.reject(a)}})),e.promise}}async function im(n,e){n.asyncQueue.verifyOperationInProgress(),Me(Si,"Initializing OfflineComponentProvider");const s=n.configuration;await e.initialize(s);let a=s.initialUser;n.setCredentialChangeListener((async o=>{a.isEqual(o)||(await ZS(e.localStore,o),a=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function E1(n,e){n.asyncQueue.verifyOperationInProgress();const s=await ok(n);Me(Si,"Initializing OnlineComponentProvider"),await e.initialize(s,n.configuration),n.setCredentialChangeListener((a=>g1(e.remoteStore,a))),n.setAppCheckTokenChangeListener(((a,o)=>g1(e.remoteStore,o))),n._onlineComponents=e}async function ok(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Me(Si,"Using user provided OfflineComponentProvider");try{await im(n,n._uninitializedComponentsProvider._offline)}catch(e){const s=e;if(!(function(o){return o.name==="FirebaseError"?o.code===Re.FAILED_PRECONDITION||o.code===Re.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(s))throw s;So("Error using user provided cache. Falling back to memory cache: "+s),await im(n,new bf)}}else Me(Si,"Using default OfflineComponentProvider"),await im(n,new rk(void 0));return n._offlineComponents}async function lk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Me(Si,"Using user provided OnlineComponentProvider"),await E1(n,n._uninitializedComponentsProvider._online)):(Me(Si,"Using default OnlineComponentProvider"),await E1(n,new mg))),n._onlineComponents}async function ck(n){const e=await lk(n),s=e.eventManager;return s.onListen=Wj.bind(null,e.syncEngine),s.onUnlisten=Xj.bind(null,e.syncEngine),s.onFirstRemoteStoreListen=Kj.bind(null,e.syncEngine),s.onLastRemoteStoreUnlisten=Jj.bind(null,e.syncEngine),s}function uk(n,e,s={}){const a=new fo;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,p,m,y){const x=new ak({next:S=>{x.Nu(),d.enqueueAndForget((()=>Bj(l,v)));const N=S.docs.has(p);!N&&S.fromCache?y.reject(new He(Re.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&S.fromCache&&m&&m.source==="server"?y.reject(new He(Re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(S)},error:S=>y.reject(S)}),v=new Gj(o0(p.path),x,{includeMetadataChanges:!0,Ka:!0});return zj(l,v)})(await ck(n),n.asyncQueue,e,s,a))),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fT(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk="ComponentProvider",w1=new Map;function fk(n,e,s,a,o){return new BR(n,e,s,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,fT(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT="firestore.googleapis.com",S1=!0;class T1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new He(Re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hT,this.ssl=S1}else this.host=e.host,this.ssl=e.ssl??S1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=WS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WO)throw new He(Re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}IR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fT(e.experimentalLongPollingOptions??{}),(function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new He(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new He(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new He(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(a,o){return a.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class w0{constructor(e,s,a,o){this._authCredentials=e,this._appCheckCredentials=s,this._databaseId=a,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new T1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new He(Re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new He(Re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new T1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(a){if(!a)return new gR;switch(a.type){case"firstParty":return new vR(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new He(Re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(s){const a=w1.get(s);a&&(Me(dk,"Removing Datastore"),w1.delete(s),a.terminate())})(this),Promise.resolve()}}function hk(n,e,s,a={}){var y;n=Jm(n,w0);const o=Jg(e),l=n._getSettings(),d={...l,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${s}`;o&&(FN(`https://${p}`),$N("Firestore",!0)),l.host!==hT&&l.host!==p&&So("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...l,host:p,ssl:o,emulatorOptions:a};if(!uf(m,d)&&(n._setSettings(m),a.mockUserToken)){let x,v;if(typeof a.mockUserToken=="string")x=a.mockUserToken,v=ss.MOCK_USER;else{x=HN(a.mockUserToken,(y=n._app)==null?void 0:y.options.projectId);const S=a.mockUserToken.sub||a.mockUserToken.user_id;if(!S)throw new He(Re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new ss(S)}n._authCredentials=new yR(new xS(x,v))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e,s,a){this.converter=s,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new S0(this.firestore,e,this._query)}}class ps{constructor(e,s,a){this.converter=s,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new uu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ps(this.firestore,e,this._key)}toJSON(){return{type:ps._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,s,a){if(gu(s,ps._jsonSchema))return new ps(e,a||null,new Ke(en.fromString(s.referencePath)))}}ps._jsonSchemaVersion="firestore/documentReference/1.0",ps._jsonSchema={type:Cn("string",ps._jsonSchemaVersion),referencePath:Cn("string")};class uu extends S0{constructor(e,s,a){super(e,s,o0(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ps(this.firestore,null,new Ke(e))}withConverter(e){return new uu(this.firestore,e,this._path)}}function pk(n,e,...s){if(n=rS(n),arguments.length===1&&(e=n0.newId()),AR("doc","path",e),n instanceof w0){const a=en.fromString(e,...s);return Pv(a),new ps(n,null,new Ke(a))}{if(!(n instanceof ps||n instanceof uu))throw new He(Re.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(en.fromString(e,...s));return Pv(a),new ps(n.firestore,n instanceof uu?n.converter:null,new Ke(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A1="AsyncQueue";class I1{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new eT(this,"async_queue_retry"),this._c=()=>{const a=am();a&&Me(A1,"Visibility state changed to "+a.visibilityState),this.M_.w_()},this.ac=e;const s=am();s&&typeof s.addEventListener=="function"&&s.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const s=am();s&&typeof s.removeEventListener=="function"&&s.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const s=new fo;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(s.resolve,s.reject),s.promise))).then((()=>s.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!zl(e))throw e;Me(A1,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const s=this.ac.then((()=>(this.rc=!0,e().catch((a=>{throw this.nc=a,this.rc=!1,La("INTERNAL UNHANDLED ERROR: ",N1(a)),a})).then((a=>(this.rc=!1,a))))));return this.ac=s,s}enqueueAfterDelay(e,s,a){this.uc(),this.oc.indexOf(e)>-1&&(s=0);const o=b0.createAndSchedule(this,e,s,a,(l=>this.hc(l)));return this.tc.push(o),o}uc(){this.nc&&at(47125,{Pc:N1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const s of this.tc)if(s.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((s,a)=>s.targetTimeMs-a.targetTimeMs));for(const s of this.tc)if(s.skipDelay(),e!=="all"&&s.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const s=this.tc.indexOf(e);this.tc.splice(s,1)}}function N1(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class pT extends w0{constructor(e,s,a,o){super(e,s,a,o),this.type="firestore",this._queue=new I1,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new I1(e),this._firestoreClient=void 0,await e}}}function mk(n,e){const s=typeof n=="object"?n:nR(),a=typeof n=="string"?n:hf,o=ZC(s,"firestore").getImmediate({identifier:a});if(!o._initialized){const l=zN("firestore");l&&hk(o,...l)}return o}function gk(n){if(n._terminated)throw new He(Re.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||yk(n),n._firestoreClient}function yk(n){var a,o,l,d;const e=n._freezeSettings(),s=fk(n._databaseId,((a=n._app)==null?void 0:a.options.appId)||"",n._persistenceKey,(o=n._app)==null?void 0:o.options.apiKey,e);n._componentsProvider||(l=e.localCache)!=null&&l._offlineComponentProvider&&((d=e.localCache)!=null&&d._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new ik(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(m){const y=m==null?void 0:m._online.build();return{_offline:m==null?void 0:m._offline.build(y),_online:y}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wr(Kn.fromBase64String(e))}catch(s){throw new He(Re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+s)}}static fromUint8Array(e){return new Wr(Kn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Wr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(gu(e,Wr._jsonSchema))return Wr.fromBase64String(e.bytes)}}Wr._jsonSchemaVersion="firestore/bytes/1.0",Wr._jsonSchema={type:Cn("string",Wr._jsonSchemaVersion),bytes:Cn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT{constructor(...e){for(let s=0;s<e.length;++s)if(e[s].length===0)throw new He(Re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,s){if(!isFinite(e)||e<-90||e>90)throw new He(Re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(s)||s<-180||s>180)throw new He(Re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+s);this._lat=e,this._long=s}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xt(this._lat,e._lat)||xt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:mi._jsonSchemaVersion}}static fromJSON(e){if(gu(e,mi._jsonSchema))return new mi(e.latitude,e.longitude)}}mi._jsonSchemaVersion="firestore/geoPoint/1.0",mi._jsonSchema={type:Cn("string",mi._jsonSchemaVersion),latitude:Cn("number"),longitude:Cn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e){this._values=(e||[]).map((s=>s))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(a,o){if(a.length!==o.length)return!1;for(let l=0;l<a.length;++l)if(a[l]!==o[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:gi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(gu(e,gi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((s=>typeof s=="number")))return new gi(e.vectorValues);throw new He(Re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}gi._jsonSchemaVersion="firestore/vectorValue/1.0",gi._jsonSchema={type:Cn("string",gi._jsonSchemaVersion),vectorValues:Cn("object")};function gT(n,e,s){if((e=rS(e))instanceof mT)return e._internalPath;if(typeof e=="string")return bk(n,e);throw gg("Field path arguments must be of type string or ",n)}const xk=new RegExp("[~\\*/\\[\\]]");function bk(n,e,s){if(e.search(xk)>=0)throw gg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new mT(...e.split("."))._internalPath}catch{throw gg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function gg(n,e,s,a,o){let l=`Function ${e}() called with invalid data`;l+=". ";let d="";return new He(Re.INVALID_ARGUMENT,l+n+d)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{convertValue(e,s="none"){switch(Ei(e)){case 0:return null;case 1:return e.booleanValue;case 2:return bn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,s);case 5:return e.stringValue;case 6:return this.convertBytes(_i(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,s);case 11:return this.convertObject(e.mapValue,s);case 10:return this.convertVectorValue(e.mapValue);default:throw at(62114,{value:e})}}convertObject(e,s){return this.convertObjectMap(e.fields,s)}convertObjectMap(e,s="none"){const a={};return yu(e,((o,l)=>{a[o]=this.convertValue(l,s)})),a}convertVectorValue(e){var a,o,l;const s=(l=(o=(a=e.fields)==null?void 0:a[tg].arrayValue)==null?void 0:o.values)==null?void 0:l.map((d=>bn(d.doubleValue)));return new gi(s)}convertGeoPoint(e){return new mi(bn(e.latitude),bn(e.longitude))}convertArray(e,s){return(e.values||[]).map((a=>this.convertValue(a,s)))}convertServerTimestamp(e,s){switch(s){case"previous":const a=kf(e);return a==null?null:this.convertValue(a,s);case"estimate":return this.convertTimestamp(ou(e));default:return null}}convertTimestamp(e){const s=vi(e);return new Nn(s.seconds,s.nanos)}convertDocumentKey(e,s){const a=en.fromString(e);tn(QS(a),9688,{name:e});const o=new lu(a.get(1),a.get(3)),l=new Ke(a.popFirst(5));return o.isEqual(s)||La(`Document ${l} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${s.projectId}/${s.database}) instead.`),l}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k extends vk{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wr(e)}convertReference(e){const s=this.convertDocumentKey(e,this.firestore._databaseId);return new ps(this.firestore,null,s)}}const C1="@firebase/firestore",R1="4.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(e,s,a,o,l){this._firestore=e,this._userDataWriter=s,this._key=a,this._document=o,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new ps(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Ek(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const s=this._document.data.field(gT("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s)}}}class Ek extends yT{data(){return super.data()}}class Vc{constructor(e,s){this.hasPendingWrites=e,this.fromCache=s}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class po extends yT{constructor(e,s,a,o,l,d){super(e,s,a,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const s=new sf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(s,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,s={}){if(this._document){const a=this._document.data.field(gT("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,s.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new He(Re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,s={};return s.type=po._jsonSchemaVersion,s.bundle="",s.bundleSource="DocumentSnapshot",s.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?s:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),s.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),s)}}po._jsonSchemaVersion="firestore/documentSnapshot/1.0",po._jsonSchema={type:Cn("string",po._jsonSchemaVersion),bundleSource:Cn("string","DocumentSnapshot"),bundleName:Cn("string"),bundle:Cn("string")};class sf extends po{data(e={}){return super.data(e)}}class eu{constructor(e,s,a,o){this._firestore=e,this._userDataWriter=s,this._snapshot=o,this.metadata=new Vc(o.hasPendingWrites,o.fromCache),this.query=a}get docs(){const e=[];return this.forEach((s=>e.push(s))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,s){this._snapshot.docs.forEach((a=>{e.call(s,new sf(this._firestore,this._userDataWriter,a.key,a,new Vc(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const s=!!e.includeMetadataChanges;if(s&&this._snapshot.excludesMetadataChanges)throw new He(Re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===s||(this._cachedChanges=(function(o,l){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((p=>{const m=new sf(o._firestore,o._userDataWriter,p.doc.key,p.doc,new Vc(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);return p.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((p=>l||p.type!==3)).map((p=>{const m=new sf(o._firestore,o._userDataWriter,p.doc.key,p.doc,new Vc(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);let y=-1,x=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),x=d.indexOf(p.doc.key)),{type:wk(p.type),doc:m,oldIndex:y,newIndex:x}}))}})(this,s),this._cachedChangesIncludeMetadataChanges=s),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new He(Re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=eu._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=n0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const s=[],a=[],o=[];return this.docs.forEach((l=>{l._document!==null&&(s.push(l._document),a.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),o.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function wk(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return at(61501,{type:n})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */eu._jsonSchemaVersion="firestore/querySnapshot/1.0",eu._jsonSchema={type:Cn("string",eu._jsonSchemaVersion),bundleSource:Cn("string","QuerySnapshot"),bundleName:Cn("string"),bundle:Cn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sk(n){n=Jm(n,ps);const e=Jm(n.firestore,pT),s=gk(e);return uk(s,n._key).then((a=>Tk(e,n,a)))}function Tk(n,e,s){const a=s.docs.get(e._key),o=new _k(n);return new po(n,o,e._key,a,new Vc(s.hasPendingWrites,s.fromCache),e.converter)}(function(e,s=!0){mR(tR),ff(new ru("firestore",((a,{instanceIdentifier:o,options:l})=>{const d=a.getProvider("app").getImmediate(),p=new pT(new xR(a.getProvider("auth-internal")),new _R(d,a.getProvider("app-check-internal")),FR(d,o),d);return l={useFetchStreams:s,...l},p._setSettings(l),p}),"PUBLIC").setMultipleInstances(!0)),wl(C1,R1,e),wl(C1,R1,"esm2020")})();const Ak={apiKey:"...",authDomain:"...",projectId:"vocabpro-5604c"},Ik=lS(Ak),Nk=mk(Ik);async function O1(){try{console.log("Attempting to get current host from Firebase...");const n=pk(Nk,"vocabpro","server");console.log("Fetching document from Firestore...");const e=await Sk(n);if(console.log("Received response from Firestore:",e.exists()?e.data():"No document"),!e.exists())return console.log("Document does not exist"),null;const s=e.data();return{host:s.host||null,local:s.local||null}}catch(n){return console.error("Firebase error:",n),null}}const Ck=()=>{const{showToast:n}=ea(),{currentUser:e,isLoaded:s,handleLogin:a,handleUpdateUser:o,setCurrentUser:l,shouldSkipAuth:d}=EN(),[p,m]=M.useState("AUTH"),[y,x]=M.useState(!1),[v,S]=M.useState(null),[N,z]=M.useState(null),[D,j]=M.useState(!1),[P,F]=M.useState(Date.now()),[G,H]=M.useState("disconnected"),[W,Q]=M.useState(""),[I,T]=M.useState(()=>wt().server.useCustomUrl?"outside":"home"),[_,C]=M.useState(null),[R,L]=M.useState(!1),[O,_e]=M.useState(!1),[ye,B]=M.useState("idle"),[le,se]=M.useState(""),[Z,Y]=M.useState(null),A=M.useRef(!1),V=M.useRef(!1),q=M.useRef(null),[X,de]=M.useState(null),[ce,fe]=M.useState(!1),ie=M.useRef(!1),[Ae,he]=M.useState(!1),[xe,je]=M.useState(!1),[pe,Ie]=M.useState(null),[Le,Te]=M.useState(null),[me,et]=M.useState(null),Xe=M.useCallback(()=>et(null),[]),[re,Fe]=M.useState(null),rt=M.useCallback(()=>Fe(null),[]),[Tt,Ze]=M.useState(null),tt=M.useCallback(()=>Ze(null),[]),[ut,At]=M.useState(null),Ht=M.useCallback(()=>At(null),[]),[fr,hr]=M.useState(null),Cs=M.useCallback(()=>hr(null),[]),[ys,pn]=M.useState(null),be=M.useCallback(()=>pn(null),[]),[De,Ne]=M.useState([]),[bt,it]=M.useState(!1),Ge=M.useRef(!1),[It,dt]=M.useState(!1),[Je,Qt]=M.useState(""),{sessionWords:gt,setSessionWords:rn,sessionType:xs,sessionFocus:bs,startSession:Wt,clearSessionState:Hn}=wN({setView:m,setIsSidebarOpen:x}),{stats:ta,wotd:Hs,apiUsage:na,refreshGlobalStats:Lr,isWotdComposed:sa,randomizeWotd:pr}=NN({currentUser:e,onUpdateUser:o}),Rs=M.useCallback(async(Oe,ke)=>{const Be=new AbortController,Ve=setTimeout(()=>Be.abort(),1200),Ye=()=>Be.abort();ke==null||ke.addEventListener("abort",Ye);try{const $e=await fetch(`${Oe}/api/health`,{signal:Be.signal,mode:"cors"});return clearTimeout(Ve),ke==null||ke.removeEventListener("abort",Ye),$e.ok}catch($e){clearTimeout(Ve),ke==null||ke.removeEventListener("abort",Ye);const Qe=$e&&$e.message?String($e.message).toLowerCase():"";return Oe.startsWith("https://")&&!Be.signal.aborted&&(Qe.includes("certificate")||Qe.includes("ssl")||Qe.includes("secure"))?(console.warn("[SSL] Confirmed certificate issue at:",Oe,$e),Y(Oe),"ssl_error"):!1}},[]),mn=M.useCallback(async(Oe=!1,ke,Be=!1,Ve)=>{if(V.current)return console.log("[AutoConnect] Skip: already connecting"),!1;V.current=!0;const Ye=wt();let $e;if(I==="home"){const Qe={...Ye,server:{...Ye.server,useCustomUrl:!1}};$e=Bn(Qe)}else $e=ke||Bn(Ye);if(Q($e),!Be){se($e);const Qe=await Rs($e,Ve);if(Qe===!0){if(H("connected"),Ye.sync.autoBackupEnabled||qr({...Ye,sync:{...Ye.sync,autoBackupEnabled:!0}},!0),ke){const kt={...Ye,server:{...Ye.server,useCustomUrl:!0,customUrl:ke},sync:{...Ye.sync,autoBackupEnabled:!0}};qr(kt,!0),n(`Connected to ${ke}`,"success")}return V.current=!1,!0}if(Qe==="ssl_error")return console.warn("[AutoConnect] SSL error during initial attempt. Hard stop."),H("disconnected"),V.current=!1,!1}if(!ke&&Oe||Be){if(Ve!=null&&Ve.aborted)return!1;try{const Qe=await O1();if(console.log("[AutoConnect] Firebase data:",Qe),Qe!=null&&Qe.local){console.log("[AutoConnect] Firebase LOCAL raw:",Qe.local);const kt=new URL(Qe.local),On=kt.port||"443",Gt=`https://localhost:${On}`;console.log("[AutoConnect] Trying LOCALHOST first:",Gt),se(Gt);let cn=await Rs(Gt,Ve);if(console.log("[AutoConnect] LOCALHOST result:",cn),cn===!0){Q(Gt),H("connected"),T("home");const Un={...Ye,server:{...Ye.server,host:"localhost",port:Number(On)||443,useCustomUrl:!1,customUrl:""}};return qr(Un,!0),n(`Connected to ${Gt}`,"success"),V.current=!1,!0}if(cn==="ssl_error")return console.warn("[AutoConnect] SSL error at localhost. Hard stop."),H("disconnected"),V.current=!1,!1;if(console.log("[AutoConnect] Fallback to Firebase LOCAL hostname:",Qe.local),se(Qe.local),cn=await Rs(Qe.local,Ve),console.log("[AutoConnect] Firebase LOCAL result:",cn),cn===!0){Q(Qe.local),H("connected"),T("home");const Un={...Ye,server:{...Ye.server,host:kt.hostname,port:Number(On)||443,useCustomUrl:!1,customUrl:""}};return qr(Un,!0),n(`Connected to ${Qe.local}`,"success"),V.current=!1,!0}if(cn==="ssl_error")return console.warn("[AutoConnect] SSL error detected. Hard stop."),H("disconnected"),V.current=!1,!1}if(!Z&&(Qe!=null&&Qe.host)){console.log("[AutoConnect] Trying PUBLIC:",Qe.host),se(Qe.host);const kt=await Rs(Qe.host,Ve);if(console.log("[AutoConnect] PUBLIC result:",kt),kt){Q(Qe.host),H("connected"),T("outside");const On={...Ye,server:{...Ye.server,useCustomUrl:!0,customUrl:Qe.host}};return qr(On,!0),n(`Connected to ${Qe.host}`,"success"),V.current=!1,!0}}}catch(Qe){console.warn("[Firebase] Failed to fetch host:",Qe)}}return Ve!=null&&Ve.aborted||H("disconnected"),V.current=!1,!1},[n,I,Rs,Z]),is=M.useCallback(async Oe=>{if(R||V.current)return!1;L(!0),C(Oe),B("scanning");try{const ke=await O1(),Be=wt();if(Oe==="home"){if(!(ke!=null&&ke.local))return n("Home server URL not found on Firebase.","error"),B("failed"),!1;const Qe=new URL(ke.local).port||"443",kt=[`https://localhost:${Qe}`,ke.local];for(const On of kt){se(On);const Gt=await Rs(On);if(Gt===!0){const cn=new URL(On),Un={...Be,server:{...Be.server,host:cn.hostname,port:Number(cn.port||Qe)||443,useCustomUrl:!1,customUrl:""}};return qr(Un,!0),T("home"),Q(On),H("connected"),B("success"),n(`Connected to ${On}`,"success"),!0}if(Gt==="ssl_error")return B("failed"),!1}return n("Failed to switch to Home server.","error"),C(null),B("failed"),!1}if(!(ke!=null&&ke.host))return n("Public server URL not found on Firebase.","error"),C(null),B("failed"),!1;se(ke.host);const Ve=await Rs(ke.host);if(Ve!==!0)return Ve!=="ssl_error"&&(n("Failed to switch to Public server.","error"),C(null)),B("failed"),!1;const Ye={...Be,server:{...Be.server,useCustomUrl:!0,customUrl:ke.host}};return qr(Ye,!0),T("outside"),Q(ke.host),H("connected"),C(null),B("success"),n(`Connected to ${ke.host}`,"success"),!0}catch(ke){return console.warn("[ServerToggle] Failed to switch mode:",ke),n("Failed to switch server mode.","error"),C(null),B("failed"),!1}finally{L(!1)}},[R,Rs,n]),an=M.useCallback(async()=>{if(_){await is(_);return}await mn(!0)},[_,is,mn]),_n=async Oe=>{if(Oe)T("outside");else{T("home");const Be=wt(),Ve={...Be,server:{...Be.server,useCustomUrl:!1,customUrl:""}};qr(Ve,!0)}q.current&&q.current.abort(),q.current=new AbortController;const ke=q.current.signal;B("scanning");try{await new Promise((Ve,Ye)=>{const $e=setTimeout(Ve,800);ke.addEventListener("abort",()=>{clearTimeout($e),Ye(new Error("aborted"))})});const Be=await mn(!Oe,Oe,!Oe,ke);return ke.aborted?!1:Be?(B("success"),setTimeout(()=>_e(!1),1e3),!0):(B("failed"),!1)}catch(Be){return Be.message==="aborted"||B("failed"),!1}},Gs=()=>{q.current&&(q.current.abort(),q.current=null),B("failed")},ra=M.useCallback(()=>e&&e.id===$c&&e.name==="Vocab Master",[e]);M.useEffect(()=>{if(s&&!A.current){A.current=!0;const Oe=new AbortController;(async()=>{try{const $e=wt().server.useCustomUrl?"outside":"home";T($e),await mn(!0,void 0,$e==="home",Oe.signal)}catch(Ye){console.warn("[AutoConnect] Failed:",Ye)}})();const Be=setInterval(()=>{const $e=wt().server.useCustomUrl?"outside":"home";T($e),mn(!0,void 0,$e==="home")},3e4),Ve=()=>{const $e=wt().server.useCustomUrl?"outside":"home";T($e),mn(!0,void 0,$e==="home")};return window.addEventListener("config-updated",Ve),()=>{Oe.abort(),clearInterval(Be),window.removeEventListener("config-updated",Ve)}}},[s,mn]),M.useEffect(()=>{const ke=setTimeout(async()=>{if(!(!s||G!=="connected"||!e||ie.current||O||bt)){ie.current=!0;try{const Be=await Ud(),Ve=e.name||e.id,Ye=Be.find($e=>$e.id===Ve||$e.name===Ve);if(Ye){const $e=new Date(Ye.date).getTime(),Qe=Number(localStorage.getItem("vocab_pro_local_last_modified")||0),kt=2e3;$e>Qe+kt?de({isOpen:!0,type:"restore",localDate:Qe===0?"Never":new Date(Qe).toLocaleString(),serverDate:new Date($e).toLocaleString(),serverId:Ye.id,serverMtime:$e}):Qe>$e+kt&&de({isOpen:!0,type:"push",localDate:new Date(Qe).toLocaleString(),serverDate:new Date($e).toLocaleString(),serverId:Ye.id,serverMtime:$e})}}catch(Be){console.warn("[Sync] Initial check failed:",Be)}}},2e3);return()=>clearTimeout(ke)},[s,G,e==null?void 0:e.id,O,bt]),M.useEffect(()=>{const ke=setTimeout(async()=>{if(Ge.current)return;const Be=sessionStorage.getItem("vocab_pro_suppress_auto_restore")==="true";if(s&&G==="connected"&&ra()&&!O&&!Be){Ge.current=!0;try{const Ve=await Ud();Ve&&Ve.length>0&&(Ne(Ve),it(!0))}catch(Ve){console.warn("[AutoRestore] Failed to fetch backups on init:",Ve)}}},1e3);return()=>clearTimeout(ke)},[s,G,ra,O]);const{lastBackupTime:Fl,refreshBackupTime:Ti,handleBackup:Ai,restoreFromServerAction:Os,triggerLocalRestore:aa,handleLibraryReset:qs,deleteWord:vs,bulkDeleteWords:os,bulkUpdateWords:$s}=CN({currentUser:e,setView:m,refreshGlobalStats:Lr,sessionWords:gt,setSessionWords:rn,globalViewWord:v,setGlobalViewWord:S,onUpdateUser:o}),on=async Oe=>{de(null),it(!1),fe(!0);try{const Be=(await Ud()).find(Ye=>Ye.id===Oe),Ve=Be?new Date(Be.date).getTime():void 0;await Os(Oe,Ve),fe(!1)}catch{fe(!1),n("Restore failed.","error")}},Ii=()=>{it(!1),aa()},Ni=async()=>{sessionStorage.setItem("vocab_pro_suppress_auto_restore","true"),it(!1),dt(!0),Qt("Wiping all data and preparing new profile...");try{await Ww();const Oe=await Mg(!0);Oe&&(a(Oe),m("SETTINGS"),n("Welcome! Your data has been wiped. Please set up your new profile.","success"))}catch{n("Failed to prepare new profile.","error")}finally{dt(!1)}},Ys=async()=>{if(!await mn(!0)){_e(!0),B("failed");return}if(sessionStorage.removeItem("vocab_pro_suppress_auto_restore"),Ge.current=!1,e&&e.id!==$c){n("Syncing current profile...","info");try{await Xd(e.id,e,!0)}catch{n("Backup failed, proceeding...","error")}}try{await Xw();const ke=await Ud();Ne(ke),it(!0)}catch{n("Failed to fetch user list from server.","error")}},Qs=async()=>{if(e){fe(!0);try{await Xd(e.id,e,!0),n("Cloud backup updated!","success"),de(null)}catch{n("Push failed.","error")}finally{fe(!1)}}},Ci=async()=>{if(X){fe(!0);try{await Os(X.serverId,X.serverMtime),de(null),fe(!1)}catch{n("Restore failed.","error"),fe(!1)}}};M.useEffect(()=>{const Oe=()=>{window.isRestoring||he(!0)},ke=()=>{he(!1),Ie(null)},Be=Ye=>{const $e=Ye;$e.detail&&$e.detail.targetTime&&Ie($e.detail.targetTime)},Ve=Ye=>{const $e=Ye;$e.detail&&($e.detail.success?(he(!1),Ie(null),Ti(),n("Cloud sync complete!","success",2e3)):he(!0))};return window.addEventListener("datastore-updated",Oe),window.addEventListener("vocab-pro-restore-complete",ke),window.addEventListener("backup-scheduled",Be),window.addEventListener("backup-complete",Ve),()=>{window.removeEventListener("datastore-updated",Oe),window.removeEventListener("vocab-pro-restore-complete",ke),window.removeEventListener("backup-scheduled",Be),window.removeEventListener("backup-complete",Ve)}},[Ti,n]);const Ri=async()=>{if(!e)return;const Oe=Zw(),{learned:ke,reviewed:Be}=Oe.dayProgress,Ve=new Date().toISOString().split("T")[0],Ye=Math.floor(ke/3),$e=Math.floor(Be/10),Qe=Ye+$e,kt=e.adventure,On=kt.lastDailyEnergyAwardDate||"";let Gt=kt.dailyEnergyAwarded||0;if(On!==Ve&&(Gt=0),Qe>Gt){const cn=Qe-Gt,Un={...e,adventure:{...kt,energy:(kt.energy||0)+cn,dailyEnergyAwarded:Qe,lastDailyEnergyAwardDate:Ve}};await o(Un),n(`Daily Progress: +${cn} Energy `,"success",2e3)}};M.useEffect(()=>{s&&e&&Ri()},[ta,s,e==null?void 0:e.id]);const Oi=async Oe=>{const ke=Ev(Oe.id);(!ke||ke.masteryScore!==Oe.masteryScore)&&F(Date.now()),await Cf(Oe),gt&&rn(Be=>(Be||[]).map(Ve=>Ve.id===Oe.id?Oe:Ve)),v&&v.id===Oe.id&&S(Oe)},ji=async()=>{e&&(Hm(),he(!1),Ie(null),await Xd(e.id,e,!0))},Ma=async()=>{G==="connected"&&e?await ji():await Ai()},ls=async Oe=>{await $s(Oe)},ln=async(Oe,ke)=>{await hN(Oe,ke),l(ke);const Be=Ev(Oe.id);(!Be||Be.masteryScore!==Oe.masteryScore)&&F(Date.now()),gt&&rn(Ve=>(Ve||[]).map(Ye=>Ye.id===Oe.id?Oe:Ye)),v&&v.id===Oe.id&&S(Oe)},{gainExperienceAndLevelUp:En,recalculateXpAndLevelUp:Mr,xpGained:ki,xpToNextLevel:Rt}=TN({currentUser:e,onUpdateUser:o,onSaveWordAndUser:ln});M.useEffect(()=>{s&&(d&&e?m("DASHBOARD"):e||m("AUTH"))},[s,d,e==null?void 0:e.id]);const ia=async Oe=>{Oe.id!==$c&&sessionStorage.removeItem("vocab_pro_suppress_auto_restore"),Oe.adventure.map||(Oe.adventure.map=Yc(100),await ur(Oe)),l(Oe),localStorage.setItem("vocab_pro_current_user_id",Oe.id),localStorage.setItem("vocab_pro_current_user_name",Oe.name),await ur({...Oe,lastLogin:Date.now()})},Ws=()=>{l(null),localStorage.removeItem("vocab_pro_current_user_id")},Ks=M.useCallback(()=>{Hn(),m("DASHBOARD"),Lr()},[Hn,Lr]),Xn=M.useCallback(()=>{if(!gt||gt.length===0||!xs){Ks();return}const Oe=gt.map(Be=>Be.id),ke=di().filter(Be=>Oe.includes(Be.id));ke.length>0?Wt(ke,xs,bs):Ks()},[gt,xs,bs,Wt,Ks]),oa=M.useCallback(async()=>{if(!e)return;const Oe=di(),ke=Date.now(),Be=Oe.filter(Ve=>!Ve.isPassive&&Ve.lastReview&&Ve.nextReview<=ke&&Ve.quality!=="FAILED").sort((Ve,Ye)=>Ve.nextReview-Ye.nextReview).slice(0,30);if(Be.length===0){n("No words due for review!","success");return}Wt(Be,"due")},[e,Wt,n]),Li=M.useCallback(async()=>{if(!e)return;const ke=di().filter(Be=>!Be.isPassive&&!Be.lastReview&&Be.quality==="VERIFIED").sort((Be,Ve)=>Be.createdAt-Ve.createdAt).slice(0,20);if(ke.length===0){n("No new words to learn!","success");return}Wt(ke,"new")},[e,Wt,n]);return{view:p,setView:m,currentUser:e,isLoaded:s,isResetting:It,resetStep:Je,isSidebarOpen:y,setIsSidebarOpen:x,handleLogin:ia,handleLogout:Ws,handleUpdateUser:o,sessionWords:gt,sessionFocus:bs,sessionType:xs,startSession:Wt,handleSessionComplete:Ks,stats:ta,wotd:Hs,refreshGlobalStats:Lr,isWotdComposed:sa,randomizeWotd:pr,globalViewWord:v,setGlobalViewWord:S,lastBackupTime:Fl,handleBackup:Ma,triggerLocalBackup:Ai,triggerServerBackup:ji,restoreFromServerAction:on,triggerLocalRestore:aa,handleLibraryReset:qs,initialListFilter:N,setInitialListFilter:z,forceExpandAdd:D,setForceExpandAdd:j,apiUsage:na,updateWord:Oi,deleteWord:vs,bulkDeleteWords:os,bulkUpdateWords:ls,handleNavigateToList:Oe=>{z(Oe),m("BROWSE")},openAddWordLibrary:()=>{m("BROWSE"),j(!0)},clearSessionState:Hn,handleRetrySession:Xn,gainExperienceAndLevelUp:En,recalculateXpAndLevelUp:Mr,xpGained:ki,xpToNextLevel:Rt,startDueReviewSession:oa,startNewLearnSession:Li,lastMasteryScoreUpdateTimestamp:P,writingContextWord:Le,handleComposeWithWord:Oe=>{Te(Oe),m("WRITING")},consumeWritingContext:()=>Te(null),targetLessonId:me,setTargetLessonId:et,consumeTargetLessonId:Xe,targetLessonTag:re,consumeTargetLessonTag:rt,targetLessonType:Tt,consumeTargetLessonType:tt,targetCourseId:ut,consumeTargetCourseId:Ht,targetGameMode:fr,consumeTargetGameMode:Cs,planningAction:ys,setPlanningAction:pn,consumePlanningAction:be,serverStatus:G,serverUrl:W,networkMode:I,isSwitchingServerMode:R,handleToggleServerMode:is,sslIssueUrl:Z,setSslIssueUrl:Y,hasUnsavedChanges:Ae,hasWritingUnsavedChanges:xe,setHasWritingUnsavedChanges:je,nextAutoBackupTime:pe,isAutoRestoreOpen:bt,setIsAutoRestoreOpen:it,autoRestoreCandidates:De,handleNewUserSetup:Ni,handleLocalRestoreSetup:Ii,handleSwitchUser:Ys,isConnectionModalOpen:O,setIsConnectionModalOpen:_e,connectionScanStatus:ye,scanningUrl:le,handleScanAndConnect:_n,handleStopScan:Gs,syncPrompt:X,setSyncPrompt:de,isSyncing:ce,handleSyncPush:Qs,handleSyncRestore:Ci,checkServerConnection:mn,retrySslConnection:an,handleSpecialAction:(Oe,ke)=>{switch(Oe){case"REVIEW":oa();break;case"BROWSE":Li();break;case"LESSON":ke&&ke.lessonId&&et(ke.lessonId),m("LESSON");break;case"LESSON_ONLY":Ze("ESSAY"),m("LESSON");break;case"LESSON_GRAMMAR":At("grammar"),m("COURSE");break;case"LESSON_SCALE":Ze("INTENSITY"),m("LESSON");break;case"LESSON_DIFF":Ze("COMPARISON"),m("LESSON");break;case"IRREGULAR_VERBS":m("IRREGULAR_VERBS");break;case"MIMIC":m("MIMIC");break;case"PRONUNCIATION_ROADMAP":At("pronunciation_roadmap"),m("COURSE");break;case"PLAN_AI":pn("AI"),m("PLANNING");break;case"PLAN_IMPORT":pn("IMPORT"),m("PLANNING");break;case"COLLO_CONNECT":case"DICTATION":case"SENTENCE_SCRAMBLE":case"MEANING_MATCH":case"IPA_SORTER":case"PREPOSITION_POWER":case"WORD_TRANSFORMER":case"PARAPHRASE_CONTEXT":case"IDIOM_CONNECT":case"WORD_SCATTER":case"NATURAL_EXPRESSION":case"INTENSITY_SCALE":case"COMPARISON_LAB":case"ADVENTURE":sessionStorage.setItem("dashboard_active_tab","PRACTICE"),hr(Oe),m("DISCOVER");break;default:m(Oe)}}}},Rk="modulepreload",Ok=function(n){return"/ielts-pro/"+n},j1={},gs=function(e,s,a){let o=Promise.resolve();if(s&&s.length>0){let d=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),m=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));o=d(s.map(y=>{if(y=Ok(y),y in j1)return;j1[y]=!0;const x=y.endsWith(".css"),v=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${v}`))return;const S=document.createElement("link");if(S.rel=x?"stylesheet":Rk,x||(S.as="script"),S.crossOrigin="",S.href=y,m&&S.setAttribute("nonce",m),document.head.appendChild(S),x)return new Promise((N,z)=>{S.addEventListener("load",N),S.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${y}`)))})}))}function l(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return o.then(d=>{for(const p of d||[])p.status==="rejected"&&l(p.reason);return e().catch(l)})};function jk(n,e="Vietnamese"){return`You are an expert IELTS coach, examiner, and native English speaker.
    
    Analyze this list of vocabulary items: [${n.map(a=>`"${a}"`).join(", ")}].

    IMPORTANT RULES FOR HEADWORD (hw) IDENTIFICATION:
    1. FOR PHRASES/IDIOMS/EXPRESSIONS: If the input is a multi-word unit (e.g., "cut the road", "break the ice", "get over"), the headword (hw) MUST be the EXACT phrase provided. DO NOT reduce it to a single word.
    2. FOR SINGLE WORDS: If the input is a single inflected word, identify its base form and ensure it is in SINGULAR form (e.g., "running" -> "run", "cities" -> "city", "problems" -> "problem").
    3. All details (meaning, IPA, examples) MUST correspond to the identified headword (the whole phrase or the base word).
    4. If input has multiple distinct meanings as a phrase vs a single word, prioritize the meaning of the input as provided.

    LANGUAGE RULES:
    - All content in English, except "m" (Meaning) which must be in ${e}.

    FIELD GENERATION RULES:
    - If the headword (hw) is a PHRASE, PHRASAL VERB, or IDIOM (e.g., "break the ice"):
      - DO NOT generate 'fam' (word family). Return an empty object {} or null.
      - DO NOT generate 'col' (collocations). Return an empty array [].
    - Do NOT generate 'para' (paraphrase) for orthographic variants (e.g., space vs no space, hyphen vs no hyphen).

    RESPONSE OPTIMIZATION:
    - Omit "og" if it is identical to "hw".
    - Omit "ipa_uk" if "pron_sim" is "same".

    FIELD DEFINITIONS:
    - og: The EXACT string from the input list. (Include ONLY if different from "hw").
    - hw: The headword (Full phrase for expressions; base form for single words).
    - ipa_us: Primary IPA transcription (General American).
    - ipa_uk: Received Pronunciation (UK) IPA. (Omit if "pron_sim" is "same").
    - pron_sim: Similarity between US and UK pronunciation. MUST be: "same", "near", or "different".
    - ipa_m: Array of 2-4 common mispronunciation transcriptions (to test the user).
    - m: Definition of the headword in ${e}.
    - reg: Register. MUST be one of: "academic", "casual", or "neutral".
    - ex: A high-quality example sentence using the headword.
    - col: Array of 3-5 collocations. ONLY for single-word headwords. Items: {"text": "phrase", "d": "minimal descriptive cue for recall (5-10 words)"}.
    - idm: Array of 1-3 common idioms containing the headword (only if hw is a single word). Items: {"text": "phrase", "d": "descriptive cue"}.
    - prep: Array of dependent prepositions. If the headword does NOT take a fixed preposition, return an empty array []. Format: [{"p": "preposition", "c": "short usage example"}].
    - para: Controlled paraphrase system (max 5 items total). ONLY generate categories if a natural equivalent exists. Try to force all tone types but avoid unnatural versions.        - Each item MUST be an object: {"w": "word_or_phrase", "t": "tone_type", "c": "recall cue"}.
        - 't' (tone) MUST be one of: "academic", "casual", "synonym" (no hypernyms or hyponyms)
        - 'c' (context) = a short (2-5 words) situational recall cue (e.g., "job interview", "arguing with friend").
    - fam: Word family. ONLY for single-word headwords. 'n'=nouns, 'v'=verbs, 'j'=adjectives, 'adv'=adverbs. Format: [{"w": "word"}].
    - type: The grammatical classification. MUST be one of: "idiom", "phrasal_verb", "collocation", "phrase", "vocabulary", "irregular_verb".
    - is_pas: Boolean. True if the word is "Passive" (vulgar, slang, or should be archived).

    Response Example (Return in code block format Strict JSON Array):
    [{
      "hw": "unhappy",
      "ipa_us": "/nhpi/",
      "pron_sim": "same",
      "ipa_m": ["/nhepi/"],
      "m": "khng vui, bun",
      "reg": "neutral",
      "ex": "She was unhappy with the results of the experiment.",
      "col": [{"text": "deeply unhappy", "d": "extreme sadness about a life event"}],
      "idm": [],
      "prep": [{"p": "with", "c": "unhappy with the service"}], 
      "para": [
        { "w": "dissatisfied", "t": "academic", "c": "complaining about product quality" },
        { "w": "miserable", "t": "intensified", "c": "sitting alone in the rain" }
      ],
      "type": "vocabulary",
      "is_pas": false,
      "fam": { "n": [{"w": "unhappiness"}], "adv": [{"w": "unhappily"}] }
    }]`}function kk(n){return`You are an expert English linguist.
    
    TASK: Provide the principal parts (past simple and past participle) for the following list of irregular verbs: [${n.map(s=>`"${s}"`).join(", ")}].

    RULES:
    1.  For each verb, provide its V1 (base form), V2 (past simple), and V3 (past participle).
    2.  If a verb has multiple common forms (e.g., "dreamt" / "dreamed"), provide the most common one first.
    3.  If a word is not an irregular verb, return its regular "-ed" forms.
    
    Return in code block format your analysis as a strict JSON array of objects. Each object must contain "v1", "v2", and "v3".

    Response Example (Strict JSON Array):
    [
      {
        "v1": "go",
        "v2": "went",
        "v3": "gone"
      },
      {
        "v1": "begin",
        "v2": "began",
        "v3": "begun"
      },
      {
        "v1": "dream",
        "v2": "dreamt",
        "v3": "dreamt"
      }
    ]`}function Lk(n,e){var a,o,l;const s={word:n.word,meaning:n.meaningVi,family:n.wordFamily,collocations:(a=n.collocationsArray)==null?void 0:a.map(d=>d.text),idioms:(o=n.idiomsList)==null?void 0:o.map(d=>d.text),paraphrases:(l=n.paraphrases)==null?void 0:l.map(d=>({word:d.word,tone:d.tone,context:d.context}))};return`You are an expert IELTS coach and English teacher. Your task is to provide learning recommendations for a vocabulary item based on a user's profile.

    USER PROFILE:
    - Role: ${e.role||"N/A"}
    - Current Level: ${e.currentLevel||"N/A"}
    - Target: ${e.target||"N/A"}

    VOCABULARY ITEM TO ANALYZE:
    ${JSON.stringify(s,null,2)}

    INSTRUCTIONS:
    1.  Analyze all components of the vocabulary item (word family, collocations, idioms, paraphrases).
    2.  Based on the USER PROFILE, decide whether each component is essential to learn ('learn') or can be ignored for now ('ignore').
    3.  Provide a concise, sharp 'reason' for each decision. Your reasoning is the most important part.
    4.  Be strict. For an IELTS learner, prioritize academic, high-impact, and flexible vocabulary. For a beginner, prioritize core meanings and common usage.

    EXAMPLE REASONING:
    - For an IELTS goal, if a paraphrase is "the process of a liquid turning into a gas," you should suggest 'ignore' and reason: "This is too descriptive and wordy for IELTS. A single academic term like 'evaporation' is more effective and scores higher for lexical resource."
    - For a primary school student goal, you might suggest 'learn' for the same phrase, reasoning: "This simple explanation is great for building foundational understanding before learning the scientific term."
    - For a common idiom, you might suggest 'learn' for an IELTS student: "Essential for demonstrating natural, native-like language in Speaking Part 1."

    Return in code block format a single, strict JSON object. Do not include any text outside the JSON block.

    STRICT JSON OUTPUT FORMAT:
    {
      "overall_summary": "string (A one-sentence summary of the learning strategy for this word, based on the user's goal.)",
      "wordFamily": [
        { "item": "string (the word form)", "suggestion": "learn" | "ignore", "reason": "string (your concise explanation)" }
      ],
      "collocations": [
        { "item": "string (the collocation)", "suggestion": "learn" | "ignore", "reason": "string" }
      ],
      "idioms": [
        { "item": "string (the idiom)", "suggestion": "learn" | "ignore", "reason": "string" }
      ],
      "paraphrases": [
        { "item": "string (the paraphrase word)", "suggestion": "learn" | "ignore", "reason": "string" }
      ]
    }
    `}function Mk(n,e,s){var l,d,p,m;const a=e.language||"English",o={word:n.word,meaning:n.meaningVi,family:n.wordFamily,collocations:(l=n.collocationsArray)==null?void 0:l.filter(y=>!y.isIgnored).map(y=>({text:y.text,hint:y.d})),idioms:(d=n.idiomsList)==null?void 0:d.filter(y=>!y.isIgnored).map(y=>({text:y.text,hint:y.d})),paraphrases:(p=n.paraphrases)==null?void 0:p.filter(y=>!y.isIgnored).map(y=>({word:y.word,tone:y.tone,context:y.context})),prepositions:(m=n.prepositions)==null?void 0:m.filter(y=>!y.isIgnored)};return`You are an expert IELTS coach${s?` named '${s}'`:""}. 
  
  TASK: Generate a highly structured "Usage Guide" for the word: "${n.word}".
  
  DATA: ${JSON.stringify(o)}

  INSTRUCTIONS:
  1. Create 5 distinct sections, each containing a Markdown Table:
     - **Prepositions**
     - **Word Family**
     - **Collocations**
     - **Variations (Paraphrases)**
     - **Idioms**
  
  2. Each table MUST have exactly these 3 columns:
     - **Word**: The specific form, collocation, or phrase.
     - **Context**: A brief explanation of *when* or *how* to use it (nuance, tone, or grammatical rule).
     - **Examples**: EXACTLY one high-quality, natural example sentence using that specific item.

  3. CONSTRAINTS:
     - Use ONLY Markdown tables for the usage data.
     - For line breaks WITHIN a table cell, use \`<br>\`. Do NOT use \`\\n\` or \`\\\\n\` inside table rows.
     - You MUST provide at least 1 example for every single item listed in the tables.
     - Keep the "Context" column concise (max 15 words).
     - If no data exists for a category (e.g., no idioms), you may skip that section or note it as "No common idioms".
     - All instructional text and headers should be in ${a}. All material/examples in English.

  Return in code block format a JSON object:
  {
    "content": "string (Markdown formatted with headers and tables, use \\n for newlines)"
  }`}function Dk(n,e,s){var l,d,p;const a=e.language||"English",o={word:n.word,meaning:n.meaningVi,collocations:(l=n.collocationsArray)==null?void 0:l.filter(m=>!m.isIgnored).map(m=>({text:m.text,hint:m.d})),idioms:(d=n.idiomsList)==null?void 0:d.filter(m=>!m.isIgnored).map(m=>({text:m.text,hint:m.d})),paraphrases:(p=n.paraphrases)==null?void 0:p.filter(m=>!m.isIgnored).map(m=>({word:m.word,tone:m.tone,context:m.context}))};return`You are an expert IELTS examiner${s?` working with coach '${s}'`:""}. Design an interactive PRACTICE TEST for: "${n.word}".
    
    DATA: ${JSON.stringify(o)}

    AVAILABLE TAGS:
    - [Select: Correct | Wrong 1 | Wrong 2] (Dropdown)
    - [Multi: Correct | Option 2 | Option 3] (Multiple Choice Buttons)
    - [Quiz: Answer] (Fill-in)

    TASK:
    Generate 5-8 questions covering:
    1. Nuanced collocation choice.
    2. Meaning selection.
    3. Sentence completion with correct word forms.
    4. Synonym selection for specific contexts.

    LANGUAGE: Instructions in ${a}, questions in English.

    Return a JSON object:
    {
      "content": "string (Markdown with interactive tags)"
    }`}const Uk=()=>`Transcribe the text contained in this image exactly as it appears. 
    - Maintain the original language.
    - Do not add introductory or concluding remarks. 
    - If there is no text, return "No text detected."`,Pk=n=>{if(!n)return null;const e=j=>Array.isArray(j)?j.map(P=>typeof P=="string"?{word:P}:P&&(P.w||P.word)?{word:P.w||P.word,isIgnored:P.g??P.isIgnored}:null).filter(P=>P!==null&&!!P.word):[],s=j=>(j==null?void 0:j.map(P=>({word:P.w||P.word,tone:P.t||P.tone,context:P.c||P.context,isIgnored:P.g??P.isIgnored??!1})))||[],a=j=>Array.isArray(j)?j.map(P=>typeof P=="string"?{prep:P.trim(),usage:""}:{prep:(P.p||P.prep||"").trim(),usage:(P.c||P.usage||"").trim(),isIgnored:P.g??P.isIgnored??!1}).filter(P=>P.prep.length>0):[],o=j=>Array.isArray(j)?j.map(F=>{if(typeof F=="string")return{text:F,isIgnored:!1};const G=F.text||F.x;if(G){const H=F.d||F.ds;return{text:G,d:H,isIgnored:F.g??F.isIgnored??!1}}return null}).filter(F=>F!==null&&!!F.text):void 0;let l;Array.isArray(n.prepositionsArray)?l=n.prepositionsArray:Array.isArray(n.prep)&&(l=a(n.prep));const d=n.col||n.collocations;let p,m;Array.isArray(d)?(p=o(d),p&&(m=p.map(j=>j.text).join(`
`))):typeof d=="string"&&(m=d);const y=n.idm||n.idioms;let x;Array.isArray(y)&&(x=o(y));const v=n.hw||n.headword,S=n.pron_sim||n.pronSim||n.ps,N=n.ipa_us||n.ipaUs||n.ipa||n.i,z=n.type,D={isIdiom:z==="idiom",isPhrasalVerb:z==="phrasal_verb",isCollocation:z==="collocation",isStandardPhrase:z==="phrase",isIrregular:z==="irregular_verb"};return{original:n.og||n.original||v,headword:v,ipaUs:N,ipaUk:n.ipa_uk||n.ipaUk||(S==="same"?N:void 0),pronSim:S,ipaMistakes:n.ipa_m||n.ipaMistakes||n.im,meaningVi:n.m||n.meaningVi,register:n.reg||n.register,example:n.ex||n.example,collocations:m,collocationsArray:p,idioms:x?x.map(j=>j.text).join(`
`):void 0,idiomsList:x,prepositionString:typeof n.prep=="string"?n.prep:void 0,prepositionsArray:l,isIdiom:z?D.isIdiom:n.is_id??n.isIdiom,isPhrasalVerb:z?D.isPhrasalVerb:n.is_pv??n.isPhrasalVerb,isCollocation:z?D.isCollocation:n.is_col??n.isCollocation,isStandardPhrase:z?D.isStandardPhrase:n.is_phr??n.isStandardPhrase,isIrregular:z?D.isIrregular:n.is_irr??n.isIrregular,isPassive:n.is_pas??n.isPassive,paraphrases:s(n.para||n.paraphrases),wordFamily:n.fam?{nouns:e(n.fam.n||n.fam.ns||[]),verbs:e(n.fam.v||[]),adjs:e(n.fam.j||[]),advs:e(n.fam.adv||n.fam.d||[])}:n.wordFamily||void 0}},Vk=(n,e)=>{const s=Pk(e);if(!s)return n;const a={...n};a.ipaUs=s.ipaUs??n.ipaUs,a.ipaUk=s.ipaUk??n.ipaUk,a.pronSim=s.pronSim??n.pronSim,a.ipaMistakes=s.ipaMistakes??n.ipaMistakes,a.meaningVi=s.meaningVi??n.meaningVi,a.register=s.register??n.register;let l=[...n.collocationsArray||(n.collocations?n.collocations.split(`
`).map(y=>({text:y.trim(),isIgnored:!1})).filter(y=>y.text):[])];s.collocationsArray&&s.collocationsArray.forEach(y=>{const x=l.findIndex(v=>v.text.toLowerCase()===y.text.toLowerCase());x!==-1?(y.d&&!l[x].d&&(l[x].d=y.d),y.isIgnored&&(l[x].isIgnored=!0)):l.push({text:y.text,d:y.d,isIgnored:y.isIgnored||!1})}),a.collocationsArray=l,a.collocations=l.map(y=>y.text).join(`
`);let p=[...n.idiomsList||(n.idioms?n.idioms.split(`
`).map(y=>({text:y.trim(),isIgnored:!1})).filter(y=>y.text):[])];s.idiomsList&&s.idiomsList.forEach(y=>{const x=p.findIndex(v=>v.text.toLowerCase()===y.text.toLowerCase());x!==-1?(y.d&&!p[x].d&&(p[x].d=y.d),y.isIgnored&&(p[x].isIgnored=!0)):p.push({text:y.text,d:y.d,isIgnored:y.isIgnored||!1})}),a.idiomsList=p,a.idioms=p.map(y=>y.text).join(`
`);let m=n.prepositions||[];if(s.prepositionsArray&&Array.isArray(s.prepositionsArray)&&s.prepositionsArray.length>0){const y=s.prepositionsArray,x=[...m];y.forEach(v=>{v.prep&&(x.some(N=>N.prep.toLowerCase()===v.prep.toLowerCase()&&N.usage.toLowerCase()===v.usage.toLowerCase())||x.push({...v,isIgnored:v.isIgnored||!1}))}),m=x}if(a.prepositions=m.length>0?m:void 0,s.wordFamily&&(a.wordFamily=s.wordFamily),s.paraphrases&&Array.isArray(s.paraphrases)){const y=n.paraphrases||[],x=s.paraphrases,v=[...y];x.forEach(S=>{v.some(N=>N.word.toLowerCase()===S.word.toLowerCase())||v.push(S)}),a.paraphrases=v}if(s.example){let y=n.example||"";y.toLowerCase().includes(s.example.toLowerCase())||(y=y.trim()?`${y}
${s.example}`:s.example),a.example=y}return a.isIdiom=s.isIdiom!==void 0?!!s.isIdiom:n.isIdiom,a.isPhrasalVerb=s.isPhrasalVerb!==void 0?!!s.isPhrasalVerb:n.isPhrasalVerb,a.isCollocation=s.isCollocation!==void 0?!!s.isCollocation:n.isCollocation,a.isStandardPhrase=s.isStandardPhrase!==void 0?!!s.isStandardPhrase:n.isStandardPhrase,a.isIrregular=s.isIrregular!==void 0?!!s.isIrregular:n.isIrregular,a.isPassive=s.isPassive!==void 0?!!s.isPassive:n.isPassive,a.quality=Ft.REFINED,a.complexity=kr(a),a.masteryScore=Ns(a),a.gameEligibility=jr(a),a.updatedAt=Date.now(),a},k1=({label:n,options:e,selectedId:s,onSelect:a,buttonClass:o,disabled:l=!1})=>{const[d,p]=M.useState(!1),m=M.useRef(null),y=e.find(x=>x.id===s)||e[0];return M.useEffect(()=>{const x=v=>{m.current&&!m.current.contains(v.target)&&p(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),u.jsxs("div",{className:"relative",ref:m,children:[u.jsxs("button",{type:"button",onClick:()=>p(!d),className:o,disabled:l,children:[n&&u.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-neutral-400",children:n}),y.icon,u.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:y.label}),u.jsx(CE,{size:14,className:`transition-transform duration-200 ${d?"rotate-180":""}`})]}),d&&!l&&u.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-2xl shadow-xl border border-neutral-100 z-50 p-2 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col gap-1",children:e.map(x=>u.jsxs("button",{type:"button",onClick:()=>{a(x.id),p(!1)},className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-xs font-bold transition-colors ${s===x.id?"bg-neutral-100 text-neutral-900":"text-neutral-600 hover:bg-neutral-50 hover:text-neutral-900"}`,children:[x.icon,u.jsx("span",{children:x.label})]},x.id))})]})},cl=({title:n,items:e,onUpdate:s,onToggleIgnore:a,onRemove:o,onAdd:l,placeholders:d,showDescription:p=!1})=>u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:n}),u.jsxs("div",{className:"space-y-2 p-3 bg-neutral-50 border border-neutral-200 rounded-2xl",children:[(e||[]).map((m,y)=>u.jsxs("div",{className:`bg-white p-2 rounded-lg border border-neutral-100 flex items-start gap-2 group transition-opacity ${m.isIgnored?"opacity-50":""}`,children:[u.jsxs("div",{className:"flex-1 space-y-1",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("input",{type:"text",value:m.text,onChange:x=>s(y,"text",x.target.value),placeholder:d.text,className:"flex-1 px-3 py-2 bg-neutral-50/50 border border-neutral-200 rounded-lg text-xs font-bold focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"})}),p&&u.jsx("input",{type:"text",value:m.d||"",onChange:x=>s(y,"d",x.target.value),placeholder:d.d,className:"w-full px-3 py-1 bg-neutral-50/50 border border-transparent rounded-lg text-[10px] font-medium text-neutral-500 focus:bg-white focus:ring-1 focus:ring-neutral-900 focus:border-neutral-200 outline-none"})]}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("button",{type:"button",onClick:()=>a(y),className:"p-2 text-neutral-400 hover:text-neutral-700 rounded-lg hover:bg-neutral-100",children:m.isIgnored?u.jsx(Dm,{size:14}):u.jsx(su,{size:14})}),u.jsx("button",{type:"button",onClick:()=>o(y),className:"p-2 text-neutral-400 hover:text-red-500 rounded-lg hover:bg-red-50",children:u.jsx(Rn,{size:14})})]})]},y)),u.jsxs("button",{type:"button",onClick:l,className:"w-full text-center py-2 bg-white hover:bg-neutral-100 text-neutral-400 hover:text-neutral-700 rounded-lg text-xs font-bold transition-colors flex items-center justify-center gap-1.5 border border-neutral-200 shadow-sm",children:[u.jsx(Kr,{size:12})," Add"]})]})]}),zk=n=>{var W,Q,I,T;const{onClose:e,onSwitchToView:s,formData:a,setFormData:o,setFlag:l,familyHandler:d,prepList:p,collocList:m,idiomList:y,paraList:x,handleSubmit:v,onOpenAiRefine:S,onSuggestLearn:N,hasSuggestions:z}=n,[D,j]=M.useState("MAIN"),P=[{id:"MAIN",label:"Main",icon:$2},{id:"DETAILS",label:"Details",icon:PE},{id:"CONNECTIONS",label:"Links",icon:uI},{id:"USAGE",label:"Usage & Test",icon:af}],F=[{id:Ft.RAW,label:"Raw",icon:u.jsx(LE,{size:14,className:"text-neutral-400"})},{id:Ft.REFINED,label:"Refined",icon:u.jsx(qE,{size:14,className:"text-indigo-500"})},{id:Ft.VERIFIED,label:"Verified",icon:u.jsx(FE,{size:14,className:"text-emerald-500"})},{id:Ft.FAILED,label:"Incorrect",icon:u.jsx(HE,{size:14,className:"text-rose-500"})}],G=[{id:"NEW",label:"New",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"})},{id:Lt.LEARNED,label:"Learned",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-cyan-500"})},{id:Lt.FORGOT,label:"Forgot",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-rose-500"})},{id:Lt.HARD,label:"Hard",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"})},{id:Lt.EASY,label:"Easy",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}],H=["intensified","softened","synonym","academic","casual"];return u.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-4xl rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[95vh]",children:[u.jsxs("header",{className:"px-6 py-4 border-b border-neutral-100 flex flex-col gap-4 shrink-0 bg-white/80 backdrop-blur-sm z-10",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("button",{onClick:s,className:"p-2 bg-neutral-100 hover:bg-neutral-200 rounded-lg text-neutral-500 transition-colors",children:u.jsx(IE,{size:16})}),u.jsx("h3",{className:"font-black text-lg text-neutral-900 leading-none",children:"Edit Word"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{type:"button",onClick:N,title:z?"View Suggestions":"Get Learning Suggestions",className:`px-3 py-2 border rounded-lg font-black text-[10px] flex items-center justify-center space-x-1.5 hover:bg-neutral-50 active:scale-95 transition-all shadow-sm ${z?"bg-amber-50 border-amber-200 text-amber-700":"bg-white border-neutral-200 text-neutral-600"}`,children:[u.jsx(Ng,{size:12,className:z?"text-amber-500":"text-neutral-400"}),u.jsx("span",{children:z?"View Suggestion":"Suggest"})]}),u.jsxs("button",{type:"button",onClick:S,className:"px-3 py-2 bg-white border border-neutral-200 text-neutral-600 rounded-lg font-black text-[10px] flex items-center justify-center space-x-1.5 hover:bg-neutral-50 active:scale-95 transition-all shadow-sm",children:[u.jsx(Rl,{size:12,className:"text-amber-500"}),u.jsx("span",{children:"Manual AI"})]}),u.jsxs("button",{type:"button",onClick:()=>v(),className:"px-5 py-2 bg-neutral-900 text-white rounded-lg font-black text-[10px] flex items-center justify-center space-x-1.5 hover:bg-neutral-800 active:scale-95 transition-all shadow-md shadow-neutral-900/10",children:[u.jsx(BE,{size:12}),u.jsx("span",{children:"Save"})]}),u.jsx("button",{onClick:e,className:"p-2 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 rounded-full transition-colors ml-2",children:u.jsx(Rn,{size:18})})]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[u.jsx("div",{className:"flex bg-neutral-100 p-1 rounded-xl w-fit",children:P.map(({id:_,label:C,icon:R})=>u.jsxs("button",{onClick:()=>j(_),className:`px-4 py-2 text-xs font-black rounded-lg transition-all flex items-center gap-2 ${D===_?"bg-white shadow-sm text-neutral-900":"text-neutral-500 hover:text-neutral-800"}`,children:[u.jsx(R,{size:14})," ",C]},_))}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(k1,{label:"Quality",options:F,selectedId:a.quality,onSelect:_=>o("quality",_),buttonClass:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg hover:bg-neutral-100 transition-colors shadow-sm border border-neutral-200"}),u.jsx(k1,{label:"Learn Status",options:G,selectedId:a.studiedStatus,onSelect:_=>o("studiedStatus",_),buttonClass:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg hover:bg-neutral-100 transition-colors shadow-sm border border-neutral-200"})]})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar bg-neutral-50/50",children:u.jsxs("div",{className:"p-6 space-y-6",children:[D==="MAIN"&&u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Headword"}),u.jsx("input",{type:"text",value:a.word,onChange:_=>o("word",_.target.value),className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-lg font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Primary IPA / US"}),u.jsx("input",{type:"text",value:a.ipaUs||"",onChange:_=>o("ipaUs",_.target.value),placeholder:"/.../",className:"w-full px-4 py-2 bg-white border border-neutral-200 rounded-xl font-mono text-base text-neutral-600 focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"IPA UK (Optional)"}),u.jsx("input",{type:"text",value:a.ipaUk||"",onChange:_=>o("ipaUk",_.target.value),placeholder:"/.../",className:"w-full px-4 py-2 bg-white border border-neutral-200 rounded-xl font-mono text-base text-neutral-600 focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Pronunciation Similarity"}),u.jsx("div",{className:"flex bg-neutral-100 p-1 rounded-xl w-full",children:["same","near","different"].map(_=>u.jsx("button",{type:"button",onClick:()=>o("pronSim",_),className:`flex-1 px-4 py-2 text-xs font-black rounded-lg transition-all flex items-center justify-center gap-2 ${a.pronSim===_?"bg-white shadow-sm text-neutral-900":"text-neutral-500 hover:text-neutral-800"}`,children:_.charAt(0).toUpperCase()+_.slice(1)},_))})]})]}),u.jsxs("div",{className:"md:col-span-2 space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Definition / Meaning"}),u.jsx("input",{type:"text",value:a.meaningVi,onChange:_=>o("meaningVi",_.target.value),className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-base font-medium focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"md:col-span-2 space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Examples"}),u.jsx("textarea",{rows:5,value:a.example,onChange:_=>o("example",_.target.value),className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm leading-relaxed resize-y focus:ring-2 focus:ring-neutral-900 outline-none"})]})]}),D==="DETAILS"&&u.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Flags"}),u.jsx("div",{className:"flex flex-wrap gap-2 p-3 bg-white border border-neutral-200 rounded-2xl",children:[{id:"isIdiom",label:"Idiom",icon:Tf},{id:"isCollocation",label:"Colloc.",icon:Sf},{id:"isStandardPhrase",label:"Phrase",icon:Cg},{id:"isPhrasalVerb",label:"Phrasal",icon:VE},{id:"isIrregular",label:"Irregular",icon:gI},{id:"isPassive",label:"Archive",icon:a.isPassive?F2:jg}].map(_=>u.jsxs("button",{type:"button",onClick:()=>l(_.id),className:`flex items-center space-x-1.5 py-1.5 px-3 rounded-lg border transition-all font-bold text-[9px] uppercase tracking-wider ${a[_.id]?"bg-neutral-900 border-neutral-900 text-white shadow-sm":"bg-white border-neutral-200 text-neutral-500 hover:border-neutral-300"}`,children:[u.jsx(_.icon,{size:10}),u.jsx("span",{children:_.label})]},_.id))})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center",children:[u.jsx(II,{size:10,className:"mr-1"}),"User Groups"]}),u.jsx("input",{type:"text",value:a.groupsString,onChange:_=>o("groupsString",_.target.value),placeholder:"bird_species, env_academic...",className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm focus:ring-1 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"md:col-span-2 space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Register"}),u.jsx("div",{className:"flex bg-neutral-100 p-1 rounded-xl w-fit",children:["raw","neutral","academic","casual"].map(_=>u.jsx("button",{type:"button",onClick:()=>o("register",_),className:`px-4 py-2 text-xs font-black rounded-lg transition-all flex items-center gap-2 ${a.register===_||!a.register&&_==="raw"?"bg-white shadow-sm text-neutral-900":"text-neutral-500 hover:text-neutral-800"}`,children:_.charAt(0).toUpperCase()+_.slice(1)},_))})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center",children:[u.jsx(Ag,{size:10,className:"mr-1"})," Prepositions / Patterns"]}),u.jsxs("div",{className:"space-y-2 p-3 bg-white border border-neutral-200 rounded-2xl",children:[a.prepositionsList.map((_,C)=>u.jsxs("div",{className:`flex items-center gap-2 transition-opacity ${_.isIgnored?"opacity-40":""}`,children:[u.jsx("input",{type:"text",value:_.prep,onChange:R=>p.update(C,{prep:R.target.value}),placeholder:"Prep",className:"w-24 px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-bold focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"}),u.jsx("input",{type:"text",value:_.usage,onChange:R=>p.update(C,{usage:R.target.value}),placeholder:"Usage Context",className:"flex-1 px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-medium focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"}),u.jsx("button",{type:"button",onClick:()=>p.toggleIgnore(C),className:"p-2 text-neutral-400 hover:text-neutral-700 rounded-lg hover:bg-neutral-100",children:_.isIgnored?u.jsx(Dm,{size:14}):u.jsx(su,{size:14})}),u.jsx("button",{type:"button",onClick:()=>p.remove(C),className:"p-2 text-neutral-400 hover:text-red-500 rounded-lg hover:bg-red-50",children:u.jsx(Rn,{size:14})})]},C)),u.jsxs("button",{type:"button",onClick:()=>p.add({prep:"",usage:"",isIgnored:!1}),className:"w-full text-center py-2 bg-neutral-50 hover:bg-neutral-100 text-neutral-400 hover:text-neutral-700 rounded-lg text-xs font-bold transition-colors flex items-center justify-center gap-1.5 border border-neutral-200 shadow-sm",children:[u.jsx(Kr,{size:12})," Add Pattern"]})]})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center",children:[u.jsx(_I,{size:10,className:"mr-1"})," Private Note"]}),u.jsx("textarea",{rows:3,value:a.note,onChange:_=>o("note",_.target.value),className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm text-neutral-600 resize-y focus:ring-1 focus:ring-neutral-900 outline-none"})]})]}),D==="CONNECTIONS"&&u.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[u.jsx(cl,{title:"Collocations",items:a.collocationsArray,onUpdate:(_,C,R)=>m.update(_,{[C]:R}),onToggleIgnore:m.toggleIgnore,onRemove:m.remove,onAdd:()=>m.add({text:"",d:"",isIgnored:!1}),placeholders:{text:"Collocation phrase...",d:"Descriptive hint..."},showDescription:!0}),u.jsx(cl,{title:"Related Idioms",items:a.idiomsList,onUpdate:(_,C,R)=>y.update(_,{[C]:R}),onToggleIgnore:y.toggleIgnore,onRemove:y.remove,onAdd:()=>y.add({text:"",d:"",isIgnored:!1}),placeholders:{text:"Idiom or phrase...",d:"Descriptive hint..."},showDescription:!0}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Word Family"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(cl,{title:"Nouns",items:(((W=a.wordFamily)==null?void 0:W.nouns)||[]).map(_=>({text:_.word,isIgnored:_.isIgnored})),onUpdate:(_,C,R)=>{C==="text"&&d("nouns").update(_,"word",R)},onToggleIgnore:d("nouns").toggleIgnore,onRemove:d("nouns").remove,onAdd:d("nouns").add,placeholders:{text:"Noun form..."}}),u.jsx(cl,{title:"Verbs",items:(((Q=a.wordFamily)==null?void 0:Q.verbs)||[]).map(_=>({text:_.word,isIgnored:_.isIgnored})),onUpdate:(_,C,R)=>{C==="text"&&d("verbs").update(_,"word",R)},onToggleIgnore:d("verbs").toggleIgnore,onRemove:d("verbs").remove,onAdd:d("verbs").add,placeholders:{text:"Verb form..."}}),u.jsx(cl,{title:"Adjectives",items:(((I=a.wordFamily)==null?void 0:I.adjs)||[]).map(_=>({text:_.word,isIgnored:_.isIgnored})),onUpdate:(_,C,R)=>{C==="text"&&d("adjs").update(_,"word",R)},onToggleIgnore:d("adjs").toggleIgnore,onRemove:d("adjs").remove,onAdd:d("adjs").add,placeholders:{text:"Adjective form..."}}),u.jsx(cl,{title:"Adverbs",items:(((T=a.wordFamily)==null?void 0:T.advs)||[]).map(_=>({text:_.word,isIgnored:_.isIgnored})),onUpdate:(_,C,R)=>{C==="text"&&d("advs").update(_,"word",R)},onToggleIgnore:d("advs").toggleIgnore,onRemove:d("advs").remove,onAdd:d("advs").add,placeholders:{text:"Adverb form..."}})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Af,{size:10,className:"text-amber-500"})," Word Power & Variations"]}),u.jsxs("div",{className:"space-y-2 p-3 bg-white border border-neutral-200 rounded-2xl",children:[(a.paraphrases||[]).map((_,C)=>u.jsxs("div",{className:`grid grid-cols-[1fr,auto,1fr,auto,auto] items-center gap-2 transition-opacity ${_.isIgnored?"opacity-40":""}`,children:[u.jsx("input",{type:"text",value:_.word,onChange:R=>x.update(C,{word:R.target.value}),placeholder:"Variation...",className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-bold focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"}),u.jsx("select",{value:_.tone,onChange:R=>x.update(C,{tone:R.target.value}),className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-bold focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none appearance-none",children:H.map(R=>u.jsx("option",{value:R,children:R.charAt(0).toUpperCase()+R.slice(1)},R))}),u.jsx("input",{type:"text",value:_.context,onChange:R=>x.update(C,{context:R.target.value}),placeholder:"Context...",className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-medium focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"}),u.jsx("button",{type:"button",onClick:()=>x.toggleIgnore(C),className:"p-2 text-neutral-400 hover:text-neutral-700 rounded-lg hover:bg-neutral-100",children:_.isIgnored?u.jsx(Dm,{size:14}):u.jsx(su,{size:14})}),u.jsx("button",{type:"button",onClick:()=>x.remove(C),className:"p-2 text-neutral-400 hover:text-red-500 rounded-lg hover:bg-red-50",children:u.jsx(Rn,{size:14})})]},C)),u.jsxs("button",{type:"button",onClick:()=>x.add({word:"",context:"",tone:"synonym",isIgnored:!1}),className:"w-full text-center py-2 bg-neutral-50 hover:bg-neutral-100 text-neutral-400 hover:text-neutral-700 rounded-lg text-xs font-bold transition-colors flex items-center justify-center gap-1.5 border border-neutral-200 shadow-sm",children:[u.jsx(Kr,{size:12})," Add Variation"]})]})]})]}),D==="USAGE"&&u.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300 h-full flex flex-col",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"flex justify-between items-center px-1",children:u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[u.jsx(af,{size:12})," Usage Guide (Markdown)"]})}),u.jsx("textarea",{value:a.essayEdit,onChange:_=>o("essayEdit",_.target.value),rows:12,className:"w-full p-4 bg-white border border-neutral-200 rounded-2xl font-mono text-xs leading-relaxed focus:ring-2 focus:ring-neutral-900 outline-none resize-y",placeholder:"Enter the Usage Guide Markdown content here..."})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"flex justify-between items-center px-1",children:u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[u.jsx(Mm,{size:12})," Practice Test (Markdown)"]})}),u.jsx("textarea",{value:a.testEdit,onChange:_=>o("testEdit",_.target.value),rows:12,className:"w-full p-4 bg-white border border-neutral-200 rounded-2xl font-mono text-xs leading-relaxed focus:ring-2 focus:ring-neutral-900 outline-none resize-y",placeholder:"Enter the Practice Test Markdown content here..."})]})]})]})})]})})};async function Bf(n){if(navigator.clipboard&&navigator.clipboard.writeText)try{return await navigator.clipboard.writeText(n),!0}catch{console.warn("Clipboard API failed, trying fallback strategy")}try{const e=document.createElement("textarea");e.value=n,e.style.position="fixed",e.style.left="-9999px",e.style.top="0",document.body.appendChild(e),e.focus(),e.select();const s=document.execCommand("copy");return document.body.removeChild(e),s}catch(e){return console.error("Copy failed",e),!1}}const Bk=n=>n?n.split(/[;\n\r\t,]+/).map(e=>e.trim()).filter(Boolean):[],eM=n=>{const e=new Map;return n&&Bk(n).forEach(a=>{const o=a.split(":").map(p=>p.trim()),l=o[0],d=o.length>1?o[1]:o[0];if(l&&d){const p=l.toLowerCase(),m=d.toLowerCase();e.set(p,m),e.has(m)||e.set(m,m)}}),e},tM=n=>{const e=Array.from(n.keys()).sort((a,o)=>o.length-a.length);if(e.length===0)return null;const s=e.map(a=>a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"));return new RegExp(`\\b(${s.join("|")})\\b`,"gi")},yg=({isOpen:n,onClose:e,type:s,title:a,description:o,initialData:l,onGeneratePrompt:d,onJsonReceived:p,hidePrimaryInput:m=!1,closeOnSuccess:y=!1})=>{const[x,v]=M.useState(""),[S,N]=M.useState(""),[z,D]=M.useState(""),[j,P]=M.useState(""),[F,G]=M.useState("CASUAL"),[H,W]=M.useState(""),[Q,I]=M.useState(Um.VARIETY),[T,_]=M.useState(""),[C,R]=M.useState("Adult"),[L,O]=M.useState("English"),[_e,ye]=M.useState("friendly_elementary"),[B,le]=M.useState(""),[se,Z]=M.useState(""),[Y,A]=M.useState(null),[V,q]=M.useState(!1),[X,de]=M.useState(!1),[ce,fe]=M.useState(!1),[ie,Ae]=M.useState(""),he=M.useRef(null),xe=M.useRef(void 0),je=["GENERATE_LESSON","GENERATE_WORD_LESSON","GENERATE_AUDIO_SCRIPT"].includes(s);if(M.useEffect(()=>{if(n&&!xe.current){if(v(""),N(""),D(""),P(""),G("CASUAL"),W(""),I(Um.VARIETY),le(""),s==="REFINE_WORDS"&&(l!=null&&l.words)){const me=l.words.replace(/\n/g,"; ");v(me)}else je&&(_(""),R((l==null?void 0:l.targetAudience)||"Adult"),O((l==null?void 0:l.language)||"English"),ye((l==null?void 0:l.tone)||"friendly_elementary"));Z(""),A(null),fe(!1),q(!1),de(!1)}xe.current=n},[n,s,l,je]),M.useEffect(()=>{let me={};s==="REFINE_WORDS"?me={words:m?l==null?void 0:l.words:x}:s==="REFINE_UNIT"?me={request:S,language:L,targetAudience:C,tone:_e,format:"reading"}:s==="GENERATE_AUDIO_SCRIPT"?me={request:S,language:L,targetAudience:C,tone:_e,format:"listening"}:s==="GENERATE_CHAPTER"?me={request:z}:s==="GENERATE_SEGMENT"?me={request:j}:s==="GENERATE_PARAPHRASE"?me={tone:F,context:H,mode:Q}:s==="EVALUATE_PARAPHRASE"?me=l:s==="GENERATE_LESSON"||s==="GENERATE_WORD_LESSON"?me={topic:T,language:L,targetAudience:C,tone:_e,format:"reading"}:s==="GENERATE_UNIT"?me={request:S}:s==="GENERATE_PLAN"&&(me={request:B}),Ae(d(me))},[s,x,S,z,j,F,H,Q,l,m,T,C,L,_e,B,d]),!n)return null;const pe=async()=>{await Bf(ie),fe(!0),setTimeout(()=>fe(!1),2e3),setTimeout(()=>{var me;return(me=he.current)==null?void 0:me.focus()},100)},Ie=async()=>{V||!se.trim()||(A(null),q(!0),setTimeout(async()=>{try{let me=se.trim();me=me.replace(/^```json\s*/,"").replace(/^```\s*/,"").replace(/\s*```$/,"");let et;try{et=JSON.parse(me)}catch{try{me=me.replace(/,\s*([}\]])/g,"$1"),et=JSON.parse(me)}catch(Xe){throw new Error("Cannot read AI response. Please ensure you copied the full code.",{cause:Xe})}}je?await p({result:et,preferences:{language:L,targetAudience:C,tone:_e}}):await p(et),y?e():(q(!1),de(!0))}catch(me){console.error(me),q(!1),A(me.message||"Failed to process.")}},50))},Le=me=>{me.key==="Enter"&&(me.metaKey||me.ctrlKey)&&(me.preventDefault(),Ie())},Te=()=>u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[u.jsx(ME,{size:10})," Language"]}),u.jsxs("select",{value:L,onChange:me=>O(me.target.value),className:"w-full px-3 py-2 bg-white border border-neutral-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none appearance-none cursor-pointer",children:[u.jsx("option",{value:"English",children:"English"}),u.jsx("option",{value:"Vietnamese",children:"Vietnamese"})]})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[u.jsx(wI,{size:10})," Audience"]}),u.jsxs("select",{value:C,onChange:me=>R(me.target.value),className:"w-full px-3 py-2 bg-white border border-neutral-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none appearance-none cursor-pointer",children:[u.jsx("option",{value:"Adult",children:"Adult"}),u.jsx("option",{value:"Kid",children:"Kid"})]})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[u.jsx(mI,{size:10})," Persona"]}),u.jsxs("select",{value:_e,onChange:me=>ye(me.target.value),className:"w-full px-3 py-2 bg-white border border-neutral-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none appearance-none cursor-pointer",children:[u.jsx("option",{value:"friendly_elementary",children:"Friendly"}),u.jsx("option",{value:"professional_professor",children:"Professional"})]})]})]});return u.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center p-4 bg-white/10 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl flex flex-col overflow-hidden border border-neutral-200 relative ring-4 ring-neutral-100",children:[u.jsx("button",{onClick:e,disabled:V,className:"absolute top-4 right-4 p-2 text-neutral-300 hover:text-neutral-900 hover:bg-neutral-50 rounded-full transition-all z-10 disabled:opacity-0",children:u.jsx(Rn,{size:18})}),u.jsxs("div",{className:"p-6 md:p-8 flex flex-col gap-6",children:[u.jsxs("div",{className:"space-y-1 pr-8",children:[u.jsxs("div",{className:"flex items-center gap-2 text-neutral-900",children:[u.jsx("div",{className:"p-1.5 bg-neutral-900 rounded-lg text-white",children:u.jsx(Rl,{size:14})}),u.jsx("h3",{className:"font-black text-lg tracking-tight",children:a})]}),u.jsx("p",{className:"text-xs font-medium text-neutral-400 pl-9",children:o})]}),u.jsxs("div",{className:"py-2 space-y-4",children:[!m&&s==="REFINE_WORDS"&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Vocabulary List"}),u.jsx("textarea",{value:x,onChange:me=>v(me.target.value),disabled:V||X,className:"w-full h-32 p-4 bg-neutral-50/50 border border-neutral-200 rounded-2xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none resize-none shadow-inner leading-relaxed transition-all focus:bg-white disabled:opacity-50",placeholder:"word1; word2; word3..."}),u.jsx("p",{className:"text-[9px] text-neutral-400 px-2 text-right",children:"Edit freely. Separated by semicolon (;) or newline."})]}),["REFINE_UNIT","GENERATE_AUDIO_SCRIPT"].includes(s)&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Your Instructions"}),u.jsx("textarea",{value:S,onChange:me=>N(me.target.value),disabled:V||X,placeholder:s==="GENERATE_AUDIO_SCRIPT"?'e.g., "Focus on the definition of key terms"':'e.g., "Add more advanced vocabulary and examples."',className:"w-full h-24 p-4 bg-neutral-50/50 border border-neutral-200 rounded-2xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none resize-none transition-all focus:bg-white disabled:opacity-50"})]}),(s==="GENERATE_LESSON"||s==="GENERATE_WORD_LESSON")&&u.jsx(u.Fragment,{children:u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[u.jsx(wf,{size:10})," Topic"]}),u.jsx("input",{value:T,onChange:me=>_(me.target.value),placeholder:"e.g. Present Perfect Tense, Space Travel",className:"w-full px-4 py-2 bg-neutral-50/50 border border-neutral-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]})}),je&&Te(),s==="GENERATE_UNIT"&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Topic or Request"}),u.jsx("input",{value:S,onChange:me=>N(me.target.value),disabled:V||X,placeholder:'e.g., "Trees", "Technology", "The Ocean"',className:"w-full px-4 py-3 bg-neutral-50/50 border border-neutral-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]}),s==="GENERATE_PLAN"&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"What is your goal?"}),u.jsx("textarea",{value:B,onChange:me=>le(me.target.value),disabled:V||X,placeholder:'e.g., "Prepare for IELTS in 30 days focusing on academic writing"',className:"w-full h-24 p-4 bg-neutral-50/50 border border-neutral-200 rounded-2xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none resize-none transition-all focus:bg-white disabled:opacity-50"})]})]}),u.jsxs("div",{className:"space-y-3 pt-4 border-t border-neutral-100",children:[u.jsx("div",{className:"space-y-2",children:u.jsx("button",{onClick:pe,disabled:V||X,className:`w-full py-3 px-4 rounded-xl font-bold text-xs flex items-center justify-between transition-all group ${ce?"bg-green-50 text-green-700 border border-green-200":"bg-neutral-50 text-neutral-600 border border-neutral-200 hover:border-neutral-300 hover:bg-white"} disabled:opacity-50`,children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:`p-1.5 rounded-md ${ce?"bg-green-200 text-green-800":"bg-white text-neutral-400 shadow-sm"}`,children:ce?u.jsx(Nl,{size:14}):u.jsx(J2,{size:14})}),u.jsx("span",{className:"uppercase tracking-widest text-[10px]",children:ce?"Command Copied":"Step 1: Copy Command"})]})})}),u.jsxs("div",{className:`relative flex items-start gap-2 p-1.5 rounded-2xl border-2 transition-all ${Y?"border-red-100 bg-red-50/30":X?"border-green-200 bg-green-50":"border-neutral-100 bg-white focus-within:border-neutral-900 focus-within:shadow-md"}`,children:[u.jsx("div",{className:"pl-3 py-3 shrink-0",children:X?u.jsx(Nl,{size:18,className:"text-green-600"}):u.jsx(Y2,{size:18,className:Y?"text-red-400":"text-neutral-400"})}),u.jsx("textarea",{ref:he,value:X?"Data applied! Success.":se,onChange:me=>{Z(me.target.value),A(null)},onKeyDown:Le,disabled:V||X,placeholder:V?"Processing data...":"Step 2: Paste AI response...",className:`w-full bg-transparent border-none text-xs font-medium placeholder:text-neutral-400 focus:ring-0 outline-none resize-none min-h-[70px] p-2 ${X?"text-green-700 font-bold":"text-neutral-800"}`,rows:3,autoComplete:"off"}),u.jsx("button",{onClick:Ie,disabled:!se.trim()||V,className:"p-2.5 rounded-xl transition-all shadow-md active:scale-90 flex items-center justify-center w-10 h-10 self-end bg-neutral-900 text-white hover:bg-neutral-800 disabled:opacity-20 disabled:scale-95",children:V?u.jsx(fn,{size:16,className:"animate-spin"}):u.jsx(eI,{size:16})})]})]})]})]})})},Hd=({title:n,icon:e,suggestions:s})=>!s||s.length===0?null:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("h4",{className:"text-xs font-black uppercase tracking-widest text-neutral-500 flex items-center gap-2 border-b border-neutral-200 pb-2",children:[e,n]}),u.jsx("ul",{className:"space-y-3",children:s.map((a,o)=>u.jsxs("li",{className:"flex items-start gap-3",children:[a.suggestion==="learn"?u.jsx(Nl,{size:16,className:"text-green-500 shrink-0 mt-0.5"}):u.jsx(Z2,{size:16,className:"text-neutral-400 shrink-0 mt-0.5"}),u.jsxs("div",{children:[u.jsx("p",{className:`font-bold text-sm ${a.suggestion==="ignore"?"text-neutral-500":"text-neutral-900"}`,children:a.item}),u.jsxs("p",{className:"text-xs text-neutral-600 italic",children:['"',a.reason,'"']})]})]},o))})]}),Fk=({isOpen:n,onClose:e,suggestions:s})=>!n||!s?null:u.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col max-h-[90vh]",children:[u.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-start shrink-0",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-xl font-black text-neutral-900 flex items-center gap-2",children:[u.jsx(Ng,{size:20,className:"text-amber-500"})," Learning Suggestions"]}),u.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:s.overall_summary})]}),u.jsx("button",{type:"button",onClick:e,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:u.jsx(Rn,{size:20})})]}),u.jsxs("main",{className:"p-8 overflow-y-auto space-y-6",children:[u.jsx(Hd,{title:"Word Family",icon:u.jsx(wf,{size:14}),suggestions:s.wordFamily}),u.jsx(Hd,{title:"Collocations",icon:u.jsx(Sf,{size:14}),suggestions:s.collocations}),u.jsx(Hd,{title:"Idioms",icon:u.jsx(Tf,{size:14}),suggestions:s.idioms}),u.jsx(Hd,{title:"Paraphrases (Word Power)",icon:u.jsx(Af,{size:14}),suggestions:s.paraphrases})]})]})});function L1(n,e){var s,a,o;switch(e.type){case"REINITIALIZE":const l=e.payload;return{...l,register:l.register||"raw",groupsString:((s=l.groups)==null?void 0:s.join(", "))||"",studiedStatus:l.lastReview&&l.lastGrade||"NEW",collocationsArray:l.collocationsArray||(l.collocations?l.collocations.split(`
`).map(y=>({text:y.trim(),isIgnored:!1})):[]),idiomsList:l.idiomsList||(l.idioms?l.idioms.split(`
`).map(y=>({text:y.trim(),isIgnored:!1})):[]),prepositionsList:l.prepositions||[],wordFamily:l.wordFamily||{nouns:[],verbs:[],adjs:[],advs:[]},paraphrases:l.paraphrases||[],essayEdit:((a=l.lesson)==null?void 0:a.essay)||"",testEdit:((o=l.lesson)==null?void 0:o.test)||""};case"SET_FIELD":return{...n,[e.payload.field]:e.payload.value};case"SET_FLAG":const{flag:d}=e.payload,p={...n,[d]:!n[d]};return["isIdiom","isPhrasalVerb","isCollocation","isStandardPhrase"].includes(d)&&p[d]&&(d!=="isIdiom"&&(p.isIdiom=!1),d!=="isPhrasalVerb"&&(p.isPhrasalVerb=!1),d!=="isCollocation"&&(p.isCollocation=!1),d!=="isStandardPhrase"&&(p.isStandardPhrase=!1)),p;case"SET_LIST_ITEM":return{...n,[e.payload.list]:e.payload.data};case"APPLY_AI_MERGE":const m=Vk(n,e.payload);return{...n,...m,register:m.register,prepositionsList:m.prepositions||[]};default:return n}}const Hk=({word:n,user:e,onSave:s,onClose:a,onSwitchToView:o})=>{const{showToast:l}=ea(),[d,p]=M.useReducer(L1,n,L=>L1({},{type:"REINITIALIZE",payload:L})),[m,y]=M.useState(!1),[x,v]=M.useState(null),[S,N]=M.useState(!1),[z,D]=M.useState(!1);M.useEffect(()=>{p({type:"REINITIALIZE",payload:n}),v(null)},[n]);const j=L=>jk(L.words.split(/[,\n]+/).map(O=>O.trim()).filter(Boolean),e.nativeLanguage||"Vietnamese"),P=L=>{const O=Array.isArray(L)?L[0]:L;O&&(p({type:"APPLY_AI_MERGE",payload:O}),y(!1))},F=()=>{x?N(!0):D(!0)},G=L=>Lk(d,e),H=L=>{L&&L.overall_summary?(v(L),D(!1),N(!0)):l("Invalid suggestion format from AI.","error")},W=L=>{L&&L.preventDefault();const{groupsString:O,studiedStatus:_e,collocationsArray:ye,idiomsList:B,prepositionsList:le,essayEdit:se,testEdit:Z,...Y}=d;let A=Y.wordFamily;if(A){const he={};let xe=!1;["nouns","verbs","adjs","advs"].forEach(je=>{var Ie;const pe=((Ie=A[je])==null?void 0:Ie.filter(Le=>Le.word.trim()))||[];pe.length>0&&(he[je]=pe,xe=!0)}),A=xe?he:void 0}let V={...Y,wordFamily:A,prepositions:le.filter(he=>he.prep.trim()).length>0?le.filter(he=>he.prep.trim()):void 0,collocationsArray:ye.filter(he=>he.text.trim()),collocations:ye.filter(he=>he.text.trim()).map(he=>he.text).join(`
`),idiomsList:B.filter(he=>he.text.trim()),idioms:B.filter(he=>he.text.trim()).map(he=>he.text).join(`
`),lesson:{essay:se,test:Z},groups:O.split(",").map(he=>he.trim()).filter(Boolean),updatedAt:Date.now()};const q={...V.lastTestResults||{}},X=new Set((V.collocationsArray||[]).filter(he=>!he.isIgnored).map(he=>he.text.toLowerCase())),de=new Set((V.idiomsList||[]).filter(he=>!he.isIgnored).map(he=>he.text.toLowerCase())),ce=new Set((V.prepositions||[]).filter(he=>!he.isIgnored).map(he=>he.prep.toLowerCase())),fe=new Set((V.paraphrases||[]).filter(he=>!he.isIgnored).map(he=>he.word.toLowerCase())),ie=new Set;V.wordFamily&&["nouns","verbs","adjs","advs"].forEach(he=>{(V.wordFamily[he]||[]).forEach(xe=>{!xe.isIgnored&&xe.word.trim()&&ie.add(xe.word.trim().toLowerCase())})});for(const he in q){const xe=he.split(":"),je=xe[0],pe=xe.slice(1).join(":").toLowerCase();let Ie=!1;switch(je){case"COLLOCATION_QUIZ":X.has(pe)||(Ie=!0);break;case"IDIOM_QUIZ":de.has(pe)||(Ie=!0);break;case"PREPOSITION_QUIZ":ce.has(pe)||(Ie=!0);break;case"PARAPHRASE_QUIZ":fe.has(pe)||(Ie=!0);break;case"WORD_FAMILY":ie.has(pe)||(Ie=!0);break}Ie&&delete q[he]}V.lastTestResults=q;const Ae=n.lastReview&&n.lastGrade||"NEW";_e!==Ae?_e==="NEW"?V=qw(V):V=Gw(V,_e):(V.complexity=kr(V),V.masteryScore=Ns(V),V.gameEligibility=jr(V)),s(V),l("Word saved successfully!","success")},Q=L=>{const O=d[L]||[];return{update:(_e,ye)=>p({type:"SET_LIST_ITEM",payload:{list:L,data:[...O].map((B,le)=>le===_e?{...B,...ye}:B)}}),toggleIgnore:_e=>p({type:"SET_LIST_ITEM",payload:{list:L,data:[...O].map((ye,B)=>B===_e?{...ye,isIgnored:!ye.isIgnored}:ye)}}),remove:_e=>p({type:"SET_LIST_ITEM",payload:{list:L,data:O.filter((ye,B)=>B!==_e)}}),add:_e=>p({type:"SET_LIST_ITEM",payload:{list:L,data:[...O,_e]}})}},I=L=>{const O=d.wordFamily||{nouns:[],verbs:[],adjs:[],advs:[]},_e=ye=>p({type:"SET_LIST_ITEM",payload:{list:"wordFamily",data:{...O,...ye}}});return{update:(ye,B,le)=>{const se=[...O[L]||[]];se[ye]={...se[ye],[B]:le},_e({[L]:se})},toggleIgnore:ye=>{const B=[...O[L]||[]];B[ye]={...B[ye],isIgnored:!B[ye].isIgnored},_e({[L]:B})},remove:ye=>{_e({[L]:(O[L]||[]).filter((B,le)=>le!==ye)})},add:()=>{const ye={word:"",isIgnored:L==="advs"};_e({[L]:[...O[L]||[],ye]})}}},T=Q("prepositionsList"),_=Q("collocationsArray"),C=Q("idiomsList"),R=Q("paraphrases");return u.jsxs(u.Fragment,{children:[u.jsx(zk,{onClose:a,onSwitchToView:()=>o(n),formData:d,setFormData:(L,O)=>p({type:"SET_FIELD",payload:{field:L,value:O}}),setFlag:L=>p({type:"SET_FLAG",payload:{flag:L}}),familyHandler:I,prepList:T,collocList:_,idiomList:C,paraList:R,handleSubmit:W,onOpenAiRefine:()=>y(!0),onSuggestLearn:F,hasSuggestions:!!x}),u.jsx(Fk,{isOpen:S,onClose:()=>N(!1),suggestions:x}),m&&u.jsx(yg,{isOpen:m,onClose:()=>y(!1),type:"REFINE_WORDS",title:"Manual AI Refinement",description:`Refining details for "${d.word}"`,initialData:{words:d.word},user:e,onGeneratePrompt:j,onJsonReceived:P,actionLabel:"Apply to Word",hidePrimaryInput:!0}),z&&u.jsx(yg,{isOpen:z,onClose:()=>D(!1),type:"REFINE_WORDS",title:"Get Learning Suggestions",description:"AI will suggest what to focus on based on your profile.",initialData:{words:n.word},user:e,onGeneratePrompt:G,onJsonReceived:H,hidePrimaryInput:!0})]})},Gk=1500;let ro=[],Yt=null,vf=!1,Ln=!1,T0=[],zc=null,Vs=!1,cr=0,gl=0,mo=1,ao=null;function qk(n){const e=n.numberOfChannels,s=n.length*e*2+44,a=new ArrayBuffer(s),o=new DataView(a),l=[];let d,p,m=0,y=0;for(v(1179011410),v(s-8),v(1163280727),v(544501094),v(16),x(1),x(e),v(n.sampleRate),v(n.sampleRate*2*e),x(e*2),x(16),v(1635017060),v(s-y-4),d=0;d<n.numberOfChannels;d++)l.push(n.getChannelData(d));for(;y<s;){for(d=0;d<e;d++)p=Math.max(-1,Math.min(1,l[d][m])),p=(p<0?p*32768:p*32767)|0,o.setInt16(y,p,!0),y+=2;m++}return new Blob([a],{type:"audio/wav"});function x(S){o.setUint16(y,S,!0),y+=2}function v(S){o.setUint32(y,S,!0),y+=4}}const $k=()=>{ao=null},A0=async n=>{if(n)return ao=n.replace(/\/$/,""),ao;if(ao)return ao;const e=wt();return ao=Bn(e),ao};function Yk(){if(typeof window>"u"||!window.speechSynthesis)return;const n=()=>{const e=window.speechSynthesis.getVoices();e&&e.length>0&&(ro=Array.from(e))};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)}Yk();const Qk=()=>new Promise(n=>{const e=window.speechSynthesis.getVoices();if(e.length>0)ro=Array.from(e),n(ro);else{const s=()=>{const a=window.speechSynthesis.getVoices();a.length>0&&(ro=Array.from(a),n(ro),window.speechSynthesis.onvoiceschanged=null)};window.speechSynthesis.onvoiceschanged=s,setTimeout(()=>{const a=window.speechSynthesis.getVoices();ro=Array.from(a),n(ro)},1e3)}}),Wk=async n=>{try{const s=`${await A0(n)}/voices`,a=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(2e3)});if(!a.ok)throw new Error(`HTTP ${a.status}`);return await a.json()}catch{return null}},zn=n=>{vf=n,window.dispatchEvent(new CustomEvent("audio-status-changed",{detail:{isSpeaking:vf,isAudioPaused:Ln,isSingleWordPlayback:Vs}}))},Ff=n=>String(n||"").trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(//g,"d").replace(//g,"D").toLowerCase().replace(/[^a-z0-9'-]/g,""),Kk=n=>{if(!n)return null;const e=decodeURIComponent(n);if(!/quality_sound/i.test(e))return null;const o=(e.split("?")[0].split("#")[0].split("/").pop()||"").replace(/\.[a-z0-9]+$/i,"");if(!o)return null;const l=o.replace(/_(N|V|ADJ|ADV|PRO|PREP|CONJ|INTJ|X)_(US|UK)$/i,"").replace(/_(US|UK)$/i,"");return Ff(l)||null},Zk=n=>{const e=Ff(n);return e?!/\s/.test(String(n||"").trim())&&e.length>0:!1},tu=async n=>{const e=Ff(n);if(!e)return!1;if(Eu(n)==="vi")return console.log("[VI FLOW] Skip CoachLookup because detected Vietnamese:",n),!1;const a=wt(),o=Bn(a);try{const l=await fetch(`${o}/api/lookup/cambridge/cache?word=${encodeURIComponent(e)}`,{signal:AbortSignal.timeout(6e3),cache:"no-store"});if(l.ok){const d=await l.text(),p=d?JSON.parse(d):null;if(p!=null&&p.exists)return window.dispatchEvent(new CustomEvent("coach-cambridge-lookup-request",{detail:{word:e,data:p}})),!0}}catch{}try{const l=await fetch(`${o}/api/lookup/cambridge/simple?word=${encodeURIComponent(e)}`,{signal:AbortSignal.timeout(12e3),cache:"no-store"});if(!l.ok)return!1;const d=await l.text(),p=d?JSON.parse(d):null;if(!(p!=null&&p.exists))try{const m=await fetch(`${o}/api/convert/ipa?text=${encodeURIComponent(e)}&mode=2`,{signal:AbortSignal.timeout(6e3),cache:"no-store"});if(!m.ok)return!1;const y=await m.json().catch(()=>null);return y!=null&&y.ipa?(window.dispatchEvent(new CustomEvent("coach-ipa-fallback-request",{detail:{word:e,ipa:y.ipa}})),!0):!1}catch{return!1}return window.dispatchEvent(new CustomEvent("coach-cambridge-lookup-request",{detail:{word:e,data:p}})),!0}catch{return!1}},_u=n=>{cr+=1,gl+=1,Yt&&(Yt.pause(),Yt.src="",Yt=null),typeof window<"u"&&window.speechSynthesis&&window.speechSynthesis.cancel(),zc=null,Vs=!1,Ln=!1,T0=[],n||zn(!1)},xT=()=>{_u(!1)},Bc=()=>vf,Fc=()=>Ln,Hc=()=>Vs,bT=()=>T0,rf=()=>mo,vT=n=>{const e=Number.isFinite(n)?Math.min(2,Math.max(.5,n)):1;mo=Math.round(e*100)/100,Yt&&(Yt.playbackRate=mo),window.dispatchEvent(new CustomEvent("audio-status-changed",{detail:{isSpeaking:vf,isAudioPaused:Ln,isSingleWordPlayback:Vs,playbackRate:mo}}))},_T=()=>{!Yt||Yt.paused||(Yt.pause(),Ln=!0,zn(!0))},ET=async()=>{if(!(!Yt||!Yt.paused))try{await Yt.play(),Ln=!1,zn(!0)}catch(n){throw zn(!1),n}},Xk=async(n,e)=>{const s=wt(),a=Bn(s),o=e==="vi"||e==="vn"?"vi":e==="en"?"en":void 0,l=o||Eu(n),d=s.audioCoach.activeCoach,p=s.audioCoach.coaches[d],m=l==="vi"?p.viVoice:p.enVoice,y=l==="vi"?p.viAccent:p.enAccent;try{const x=`${a}/speak`,v=await fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,language:l,accent:y,voice:m}),signal:AbortSignal.timeout(2e4)});if(v.ok)return await v.blob()}catch(x){console.error("Prefetch failed",x)}return null},wT=(n,e)=>{_u(!0);const s=++cr;Ln=!1,zc=e!=null&&e.isSingleWord&&(e!=null&&e.word)?e.word:null,Vs=!!(e!=null&&e.isSingleWord),zn(!0);const a=zc,o=a?tu(a):Promise.resolve(!1),l=URL.createObjectURL(n),d=new Audio(l);return d.playbackRate=mo,Yt=d,new Promise((p,m)=>{d.play().then(()=>{d.onended=()=>{if(s!==cr||Yt!==d){URL.revokeObjectURL(l),p(!0);return}URL.revokeObjectURL(l),zc=null,Ln=!1,zn(!1),a&&o.then(y=>{y||tu(a)}),p(!0)}}).catch(y=>{if(s!==cr||Yt!==d){URL.revokeObjectURL(l),p(!1);return}URL.revokeObjectURL(l),zc=null,Vs=!1,Ln=!1,zn(!1),m(y)})})},Jk=async(n,e,s,a,o)=>{_u(!0);const l=++gl,d=e==="en"&&Zk(n);Vs=d,Ln=!1,zn(!0);try{const m=`${await A0(o)}/speak`,x=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,language:e,accent:s,voice:a}),signal:AbortSignal.timeout(2e4)});if(l!==gl)return!0;if(!x.ok)throw new Error("Server unreachable");const v=x.headers.get("Content-Type");if(v&&v.includes("audio")){const S=await x.blob();if(l!==gl)return!0;const N=x.headers.get("X-TTS-Source")||void 0,z=x.headers.get("X-TTS-Word")||void 0,D=d?Ff(n):void 0;return await wT(S,{source:N,word:z||D,isSingleWord:d})}else return l!==gl||(Vs=!1,Ln=!1,zn(!1)),!0}catch(p){if(l!==gl)return!0;throw Ln=!1,zn(!1),p}},e4=(n,e,s="en")=>new Promise(a=>{if(typeof window>"u"||!window.speechSynthesis)return a(!1);_u(!0);const o=++cr;Ln=!1,zn(!0);const l=new SpeechSynthesisUtterance(n);l.lang=s==="vi"?"vi-VN":"en-US";const d=window.speechSynthesis.getVoices(),p=e&&d.find(m=>m.name===e)||d.find(m=>m.lang.startsWith(s));p&&(l.voice=p),l.rate=Math.min(2,Math.max(.5,.95*mo)),l.onend=()=>{if(o!==cr)return a(!0);Ln=!1,zn(!1),a(!0)},l.onerror=()=>{if(o!==cr)return a(!1);Ln=!1,zn(!1),a(!1)},window.speechSynthesis.speak(l)}),Eu=n=>/[]/i.test(n)?"vi":"en",t4=n=>n?n.substring(0,Gk).normalize("NFD").replace(/\*+/g,"").replace(//g,", ").replace(/[^a-zA-Z0-9.,!?%'\-\s\u00C0-\u1EF9]/g,"").trim():"",ns=async(n,e=!1,s,a,o,l)=>{if(typeof window>"u"||!n)return;const d=t4(n);if(!d)return;if(l)try{await wT(l);return}catch{console.warn("Play preloaded failed, falling back to standard")}const p=wt(),m=p.audioCoach.activeCoach,y=p.audioCoach.coaches[m],x=Bn(p),v=s==="vi"||s==="vn"?"vi":s==="en"?"en":void 0,S=v||Eu(n),N=a!==void 0?a:S==="vi"?y.viVoice:y.enVoice,z=o!==void 0?o:S==="vi"?y.viAccent:y.enAccent;try{await Jk(d,S,z,N,x);return}catch{await e4(d,N,S)}},ST=async(n,e,s,a)=>{_u(!0);const o=++cr;T0=a||[];const l=Kk(n);Vs=!!l;const d=l?tu(l):Promise.resolve(!1),p=await A0();let m=n;if(!n.startsWith("http")){const x=n.startsWith("/")?n.slice(1):n;x.startsWith("api/")?m=`${p}/${x}`:m=`${p}/api/audio/stream/${x}`}const y=new Audio(m);return y.playbackRate=mo,Yt=y,new Promise((x,v)=>{const S=()=>{if(e!==void 0&&(y.currentTime=e),s!==void 0){const N=(e||0)+s,z=()=>{if(y.currentTime>=N){if(o!==cr||Yt!==y){x(!0);return}y.pause(),zn(!1),y.removeEventListener("timeupdate",z),l&&d.then(D=>{D||tu(l)}),Vs=!1,x(!0)}};y.addEventListener("timeupdate",z)}zn(!0),Ln=!1,y.play().then(()=>{y.onended=()=>{if(o!==cr||Yt!==y){x(!0);return}Vs=!1,Ln=!1,zn(!1),l&&d.then(N=>{N||tu(l)}),x(!0)}}).catch(N=>{if(o!==cr||Yt!==y){x(!1);return}Vs=!1,Ln=!1,zn(!1),v(N)})};y.readyState>=1?S():y.onloadedmetadata=S,y.onerror=N=>{if(o!==cr||Yt!==y){x(!1);return}Vs=!1,Ln=!1,zn(!1),v(N)}})},I0=async()=>{const n=await navigator.mediaDevices.getUserMedia({audio:!0}),e=["audio/webm;codecs=opus","audio/webm","audio/mp4"].find(s=>MediaRecorder.isTypeSupported(s));lr=new MediaRecorder(n,e?{mimeType:e}:void 0),xg=[],lr.ondataavailable=s=>{s.data.size>0&&xg.push(s.data)},lr.start()};let lr=null,xg=[];const N0=()=>new Promise(n=>{if(!lr)return n(null);const e=lr.mimeType||"audio/webm";lr.onstop=()=>{const s=new Blob(xg,{type:e}),a=new FileReader;a.readAsDataURL(s),a.onloadend=()=>{const l=a.result.split(",")[1]||"";n({base64:l,mimeType:e})},lr==null||lr.stream.getTracks().forEach(o=>o.stop()),lr=null},lr.state!=="inactive"?lr.stop():n(null)}),yl=n=>{Yt&&(Yt.currentTime=n)},TT=()=>Yt?{currentTime:Yt.currentTime,duration:Yt.duration||0}:null,n4=Object.freeze(Object.defineProperty({__proto__:null,bufferToWav:qk,detectLanguage:Eu,fetchServerVoices:Wk,getAudioProgress:TT,getAvailableVoices:Qk,getIsAudioPaused:Fc,getIsSingleWordPlayback:Hc,getIsSpeaking:Bc,getMarkPoints:bT,getPlaybackRate:rf,pauseSpeaking:_T,playSound:ST,prefetchSpeech:Xk,resetAudioProtocolCache:$k,resumeSpeaking:ET,seekAudio:yl,setPlaybackRate:vT,speak:ns,startRecording:I0,stopRecording:N0,stopSpeaking:xT},Symbol.toStringTag,{value:"Module"}));typeof window<"u"&&(window.checkMarkdownQuiz=n=>{const e=n.getAttribute("data-answer");if(!e)return;const a=n.value.trim().toLowerCase()===e.trim().toLowerCase();n.classList.remove("border-neutral-300","text-neutral-900","focus:border-indigo-600"),n.classList.remove("border-green-500","text-green-700","bg-green-50"),n.classList.remove("border-red-500","text-red-700","bg-red-50"),a?n.classList.add("border-green-500","text-green-700","bg-green-50"):n.classList.add("border-red-500","text-red-700","bg-red-50")},window.checkDropdownQuiz=n=>{const e=n.parentElement;if(!e)return;const s=e.querySelector("select");if(!s)return;const a=s.getAttribute("data-answer"),o=s.value;if(!o)return;const l=o===a;if(s.disabled=!0,n.disabled=!0,n.classList.add("opacity-0","pointer-events-none"),s.classList.remove("border-neutral-300","text-neutral-900","focus:border-indigo-600"),s.classList.remove("bg-white"),l)s.classList.add("border-green-500","text-green-700","bg-green-50","font-bold");else{s.classList.add("border-red-500","text-red-700","bg-red-50","line-through");const d=document.createElement("span");d.className="ml-2 text-xs font-bold text-green-600 bg-green-50 px-1.5 py-0.5 rounded border border-green-200 animate-in fade-in",d.innerText=a||"",e.appendChild(d)}},window.checkMultiChoice=n=>{var l;const e=n.parentElement;if(!e)return;const s=e.getAttribute("data-answer"),a=(l=n.textContent)==null?void 0:l.trim();e.querySelectorAll("button").forEach(d=>{var p;d.disabled=!0,d.classList.add("opacity-50","cursor-not-allowed"),((p=d.textContent)==null?void 0:p.trim())===s&&(d.classList.remove("bg-white","text-neutral-700","opacity-50"),d.classList.add("bg-green-500","text-white","border-green-600"))}),a===s?(n.classList.remove("opacity-50"),n.classList.add("ring-2","ring-green-300")):(n.classList.remove("bg-white","text-neutral-700","opacity-50"),n.classList.add("bg-red-500","text-white","border-red-600"))},window.handleLessonSound=(n,e,s,a)=>{ST(n,e,s,a).catch(o=>console.error("Sound play failed",o))},window.handleWordAudioSpeak=n=>{const e=window.handleLessonSpeak;typeof e=="function"?e(n):console.warn("handleLessonSpeak is not registered in current view.")},window.handleMarkdownNav=n=>{const e=String(n||"").trim().toLowerCase();if(!e)return;const s=window.resolveMarkdownNav;if(typeof s=="function"&&s(e))return;const a=Array.from(document.querySelectorAll("h1, h2, h3, h4")),o=a.find(p=>(p.textContent||"").trim().toLowerCase()===e),l=a.find(p=>(p.textContent||"").trim().toLowerCase().includes(e)),d=o||l;d&&d.scrollIntoView({behavior:"smooth",block:"start"})});const s4=n=>{if(!n[0].trim().startsWith("|"))return null;const e=[];for(const m of n)if(m.trim().startsWith("|"))e.push(m);else break;if(e.length===0)return null;const s=m=>{const y=m.split("|");return m.trim().startsWith("|")&&y.shift(),m.trim().endsWith("|")&&y.pop(),y.map(x=>x.trim())},a=/^\|?(\s*:?-+:?\s*\|)+\s*$/;let o=!1;e.length>1&&a.test(e[1].trim())&&(o=!0);let l='<div class="overflow-x-auto my-4 border border-neutral-200 rounded-xl shadow-sm"><table class="w-full text-sm text-left border-collapse">';const d=s(e[0]);l+='<thead class="bg-neutral-50 text-neutral-900 uppercase font-bold text-xs"><tr>',d.forEach(m=>l+=`<th class="px-6 py-3 border-b border-neutral-200 min-w-[100px]">${m}</th>`),l+="</tr></thead>",l+='<tbody class="divide-y divide-neutral-100 bg-white">';const p=o?2:1;for(let m=p;m<e.length;m++){const y=s(e[m]);l+='<tr class="hover:bg-neutral-50/50 transition-colors">';for(let x=0;x<d.length;x++){const v=y[x]||"";l+=`<td class="px-6 py-4 font-medium text-neutral-600 align-top">${v}</td>`}l+="</tr>"}return l+="</tbody></table></div>",{html:l,consumed:e.length}},r4=n=>n.replace(/\[HIDDEN:\s*(.*?)\]/gi,(e,s)=>`<button type="button" onclick="this.outerHTML='<span class=\\'px-1.5 py-0.5 bg-green-50 border border-green-200 text-green-800 rounded-md text-sm font-bold animate-in fade-in zoom-in-95 inline-block align-baseline mx-1\\'>${s.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"\\'")}</span>'" class="inline-flex flex-nowrap whitespace-nowrap items-center gap-1.5 px-2 py-0.5 bg-indigo-50 hover:bg-indigo-100 text-indigo-600 rounded-md text-[10px] font-black uppercase tracking-wider transition-colors select-none border border-indigo-100 shadow-sm align-middle my-0.5 mx-1"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="shrink-0"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>Reveal</button>`),a4=n=>n.replace(/\[Quiz:\s*(.*?)\]/gi,(e,s)=>{const a=s.trim(),o=Math.max(3,a.length);return`<span class="inline-flex items-center gap-1 align-middle mx-1 whitespace-nowrap"><input type="text" data-answer="${a.replace(/"/g,"&quot;")}" placeholder="?" class="border-b-2 border-neutral-300 bg-transparent text-center font-bold text-neutral-900 outline-none focus:border-indigo-600 transition-all rounded-t-md px-1 py-0.5 text-sm" style="width: ${o}ch; min-width: 40px;" onkeydown="if(event.key==='Enter') window.checkMarkdownQuiz(this)" /><button onclick="window.checkMarkdownQuiz(this.previousElementSibling)" class="p-1 text-neutral-400 hover:text-indigo-600 transition-colors bg-neutral-100 hover:bg-indigo-50 rounded-full shadow-sm" title="Check Answer"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg></button></span>`}),i4=n=>n.replace(/\[Select:\s*(.*?)\]/gi,(e,s)=>{const a=s.split("|").map(p=>p.trim()).filter(p=>p.length>0);if(a.length<2)return`[Invalid Select: ${s}]`;const o=a[0],l=[...a];for(let p=l.length-1;p>0;p--){const m=Math.floor(Math.random()*(p+1));[l[p],l[m]]=[l[m],l[p]]}let d='<span class="inline-flex items-center gap-1 align-middle mx-1 whitespace-nowrap">';return d+=`<select data-answer="${o.replace(/"/g,"&quot;")}" class="border-b-2 border-neutral-300 bg-transparent font-bold text-neutral-900 outline-none focus:border-indigo-600 transition-all rounded-t-md px-2 py-0.5 text-sm cursor-pointer hover:bg-neutral-50 appearance-none pr-6 relative" style="min-width: 80px;">`,d+='<option value="" disabled selected>Select...</option>',l.forEach(p=>{d+=`<option value="${p.replace(/"/g,"&quot;")}">${p}</option>`}),d+="</select>",d+='<button onclick="window.checkDropdownQuiz(this)" class="p-1 text-neutral-400 hover:text-indigo-600 transition-colors bg-neutral-100 hover:bg-indigo-50 rounded-full shadow-sm" title="Check Answer"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg></button>',d+="</span>",d}),o4=n=>n.replace(/\[Multi:\s*(.*?)\]/gi,(e,s)=>{const a=s.split("|").map(p=>p.trim()).filter(p=>p.length>0);if(a.length<2)return`[Invalid Multi: ${s}]`;const o=a[0],l=[...a];for(let p=l.length-1;p>0;p--){const m=Math.floor(Math.random()*(p+1));[l[p],l[m]]=[l[m],l[p]]}let d=`<span class="inline-flex flex-wrap items-center gap-1.5 align-middle mx-1" data-answer="${o.replace(/"/g,"&quot;")}">`;return l.forEach(p=>{d+=`<button onclick="window.checkMultiChoice(this)" class="px-2 py-1 bg-white border border-neutral-200 text-neutral-700 rounded-md text-xs font-bold hover:bg-neutral-50 hover:border-neutral-300 transition-all shadow-sm select-none">${p}</button>`}),d+="</span>",d}),l4=n=>n.replace(/\[Formula:?\s*(.*?)\]/gi,(e,s)=>{const a=s.split("|").map(l=>l.trim());let o='<div class="flex flex-wrap items-center gap-2 p-3 my-3 bg-amber-50 border-l-4 border-amber-400 rounded-r-xl shadow-sm">';return o+='<span class="text-[10px] font-black text-amber-500 uppercase tracking-widest mr-1 select-none">Formula</span>',a.forEach(l=>{/^[+,.]+$/.test(l)?o+=`<span class="font-bold text-amber-700">${l}</span>`:o+=`<span class="px-2 py-1 bg-white border border-amber-200 rounded-lg text-amber-900 font-mono text-sm font-bold shadow-sm">${l}</span>`}),o+="</div>",o}),c4=n=>{const e=/\[Audio-(VN|EN)\]([\s\S]*?)\[\/(?:Audio-(?:VN|EN))?\]/gi;return n.replace(e,(s,a,o)=>`<button onclick="window.handleLessonSpeak('${o.replace(/\[HIDDEN:.*?\]/gi,"").replace(/\[Quiz:.*?\]/gi,"").replace(/\[Select:.*?\]/gi,"").replace(/\[Multi:.*?\]/gi,"").replace(/\[Formula:.*?\]/gi,"").replace(/[#*`_~[\]()]/g,"").replace(/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}]/gu,"").replace(/\n/g," ").trim().replace(/'/g,"\\'")}', '${a.toLowerCase()}')" class="inline-flex items-center justify-center w-6 h-6 mr-1.5 bg-indigo-600 text-white hover:bg-indigo-700 rounded-md transition-all active:scale-90 align-middle shadow-sm" title="Listen"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg></button>`+o.trim())},u4=n=>{const e=/\[W_AUDIO\]([\s\S]*?)\[\/\]/gi;return n.replace(e,(s,a)=>{const o=String(a||"").split(",").map(d=>d.trim()).filter(d=>d.length>0);return o.length?`<span class="inline-flex flex-wrap items-center gap-1.5 align-middle my-1">${o.map(d=>`<button onclick="window.handleWordAudioSpeak('${d.replace(/'/g,"\\'")}')" class="inline-flex items-center px-2.5 py-1 bg-white border border-neutral-200 hover:border-indigo-300 hover:bg-indigo-50 text-neutral-700 hover:text-indigo-700 rounded-lg text-xs font-bold transition-all shadow-sm active:scale-95">${d}</button>`).join("")}</span>`:""})},d4=n=>{const e=/\[NAV(?:\s+([^\]]+))?\]([\s\S]*?)\[\/\]/gi;return n.replace(e,(s,a,o)=>{const l=String(o||"").trim(),d=String(a||l).trim();return!l||!d?"":`<button onclick="window.handleMarkdownNav('${d.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/\n/g," ")}')" class="inline-flex items-center gap-1 px-2.5 py-1 bg-neutral-100 border border-neutral-200 hover:bg-neutral-900 hover:text-white hover:border-neutral-900 text-neutral-700 rounded-lg text-xs font-bold transition-all active:scale-95 my-1">${l}</button>`})},f4=n=>n.replace(/\[SOUND\s*(.*?)\]/gi,(e,s)=>{let a=[],o=s;if(s.includes("<")){const v=s.split("<");o=v[0],a=v[1].split(",").map(S=>parseFloat(S.trim())).filter(S=>!isNaN(S)).slice(0,10)}const l=o.split("|").map(v=>v.trim());if(l.length<2)return`[Invalid Sound: ${s}]`;const d=l[0],p=l[1],m=l[2]?parseFloat(l[2]):void 0,y=l[3]?parseFloat(l[3]):void 0,x=[`'${p.replace(/'/g,"\\'")}'`];return(a.length>0||y!==void 0||m!==void 0)&&x.push(m!==void 0?m.toString():"undefined"),(a.length>0||y!==void 0)&&x.push(y!==void 0?y.toString():"undefined"),a.length>0&&x.push(`[${a.join(",")}]`),`<button onclick="window.handleLessonSound(${x.join(", ")})" class="inline-flex items-center gap-2 px-3 py-1.5 bg-white border border-neutral-200 hover:border-indigo-300 hover:bg-indigo-50 text-neutral-700 hover:text-indigo-600 rounded-xl text-xs font-bold transition-all shadow-sm active:scale-95 my-1 mx-1 select-none"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-indigo-500"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>${d}</button>`}),h4=n=>n.replace(/\[IMG\s*(.*?)\]/gi,(e,s)=>{const a=s.split("|").map(y=>y.trim()),o=a[0],l=a[1];let d=o;if(!o.startsWith("http")){const y=wt(),x=Bn(y),v=o.startsWith("/")?o.slice(1):o;v.startsWith("api/")?d=`${x}/${v}`:d=`${x}/api/audio/stream/${v}`}const p=l?`style="width: ${l}; max-width: 100%; height: auto;"`:"";return`<img src="${d}" ${p} ${l?'class="rounded-lg my-4 shadow-md border border-neutral-200"':'class="max-w-full h-auto rounded-lg my-4 shadow-md border border-neutral-200"'} />`}),M1=n=>{if(!n)return"";const e=n.replace(/\\n/g,`
`);let s=c4(e);s=u4(s),s=d4(s),s=f4(s),s=h4(s),s=a4(s),s=i4(s),s=o4(s),s=l4(s),s=r4(s);const a=s.split(`
`),o=[],l=[],d=(p=0)=>{for(;l.length>p;){const m=l.pop();o.push(m.type==="ul"?"</ul>":"</ol>")}};for(let p=0;p<a.length;p++){const m=a[p],y=m.trim();if(!y&&l.length===0){o.push('<br class="block my-2" />');continue}const x=s4(a.slice(p));if(x){d(0),o.push(x.html),p+=x.consumed-1;continue}if(/^([-*_])\s*(\1\s*){2,}$/.test(y)){d(0),o.push('<hr class="my-6 border-t-2 border-neutral-100" />');continue}if(y.startsWith("# ")){d(0),o.push(`<h1 class="text-3xl font-black text-neutral-900 mb-4 mt-8 pb-2 border-b border-neutral-100 leading-tight">${y.substring(2)}</h1>`);continue}if(y.startsWith("## ")){d(0),o.push(`<h2 class="text-xl font-extrabold text-neutral-800 mb-3 mt-6 leading-tight">${y.substring(3)}</h2>`);continue}if(y.startsWith("### ")){d(0),o.push(`<h3 class="text-lg font-bold text-neutral-700 mb-2 mt-4 leading-tight">${y.substring(4)}</h3>`);continue}if(y.startsWith("#### ")){d(0),o.push(`<h4 class="text-sm font-bold text-neutral-600 mb-1 mt-3 uppercase tracking-wider">${y.substring(5)}</h4>`);continue}if(y.startsWith("> ")){d(0),o.push(`<blockquote class="border-l-4 border-amber-400 bg-amber-50 pl-4 py-3 pr-2 my-4 rounded-r-lg text-sm text-neutral-700 font-medium italic shadow-sm">${y.substring(2)}</blockquote>`);continue}const v=y.match(/^\[(?!(HIDDEN:|Quiz:|Select:|QUIZ:|Multi:|Formula:|Audio-|IMG|(\/\])))(.*)\]$/);if(v){d(0);const j='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="shrink-0 mt-0.5 text-sky-500"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.8 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>',P=v[3].trim();o.push(`
                <div class="flex items-start gap-3 my-4 p-4 bg-sky-50 border-l-4 border-sky-400 rounded-r-lg shadow-sm">
                    ${j}
                    <div class="text-sm text-sky-900 font-medium leading-relaxed">
                        ${P}
                    </div>
                </div>
            `);continue}const S=m.match(/^(\s*)/),N=S?S[0].length:0,z=m.match(/^\s*[-*]\s+(.*)/),D=m.match(/^\s*(\d+)\.\s+(.*)/);if(z||D){const j=z?"ul":"ol",P=z?z[1]:D[2],F=D?D[1]:void 0;if(l.length===0||N>l[l.length-1].indent)o.push(j==="ul"?'<ul class="list-disc list-outside pl-5 my-3 space-y-1 text-neutral-700 marker:text-neutral-400">':'<ol class="list-decimal list-outside pl-5 my-3 space-y-1 text-neutral-700 marker:font-bold marker:text-neutral-500">'),l.push({type:j,indent:N});else if(N<l[l.length-1].indent)for(;l.length>0&&N<l[l.length-1].indent;)d(l.length-1);j==="ol"&&F?o.push(`<li value="${F}" class="pl-1">${P}</li>`):o.push(`<li class="pl-1">${P}</li>`);continue}y!==""&&(d(0),o.push(`<p class="mb-2 leading-relaxed text-neutral-600">${m}</p>`))}return d(0),o.join("").replace(/!\[(.*?)\]\((.*?)\)/g,(p,m,y)=>{let x=y;if(!y.startsWith("http")){const v=wt(),S=Bn(v),N=y.startsWith("/")?y.slice(1):y;N.startsWith("api/")?x=`${S}/${N}`:x=`${S}/api/audio/stream/${N}`}return`<img alt="${m}" src="${x}" class="max-w-full h-auto rounded-lg my-4 shadow-md border border-neutral-200" />`}).replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="text-indigo-600 font-bold hover:underline">$1</a>').replace(/\*\*(.*?)\*\*/g,'<strong class="font-black text-neutral-900">$1</strong>').replace(/\*(.*?)\*/g,'<span class="italic font-normal text-inherit">$1</span>').replace(/`([^`]+)`/g,'<code class="bg-neutral-100 text-pink-600 px-1.5 py-0.5 rounded text-xs font-mono font-bold border border-neutral-200">$1</code>')},p4=({score:n})=>{const o=2*Math.PI*16,l=o-n/100*o;let d="text-neutral-400";return n>=80?d="text-green-500":n>=50?d="text-yellow-500":n>0&&(d="text-orange-500"),u.jsxs("div",{className:"relative flex items-center justify-center",style:{width:36,height:36},children:[u.jsxs("svg",{className:"absolute",width:36,height:36,children:[u.jsx("circle",{className:"text-neutral-100",stroke:"currentColor",strokeWidth:4,fill:"transparent",r:16,cx:36/2,cy:36/2}),u.jsx("circle",{className:d,stroke:"currentColor",strokeWidth:4,fill:"transparent",r:16,cx:36/2,cy:36/2,strokeDasharray:o,strokeDashoffset:l,strokeLinecap:"round",style:{transform:"rotate(-90deg)",transformOrigin:"50% 50%",transition:"stroke-dashoffset 0.5s ease-out"}})]}),u.jsx("span",{className:`text-[10px] font-black ${d}`,children:n})]})},m4=({word:n})=>{const e=n.masteryScore??0;return u.jsxs("div",{className:"relative group/score",children:[u.jsx(p4,{score:e}),u.jsxs("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 bg-neutral-800 text-white text-[10px] font-black rounded-lg opacity-0 group-hover/score:opacity-100 transition-opacity pointer-events-none z-10 uppercase tracking-wider",children:["Mastery Score",u.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 w-2 h-2 bg-neutral-800 rotate-45"})]})]})},g4=({register:n})=>{if(!n||n==="neutral"||n==="raw")return null;const e={academic:"bg-purple-100 text-purple-800 border-purple-200",casual:"bg-sky-100 text-sky-800 border-sky-200"},s={academic:"ACADEMIC",casual:"CASUAL"};return u.jsx("span",{className:`px-2 py-0.5 rounded text-[8px] font-black uppercase border ${e[n]}`,children:s[n]})},y4=n=>{const e={intensified:"bg-orange-100 text-orange-700 border-orange-200",softened:"bg-blue-100 text-blue-700 border-blue-200",synonym:"bg-neutral-100 text-neutral-600 border-neutral-200",academic:"bg-purple-100 text-purple-700 border-purple-200",casual:"bg-sky-100 text-sky-700 border-sky-200"};return u.jsx("span",{className:`px-2 py-0.5 rounded text-[8px] font-black uppercase border ${e[n]||e.synonym}`,children:n})},D1=({label:n,options:e,selectedId:s,onSelect:a,buttonClass:o,disabled:l=!1})=>{const[d,p]=M.useState(!1),m=M.useRef(null),y=e.find(x=>x.id===s)||e[0];return M.useEffect(()=>{const x=v=>{m.current&&!m.current.contains(v.target)&&p(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),u.jsxs("div",{className:"relative",ref:m,children:[u.jsxs("button",{type:"button",onClick:()=>p(!d),className:o,disabled:l,children:[n&&u.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-neutral-400 mr-2",children:n}),y.icon,u.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:y.label}),u.jsx(CE,{size:14,className:`transition-transform duration-200 ${d?"rotate-180":""}`})]}),d&&!l&&u.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-2xl shadow-xl border border-neutral-100 z-50 p-2 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col gap-1",children:e.map(x=>u.jsxs("button",{type:"button",onClick:()=>{a(x.id),p(!1)},className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-xs font-bold transition-colors ${s===x.id?"bg-neutral-100 text-neutral-900":"text-neutral-600 hover:bg-neutral-50 hover:text-neutral-900"}`,children:[x.icon,u.jsx("span",{children:x.label})]},x.id))})]})},x4=({word:n,onClose:e,onChallengeRequest:s,onMimicRequest:a,onEditRequest:o,onUpdate:l,linkedUnits:d,relatedWords:p,relatedByGroup:m,onNavigateToWord:y,onAddVariantToLibrary:x,addingVariant:v,existingVariants:S,isViewOnly:N=!1,appliedAccent:z,initialTab:D="OVERVIEW",onGenerateLesson:j})=>{var fe,ie,Ae,he,xe,je,pe,Ie,Le,Te,me,et,Xe;const[P,F]=M.useState(()=>mu("ielts_pro_word_view_settings",{showHidden:!1,highlightFailed:!0,isLearnView:!0})),[G,H]=M.useState(!1),[W,Q]=M.useState(D),[I,T]=M.useState(new Set),_=M.useRef(null),C=re=>{ns(re)};M.useEffect(()=>{Zg("ielts_pro_word_view_settings",P)},[P]);const R=(re,Fe)=>F(rt=>({...rt,[re]:Fe}));M.useEffect(()=>{const re=Fe=>{_.current&&!_.current.contains(Fe.target)&&H(!1)};return document.addEventListener("mousedown",re),()=>document.removeEventListener("mousedown",re)},[]),M.useEffect(()=>(window.handleLessonSpeak=(re,Fe)=>{ns(re,!1,Fe)},()=>{delete window.handleLessonSpeak}),[]);const L=[{id:"NEW",label:"New",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"})},{id:Lt.LEARNED,label:"Learned",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-cyan-500"})},{id:Lt.FORGOT,label:"Forgot",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-rose-500"})},{id:Lt.HARD,label:"Hard",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"})},{id:Lt.EASY,label:"Easy",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}],O=n.lastReview&&n.lastGrade||"NEW",_e=re=>{if(!N)if(re==="NEW"){const Fe=qw(n);l(Fe)}else{const Fe=Gw(n,re);l(Fe)}},ye=[{id:Ft.RAW,label:"Raw",icon:u.jsx(LE,{size:14,className:"text-neutral-400"})},{id:Ft.REFINED,label:"Needs Review",icon:u.jsx(qE,{size:14,className:"text-indigo-500"})},{id:Ft.VERIFIED,label:"Verified",icon:u.jsx(FE,{size:14,className:"text-emerald-500"})},{id:Ft.FAILED,label:"Incorrect",icon:u.jsx(HE,{size:14,className:"text-rose-500"})}],B=(re,Fe,rt,Tt)=>{const Ze=Array.isArray(Fe)?Fe.filter(tt=>P.showHidden||!tt.isIgnored):[];return Ze.length===0?null:u.jsxs("div",{className:"space-y-1",children:[u.jsx("span",{className:`text-[8px] font-black uppercase text-${rt}-600 tracking-widest ml-1`,children:re}),u.jsx("div",{className:"flex flex-col gap-1",children:Ze.map((tt,ut)=>{var De,Ne;const At=S.has(tt.word.toLowerCase()),Ht=`WORD_FAMILY:${Tt}:${tt.word.toLowerCase().trim()}`,fr=n.lastTestResults&&Ht in n.lastTestResults,hr=fr?n.lastTestResults[Ht]:void 0;let Cs=!1;if(fr)Cs=hr===!1;else{const bt=`WORD_FAMILY_${Tt.toUpperCase()}`,it=(De=n.lastTestResults)==null?void 0:De[bt];(it===!1||it===void 0&&((Ne=n.lastTestResults)==null?void 0:Ne.WORD_FAMILY)===!1)&&(Cs=!0)}const ys=P.highlightFailed&&Cs&&!tt.isIgnored,pn=tt.isIgnored;let be="bg-white border-neutral-100 hover:border-neutral-300";return ys?be="bg-red-50 border-red-200 hover:border-red-300":pn&&(be="bg-neutral-50/50 border-neutral-100 opacity-60"),u.jsxs("div",{className:`flex items-center justify-between px-2 py-1.5 rounded-lg border group transition-colors ${be}`,children:[" ",u.jsxs("div",{className:"flex flex-col overflow-hidden",children:[" ",u.jsxs("div",{className:"flex items-center gap-1.5",children:[" ",u.jsx("span",{className:`text-[10px] font-bold truncate ${ys?"text-red-700":"text-neutral-900"} ${pn?"line-through decoration-neutral-400":""}`,children:tt.word})," ",u.jsx("button",{onClick:bt=>{bt.stopPropagation(),ns(tt.word)},className:"text-neutral-300 hover:text-indigo-500 transition-colors p-0.5",children:u.jsx(wr,{size:10})})," ",ys&&u.jsx(Ca,{size:10,className:"text-red-500 fill-red-100 shrink-0"})," "]})," "]})," ",u.jsx("button",{type:"button",disabled:v===tt.word||At,onClick:()=>x({word:tt.word,ipa:""},"family"),className:`p-1 rounded-md transition-all ${At?"text-green-500 cursor-default":"text-neutral-300 hover:text-neutral-900 hover:bg-neutral-100"}`,children:v===tt.word?u.jsx(fn,{size:10,className:"animate-spin"}):At?u.jsx(Er,{size:10}):u.jsx(Kr,{size:10})})," "]},ut)})})]})},le=({title:re,icon:Fe,children:rt,className:Tt})=>u.jsxs("div",{className:`space-y-2 ${Tt||""}`,children:[u.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-black uppercase tracking-widest text-neutral-400 border-b border-neutral-100 pb-1 mb-2",children:[u.jsx(Fe,{size:12}),u.jsx("span",{children:re})]}),rt]}),se=uN(n.nextReview),Z=!!(n.wordFamily&&((fe=n.wordFamily.nouns)!=null&&fe.length||(ie=n.wordFamily.verbs)!=null&&ie.length||(Ae=n.wordFamily.adjs)!=null&&Ae.length||(he=n.wordFamily.advs)!=null&&he.length)),Y=(n.prepositions||[]).filter(re=>P.showHidden||!re.isIgnored),A=(n.collocationsArray||[]).filter(re=>P.showHidden||!re.isIgnored),V=(n.idiomsList||[]).filter(re=>P.showHidden||!re.isIgnored),q=(n.paraphrases||[]).filter(re=>P.showHidden||!re.isIgnored),X=P.highlightFailed&&((xe=n.lastTestResults)==null?void 0:xe.SPELLING)===!1;P.highlightFailed&&(((je=n.lastTestResults)==null?void 0:je.IPA_QUIZ)===!1||((pe=n.lastTestResults)==null||pe.PRONUNCIATION)),M.useMemo(()=>{if(!n.wordFamily)return[];const re=[],Fe=["nouns","verbs","adjs","advs"],rt={nouns:"Noun",verbs:"Verb",adjs:"Adjective",advs:"Adverb"};return Fe.forEach(Tt=>{(n.wordFamily[Tt]||[]).forEach(Ze=>{(P.showHidden||!Ze.isIgnored)&&re.push({word:Ze.word,type:rt[Tt],ipa:Ze.ipaUs})})}),re},[n.wordFamily,P.showHidden]);const de=M.useMemo(()=>{var re;return(re=n.lesson)!=null&&re.essay?M1(n.lesson.essay):null},[(Ie=n.lesson)==null?void 0:Ie.essay]),ce=M.useMemo(()=>{var re;return(re=n.lesson)!=null&&re.test?M1(n.lesson.test):null},[(Le=n.lesson)==null?void 0:Le.test]);return u.jsx("div",{className:"fixed inset-0 z-[100] flex items-start sm:items-center justify-center p-2 sm:p-4 bg-black/40 backdrop-blur-sm animate-in fade-in duration-200 overflow-y-auto",children:u.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-2xl sm:rounded-[2.5rem] shadow-2xl flex flex-col max-h-[95vh] sm:max-h-[90vh] overflow-hidden",children:[u.jsx("header",{className:"px-4 sm:px-8 py-4 border-b border-neutral-100 bg-neutral-50/30 flex flex-col gap-2 shrink-0",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-start w-full gap-4",children:[u.jsx("div",{className:"flex-1 w-full",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h2",{className:`text-2xl font-black tracking-tight leading-none ${X?"text-red-600":"text-neutral-900"}`,children:n.word}),X&&u.jsx(Ca,{size:16,className:"text-red-500 fill-red-100"}),!n.isPassive&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:re=>{re.stopPropagation(),C(n.word)},className:"p-2 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 rounded-full transition-colors",title:"Pronounce",children:u.jsx(wr,{size:18})}),u.jsx("button",{onClick:re=>{re.stopPropagation(),a()},className:"p-2 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 rounded-full transition-colors",title:"Mimic",children:u.jsx(To,{size:18})})]}),u.jsxs("div",{className:"relative group",children:[u.jsx("button",{onClick:re=>{re.stopPropagation(),ns(n.meaningVi,!1,"vi")},className:"p-2 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 rounded-full transition-colors",title:"Read Vietnamese meaning",children:u.jsx(wf,{size:18})}),u.jsxs("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-max max-w-xs px-3 py-2 bg-neutral-800 text-white text-xs font-bold rounded-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10",children:[n.meaningVi,u.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 w-2 h-2 bg-neutral-800 rotate-45"})]})]}),u.jsx(m4,{word:n})]})}),u.jsxs("div",{className:"flex items-center gap-2 flex-wrap sm:flex-nowrap justify-end w-full sm:w-auto",children:[u.jsx(D1,{options:L,selectedId:O,onSelect:_e,buttonClass:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg hover:bg-neutral-100 transition-colors shadow-sm border border-neutral-200",disabled:N}),u.jsxs("div",{className:"relative",ref:_,children:[u.jsx("button",{onClick:()=>H(!G),className:`p-2 rounded-lg transition-colors ${G?"bg-neutral-900 text-white shadow-sm":"bg-white border border-neutral-200 text-neutral-400 hover:text-neutral-900"}`,title:"View Options",children:u.jsx(su,{size:16})}),G&&u.jsxs("div",{className:"absolute right-0 top-full mt-2 w-56 bg-white rounded-2xl shadow-xl border border-neutral-100 z-50 p-2 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col gap-1",children:[u.jsx("div",{className:"px-3 py-2 text-[9px] font-black text-neutral-400 uppercase tracking-widest border-b border-neutral-50",children:"View Options"}),u.jsxs("button",{onClick:()=>R("isLearnView",!P.isLearnView),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-neutral-50 text-xs font-bold text-neutral-700 transition-colors",children:[u.jsx("span",{children:"Learn View"}),P.isLearnView?u.jsx(Er,{size:14,className:"text-green-500"}):u.jsx("div",{className:"w-4 h-4 rounded-full border border-neutral-200"})]}),u.jsxs("button",{onClick:()=>R("showHidden",!P.showHidden),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-neutral-50 text-xs font-bold text-neutral-700 transition-colors",children:[u.jsx("span",{children:"Show Ignored Items"}),P.showHidden?u.jsx(Er,{size:14,className:"text-green-500"}):u.jsx("div",{className:"w-4 h-4 rounded-full border border-neutral-200"})]}),u.jsxs("button",{onClick:()=>R("highlightFailed",!P.highlightFailed),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-neutral-50 text-xs font-bold text-neutral-700 transition-colors",children:[u.jsx("span",{children:"Highlight Failed"}),P.highlightFailed?u.jsx(Er,{size:14,className:"text-green-500"}):u.jsx("div",{className:"w-4 h-4 rounded-full border border-neutral-200"})]})]})]}),!N&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:s,className:"p-2 bg-amber-100 text-amber-600 hover:text-amber-900 rounded-lg hover:bg-amber-200 transition-colors",title:"Practice",children:u.jsx(NE,{size:16})}),u.jsx("button",{onClick:o,className:"p-2 bg-neutral-100 text-neutral-600 hover:text-neutral-900 rounded-lg hover:bg-neutral-200 transition-colors",children:u.jsx(hI,{size:16})})]}),u.jsx("button",{onClick:e,className:"p-2 bg-white border border-neutral-200 text-neutral-400 hover:text-neutral-900 rounded-lg transition-colors",children:u.jsx(Rn,{size:16})})]})]})}),u.jsxs("nav",{className:"px-4 sm:px-8 border-b border-neutral-100 bg-white flex items-center gap-4 sm:gap-6 shrink-0 overflow-x-auto no-scrollbar",children:[u.jsx("button",{onClick:()=>Q("OVERVIEW"),className:`py-3 px-1 text-[10px] font-black uppercase tracking-widest border-b-2 transition-all ${W==="OVERVIEW"?"border-neutral-900 text-neutral-900":"border-transparent text-neutral-400 hover:text-neutral-600"}`,children:"Overview"}),u.jsxs("button",{onClick:()=>Q("USAGE"),className:`py-3 px-1 text-[10px] font-black uppercase tracking-widest border-b-2 transition-all flex items-center gap-2 ${W==="USAGE"?"border-indigo-600 text-indigo-600":"border-transparent text-neutral-400 hover:text-neutral-600"}`,children:[u.jsx(af,{size:14})," Usage"]}),u.jsxs("button",{onClick:()=>Q("TEST"),className:`py-3 px-1 text-[10px] font-black uppercase tracking-widest border-b-2 transition-all flex items-center gap-2 ${W==="TEST"?"border-emerald-600 text-emerald-600":"border-transparent text-neutral-400 hover:text-neutral-600"}`,children:[u.jsx(Mm,{size:14})," Practice Test"]})]}),u.jsxs("div",{className:"flex-1 overflow-auto no-scrollbar px-4 sm:px-6 pt-4 pb-8 bg-neutral-50/20",children:[W==="OVERVIEW"&&u.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"px-2 py-3 bg-white border border-neutral-100 rounded-2xl flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 shadow-sm",children:[u.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[u.jsx("div",{className:"flex flex-col",children:u.jsx("p",{className:"px-2 py-1 bg-neutral-50 rounded-lg text-sm font-mono font-medium border border-neutral-200 text-neutral-500",children:n.ipaUs||"/?/"})}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx(g4,{register:n.register}),(!n.register||n.register==="raw")&&u.jsx("span",{className:"px-2 py-1 bg-neutral-100 text-neutral-400 rounded-lg text-[10px] font-black uppercase tracking-tighter border border-neutral-200",children:"Neutral"})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(D1,{label:"Quality",options:ye,selectedId:n.quality,onSelect:re=>l({...n,quality:re}),buttonClass:"flex items-center gap-2 p-1.5 bg-neutral-50 border border-neutral-200 hover:bg-neutral-100 rounded-xl transition-all",disabled:N}),!n.isPassive&&u.jsx("div",{className:"flex flex-col items-end",children:u.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-bold text-neutral-500",title:`Next Review: ${se.label}`,children:[u.jsx(RE,{size:12}),u.jsx("span",{className:`text-[11px] font-black uppercase ${se.urgency==="due"?"text-rose-500":"text-green-600"}`,children:se.label})]})})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[n.note&&u.jsx("div",{className:"md:col-span-4",children:u.jsx("p",{className:"text-sm text-neutral-700 bg-yellow-50/50 p-4 rounded-xl border border-yellow-100 italic leading-relaxed whitespace-pre-wrap",children:n.note})}),u.jsx(le,{title:"Examples",icon:Tf,className:"md:col-span-4",children:n.example?u.jsx("div",{className:"flex flex-col gap-2",children:n.example.split(`
`).filter(re=>re.trim()!=="").map((re,Fe)=>u.jsxs("div",{className:"flex items-start gap-2 px-3 py-2 bg-neutral-50 border border-neutral-100 rounded-xl group hover:border-neutral-200 transition-all",children:[u.jsx("span",{className:"text-sm font-medium text-neutral-700 leading-relaxed flex-1 select-text cursor-text",children:re}),u.jsx("button",{onClick:()=>ns(re),className:"p-1.5 text-neutral-400 hover:text-indigo-500 hover:bg-white rounded-lg transition-all shrink-0",children:u.jsx(wr,{size:14})})]},Fe))}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic px-1",children:"No examples added."})}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Ag,{size:10})," Prepositions"]}),Y.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 bg-white border border-neutral-100 p-3 rounded-xl shadow-sm",children:Y.map((re,Fe)=>{var tt,ut;const rt=`PREPOSITION_QUIZ:${re.prep}`,Tt=(tt=n.lastTestResults)==null?void 0:tt[rt],Ze=P.highlightFailed&&(Tt===!1||Tt===void 0&&((ut=n.lastTestResults)==null?void 0:ut.PREPOSITION_QUIZ)===!1)&&!re.isIgnored;return u.jsxs("div",{className:`flex items-center justify-between gap-3 p-2 rounded-lg border transition-colors ${Ze?"bg-red-50 border-red-200":"bg-neutral-50/30 border-neutral-100"} ${re.isIgnored?"opacity-50":""}`,children:[u.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[Ze&&u.jsx(Ca,{size:10,className:"text-red-500 shrink-0"}),u.jsx("span",{className:`font-bold text-xs shrink-0 ${Ze?"text-red-700":"text-neutral-900"} ${re.isIgnored?"line-through":""}`,children:re.prep}),u.jsx("span",{className:`font-medium text-[10px] truncate ${Ze?"text-red-400":"text-neutral-500"}`,children:re.usage})]}),re.usage&&u.jsx("button",{onClick:()=>ns(re.usage),className:"text-neutral-300 hover:text-indigo-500 transition-colors p-1 shrink-0",children:u.jsx(wr,{size:12})})]},Fe)})}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic px-1",children:"No prepositions."})]}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(zE,{size:10})," Word Family"]}),u.jsx("div",{className:"p-3 bg-neutral-50 rounded-xl border border-neutral-100",children:Z?u.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[B("Nouns",(Te=n.wordFamily)==null?void 0:Te.nouns,"blue","nouns"),B("Verbs",(me=n.wordFamily)==null?void 0:me.verbs,"green","verbs"),B("Adjectives",(et=n.wordFamily)==null?void 0:et.adjs,"orange","adjs"),B("Adverbs",(Xe=n.wordFamily)==null?void 0:Xe.advs,"purple","advs")]}):u.jsx("span",{className:"text-[10px] text-neutral-300 italic",children:"No family data available."})})]}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Sf,{size:10})," Collocations"]}),A.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 bg-white border border-neutral-200 p-3 rounded-xl",children:A.map((re,Fe)=>{var At,Ht;const rt=S.has(re.text.toLowerCase()),Tt=`COLLOCATION_QUIZ:${re.text}`,Ze=(At=n.lastTestResults)==null?void 0:At[Tt];let tt=!1;P.highlightFailed&&!re.isIgnored&&(Ze===!1||Ze===void 0&&((Ht=n.lastTestResults)==null?void 0:Ht.COLLOCATION_QUIZ)===!1)&&(tt=!0);let ut="bg-indigo-50/50 border-indigo-100 text-indigo-900";return tt?ut="bg-red-50 border-red-200 text-red-700":re.isIgnored&&(ut="bg-neutral-50 border-neutral-100 text-neutral-400"),u.jsxs("div",{className:`flex items-start justify-between gap-2 px-3 py-2 rounded-lg border text-xs font-bold transition-colors ${ut}`,children:[u.jsxs("div",{className:"flex-1 overflow-hidden",children:[tt&&u.jsx(Ca,{size:12,className:"text-red-500 shrink-0"}),u.jsx("span",{className:`truncate ${re.isIgnored?"line-through":""}`,title:re.text,children:re.text}),re.d&&!re.isIgnored&&u.jsx("div",{className:"text-[10px] italic text-neutral-400 mt-0.5 normal-case font-medium",children:re.d})]}),u.jsx("button",{onClick:()=>ns(re.text),className:"text-neutral-300 hover:text-indigo-500 transition-colors p-0.5",children:u.jsx(wr,{size:10})}),u.jsx("button",{type:"button",disabled:v===re.text||rt||re.isIgnored,onClick:()=>x({word:re.text,ipa:""},"collocation"),className:`p-1 rounded-md transition-all shrink-0 ${rt?"text-green-500 cursor-default":re.isIgnored?"text-neutral-300 cursor-not-allowed":"text-neutral-400 hover:text-neutral-900 hover:bg-white/50"}`,title:rt?"Already in library":"Add to library",children:v===re.text?u.jsx(fn,{size:12,className:"animate-spin"}):rt?u.jsx(Er,{size:12}):u.jsx(Kr,{size:12})})]},Fe)})}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic px-1",children:"No collocations."})]}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Af,{size:10,className:"text-amber-500"})," Variations"]}),q.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:q.map((re,Fe)=>{var At,Ht;const rt=S.has(re.word.toLowerCase()),Tt=`PARAPHRASE_QUIZ:${re.word}`,Ze=(At=n.lastTestResults)==null?void 0:At[Tt],tt=P.highlightFailed&&(Ze===!1||Ze===void 0&&((Ht=n.lastTestResults)==null?void 0:Ht.PARAPHRASE_QUIZ)===!1)&&!re.isIgnored,ut=re.isIgnored;return u.jsxs("div",{className:`flex items-start justify-between gap-2 border px-3 py-2 rounded-xl shadow-sm ${tt?"bg-red-50 border-red-200":ut?"bg-neutral-50 border-neutral-100 opacity-60":"bg-white border-neutral-200"}`,children:[u.jsxs("div",{className:"flex-1 overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-1",children:[y4(re.tone),tt&&u.jsx(Ca,{size:12,className:"text-red-500 fill-red-100"})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("div",{className:`text-xs font-bold ${tt?"text-red-800":"text-neutral-800"} ${ut?"line-through":""}`,children:re.word}),u.jsx("button",{onClick:()=>ns(re.word),className:"text-neutral-300 hover:text-indigo-500 transition-colors p-0.5",children:u.jsx(wr,{size:10})})]}),u.jsx("div",{className:`text-[10px] italic truncate ${tt?"text-red-400":"text-neutral-400"}`,title:re.context,children:re.context})]}),u.jsx("button",{type:"button",disabled:v===re.word||rt,onClick:()=>x({word:re.word,ipa:""},"paraphrase"),className:`p-1 rounded-md transition-all mt-1 shrink-0 ${rt?"text-green-500 cursor-default":"text-neutral-300 hover:text-neutral-900 hover:bg-neutral-100"}`,children:v===re.word?u.jsx(fn,{size:10,className:"animate-spin"}):rt?u.jsx(Er,{size:10}):u.jsx(Kr,{size:10})})]},Fe)})}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic",children:"No variations available."})]}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Cg,{size:10})," Related Idioms"]}),V.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 bg-white border border-neutral-200 p-3 rounded-xl",children:V.map((re,Fe)=>{var At,Ht;const rt=S.has(re.text.toLowerCase()),Tt=`IDIOM_QUIZ:${re.text}`,Ze=(At=n.lastTestResults)==null?void 0:At[Tt];let tt=!1;P.highlightFailed&&!re.isIgnored&&(Ze===!1||Ze===void 0&&((Ht=n.lastTestResults)==null?void 0:Ht.IDIOM_QUIZ)===!1)&&(tt=!0);let ut="bg-amber-50/50 border-amber-100 text-amber-900";return tt?ut="bg-red-50 border-red-200 text-red-700":re.isIgnored&&(ut="bg-neutral-50 border-neutral-100 text-neutral-400"),u.jsxs("div",{className:`flex items-start justify-between gap-2 px-3 py-2 rounded-lg border text-xs font-bold transition-colors ${ut}`,children:[u.jsxs("div",{className:"flex-1 overflow-hidden",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[tt&&u.jsx(Ca,{size:12,className:"text-red-500 shrink-0"}),u.jsx("span",{className:`truncate ${re.isIgnored?"line-through":""}`,title:re.text,children:re.text}),u.jsx("button",{onClick:()=>ns(re.text),className:"text-neutral-300 hover:text-indigo-500 transition-colors p-0.5",children:u.jsx(wr,{size:10})})]}),re.d&&!re.isIgnored&&u.jsx("div",{className:"text-[10px] italic text-neutral-400 mt-0.5 normal-case font-medium",children:re.d})]}),u.jsx("button",{type:"button",disabled:v===re.text||rt||re.isIgnored,onClick:()=>x({word:re.text,ipa:""},"idiom"),className:`p-1 rounded-md transition-all shrink-0 ${rt?"text-green-500 cursor-default":re.isIgnored?"text-neutral-300 cursor-not-allowed":"text-neutral-400 hover:text-neutral-900 hover:bg-white/50"}`,title:rt?"Already in library":"Add to library",children:v===re.text?u.jsx(fn,{size:12,className:"animate-spin"}):rt?u.jsx(Er,{size:12}):u.jsx(Kr,{size:12})})]},Fe)})}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic px-1",children:"No related idioms found."})]})]})]}),W==="USAGE"&&u.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-2 duration-500 flex flex-col h-full space-y-8",children:[de?u.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-black prose-headings:text-neutral-900 prose-p:text-neutral-600 prose-p:leading-relaxed prose-img:rounded-xl prose-img:shadow-md prose-strong:text-neutral-900 prose-a:text-indigo-600 overflow-x-auto",dangerouslySetInnerHTML:{__html:de}}):u.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white border-2 border-dashed border-neutral-200 rounded-[2.5rem] space-y-4",children:[u.jsx("div",{className:"p-4 bg-indigo-50 rounded-full text-indigo-600",children:u.jsx(af,{size:32})}),u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"font-black text-neutral-900",children:"No Usage Guide"}),u.jsx("p",{className:"text-xs text-neutral-400 font-medium",children:"Generate a structural guide with tables and examples."})]}),!N&&u.jsxs("button",{onClick:()=>j==null?void 0:j("ESSAY"),className:"px-6 py-3 bg-neutral-900 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center gap-2 hover:bg-neutral-800 transition-all active:scale-95 shadow-lg",children:[u.jsx(Rl,{size:16})," Generate Usage Guide"]})]}),de&&!N&&u.jsx("div",{className:"flex justify-center border-t border-neutral-100 pt-6",children:u.jsxs("button",{onClick:()=>j==null?void 0:j("ESSAY"),className:"flex items-center gap-2 px-4 py-2 bg-neutral-50 text-neutral-500 hover:text-indigo-600 hover:bg-indigo-50 border border-neutral-200 hover:border-indigo-200 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all",children:[u.jsx(Cl,{size:12})," ",u.jsx("span",{children:"Refresh Usage Guide"})]})})]}),W==="TEST"&&u.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-2 duration-500 flex flex-col h-full space-y-8",children:[ce?u.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-black prose-headings:text-neutral-900 prose-p:text-neutral-600 prose-p:leading-relaxed prose-img:rounded-xl prose-img:shadow-md prose-strong:text-neutral-900 prose-a:text-indigo-600",dangerouslySetInnerHTML:{__html:ce}}):u.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white border-2 border-dashed border-neutral-200 rounded-[2.5rem] space-y-4",children:[u.jsx("div",{className:"p-4 bg-emerald-50 rounded-full text-emerald-600",children:u.jsx(Mm,{size:32})}),u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"font-black text-neutral-900",children:"No Practice Test"}),u.jsx("p",{className:"text-xs text-neutral-400 font-medium",children:"Create an interactive test based on this word's usage."})]}),!N&&u.jsxs("button",{onClick:()=>j==null?void 0:j("TEST"),className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs uppercase tracking-widest flex items-center gap-2 hover:bg-neutral-800 transition-all active:scale-95 shadow-lg",children:[u.jsx(Rl,{size:16})," Generate Test"]})]}),ce&&!N&&u.jsx("div",{className:"flex justify-center border-t border-neutral-100 pt-6",children:u.jsxs("button",{onClick:()=>j==null?void 0:j("TEST"),className:"flex items-center gap-2 px-4 py-2 bg-neutral-50 text-neutral-500 hover:text-emerald-600 hover:bg-emerald-50 border border-neutral-200 hover:border-emerald-200 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all",children:[u.jsx(Cl,{size:12})," ",u.jsx("span",{children:"Regenerate Test"})]})})]})]})]})})},b4=({title:n,type:e,currentStep:s,totalSteps:a,onClose:o,onFinish:l,label:d="Challenge",isQuickFire:p,elapsedTime:m})=>u.jsxs("div",{className:"px-6 py-5 border-b border-neutral-100 flex items-center justify-between bg-neutral-50/50 shrink-0",children:[u.jsx("button",{onClick:o,className:"p-2 -ml-2 text-neutral-400 hover:text-neutral-900 transition-colors",title:p?"Exit to Dashboard":"Close",children:u.jsx(Rn,{size:20})}),u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:[d," ",s," of ",a]}),m&&u.jsxs("div",{className:"flex items-center gap-1 bg-neutral-200/50 px-1.5 py-0.5 rounded-md",children:[u.jsx(RE,{size:10,className:"text-neutral-500"}),u.jsx("span",{className:"text-[10px] font-mono font-bold text-neutral-600",children:m})]})]}),u.jsx("span",{className:"text-xs font-black text-neutral-900",children:n})]}),u.jsx("button",{onClick:()=>l(p),className:"p-2 -mr-2 text-amber-500 hover:text-amber-700 transition-colors",title:p?"Finish Session & See Results":"Finish & Save",children:u.jsx(oI,{size:20,className:p?"fill-amber-500":""})})]});class C0{constructor(){this.recognition=null,this.finalTranscript="",this.onResultCallback=null,this.onEndCallback=null,this.initBrowserRecognition()}initBrowserRecognition(){const e=window.SpeechRecognition||window.webkitSpeechRecognition;e&&(this.recognition=new e,this.recognition.continuous=!0,this.recognition.interimResults=!0,this.recognition.lang="en-US",this.recognition.onresult=s=>{let a="",o="";for(let l=s.resultIndex;l<s.results.length;++l)s.results[l].isFinal?o+=s.results[l][0].transcript:a+=s.results[l][0].transcript;this.finalTranscript+=o,this.onResultCallback&&this.onResultCallback(this.finalTranscript,a)},this.recognition.onend=()=>{this.onEndCallback&&this.onEndCallback(this.finalTranscript)},this.recognition.onerror=s=>{console.error("Speech Recognition Error:",s.error),this.stop()})}async start(e,s){if(this.onResultCallback=e,this.onEndCallback=s,this.finalTranscript="",!this.recognition){console.error("Speech Recognition not supported in this browser.");return}try{this.recognition.start()}catch(a){console.error("Speech Recognition start failed:",a)}}stop(){if(this.recognition)try{this.recognition.stop()}catch{}}}const R0=({isListening:n,onClick:e,disabled:s,className:a})=>u.jsx("button",{onClick:e,disabled:s,className:`p-2.5 rounded-xl transition-all shadow-sm flex items-center justify-center
            ${n?"bg-red-500 text-white animate-pulse ring-2 ring-red-200 border-transparent":"bg-white border border-neutral-200 text-neutral-400 hover:text-indigo-600 hover:border-indigo-300"} ${a}`,title:n?"Stop Recording":"Use Voice Input",tabIndex:-1,children:n?u.jsx(Og,{size:18,fill:"currentColor"}):u.jsx(To,{size:18})}),Hf=()=>{const[n,e]=M.useState({});return{validationState:n,clearValidation:d=>{e(p=>{if(!p[d])return p;const m={...p};return delete m[d],m})},getValidationClass:d=>{const p=n[d];return p==="correct"?"!border-green-500 !ring-2 !ring-green-100 !bg-green-50 text-green-900":p==="incorrect"?"!border-red-500 !ring-2 !ring-red-100 !bg-red-50 text-red-900":""},handleSmartChange:(d,p,m)=>{const y=d.target.value;if(y===" ")p(m);else if(y.endsWith("  ")){const x=y.substring(0,y.length-2),v=x.length>0?" ":"";p(x+v+m)}else p(y)},handleValidationKeyDown:(d,p,m)=>{if(d.key==="Escape"){d.preventDefault(),d.stopPropagation();const y=d.currentTarget.value,x=S=>S.trim().toLowerCase().replace(/[^a-z0-9]/g,"");let v=!1;if(Array.isArray(m)){const S=y.split(",").map(x).filter(Boolean);if(S.length===0){e(z=>({...z,[p]:null}));return}const N=new Set(m.map(x));v=S.every(z=>N.has(z))}else{const S=x(y);if(!S){e(N=>({...N,[p]:null}));return}v=x(m)===S}e(S=>({...S,[p]:v?"correct":"incorrect"}))}}}},v4=({group:n,userAnswers:e,results:s,onAnswerChange:a,isFinishing:o,showHint:l,toggleListening:d,listeningId:p,containerRef:m})=>{const{clearValidation:y,handleSmartChange:x,handleValidationKeyDown:v,getValidationClass:S}=Hf();return u.jsxs("div",{ref:m,className:"flex flex-col animate-in fade-in duration-300",children:[u.jsxs("div",{className:"text-center space-y-2 mb-6",children:[u.jsx("h3",{className:"text-lg font-black text-neutral-900",children:"Preposition Drill"}),u.jsx("p",{className:"text-xs text-neutral-500 font-medium max-w-xs mx-auto",children:"Complete the collocations. Type the missing preposition(s)."})]}),u.jsx("div",{className:"space-y-4",children:n.map(N=>{var I,T;const z=e[N.index]||"",D=s?s[N.index]:null,j=typeof D=="boolean"?D:D&&typeof D=="object"?D.correct:!1,P=D!==null&&!j,F=N.challenge.example.split("___"),G=(I=F[0])==null?void 0:I.trim(),H=(T=F[1])==null?void 0:T.trim(),W=`prep-${N.index}`,Q=p===W;return u.jsxs("div",{className:"w-full bg-neutral-50 border-2 border-neutral-100 rounded-2xl p-5 flex flex-wrap items-center justify-center gap-x-2 gap-y-3 shadow-sm transition-all focus-within:border-neutral-300 focus-within:shadow-md focus-within:bg-white",children:[G&&u.jsx("span",{className:"text-lg font-medium text-neutral-600 text-right",children:G}),u.jsxs("div",{className:"relative mx-1 flex items-center gap-2",children:[u.jsx("input",{type:"text",value:z,onChange:_=>{y(W),x(_,C=>a(N.index,C),N.challenge.answer)},onKeyDown:_=>{v(_,W,N.challenge.answer)},disabled:o,className:`h-10 min-w-[80px] max-w-[160px] w-[12ch] text-center text-lg font-bold rounded-lg border-b-2 outline-none transition-colors ${o?j?"bg-green-50 border-green-500 text-green-700":"bg-red-50 border-red-500 text-red-700 decoration-red-500 line-through decoration-2":`bg-white border-neutral-300 text-neutral-900 focus:border-neutral-900 focus:bg-neutral-50 ${S(W)}`}`,placeholder:"?",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"}),!o&&u.jsx(R0,{isListening:Q,onClick:()=>d(W,_=>a(N.index,_)),disabled:o}),(o&&P||l)&&u.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 top-full mt-2 z-10",children:[u.jsxs("div",{className:"bg-neutral-900 text-white text-xs font-bold py-1 px-3 rounded-lg shadow-lg whitespace-nowrap flex items-center gap-1 animate-in zoom-in-95",children:[u.jsx(qc,{size:10,className:"text-green-400"})," ",N.challenge.answer]}),u.jsx("div",{className:"w-2 h-2 bg-neutral-900 rotate-45 absolute left-1/2 -translate-x-1/2 -top-1"})]})]}),H&&u.jsx("span",{className:"text-lg font-medium text-neutral-800 text-left",children:H})]},N.index)})})]})},om=({challenge:n,answer:e,onAnswer:s,isFinishing:a,result:o,showHint:l,itemLabel:d,instructionText:p,containerRef:m})=>{const[y,x]=M.useState(n.contexts.map(H=>({...H}))),[v,S]=M.useState(n.items.map(H=>({...H}))),[N,z]=M.useState(null),D=(H,W)=>{const Q=new Map(e);if(W===null)Q.delete(H);else{for(const[I,T]of Q.entries())T===W&&Q.delete(I);Q.set(H,W)}s(Q)};M.useEffect(()=>{const H=n.contexts.map(Q=>({...Q})),W=n.items.map(Q=>({...Q}));if(e)for(const[Q,I]of e.entries()){const T=H.findIndex(_=>_.id===Q);T!==-1&&(H[T].matchId=I)}x(H),S(W)},[e,n]);const j=H=>{a||z(W=>W===H?null:H)},P=H=>{a||!N||(D(H,N),z(null))},F=o&&typeof o=="object"&&"details"in o?o.details:{},G=()=>{a||s(new Map)};return u.jsxs("div",{ref:m,className:"flex flex-col gap-4 animate-in fade-in duration-300",children:[u.jsx("div",{className:"text-center",children:u.jsx("p",{className:"text-xs text-neutral-500 font-medium",children:p})}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsx("div",{className:"space-y-3",children:y.map(H=>{var C;const W=a&&F[H.id]===!0,Q=a&&F[H.id]===!1,I=n.items.find(R=>R.id===H.matchId),T=(C=n.items.find(R=>R.pairId===H.pairId))==null?void 0:C.text;let _="border-neutral-200";return a?(W&&(_="border-green-400 bg-green-50"),Q&&(_="border-red-400 bg-red-50")):l?_="border-yellow-400 bg-yellow-50":H.matchId&&(_="border-neutral-400 bg-neutral-50"),u.jsxs("button",{onClick:()=>P(H.id),disabled:a||!N,className:`relative w-full p-3 rounded-xl border-2 text-left transition-all duration-200 ${_} disabled:cursor-not-allowed`,children:[d(H),u.jsx("p",{className:"font-medium text-xs leading-snug text-neutral-600",children:H.text}),H.matchId&&!a&&!l&&u.jsx("p",{className:"font-bold text-xs mt-2 pt-2 border-t border-neutral-200",children:I==null?void 0:I.text}),l&&!a&&u.jsxs("div",{className:"mt-2 pt-2 border-t flex items-center gap-2 text-yellow-700 animate-in fade-in",children:[u.jsx(Nl,{size:14,className:"text-yellow-600"}),u.jsx("p",{className:"font-bold text-xs",children:T})]}),a&&u.jsxs("div",{className:"mt-2 pt-2 border-t flex items-center gap-2",children:[W?u.jsx(Nl,{size:14,className:"text-green-500"}):u.jsx(Rn,{size:14,className:"text-red-500"}),u.jsx("p",{className:`font-bold text-xs ${Q?"text-red-700":"text-green-700"}`,children:(I==null?void 0:I.text)||"No selection"})]}),a&&Q&&u.jsxs("p",{className:"text-[10px] text-green-700 font-bold mt-1",children:["Correct: ",T]})]},H.id)})}),u.jsx("div",{className:"space-y-3",children:v.map(H=>{var T;const W=N===H.id,Q=e==null?void 0:e.has(((T=y.find(_=>_.matchId===H.id))==null?void 0:T.id)||"");let I="bg-white border-neutral-200 text-neutral-800 hover:border-neutral-900";return a&&Q?I="bg-neutral-100 border-neutral-200 text-neutral-400 opacity-60":W?I="bg-indigo-600 border-indigo-600 text-white ring-4 ring-indigo-100":Q&&(I="bg-neutral-100 border-neutral-200 text-neutral-400 opacity-60"),u.jsx("button",{onClick:()=>j(H.id),disabled:a||Q,className:`w-full p-3 rounded-xl border-2 text-left transition-all duration-200 disabled:cursor-not-allowed ${I}`,children:u.jsx("p",{className:"font-bold text-sm leading-snug",children:H.text})},H.id)})})]}),e&&e.size>0&&!a&&u.jsx("div",{className:"flex justify-center pt-2",children:u.jsxs("button",{onClick:G,className:"flex items-center gap-1.5 text-xs font-bold text-neutral-500 hover:text-neutral-900 transition-colors",children:[u.jsx(Cl,{size:12})," Reset"]})})]})},_4=({challenge:n,onAnswer:e,isFinishing:s,result:a,containerRef:o})=>{const[l,d]=M.useState(!1),[p,m]=M.useState(""),y=M.useRef(null);M.useEffect(()=>{try{y.current=new C0}catch(z){console.error("Speech Recognition not supported",z)}return()=>{var z;(z=y.current)==null||z.stop()}},[]);const x=()=>{y.current&&(m(""),d(!0),y.current.start((z,D)=>m(z+D),z=>{d(!1),e(z)}))},v=()=>{var z;(z=y.current)==null||z.stop()},S=()=>{l?v():x()},N=a===!0;return u.jsxs("div",{ref:o,className:"text-center space-y-8 animate-in fade-in duration-300 flex flex-col items-center",children:[u.jsx("p",{className:"text-sm font-bold text-neutral-500",children:"Press the button and pronounce the word below."}),u.jsx("h2",{className:"text-4xl font-black text-neutral-900 tracking-tight",children:n.word.word}),u.jsx("button",{onClick:S,disabled:s,className:`w-24 h-24 rounded-full flex items-center justify-center shadow-lg transition-all active:scale-95 disabled:opacity-50
                    ${l?"bg-neutral-900 text-white animate-pulse":"bg-red-600 text-white hover:scale-105 shadow-red-500/30"}`,children:l?u.jsx(Og,{size:32,fill:"white"}):u.jsx(To,{size:32})}),u.jsx("div",{className:"w-full max-w-sm min-h-[6rem] p-4 bg-neutral-50 border border-neutral-200 rounded-xl text-lg font-medium text-neutral-600 italic",children:p||"..."}),s&&u.jsxs("div",{className:`flex items-center gap-2 font-bold text-lg animate-in fade-in slide-in-from-bottom-2 ${N?"text-green-600":"text-red-600"}`,children:[N?u.jsx(W2,{size:20}):u.jsx(X2,{size:20}),u.jsx("span",{children:N?"Correct!":`Not quite. The word was "${n.word.word}".`})]})]})},lm=({word:n,title:e,cue:s,options:a,answer:o,selected:l,onAnswer:d,isFinishing:p,showHint:m,containerRef:y})=>u.jsxs("div",{ref:y,className:"text-center space-y-6 animate-in fade-in duration-300 flex flex-col",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:e}),u.jsx("h2",{className:"text-3xl font-black text-neutral-900",children:n.word}),s&&u.jsx("div",{className:"inline-flex items-center gap-2 bg-neutral-100 px-3 py-1.5 rounded-lg border border-neutral-200 max-w-sm mx-auto mt-2",children:u.jsx("span",{className:"text-xs font-bold text-neutral-700 italic",children:s})})]}),u.jsx("div",{className:"grid grid-cols-1 gap-3",children:a.map((x,v)=>{let S="bg-white border-neutral-200 hover:border-neutral-400 text-neutral-700";return p?x===o?S="bg-green-50 border-green-500 text-green-700 shadow-md ring-1 ring-green-500":x===l&&x!==o?S="bg-red-50 border-red-500 text-red-700 opacity-60":S="bg-neutral-50 border-neutral-100 text-neutral-400 opacity-40":m&&x===o?S="bg-yellow-50 border-yellow-400 text-yellow-800 shadow-md ring-1 ring-yellow-400":l===x&&(S="bg-neutral-900 border-neutral-900 text-white shadow-lg"),u.jsx("button",{disabled:p,onClick:()=>d(x),className:`p-4 rounded-2xl border-2 text-sm font-medium transition-all duration-200 text-left leading-snug active:scale-[0.98] ${S}`,children:x},v)})})]}),cm=({word:n,title:e,cue:s,contextTag:a,answer:o,userAnswer:l,onAnswer:d,isFinishing:p,result:m,showHint:y,containerRef:x,toggleListening:v,listeningId:S})=>{const{clearValidation:N,handleSmartChange:z,handleValidationKeyDown:D,getValidationClass:j}=Hf(),P=m===!0,F=m===!1,G="main",H=S===G;return u.jsxs("div",{ref:x,className:"text-center space-y-8 animate-in fade-in duration-300 flex flex-col items-center",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:e}),u.jsx("h2",{className:"text-3xl font-black text-neutral-900",children:n.word}),(s||a)&&u.jsxs("div",{className:"inline-flex items-center gap-2 bg-neutral-100 px-3 py-1.5 rounded-lg border border-neutral-200 max-w-sm",children:[a&&u.jsx("span",{className:"text-[9px] font-black uppercase bg-white px-1.5 py-0.5 rounded border border-neutral-200 text-neutral-500",children:a}),s&&u.jsx("span",{className:"text-xs font-bold text-neutral-700 italic",children:s})]})]}),u.jsxs("div",{className:"w-full max-w-md flex flex-col items-center gap-3",children:[u.jsxs("div",{className:"relative w-full",children:[u.jsx("input",{type:"text",autoFocus:!0,value:l||"",onChange:W=>{N(G),z(W,d,n.word)},onKeyDown:W=>{D(W,G,o)},disabled:p,className:`w-full text-center py-4 pl-12 pr-12 rounded-2xl border-2 text-xl font-bold focus:outline-none placeholder:text-neutral-200 transition-colors duration-200 ${p?P?"bg-green-50 border-green-500 text-green-600":"bg-red-50 border-red-500 text-red-600":`bg-neutral-50 border-transparent focus:bg-white focus:border-neutral-900 text-neutral-900 shadow-sm ${j(G)}`}`,placeholder:"Type answer...",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"}),!p&&u.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:u.jsx(R0,{isListening:H,onClick:()=>v(G,d),disabled:p})})]}),(p&&F||y)&&u.jsx("div",{className:"text-green-600 font-bold text-lg animate-in slide-in-from-top-2 bg-green-50 px-3 py-1 rounded-lg border border-green-100 inline-block",children:o})]})]})},E4=({word:n,userAnswer:e,onAnswer:s,isFinishing:a,resultDetails:o,showHint:l,containerRef:d,toggleListening:p,listeningId:m})=>{const{clearValidation:y,handleSmartChange:x,handleValidationKeyDown:v,getValidationClass:S}=Hf(),N=n.wordFamily,z=e||{},D=(j,P)=>{s({...z,[j]:P})};return u.jsxs("div",{ref:d,className:"space-y-6 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"text-center space-y-1",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Word Family"}),u.jsx("h2",{className:"text-3xl font-black text-neutral-900",children:n.word}),u.jsx("p",{className:"text-xs font-bold text-neutral-500",children:"Fill related forms"})]}),u.jsx("div",{className:"grid grid-cols-1 gap-4",children:["nouns","verbs","adjs","advs"].map(j=>{const P=((N==null?void 0:N[j])||[]).filter(T=>!T.isIgnored).map(T=>T.word);if(P.length===0)return null;const F={nouns:"Noun",verbs:"Verb",adjs:"Adjective",advs:"Adverb"}[j],G=z[j]||"",H=o[j],W=a,Q=`fam-${j}`,I=m===Q;return u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:"w-20 text-[10px] font-black uppercase text-neutral-400 text-right",children:F}),u.jsxs("div",{className:"flex-1 relative flex items-center gap-2",children:[u.jsx("input",{type:"text",value:G,onChange:T=>{y(Q),x(T,_=>D(j,_),n.word)},onKeyDown:T=>{v(T,Q,P)},disabled:a,className:`w-full px-4 py-2 bg-neutral-50 border-2 rounded-xl text-sm font-bold outline-none transition-all ${W?H?"border-green-500 bg-green-50 text-green-800":"border-red-500 bg-red-50 text-red-800":`border-neutral-100 focus:border-neutral-900 focus:bg-white ${S(Q)}`}`,placeholder:"..."}),!a&&u.jsx(R0,{isListening:I,onClick:()=>p(Q,T=>D(j,T)),disabled:a}),(W&&!H||l)&&u.jsx("div",{className:"text-[10px] font-bold text-green-600 mt-1 pl-1",children:((N==null?void 0:N[j])||[]).filter(T=>!T.isIgnored).map(T=>T.word).join(", ")})]})]},j)})})]})},w4=({word:n,original:e,shuffled:s,userAnswer:a,onAnswer:o,isFinishing:l,isCorrect:d,showHint:p,containerRef:m})=>{const[y,x]=Fn.useState(0),v=a||[],S=new Set;v.forEach(j=>{const P=s.findIndex((F,G)=>F===j&&!S.has(G));P!==-1&&S.add(P)});const N=j=>{if(l)return;const P=[...v];P.splice(y,0,j),o(P),x(F=>F+1)},z=j=>{if(l)return;const P=[...v];P.splice(j,1),o(P),y>j&&x(F=>F-1)},D=({index:j})=>{const P=j===y;return l?u.jsx("div",{className:"w-1 mx-0.5"}):u.jsx("div",{onClick:()=>x(j),className:`h-8 w-2 rounded-full cursor-pointer transition-all duration-200 mx-0.5 flex items-center justify-center ${P?"bg-indigo-500 scale-110 shadow-sm":"bg-transparent hover:bg-neutral-200"}`,children:u.jsx("div",{className:`w-1 h-4 rounded-full ${P?"bg-white/50":"bg-transparent"}`})})};return u.jsxs("div",{ref:m,className:"flex flex-col space-y-6 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"text-center space-y-1",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Sentence Builder"}),u.jsxs("p",{className:"text-xs text-neutral-500 font-medium",children:['Reconstruct the example sentence for "',n.word,'".']})]}),u.jsxs("div",{className:`min-h-[120px] p-6 rounded-[2rem] border-2 border-dashed flex flex-wrap gap-y-3 items-center justify-center transition-all ${l?d?"bg-green-50 border-green-200":"bg-red-50 border-red-200":"bg-neutral-50 border-neutral-200"}`,children:[v.length===0&&!l&&u.jsx("span",{className:"absolute text-sm font-bold text-neutral-300 italic pointer-events-none",children:"Click words below to build sentence..."}),u.jsx(D,{index:0}),v.map((j,P)=>u.jsxs(Fn.Fragment,{children:[u.jsxs("button",{onClick:()=>z(P),disabled:l,className:`px-3 py-2 rounded-xl text-sm font-bold shadow-sm transition-all active:scale-95 flex items-center gap-1 group ${l?d?"bg-green-600 text-white":"bg-red-500 text-white":"bg-white text-neutral-900 border border-neutral-100 hover:border-red-200 hover:text-red-500"}`,children:[j," ",!l&&u.jsx(Rn,{size:14,className:"opacity-40 group-hover:opacity-100"})]}),u.jsx(D,{index:P+1})]},`${j}-${P}`))]}),(l||p)&&u.jsxs("div",{className:"p-4 bg-yellow-50 rounded-2xl border border-yellow-100 animate-in slide-in-from-top-2",children:[u.jsx("p",{className:"text-xs font-black text-yellow-600 uppercase tracking-widest mb-1",children:"Correct Sentence"}),u.jsx("p",{className:"text-sm font-bold text-yellow-900 leading-relaxed",children:e})]}),u.jsx("div",{className:"flex flex-wrap gap-2 justify-center pt-4",children:s.map((j,P)=>{const F=S.has(P);return u.jsx("button",{onClick:()=>N(j),disabled:F||l,className:`px-4 py-2.5 rounded-xl text-sm font-bold transition-all active:scale-95 ${F?"bg-neutral-100 text-neutral-300 border-transparent cursor-default":"bg-white border-2 border-neutral-100 text-neutral-700 hover:border-neutral-900 hover:text-neutral-900 shadow-sm"}`,children:j},P)})}),!l&&v.length>0&&u.jsxs("button",{onClick:()=>o([]),className:"mx-auto flex items-center space-x-1.5 text-[10px] font-black uppercase text-neutral-400 hover:text-neutral-600 transition-colors",children:[u.jsx(Rn,{size:12}),u.jsx("span",{children:"Reset"})]})]})},S4=({word:n,forms:e,ipaOptions:s,userAnswer:a,onAnswer:o,isFinishing:l,result:d,showHint:p,containerRef:m})=>{const y=a||{},x=(v,S)=>{o({...y,[v]:S})};return u.jsxs("div",{ref:m,className:"text-center space-y-6 animate-in fade-in duration-300",children:[u.jsxs("p",{className:"text-sm font-bold text-neutral-500",children:["The word ",u.jsxs("span",{className:"font-black text-neutral-900",children:['"',n.word,'"']})," has different pronunciations. Match the IPA to the part of speech."]}),u.jsx("div",{className:"space-y-6",children:e.map(v=>{const S=y[v.pos];return u.jsxs("div",{className:"space-y-3",children:[u.jsxs("h4",{className:"text-sm font-black text-neutral-900 uppercase tracking-widest bg-neutral-100 py-1 rounded-md",children:["As a ",v.pos]}),u.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.map(N=>{let z="bg-white border-neutral-200 hover:border-neutral-400 text-neutral-600";return l?N===v.ipa?z="bg-green-50 border-green-500 text-green-700 shadow-md":N===S?z="bg-red-50 border-red-500 text-red-700 opacity-60":z="bg-neutral-50 border-neutral-100 text-neutral-400 opacity-50":S===N&&(z="bg-neutral-900 border-neutral-900 text-white shadow-lg"),u.jsx("button",{disabled:l,onClick:()=>x(v.pos,N),className:`p-3 rounded-xl border-2 font-mono text-base font-medium transition-all duration-200 ${z}`,children:N},N)})})]},v.pos)})}),l&&d===!1&&!p&&u.jsx("div",{className:"text-center text-rose-600 font-bold text-sm",children:"One or more selections were incorrect."})]})},T4=({word:n,userAnswer:e,onAnswer:s,isFinishing:a,result:o,showHint:l,containerRef:d})=>{const{clearValidation:p,handleSmartChange:m,handleValidationKeyDown:y,getValidationClass:x}=Hf(),v=o===!0,S=o===!1,N="main";return u.jsxs("div",{ref:d,className:"text-center space-y-8 animate-in fade-in duration-300",children:[u.jsx("p",{className:"text-sm font-bold text-neutral-500",children:"Listen carefully and type the word."}),u.jsxs("div",{className:"space-y-6 flex flex-col items-center",children:[u.jsx("button",{onClick:()=>ns(n.word),className:"p-6 bg-neutral-50 hover:bg-neutral-100 text-neutral-900 rounded-full shadow-sm transition-all active:scale-95",children:u.jsx(wr,{size:32})}),u.jsxs("div",{className:"w-full max-w-sm flex flex-col items-center gap-4",children:[u.jsx("div",{className:"relative w-full",children:u.jsx("input",{type:"text",autoFocus:!0,value:e||"",onChange:z=>{p(N),m(z,s,n.word)},onKeyDown:z=>{y(z,N,n.word)},disabled:a,className:`w-full text-center py-4 rounded-2xl border-2 text-3xl font-bold focus:outline-none tracking-[0.1em] placeholder:text-neutral-200 transition-colors duration-200 ${a?v?"bg-green-50 border-green-500 text-green-600":"bg-red-50 border-red-500 text-red-600":`bg-neutral-50 border-transparent focus:bg-white focus:border-neutral-900 text-neutral-900 shadow-sm ${x(N)}`}`,placeholder:"TYPE HERE",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"})}),(a&&S||l)&&u.jsx("div",{className:"text-xl font-black text-yellow-500 animate-in fade-in slide-in-from-bottom-2",children:n.word})]})]})]})},A4=({word:n,currentChallenge:e,currentChallengeIndex:s,userAnswers:a,handleAnswerChange:o,results:l,isFinishing:d,currentPrepositionGroup:p,showHint:m,onEnterPress:y})=>{const x=M.useRef(null),[v,S]=M.useState(null),N=M.useRef(null);M.useEffect(()=>{try{N.current=new C0}catch{}return()=>{var D;(D=N.current)==null||D.stop()}},[]),M.useEffect(()=>{var D;(D=N.current)==null||D.stop(),S(null)},[s,p]);const z=(D,j)=>{N.current&&(v===D?(N.current.stop(),S(null)):(v&&N.current.stop(),j(""),S(D),N.current.start((P,F)=>{const G=P+(F?(P?" ":"")+F:"");j(G)},P=>{const F=P.trim().replace(/[.]/g,"");j(F),S(null)})))};if(M.useEffect(()=>{const D=()=>{var F,G;const P=(F=x.current)==null?void 0:F.querySelector('input[type="text"]:not([disabled]), textarea:not([disabled])');P&&!((G=x.current)!=null&&G.contains(document.activeElement))&&P.focus()};setTimeout(D,50);const j=P=>{var F;if(!(P.metaKey||P.ctrlKey||P.altKey)){if(P.key==="Enter"){const G=document.activeElement;if(G&&G.tagName==="TEXTAREA"&&P.shiftKey)return;P.preventDefault(),y();return}if(P.key.length===1){const G=document.activeElement;((F=x.current)==null?void 0:F.contains(G))||D()}}};return window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j)},[s,y]),p)return u.jsx(v4,{containerRef:x,group:p.group,userAnswers:a,results:l,onAnswerChange:o,isFinishing:d,showHint:m,toggleListening:z,listeningId:v});switch(e.type){case"PARAPHRASE_CONTEXT_QUIZ":{const D=e;return u.jsx(om,{containerRef:x,challenge:{contexts:D.contexts,items:D.paraphrases},answer:a[s],onAnswer:j=>o(s,j),isFinishing:d,result:l?l[s]:null,showHint:m,itemLabel:j=>j.tone&&u.jsx("span",{className:"inline-block text-[9px] font-black uppercase bg-neutral-100 text-neutral-500 px-1.5 py-0.5 rounded border border-neutral-200 mb-1",children:j.tone}),instructionText:"Match each phrase on the right to its correct context on the left."})}case"COLLOCATION_CONTEXT_QUIZ":{const D=e;return u.jsx(om,{containerRef:x,challenge:{contexts:D.contexts,items:D.collocations},answer:a[s],onAnswer:j=>o(s,j),isFinishing:d,result:l?l[s]:null,showHint:m,itemLabel:()=>null,instructionText:"Match each collocation on the right to its correct definition/cue."})}case"IDIOM_CONTEXT_QUIZ":{const D=e;return u.jsx(om,{containerRef:x,challenge:{contexts:D.contexts,items:D.idioms},answer:a[s],onAnswer:j=>o(s,j),isFinishing:d,result:l?l[s]:null,showHint:m,itemLabel:()=>null,instructionText:"Match each idiom on the right to its correct definition/cue."})}case"COLLOCATION_MULTICHOICE_QUIZ":{const D=e;return u.jsx(lm,{containerRef:x,word:n,title:"Select Collocation",cue:D.cue,options:D.options,answer:D.answer,selected:a[s],onAnswer:j=>o(s,j),isFinishing:d,showHint:m})}case"COLLOCATION_QUIZ":{const D=e,j=l?l[s]:null,P=typeof j=="boolean"?j:j&&typeof j=="object"?j.correct:null;return u.jsx(cm,{containerRef:x,word:n,title:"Fill Collocation",cue:D.cue,answer:D.answer,userAnswer:a[s],onAnswer:F=>o(s,F),isFinishing:d,result:P,showHint:m,toggleListening:z,listeningId:v})}case"IDIOM_QUIZ":{const D=e,j=l?l[s]:null,P=typeof j=="boolean"?j:j&&typeof j=="object"?j.correct:null;return u.jsx(cm,{containerRef:x,word:n,title:"Fill Idiom",cue:D.cue,answer:D.answer,userAnswer:a[s],onAnswer:F=>o(s,F),isFinishing:d,result:P,showHint:m,toggleListening:z,listeningId:v})}case"PRONUNCIATION":return u.jsx(_4,{containerRef:x,challenge:e,onAnswer:D=>o(s,D),isFinishing:d,result:l?l[s]:null});case"HETERONYM_QUIZ":{const D=e,j=l?l[s]:null,P=typeof j=="boolean"?j:null;return u.jsx(S4,{containerRef:x,word:n,forms:D.forms,ipaOptions:D.ipaOptions,userAnswer:a[s],onAnswer:F=>o(s,F),isFinishing:d,result:P,showHint:m})}case"SENTENCE_SCRAMBLE":{const D=e,j=l?l[s]:null,P=typeof j=="boolean"?j:null;return u.jsx(w4,{containerRef:x,word:n,original:D.original,shuffled:D.shuffled||[],userAnswer:a[s],onAnswer:F=>o(s,F),isFinishing:d,isCorrect:P,showHint:m})}case"SPELLING":{const D=l?l[s]:null,j=typeof D=="boolean"?D:null;return u.jsx(T4,{containerRef:x,word:n,userAnswer:a[s],onAnswer:P=>o(s,P),isFinishing:d,result:j,showHint:m})}case"IPA_QUIZ":{const D=e;return u.jsx(lm,{containerRef:x,word:n,title:"Select Pronunciation",options:D.options,answer:D.answer,selected:a[s],onAnswer:j=>o(s,j),isFinishing:d,showHint:m})}case"MEANING_QUIZ":{const D=e;return u.jsx(lm,{containerRef:x,word:n,title:"Select Definition",options:D.options,answer:D.answer,selected:a[s],onAnswer:j=>o(s,j),isFinishing:d,showHint:m})}case"PARAPHRASE_QUIZ":{const D=e,j=l?l[s]:null,P=typeof j=="boolean"?j:null;return u.jsx(cm,{containerRef:x,word:n,title:"Fill Paraphrase",contextTag:D.tone,cue:D.context,answer:D.answer,userAnswer:a[s],onAnswer:F=>o(s,F),isFinishing:d,result:P,showHint:m,toggleListening:z,listeningId:v})}case"WORD_FAMILY":{const D=l?l[s]:null,j=D&&typeof D=="object"&&"details"in D?D.details:{};return u.jsx(E4,{containerRef:x,word:n,userAnswer:a[s],onAnswer:P=>o(s,P),isFinishing:d,resultDetails:j,showHint:m,toggleListening:z,listeningId:v})}default:return null}},I4=({onBack:n,onNext:e,onIgnore:s,onHint:a,showHint:o,isBackDisabled:l,isNextDisabled:d,isLastChallenge:p,nextLabel:m,disableHints:y})=>{const x=p&&!m;return u.jsxs("div",{className:"p-4 bg-white border-t border-neutral-100 flex items-center justify-between gap-3 shrink-0",children:[u.jsx("button",{onClick:n,disabled:l,className:"p-4 rounded-2xl bg-neutral-50 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 disabled:opacity-30 disabled:hover:bg-neutral-50 disabled:hover:text-neutral-400 transition-all",title:"Previous Question",children:u.jsx(IE,{size:20})}),!p&&!d&&u.jsx("button",{onClick:s,className:"px-4 py-4 rounded-2xl text-neutral-400 hover:text-neutral-600 font-bold text-xs uppercase tracking-wider hover:bg-neutral-50 transition-colors",children:"Ignore"}),!d&&!y&&u.jsx("button",{onClick:a,className:`p-4 rounded-2xl transition-colors ${o?"text-yellow-500 bg-yellow-50 hover:bg-yellow-100":"text-neutral-400 hover:text-yellow-500 hover:bg-neutral-50"}`,title:"Show Hint",children:u.jsx(Ng,{size:20,className:o?"fill-yellow-500":""})}),u.jsxs("button",{onClick:e,disabled:d,className:"flex-1 py-4 rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 shadow-lg transition-all active:scale-95 bg-neutral-900 text-white hover:bg-neutral-800",children:[u.jsx("span",{children:m||(p?"Finish":"Next")}),x?u.jsx(Er,{size:16}):u.jsx(qc,{size:16})]})]})},U1=[{id:"core",title:"Core Skills",description:"Essential accuracy",color:"text-blue-700",bg:"bg-blue-50/60",border:"border-blue-100",areas:[{id:"spelling",label:"Spelling",icon:SI,types:["SPELLING"]},{id:"sound",label:"Sound",icon:wr,types:["PRONUNCIATION","IPA_QUIZ","HETERONYM_QUIZ"]},{id:"meaning",label:"Meaning",icon:wf,types:["MEANING_QUIZ"]},{id:"preposition",label:"Prep.",icon:Ag,types:["PREPOSITION_QUIZ"]}]},{id:"advanced",title:"Advanced Usage",description:"Fluency & range",color:"text-purple-700",bg:"bg-purple-50/60",border:"border-purple-100",areas:[{id:"family",label:"Word Family",icon:zE,types:["WORD_FAMILY"]},{id:"collocation",label:"Collocation",icon:Sf,types:["COLLOCATION_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ","COLLOCATION_QUIZ"]},{id:"paraphrase",label:"Paraphrase",icon:Af,types:["PARAPHRASE_CONTEXT_QUIZ","PARAPHRASE_QUIZ"]}]},{id:"bonus",title:"Good to Have",description:"Context & Flair",color:"text-amber-700",bg:"bg-amber-50/60",border:"border-amber-100",areas:[{id:"idiom",label:"Idiom",icon:Tf,types:["IDIOM_CONTEXT_QUIZ","IDIOM_QUIZ"]},{id:"example",label:"Example",icon:vI,types:["SENTENCE_SCRAMBLE"]}]}],um={MEANING_QUIZ:"Select",COLLOCATION_CONTEXT_QUIZ:"Match",COLLOCATION_MULTICHOICE_QUIZ:"Multi",COLLOCATION_QUIZ:"Fill",PARAPHRASE_CONTEXT_QUIZ:"Match",PARAPHRASE_QUIZ:"Fill",PREPOSITION_QUIZ:"Fill",IDIOM_QUIZ:"Fill",IDIOM_CONTEXT_QUIZ:"Match",PRONUNCIATION:"Speak",IPA_QUIZ:"IPA",HETERONYM_QUIZ:"Match",SPELLING:"Dictation",SENTENCE_SCRAMBLE:"Build",WORD_FAMILY:"Fill"},N4=[{label:"Dictation",desc:"Listen to the word and type the exact spelling."},{label:"Speak",desc:"Pronounce the word clearly into your microphone."},{label:"IPA",desc:"Identify the correct phonetic transcription."},{label:"Select",desc:"Choose the correct meaning from options."},{label:"Fill",desc:"Type missing parts (Prepositions, Idioms, Families)."},{label:"Match",desc:"Connect related items (Collocations, Idioms, Contexts)."},{label:"Build",desc:"Reorder scrambled words to form a valid sentence."},{label:"Multi",desc:"Multiple choice for collocations."}],C4=(n,e)=>{if(e===0)return{label:"N/A",color:"bg-neutral-50 text-neutral-400 border-neutral-100"};const s=n/e*100;let a="bg-neutral-50 text-neutral-400 border-neutral-100";return s===100?a="bg-green-50 text-green-700 border-green-100":n>0?a="bg-yellow-50 text-yellow-700 border-yellow-100":a="bg-red-50 text-red-600 border-red-100",{label:`${n}/${e}`,color:a}},P1=n=>{switch(n){case"NEW":return"bg-blue-100 text-blue-700 border-blue-200";case"LEARNED":return"bg-cyan-100 text-cyan-700 border-cyan-200";case"EASY":return"bg-green-100 text-green-700 border-green-200";case"HARD":return"bg-orange-100 text-orange-700 border-orange-200";case"FORGOT":return"bg-red-100 text-red-700 border-red-200";default:return"bg-neutral-100 text-neutral-600 border-neutral-200"}},R4=({isModal:n=!0,word:e,onClose:s,isSetupMode:a,isPreparing:o,availableChallenges:l,selectedChallengeTypes:d,onSetSelection:p,onStartTest:m,challengeStats:y,challenges:x,currentChallenge:v,currentChallengeIndex:S,userAnswers:N,handleAnswerChange:z,results:D,isFinishing:j,currentPrepositionGroup:P,isLastChallenge:F,handleNextClick:G,handleBackClick:H,handleIgnore:W,handleFinishEarly:Q,showHint:I,onToggleHint:T,disableHints:_,sessionPosition:C,elapsedTime:R,onSelectQuick:L,onSelectPreferred:O,onSelectZeroScore:_e,onSelectPartialScore:ye,recapData:B,onRecalculateFinish:le,isMastered:se})=>{const Z=M.useRef(null),[Y,A]=M.useState(!1),[V,q]=M.useState(!1);M.useEffect(()=>{Z.current&&(Z.current.scrollTop=0)},[S,e]);const X=M.useMemo(()=>new Set(l.map(Ae=>Ae.type)),[l]),de=(Ae,he)=>{const xe=new Set(d);Ae.forEach(je=>xe.delete(je)),he!=="none"&&xe.add(he),p(xe)},ce=()=>U1.flatMap(Ae=>Ae.areas),fe=()=>{const Ae=new Set;ce().forEach(he=>{const xe=he.types.find(je=>X.has(je));xe&&Ae.add(xe)}),p(Ae)};let ie;if(B){const Ae=Math.max(0,B.newMastery-B.oldMastery),he=Object.values(B.results.reduce((xe,je)=>{if(!xe[je.type]){let pe=um[je.type]||je.type;const Ie=ce().find(Le=>Le.types.includes(je.type));Ie&&(pe=`${Ie.label} ${um[je.type]||""}`),xe[je.type]={type:je.type,label:pe.trim(),passed:0,total:0}}return xe[je.type].total++,je.passed&&xe[je.type].passed++,xe},{}));ie=u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-500",children:[u.jsxs("div",{className:"flex-1 overflow-y-auto p-8 text-center space-y-6 custom-scrollbar",children:[u.jsx("div",{className:"inline-flex p-4 bg-green-50 rounded-full text-green-600 mb-2 shadow-inner",children:u.jsx(Er,{size:48})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:"Session Complete!"}),u.jsx("p",{className:"text-sm text-neutral-500 font-medium",children:"Here's how you improved."})]}),u.jsxs("div",{className:"bg-neutral-50 rounded-3xl p-6 border border-neutral-100 space-y-6",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between items-end px-1",children:[u.jsx("span",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Mastery Score"}),u.jsxs("span",{className:"text-sm font-black text-neutral-900 flex items-center gap-1",children:[B.oldMastery,"%",u.jsx(qc,{size:14,className:"text-neutral-300"}),u.jsxs("span",{className:"text-green-600",children:[B.newMastery,"%"]}),Ae>0&&u.jsxs("span",{className:"text-[10px] bg-green-100 text-green-700 px-1.5 rounded-full ml-1",children:["+",Ae]})]})]}),u.jsxs("div",{className:"h-3 w-full bg-neutral-200 rounded-full overflow-hidden relative",children:[u.jsx("div",{className:"absolute top-0 left-0 h-full bg-neutral-400",style:{width:`${B.oldMastery}%`}}),u.jsx("div",{className:"absolute top-0 h-full bg-green-500 animate-pulse",style:{left:`${B.oldMastery}%`,width:`${Ae}%`}})]})]}),u.jsxs("div",{className:"flex items-center justify-center gap-3",children:[u.jsx("span",{className:`px-3 py-1 rounded-xl text-xs font-black uppercase border ${P1(B.oldStatus)}`,children:B.oldStatus}),u.jsx(qc,{size:16,className:"text-neutral-300"}),u.jsx("span",{className:`px-3 py-1 rounded-xl text-xs font-black uppercase border ${P1(B.newStatus)}`,children:B.newStatus})]})]}),u.jsxs("div",{className:"space-y-2 text-left",children:[u.jsx("h4",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest px-2",children:"Challenge Summary"}),u.jsx("div",{className:"flex flex-col gap-2",children:he.map((xe,je)=>{const pe=xe.passed===xe.total,Ie=xe.passed===0;let Le="bg-white border-neutral-100",Te="text-neutral-700",me=null;return pe?(Le="bg-green-50 border-green-100",Te="text-green-800",me=u.jsx(Nl,{size:14,className:"text-green-600"})):Ie?(Le="bg-red-50 border-red-100",Te="text-red-800",me=u.jsx(Rn,{size:14,className:"text-red-600"})):(Le="bg-orange-50 border-orange-100",Te="text-orange-800",me=u.jsxs("div",{className:"text-[10px] font-black text-orange-600",children:[Math.round(xe.passed/xe.total*100),"%"]})),u.jsxs("div",{className:`flex items-center justify-between p-3 border rounded-xl shadow-sm ${Le}`,children:[u.jsx("span",{className:`text-xs font-bold ${Te}`,children:xe.label}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("span",{className:`text-[10px] font-black uppercase tracking-wider ${Te}`,children:[xe.passed," / ",xe.total]}),u.jsx("div",{className:"p-1 rounded-full bg-white/50",children:me})]})]},je)})})]})]}),u.jsx("div",{className:"p-6 bg-white border-t border-neutral-100 shrink-0",children:u.jsxs("button",{onClick:le,className:"w-full py-4 bg-neutral-900 text-white rounded-2xl font-black text-sm uppercase tracking-widest shadow-xl hover:bg-neutral-800 transition-all active:scale-95 flex items-center justify-center gap-2",children:[u.jsx("span",{children:"Continue"}),u.jsx(qc,{size:18})]})})]})}else if(a){const Ae=d.size===0;let he=0,xe=0;y.forEach(Te=>{he+=Te.score,xe+=Te.total});const je=xe>0?he/xe*100:0,pe=60,Ie=2*Math.PI*pe,Le=Ie-je/100*Ie;ie=u.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[2rem] shadow-2xl overflow-hidden flex flex-col max-h-[95vh] animate-in fade-in zoom-in-95 duration-300",children:[u.jsxs("div",{className:"px-6 py-4 border-b border-neutral-100 bg-white/80 backdrop-blur-sm flex justify-between items-center shrink-0 z-20 relative",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-neutral-900 text-white rounded-xl flex items-center justify-center shadow-lg shadow-neutral-900/20",children:u.jsx(lI,{size:20})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-black text-neutral-900 leading-none tracking-tight",children:"Test Setup"}),u.jsxs("p",{className:"text-xs font-bold text-neutral-500 mt-1",children:["Target: ",u.jsx("span",{className:"text-neutral-900",children:e.word})]})]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:"flex flex-col items-end mr-2",children:[u.jsx("span",{className:"text-[9px] font-black uppercase text-neutral-400 tracking-widest",children:"Mastery"}),u.jsxs("div",{className:"flex items-baseline gap-1",children:[u.jsx("span",{className:`text-xl font-black leading-none ${he===xe&&xe>0?"text-green-600":"text-neutral-900"}`,children:he}),u.jsxs("span",{className:"text-sm font-bold text-neutral-400",children:["/",xe]})]})]}),u.jsx("button",{onClick:()=>q(!V),className:`p-2.5 rounded-xl transition-all ${V?"bg-neutral-900 text-white shadow-md":"bg-neutral-100 text-neutral-500 hover:bg-neutral-200"}`,title:"Configure Test",children:u.jsx(bI,{size:20})}),u.jsx("button",{onClick:s,className:"p-2.5 text-neutral-400 hover:text-neutral-900 hover:bg-neutral-100 rounded-xl transition-colors",children:u.jsx(Rn,{size:20})})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar relative",children:V?u.jsxs("div",{className:"flex flex-col h-full animate-in slide-in-from-top-4 duration-300",children:[u.jsxs("div",{className:"px-5 py-3 bg-neutral-50 border-b border-neutral-100 flex flex-wrap gap-2 shrink-0 z-10 justify-center",children:[u.jsxs("button",{onClick:fe,className:"px-3 py-2 rounded-lg bg-white border border-neutral-200 text-neutral-600 font-bold text-[10px] uppercase tracking-wider hover:bg-neutral-50 transition-colors flex items-center gap-1.5 shadow-sm",children:[u.jsx(VE,{size:12})," All"]}),u.jsxs("button",{onClick:()=>p(new Set),className:"px-3 py-2 rounded-lg bg-white border border-neutral-200 text-neutral-400 font-bold text-[10px] uppercase tracking-wider hover:bg-neutral-50 hover:text-neutral-600 transition-colors flex items-center gap-1.5 shadow-sm",children:[u.jsx(nI,{size:12})," Clear"]}),u.jsxs("button",{onClick:()=>A(!Y),className:"px-3 py-2 rounded-lg bg-white border border-neutral-200 text-neutral-500 font-bold text-[10px] uppercase tracking-wider hover:bg-neutral-50 hover:text-indigo-500 transition-colors flex items-center gap-1.5 shadow-sm ml-auto",children:[u.jsx(K2,{size:12})," Guide"]})]}),Y&&u.jsx("div",{className:"bg-neutral-50 border-b border-neutral-100 p-4 grid grid-cols-2 gap-2 animate-in fade-in slide-in-from-top-2",children:N4.map(Te=>u.jsxs("div",{className:"text-[10px] text-neutral-500 leading-tight",children:[u.jsxs("span",{className:"font-black text-indigo-600 uppercase mr-1",children:[Te.label,":"]}),Te.desc]},Te.label))}),u.jsx("div",{className:"p-4 space-y-3",children:U1.map(Te=>{const me=Te.areas.filter(re=>re.types.some(Fe=>X.has(Fe)));if(me.length===0)return null;let et=0,Xe=0;return me.forEach(re=>{re.types.forEach(Fe=>{const rt=y.get(Fe);rt&&(et+=rt.score,Xe+=rt.total)})}),u.jsxs("div",{className:`rounded-2xl border ${Te.border} ${Te.bg} p-4`,children:[u.jsxs("div",{className:"flex items-baseline justify-between mb-3 border-b border-black/5 pb-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h4",{className:`text-xs font-black uppercase tracking-widest ${Te.color}`,children:Te.title}),u.jsxs("span",{className:"text-[10px] font-bold text-neutral-500 opacity-60 bg-white/50 px-1.5 py-0.5 rounded-md",children:["(",et,"/",Xe,")"]})]}),u.jsx("span",{className:"text-[10px] font-bold text-neutral-500 opacity-60",children:Te.description})]}),u.jsx("div",{className:"space-y-2",children:me.map(re=>{const Fe=re.types.filter(ut=>X.has(ut));if(Fe.length===0)return null;const rt=re.types.find(ut=>d.has(ut));let Tt=0,Ze=0;re.types.forEach(ut=>{const At=y.get(ut);At&&(Tt+=At.score,Ze+=At.total)});const tt=C4(Tt,Ze);return u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 p-2 rounded-xl bg-white/40 hover:bg-white/70 transition-colors border border-transparent hover:border-black/5",children:[u.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[u.jsx("div",{className:"p-1.5 bg-white rounded-lg shadow-sm text-neutral-600",children:u.jsx(re.icon,{size:14})}),u.jsx("span",{className:`text-xs font-bold ${rt?"text-neutral-900":"text-neutral-600"}`,children:re.label}),u.jsx("span",{className:`text-[9px] font-black uppercase tracking-wider px-1.5 py-0.5 rounded-md border ${tt.color}`,children:tt.label})]}),u.jsx("div",{className:"flex flex-wrap gap-1.5 justify-end",children:Fe.map(ut=>{const At=rt===ut;return u.jsx("button",{onClick:()=>de(re.types,At?"none":ut),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold border transition-all ${At?"bg-neutral-900 border-neutral-900 text-white shadow-md transform scale-105":"bg-white border-neutral-200 text-neutral-500 hover:border-neutral-300 hover:text-neutral-700"}`,children:um[ut]||"Quiz"},ut)})})]},re.id)})})]},Te.id)})})]}):u.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 space-y-8 animate-in zoom-in-95 duration-500",children:[u.jsxs("div",{className:"relative w-48 h-48 flex items-center justify-center",children:[u.jsxs("svg",{className:"absolute w-full h-full transform -rotate-90",children:[u.jsx("circle",{cx:"50%",cy:"50%",r:pe,stroke:"currentColor",strokeWidth:"12",fill:"transparent",className:"text-neutral-100"}),u.jsx("circle",{cx:"50%",cy:"50%",r:pe,stroke:"currentColor",strokeWidth:"12",fill:"transparent",strokeDasharray:Ie,strokeDashoffset:Le,strokeLinecap:"round",className:`transition-all duration-1000 ease-out ${je===100?"text-green-500":"text-indigo-600"}`})]}),u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsxs("span",{className:"text-4xl font-black text-neutral-900 tracking-tighter",children:[je.toFixed(0),"%"]}),u.jsx("span",{className:"text-xs font-bold text-neutral-400 uppercase tracking-widest mt-1",children:"Mastery"})]})]}),u.jsx("p",{className:"text-center text-sm font-medium text-neutral-500 max-w-xs leading-relaxed",children:he===xe?"Incredible! You have mastered all challenges for this word. Keep practicing to maintain it.":"Ready to improve? Choose a quick mix or focus on what you haven't mastered yet."})]})}),u.jsx("div",{className:"px-6 py-5 bg-white border-t border-neutral-100 flex items-center justify-center shrink-0 z-20 gap-4",children:V?u.jsxs("button",{onClick:m,disabled:Ae||o,className:"w-full py-4 bg-neutral-900 text-white rounded-2xl font-black text-sm uppercase tracking-widest flex items-center justify-center gap-3 shadow-xl hover:bg-neutral-800 transition-all active:scale-95 disabled:opacity-50 disabled:active:scale-100 hover:shadow-2xl shadow-neutral-900/20",children:[o?u.jsx(fn,{size:18,className:"animate-spin"}):u.jsx(du,{size:18,fill:"currentColor"}),u.jsx("span",{children:o?"Preparing...":"Start Custom Test"})]}):u.jsxs(u.Fragment,{children:[se?u.jsxs("button",{onClick:ye,className:"flex-1 py-4 bg-red-600 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-red-700 transition-all active:scale-95 shadow-lg shadow-red-200",children:[u.jsx(EI,{size:18}),u.jsx("span",{children:"Challenge"})]}):u.jsxs("button",{onClick:_e,className:"flex-1 py-4 bg-indigo-600 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-indigo-700 transition-all active:scale-95 shadow-lg shadow-indigo-200",children:[u.jsx(DE,{size:18}),u.jsx("span",{children:"Master It"})]}),u.jsxs("button",{onClick:L,className:"flex-1 py-4 bg-cyan-500 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-cyan-600 transition-all active:scale-95 shadow-lg shadow-cyan-200",children:[u.jsx(G2,{size:18}),u.jsx("span",{children:"Quick Test"})]})]})})]})}else{let Ae;C&&(C.current<C.total?Ae="Next Item":Ae="Finalize"),ie=u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[90vh] h-full",children:[u.jsx(b4,{title:v.title,type:v.type,currentStep:C?C.current:S+1,totalSteps:C?C.total:x.length,onClose:s,onFinish:Q,label:C?"Item":"Challenge",isQuickFire:!!C,elapsedTime:R}),u.jsx("div",{ref:Z,className:"flex-1 p-8 overflow-y-auto no-scrollbar",children:u.jsx(A4,{word:e,currentChallenge:v,currentChallengeIndex:S,userAnswers:N,handleAnswerChange:z,results:D,isFinishing:j,currentPrepositionGroup:P,showHint:I,onEnterPress:G})}),u.jsx(I4,{onBack:H,onNext:G,onIgnore:W,onHint:T,showHint:I,isBackDisabled:C?C.current===1&&S===0:S===0,isNextDisabled:j,isLastChallenge:F,nextLabel:Ae,disableHints:_})]})}return n?u.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:ie}):ie},oo=n=>[...n].sort(()=>Math.random()-.5),O4=n=>n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ts=n=>n.replace(/[^a-zA-Z0-9]/g,"").toLowerCase();function j4(n){const e=[];if(e.push({type:"SPELLING",title:"Spelling Fill",word:n}),e.push({type:"PRONUNCIATION",title:"Speak Out",word:n}),n.meaningVi&&n.meaningVi.length>0&&e.push({type:"MEANING_QUIZ",title:"Meaning Multi Choice",options:[],answer:n.meaningVi,word:n}),n.ipaMistakes&&n.ipaMistakes.length>0&&n.ipaUs&&e.push({type:"IPA_QUIZ",title:"IPA Multi Choice",options:oo([n.ipaUs,...n.ipaMistakes]),answer:n.ipaUs,word:n}),n.collocationsArray&&n.collocationsArray.length>0){const s=n.collocationsArray.filter(a=>!a.isIgnored&&a.d);s.forEach(a=>{e.push({type:"COLLOCATION_QUIZ",title:"Collocation Fill",word:n,fullText:a.text,cue:a.d,answer:a.text}),s.length>=4&&e.push({type:"COLLOCATION_MULTICHOICE_QUIZ",title:"Collocation Multi Choice",word:n,fullText:a.text,cue:a.d,answer:a.text,options:[]})}),s.length>=2&&e.push({type:"COLLOCATION_CONTEXT_QUIZ",title:"Collocation Match",word:n,contexts:[],collocations:[]})}if(n.idiomsList&&n.idiomsList.length>0){const s=n.idiomsList.filter(a=>!a.isIgnored&&a.d);s.forEach(a=>{e.push({type:"IDIOM_QUIZ",title:"Idiom Fill",word:n,fullText:a.text,cue:a.d,answer:a.text})}),s.length>=2&&e.push({type:"IDIOM_CONTEXT_QUIZ",title:"Idiom Match",word:n,contexts:[],idioms:[]})}if(n.prepositions&&n.prepositions.length>0&&n.prepositions.filter(a=>!a.isIgnored).forEach(a=>{let o="";const l=n.word,d=a.prep,p=a.usage;if(p&&p.toLowerCase().includes(l.toLowerCase())){const m=new RegExp(`\\b${O4(d)}\\b`,"i");m.test(p)?o=p.replace(m,"___"):o=`${p} [___]`}else p?o=`${l} ___ ${p}`:o=`${l} ___`;e.push({type:"PREPOSITION_QUIZ",title:"Preposition Fill",example:o,answer:d,word:n})}),n.example&&n.example.trim().length>5){const s=n.example.trim().split(`
`).flatMap(a=>a.split(new RegExp("(?<=[.?!])\\s+"))).map(a=>a.trim()).filter(a=>a.length>5);for(const a of s){const o=a.split(/\s+/).filter(Boolean);if(o.length>=3){let d;if(o.length>10){d=[];let p=0;for(;p<o.length;){const m=Math.min(3,o.length-p);let y=1;m>1&&Math.random()<.5&&(m===2?y=2:y=Math.random()<.5?2:3);const x=o.slice(p,p+y).join(" ");d.push(x),p+=y}}else d=o;e.push({type:"SENTENCE_SCRAMBLE",title:"Sentence Builder",original:a.trim(),shuffled:oo(d),word:n})}}}return n.wordFamily&&[...n.wordFamily.nouns||[],...n.wordFamily.verbs||[],...n.wordFamily.adjs||[],...n.wordFamily.advs||[]].filter(l=>!l.isIgnored&&l.word.trim()).some(l=>l.word.toLowerCase().trim()!==n.word.toLowerCase().trim())&&e.push({type:"WORD_FAMILY",title:"Word Family Fill",word:n}),n.paraphrases&&n.paraphrases.length>0&&n.paraphrases.filter(s=>!s.isIgnored).forEach(s=>{e.push({type:"PARAPHRASE_QUIZ",title:"Paraphrase Fill",tone:s.tone,context:s.context,answer:s.word,word:n})}),n.paraphrases&&n.paraphrases.filter(s=>!s.isIgnored&&s.context&&s.context.trim()).length>=2&&e.push({type:"PARAPHRASE_CONTEXT_QUIZ",title:"Paraphrase Match",word:n,contexts:[],paraphrases:[]}),e}async function V1(n,e){const s=[];for(const a of n)if(a.type==="MEANING_QUIZ"){const l=(await WE(3,e.id)).filter(p=>p.trim().toLowerCase()!==e.meaningVi.trim().toLowerCase()),d=oo([e.meaningVi,...l]).slice(0,4);s.push({...a,options:d})}else if(a.type==="COLLOCATION_MULTICHOICE_QUIZ"){const l=(e.collocationsArray||[]).filter(p=>!p.isIgnored&&p.text!==a.answer).map(p=>p.text),d=oo([a.answer,...l]).slice(0,4);s.push({...a,options:d})}else if(a.type==="PARAPHRASE_CONTEXT_QUIZ"){const o=a.word,l=(o.paraphrases||[]).filter(d=>!d.isIgnored&&d.context&&d.context.trim()).sort(()=>Math.random()-.5).slice(0,5);if(l.length>=2){const d=[],p=[];l.forEach((m,y)=>{const x=`${o.id}-${y}`;d.push({id:`context-${x}`,text:m.context,pairId:x,tone:m.tone}),p.push({id:`word-${x}`,text:m.word,pairId:x})}),s.push({...a,contexts:d,paraphrases:oo(p)})}}else if(a.type==="COLLOCATION_CONTEXT_QUIZ"){const o=a.word,l=(o.collocationsArray||[]).filter(d=>!d.isIgnored&&d.d&&d.d.trim()).sort(()=>Math.random()-.5).slice(0,5);if(l.length>=2){const d=[],p=[];l.forEach((m,y)=>{const x=`${o.id}-col-${y}`;d.push({id:`context-${x}`,text:m.d,pairId:x}),p.push({id:`col-${x}`,text:m.text,pairId:x})}),s.push({...a,contexts:d,collocations:oo(p)})}}else if(a.type==="IDIOM_CONTEXT_QUIZ"){const o=a.word,l=(o.idiomsList||[]).filter(d=>!d.isIgnored&&d.d&&d.d.trim()).sort(()=>Math.random()-.5).slice(0,5);if(l.length>=2){const d=[],p=[];l.forEach((m,y)=>{const x=`${o.id}-idm-${y}`;d.push({id:`context-${x}`,text:m.d,pairId:x}),p.push({id:`idm-${x}`,text:m.text,pairId:x})}),s.push({...a,contexts:d,idioms:oo(p)})}}else s.push(a);return s}function k4(n,e){switch(n.type){case"SPELLING":return ts(e||"")===ts(n.word.word);case"IPA_QUIZ":return e===n.answer;case"PREPOSITION_QUIZ":return ts(e||"")===ts(n.answer);case"MEANING_QUIZ":return e===n.answer;case"PARAPHRASE_QUIZ":return ts(e||"")===ts(n.answer);case"COLLOCATION_QUIZ":return ts(e||"")===ts(n.answer);case"COLLOCATION_MULTICHOICE_QUIZ":return e===n.answer;case"IDIOM_QUIZ":return ts(e||"")===ts(n.answer);case"SENTENCE_SCRAMBLE":const s=(e||[]).join(" ");return ts(s)===ts(n.original);case"PRONUNCIATION":return ts(e||"")===ts(n.word.word);case"HETERONYM_QUIZ":{if(!e)return!1;let a=!0;for(const o of n.forms)if(e[o.pos]!==o.ipa){a=!1;break}return a}case"WORD_FAMILY":{const a={};let o=!0,l=!1;const d={nouns:"n",verbs:"v",adjs:"j",advs:"d"};return["nouns","verbs","adjs","advs"].forEach(p=>{var y;const m=(((y=n.word.wordFamily)==null?void 0:y[p])||[]).filter(x=>!x.isIgnored).map(x=>x.word);if(m.length>0){l=!0;const v=((e==null?void 0:e[p])||"").split(",").filter(Boolean).map(N=>ts(N)),S=d[p];m.forEach(N=>{const z=ts(N),D=v.findIndex(P=>P===z),j=D!==-1;a[`${S}:${N}`]=j,j?v.splice(D,1):o=!1}),v.length>0&&(o=!1)}}),l?{correct:o,details:a}:!0}case"PARAPHRASE_CONTEXT_QUIZ":{const a=n;if(!(e instanceof Map)||e.size===0)return{correct:!1,details:{}};const o={};let l=0;return a.contexts.forEach(d=>{const p=e.get(d.id);if(p){const m=a.paraphrases.find(y=>y.id===p);m&&m.pairId===d.pairId?(o[d.id]=!0,l++):o[d.id]=!1}else o[d.id]=!1}),{correct:l===a.contexts.length,details:o}}case"COLLOCATION_CONTEXT_QUIZ":{const a=n;if(!(e instanceof Map)||e.size===0)return{correct:!1,details:{}};const o={};let l=0;return a.contexts.forEach(d=>{const p=e.get(d.id);if(p){const m=a.collocations.find(y=>y.id===p);m&&m.pairId===d.pairId?(o[d.id]=!0,l++):o[d.id]=!1}else o[d.id]=!1}),{correct:l===a.contexts.length,details:o}}case"IDIOM_CONTEXT_QUIZ":{const a=n;if(!(e instanceof Map)||e.size===0)return{correct:!1,details:{}};const o={};let l=0;return a.contexts.forEach(d=>{const p=e.get(d.id);if(p){const m=a.idioms.find(y=>y.id===p);m&&m.pairId===d.pairId?(o[d.id]=!0,l++):o[d.id]=!1}else o[d.id]=!1}),{correct:l===a.contexts.length,details:o}}default:return!1}}const L4=()=>{const[n,e]=M.useState([]),[s,a]=M.useState(0),[o,l]=M.useState([]),[d,p]=M.useState(null),[m,y]=M.useState(!1),[x,v]=M.useState(new Set),[S,N]=M.useState(0),[z,D]=M.useState(!1);M.useEffect(()=>{let C;return z&&!m&&(C=window.setInterval(()=>{N(R=>R+1)},1e3)),()=>clearInterval(C)},[z,m]);const j=C=>{e(C),l(new Array(C.length).fill(void 0)),a(0),p(null),y(!1),v(new Set),N(0),D(!0)},P=(C,R)=>{l(L=>{const O=[...L];return O[C]=R,O})},F=n[s],G=M.useMemo(()=>{if((F==null?void 0:F.type)!=="PREPOSITION_QUIZ")return null;const C=[];let R=s;for(;R>0&&n[R-1].type==="PREPOSITION_QUIZ";)R--;for(let L=R;L<n.length&&n[L].type==="PREPOSITION_QUIZ";L++)C.push({challenge:n[L],index:L});return C.length===0?null:{startIndex:R,group:C}},[F,s,n]),H=M.useMemo(()=>G?G.startIndex+G.group.length>=n.length:s>=n.length-1,[s,n,G]),W=()=>{H||a(G?G.startIndex+G.group.length:C=>C+1)},Q=()=>{const C=G?G.startIndex-1:s-1;C>=0&&a(C)},I=()=>{v(C=>{const R=new Set(C);return G?G.group.forEach(L=>R.add(L.index)):R.add(s),R}),W()},T=()=>{const C=[];let R=0,L=0;const O={},_e=[];n.forEach((B,le)=>{if(x.has(le)){C[le]=null;return}L++;const se=k4(B,o[le]);C[le]=se;const Z=typeof se=="boolean"?se:se.correct;if(Z&&R++,_e.push({type:B.type,passed:Z}),B.type==="WORD_FAMILY"&&typeof se=="object"&&"details"in se)Object.entries(se.details).forEach(([Y,A])=>{O[`WORD_FAMILY:${Y}`]=A});else if(B.type==="COLLOCATION_QUIZ")O[`COLLOCATION_QUIZ:${B.fullText}`]=Z;else if(B.type==="COLLOCATION_MULTICHOICE_QUIZ")O[`COLLOCATION_MULTICHOICE_QUIZ:${B.fullText}`]=Z;else if(B.type==="IDIOM_QUIZ")O[`IDIOM_QUIZ:${B.fullText}`]=Z;else if(B.type==="PARAPHRASE_QUIZ")O[`PARAPHRASE_QUIZ:${B.answer}`]=Z;else if(B.type==="PREPOSITION_QUIZ")O[`PREPOSITION_QUIZ:${B.answer}`]=Z;else if(B.type==="PARAPHRASE_CONTEXT_QUIZ"){const Y=B;typeof se=="object"&&se.details&&Y.paraphrases.forEach(A=>{const V=Y.contexts.find(q=>q.pairId===A.pairId);V&&se.details[V.id]&&(O[`PARAPHRASE_CONTEXT_QUIZ:${A.text}`]=!0)}),O[B.type]=Z}else if(B.type==="COLLOCATION_CONTEXT_QUIZ"){const Y=B;typeof se=="object"&&se.details&&Y.collocations.forEach(A=>{const V=Y.contexts.find(q=>q.pairId===A.pairId);V&&se.details[V.id]&&(O[`COLLOCATION_CONTEXT_QUIZ:${A.text}`]=!0)}),O[B.type]=Z}else if(B.type==="IDIOM_CONTEXT_QUIZ"){const Y=B;typeof se=="object"&&se.details&&Y.idioms.forEach(A=>{const V=Y.contexts.find(q=>q.pairId===A.pairId);V&&se.details[V.id]&&(O[`IDIOM_CONTEXT_QUIZ:${A.text}`]=!0)}),O[B.type]=Z}else O[B.type]=Z});let ye=Lt.HARD;return L>0&&(R===L?ye=L>1?Lt.EASY:Lt.HARD:R<L/2&&(ye=Lt.FORGOT)),{finalGrade:ye,resultHistory:O,detailedResults:_e,counts:{correct:R,tested:L},newResults:C}};return{challenges:n,currentChallengeIndex:s,currentChallenge:F,userAnswers:o,results:d,isFinishing:m,elapsedSeconds:S,currentPrepositionGroup:G,isLastChallenge:H,startTest:j,setAnswer:P,handleNext:W,handleBack:Q,handleIgnore:I,checkAnswers:T,finishTest:()=>{D(!1),y(!0);const{newResults:C}=T();p(C)}}},M4={SPELLING:"sp",IPA_QUIZ:"iq",PREPOSITION_QUIZ:"pq",WORD_FAMILY:"wf",MEANING_QUIZ:"mq",PARAPHRASE_QUIZ:"prq",SENTENCE_SCRAMBLE:"sc",HETERONYM_QUIZ:"hq",PRONUNCIATION:"p",COLLOCATION_QUIZ:"cq",IDIOM_QUIZ:"idq",PARAPHRASE_CONTEXT_QUIZ:"pcq",COLLOCATION_CONTEXT_QUIZ:"ccq",COLLOCATION_MULTICHOICE_QUIZ:"cmq",IDIOM_CONTEXT_QUIZ:"icq"},D4=["PARAPHRASE_CONTEXT_QUIZ","COLLOCATION_CONTEXT_QUIZ","IDIOM_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ","HETERONYM_QUIZ"],yi={collocation:{easy:["COLLOCATION_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ","COLLOCATION_QUIZ"],hard:["COLLOCATION_QUIZ","COLLOCATION_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ"]},paraphrase:{easy:["PARAPHRASE_CONTEXT_QUIZ","PARAPHRASE_QUIZ"],hard:["PARAPHRASE_QUIZ","PARAPHRASE_CONTEXT_QUIZ"]},idiom:{easy:["IDIOM_CONTEXT_QUIZ","IDIOM_QUIZ"],hard:["IDIOM_QUIZ","IDIOM_CONTEXT_QUIZ"]}},U4=new Set([...yi.collocation.easy,...yi.paraphrase.easy,...yi.idiom.easy]),Gd=(n,e)=>{const s=new Set;return Object.keys(yi).forEach(a=>{const o=yi[a][e];for(const l of o){const d=l;if(n.has(d)){s.add(d);break}}}),n.forEach(a=>{U4.has(a)||s.add(a)}),s},P4=({word:n,onClose:e,onComplete:s,isQuickFire:a=!1,isModal:o=!0,sessionPosition:l,onPrevWord:d,disableHints:p=!1,forceShowHint:m=!1,skipSetup:y=!1,challengeFilter:x,skipRecap:v=!1})=>{const[S,N]=M.useState(!a&&!y),[z,D]=M.useState(new Set),[j,P]=M.useState(!1),[F,G]=M.useState(!1),[H,W]=M.useState(m),[Q,I]=M.useState(null),T=L4();M.useEffect(()=>{W(m)},[T.currentChallengeIndex,m]);const _=M.useMemo(()=>{try{return j4(n)}catch(A){return console.error("[TestModal] Error generating challenges:",A),[]}},[n]),C=M.useMemo(()=>{const A=n.lastTestResults||{},V=new Map,q=Array.from(new Set(_.map(de=>de.type))),X=(de,ce)=>{if(A[de]!==void 0)return A[de];const fe=M4[ce];if(fe){const ie=de.startsWith(ce)?de.substring(ce.length):"",Ae=fe+ie;return A[Ae]}};return q.forEach(de=>{const ce=_.filter(ie=>ie.type===de);if(de==="WORD_FAMILY"){const ie=["nouns","verbs","adjs","advs"],Ae={nouns:"n",verbs:"v",adjs:"j",advs:"d"};let he=0;const xe=ie.flatMap(je=>{var pe;return(((pe=n.wordFamily)==null?void 0:pe[je])||[]).map(Ie=>({...Ie,typeKey:je}))}).filter(je=>!je.isIgnored&&je.word);xe.length>0&&xe.forEach(je=>{const pe=Ae[je.typeKey];(A[`WORD_FAMILY:${pe}:${je.word}`]??A[`wf:${pe}:${je.word}`]??A[`WORD_FAMILY_${je.typeKey.toUpperCase()}`])===!0&&he++}),V.set(de,{score:he,total:xe.length});return}if(de==="SENTENCE_SCRAMBLE"){const ie=Object.keys(A).some(Ae=>(Ae.startsWith("SENTENCE_SCRAMBLE")||Ae.startsWith("sc"))&&A[Ae]===!0);V.set(de,{score:ie?1:0,total:1});return}let fe=0;ce.forEach(ie=>{let Ae=!1,he="";if(ie.type==="COLLOCATION_QUIZ"?he=`COLLOCATION_QUIZ:${ie.fullText}`:ie.type==="COLLOCATION_MULTICHOICE_QUIZ"?he=`COLLOCATION_MULTICHOICE_QUIZ:${ie.fullText}`:ie.type==="IDIOM_QUIZ"?he=`IDIOM_QUIZ:${ie.fullText}`:ie.type==="PREPOSITION_QUIZ"?he=`PREPOSITION_QUIZ:${ie.answer}`:ie.type==="PARAPHRASE_QUIZ"?he=`PARAPHRASE_QUIZ:${ie.answer}`:ie.type==="PARAPHRASE_CONTEXT_QUIZ"?he="PARAPHRASE_CONTEXT_QUIZ":ie.type==="COLLOCATION_CONTEXT_QUIZ"?he="COLLOCATION_CONTEXT_QUIZ":ie.type==="IDIOM_CONTEXT_QUIZ"?he="IDIOM_CONTEXT_QUIZ":he=ie.type,X(he,de)===!0&&(Ae=!0),!Ae){if(ie.type==="PARAPHRASE_QUIZ"){const xe=ie.answer;A[`PARAPHRASE_CONTEXT_QUIZ:${xe}`]===!0&&(Ae=!0)}else if(ie.type==="COLLOCATION_QUIZ"){const xe=ie.fullText;A[`COLLOCATION_CONTEXT_QUIZ:${xe}`]===!0&&(Ae=!0),X(`COLLOCATION_MULTICHOICE_QUIZ:${xe}`,"COLLOCATION_MULTICHOICE_QUIZ")===!0&&(Ae=!0)}else if(ie.type==="IDIOM_QUIZ"){const xe=ie.fullText;A[`IDIOM_CONTEXT_QUIZ:${xe}`]===!0&&(Ae=!0)}}Ae&&fe++}),V.set(de,{score:fe,total:ce.length})}),V},[n,_]);M.useEffect(()=>{if(a&&!j&&T.challenges.length===0){if(_.length===0){setTimeout(e,100);return}(async()=>{P(!0);let V=_;x&&(V=_.filter(x)),V.length===0&&(V=_.filter(X=>X.type!=="SPELLING")),V.length===0&&(V=_);const q=V[Math.floor(Math.random()*V.length)];if(!q){P(!1),setTimeout(e,500);return}try{const X=await V1([q],n);X.length>0?(T.startTest(X),N(!1)):setTimeout(e,500)}catch{setTimeout(e,500)}finally{P(!1)}})()}},[a,_,n,x]),M.useEffect(()=>{y&&!a&&_.length>0&&T.challenges.length===0&&!j&&O()},[y,a,_.length,T.challenges.length,j]),M.useEffect(()=>{if(a||_.length===0)return;const A=Object.keys(n.lastTestResults||{}).length>0,V=new Set;!A&&!y?(G(!1),_.forEach(q=>V.add(q.type))):(G(!0),["MEANING_QUIZ","PREPOSITION_QUIZ","COLLOCATION_CONTEXT_QUIZ"].forEach(q=>{_.some(X=>X.type===q)&&V.add(q)})),D(V)},[_,n,a,y]);const R=A=>{G(!1),D(V=>{const q=new Set(V);return q.has(A)?q.delete(A):q.add(A),q})},L=async A=>{const V=A||z;let q=_.filter(ce=>V.has(ce.type));if(V.has("SENTENCE_SCRAMBLE")){const ce=q.filter(fe=>fe.type==="SENTENCE_SCRAMBLE");if(ce.length>1){const fe=ce[Math.floor(Math.random()*ce.length)];q=q.filter(ie=>ie.type!=="SENTENCE_SCRAMBLE"),q.push(fe)}}if(q.length===0)return;P(!0);const de=(await V1(q,n)).sort(()=>Math.random()-.5);T.startTest(de),P(!1),N(!1)},O=async()=>{const A=new Set(_.map(X=>X.type)),V=new Set;A.has("MEANING_QUIZ")&&V.add("MEANING_QUIZ");for(const X of yi.collocation.easy)if(A.has(X)){V.add(X);break}for(const X of yi.paraphrase.easy)if(A.has(X)){V.add(X);break}const q=[];A.has("IPA_QUIZ")&&q.push("IPA_QUIZ"),A.has("PREPOSITION_QUIZ")&&q.push("PREPOSITION_QUIZ"),A.has("WORD_FAMILY")&&q.push("WORD_FAMILY");for(const X of yi.idiom.easy)if(A.has(X)){q.push(X);break}if(q.length>0){const X=q[Math.floor(Math.random()*q.length)];V.add(X)}if(V.size===0){const X=Gd(A,"easy");if(X.size>0){G(!0),L(X);return}return}G(!0),L(V)},_e=()=>{const A=new Set,V=Kg(n),q=n.lastTestResults||{},X=V.filter(ce=>!ce.testKeys.some(fe=>q[fe]===!0));if(X.length===0){if(C.forEach((fe,ie)=>{fe.score<fe.total&&A.add(ie)}),A.size===0)return;const ce=Gd(A,"easy");L(ce);return}_.forEach(ce=>{let fe=[];ce.type==="COLLOCATION_QUIZ"?fe.push(`COLLOCATION_QUIZ:${ce.fullText}`):ce.type==="COLLOCATION_MULTICHOICE_QUIZ"?fe.push(`COLLOCATION_MULTICHOICE_QUIZ:${ce.fullText}`):ce.type==="COLLOCATION_CONTEXT_QUIZ"||(ce.type==="PARAPHRASE_QUIZ"?fe.push(`PARAPHRASE_QUIZ:${ce.answer}`):ce.type==="PREPOSITION_QUIZ"?fe.push(`PREPOSITION_QUIZ:${ce.answer}`):ce.type==="SPELLING"?fe.push("SPELLING"):ce.type==="PRONUNCIATION"?fe.push("PRONUNCIATION"):ce.type==="MEANING_QUIZ"?fe.push("MEANING_QUIZ"):ce.type==="IPA_QUIZ"?fe.push("IPA_QUIZ"):ce.type==="WORD_FAMILY"?fe.push("WORD_FAMILY"):ce.type==="SENTENCE_SCRAMBLE"&&fe.push("SENTENCE_SCRAMBLE")),fe.some(Ae=>X.some(he=>he.testKeys.includes(Ae)||he.testKeys.some(xe=>xe.startsWith("WORD_FAMILY")&&Ae==="WORD_FAMILY")))&&A.add(ce.type),ce.type==="COLLOCATION_CONTEXT_QUIZ"&&X.filter(he=>he.key.startsWith("colloc:")).length>0&&A.add(ce.type),ce.type==="PARAPHRASE_CONTEXT_QUIZ"&&X.filter(he=>he.key.startsWith("para:")).length>0&&A.add(ce.type),ce.type==="IDIOM_CONTEXT_QUIZ"&&X.filter(he=>he.key.startsWith("idiom:")).length>0&&A.add(ce.type)}),A.size===0&&C.forEach((ce,fe)=>{ce.score<ce.total&&A.add(fe)});const de=Gd(A,"easy");G(!1),L(de)},ye=async()=>{const A=new Set(_.map(q=>q.type)),V=Gd(A,"hard");V.size!==0&&(G(!1),L(V))},B=(A=!1)=>{const{finalGrade:V,resultHistory:q,detailedResults:X,counts:de}=T.checkAnswers();if(T.finishTest(),v||a)setTimeout(()=>s(V,q,A,de),1e3);else{const ce=n.masteryScore||0,fe=n.lastReview&&n.lastGrade||"NEW",ie={...n,lastTestResults:{...n.lastTestResults||{},...q}},Ae=Ns(ie);I({oldMastery:ce,newMastery:Ae,oldStatus:fe,newStatus:V,results:X,finalGrade:V,resultHistory:q,counts:de})}},le=()=>{T.isLastChallenge?B(!1):T.handleNext()},se=A=>{const V=Math.floor(A/60),q=A%60;return`${V}:${q.toString().padStart(2,"0")}`},Z=M.useMemo(()=>{const A=new Map;return C.forEach((V,q)=>{D4.includes(q)||A.set(q,V)}),A},[C]),Y=M.useMemo(()=>Ns(n)===100,[n]);if(!S&&!j&&!T.currentChallenge)return o?u.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:u.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-xl text-center space-y-4",children:[u.jsx("p",{className:"text-red-500 font-bold",children:"Failed to load challenge."}),u.jsx("button",{onClick:e,className:"px-4 py-2 bg-neutral-100 rounded-lg text-sm font-bold",children:"Close"})]})}):u.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center space-y-4",children:[u.jsx(fn,{className:"animate-spin text-neutral-400",size:32}),u.jsx("p",{className:"text-red-500 font-bold",children:"Error loading."}),u.jsx("button",{onClick:e,className:"text-xs underline text-neutral-500",children:"Return"})]});if((a||y)&&(j||!T.currentChallenge)){const A=u.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center p-8 text-center space-y-4",children:[u.jsx(fn,{className:"animate-spin text-neutral-400",size:32}),u.jsx("p",{className:"text-xs font-black text-neutral-500 uppercase tracking-widest",children:"Preparing..."})]});return o?u.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:u.jsx("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col h-[500px]",children:A})}):A}return u.jsx(R4,{isModal:o,word:n,onClose:e,isSetupMode:S,isPreparing:j,availableChallenges:_,selectedChallengeTypes:z,onToggleChallenge:R,onSetSelection:A=>{D(A),G(!1)},onStartTest:()=>L(),challenges:T.challenges,currentChallenge:T.currentChallenge,currentChallengeIndex:T.currentChallengeIndex,userAnswers:T.userAnswers,handleAnswerChange:T.setAnswer,results:T.results,isFinishing:T.isFinishing,currentPrepositionGroup:T.currentPrepositionGroup,isLastChallenge:T.isLastChallenge,handleNextClick:le,handleBackClick:T.handleBack,handleIgnore:T.handleIgnore,handleFinishEarly:B,showHint:H,onToggleHint:()=>W(!H),sessionPosition:l,challengeStats:Z,disableHints:p,onSelectQuick:O,onSelectPreferred:_e,onSelectZeroScore:_e,onSelectPartialScore:ye,isQuickMode:F,elapsedTime:se(T.elapsedSeconds),recapData:Q,onRecalculateFinish:()=>Q&&s(Q.finalGrade,Q.resultHistory,!1,Q.counts),isMastered:Y})},z1=n=>n.toLowerCase().replace(/[.,!?;:]/g,"").trim();function V4(n,e){const s=n.toLowerCase(),a=e.toLowerCase(),o=[];let l=0,d=0,p=0;const m=(s.length+a.length)*2+100;for(;(l<s.length||d<a.length)&&p<m;)if(p++,l<s.length&&d<a.length&&s[l]===a[d])o.push({char:s[l],status:"correct"}),l++,d++;else if(l<s.length&&(d>=a.length||s[l]!==a[d])){const y=a.indexOf(s[l],d);y!==-1&&y-d<3?(d=y,o.push({char:s[l],status:"correct"}),l++,d++):(o.push({char:s[l],status:"wrong"}),l++)}else d++;return o}function B1(n,e){const s=n.split(/\s+/).filter(Boolean),a=z1(e).split(/\s+/).filter(Boolean);let o=0,l=0;const d=s.map(m=>{const y=z1(m);o+=y.length;let x=-1;if(a.forEach((v,S)=>{x===-1&&v===y&&(x=S)}),x===-1&&a.forEach((v,S)=>{x===-1&&v.length>=2&&(v.startsWith(y.substring(0,2))||y.startsWith(v.substring(0,2)))&&(x=S)}),x!==-1){const v=a[x];a.splice(x,1);const S=V4(m,v),N=S.filter(D=>D.status==="correct").length;l+=N;const z=N===y.length?"correct":"near";return{word:m,status:z,chars:S}}return{word:m,status:"missing",chars:m.split("").map(v=>({char:v,status:"missing"}))}});return{score:o>0?Math.round(l/o*100):0,words:d}}const qd=3e3,AT=({target:n,onClose:e,onSaveScore:s})=>{const[a,o]=M.useState(!1),l=M.useRef(!1),[d,p]=M.useState(n||""),[m,y]=M.useState(!n),[x,v]=M.useState(""),[S,N]=M.useState(null),[z,D]=M.useState(null),[j,P]=M.useState(qd),[F,G]=M.useState(null),[H,W]=M.useState(!1),[Q,I]=M.useState(!1),T=M.useRef(new C0),_=M.useRef(null),C=M.useRef(Date.now()),{showToast:R}=ea();M.useEffect(()=>{if(a&&d&&x){const Y=B1(d,x);D(Y)}},[x,a,d]);const L=M.useCallback(async()=>{if(d){if(F){I(!Q);return}W(!0);try{const Y=d.trim().toLowerCase(),A=di().find(de=>de.word.toLowerCase()===Y);if(A&&A.ipaUs){G(A.ipaUs),I(!0),W(!1);return}const V=wt(),q=Bn(V),X=await fetch(`${q}/api/convert/ipa?text=${encodeURIComponent(d)}`);if(X.ok){const de=await X.json();G(de.ipa),I(!0)}else R("IPA server unavailable","error")}catch{R("Failed to fetch IPA","error")}finally{W(!1)}}},[d,F,Q,R]),O=M.useCallback(async Y=>{if(!d)return;_.current&&(clearInterval(_.current),_.current=null),T.current.stop();const A=await N0();A&&N(A),o(!1),l.current=!1;const V=B1(d,Y);D(V),s&&s(V.score)},[d,s]),_e=M.useCallback(()=>{C.current=Date.now(),P(qd)},[]),ye=M.useCallback(Y=>{_.current&&clearInterval(_.current),C.current=Date.now(),P(qd),_.current=setInterval(()=>{const V=Date.now()-C.current,q=Math.max(0,qd-V);P(q),q<=0&&l.current&&O(Y)},50)},[O]);M.useEffect(()=>()=>{_.current&&clearInterval(_.current),T.current.stop()},[]);const B=async()=>{if(d)if(m&&y(!1),a)await O(x);else{v(""),D(null),N(null);try{await I0(),o(!0),l.current=!0,_e(),ye(""),T.current.start((Y,A)=>{const V=Y+A;v(V),_e()},Y=>{l.current&&(v(Y),O(Y))})}catch(Y){console.error(Y),o(!1),l.current=!1}}},le=()=>{S&&new Audio(`data:${S.mimeType};base64,${S.base64}`).play()},se=()=>{if(!d)return;const Y=mu("vocab_pro_mimic_practice_queue",[]);if(Y.some(V=>V.text===d)){R("Already in Pronunciation Queue","info");return}const A={id:`quick-save-${Date.now()}`,text:d,sourceWord:d.length>30?d.substring(0,30)+"...":d,type:"Quick Practice"};Zg("vocab_pro_mimic_practice_queue",[...Y,A]),R("Saved to Pronunciation Page","success")},Z=Y=>{const A=Y.length;return A<40?"text-2xl md:text-3xl":A<80?"text-xl md:text-2xl":A<150?"text-lg md:text-xl":"text-base md:text-lg"};return u.jsx("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl border border-neutral-200 p-8 flex flex-col items-center gap-6 relative",children:[u.jsx("button",{onClick:e,className:"absolute top-6 right-6 p-2 text-neutral-300 hover:text-neutral-900 hover:bg-neutral-100 rounded-full transition-all",children:u.jsx(Rn,{size:20})}),u.jsxs("div",{className:"text-center space-y-1 mt-2",children:[u.jsx("span",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Mimic Practice"}),u.jsx("h3",{className:"text-xl font-bold text-neutral-900 leading-tight",children:"Practice Selected Phrase"})]}),u.jsxs("div",{className:"w-full p-6 bg-neutral-50 rounded-[2rem] border border-neutral-200 flex flex-col items-center gap-3 min-h-[120px] overflow-hidden relative group",children:[m?u.jsxs("div",{className:"w-full relative",children:[u.jsx("textarea",{value:d,onChange:Y=>p(Y.target.value),placeholder:"Enter text to practice...",className:"w-full h-32 p-4 bg-white border border-neutral-200 rounded-xl font-medium resize-none focus:ring-2 focus:ring-neutral-900 outline-none text-base leading-relaxed"}),u.jsx("button",{onClick:()=>y(!1),className:"absolute bottom-4 right-4 px-3 py-1.5 bg-neutral-900 text-white rounded-lg text-xs font-bold shadow-sm",children:"Done"})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>y(!0),className:"absolute top-4 right-4 p-2 text-neutral-400 hover:text-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity bg-white rounded-full shadow-sm",children:u.jsx(pI,{size:16})}),u.jsx("div",{className:"flex flex-wrap justify-center gap-x-1.5 gap-y-1 w-full",children:d.split(/\s+/).map((Y,A)=>{const V=z==null?void 0:z.words[A];let q="text-neutral-800";if(V)switch(V.status){case"correct":q="text-emerald-600";break;case"near":q="text-amber-500";break;case"wrong":q="text-rose-500";break;case"missing":q="text-neutral-300";break;default:q="text-neutral-800"}return u.jsx("span",{onClick:()=>ns(Y),className:`${Z(d)} font-bold cursor-pointer hover:underline decoration-neutral-200 transition-all leading-normal ${q}`,children:Y},A)})})]}),Q&&F&&!m&&u.jsx("div",{className:"px-4 py-1.5 bg-white border border-neutral-200 rounded-xl text-sm font-mono font-medium text-neutral-500 animate-in slide-in-from-top-2 duration-300",children:F})]}),u.jsxs("div",{className:"flex flex-col items-center gap-4 w-full",children:[a?u.jsxs("div",{className:"flex items-center gap-2 text-rose-500 animate-pulse",children:[u.jsx(pv,{size:20}),u.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Listening..."})]}):x&&u.jsxs("p",{className:"text-sm font-medium italic text-neutral-500 line-clamp-2",children:['"',x,'"']}),z&&u.jsxs("div",{className:"text-center animate-in zoom-in-95",children:[u.jsxs("div",{className:`text-4xl font-black ${z.score>80?"text-emerald-500":z.score>50?"text-amber-500":"text-rose-500"}`,children:[z.score,"%"]}),u.jsx("p",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest",children:"Accuracy"})]})]}),u.jsxs("div",{className:"flex items-center gap-4 pt-2",children:[u.jsx("button",{onClick:()=>ns(d),disabled:!d.trim(),className:"p-4 rounded-2xl bg-neutral-100 text-neutral-600 hover:text-neutral-900 transition-all",title:"Listen",children:u.jsx(wr,{size:24})}),u.jsx("button",{onClick:L,disabled:H,className:`p-4 rounded-2xl transition-all ${Q?"bg-indigo-600 text-white shadow-md":"bg-neutral-100 text-neutral-600 hover:text-indigo-600"}`,title:"Show Phonetic (IPA)",children:H?u.jsx(fn,{size:24,className:"animate-spin"}):u.jsx(H2,{size:24})}),u.jsx("button",{onClick:B,className:`w-20 h-20 rounded-full flex items-center justify-center shadow-lg transition-all transform active:scale-105 ${a?"bg-rose-600 text-white scale-110 shadow-rose-500/50 ring-8 ring-rose-500/10":"bg-white border-4 border-neutral-100 text-neutral-900 hover:scale-105"}`,title:"Record",children:a?j<=1e3?u.jsx("span",{className:"text-2xl font-black tabular-nums animate-in fade-in duration-300",children:(j/1e3).toFixed(1)}):u.jsx(pv,{size:28,className:"animate-pulse"}):u.jsx(To,{size:28})}),u.jsx("button",{onClick:le,disabled:!S||a,className:`p-4 rounded-2xl transition-all ${S&&!a?"bg-indigo-100 text-indigo-600 hover:text-indigo-900":"bg-neutral-50 text-neutral-300 cursor-not-allowed"}`,title:"Play recording",children:u.jsx(du,{size:24,fill:S&&!a?"currentColor":"none"})}),u.jsx("button",{onClick:se,disabled:!d.trim(),className:"p-4 rounded-2xl bg-neutral-100 text-neutral-600 hover:text-indigo-600 transition-all",title:"Save to Pronunciation Page",children:u.jsx(dI,{size:24})})]})]})})},z4=({word:n,onClose:e,onNavigateToWord:s,onEditRequest:a,onUpdate:o,onGainXp:l,isViewOnly:d=!1,initialTab:p="OVERVIEW"})=>{const[m,y]=M.useState(n),[x,v]=M.useState([]),[S,N]=M.useState({}),[z,D]=M.useState({}),[j,P]=M.useState(null),[F,G]=M.useState(new Set),[H,W]=M.useState(!1),[Q,I]=M.useState(!1);M.useEffect(()=>{y(n)},[n]),M.useEffect(()=>{(async()=>{if(!m)return;const Z=[],Y=m.wordFamily;Y&&Z.push(...(Y.nouns||[]).map(xe=>xe.word.toLowerCase().trim()),...(Y.verbs||[]).map(xe=>xe.word.toLowerCase().trim()),...(Y.adjs||[]).map(xe=>xe.word.toLowerCase().trim()),...(Y.advs||[]).map(xe=>xe.word.toLowerCase().trim()));const A=m.paraphrases;A&&Z.push(...A.map(xe=>xe.word.toLowerCase().trim()));const V=m.idiomsList;V&&Z.push(...V.map(xe=>xe.text.toLowerCase().trim()));const q=m.collocationsArray;q&&Z.push(...q.map(xe=>xe.text.toLowerCase().trim()));const X=[...new Set(Z.filter(Boolean))],de=new Set;for(const xe of X){if(!xe)continue;await qm(m.userId,xe)&&de.add(xe)}G(de);const ce=await yN(m.userId,m.id);v(ce);const fe=di(),ie={};(m.groups||[]).filter(xe=>xe.toLowerCase()!=="ielts").forEach(xe=>{const je=fe.filter(pe=>{var Ie;return pe.userId===m.userId&&pe.id!==m.id&&((Ie=pe.groups)==null?void 0:Ie.includes(xe))});je.length>0&&(ie[xe]=je)}),N(ie);const he={};(m.groups||[]).forEach(xe=>{const je=fe.filter(pe=>{var Ie;return pe.userId===m.userId&&pe.id!==m.id&&((Ie=pe.groups)==null?void 0:Ie.includes(xe))});je.length>0&&(he[xe]=je)}),D(he)})()},[m]);const T=async(se,Z="family")=>{if(!(!se.word||j||F.has(se.word.toLowerCase()))){P(se.word);try{const Y=`From ${Z} of "${m.word}"`,A=[...m.groups||[],`word-${Z}`],V={...$w(se.word,se.ipa||"",`Added from ${Z}`,"",Y,A),userId:m.userId};await Cf(V),G(q=>new Set(q).add(se.word.toLowerCase()))}finally{P(null)}}},_=async(se,Z,Y,A)=>{const V={...m};Z&&(V.lastTestResults={...V.lastTestResults||{},...Z}),V.masteryScore=Ns(V),await o(V),W(!1),y(V)},C=se=>{o(se),y(se)},[R,L]=M.useState(null),O=se=>{L(se)},_e=se=>{const Z=wt(),Y=Z.audioCoach.activeCoach,A=Z.audioCoach.coaches[Y].name;return R==="ESSAY"?Mk(m,se,A):Dk(m,se,A)},ye=se=>{const{result:Z}=se,Y=Z||se,A={...m,lesson:{...m.lesson||{}}};R==="ESSAY"?A.lesson.essay=Y.content:A.lesson.test=Y.content,C(A),L(null)},le=wt().audio.appliedAccent;return u.jsxs(u.Fragment,{children:[H&&u.jsx(P4,{word:m,onComplete:_,onClose:()=>W(!1)}),Q&&u.jsx(AT,{target:m.word,onClose:()=>I(!1)}),u.jsx(x4,{word:m,onClose:e,onChallengeRequest:()=>W(!0),onMimicRequest:()=>I(!0),onEditRequest:()=>a(m),onUpdate:C,linkedUnits:x,relatedWords:S,relatedByGroup:z,onNavigateToWord:s,onAddVariantToLibrary:T,addingVariant:j,existingVariants:F,appliedAccent:le,isViewOnly:d,initialTab:p,onGenerateLesson:O}),R&&u.jsx("div",{className:"z-[2000]",children:u.jsx("div",{className:"relative z-[500]",children:u.jsx(yg,{isOpen:!!R,onClose:()=>L(null),type:"GENERATE_WORD_LESSON",title:R==="ESSAY"?`Generate Usage Guide: ${m.word}`:`Generate Practice Test: ${m.word}`,description:R==="ESSAY"?"AI will create a structured usage guide with tables and examples.":"AI will design an interactive test for this word.",initialData:{},onGeneratePrompt:_e,onJsonReceived:ye,closeOnSuccess:!0})})})]})},bg=({isOpen:n,title:e,message:s,confirmText:a,isProcessing:o,onConfirm:l,onClose:d,confirmButtonClass:p="bg-red-600 text-white hover:bg-red-700 shadow-red-200",icon:m=u.jsx(kg,{size:40})})=>n?u.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsx("div",{className:"bg-white w-full max-w-sm rounded-[2.5rem] shadow-2xl border border-neutral-200 overflow-hidden animate-in zoom-in-95 duration-200",children:u.jsxs("div",{className:"p-8 text-center space-y-6",children:[u.jsx("div",{className:"mx-auto w-20 h-20 bg-neutral-50 text-neutral-500 rounded-full flex items-center justify-center border-4 border-white shadow-sm",children:m}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h3",{className:"text-2xl font-black text-neutral-900 leading-tight",children:e}),u.jsx("p",{className:"text-neutral-500 text-sm leading-relaxed",children:s})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsxs("button",{disabled:o,onClick:l,className:`w-full py-4 rounded-2xl font-black text-sm transition-all shadow-lg active:scale-95 flex items-center justify-center space-x-2 disabled:opacity-50 ${p}`,children:[o?u.jsx(fn,{size:18,className:"animate-spin"}):null,u.jsx("span",{children:o?"PROCESSING...":a})]}),u.jsx("button",{disabled:o,onClick:d,className:"w-full py-4 bg-neutral-100 text-neutral-500 rounded-2xl font-bold text-sm hover:bg-neutral-200 transition-all active:scale-95 disabled:opacity-50",children:"Cancel"})]})]})})}):null;var B4={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var F1;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(F1||(F1={}));var H1;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(H1||(H1={}));var G1;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(G1||(G1={}));var lo;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(lo||(lo={}));var q1;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(q1||(q1={}));var $1;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})($1||($1={}));var Y1;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Y1||(Y1={}));var Q1;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Q1||(Q1={}));var W1;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(W1||(W1={}));var K1;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(K1||(K1={}));var Z1;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(Z1||(Z1={}));var X1;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(X1||(X1={}));var J1;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(J1||(J1={}));var e_;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(e_||(e_={}));var t_;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(t_||(t_={}));var n_;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(n_||(n_={}));var s_;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(s_||(s_={}));var r_;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(r_||(r_={}));var a_;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(a_||(a_={}));var i_;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(i_||(i_={}));var o_;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(o_||(o_={}));var l_;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(l_||(l_={}));var c_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(c_||(c_={}));var u_;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(u_||(u_={}));var d_;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(d_||(d_={}));var f_;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(f_||(f_={}));var h_;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(h_||(h_={}));var p_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(p_||(p_={}));var m_;(function(n){n.COLLECTION="COLLECTION"})(m_||(m_={}));var g_;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(g_||(g_={}));var y_;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(y_||(y_={}));var x_;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(x_||(x_={}));var b_;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(b_||(b_={}));var v_;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(v_||(v_={}));var __;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(__||(__={}));var E_;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(E_||(E_={}));var w_;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(w_||(w_={}));var S_;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(S_||(S_={}));var T_;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(T_||(T_={}));var A_;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(A_||(A_={}));var I_;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(I_||(I_={}));var N_;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(N_||(N_={}));var C_;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING",n.DISTILLATION="DISTILLATION"})(C_||(C_={}));var R_;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(R_||(R_={}));var O_;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(O_||(O_={}));var j_;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED",n.REGISTERED="REGISTERED"})(j_||(j_={}));var k_;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(k_||(k_={}));var L_;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(L_||(L_={}));var M_;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(M_||(M_={}));var D_;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.ACTIVITY_START="ACTIVITY_START",n.ACTIVITY_END="ACTIVITY_END"})(D_||(D_={}));var U_;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(U_||(U_={}));var P_;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(P_||(P_={}));var V_;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(V_||(V_={}));var z_;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(z_||(z_={}));var B_;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(B_||(B_={}));var F_;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(F_||(F_={}));var H_;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(H_||(H_={}));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var G_;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(G_||(G_={}));function _f(n,e){var s={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&e.indexOf(a)<0&&(s[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(n);o<a.length;o++)e.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(n,a[o])&&(s[a[o]]=n[a[o]]);return s}function q_(n){var e=typeof Symbol=="function"&&Symbol.iterator,s=e&&n[e],a=0;if(s)return s.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&a>=n.length&&(n=void 0),{value:n&&n[a++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Jt(n){return this instanceof Jt?(this.v=n,this):new Jt(n)}function nu(n,e,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=s.apply(n,e||[]),o,l=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),p("next"),p("throw"),p("return",d),o[Symbol.asyncIterator]=function(){return this},o;function d(N){return function(z){return Promise.resolve(z).then(N,v)}}function p(N,z){a[N]&&(o[N]=function(D){return new Promise(function(j,P){l.push([N,D,j,P])>1||m(N,D)})},z&&(o[N]=z(o[N])))}function m(N,z){try{y(a[N](z))}catch(D){S(l[0][3],D)}}function y(N){N.value instanceof Jt?Promise.resolve(N.value.v).then(x,v):S(l[0][2],N)}function x(N){m("next",N)}function v(N){m("throw",N)}function S(N,z){N(z),l.shift(),l.length&&m(l[0][0],l[0][1])}}function Il(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],s;return e?e.call(n):(n=typeof q_=="function"?q_(n):n[Symbol.iterator](),s={},a("next"),a("throw"),a("return"),s[Symbol.asyncIterator]=function(){return this},s);function a(l){s[l]=n[l]&&function(d){return new Promise(function(p,m){d=n[l](d),o(p,m,d.done,d.value)})}}function o(l,d,p,m){Promise.resolve(m).then(function(y){l({value:y,done:p})},d)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let IT=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return IT=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),s=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(+a^s()&15>>+a/4).toString(16))};const F4=()=>IT();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vg(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const _g=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dr extends Error{}class ms extends dr{constructor(e,s,a,o){super(`${ms.makeMessage(e,s,a)}`),this.status=e,this.headers=o,this.error=s}static makeMessage(e,s,a){const o=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):a;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,s,a,o){if(!e||!o)return new Gf({message:a,cause:_g(s)});const l=s;return e===400?new CT(e,l,a,o):e===401?new RT(e,l,a,o):e===403?new OT(e,l,a,o):e===404?new jT(e,l,a,o):e===409?new kT(e,l,a,o):e===422?new LT(e,l,a,o):e===429?new MT(e,l,a,o):e>=500?new DT(e,l,a,o):new ms(e,l,a,o)}}class Eg extends ms{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Gf extends ms{constructor({message:e,cause:s}){super(void 0,void 0,e||"Connection error.",void 0),s&&(this.cause=s)}}class NT extends Gf{constructor({message:e}={}){super({message:e??"Request timed out."})}}class CT extends ms{}class RT extends ms{}class OT extends ms{}class jT extends ms{}class kT extends ms{}class LT extends ms{}class MT extends ms{}class DT extends ms{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const H4=/^[a-z][a-z0-9+.-]*:/i,G4=n=>H4.test(n);let wg=n=>(wg=Array.isArray,wg(n));const q4=wg;let $4=q4;const $_=$4;function Y4(n){if(!n)return!0;for(const e in n)return!1;return!0}function Q4(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const W4=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new dr(`${n} must be an integer`);if(e<0)throw new dr(`${n} must be a positive integer`);return e},K4=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Z4=n=>new Promise(e=>setTimeout(e,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xl="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function X4(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const J4=()=>{var n,e,s,a,o;const l=X4();if(l==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":xl,"X-Stainless-OS":Q_(Deno.build.os),"X-Stainless-Arch":Y_(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":xl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(l==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":xl,"X-Stainless-OS":Q_((s=globalThis.process.platform)!==null&&s!==void 0?s:"unknown"),"X-Stainless-Arch":Y_((a=globalThis.process.arch)!==null&&a!==void 0?a:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(o=globalThis.process.version)!==null&&o!==void 0?o:"unknown"};const d=eL();return d?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":xl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${d.browser}`,"X-Stainless-Runtime-Version":d.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":xl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function eL(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:s}of n){const a=s.exec(navigator.userAgent);if(a){const o=a[1]||0,l=a[2]||0,d=a[3]||0;return{browser:e,version:`${o}.${l}.${d}`}}}return null}const Y_=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",Q_=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let $d;const tL=()=>$d??($d=J4());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nL(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function UT(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function sL(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return UT({start(){},async pull(s){const{done:a,value:o}=await e.next();a?s.close():s.enqueue(o)},async cancel(){var s;await((s=e.return)===null||s===void 0?void 0:s.call(e))}})}function PT(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const s=await e.read();return s!=null&&s.done&&e.releaseLock(),s}catch(s){throw e.releaseLock(),s}},async return(){const s=e.cancel();return e.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function rL(n){var e,s;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((s=(e=n[Symbol.asyncIterator]()).return)===null||s===void 0?void 0:s.call(e));return}const a=n.getReader(),o=a.cancel();a.releaseLock(),await o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const aL=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const VT=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,s=typeof((n=e==null?void 0:e.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(s?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function dm(n,e,s){return VT(),new File(n,e??"unknown_file",s)}function iL(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const oL=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zT=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",lL=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&zT(n),cL=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function uL(n,e,s){if(VT(),n=await n,lL(n))return n instanceof File?n:dm([await n.arrayBuffer()],n.name);if(cL(n)){const o=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),dm(await Sg(o),e,s)}const a=await Sg(n);if(e||(e=iL(n)),!(s!=null&&s.type)){const o=a.find(l=>typeof l=="object"&&"type"in l&&l.type);typeof o=="string"&&(s=Object.assign(Object.assign({},s),{type:o}))}return dm(a,e,s)}async function Sg(n){var e,s,a,o,l;let d=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)d.push(n);else if(zT(n))d.push(n instanceof Blob?n:await n.arrayBuffer());else if(oL(n))try{for(var p=!0,m=Il(n),y;y=await m.next(),e=y.done,!e;p=!0){o=y.value,p=!1;const x=o;d.push(...await Sg(x))}}catch(x){s={error:x}}finally{try{!p&&!e&&(a=m.return)&&await a.call(m)}finally{if(s)throw s.error}}else{const x=(l=n==null?void 0:n.constructor)===null||l===void 0?void 0:l.name;throw new Error(`Unexpected data type: ${typeof n}${x?`; constructor: ${x}`:""}${dL(n)}`)}return d}function dL(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(s=>`"${s}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class BT{constructor(e){this._client=e}}BT._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FT(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const W_=Object.freeze(Object.create(null)),fL=(n=FT)=>(function(s,...a){if(s.length===1)return s[0];let o=!1;const l=[],d=s.reduce((x,v,S)=>{var N,z,D;/[?#]/.test(v)&&(o=!0);const j=a[S];let P=(o?encodeURIComponent:n)(""+j);return S!==a.length&&(j==null||typeof j=="object"&&j.toString===((D=Object.getPrototypeOf((z=Object.getPrototypeOf((N=j.hasOwnProperty)!==null&&N!==void 0?N:W_))!==null&&z!==void 0?z:W_))===null||D===void 0?void 0:D.toString))&&(P=j+"",l.push({start:x.length+v.length,length:P.length,error:`Value of type ${Object.prototype.toString.call(j).slice(8,-1)} is not a valid path parameter`})),x+v+(S===a.length?"":P)},""),p=d.split(/[?#]/,1)[0],m=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let y;for(;(y=m.exec(p))!==null;)l.push({start:y.index,length:y[0].length,error:`Value "${y[0]}" can't be safely passed as a path parameter`});if(l.sort((x,v)=>x.start-v.start),l.length>0){let x=0;const v=l.reduce((S,N)=>{const z=" ".repeat(N.start-x),D="^".repeat(N.length);return x=N.start+N.length,S+z+D},"");throw new dr(`Path parameters result in path with invalid segments:
${l.map(S=>S.error).join(`
`)}
${d}
${v}`)}return d}),Yd=fL(FT);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class HT extends BT{create(e,s){var a;const{api_version:o=this._client.apiVersion}=e,l=_f(e,["api_version"]);if("model"in l&&"agent_config"in l)throw new dr("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in l&&"generation_config"in l)throw new dr("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Yd`/${o}/interactions`,Object.assign(Object.assign({body:l},s),{stream:(a=e.stream)!==null&&a!==void 0?a:!1}))}delete(e,s={},a){const{api_version:o=this._client.apiVersion}=s??{};return this._client.delete(Yd`/${o}/interactions/${e}`,a)}cancel(e,s={},a){const{api_version:o=this._client.apiVersion}=s??{};return this._client.post(Yd`/${o}/interactions/${e}/cancel`,a)}get(e,s={},a){var o;const l=s??{},{api_version:d=this._client.apiVersion}=l,p=_f(l,["api_version"]);return this._client.get(Yd`/${d}/interactions/${e}`,Object.assign(Object.assign({query:p},a),{stream:(o=s==null?void 0:s.stream)!==null&&o!==void 0?o:!1}))}}HT._key=Object.freeze(["interactions"]);class GT extends HT{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hL(n){let e=0;for(const o of n)e+=o.length;const s=new Uint8Array(e);let a=0;for(const o of n)s.set(o,a),a+=o.length;return s}let Qd;function O0(n){let e;return(Qd??(e=new globalThis.TextEncoder,Qd=e.encode.bind(e)))(n)}let Wd;function K_(n){let e;return(Wd??(e=new globalThis.TextDecoder,Wd=e.decode.bind(e)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qf{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const s=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?O0(e):e;this.buffer=hL([this.buffer,s]);const a=[];let o;for(;(o=pL(this.buffer,this.carriageReturnIndex))!=null;){if(o.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=o.index;continue}if(this.carriageReturnIndex!=null&&(o.index!==this.carriageReturnIndex+1||o.carriage)){a.push(K_(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const l=this.carriageReturnIndex!==null?o.preceding-1:o.preceding,d=K_(this.buffer.subarray(0,l));a.push(d),this.buffer=this.buffer.subarray(o.index),this.carriageReturnIndex=null}return a}flush(){return this.buffer.length?this.decode(`
`):[]}}qf.NEWLINE_CHARS=new Set([`
`,"\r"]);qf.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function pL(n,e){for(let o=e??0;o<n.length;o++){if(n[o]===10)return{preceding:o,index:o+1,carriage:!1};if(n[o]===13)return{preceding:o,index:o+1,carriage:!0}}return null}function mL(n){for(let a=0;a<n.length-1;a++){if(n[a]===10&&n[a+1]===10||n[a]===13&&n[a+1]===13)return a+2;if(n[a]===13&&n[a+1]===10&&a+3<n.length&&n[a+2]===13&&n[a+3]===10)return a+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ef={off:0,error:200,warn:300,info:400,debug:500},Z_=(n,e,s)=>{if(n){if(Q4(Ef,n))return n;fs(s).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Ef))}`)}};function Gc(){}function Kd(n,e,s){return!e||Ef[n]>Ef[s]?Gc:e[n].bind(e)}const gL={error:Gc,warn:Gc,info:Gc,debug:Gc};let X_=new WeakMap;function fs(n){var e;const s=n.logger,a=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!s)return gL;const o=X_.get(s);if(o&&o[0]===a)return o[1];const l={error:Kd("error",s,a),warn:Kd("warn",s,a),info:Kd("info",s,a),debug:Kd("debug",s,a)};return X_.set(s,[a,l]),l}const io=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,s])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":s]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bl{constructor(e,s,a){this.iterator=e,this.controller=s,this.client=a}static fromSSEResponse(e,s,a){let o=!1;const l=a?fs(a):console;function d(){return nu(this,arguments,function*(){var m,y,x,v;if(o)throw new dr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let S=!1;try{try{for(var N=!0,z=Il(yL(e,s)),D;D=yield Jt(z.next()),m=D.done,!m;N=!0){v=D.value,N=!1;const j=v;if(!S)if(j.data.startsWith("[DONE]")){S=!0;continue}else try{yield yield Jt(JSON.parse(j.data))}catch(P){throw l.error("Could not parse message into JSON:",j.data),l.error("From chunk:",j.raw),P}}}catch(j){y={error:j}}finally{try{!N&&!m&&(x=z.return)&&(yield Jt(x.call(z)))}finally{if(y)throw y.error}}S=!0}catch(j){if(vg(j))return yield Jt(void 0);throw j}finally{S||s.abort()}})}return new bl(d,s,a)}static fromReadableStream(e,s,a){let o=!1;function l(){return nu(this,arguments,function*(){var m,y,x,v;const S=new qf,N=PT(e);try{for(var z=!0,D=Il(N),j;j=yield Jt(D.next()),m=j.done,!m;z=!0){v=j.value,z=!1;const P=v;for(const F of S.decode(P))yield yield Jt(F)}}catch(P){y={error:P}}finally{try{!z&&!m&&(x=D.return)&&(yield Jt(x.call(D)))}finally{if(y)throw y.error}}for(const P of S.flush())yield yield Jt(P)})}function d(){return nu(this,arguments,function*(){var m,y,x,v;if(o)throw new dr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let S=!1;try{try{for(var N=!0,z=Il(l()),D;D=yield Jt(z.next()),m=D.done,!m;N=!0){v=D.value,N=!1;const j=v;S||j&&(yield yield Jt(JSON.parse(j)))}}catch(j){y={error:j}}finally{try{!N&&!m&&(x=z.return)&&(yield Jt(x.call(z)))}finally{if(y)throw y.error}}S=!0}catch(j){if(vg(j))return yield Jt(void 0);throw j}finally{S||s.abort()}})}return new bl(d,s,a)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],s=[],a=this.iterator(),o=l=>({next:()=>{if(l.length===0){const d=a.next();e.push(d),s.push(d)}return l.shift()}});return[new bl(()=>o(e),this.controller,this.client),new bl(()=>o(s),this.controller,this.client)]}toReadableStream(){const e=this;let s;return UT({async start(){s=e[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:l}=await s.next();if(l)return a.close();const d=O0(JSON.stringify(o)+`
`);a.enqueue(d)}catch(o){a.error(o)}},async cancel(){var a;await((a=s.return)===null||a===void 0?void 0:a.call(s))}})}}function yL(n,e){return nu(this,arguments,function*(){var a,o,l,d;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new dr("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new dr("Attempted to iterate over a response with no body");const p=new bL,m=new qf,y=PT(n.body);try{for(var x=!0,v=Il(xL(y)),S;S=yield Jt(v.next()),a=S.done,!a;x=!0){d=S.value,x=!1;const N=d;for(const z of m.decode(N)){const D=p.decode(z);D&&(yield yield Jt(D))}}}catch(N){o={error:N}}finally{try{!x&&!a&&(l=v.return)&&(yield Jt(l.call(v)))}finally{if(o)throw o.error}}for(const N of m.flush()){const z=p.decode(N);z&&(yield yield Jt(z))}})}function xL(n){return nu(this,arguments,function*(){var s,a,o,l;let d=new Uint8Array;try{for(var p=!0,m=Il(n),y;y=yield Jt(m.next()),s=y.done,!s;p=!0){l=y.value,p=!1;const x=l;if(x==null)continue;const v=x instanceof ArrayBuffer?new Uint8Array(x):typeof x=="string"?O0(x):x;let S=new Uint8Array(d.length+v.length);S.set(d),S.set(v,d.length),d=S;let N;for(;(N=mL(d))!==-1;)yield yield Jt(d.slice(0,N)),d=d.slice(N)}}catch(x){a={error:x}}finally{try{!p&&!s&&(o=m.return)&&(yield Jt(o.call(m)))}finally{if(a)throw a.error}}d.length>0&&(yield yield Jt(d))})}class bL{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const l={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],l}if(this.chunks.push(e),e.startsWith(":"))return null;let[s,a,o]=vL(e,":");return o.startsWith(" ")&&(o=o.substring(1)),s==="event"?this.event=o:s==="data"&&this.data.push(o),null}}function vL(n,e){const s=n.indexOf(e);return s!==-1?[n.substring(0,s),e,n.substring(s+e.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function _L(n,e){const{response:s,requestLogID:a,retryOfRequestLogID:o,startTime:l}=e,d=await(async()=>{var p;if(e.options.stream)return fs(n).debug("response",s.status,s.url,s.headers,s.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(s,e.controller,n):bl.fromSSEResponse(s,e.controller,n);if(s.status===204)return null;if(e.options.__binaryResponse)return s;const m=s.headers.get("content-type"),y=(p=m==null?void 0:m.split(";")[0])===null||p===void 0?void 0:p.trim();return(y==null?void 0:y.includes("application/json"))||(y==null?void 0:y.endsWith("+json"))?s.headers.get("content-length")==="0"?void 0:await s.json():await s.text()})();return fs(n).debug(`[${a}] response parsed`,io({retryOfRequestLogID:o,url:s.url,status:s.status,body:d,durationMs:Date.now()-l})),d}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class j0 extends Promise{constructor(e,s,a=_L){super(o=>{o(null)}),this.responsePromise=s,this.parseResponse=a,this.client=e}_thenUnwrap(e){return new j0(this.client,this.responsePromise,async(s,a)=>e(await this.parseResponse(s,a),a))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:s}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,s){return this.parse().then(e,s)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qT=Symbol("brand.privateNullableHeaders");function*EL(n){if(!n)return;if(qT in n){const{values:a,nulls:o}=n;yield*a.entries();for(const l of o)yield[l,null];return}let e=!1,s;n instanceof Headers?s=n.entries():$_(n)?s=n:(e=!0,s=Object.entries(n??{}));for(let a of s){const o=a[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const l=$_(a[1])?a[1]:[a[1]];let d=!1;for(const p of l)p!==void 0&&(e&&!d&&(d=!0,yield[o,null]),yield[o,p])}}const Lc=n=>{const e=new Headers,s=new Set;for(const a of n){const o=new Set;for(const[l,d]of EL(a)){const p=l.toLowerCase();o.has(p)||(e.delete(l),o.add(p)),d===null?(e.delete(l),s.add(p)):(e.append(l,d),s.delete(p))}}return{[qT]:!0,values:e,nulls:s}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fm=n=>{var e,s,a,o,l,d;if(typeof globalThis.process<"u")return(a=(s=(e=B4)===null||e===void 0?void 0:e[n])===null||s===void 0?void 0:s.trim())!==null&&a!==void 0?a:void 0;if(typeof globalThis.Deno<"u")return(d=(l=(o=globalThis.Deno.env)===null||o===void 0?void 0:o.get)===null||l===void 0?void 0:l.call(o,n))===null||d===void 0?void 0:d.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $T;class $f{constructor(e){var s,a,o,l,d,p,m,{baseURL:y=fm("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:x=(s=fm("GEMINI_API_KEY"))!==null&&s!==void 0?s:null,apiVersion:v="v1beta"}=e,S=_f(e,["baseURL","apiKey","apiVersion"]);const N=Object.assign(Object.assign({apiKey:x,apiVersion:v},S),{baseURL:y||"https://generativelanguage.googleapis.com"});this.baseURL=N.baseURL,this.timeout=(a=N.timeout)!==null&&a!==void 0?a:$f.DEFAULT_TIMEOUT,this.logger=(o=N.logger)!==null&&o!==void 0?o:console;const z="warn";this.logLevel=z,this.logLevel=(d=(l=Z_(N.logLevel,"ClientOptions.logLevel",this))!==null&&l!==void 0?l:Z_(fm("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&d!==void 0?d:z,this.fetchOptions=N.fetchOptions,this.maxRetries=(p=N.maxRetries)!==null&&p!==void 0?p:2,this.fetch=(m=N.fetch)!==null&&m!==void 0?m:nL(),this.encoder=aL,this._options=N,this.apiKey=x,this.apiVersion=v,this.clientAdapter=N.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:s}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!s.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const s=Lc([e.headers]);if(!(s.values.has("authorization")||s.values.has("x-goog-api-key"))){if(this.apiKey)return Lc([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Lc([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([s,a])=>typeof a<"u").map(([s,a])=>{if(typeof a=="string"||typeof a=="number"||typeof a=="boolean")return`${encodeURIComponent(s)}=${encodeURIComponent(a)}`;if(a===null)return`${encodeURIComponent(s)}=`;throw new dr(`Cannot stringify type ${typeof a}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${xl}`}defaultIdempotencyKey(){return`stainless-node-retry-${F4()}`}makeStatusError(e,s,a,o){return ms.generate(e,s,a,o)}buildURL(e,s,a){const o=!this.baseURLOverridden()&&a||this.baseURL,l=G4(e)?new URL(e):new URL(o+(o.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),d=this.defaultQuery();return Y4(d)||(s=Object.assign(Object.assign({},d),s)),typeof s=="object"&&s&&!Array.isArray(s)&&(l.search=this.stringifyQuery(s)),l.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const s=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${s}`}}async prepareRequest(e,{url:s,options:a}){}get(e,s){return this.methodRequest("get",e,s)}post(e,s){return this.methodRequest("post",e,s)}patch(e,s){return this.methodRequest("patch",e,s)}put(e,s){return this.methodRequest("put",e,s)}delete(e,s){return this.methodRequest("delete",e,s)}methodRequest(e,s,a){return this.request(Promise.resolve(a).then(o=>Object.assign({method:e,path:s},o)))}request(e,s=null){return new j0(this,this.makeRequest(e,s,void 0))}async makeRequest(e,s,a){var o,l,d;const p=await e,m=(o=p.maxRetries)!==null&&o!==void 0?o:this.maxRetries;s==null&&(s=m),await this.prepareOptions(p);const{req:y,url:x,timeout:v}=await this.buildRequest(p,{retryCount:m-s});await this.prepareRequest(y,{url:x,options:p});const S="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),N=a===void 0?"":`, retryOf: ${a}`,z=Date.now();if(fs(this).debug(`[${S}] sending request`,io({retryOfRequestLogID:a,method:p.method,url:x,options:p,headers:y.headers})),!((l=p.signal)===null||l===void 0)&&l.aborted)throw new Eg;const D=new AbortController,j=await this.fetchWithTimeout(x,y,v,D).catch(_g),P=Date.now();if(j instanceof globalThis.Error){const G=`retrying, ${s} attempts remaining`;if(!((d=p.signal)===null||d===void 0)&&d.aborted)throw new Eg;const H=vg(j)||/timed? ?out/i.test(String(j)+("cause"in j?String(j.cause):""));if(s)return fs(this).info(`[${S}] connection ${H?"timed out":"failed"} - ${G}`),fs(this).debug(`[${S}] connection ${H?"timed out":"failed"} (${G})`,io({retryOfRequestLogID:a,url:x,durationMs:P-z,message:j.message})),this.retryRequest(p,s,a??S);throw fs(this).info(`[${S}] connection ${H?"timed out":"failed"} - error; no more retries left`),fs(this).debug(`[${S}] connection ${H?"timed out":"failed"} (error; no more retries left)`,io({retryOfRequestLogID:a,url:x,durationMs:P-z,message:j.message})),H?new NT:new Gf({cause:j})}const F=`[${S}${N}] ${y.method} ${x} ${j.ok?"succeeded":"failed"} with status ${j.status} in ${P-z}ms`;if(!j.ok){const G=await this.shouldRetry(j);if(s&&G){const _=`retrying, ${s} attempts remaining`;return await rL(j.body),fs(this).info(`${F} - ${_}`),fs(this).debug(`[${S}] response error (${_})`,io({retryOfRequestLogID:a,url:j.url,status:j.status,headers:j.headers,durationMs:P-z})),this.retryRequest(p,s,a??S,j.headers)}const H=G?"error; no more retries left":"error; not retryable";fs(this).info(`${F} - ${H}`);const W=await j.text().catch(_=>_g(_).message),Q=K4(W),I=Q?void 0:W;throw fs(this).debug(`[${S}] response error (${H})`,io({retryOfRequestLogID:a,url:j.url,status:j.status,headers:j.headers,message:I,durationMs:Date.now()-z})),this.makeStatusError(j.status,Q,I,j.headers)}return fs(this).info(F),fs(this).debug(`[${S}] response start`,io({retryOfRequestLogID:a,url:j.url,status:j.status,headers:j.headers,durationMs:P-z})),{response:j,options:p,controller:D,requestLogID:S,retryOfRequestLogID:a,startTime:z}}async fetchWithTimeout(e,s,a,o){const l=s||{},{signal:d,method:p}=l,m=_f(l,["signal","method"]),y=this._makeAbort(o);d&&d.addEventListener("abort",y,{once:!0});const x=setTimeout(y,a),v=globalThis.ReadableStream&&m.body instanceof globalThis.ReadableStream||typeof m.body=="object"&&m.body!==null&&Symbol.asyncIterator in m.body,S=Object.assign(Object.assign(Object.assign({signal:o.signal},v?{duplex:"half"}:{}),{method:"GET"}),m);p&&(S.method=p.toUpperCase());try{return await this.fetch.call(void 0,e,S)}finally{clearTimeout(x)}}async shouldRetry(e){const s=e.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,s,a,o){var l;let d;const p=o==null?void 0:o.get("retry-after-ms");if(p){const y=parseFloat(p);Number.isNaN(y)||(d=y)}const m=o==null?void 0:o.get("retry-after");if(m&&!d){const y=parseFloat(m);Number.isNaN(y)?d=Date.parse(m)-Date.now():d=y*1e3}if(!(d&&0<=d&&d<60*1e3)){const y=(l=e.maxRetries)!==null&&l!==void 0?l:this.maxRetries;d=this.calculateDefaultRetryTimeoutMillis(s,y)}return await Z4(d),this.makeRequest(e,s-1,a)}calculateDefaultRetryTimeoutMillis(e,s){const l=s-e,d=Math.min(.5*Math.pow(2,l),8),p=1-Math.random()*.25;return d*p*1e3}async buildRequest(e,{retryCount:s=0}={}){var a,o,l;const d=Object.assign({},e),{method:p,path:m,query:y,defaultBaseURL:x}=d,v=this.buildURL(m,y,x);"timeout"in d&&W4("timeout",d.timeout),d.timeout=(a=d.timeout)!==null&&a!==void 0?a:this.timeout;const{bodyHeaders:S,body:N}=this.buildBody({options:d}),z=await this.buildHeaders({options:e,method:p,bodyHeaders:S,retryCount:s});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:p,headers:z},d.signal&&{signal:d.signal}),globalThis.ReadableStream&&N instanceof globalThis.ReadableStream&&{duplex:"half"}),N&&{body:N}),(o=this.fetchOptions)!==null&&o!==void 0?o:{}),(l=d.fetchOptions)!==null&&l!==void 0?l:{}),url:v,timeout:d.timeout}}async buildHeaders({options:e,method:s,bodyHeaders:a,retryCount:o}){let l={};this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const d=await this.authHeaders(e);let p=Lc([l,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),tL()),this._options.defaultHeaders,a,e.headers,d]);return this.validateHeaders(p),p.values}_makeAbort(e){return()=>e.abort()}buildBody({options:{body:e,headers:s}}){if(!e)return{bodyHeaders:void 0,body:void 0};const a=Lc([s]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&a.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:sL(e)}:this.encoder({body:e,headers:a})}}$f.DEFAULT_TIMEOUT=6e4;class Zn extends $f{constructor(){super(...arguments),this.interactions=new GT(this)}}$T=Zn;Zn.GeminiNextGenAPIClient=$T;Zn.GeminiNextGenAPIClientError=dr;Zn.APIError=ms;Zn.APIConnectionError=Gf;Zn.APIConnectionTimeoutError=NT;Zn.APIUserAbortError=Eg;Zn.NotFoundError=jT;Zn.ConflictError=kT;Zn.RateLimitError=MT;Zn.BadRequestError=CT;Zn.AuthenticationError=RT;Zn.InternalServerError=DT;Zn.PermissionDeniedError=OT;Zn.UnprocessableEntityError=LT;Zn.toFile=uL;Zn.Interactions=GT;class wL extends Error{constructor(e,s){super(e),this.name="ManualApiResponseError",this.prompt=s}}const SL=()=>{throw new Error("API_KEY_MISSING")},TL=n=>new Promise(e=>setTimeout(e,n));function AL(n){let e=n.trim();const s=e.indexOf("```json");if(s!==-1){const x=s+7,v=e.lastIndexOf("```");if(v>x)return e.substring(x,v).trim()}const a=e.indexOf("```");if(a!==-1){const x=a+3,v=e.lastIndexOf("```");if(v>x)return e.substring(x,v).trim()}const o=e.indexOf("{"),l=e.indexOf("[");let d=-1;if(o===-1?d=l:l===-1?d=o:d=Math.min(o,l),d===-1)return e;const p=e.lastIndexOf("}"),m=e.lastIndexOf("]"),y=Math.max(p,m);return y>d?e.substring(d,y+1):e}function IL(n,e){if(!n)return e;const s=AL(n);if(!s)return e;try{return JSON.parse(s)}catch(a){if(/[\u201C\u201D]/.test(s)){const d=s.replace(/"/g,'\\"').replace(/[\u201C\u201D]/g,'"');try{return JSON.parse(d)}catch{}}const o=s.replace(/[\u201C\u201D]/g,'"');try{return JSON.parse(o)}catch{}const l=o.replace(/,\s*([}\]])/g,"$1");try{return JSON.parse(l)}catch{if(/[\u201C\u201D]/.test(s)){const p=s.replace(/"/g,'\\"').replace(/[\u201C\u201D]/g,'"').replace(/,\s*([}\]])/g,"$1");try{return JSON.parse(p)}catch{}}return console.error("JSON Parse Failed:",a),e}}}const NL=()=>{const n=new Date().toISOString().split("T")[0];let e=mu("vocab_pro_api_usage",{count:0,date:"1970-01-01"});e.date!==n&&(e={count:0,date:n}),e.count+=1,Zg("vocab_pro_api_usage",e),window.dispatchEvent(new CustomEvent("apiUsageUpdated"))};async function YT(n,e=3){var a;NL();let s;for(let o=0;o<=e;o++)try{return await SL().models.generateContent(n)}catch(l){s=l;const d=((a=l.message)==null?void 0:a.toLowerCase())||"";if(d.includes("api_key_missing"))throw l;if(d.includes("429")||d.includes("quota")||d.includes("exhausted")||d.includes("503")){if(o<e){await TL(Math.pow(2,o)*1e3);continue}throw new wL("API quota exceeded.",n.contents)}throw l}throw s}async function nM(n){const e=wt(),s=kk(n),a=await YT({model:e.ai.modelForBasicTasks,contents:s,config:{responseMimeType:"application/json",responseSchema:{type:lo.ARRAY,items:{type:lo.OBJECT,properties:{v1:{type:lo.STRING},v2:{type:lo.STRING},v3:{type:lo.STRING}},required:["v1","v2","v3"]}}}});return IL(a.text,[])}async function CL(n,e){wt();const s=Uk();return(await YT({model:"gemini-2.5-flash-image",contents:{parts:[{inlineData:{mimeType:e,data:n}},{text:s}]}})).text||"No text detected."}var hm={exports:{}},J_;function RL(){return J_||(J_=1,(function(n){var e=(function(s){var a=Object.prototype,o=a.hasOwnProperty,l=Object.defineProperty||function(Z,Y,A){Z[Y]=A.value},d,p=typeof Symbol=="function"?Symbol:{},m=p.iterator||"@@iterator",y=p.asyncIterator||"@@asyncIterator",x=p.toStringTag||"@@toStringTag";function v(Z,Y,A){return Object.defineProperty(Z,Y,{value:A,enumerable:!0,configurable:!0,writable:!0}),Z[Y]}try{v({},"")}catch{v=function(Y,A,V){return Y[A]=V}}function S(Z,Y,A,V){var q=Y&&Y.prototype instanceof G?Y:G,X=Object.create(q.prototype),de=new B(V||[]);return l(X,"_invoke",{value:L(Z,A,de)}),X}s.wrap=S;function N(Z,Y,A){try{return{type:"normal",arg:Z.call(Y,A)}}catch(V){return{type:"throw",arg:V}}}var z="suspendedStart",D="suspendedYield",j="executing",P="completed",F={};function G(){}function H(){}function W(){}var Q={};v(Q,m,function(){return this});var I=Object.getPrototypeOf,T=I&&I(I(le([])));T&&T!==a&&o.call(T,m)&&(Q=T);var _=W.prototype=G.prototype=Object.create(Q);H.prototype=W,l(_,"constructor",{value:W,configurable:!0}),l(W,"constructor",{value:H,configurable:!0}),H.displayName=v(W,x,"GeneratorFunction");function C(Z){["next","throw","return"].forEach(function(Y){v(Z,Y,function(A){return this._invoke(Y,A)})})}s.isGeneratorFunction=function(Z){var Y=typeof Z=="function"&&Z.constructor;return Y?Y===H||(Y.displayName||Y.name)==="GeneratorFunction":!1},s.mark=function(Z){return Object.setPrototypeOf?Object.setPrototypeOf(Z,W):(Z.__proto__=W,v(Z,x,"GeneratorFunction")),Z.prototype=Object.create(_),Z},s.awrap=function(Z){return{__await:Z}};function R(Z,Y){function A(X,de,ce,fe){var ie=N(Z[X],Z,de);if(ie.type==="throw")fe(ie.arg);else{var Ae=ie.arg,he=Ae.value;return he&&typeof he=="object"&&o.call(he,"__await")?Y.resolve(he.__await).then(function(xe){A("next",xe,ce,fe)},function(xe){A("throw",xe,ce,fe)}):Y.resolve(he).then(function(xe){Ae.value=xe,ce(Ae)},function(xe){return A("throw",xe,ce,fe)})}}var V;function q(X,de){function ce(){return new Y(function(fe,ie){A(X,de,fe,ie)})}return V=V?V.then(ce,ce):ce()}l(this,"_invoke",{value:q})}C(R.prototype),v(R.prototype,y,function(){return this}),s.AsyncIterator=R,s.async=function(Z,Y,A,V,q){q===void 0&&(q=Promise);var X=new R(S(Z,Y,A,V),q);return s.isGeneratorFunction(Y)?X:X.next().then(function(de){return de.done?de.value:X.next()})};function L(Z,Y,A){var V=z;return function(X,de){if(V===j)throw new Error("Generator is already running");if(V===P){if(X==="throw")throw de;return se()}for(A.method=X,A.arg=de;;){var ce=A.delegate;if(ce){var fe=O(ce,A);if(fe){if(fe===F)continue;return fe}}if(A.method==="next")A.sent=A._sent=A.arg;else if(A.method==="throw"){if(V===z)throw V=P,A.arg;A.dispatchException(A.arg)}else A.method==="return"&&A.abrupt("return",A.arg);V=j;var ie=N(Z,Y,A);if(ie.type==="normal"){if(V=A.done?P:D,ie.arg===F)continue;return{value:ie.arg,done:A.done}}else ie.type==="throw"&&(V=P,A.method="throw",A.arg=ie.arg)}}}function O(Z,Y){var A=Y.method,V=Z.iterator[A];if(V===d)return Y.delegate=null,A==="throw"&&Z.iterator.return&&(Y.method="return",Y.arg=d,O(Z,Y),Y.method==="throw")||A!=="return"&&(Y.method="throw",Y.arg=new TypeError("The iterator does not provide a '"+A+"' method")),F;var q=N(V,Z.iterator,Y.arg);if(q.type==="throw")return Y.method="throw",Y.arg=q.arg,Y.delegate=null,F;var X=q.arg;if(!X)return Y.method="throw",Y.arg=new TypeError("iterator result is not an object"),Y.delegate=null,F;if(X.done)Y[Z.resultName]=X.value,Y.next=Z.nextLoc,Y.method!=="return"&&(Y.method="next",Y.arg=d);else return X;return Y.delegate=null,F}C(_),v(_,x,"Generator"),v(_,m,function(){return this}),v(_,"toString",function(){return"[object Generator]"});function _e(Z){var Y={tryLoc:Z[0]};1 in Z&&(Y.catchLoc=Z[1]),2 in Z&&(Y.finallyLoc=Z[2],Y.afterLoc=Z[3]),this.tryEntries.push(Y)}function ye(Z){var Y=Z.completion||{};Y.type="normal",delete Y.arg,Z.completion=Y}function B(Z){this.tryEntries=[{tryLoc:"root"}],Z.forEach(_e,this),this.reset(!0)}s.keys=function(Z){var Y=Object(Z),A=[];for(var V in Y)A.push(V);return A.reverse(),function q(){for(;A.length;){var X=A.pop();if(X in Y)return q.value=X,q.done=!1,q}return q.done=!0,q}};function le(Z){if(Z){var Y=Z[m];if(Y)return Y.call(Z);if(typeof Z.next=="function")return Z;if(!isNaN(Z.length)){var A=-1,V=function q(){for(;++A<Z.length;)if(o.call(Z,A))return q.value=Z[A],q.done=!1,q;return q.value=d,q.done=!0,q};return V.next=V}}return{next:se}}s.values=le;function se(){return{value:d,done:!0}}return B.prototype={constructor:B,reset:function(Z){if(this.prev=0,this.next=0,this.sent=this._sent=d,this.done=!1,this.delegate=null,this.method="next",this.arg=d,this.tryEntries.forEach(ye),!Z)for(var Y in this)Y.charAt(0)==="t"&&o.call(this,Y)&&!isNaN(+Y.slice(1))&&(this[Y]=d)},stop:function(){this.done=!0;var Z=this.tryEntries[0],Y=Z.completion;if(Y.type==="throw")throw Y.arg;return this.rval},dispatchException:function(Z){if(this.done)throw Z;var Y=this;function A(fe,ie){return X.type="throw",X.arg=Z,Y.next=fe,ie&&(Y.method="next",Y.arg=d),!!ie}for(var V=this.tryEntries.length-1;V>=0;--V){var q=this.tryEntries[V],X=q.completion;if(q.tryLoc==="root")return A("end");if(q.tryLoc<=this.prev){var de=o.call(q,"catchLoc"),ce=o.call(q,"finallyLoc");if(de&&ce){if(this.prev<q.catchLoc)return A(q.catchLoc,!0);if(this.prev<q.finallyLoc)return A(q.finallyLoc)}else if(de){if(this.prev<q.catchLoc)return A(q.catchLoc,!0)}else if(ce){if(this.prev<q.finallyLoc)return A(q.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(Z,Y){for(var A=this.tryEntries.length-1;A>=0;--A){var V=this.tryEntries[A];if(V.tryLoc<=this.prev&&o.call(V,"finallyLoc")&&this.prev<V.finallyLoc){var q=V;break}}q&&(Z==="break"||Z==="continue")&&q.tryLoc<=Y&&Y<=q.finallyLoc&&(q=null);var X=q?q.completion:{};return X.type=Z,X.arg=Y,q?(this.method="next",this.next=q.finallyLoc,F):this.complete(X)},complete:function(Z,Y){if(Z.type==="throw")throw Z.arg;return Z.type==="break"||Z.type==="continue"?this.next=Z.arg:Z.type==="return"?(this.rval=this.arg=Z.arg,this.method="return",this.next="end"):Z.type==="normal"&&Y&&(this.next=Y),F},finish:function(Z){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var A=this.tryEntries[Y];if(A.finallyLoc===Z)return this.complete(A.completion,A.afterLoc),ye(A),F}},catch:function(Z){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var A=this.tryEntries[Y];if(A.tryLoc===Z){var V=A.completion;if(V.type==="throw"){var q=V.arg;ye(A)}return q}}throw new Error("illegal catch attempt")},delegateYield:function(Z,Y,A){return this.delegate={iterator:le(Z),resultName:Y,nextLoc:A},this.method==="next"&&(this.arg=d),F}},s})(n.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(hm)),hm.exports}var pm,eE;function k0(){return eE||(eE=1,pm=(n,e)=>`${n}-${e}-${Math.random().toString(16).slice(3,8)}`),pm}var mm,tE;function QT(){if(tE)return mm;tE=1;const n=k0();let e=0;return mm=({id:s,action:a,payload:o={}})=>{let l=s;return typeof l>"u"&&(l=n("Job",e),e+=1),{id:l,action:a,payload:o}},mm}var Mc={},nE;function L0(){if(nE)return Mc;nE=1;let n=!1;return Mc.logging=n,Mc.setLogging=e=>{n=e},Mc.log=(...e)=>n?console.log.apply(this,e):null,Mc}var gm,sE;function OL(){if(sE)return gm;sE=1;const n=QT(),{log:e}=L0(),s=k0();let a=0;return gm=()=>{const o=s("Scheduler",a),l={},d={};let p=[];a+=1;const m=()=>p.length,y=()=>Object.keys(l).length,x=()=>{if(p.length!==0){const D=Object.keys(l);for(let j=0;j<D.length;j+=1)if(typeof d[D[j]]>"u"){p[0](l[D[j]]);break}}},v=(D,j)=>new Promise((P,F)=>{const G=n({action:D,payload:j});p.push(async H=>{p.shift(),d[H.id]=G;try{P(await H[D].apply(this,[...j,G.id]))}catch(W){F(W)}finally{delete d[H.id],x()}}),e(`[${o}]: Add ${G.id} to JobQueue`),e(`[${o}]: JobQueue length=${p.length}`),x()});return{addWorker:D=>(l[D.id]=D,e(`[${o}]: Add ${D.id}`),e(`[${o}]: Number of workers=${y()}`),x(),D.id),addJob:async(D,...j)=>{if(y()===0)throw Error(`[${o}]: You need to have at least one worker before adding jobs`);return v(D,j)},terminate:async()=>{Object.keys(l).forEach(async D=>{await l[D].terminate()}),p=[]},getQueueLen:m,getNumWorkers:y}},gm}function jL(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ym,rE;function kL(){if(rE)return ym;rE=1;function n(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}return ym=n,ym}var xm,aE;function LL(){if(aE)return xm;aE=1;const n=kL();return xm=e=>{const s={};return typeof WorkerGlobalScope<"u"?s.type="webworker":n()?s.type="electron":typeof document=="object"?s.type="browser":typeof process=="object"&&typeof jL=="function"&&(s.type="node"),typeof e>"u"?s:s[e]},xm}var bm,iE;function ML(){if(iE)return bm;iE=1;const e=LL()("type")==="browser"?s=>new URL(s,window.location.href).href:s=>s;return bm=s=>{const a={...s};return["corePath","workerPath","langPath"].forEach(o=>{s[o]&&(a[o]=e(a[o]))}),a},bm}var vm,oE;function DL(){return oE||(oE=1,vm=n=>{const e=[],s=[],a=[],o=[],l=[];return n.blocks&&n.blocks.forEach(d=>{d.paragraphs.forEach(p=>{p.lines.forEach(m=>{m.words.forEach(y=>{y.symbols.forEach(x=>{l.push({...x,page:n,block:d,paragraph:p,line:m,word:y})}),o.push({...y,page:n,block:d,paragraph:p,line:m})}),a.push({...m,page:n,block:d,paragraph:p})}),s.push({...p,page:n,block:d})}),e.push({...d,page:n})}),{...n,blocks:e,paragraphs:s,lines:a,words:o,symbols:l}}),vm}var _m,lE;function WT(){return lE||(lE=1,_m={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),_m}const UL="5.1.1",PL={version:UL};var Em,cE;function VL(){return cE||(cE=1,Em={workerBlobURL:!0,logger:()=>{}}),Em}var wm,uE;function zL(){if(uE)return wm;uE=1;const n=PL.version;return wm={...VL(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${n}/dist/worker.min.js`},wm}var Sm,dE;function BL(){return dE||(dE=1,Sm=({workerPath:n,workerBlobURL:e})=>{let s;if(Blob&&URL&&e){const a=new Blob([`importScripts("${n}");`],{type:"application/javascript"});s=new Worker(URL.createObjectURL(a))}else s=new Worker(n);return s}),Sm}var Tm,fE;function FL(){return fE||(fE=1,Tm=n=>{n.terminate()}),Tm}var Am,hE;function HL(){return hE||(hE=1,Am=(n,e)=>{n.onmessage=({data:s})=>{e(s)}}),Am}var Im,pE;function GL(){return pE||(pE=1,Im=async(n,e)=>{n.postMessage(e)}),Im}var Nm,mE;function qL(){if(mE)return Nm;mE=1;const n=s=>new Promise((a,o)=>{const l=new FileReader;l.onload=()=>{a(l.result)},l.onerror=({target:{error:{code:d}}})=>{o(Error(`File could not be read! Code=${d}`))},l.readAsArrayBuffer(s)}),e=async s=>{let a=s;if(typeof s>"u")return"undefined";if(typeof s=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(s)?a=atob(s.split(",")[1]).split("").map(o=>o.charCodeAt(0)):a=await(await fetch(s)).arrayBuffer();else if(typeof HTMLElement<"u"&&s instanceof HTMLElement)s.tagName==="IMG"&&(a=await e(s.src)),s.tagName==="VIDEO"&&(a=await e(s.poster)),s.tagName==="CANVAS"&&await new Promise(o=>{s.toBlob(async l=>{a=await n(l),o()})});else if(typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas){const o=await s.convertToBlob();a=await n(o)}else(s instanceof File||s instanceof Blob)&&(a=await n(s));return new Uint8Array(a)};return Nm=e,Nm}var Cm,gE;function $L(){if(gE)return Cm;gE=1;const n=zL(),e=BL(),s=FL(),a=HL(),o=GL(),l=qL();return Cm={defaultOptions:n,spawnWorker:e,terminateWorker:s,onMessage:a,send:o,loadImage:l},Cm}var Rm,yE;function KT(){if(yE)return Rm;yE=1;const n=ML(),e=DL(),s=QT(),{log:a}=L0(),o=k0(),l=WT(),{defaultOptions:d,spawnWorker:p,terminateWorker:m,onMessage:y,loadImage:x,send:v}=$L();let S=0;return Rm=async(N="eng",z=l.LSTM_ONLY,D={},j={})=>{const P=o("Worker",S),{logger:F,errorHandler:G,...H}=n({...d,...D}),W={},Q={},I=typeof N=="string"?N.split("+"):N;let T=z,_=j;const C=[l.DEFAULT,l.LSTM_ONLY].includes(z)&&!H.legacyCore;let R,L;const O=new Promise((Te,me)=>{L=Te,R=me}),_e=Te=>{R(Te.message)};let ye=p(H);ye.onerror=_e,S+=1;const B=(Te,me)=>{W[Te]=me},le=(Te,me)=>{Q[Te]=me},se=({id:Te,action:me,payload:et})=>new Promise((Xe,re)=>{a(`[${P}]: Start ${Te}, action=${me}`);const Fe=`${me}-${Te}`;B(Fe,Xe),le(Fe,re),v(ye,{workerId:P,jobId:Te,action:me,payload:et})}),Z=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),Y=Te=>se(s({id:Te,action:"load",payload:{options:{lstmOnly:C,corePath:H.corePath,logging:H.logging}}})),A=(Te,me,et)=>se(s({id:et,action:"FS",payload:{method:"writeFile",args:[Te,me]}})),V=(Te,me)=>se(s({id:me,action:"FS",payload:{method:"readFile",args:[Te,{encoding:"utf8"}]}})),q=(Te,me)=>se(s({id:me,action:"FS",payload:{method:"unlink",args:[Te]}})),X=(Te,me,et)=>se(s({id:et,action:"FS",payload:{method:Te,args:me}})),de=()=>console.warn("`loadLanguage` is depreciated and should be removed from code (workers now come with language pre-loaded)"),ce=(Te,me)=>se(s({id:me,action:"loadLanguage",payload:{langs:Te,options:{langPath:H.langPath,dataPath:H.dataPath,cachePath:H.cachePath,cacheMethod:H.cacheMethod,gzip:H.gzip,lstmOnly:[l.DEFAULT,l.LSTM_ONLY].includes(T)&&!H.legacyLang}}})),fe=()=>console.warn("`initialize` is depreciated and should be removed from code (workers now come pre-initialized)"),ie=(Te,me,et,Xe)=>se(s({id:Xe,action:"initialize",payload:{langs:Te,oem:me,config:et}})),Ae=(Te="eng",me,et,Xe)=>{if(C&&[l.TESSERACT_ONLY,l.TESSERACT_LSTM_COMBINED].includes(me))throw Error("Legacy model requested but code missing.");const re=me||T;T=re;const Fe=et||_;_=Fe;const Tt=(typeof Te=="string"?Te.split("+"):Te).filter(Ze=>!I.includes(Ze));return I.push(...Tt),Tt.length>0?ce(Tt,Xe).then(()=>ie(Te,re,Fe,Xe)):ie(Te,re,Fe,Xe)},he=(Te={},me)=>se(s({id:me,action:"setParameters",payload:{params:Te}})),xe=async(Te,me={},et={blocks:!0,text:!0,hocr:!0,tsv:!0},Xe)=>se(s({id:Xe,action:"recognize",payload:{image:await x(Te),options:me,output:et}})),je=(Te="Tesseract OCR Result",me=!1,et)=>(console.log("`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead."),se(s({id:et,action:"getPDF",payload:{title:Te,textonly:me}}))),pe=async(Te,me)=>{if(C)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return se(s({id:me,action:"detect",payload:{image:await x(Te)}}))},Ie=async()=>(ye!==null&&(m(ye),ye=null),Promise.resolve());y(ye,({workerId:Te,jobId:me,status:et,action:Xe,data:re})=>{const Fe=`${Xe}-${me}`;if(et==="resolve"){a(`[${Te}]: Complete ${me}`);let rt=re;Xe==="recognize"?rt=e(re):Xe==="getPDF"&&(rt=Array.from({...re,length:Object.keys(re).length})),W[Fe]({jobId:me,data:rt})}else if(et==="reject")if(Q[Fe](re),Xe==="load"&&R(re),G)G(re);else throw Error(re);else et==="progress"&&F({...re,userJobId:me})});const Le={id:P,worker:ye,setResolve:B,setReject:le,load:Z,writeText:A,readText:V,removeFile:q,FS:X,loadLanguage:de,initialize:fe,reinitialize:Ae,setParameters:he,recognize:xe,getPDF:je,detect:pe,terminate:Ie};return Y().then(()=>ce(N)).then(()=>ie(N,z,j)).then(()=>L(Le)).catch(()=>{}),O},Rm}var Om,xE;function YL(){if(xE)return Om;xE=1;const n=KT();return Om={recognize:async(a,o,l)=>{const d=await n(o,1,l);return d.recognize(a).finally(async()=>{await d.terminate()})},detect:async(a,o)=>{const l=await n("osd",0,o);return l.detect(a).finally(async()=>{await l.terminate()})}},Om}var jm,bE;function QL(){return bE||(bE=1,jm={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),jm}var km,vE;function WL(){return vE||(vE=1,km={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),km}var Lm,_E;function KL(){if(_E)return Lm;_E=1,RL();const n=OL(),e=KT(),s=YL(),a=QL(),o=WT(),l=WL(),{setLogging:d}=L0();return Lm={languages:a,OEM:o,PSM:l,createScheduler:n,createWorker:e,setLogging:d,...s},Lm}var ZL=KL();async function EE(n){const e=await ZL.createWorker("eng");try{const s=await e.recognize(n);return await e.terminate(),s.data.text}catch(s){throw await e.terminate(),s}}const XL=()=>{const[n,e]=M.useState(null),[s,a]=M.useState(""),[o,l]=M.useState(!1),[d,p]=M.useState(!1),[m,y]=M.useState(!1),[x,v]=M.useState("cloud"),S=M.useRef(null),{showToast:N}=ea();Fn.useEffect(()=>{const F=G=>{var W;const H=(W=G.clipboardData)==null?void 0:W.items;if(H){for(let Q=0;Q<H.length;Q++)if(H[Q].type.indexOf("image")!==-1){const I=H[Q].getAsFile();I&&z(I);break}}};return document.addEventListener("paste",F),()=>document.removeEventListener("paste",F)},[]);const z=F=>{const G=new FileReader;G.onload=H=>{var W;typeof((W=H.target)==null?void 0:W.result)=="string"&&(e(H.target.result),a(""),p(!1))},G.readAsDataURL(F)},D=F=>{var H;const G=(H=F.target.files)==null?void 0:H[0];G&&z(G)},j=async()=>{if(n){l(!0),p(!1);try{if(x==="offline"){p(!0);const F=await EE(n);a(F)}else try{const F=n.split(",")[1],G=n.split(";")[0].split(":")[1],H=await CL(F,G);a(H)}catch(F){console.warn("Online extraction failed, attempting offline fallback...",F),p(!0);const G=await EE(n);a(G),N("Used offline mode (Cloud unavailable).","info")}}catch(F){console.error(F),N("Extraction failed.","error")}finally{l(!1)}}},P=async()=>{s&&(await Bf(s),y(!0),N("Text copied!","success"),setTimeout(()=>y(!1),2e3))};return u.jsxs("div",{className:"flex flex-col h-full space-y-6",children:[u.jsx("div",{className:"space-y-2 shrink-0",children:n?u.jsxs("div",{className:"relative rounded-3xl overflow-hidden border border-neutral-200 bg-neutral-100 flex justify-center max-h-[300px]",children:[u.jsx("img",{src:n,alt:"Preview",className:"max-w-full object-contain"}),u.jsx("button",{onClick:()=>{e(null),a(""),p(!1)},className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-black/70 backdrop-blur-sm transition-all",children:u.jsx(Rn,{size:16})})]}):u.jsxs("div",{onClick:()=>{var F;return(F=S.current)==null?void 0:F.click()},className:"border-2 border-dashed border-neutral-200 rounded-3xl p-10 flex flex-col items-center justify-center text-neutral-400 hover:border-indigo-400 hover:text-indigo-500 hover:bg-indigo-50/30 transition-all cursor-pointer min-h-[200px]",children:[u.jsx(Lg,{size:40,className:"mb-4"}),u.jsx("p",{className:"font-bold text-sm",children:"Click to upload or paste image (Ctrl+V)"}),u.jsx("input",{type:"file",ref:S,className:"hidden",accept:"image/*",onChange:D})]})}),u.jsxs("div",{className:"flex justify-center gap-3 shrink-0",children:[u.jsxs("button",{onClick:()=>v("cloud"),className:`flex items-center gap-2 px-4 py-2 rounded-xl text-xs font-bold transition-all border ${x==="cloud"?"bg-indigo-50 border-indigo-200 text-indigo-700 shadow-sm":"bg-white border-neutral-200 text-neutral-500 hover:bg-neutral-50"}`,children:[u.jsx(OE,{size:14}),u.jsx("span",{children:"Cloud (Best)"})]}),u.jsxs("button",{onClick:()=>v("offline"),className:`flex items-center gap-2 px-4 py-2 rounded-xl text-xs font-bold transition-all border ${x==="offline"?"bg-emerald-50 border-emerald-200 text-emerald-700 shadow-sm":"bg-white border-neutral-200 text-neutral-500 hover:bg-neutral-50"}`,children:[u.jsx(mv,{size:14}),u.jsx("span",{children:"Offline"})]})]}),u.jsx("div",{className:"flex justify-center shrink-0",children:u.jsx("button",{onClick:j,disabled:!n||o,className:`px-8 py-3 rounded-xl font-black text-xs uppercase tracking-widest transition-all shadow-lg flex items-center gap-2 ${o?"bg-neutral-800 text-neutral-300":"bg-neutral-900 text-white hover:bg-neutral-800"} disabled:opacity-50`,children:o?u.jsxs(u.Fragment,{children:[u.jsx(fn,{size:16,className:"animate-spin"}),u.jsx("span",{children:"Processing..."})]}):u.jsxs(u.Fragment,{children:[u.jsx(iI,{size:16}),u.jsx("span",{children:"Extract Text"})]})})}),s&&u.jsxs("div",{className:"space-y-2 animate-in slide-in-from-bottom-4 fade-in duration-500 flex-1 flex flex-col min-h-0",children:[u.jsxs("div",{className:"flex justify-between items-center px-1 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Result"}),d&&u.jsxs("span",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-neutral-100 text-neutral-500 rounded text-[9px] font-bold border border-neutral-200",children:[u.jsx(mv,{size:10})," Offline Result"]})]}),u.jsxs("button",{onClick:P,className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-wider transition-all ${m?"bg-green-100 text-green-700":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}`,children:[m?u.jsx(Er,{size:12}):u.jsx(Ig,{size:12}),u.jsx("span",{children:m?"Copied":"Copy"})]})]}),u.jsx("textarea",{value:s,readOnly:!0,className:"w-full flex-1 p-4 bg-neutral-50 border border-neutral-200 rounded-2xl text-sm font-medium text-neutral-800 resize-none focus:outline-none focus:ring-2 focus:ring-neutral-900"})]})]})},JL=({audioBlob:n,onTrim:e,onCancel:s})=>{const a=M.useRef(null),[o,l]=M.useState(null),[d,p]=M.useState(null),[m,y]=M.useState(0),[x,v]=M.useState(1),[S,N]=M.useState(!1),z=M.useRef(null);M.useEffect(()=>((async()=>{const H=new(window.AudioContext||window.webkitAudioContext),W=await n.arrayBuffer(),Q=await H.decodeAudioData(W);l(H),p(Q),D(Q,0,1)})(),()=>{o&&o.close()}),[n]);const D=(G,H,W)=>{const Q=a.current;if(!Q)return;const I=Q.getContext("2d");if(!I)return;const T=Q.width,_=Q.height;I.clearRect(0,0,T,_);const C=G.getChannelData(0),R=Math.ceil(C.length/T),L=_/2;I.fillStyle="#e5e7eb",I.fillRect(0,0,T,_),I.fillStyle="#6366f1",I.beginPath();for(let ye=0;ye<T;ye++){let B=1,le=-1;for(let se=0;se<R;se++){const Z=C[ye*R+se];Z<B&&(B=Z),Z>le&&(le=Z)}I.fillRect(ye,(1+B)*L,1,Math.max(1,(le-B)*L))}I.fillStyle="rgba(0, 0, 0, 0.4)";const O=H*T,_e=W*T;I.fillRect(0,0,O,_),I.fillRect(_e,0,T-_e,_),I.fillStyle="#ef4444",I.fillRect(O-2,0,4,_),I.fillRect(_e-2,0,4,_)};M.useEffect(()=>{d&&D(d,m,x)},[m,x,d]);const j=()=>{var T;if(!o||!d)return;if(S){(T=z.current)==null||T.stop(),N(!1);return}const G=d.duration,H=G*m,Q=G*x-H,I=o.createBufferSource();I.buffer=d,I.connect(o.destination),I.start(0,H,Q),I.onended=()=>N(!1),z.current=I,N(!0)},P=async()=>{if(!o||!d)return;const{bufferToWav:G}=await gs(async()=>{const{bufferToWav:_}=await Promise.resolve().then(()=>n4);return{bufferToWav:_}},void 0),H=Math.floor(m*d.length),W=Math.floor(x*d.length),Q=W-H,I=o.createBuffer(d.numberOfChannels,Q,d.sampleRate);for(let _=0;_<d.numberOfChannels;_++){const C=d.getChannelData(_);I.getChannelData(_).set(C.subarray(H,W))}const T=G(I);e(T)},F=G=>{const H=a.current;if(!H)return;const W=H.getBoundingClientRect(),Q=G.clientX-W.left,I=Math.max(0,Math.min(1,Q/W.width)),T=Math.abs(I-m),_=Math.abs(I-x),C=T<_,R=O=>{const _e=O.clientX-W.left,ye=Math.max(0,Math.min(1,_e/W.width));C?y(Math.min(ye,x-.05)):v(Math.max(ye,m+.05))},L=()=>{window.removeEventListener("mousemove",R),window.removeEventListener("mouseup",L)};window.addEventListener("mousemove",R),window.addEventListener("mouseup",L)};return u.jsxs("div",{className:"flex flex-col gap-4 p-4 bg-white rounded-2xl border border-neutral-200",children:[u.jsx("div",{className:"relative h-24 bg-neutral-100 rounded-xl overflow-hidden cursor-pointer",onMouseDown:F,children:u.jsx("canvas",{ref:a,width:600,height:100,className:"w-full h-full"})}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 bg-neutral-900 text-white rounded-xl text-xs font-bold uppercase tracking-wider hover:bg-neutral-800 transition-all",children:[S?u.jsx(Rg,{size:14}):u.jsx(du,{size:14}),S?"Stop":"Preview"]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:s,className:"px-4 py-2 text-neutral-500 hover:text-neutral-900 font-bold text-xs",children:"Cancel"}),u.jsxs("button",{onClick:P,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-xl text-xs font-bold uppercase tracking-wider hover:bg-indigo-500 transition-all",children:[u.jsx(xI,{size:14})," Trim & Use"]})]})]}),u.jsx("p",{className:"text-[10px] text-neutral-400 text-center",children:"Drag the red bars to trim audio."})]})},e5=()=>{const n=wt(),e=Bn(n),{showToast:s}=ea(),[a,o]=M.useState({}),[l,d]=M.useState(!1),[p,m]=M.useState(null),[y,x]=M.useState(null),[v,S]=M.useState(""),[N,z]=M.useState(""),[D,j]=M.useState(!1),[P,F]=M.useState(null),[G,H]=M.useState(""),[W,Q]=M.useState([]),[I,T]=M.useState(!1),[_,C]=M.useState(null),R=M.useRef(null),[L,O]=M.useState(!1),[_e,ye]=M.useState(null),[B,le]=M.useState(!1),se=M.useRef(null),Z=async()=>{try{const pe=await fetch(`${e}/api/audio/mappings`);if(pe.ok){const Ie=await pe.json();o(Ie);const Le=Object.keys(Ie);Le.length>0&&!v&&S(Le[0]),Le.length>0&&!P&&(F(Le[0]),Y(Le[0],""))}}catch(pe){console.error("Failed to fetch mappings",pe)}};M.useEffect(()=>{Z()},[e]),M.useEffect(()=>()=>{R.current&&(R.current.pause(),R.current=null)},[]);const Y=async(pe,Ie="")=>{T(!0),Q([]);try{const Le=encodeURIComponent(Ie),Te=await fetch(`${e}/api/audio/files/${pe}?path=${Le}`);if(Te.ok){const me=await Te.json();Q(me.items),H(me.currentPath)}else s("Failed to load files","error")}catch{s("Connection error","error")}finally{T(!1)}},A=pe=>{F(pe),S(pe),H(""),Y(pe,"")},V=pe=>{if(!P)return;const Ie=G?`${G}/${pe}`:pe;Y(P,Ie)},q=()=>{if(!P||!G)return;const pe=G.split("/");pe.pop();const Ie=pe.join("/");Y(P,Ie)},X=(pe,Ie)=>{pe.stopPropagation(),P&&ye(Ie)},de=async()=>{if(!P||!_e)return;le(!0);const pe=G?`${G}/${_e}`:_e;try{const Le=await(await fetch(`${e}/api/audio/file?mapName=${encodeURIComponent(P)}&filename=${encodeURIComponent(pe)}`,{method:"DELETE"})).json();Le.success?(s("File deleted","success"),Y(P,G)):s(Le.error||"Delete failed","error")}catch{s("Server error","error")}finally{le(!1),ye(null)}},ce=async()=>{await I0(),d(!0),m(null),x(null)},fe=async()=>{const pe=await N0();if(d(!1),pe){const Ie=atob(pe.base64),Le=new Array(Ie.length);for(let et=0;et<Ie.length;et++)Le[et]=Ie.charCodeAt(et);const Te=new Uint8Array(Le),me=new Blob([Te],{type:pe.mimeType});m(me),x(me)}},ie=pe=>{var Le;const Ie=(Le=pe.target.files)==null?void 0:Le[0];Ie&&(m(Ie),x(Ie),z(Ie.name))},Ae=async()=>{if(!y||!v||!N){s("Please select audio, target folder, and filename.","error");return}j(!0);const pe=new FormData;pe.append("mapName",v),pe.append("filename",N),pe.append("audio",y,N);try{const Le=await(await fetch(`${e}/api/audio/upload`,{method:"POST",body:pe})).json();Le.success?(s("Audio uploaded successfully!","success"),m(null),x(null),z(""),P===v&&Y(v,G)):s(Le.error||"Upload failed","error")}catch{s("Upload error","error")}finally{j(!1)}},he=pe=>{if(!P)return"";const Ie=G?`${G}/${pe}`:pe;return`${e}/api/audio/stream/${P}/${Ie}`},xe=(pe,Ie)=>{pe.stopPropagation();const Le=he(Ie);Le&&(Bf(Le),s("Audio URL copied!","success"))},je=pe=>{var Te;const Ie=he(pe);if(!Ie)return;if(_===Ie&&L){(Te=R.current)==null||Te.pause(),O(!1);return}R.current&&R.current.pause();const Le=new Audio(Ie);R.current=Le,C(Ie),Le.play().then(()=>O(!0)).catch(()=>{s("Failed to play audio","error"),O(!1)}),Le.onended=()=>O(!1),Le.onerror=()=>{O(!1),C(null)}};return u.jsxs("div",{className:"flex flex-col h-full gap-4",children:[u.jsx("div",{className:"shrink-0 bg-white p-4 rounded-2xl border border-neutral-200 shadow-sm",children:p?u.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-top-2",children:[u.jsx(JL,{audioBlob:p,onTrim:pe=>{x(pe),s("Trimmed!","success")},onCancel:()=>{m(null),x(null)}}),u.jsxs("div",{className:"p-4 bg-neutral-50 rounded-xl border border-neutral-200 space-y-3",children:[u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsxs("select",{value:v,onChange:pe=>S(pe.target.value),className:"w-full px-3 py-2 rounded-xl border border-neutral-200 text-xs font-bold bg-white focus:ring-2 focus:ring-neutral-900 outline-none",children:[u.jsx("option",{value:"",children:"Target Folder..."}),Object.keys(a).map(pe=>u.jsx("option",{value:pe,children:pe},pe))]}),u.jsx("input",{value:N,onChange:pe=>z(pe.target.value),placeholder:"filename.wav",className:"w-full px-3 py-2 rounded-xl border border-neutral-200 text-xs font-bold bg-white focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>{m(null),x(null)},className:"flex-1 py-2.5 bg-white border border-neutral-200 text-neutral-500 rounded-xl font-bold text-xs hover:bg-neutral-50 transition-all",children:"Cancel"}),u.jsxs("button",{onClick:Ae,disabled:D||!v||!N,className:"flex-[2] py-2.5 bg-neutral-900 text-white rounded-xl font-black text-xs uppercase tracking-widest hover:bg-neutral-800 disabled:opacity-50 transition-all flex items-center justify-center gap-2",children:[D?u.jsx(fn,{size:14,className:"animate-spin"}):u.jsx(BE,{size:14}),u.jsx("span",{children:"Save"})]})]})]})]}):u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("button",{onClick:l?fe:ce,className:`flex items-center justify-center gap-2 p-3 rounded-xl border transition-all ${l?"bg-red-50 border-red-200 text-red-600 animate-pulse":"bg-neutral-50 border-neutral-200 text-neutral-600 hover:bg-white hover:border-indigo-300 hover:text-indigo-600"}`,children:[u.jsx(To,{size:20}),u.jsx("span",{className:"font-bold text-xs",children:l?"Stop Recording":"Record Voice"})]}),u.jsxs("button",{onClick:()=>{var pe;return(pe=se.current)==null?void 0:pe.click()},className:"flex items-center justify-center gap-2 p-3 rounded-xl border bg-neutral-50 border-neutral-200 text-neutral-600 transition-all hover:bg-white hover:border-indigo-300 hover:text-indigo-600",children:[u.jsx(Lg,{size:20}),u.jsx("span",{className:"font-bold text-xs",children:"Upload File"}),u.jsx("input",{type:"file",ref:se,className:"hidden",accept:"audio/*",onChange:ie})]})]})}),u.jsxs("div",{className:"flex-1 flex flex-col min-h-0 bg-neutral-50 rounded-2xl border border-neutral-200 overflow-hidden",children:[u.jsxs("div",{className:"p-3 border-b border-neutral-200 bg-white space-y-2 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("select",{value:P||"",onChange:pe=>A(pe.target.value),className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-xl text-xs font-bold text-neutral-700 outline-none focus:ring-2 focus:ring-neutral-900",children:[u.jsx("option",{value:"",disabled:!0,children:"Select Folder..."}),Object.keys(a).map(pe=>u.jsx("option",{value:pe,children:pe},pe))]}),u.jsx("div",{className:"flex-1 flex items-center gap-1 overflow-hidden",children:G&&u.jsxs(u.Fragment,{children:[u.jsx(of,{size:14,className:"text-neutral-300 shrink-0"}),u.jsx("span",{className:"text-xs font-mono text-neutral-500 truncate",title:G,children:G})]})}),P&&u.jsx("button",{onClick:()=>Y(P,G),className:"p-2 hover:bg-neutral-100 rounded-full transition-colors",children:u.jsx(Cl,{size:14,className:I?"animate-spin":""})})]}),G&&u.jsxs("button",{onClick:q,className:"flex items-center gap-1.5 px-3 py-1.5 bg-neutral-100 text-neutral-600 rounded-lg text-[10px] font-bold hover:bg-neutral-200 transition-colors w-fit",children:[u.jsx(jE,{size:12})," Up One Level"]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-2 custom-scrollbar",children:I?u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-neutral-400 space-y-2",children:[u.jsx(fn,{size:24,className:"animate-spin"}),u.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Loading..."})]}):W.length===0?u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-neutral-400 space-y-2",children:[u.jsx(rI,{size:32,className:"opacity-20"}),u.jsx("p",{className:"text-xs font-medium",children:"Empty folder."})]}):u.jsx("div",{className:"grid grid-cols-1 gap-1",children:W.map((pe,Ie)=>{if(pe.type==="directory")return u.jsxs("div",{onClick:()=>V(pe.name),className:"flex items-center justify-between p-2 rounded-lg hover:bg-white hover:shadow-sm border border-transparent hover:border-neutral-100 transition-all cursor-pointer group",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"p-2 rounded-full bg-blue-50 text-blue-500",children:u.jsx(kE,{size:14,fill:"currentColor"})}),u.jsx("span",{className:"text-xs font-bold text-neutral-700 truncate",children:pe.name})]}),u.jsx(of,{size:14,className:"text-neutral-300 group-hover:text-neutral-500"})]},`${pe.name}-${Ie}`);{const Le=_==null?void 0:_.endsWith(`/${encodeURIComponent(pe.name)}`);return u.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-white hover:shadow-sm border border-transparent hover:border-neutral-100 transition-all group",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0 cursor-pointer flex-1",onClick:()=>je(pe.name),children:[u.jsx("button",{className:`p-2 rounded-full transition-colors ${Le&&L?"bg-indigo-100 text-indigo-600":"bg-neutral-100 text-neutral-500 hover:bg-neutral-200 hover:text-neutral-900"}`,children:Le&&L?u.jsx(Rg,{size:12,fill:"currentColor"}):u.jsx(du,{size:12,fill:"currentColor"})}),u.jsx("span",{className:`text-xs font-medium truncate ${Le?"text-indigo-700 font-bold":"text-neutral-700"}`,children:pe.name})]}),u.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[u.jsx("button",{onClick:Te=>xe(Te,pe.name),className:"p-1.5 text-neutral-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-colors",title:"Copy URL",children:u.jsx(Ig,{size:12})}),P==="Upload_Audio"&&u.jsx("button",{onClick:Te=>X(Te,pe.name),className:"p-1.5 text-neutral-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:u.jsx(jg,{size:12})})]})]},`${pe.name}-${Ie}`)}})})})]}),u.jsx(bg,{isOpen:!!_e,title:"Delete Audio File",message:`Are you sure you want to delete "${_e}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",onConfirm:de,onClose:()=>ye(null),isLoading:B})]})},t5=()=>{const n=wt(),e=Bn(n),{showToast:s}=ea(),[a,o]=M.useState({}),[l,d]=M.useState(null),[p,m]=M.useState(""),[y,x]=M.useState([]),[v,S]=M.useState(!1),[N,z]=M.useState(!1),D=M.useRef(null),j=async()=>{try{const _=await fetch(`${e}/api/audio/mappings`);if(_.ok){const C=await _.json();o(C);const R=Object.keys(C),L=R.find(O=>O.toLowerCase()==="image"||O.toLowerCase()==="images"||O.toLowerCase()==="icon")||R[0];L&&!l&&(d(L),P(L,""))}}catch(_){console.error("Failed to fetch mappings",_)}};M.useEffect(()=>{j()},[e]);const P=async(_,C="")=>{S(!0),x([]);try{const R=encodeURIComponent(C),L=await fetch(`${e}/api/images/files/${_}?path=${R}`);if(L.ok){const O=await L.json();x(O.items),m(O.currentPath)}else s("Failed to load images","error")}catch{s("Connection error","error")}finally{S(!1)}},F=_=>{d(_),m(""),P(_,"")},G=_=>{if(!l)return;const C=p?`${p}/${_}`:_;P(l,C)},H=()=>{if(!l||!p)return;const _=p.split("/");_.pop();const C=_.join("/");P(l,C)},W=async(_,C)=>{if(_.stopPropagation(),!l)return;const R=p?`${p}/${C}`:C;try{const O=await(await fetch(`${e}/api/images/file?mapName=${encodeURIComponent(l)}&filename=${encodeURIComponent(R)}`,{method:"DELETE"})).json();O.success?(s("File deleted","success"),P(l,p)):s(O.error||"Delete failed","error")}catch{s("Server error","error")}},Q=_=>{if(!l)return"";const C=p?`${p}/${_}`:_;return`${e}/api/images/stream/${l}/${C}`},I=(_,C)=>{_.stopPropagation();const R=Q(C);R&&(Bf(R),s("Image URL copied!","success"))},T=async _=>{var L;const C=(L=_.target.files)==null?void 0:L[0];if(!C||!l)return;z(!0);const R=new FormData;R.append("mapName",l),p?`${p}${C.name}`:C.name,R.append("filename",C.name),R.append("image",C);try{const _e=await(await fetch(`${e}/api/images/upload`,{method:"POST",body:R})).json();_e.success?(s("Image uploaded!","success"),P(l,"")):s(_e.error||"Upload failed","error")}catch{s("Upload error","error")}finally{z(!1),D.current&&(D.current.value="")}};return u.jsx("div",{className:"flex flex-col h-full gap-4",children:u.jsxs("div",{className:"flex-1 flex flex-col min-h-0 bg-neutral-50 rounded-2xl border border-neutral-200 overflow-hidden",children:[u.jsxs("div",{className:"p-3 border-b border-neutral-200 bg-white space-y-2 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("select",{value:l||"",onChange:_=>F(_.target.value),className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-xl text-xs font-bold text-neutral-700 outline-none focus:ring-2 focus:ring-neutral-900",children:[u.jsx("option",{value:"",disabled:!0,children:"Select Folder..."}),Object.keys(a).map(_=>u.jsx("option",{value:_,children:_},_))]}),u.jsx("div",{className:"flex-1 flex items-center gap-1 overflow-hidden",children:p&&u.jsxs(u.Fragment,{children:[u.jsx(of,{size:14,className:"text-neutral-300 shrink-0"}),u.jsx("span",{className:"text-xs font-mono text-neutral-500 truncate",title:p,children:p})]})}),l&&u.jsx("button",{onClick:()=>P(l,p),className:"p-2 hover:bg-neutral-100 rounded-full transition-colors",children:u.jsx(Cl,{size:14,className:v?"animate-spin":""})})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[p?u.jsxs("button",{onClick:H,className:"flex items-center gap-1.5 px-3 py-1.5 bg-neutral-100 text-neutral-600 rounded-lg text-[10px] font-bold hover:bg-neutral-200 transition-colors w-fit",children:[u.jsx(jE,{size:12})," Up One Level"]}):u.jsx("div",{}),l&&u.jsxs("button",{onClick:()=>{var _;return(_=D.current)==null?void 0:_.click()},disabled:N,className:"flex items-center gap-1.5 px-3 py-1.5 bg-indigo-600 text-white rounded-lg text-[10px] font-bold hover:bg-indigo-700 transition-colors shadow-sm disabled:opacity-50",children:[N?u.jsx(fn,{size:12,className:"animate-spin"}):u.jsx(Lg,{size:12}),u.jsx("span",{children:"Upload Image"}),u.jsx("input",{type:"file",ref:D,className:"hidden",accept:"image/*",onChange:T})]})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:v?u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-neutral-400 space-y-2",children:[u.jsx(fn,{size:24,className:"animate-spin"}),u.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Loading..."})]}):y.length===0?u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-neutral-400 space-y-2",children:[u.jsx(UE,{size:32,className:"opacity-20"}),u.jsx("p",{className:"text-xs font-medium",children:"Empty folder."})]}):u.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:[y.filter(_=>_.type==="directory").map((_,C)=>u.jsxs("div",{onClick:()=>G(_.name),className:"aspect-square rounded-xl bg-blue-50 border border-blue-100 flex flex-col items-center justify-center cursor-pointer hover:bg-blue-100 transition-colors gap-2",children:[u.jsx(kE,{size:32,className:"text-blue-400"}),u.jsx("span",{className:"text-xs font-bold text-blue-800 truncate px-2 max-w-full",children:_.name})]},`dir-${C}`)),y.filter(_=>_.type==="file").map((_,C)=>{const R=Q(_.name);return u.jsxs("div",{className:"group relative aspect-square rounded-xl bg-white border border-neutral-200 overflow-hidden shadow-sm hover:shadow-md transition-all",children:[u.jsx("div",{className:"absolute inset-0 bg-neutral-100 flex items-center justify-center",children:u.jsx("img",{src:R,alt:_.name,className:"w-full h-full object-cover",loading:"lazy"})}),u.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2 p-2",children:[u.jsx("p",{className:"text-[10px] text-white font-medium truncate w-full text-center mb-1",children:_.name}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:L=>I(L,_.name),className:"p-2 bg-white text-indigo-600 rounded-full hover:bg-indigo-50 transition-colors",title:"Copy URL",children:u.jsx(Ig,{size:14})}),u.jsx("button",{onClick:L=>W(L,_.name),className:"p-2 bg-white text-red-600 rounded-full hover:bg-red-50 transition-colors",title:"Delete",children:u.jsx(jg,{size:14})})]})]})]},`file-${C}`)})]})})]})})},n5=({isOpen:n,onClose:e})=>{const[s,a]=M.useState("OCR");if(!n)return null;const o=[{id:"OCR",label:"Image to Text",icon:yI},{id:"IMAGES",label:"Image Manager",icon:UE},{id:"AUDIO",label:"Audio Tool",icon:To}];return u.jsx("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-4xl rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col h-[85vh]",children:[u.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-center shrink-0",children:[u.jsx("div",{className:"flex gap-2 p-1 bg-neutral-100 rounded-xl",children:o.map(l=>{const d=l.icon;return u.jsxs("button",{onClick:()=>a(l.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-lg text-xs font-black uppercase tracking-wider transition-all ${s===l.id?"bg-white text-neutral-900 shadow-sm":"text-neutral-500 hover:text-neutral-700"}`,children:[u.jsx(d,{size:16}),u.jsx("span",{children:l.label})]},l.id)})}),u.jsx("button",{onClick:e,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full transition-colors",children:u.jsx(Rn,{size:24})})]}),u.jsxs("main",{className:"flex-1 overflow-y-auto p-6 md:p-8",children:[s==="OCR"&&u.jsx(XL,{}),s==="IMAGES"&&u.jsx(t5,{}),s==="AUDIO"&&u.jsx(e5,{})]})]})})},s5=1e3,r5=300,wE=n=>{if(!Array.isArray(n)||n.length===0)return[];const e=new Map,s=[],a=o=>{const l=String(o||"").toLowerCase();return/\bnoun\b/.test(l)?"NOUN":/\bverb\b/.test(l)?"VERB":/\badjective\b/.test(l)?"ADJECTIVE":/\badverb\b/.test(l)?"ADVERB":/\bpronoun\b/.test(l)?"PRONOUN":/\bpreposition\b/.test(l)?"PREPOSITION":/\bconjunction\b/.test(l)?"CONJUNCTION":/\binterjection\b/.test(l)?"INTERJECTION":String(o||"").replace(/\s+/g," ").trim().toUpperCase()||"N/A"};for(const o of n){const l=a(o.partOfSpeech);e.has(l)||(e.set(l,{headword:o.headword||null,partOfSpeech:l,ipaUs:null,ipaUk:null,audioUs:null,audioUk:null}),s.push(l));const d=e.get(l);!d.headword&&o.headword&&(d.headword=o.headword),!d.ipaUs&&o.ipaUs&&(d.ipaUs=o.ipaUs),!d.ipaUk&&o.ipaUk&&(d.ipaUk=o.ipaUk),!d.audioUs&&o.audioUs&&(d.audioUs=o.audioUs),!d.audioUk&&o.audioUk&&(d.audioUk=o.audioUk)}return s.map(o=>e.get(o)).filter(o=>o.ipaUs||o.ipaUk||o.audioUs||o.audioUk)},SE={woman_teacher:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/People/Woman%20Teacher.png",bg:"bg-indigo-50"},man_teacher:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/People/Man%20Teacher.png",bg:"bg-blue-50"},fox:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Fox.png",bg:"bg-orange-100"},koala:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Koala.png",bg:"bg-teal-100"},pet:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Cat%20Face.png",bg:"bg-pink-100"},owl:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Owl.png",bg:"bg-yellow-100"},panda:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Panda.png",bg:"bg-emerald-100"},unicorn:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Unicorn.png",bg:"bg-purple-100"}},a5=({user:n,onViewWord:e,isAnyModalOpen:s})=>{const{showToast:a}=ea(),[o,l]=M.useState(wt()),[d,p]=M.useState(Bc()),[m,y]=M.useState(Fc()),[x,v]=M.useState(Hc()),[S,N]=M.useState(!1),[z,D]=M.useState(rf()),[j,P]=M.useState({currentTime:0,duration:0}),[F,G]=M.useState([]),[H,W]=M.useState(0),[Q,I]=M.useState(!1),[T,_]=M.useState(null),[C,R]=M.useState(!1),[L,O]=M.useState(null),[_e,ye]=M.useState(null),[B,le]=M.useState(!1),[se,Z]=M.useState(!1),[Y,A]=M.useState(!1),V=M.useRef(null),q=M.useRef(null),X=M.useRef(null),de=M.useRef(null),ce=M.useRef(null),fe=M.useRef(!1),ie=M.useRef(""),Ae=M.useRef(null),he=M.useRef(null),xe=M.useRef(!1),je=M.useRef(null),pe=M.useRef({word:"",at:0}),Ie=o.audioCoach.activeCoach,Le=o.audioCoach.coaches[Ie],Te=me(Le.avatar);function me(be){return be.startsWith("http")||be.startsWith("data:")?{url:be,bg:"bg-white border-2 border-neutral-100"}:SE[be]||SE.woman_teacher}const et=async be=>{if(!be||!n.id)return;const De=await qm(n.id,be);le(!!De)};M.useEffect(()=>{xe.current=Q},[Q]),M.useEffect(()=>{if(d&&!x){ce.current&&(window.clearTimeout(ce.current),ce.current=null),N(!0);return}ce.current&&window.clearTimeout(ce.current),ce.current=window.setTimeout(()=>{N(!1),ce.current=null},260)},[d,x]),M.useEffect(()=>{je.current=T},[T]),M.useEffect(()=>{const be=()=>l(wt()),De=it=>{const Ge=it.detail,It=typeof(Ge==null?void 0:Ge.isSpeaking)=="boolean"?Ge.isSpeaking:Bc(),dt=typeof(Ge==null?void 0:Ge.isAudioPaused)=="boolean"?Ge.isAudioPaused:Fc(),Je=typeof(Ge==null?void 0:Ge.isSingleWordPlayback)=="boolean"?Ge.isSingleWordPlayback:Hc(),Qt=typeof(Ge==null?void 0:Ge.playbackRate)=="number"?Ge.playbackRate:rf();if(D(Qt),It){de.current&&(window.clearTimeout(de.current),de.current=null),p(!0),y(dt),v(Je);return}de.current&&window.clearTimeout(de.current),de.current=window.setTimeout(()=>{p(Bc()),y(Fc()),v(Hc()),de.current=null},180)},Ne=it=>{var xs,bs,Wt,Hn,ta,Hs;const Ge=it,It=(bs=(xs=Ge.detail)==null?void 0:xs.word)==null?void 0:bs.trim(),dt=(Wt=Ge.detail)==null?void 0:Wt.data;if(!It||!(dt!=null&&dt.exists))return;const Je=It.toLowerCase(),Qt=(Hs=(ta=(Hn=je.current)==null?void 0:Hn.cambridge)==null?void 0:ta.word)==null?void 0:Hs.trim().toLowerCase();if(xe.current&&Qt===Je){X.current&&(window.clearTimeout(X.current),X.current=null);const na=Date.now();pe.current={word:Je,at:na};return}const gt=Date.now(),rn=pe.current;rn.word===Je&&gt-rn.at<500||(ie.current=Je,R(!1),ye(null),_({actionLabel:"Go to Cambridge",actionUrl:dt.url,cambridge:{word:dt.word||Je,pronunciations:wE(dt.pronunciations)},icon:u.jsx(Yp,{size:18,className:"text-blue-500"})}),pe.current={word:Je,at:gt},I(!0))},bt=it=>{var gt,rn,xs,bs,Wt,Hn;const Ge=it,It=(rn=(gt=Ge.detail)==null?void 0:gt.word)==null?void 0:rn.trim(),dt=(xs=Ge.detail)==null?void 0:xs.ipa;if(!It||!dt)return;const Je=It.toLowerCase(),Qt=(Hn=(Wt=(bs=je.current)==null?void 0:bs.cambridge)==null?void 0:Wt.word)==null?void 0:Hn.trim().toLowerCase();xe.current&&Qt===Je||(ie.current=Je,R(!1),ye(null),_({text:`**IPA:** ${dt}`,icon:u.jsx($p,{size:18,className:"text-purple-500"})}),pe.current={word:Je,at:Date.now()},I(!0))};return window.addEventListener("config-updated",be),window.addEventListener("audio-status-changed",De),window.addEventListener("coach-cambridge-lookup-request",Ne),window.addEventListener("coach-ipa-fallback-request",bt),p(Bc()),y(Fc()),v(Hc()),D(rf()),()=>{de.current&&(window.clearTimeout(de.current),de.current=null),ce.current&&(window.clearTimeout(ce.current),ce.current=null),window.removeEventListener("config-updated",be),window.removeEventListener("audio-status-changed",De),window.removeEventListener("coach-cambridge-lookup-request",Ne),window.removeEventListener("coach-ipa-fallback-request",bt),he.current&&(he.current.pause(),he.current=null)}},[]),M.useEffect(()=>{if(!o.interface.rightClickCommandEnabled)return;const be=it=>{if(!it||it.rangeCount===0)return;const Ge=it.toString().trim();if(!Ge)return;const It=it.getRangeAt(0).cloneRange(),dt=It.getBoundingClientRect(),Je=dt.top>250?"top":"bottom";ie.current=Ge,Ae.current=It,ye({x:dt.left+dt.width/2,y:Je==="top"?dt.top:dt.bottom,placement:Je}),_(null),I(!0),et(Ge)},De=it=>{const Ge=window.getSelection();!Ge||!Ge.toString().trim()||(it.preventDefault(),be(Ge))},Ne=it=>{if(Q)return;const Ge=window.getSelection();if(!Ge||Ge.rangeCount===0||!Ge.toString().trim())return;const Je=Ge.getRangeAt(0).getBoundingClientRect(),Qt=it.clientX,gt=it.clientY;Qt>=Je.left&&Qt<=Je.right&&gt>=Je.top&&gt<=Je.bottom&&be(Ge)},bt=it=>{const Ge=it.target,It=!V.current||!V.current.contains(Ge),dt=!q.current||!q.current.contains(Ge);It&&dt&&(I(!1),ye(null))};return document.addEventListener("contextmenu",De),document.addEventListener("click",Ne),document.addEventListener("mousedown",bt),()=>{document.removeEventListener("contextmenu",De),document.removeEventListener("click",Ne),document.removeEventListener("mousedown",bt)}},[o.interface.rightClickCommandEnabled,o.server,n.id,Q]);const Xe=async()=>{var Ne,bt;const be=ie.current||((Ne=window.getSelection())==null?void 0:Ne.toString().trim());if(!be)return;if(Eu(be)==="vi"){_({text:be,icon:u.jsx(hv,{size:18,className:"text-blue-500"})}),I(!0),ns(be,!1,"vi",Le.viVoice,Le.viAccent);return}R(!0),I(!1),ye(null);try{const Ge=await(await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(be)}&langpair=en|vi`)).json();if((bt=Ge==null?void 0:Ge.responseData)!=null&&bt.translatedText){const It=Ge.responseData.translatedText;_({text:It,icon:u.jsx(hv,{size:18,className:"text-blue-500"})}),I(!0),ns(It,!1,"vi",Le.viVoice,Le.viAccent)}}catch{a("Translation error!","error")}finally{R(!1)}},re=async()=>{var De;const be=ie.current||((De=window.getSelection())==null?void 0:De.toString().trim());if(be){be.length>s5?a("Text is too long to read!","error"):ns(be,!1,"en",Le.enVoice,Le.enAccent),R(!0),I(!1),ye(null);try{const Ne=be.toLowerCase();if(Ne.split(/\s+/).filter(Boolean).length===1){const dt=Bn(o),Je=await fetch(`${dt}/api/lookup/cambridge/simple?word=${encodeURIComponent(Ne)}`,{cache:"no-store"});if(Je.ok){const Qt=await Je.text(),gt=Qt?JSON.parse(Qt):null;if(gt!=null&&gt.exists){_({actionLabel:"Go to Cambridge",actionUrl:gt.url,cambridge:{word:gt.word||Ne,pronunciations:wE(gt.pronunciations)},icon:u.jsx(Yp,{size:18,className:"text-blue-500"})}),I(!0),R(!1);return}}}const it=di().find(dt=>dt.word.toLowerCase()===Ne);if(it&&it.ipaUs){_({text:`**IPA:** ${it.ipaUs}`,icon:u.jsx($p,{size:18,className:"text-emerald-500"})}),I(!0),R(!1);return}const Ge=Bn(o),It=await fetch(`${Ge}/api/convert/ipa?text=${encodeURIComponent(be)}&mode=2`);if(It.ok){const dt=await It.json();_({text:`**IPA:** ${dt.ipa}`,icon:u.jsx($p,{size:18,className:"text-purple-500"})}),I(!0)}}catch{}finally{R(!1)}}},Fe=async()=>{var De;const be=ie.current||((De=window.getSelection())==null?void 0:De.toString().trim());if(be&&!(!be||B)){Z(!0);try{let Ne,bt=null;try{const it=await vN([be]);it.length>0&&(bt=it[0])}catch{}bt?(Ne={...bt,id:crypto.randomUUID?crypto.randomUUID():"id-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),userId:n.id,createdAt:Date.now(),updatedAt:Date.now(),quality:Ft.REFINED,source:"refine",nextReview:Date.now(),interval:0,easeFactor:2.5,consecutiveCorrect:0,forgotCount:0,lastReview:void 0,lastGrade:void 0,lastTestResults:{},groups:[...bt.groups||[],"coach-added"]},Ne.isPassive=!1,Ne.complexity=kr(Ne),Ne.masteryScore=Ns(Ne),Ne.gameEligibility=jr(Ne)):(Ne={...$w(be,"","","","",["coach-added"],!1,!1,!1,!1,be.includes(" ")),userId:n.id,quality:Ft.RAW},Ne.isPassive=!1),await Cf(Ne),a(`"${be}" added!`,"success"),le(!0),I(!1),ye(null)}catch{a("Add error!","error")}finally{Z(!1)}}},rt=async()=>{var Ne;const be=ie.current||((Ne=window.getSelection())==null?void 0:Ne.toString().trim());if(!be||!n.id||!e||s)return;const De=await qm(n.id,be);De&&(I(!1),ye(null),e(De))},Tt=()=>{var De;const be=ie.current||((De=window.getSelection())==null?void 0:De.toString().trim());I(!1),ye(null),be&&be.length>r5?(a("Selection too long for mimic!","error"),O(null)):O(be||"")},Ze=()=>{I(!1),ye(null),A(!0)},tt=()=>{var bt;const be=ie.current||((bt=window.getSelection())==null?void 0:bt.toString().trim());if(!be)return;const De=`Example in English sentence for "${be}"`,Ne=encodeURIComponent(De);window.open(`https://www.google.com/search?q=${Ne}`,"_blank"),I(!1),ye(null)},ut=be=>{if(!be){a("Audio not available.","info");return}try{const De=be.startsWith("http")?be:`${Bn(o)}${be.startsWith("/")?"":"/"}${be}`;he.current&&(he.current.pause(),he.current=null);const Ne=new Audio(De);he.current=Ne,Ne.onerror=()=>a("Failed to play Cambridge audio.","error"),Ne.onended=()=>{he.current===Ne&&(he.current=null)},Ne.play().catch(()=>a("Failed to play Cambridge audio.","error"))}catch{a("Failed to play Cambridge audio.","error")}},At=()=>{fe.current=!0,X.current&&(window.clearTimeout(X.current),X.current=null),I(!0)},Ht=()=>{var be;fe.current=!1,X.current&&window.clearTimeout(X.current),X.current=window.setTimeout(()=>{I(!1),X.current=null},(be=je.current)!=null&&be.cambridge?3e3:300)};M.useEffect(()=>{if(!(!Q||!(T!=null&&T.cambridge))&&!fe.current)return X.current&&window.clearTimeout(X.current),X.current=window.setTimeout(()=>{fe.current||(I(!1),X.current=null)},3e3),()=>{X.current&&(window.clearTimeout(X.current),X.current=null)}},[Q,T]);const fr=()=>u.jsx("div",{ref:V,className:"bg-white/95 backdrop-blur-xl p-1.5 rounded-[1.8rem] shadow-2xl border border-neutral-200 flex flex-col gap-1 w-[160px] animate-in fade-in zoom-in-95 duration-200",children:u.jsxs("div",{className:"grid grid-cols-6 gap-1",children:[u.jsx("button",{type:"button",onClick:Xe,className:"col-span-2 aspect-square bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center hover:bg-indigo-100 transition-all active:scale-90 shadow-sm font-black text-xs",title:"Ting Vit",children:"VI"}),B?u.jsx("button",{type:"button",onClick:rt,disabled:s,className:"col-span-2 aspect-square bg-sky-50 text-sky-600 rounded-2xl flex items-center justify-center hover:bg-sky-100 transition-all active:scale-90 shadow-sm",title:"View Word Details",children:u.jsx(su,{size:15})}):u.jsx("button",{type:"button",onClick:Fe,disabled:se,className:"col-span-2 aspect-square bg-green-50 text-green-600 rounded-2xl flex items-center justify-center hover:bg-green-100 transition-all active:scale-90 shadow-sm",title:"Add to Library",children:se?u.jsx(fn,{size:14,className:"animate-spin"}):u.jsx(Kr,{size:15})}),u.jsx("button",{type:"button",onClick:re,className:"col-span-2 aspect-square bg-purple-50 text-purple-600 rounded-2xl flex items-center justify-center hover:bg-purple-100 transition-all active:scale-90 shadow-sm",title:"Read & Phonetics (EN)",children:u.jsx(wr,{size:15})}),u.jsx("button",{type:"button",onClick:Tt,className:"col-span-2 aspect-square bg-amber-50 text-amber-500 rounded-2xl flex items-center justify-center hover:bg-amber-100 transition-all active:scale-95 shadow-sm",title:"Mimic Practice",children:u.jsx(To,{size:15})}),u.jsx("button",{type:"button",onClick:Ze,className:"col-span-2 aspect-square bg-rose-50 text-rose-500 rounded-2xl flex items-center justify-center hover:bg-rose-100 transition-all active:scale-95 shadow-sm",title:"Coach Tools",children:u.jsx(NI,{size:15})}),u.jsx("button",{type:"button",onClick:tt,className:"col-span-2 aspect-square bg-blue-50 text-blue-600 rounded-2xl flex items-center justify-center hover:bg-blue-100 transition-all active:scale-95 shadow-sm",title:"Search Google Examples",children:u.jsx(Yp,{size:15})})]})}),hr=be=>{const De=new RegExp("\\*\\*(.*?)\\*\\*","g");return be.replace(De,"<strong>$1</strong>")};M.useEffect(()=>{let be;return d?(G(bT()),be=setInterval(()=>{const De=TT();De&&P(De)},100)):(P({currentTime:0,duration:0}),G([]),y(!1),v(!1)),()=>clearInterval(be)},[d]);const Cs=be=>{const De=parseFloat(be.target.value);yl(De),P(Ne=>({...Ne,currentTime:De}))},ys=be=>{const De=Math.floor(be/60),Ne=Math.floor(be%60);return`${De}:${Ne.toString().padStart(2,"0")}`},pn=()=>{const be=[.6,.7,.8,.9,1,1.25,1.5],De=be.findIndex(bt=>Math.abs(bt-z)<.001),Ne=be[(De+1)%be.length];vT(Ne),D(Ne)};return u.jsxs(u.Fragment,{children:[Q&&_e&&u.jsx("div",{className:"fixed z-[2147483647]",style:{left:`${_e.x}px`,top:`${_e.y}px`,transform:_e.placement==="top"?"translate(-50%, -100%) translateY(-10px)":"translate(-50%, 0) translateY(10px)"},children:u.jsx(fr,{})}),u.jsx("div",{className:"fixed bottom-0 left-6 z-[2147483646] flex flex-col items-start pointer-events-none",children:u.jsx("div",{className:"flex flex-col items-center pointer-events-auto group pb-0 pt-10",onMouseEnter:At,onMouseLeave:Ht,children:u.jsxs("div",{className:"relative",children:[Q&&!_e&&u.jsx("div",{className:"absolute bottom-16 left-0 z-50 animate-in fade-in slide-in-from-bottom-2 duration-200",children:T?u.jsxs("div",{ref:q,className:"bg-white p-5 rounded-[2.5rem] shadow-2xl border border-neutral-200 w-[26rem] relative",children:[u.jsx("button",{onClick:()=>{_(null),I(!1),ye(null)},className:"absolute top-4 right-4 text-neutral-300 hover:text-neutral-900",children:u.jsx(Rn,{size:14})}),u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"shrink-0 mt-1",children:T.icon||u.jsx(Cg,{size:18})}),u.jsxs("div",{className:"text-xs font-medium text-neutral-700 leading-relaxed space-y-2",children:[T.cambridge?u.jsx("div",{className:"space-y-4",children:Array.isArray(T.cambridge.wordFamily)&&T.cambridge.wordFamily.length>0?T.cambridge.wordFamily.map((be,De)=>u.jsx("div",{className:"space-y-2",children:u.jsx("div",{className:"grid grid-cols-2 gap-2",children:(be.pronunciations||[]).map((Ne,bt)=>u.jsxs("div",{className:"rounded-lg border border-neutral-200 bg-neutral-50 p-2 space-y-1.5",children:[Ne.headword&&u.jsx("p",{className:"text-[11px] font-extrabold text-indigo-700 break-words",children:Ne.headword}),u.jsx("p",{className:"text-[10px] font-black uppercase tracking-wide text-neutral-500",children:Ne.partOfSpeech||"N/A"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>ut(Ne.audioUs||void 0),disabled:!Ne.audioUs,className:`px-2 py-0.5 text-[9px] font-black uppercase rounded-md border transition-colors ${Ne.audioUs?"bg-indigo-50 text-indigo-700 border-indigo-100 hover:bg-indigo-100":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed"}`,children:"US"}),u.jsx("p",{className:"text-[11px] text-neutral-700 leading-relaxed flex-1 break-words",children:Ne.ipaUs?`/${Ne.ipaUs}/`:"N/A"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>ut(Ne.audioUk||void 0),disabled:!Ne.audioUk,className:`px-2 py-0.5 text-[9px] font-black uppercase rounded-md border transition-colors ${Ne.audioUk?"bg-emerald-50 text-emerald-700 border-emerald-100 hover:bg-emerald-100":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed"}`,children:"UK"}),u.jsx("p",{className:"text-[11px] text-neutral-700 leading-relaxed flex-1 break-words",children:Ne.ipaUk?`/${Ne.ipaUk}/`:"N/A"})]})]},bt))})},De)):u.jsx("div",{className:"space-y-2",children:u.jsx("div",{className:"grid grid-cols-2 gap-2",children:(T.cambridge.pronunciations||[]).map((be,De)=>u.jsxs("div",{className:"rounded-lg border border-neutral-200 bg-neutral-50 p-2 space-y-1.5",children:[be.headword&&u.jsx("p",{className:"text-[11px] font-extrabold text-indigo-700 break-words",children:be.headword}),u.jsx("p",{className:"text-[10px] font-black uppercase tracking-wide text-neutral-500",children:be.partOfSpeech||"N/A"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>ut(be.audioUs||void 0),disabled:!be.audioUs,className:`px-2 py-0.5 text-[9px] font-black uppercase rounded-md border transition-colors ${be.audioUs?"bg-indigo-50 text-indigo-700 border-indigo-100 hover:bg-indigo-100":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed"}`,children:"US"}),u.jsx("p",{className:"text-[11px] text-neutral-700 leading-relaxed flex-1 break-words",children:be.ipaUs?`/${be.ipaUs}/`:"N/A"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>ut(be.audioUk||void 0),disabled:!be.audioUk,className:`px-2 py-0.5 text-[9px] font-black uppercase rounded-md border transition-colors ${be.audioUk?"bg-emerald-50 text-emerald-700 border-emerald-100 hover:bg-emerald-100":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed"}`,children:"UK"}),u.jsx("p",{className:"text-[11px] text-neutral-700 leading-relaxed flex-1 break-words",children:be.ipaUk?`/${be.ipaUk}/`:"N/A"})]})]},De))})})}):u.jsx("div",{dangerouslySetInnerHTML:{__html:hr(T.text||"")}}),T.actionUrl&&u.jsx("button",{type:"button",onClick:()=>window.open(T.actionUrl,"_blank"),className:"px-3 py-1.5 text-[10px] font-black uppercase tracking-wide rounded-lg bg-blue-50 text-blue-700 border border-blue-100 hover:bg-blue-100 transition-colors",children:T.actionLabel||"Open"})]})]})]}):u.jsx(fr,{})}),u.jsx("button",{onClick:be=>{S&&(be.stopPropagation(),xT())},className:`w-14 h-14 rounded-2xl flex items-center justify-center transition-all duration-300 transform shadow-2xl relative z-10 ${Te.bg} ${Q?"ring-4 ring-white":"hover:scale-110 mb-1"}`,children:C?u.jsx(fn,{size:20,className:"animate-spin text-neutral-400"}):u.jsxs(u.Fragment,{children:[u.jsx("img",{src:Te.url,className:`w-10 h-10 object-contain ${S?"opacity-30 scale-90 blur-[1px]":""}`,alt:"Coach"}),S&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-indigo-600 animate-in fade-in zoom-in duration-200",children:u.jsx(Og,{size:24,fill:"currentColor"})})]})}),S&&u.jsxs("div",{className:"absolute left-16 bottom-2 flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 bg-white/90 backdrop-blur-md px-3 sm:px-4 py-2 rounded-2xl shadow-xl border border-neutral-200 animate-in fade-in slide-in-from-left-4 duration-300 pointer-events-auto w-[calc(100vw-6rem)] sm:w-auto max-w-[95vw] sm:max-w-none",onMouseEnter:At,onMouseLeave:Ht,children:[u.jsx("span",{className:"text-[10px] font-mono text-neutral-500 tabular-nums w-8",children:j.duration>0?ys(j.currentTime):"--:--"}),u.jsx("input",{type:"range",min:"0",max:j.duration>0?j.duration:1,step:"0.1",value:j.duration>0?j.currentTime:0,onChange:Cs,disabled:j.duration<=0,className:"flex-1 h-1.5 bg-neutral-100 rounded-full appearance-none cursor-pointer accent-indigo-600 hover:accent-indigo-700 transition-all"}),u.jsx("span",{className:"text-[10px] font-mono text-neutral-400 tabular-nums w-8",children:j.duration>0?ys(j.duration):"--:--"}),u.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-2 w-full",children:[u.jsx("button",{onClick:()=>{const be=Math.max(0,j.currentTime-5);yl(be),P(De=>({...De,currentTime:be}))},className:"w-6 h-6 rounded-lg bg-neutral-50 text-neutral-700 hover:bg-neutral-100 transition-colors flex items-center justify-center border border-neutral-200",title:"Rewind 5 seconds",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M7 8L13 12V4L7 8ZM3 8L9 12V4L3 8Z",fill:"currentColor"})})}),u.jsx("button",{onClick:()=>{const be=Math.min(j.duration,j.currentTime+5);yl(be),P(De=>({...De,currentTime:be}))},className:"w-6 h-6 rounded-lg bg-neutral-50 text-neutral-700 hover:bg-neutral-100 transition-colors flex items-center justify-center border border-neutral-200",title:"Forward 5 seconds",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M9 8L3 4V12L9 8ZM13 8L7 4V12L13 8Z",fill:"currentColor"})})}),u.jsx("button",{onClick:()=>{m?ET().catch(()=>a("Cannot resume audio.","error")):_T()},className:"w-6 h-6 rounded-lg bg-indigo-50 text-indigo-600 hover:bg-indigo-100 transition-colors flex items-center justify-center border border-indigo-100",title:m?"Resume audio":"Pause audio",children:m?u.jsx(du,{size:12,fill:"currentColor"}):u.jsx(Rg,{size:12,fill:"currentColor"})}),u.jsxs("button",{onClick:pn,className:"h-6 px-2 rounded-lg bg-neutral-50 text-neutral-700 hover:bg-neutral-100 transition-colors flex items-center justify-center border border-neutral-200 text-[10px] font-black tabular-nums",title:"Playback speed",children:[z.toFixed(z%1===0?1:2),"x"]}),F.length>0&&j.duration>0&&u.jsx("div",{className:"flex items-center gap-1 ml-1 border-l border-neutral-200 pl-2",children:F.map((be,De)=>u.jsx("button",{onClick:()=>{yl(be),P(Ne=>({...Ne,currentTime:be}))},className:"w-5 h-5 flex items-center justify-center rounded-full bg-indigo-50 text-indigo-600 text-[10px] font-bold hover:bg-indigo-600 hover:text-white transition-colors border border-indigo-100",title:`Jump to ${ys(be)}`,children:De+1},De))}),u.jsxs("div",{className:"flex items-center gap-1 border-l border-neutral-200 pl-1 pr-0 ml-0",children:[u.jsx("button",{onClick:()=>W(j.currentTime),className:"w-6 h-6 rounded-lg bg-yellow-50 text-yellow-700 hover:bg-yellow-100 transition-colors flex items-center justify-center border border-yellow-200",title:"Mark current time",children:u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"8",cy:"8",r:"6",stroke:"currentColor",strokeWidth:"2"}),u.jsx("circle",{cx:"8",cy:"8",r:"2",fill:"currentColor"})]})}),u.jsx("button",{onClick:()=>{yl(H),P(be=>({...be,currentTime:H}))},className:"w-10 h-6 rounded-lg bg-indigo-50 text-indigo-700 hover:bg-indigo-100 transition-colors flex items-center justify-center border border-indigo-200 text-[11px] font-bold",title:`Play at marked time (${H.toFixed(1)}s)`,children:H.toFixed(1)})]})]})]})]})})}),L!==null&&u.jsx(AT,{target:L,onClose:()=>O(null)}),u.jsx(n5,{isOpen:Y,onClose:()=>A(!1)})]})},i5=({isOpen:n,onClose:e,backups:s,onRestore:a,onNewUser:o,onLocalRestore:l,isRestoring:d,title:p="Server Backups",description:m="Select a user profile to restore."})=>{if(!n)return null;const y=x=>x<1024*1024?`${(x/1024).toFixed(1)} KB`:`${(x/(1024*1024)).toFixed(1)} MB`;return u.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col max-h-[85vh]",children:[u.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-center shrink-0",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-xl font-black text-neutral-900 flex items-center gap-2",children:[u.jsx(OE,{size:20})," ",p]}),u.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:m})]}),u.jsx("button",{onClick:e,disabled:d,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:u.jsx(Rn,{size:20})})]}),u.jsx("main",{className:"flex-1 overflow-y-auto p-6 space-y-3 custom-scrollbar",children:s.length===0?u.jsx("div",{className:"text-center py-10 text-neutral-400 font-medium italic",children:"No backups found on server."}):s.map(x=>u.jsxs("div",{className:"flex items-center justify-between p-4 rounded-2xl bg-neutral-50 border border-neutral-100 hover:border-neutral-300 transition-all group",children:[u.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[u.jsx("div",{className:"p-2.5 bg-white rounded-xl text-neutral-500 shadow-sm",children:u.jsx(AI,{size:18})}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("h4",{className:"font-bold text-sm text-neutral-900 truncate",children:x.name}),u.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-neutral-500 font-medium",children:[u.jsx("span",{className:"font-black text-indigo-600",children:new Date(x.date).toLocaleString()}),u.jsx("span",{className:"w-1 h-1 rounded-full bg-neutral-300"}),u.jsx("span",{children:y(x.size)})]})]})]}),u.jsx("button",{onClick:()=>a(x.id),disabled:d,className:"px-4 py-2 bg-white border border-neutral-200 text-indigo-600 rounded-xl font-black text-[10px] uppercase tracking-wider hover:bg-indigo-50 hover:border-indigo-200 transition-all shadow-sm active:scale-95 disabled:opacity-50",children:d?u.jsx(fn,{size:14,className:"animate-spin"}):"Restore"})]},x.id))}),u.jsxs("footer",{className:"px-6 py-4 border-t border-neutral-100 bg-neutral-50/30 shrink-0 flex flex-col gap-3 rounded-b-[2.5rem]",children:[u.jsxs("button",{onClick:o,disabled:d,className:"w-full py-3 bg-neutral-900 text-white rounded-xl font-bold text-xs flex items-center justify-center gap-2 shadow-lg hover:bg-neutral-800 transition-all active:scale-95",children:[u.jsx(Kr,{size:16}),u.jsx("span",{children:"I am a New User (Create Profile)"})]}),u.jsx("div",{className:"flex justify-center",children:u.jsxs("button",{onClick:l,disabled:d,className:"flex items-center gap-1.5 text-[10px] font-bold text-neutral-400 hover:text-neutral-600 transition-colors py-1 px-2 rounded-lg hover:bg-neutral-100",children:[u.jsx(aI,{size:12}),u.jsx("span",{children:"Or restore from local file"})]})})]})]})})},o5=({isOpen:n,onClose:e,onPush:s,onRestore:a,type:o,localDate:l,serverDate:d,isProcessing:p})=>{if(!n)return null;const m=o==="restore";return u.jsx("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4 bg-neutral-900/80 backdrop-blur-sm animate-in fade-in duration-300",children:u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl border border-neutral-200 overflow-hidden flex flex-col animate-in zoom-in-95 duration-300",children:[u.jsxs("div",{className:`p-8 text-center space-y-4 ${m?"bg-indigo-50":"bg-emerald-50"}`,children:[u.jsxs("div",{className:"mx-auto w-20 h-20 bg-white rounded-full flex items-center justify-center shadow-sm relative",children:[m?u.jsx(dv,{size:40,className:"text-indigo-500"}):u.jsx(fv,{size:40,className:"text-emerald-500"}),u.jsx("div",{className:"absolute -top-1 -right-1 bg-amber-500 rounded-full p-1 border-2 border-white",children:u.jsx(kg,{size:12,className:"text-white"})})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("h3",{className:"text-2xl font-black text-neutral-900 tracking-tight",children:m?"Update Available":"Unsaved Progress"}),u.jsx("p",{className:"text-sm font-medium text-neutral-500",children:m?"The server has a newer version of your data.":"Your local data is newer than the cloud backup."})]})]}),u.jsxs("div",{className:"p-8 space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{className:"space-y-1 p-3 bg-neutral-50 rounded-2xl border border-neutral-100",children:[u.jsx("p",{className:"text-[9px] font-black uppercase text-neutral-400 tracking-widest",children:"Local Device"}),u.jsx("p",{className:"text-xs font-bold text-neutral-700",children:l})]}),u.jsxs("div",{className:"space-y-1 p-3 bg-neutral-50 rounded-2xl border border-neutral-100",children:[u.jsx("p",{className:"text-[9px] font-black uppercase text-neutral-400 tracking-widest",children:"Cloud Server"}),u.jsx("p",{className:"text-xs font-bold text-neutral-700",children:d})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("button",{onClick:m?a:s,disabled:p,className:`w-full py-4 rounded-2xl font-black text-sm transition-all shadow-lg active:scale-95 flex items-center justify-center space-x-2 ${m?"bg-indigo-600 text-white hover:bg-indigo-700 shadow-indigo-200":"bg-emerald-600 text-white hover:bg-emerald-700 shadow-emerald-200"}`,children:[p?u.jsx(fn,{size:18,className:"animate-spin"}):m?u.jsx(dv,{size:18}):u.jsx(fv,{size:18}),u.jsx("span",{children:m?"RESTORE FROM CLOUD":"PUSH TO CLOUD"})]}),u.jsx("button",{onClick:e,disabled:p,className:"w-full py-4 bg-neutral-100 text-neutral-500 rounded-2xl font-bold text-sm hover:bg-neutral-200 transition-all",children:"Ignore for now"})]})]}),u.jsx("div",{className:"bg-neutral-50 px-8 py-4 border-t border-neutral-100",children:u.jsx("p",{className:"text-[9px] font-medium text-neutral-400 text-center leading-relaxed",children:"Automatic synchronization helps keep your library consistent across all your devices."})})]})})},l5=Fn.lazy(()=>gs(()=>import("./Dashboard-BPzBMppB.js"),__vite__mapDeps([0,1,2,3,4]))),c5=Fn.lazy(()=>gs(()=>import("./ReviewSession-BwtzX9Xt.js"),__vite__mapDeps([5,6]))),u5=Fn.lazy(()=>gs(()=>import("./WordList-B8NQ7dEy.js"),__vite__mapDeps([7,8,9,10,11,12,13,14,15]))),d5=Fn.lazy(()=>gs(()=>import("./ReadingUnitPage-D_8ofh4F.js"),__vite__mapDeps([16,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,1,24])).then(n=>({default:n.ReadingUnitPage}))),f5=Fn.lazy(()=>gs(()=>import("./SettingsView-7YEAhN9z.js"),__vite__mapDeps([25,26,27,23,9,10,11,12,13,14,15])).then(n=>({default:n.SettingsView}))),h5=Fn.lazy(()=>gs(()=>import("./Discover-f8wSngWN.js"),__vite__mapDeps([28,26,27,6,15,4,3,29,12,14,23]))),p5=Fn.lazy(()=>gs(()=>import("./WritingStudioPage-CO-tVnSF.js"),__vite__mapDeps([30,18,15,11,14,31,10,19,20,21])).then(n=>({default:n.WritingStudioPage}))),m5=Fn.lazy(()=>gs(()=>import("./IrregularVerbs-Cpx74j0P.js"),__vite__mapDeps([32,2,15,14,33,31]))),g5=Fn.lazy(()=>gs(()=>import("./MimicPractice-aSl2KjRH.js"),__vite__mapDeps([34,35,15])).then(n=>({default:n.MimicPractice}))),y5=Fn.lazy(()=>gs(()=>import("./LessonLibraryV2-ZPzesHw2.js"),__vite__mapDeps([36,18,15,11,10,21,3,37,19,20,29])).then(n=>({default:n.LessonLibraryV2}))),x5=Fn.lazy(()=>gs(()=>import("./PlanningPage-CC9WF24J.js"),__vite__mapDeps([38,18,15,11,21,22,23,1,24,39])).then(n=>({default:n.PlanningPage}))),b5=Fn.lazy(()=>gs(()=>import("./SpeakingCardPage-NnWHldnB.js"),__vite__mapDeps([40,18,15,11,10,19,20,21,22,23,1,24,39,37,29,35,13])).then(n=>({default:n.SpeakingCardPage}))),v5=Fn.lazy(()=>gs(()=>import("./WordBookPage-BmQ_Jqut.js"),__vite__mapDeps([41,21,15,20,27,33])).then(n=>({default:n.WordBookPage}))),_5=Fn.lazy(()=>gs(()=>import("./CourseList-CXg72ts2.js"),__vite__mapDeps([42,15,17,24])).then(n=>({default:n.CourseList}))),E5=[{id:"DASHBOARD",view:"DASHBOARD",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Mobile%20Phone.png",label:"Dashboard"},{id:"BROWSE",view:"BROWSE",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Books.png",label:"Word Library"},{id:"LESSON",view:"LESSON",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Notebook.png",label:"Knowledge Library"},{id:"COURSE",view:"COURSE",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Graduation%20Cap.png",label:"Course"},{id:"UNIT_LIBRARY",view:"UNIT_LIBRARY",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Open%20Book.png",label:"Reading"},{id:"SPEAKING",view:"SPEAKING",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Microphone.png",label:"Speaking - Listening"},{id:"WRITING",view:"WRITING",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Memo.png",label:"Writing"}],w5=({controller:n,onNavigate:e,onSwitchUser:s})=>{const{currentUser:a,view:o,setView:l,sessionType:d,isSidebarOpen:p,setIsSidebarOpen:m,forceExpandAdd:y,serverStatus:x,handleBackup:v,hasUnsavedChanges:S,nextAutoBackupTime:N,triggerServerBackup:z}=n,[D,j]=M.useState(0);M.useEffect(()=>{if(!N){j(0);return}const F=setInterval(()=>{const H=Date.now(),W=N-H,Q=Math.ceil(W/1e3);j(Math.max(0,Q)),Q<=0&&clearInterval(F)},1e3),G=N-Date.now();return j(Math.max(0,Math.ceil(G/1e3))),()=>clearInterval(F)},[N,x,z,S]);const P=N?`Auto-sync in ${D}s...`:S?"Unsaved Changes - Sync Now":"Sync to Server";return a?u.jsx(u.Fragment,{children:u.jsxs("aside",{className:`fixed md:relative inset-y-0 left-0 z-50 w-64 bg-white border-r border-neutral-200 transform ${p?"translate-x-0":"-translate-x-full"} md:translate-x-0 transition-transform duration-300 ease-in-out flex flex-col p-6`,children:[u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex items-center justify-between gap-2",children:[u.jsxs("div",{className:"flex items-center space-x-3 overflow-hidden flex-1",children:[u.jsx("img",{src:a.avatar,className:"w-10 h-10 rounded-2xl bg-neutral-100 shrink-0"}),u.jsxs("div",{className:"flex-1 overflow-hidden",children:[u.jsx("div",{className:"text-sm font-bold text-neutral-900 truncate",children:a.name}),u.jsx("div",{className:"text-[10px] text-neutral-400 font-bold truncate",children:a.role})]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:s,className:"p-2 rounded-full border-2 border-indigo-100 bg-white text-indigo-500 hover:border-indigo-500 hover:text-indigo-600 hover:bg-indigo-50 transition-all shadow-sm",title:"Switch User",children:u.jsx(GE,{size:16})}),u.jsx("button",{onClick:()=>m(!1),className:"md:hidden p-2 text-neutral-400",children:u.jsx(Rn,{size:24})})]})]}),u.jsxs("div",{className:"mt-4 flex items-center space-x-2",children:[u.jsx("button",{onClick:()=>e("SETTINGS"),className:"p-2 bg-neutral-50 hover:bg-neutral-100 rounded-xl transition-all active:scale-90 border border-neutral-100",title:"Settings",children:u.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Gear.png",alt:"Settings",className:"w-6 h-6 object-contain"})}),u.jsx("button",{onClick:()=>e("PLANNING"),className:"p-2 bg-neutral-50 hover:bg-neutral-100 rounded-xl transition-all active:scale-90 border border-neutral-100",title:"Study Plan",children:u.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Spiral%20Calendar.png",alt:"Planning",className:"w-6 h-6 object-contain"})}),u.jsx("button",{onClick:()=>e("DISCOVER"),className:"p-2 bg-neutral-50 hover:bg-neutral-100 rounded-xl transition-all active:scale-90 border border-neutral-100",title:"Games & Discover",children:u.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Activities/Video%20Game.png",alt:"Games",className:"w-6 h-6 object-contain"})}),x==="connected"&&u.jsxs("button",{onClick:()=>v(),className:`p-2 rounded-xl transition-all active:scale-90 border animate-in fade-in relative ${S?"bg-orange-50 border-orange-200 shadow-[0_0_10px_rgba(249,115,22,0.4)]":"bg-neutral-50 border-neutral-100 hover:bg-neutral-100"}`,title:P,children:[u.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Symbols/Up%20Arrow.png",alt:"Sync",className:"w-6 h-6 object-contain"}),S&&u.jsx("span",{className:`absolute top-0 right-0 w-2.5 h-2.5 rounded-full border-2 border-white -mt-1 -mr-1 ${N?"bg-green-400":"bg-orange-500 animate-pulse"}`})]})]})]}),u.jsxs("nav",{className:"flex-1 overflow-y-auto space-y-1",children:[d&&o!=="REVIEW"&&u.jsx("div",{className:"relative group animate-in fade-in duration-300 mb-1",children:u.jsxs("button",{onClick:()=>e("REVIEW"),className:"w-full flex items-center justify-between px-4 py-3 rounded-xl font-bold text-sm bg-green-500 text-white shadow-lg shadow-green-500/20",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(q2,{size:20}),u.jsx("span",{children:"Study Now"})]}),u.jsxs("div",{className:"relative flex h-3 w-3",children:[u.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-white opacity-75"}),u.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-white"})]})]})}),E5.map(F=>{const G=o===F.view&&(F.id!=="BROWSE"||!y),H=F.id==="SPEAKING"&&o==="SPEAKING";return u.jsx("div",{className:"relative group",children:u.jsx("button",{onClick:()=>e(F.view),className:`w-full flex items-center justify-between px-4 py-3 rounded-xl font-bold text-sm transition-colors ${G||H?"bg-neutral-900 text-white shadow-sm":"text-neutral-500 hover:bg-neutral-100"}`,children:u.jsxs("div",{className:"flex items-center space-x-3",children:[typeof F.icon=="string"?u.jsx("img",{src:F.icon,className:`w-5 h-5 object-contain transition-all ${G||H?"opacity-100":"opacity-70 group-hover:opacity-100"}`,alt:F.label}):u.jsx(F.icon,{size:20}),u.jsx("span",{children:F.label})]})})},F.id)})]})]})}):null},S5=({controller:n})=>{const{view:e,currentUser:s,stats:a,xpToNextLevel:o,wotd:l,setGlobalViewWord:d,setView:p,lastBackupTime:m,handleBackup:y,restoreFromServerAction:x,triggerLocalRestore:v,triggerLocalBackup:S,triggerServerBackup:N,handleNavigateToList:z,sessionWords:D,sessionType:j,sessionFocus:P,updateWord:F,bulkUpdateWords:G,handleSessionComplete:H,gainExperienceAndLevelUp:W,recalculateXpAndLevelUp:Q,handleRetrySession:I,deleteWord:T,bulkDeleteWords:_,startSession:C,initialListFilter:R,setInitialListFilter:L,forceExpandAdd:O,setForceExpandAdd:_e,handleUpdateUser:ye,refreshGlobalStats:B,handleLibraryReset:le,apiUsage:se,xpGained:Z,lastMasteryScoreUpdateTimestamp:Y,isWotdComposed:A,randomizeWotd:V,handleComposeWithWord:q,writingContextWord:X,consumeWritingContext:de,serverStatus:ce,serverUrl:fe,networkMode:ie,isSwitchingServerMode:Ae,handleToggleServerMode:he,planningAction:xe,consumePlanningAction:je,targetGameMode:pe,consumeTargetGameMode:Ie,targetCourseId:Le,consumeTargetCourseId:Te}=n;if(!s)return null;switch(e){case"DASHBOARD":return u.jsx(l5,{userId:s.id,user:s,totalCount:a.total,dueCount:a.due,newCount:a.new,xpToNextLevel:o,wotd:l,onViewWord:d,setView:p,lastBackupTime:m,onBackup:y,onRestore:()=>{},restoreFromServerAction:async()=>await x(),triggerLocalRestore:v,onLocalBackup:S,onServerBackup:N,onNavigateToWordList:z,isWotdComposed:A,onComposeWotd:q,onRandomizeWotd:V,serverStatus:ce,serverUrl:fe,activeServerMode:ie==="outside"?"public":ie,isSwitchingServerMode:Ae,onToggleServerMode:he,onAction:me=>{n.handleSpecialAction(me)},onStartDueReview:n.startDueReviewSession,onStartNewLearn:n.startNewLearnSession});case"WORDBOOK":return u.jsx(v5,{user:s});case"PLANNING":return u.jsx(x5,{user:s,initialAction:xe,onActionConsumed:je});case"REVIEW":return D&&j?u.jsx(c5,{user:s,sessionWords:D,sessionType:j,sessionFocus:P,onUpdate:F,onBulkUpdate:G,onComplete:H,onRetry:I}):null;case"BROWSE":return u.jsx(u5,{user:s,onDelete:async me=>await T(me),onBulkDelete:async me=>await _(me),onUpdate:F,onStartSession:me=>C(me,"custom"),initialFilter:R,onInitialFilterApplied:()=>L(null),forceExpandAdd:O,onExpandAddConsumed:()=>_e(!1),onNavigate:p});case"LESSON":return u.jsx(y5,{user:s,onStartSession:me=>C(me,"custom"),onExit:()=>p("DASHBOARD"),onNavigate:p,onUpdateUser:ye,initialLessonId:n.targetLessonId,onConsumeLessonId:n.consumeTargetLessonId,initialTag:n.targetLessonTag,onConsumeTag:n.consumeTargetLessonTag,initialType:n.targetLessonType,onConsumeType:n.consumeTargetLessonType});case"COURSE":return u.jsx(_5,{initialCourseId:Le,onConsumeInitialCourseId:Te});case"UNIT_LIBRARY":return u.jsx(d5,{user:s,onStartSession:me=>C(me,"new_study"),onUpdateUser:ye});case"SETTINGS":return u.jsx(f5,{user:s,onUpdateUser:ye,onRefresh:B,onNuke:le,apiUsage:se});case"DISCOVER":return u.jsx(h5,{user:s,xpToNextLevel:o,totalWords:a.total,onExit:()=>p("DASHBOARD"),onGainXp:W,onRecalculateXp:Q,xpGained:Z,onStartSession:C,onUpdateUser:ye,lastMasteryScoreUpdateTimestamp:Y,onBulkUpdate:G,initialGameMode:pe,onConsumeGameMode:Ie});case"SPEAKING":return u.jsx(b5,{user:s,onNavigate:p});case"WRITING":return u.jsx(p5,{controller:n,user:s,initialContextWord:X,onConsumeContext:de});case"IRREGULAR_VERBS":return u.jsx(m5,{user:s,onGlobalViewWord:d});case"MIMIC":return u.jsx(g5,{});default:return u.jsxs("div",{children:["Unknown view: ",e]})}},T5=({controller:n})=>{const{view:e,isSidebarOpen:s,setIsSidebarOpen:a,globalViewWord:o,setGlobalViewWord:l,updateWord:d,gainExperienceAndLevelUp:p,sessionType:m,clearSessionState:y,setView:x,setForceExpandAdd:v,currentUser:S,stats:N,lastBackupTime:z,isAutoRestoreOpen:D,setIsAutoRestoreOpen:j,autoRestoreCandidates:P,restoreFromServerAction:F,handleNewUserSetup:G,handleLocalRestoreSetup:H,handleSwitchUser:W,syncPrompt:Q,setSyncPrompt:I,isSyncing:T,handleSyncPush:_,handleSyncRestore:C,sslIssueUrl:R,setSslIssueUrl:L,retrySslConnection:O}=n,[_e,ye]=M.useState(null),[B,le]=M.useState({isOpen:!1,targetView:null,andThen:void 0}),[se,Z]=M.useState({isOpen:!1,targetView:null,action:void 0}),Y=(fe,ie)=>{if(n.hasWritingUnsavedChanges){Z({isOpen:!0,targetView:fe,action:ie});return}m&&fe!=="REVIEW"?le({isOpen:!0,targetView:fe,andThen:ie}):(v(!!ie),x(fe),a(!1))},A=()=>{B.targetView?(y(),x(B.targetView),B.andThen?B.andThen():v(!1),a(!1)):B.andThen&&(y(),B.andThen()),le({isOpen:!1,targetView:null,andThen:void 0})},V=()=>le({isOpen:!1,targetView:null,andThen:void 0}),q=fe=>{l(null),ye(fe)},X=fe=>{d(fe),ye(null)},[de,ce]=M.useState(!1);return u.jsxs("div",{className:"min-h-screen bg-neutral-50 md:flex",children:[u.jsx(w5,{controller:n,onNavigate:Y,onSwitchUser:W}),u.jsx("div",{className:`fixed inset-0 bg-black/30 z-40 md:hidden ${s?"block":"hidden"}`,onClick:()=>a(!1)}),u.jsxs("main",{className:`flex-1 overflow-y-auto relative ${e==="MIMIC"?"p-0":"p-6 md:p-10"}`,children:[u.jsx("button",{onClick:()=>a(!0),className:"md:hidden fixed top-4 left-4 p-2 bg-white/80 backdrop-blur-sm rounded-full shadow-md z-30",children:u.jsx(fI,{size:24})}),u.jsx(M.Suspense,{fallback:u.jsx("div",{className:"flex justify-center p-20",children:u.jsx(fn,{className:"animate-spin text-neutral-300",size:32})}),children:u.jsx(S5,{controller:n})})]}),S&&u.jsx(a5,{user:S,stats:N,currentView:e,lastBackupTime:z,onNavigate:n.handleSpecialAction,onViewWord:l,isAnyModalOpen:!!o||!!_e}),o&&u.jsx(z4,{word:o,onClose:()=>l(null),onNavigateToWord:l,onEditRequest:q,onUpdate:d,onGainXp:p}),_e&&u.jsx(Hk,{user:n.currentUser,word:_e,onSave:X,onClose:()=>ye(null),onSwitchToView:fe=>{ye(null),l(fe)}}),u.jsx(bg,{isOpen:B.isOpen,title:"End Current Session?",message:"Navigating away will end your current study session. Are you sure you want to continue?",confirmText:"End Session",isProcessing:!1,onConfirm:A,onClose:V,icon:u.jsx(kg,{size:40,className:"text-orange-50"}),confirmButtonClass:"bg-orange-600 text-white hover:bg-orange-700 shadow-orange-200"}),u.jsx(bg,{isOpen:se.isOpen,title:"Unsaved Writing Changes",message:"You have unsaved writing changes. Leave without saving?",confirmText:"Leave",isProcessing:!1,confirmButtonClass:"bg-red-600 text-white hover:bg-red-700 shadow-red-200",onConfirm:()=>{se.targetView&&(n.setHasWritingUnsavedChanges(!1),se.action?se.action():v(!1),x(se.targetView),a(!1)),Z({isOpen:!1,targetView:null,action:void 0})},onClose:()=>Z({isOpen:!1,targetView:null,action:void 0})}),u.jsx(i5,{isOpen:D,onClose:()=>j(!1),backups:P,onRestore:fe=>{ce(!0),F(fe).finally(()=>ce(!1))},isRestoring:de,title:"User Selection",description:"We found existing profiles on the server. Select yours to restore.",onNewUser:G,onLocalRestore:H}),Q&&u.jsx(o5,{isOpen:Q.isOpen,onClose:()=>I(null),onPush:_,onRestore:C,type:Q.type,localDate:Q.localDate,serverDate:Q.serverDate,isProcessing:T}),R&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[100]",children:u.jsxs("div",{className:"bg-white rounded-2xl p-6 w-[440px] shadow-2xl border border-red-100",children:[u.jsx("h2",{className:"text-lg font-bold text-red-600 mb-2",children:"SSL Certificate Required"}),u.jsx("p",{className:"text-sm text-neutral-600 mb-4",children:"Cannot securely connect to:"}),u.jsx("div",{className:"text-xs font-mono bg-neutral-100 p-2 rounded mb-4 break-all",children:R}),u.jsxs("p",{className:"text-sm text-neutral-600 mb-6",children:["Your browser blocked this connection because the SSL certificate is not trusted yet.",u.jsx("br",{}),u.jsx("br",{}),"Please open the link, trust the certificate, then come back and press Retry."]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>L(null),className:"px-3 py-2 rounded-lg bg-neutral-200 hover:bg-neutral-300 text-sm",children:"Cancel"}),u.jsx("button",{onClick:()=>window.open(R,"_blank"),className:"px-3 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm",children:"Open & Trust"}),u.jsx("button",{onClick:async()=>{L(null),await O()},className:"px-3 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 text-sm",children:"Retry"})]})]})})]})},A5=()=>u.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-neutral-950/90 backdrop-blur-md animate-in fade-in duration-500",children:u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[3rem] shadow-2xl border-2 border-neutral-100 overflow-hidden animate-in zoom-in-95 duration-500",children:[u.jsxs("div",{className:"bg-neutral-900 p-8 text-white text-center space-y-4",children:[u.jsxs("div",{className:"mx-auto w-20 h-20 bg-white/10 rounded-full flex items-center justify-center border-4 border-white/20 mb-2 relative",children:[u.jsx(tI,{size:40,className:"animate-pulse"}),u.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 rounded-full p-1 border-2 border-neutral-900",children:u.jsx(Ca,{size:14})})]}),u.jsx("h3",{className:"text-2xl font-black tracking-tighter uppercase",children:"Connection Lost"})]}),u.jsxs("div",{className:"p-10 text-center space-y-6",children:[u.jsxs("div",{className:"space-y-3",children:[u.jsx("p",{className:"text-lg font-black text-neutral-900 leading-tight",children:"Database link interrupted"}),u.jsxs("p",{className:"text-neutral-500 text-sm leading-relaxed font-medium",children:["The connection to your local storage was closed unexpectedly by the browser.",u.jsx("br",{}),u.jsx("br",{}),"Don't worry, ",u.jsx("strong",{children:"your data is safe"}),". Refreshing the application will restore the connection immediately."]})]}),u.jsxs("button",{onClick:()=>{localStorage.setItem("vocab_pro_auto_restore","true"),window.location.reload()},className:"w-full py-5 bg-neutral-900 text-white rounded-2xl font-black text-sm hover:bg-neutral-800 transition-all shadow-xl shadow-neutral-900/20 active:scale-95 flex items-center justify-center space-x-3",children:[u.jsx(Cl,{size:20}),u.jsx("span",{children:"REFRESH APPLICATION"})]})]}),u.jsx("div",{className:"bg-neutral-50 px-8 py-4 flex items-center justify-center space-x-2 border-t border-neutral-100",children:u.jsx("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Safe Persistent Storage"})})]})}),I5=()=>{const n=Ck(),{isLoaded:e,isResetting:s,resetStep:a,view:o,currentUser:l,handleLogin:d}=n,[p,m]=M.useState(!1);return M.useEffect(()=>{$E();const y=()=>m(!0);return window.addEventListener("db-connection-lost",y),()=>window.removeEventListener("db-connection-lost",y)},[]),p?u.jsx(A5,{}):e?s?u.jsxs("div",{className:"h-screen w-screen flex flex-col items-center justify-center bg-white space-y-4",children:[u.jsx(fn,{size:40,className:"text-neutral-900 animate-spin"}),u.jsx("p",{className:"text-sm font-bold text-neutral-500",children:a})]}):o==="AUTH"||!l?u.jsx(qI,{onLogin:d}):u.jsx(T5,{controller:n}):u.jsxs("div",{className:"h-screen w-screen flex flex-col items-center justify-center bg-white space-y-4",children:[u.jsx(Rl,{size:40,className:"text-neutral-900"}),u.jsx("p",{className:"text-sm font-bold text-neutral-500",children:"Vocab Pro"})]})},N5=()=>{const[n,e]=M.useState(0),s=M.useCallback(()=>{e(a=>a+1)},[]);return M.useEffect(()=>(window.addEventListener("vocab-pro-force-ui-reload",s),()=>window.removeEventListener("vocab-pro-force-ui-reload",s)),[s]),u.jsx($I,{children:u.jsx(I5,{},n)})},ZT=document.getElementById("root");if(!ZT)throw new Error("Could not find root element to mount to");const C5=P2.createRoot(ZT);C5.render(u.jsx(Fn.StrictMode,{children:u.jsx(N5,{})}));export{mu as $,H2 as A,q2 as B,K2 as C,IE as D,fn as E,aI as F,DE as G,ns as H,su as I,NE as J,qc as K,uI as L,To as M,Er as N,z4 as O,hI as P,Hk as Q,gI as R,Rl as S,P4 as T,Z2 as U,wr as V,qE as W,Rn as X,oI as Y,Af as Z,ea as _,fv as a,Sf as a$,Gw as a0,Ns as a1,Kg as a2,L5 as a3,Bk as a4,vN as a5,qm as a6,Ft as a7,kr as a8,jr as a9,bg as aA,pu as aB,V5 as aC,dN as aD,Pk as aE,Vk as aF,jk as aG,AI as aH,ME as aI,GE as aJ,Bn as aK,Y2 as aL,PE as aM,$k as aN,Wk as aO,qr as aP,kg as aQ,Cl as aR,zE as aS,kE as aT,Qk as aU,tN as aV,qw as aW,Yp as aX,$p as aY,Tf as aZ,VE as a_,$w as aa,pN as ab,eM as ac,SI as ad,Kr as ae,tM as af,Zg as ag,du as ah,of as ai,KE as aj,j5 as ak,k5 as al,O5 as am,D5 as an,M5 as ao,Cf as ap,gN as aq,mN as ar,BE as as,iI as at,Ca as au,yg as av,Ol as aw,kI as ax,jg as ay,wI as az,CE as b,Nw as b$,Cg as b0,F2 as b1,Og as b2,uN as b3,LE as b4,HE as b5,cI as b6,EI as b7,RE as b8,Q2 as b9,pv as bA,B1 as bB,N0 as bC,I0 as bD,Mm as bE,Rg as bF,fI as bG,Xk as bH,Y5 as bI,X5 as bJ,K5 as bK,Z5 as bL,rI as bM,_I as bN,AT as bO,F5 as bP,nI as bQ,TT as bR,JL as bS,ST as bT,yl as bU,G5 as bV,B5 as bW,H5 as bX,q5 as bY,jE as bZ,UE as b_,R5 as ba,Yc as bb,hv as bc,xT as bd,$2 as be,C0 as bf,z5 as bg,$5 as bh,M1 as bi,U5 as bj,MI as bk,hu as bl,Q5 as bm,P5 as bn,W5 as bo,W2 as bp,X2 as bq,ts as br,kk as bs,VI as bt,UI as bu,nM as bv,vw as bw,PI as bx,Dm as by,pI as bz,Se as c,Cw as c0,zI as c1,OE as d,FE as e,wf as f,af as g,vI as h,Ag as i,u as j,wt as k,qg as l,Nf as m,Gg as n,Vg as o,zg as p,Bg as q,M as r,DI as s,di as t,Qg as u,Zw as v,Nl as w,Lt as x,Fn as y,Ng as z};
