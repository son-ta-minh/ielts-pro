typeof window<"u"&&(window.checkMarkdownQuiz=s=>{const n=s.getAttribute("data-answer");if(!n)return;const r=s.value.trim().toLowerCase()===n.trim().toLowerCase();s.classList.remove("border-neutral-300","text-neutral-900","focus:border-indigo-600"),s.classList.remove("border-green-500","text-green-700","bg-green-50"),s.classList.remove("border-red-500","text-red-700","bg-red-50"),r?s.classList.add("border-green-500","text-green-700","bg-green-50"):s.classList.add("border-red-500","text-red-700","bg-red-50")},window.checkDropdownQuiz=s=>{const n=s.parentElement;if(!n)return;const i=n.querySelector("select");if(!i)return;const r=i.getAttribute("data-answer"),a=i.value;if(!a)return;const e=a===r;if(i.disabled=!0,s.disabled=!0,s.classList.add("opacity-0","pointer-events-none"),i.classList.remove("border-neutral-300","text-neutral-900","focus:border-indigo-600"),i.classList.remove("bg-white"),e)i.classList.add("border-green-500","text-green-700","bg-green-50","font-bold");else{i.classList.add("border-red-500","text-red-700","bg-red-50","line-through");const o=document.createElement("span");o.className="ml-2 text-xs font-bold text-green-600 bg-green-50 px-1.5 py-0.5 rounded border border-green-200 animate-in fade-in",o.innerText=r||"",n.appendChild(o)}},window.checkMultiChoice=s=>{var e;const n=s.parentElement;if(!n)return;const i=n.getAttribute("data-answer"),r=(e=s.textContent)==null?void 0:e.trim();n.querySelectorAll("button").forEach(o=>{var t;o.disabled=!0,o.classList.add("opacity-50","cursor-not-allowed"),((t=o.textContent)==null?void 0:t.trim())===i&&(o.classList.remove("bg-white","text-neutral-700","opacity-50"),o.classList.add("bg-green-500","text-white","border-green-600"))}),r===i?(s.classList.remove("opacity-50"),s.classList.add("ring-2","ring-green-300")):(s.classList.remove("bg-white","text-neutral-700","opacity-50"),s.classList.add("bg-red-500","text-white","border-red-600"))});const x=s=>{if(!s[0].trim().startsWith("|"))return null;const n=[];for(const l of s)if(l.trim().startsWith("|"))n.push(l);else break;if(n.length===0)return null;const i=l=>{const c=l.split("|");return l.trim().startsWith("|")&&c.shift(),l.trim().endsWith("|")&&c.pop(),c.map(d=>d.trim())},r=/^\|?(\s*:?-+:?\s*\|)+\s*$/;let a=!1;n.length>1&&r.test(n[1].trim())&&(a=!0);let e='<div class="overflow-x-auto my-4 border border-neutral-200 rounded-xl shadow-sm"><table class="w-full text-sm text-left border-collapse">';const o=i(n[0]);e+='<thead class="bg-neutral-50 text-neutral-900 uppercase font-bold text-xs"><tr>',o.forEach(l=>e+=`<th class="px-6 py-3 border-b border-neutral-200 min-w-[100px]">${l}</th>`),e+="</tr></thead>",e+='<tbody class="divide-y divide-neutral-100 bg-white">';const t=a?2:1;for(let l=t;l<n.length;l++){const c=i(n[l]);e+='<tr class="hover:bg-neutral-50/50 transition-colors">';for(let d=0;d<o.length;d++){const h=c[d]||"";e+=`<td class="px-6 py-4 font-medium text-neutral-600 align-top">${h}</td>`}e+="</tr>"}return e+="</tbody></table></div>",{html:e,consumed:n.length}},f=s=>s.replace(/\[HIDDEN:\s*(.*?)\]/gi,(n,i)=>`<button type="button" onclick="this.outerHTML='<span class=\\'px-1.5 py-0.5 bg-green-50 border border-green-200 text-green-800 rounded-md text-sm font-bold animate-in fade-in zoom-in-95 inline-block align-baseline mx-1\\'>${i.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"\\'")}</span>'" class="inline-flex flex-nowrap whitespace-nowrap items-center gap-1.5 px-2 py-0.5 bg-indigo-50 hover:bg-indigo-100 text-indigo-600 rounded-md text-[10px] font-black uppercase tracking-wider transition-colors select-none border border-indigo-100 shadow-sm align-middle my-0.5 mx-1"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="shrink-0"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>Reveal</button>`),k=s=>s.replace(/\[Quiz:\s*(.*?)\]/gi,(n,i)=>{const r=i.trim(),a=Math.max(3,r.length);return`<span class="inline-flex items-center gap-1 align-middle mx-1 whitespace-nowrap"><input type="text" data-answer="${r.replace(/"/g,"&quot;")}" placeholder="?" class="border-b-2 border-neutral-300 bg-transparent text-center font-bold text-neutral-900 outline-none focus:border-indigo-600 transition-all rounded-t-md px-1 py-0.5 text-sm" style="width: ${a}ch; min-width: 40px;" onkeydown="if(event.key==='Enter') window.checkMarkdownQuiz(this)" /><button onclick="window.checkMarkdownQuiz(this.previousElementSibling)" class="p-1 text-neutral-400 hover:text-indigo-600 transition-colors bg-neutral-100 hover:bg-indigo-50 rounded-full shadow-sm" title="Check Answer"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg></button></span>`}),v=s=>s.replace(/\[Select:\s*(.*?)\]/gi,(n,i)=>{const r=i.split("|").map(t=>t.trim()).filter(t=>t.length>0);if(r.length<2)return`[Invalid Select: ${i}]`;const a=r[0],e=[...r];for(let t=e.length-1;t>0;t--){const l=Math.floor(Math.random()*(t+1));[e[t],e[l]]=[e[l],e[t]]}let o='<span class="inline-flex items-center gap-1 align-middle mx-1 whitespace-nowrap">';return o+=`<select data-answer="${a.replace(/"/g,"&quot;")}" class="border-b-2 border-neutral-300 bg-transparent font-bold text-neutral-900 outline-none focus:border-indigo-600 transition-all rounded-t-md px-2 py-0.5 text-sm cursor-pointer hover:bg-neutral-50 appearance-none pr-6 relative" style="min-width: 80px;">`,o+='<option value="" disabled selected>Select...</option>',e.forEach(t=>{o+=`<option value="${t.replace(/"/g,"&quot;")}">${t}</option>`}),o+="</select>",o+='<button onclick="window.checkDropdownQuiz(this)" class="p-1 text-neutral-400 hover:text-indigo-600 transition-colors bg-neutral-100 hover:bg-indigo-50 rounded-full shadow-sm" title="Check Answer"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg></button>',o+="</span>",o}),y=s=>s.replace(/\[Multi:\s*(.*?)\]/gi,(n,i)=>{const r=i.split("|").map(t=>t.trim()).filter(t=>t.length>0);if(r.length<2)return`[Invalid Multi: ${i}]`;const a=r[0],e=[...r];for(let t=e.length-1;t>0;t--){const l=Math.floor(Math.random()*(t+1));[e[t],e[l]]=[e[l],e[t]]}let o=`<span class="inline-flex flex-wrap items-center gap-1.5 align-middle mx-1" data-answer="${a.replace(/"/g,"&quot;")}">`;return e.forEach(t=>{o+=`<button onclick="window.checkMultiChoice(this)" class="px-2 py-1 bg-white border border-neutral-200 text-neutral-700 rounded-md text-xs font-bold hover:bg-neutral-50 hover:border-neutral-300 transition-all shadow-sm select-none">${t}</button>`}),o+="</span>",o}),$=s=>{const n=/\[Audio-(VN|EN)\]([\s\S]*?)\[\/\]/g;return s.replace(n,(i,r,a)=>`<button onclick="window.handleLessonSpeak('${a.replace(/\[HIDDEN:.*?\]/gi,"").replace(/\[Quiz:.*?\]/gi,"").replace(/\[Select:.*?\]/gi,"").replace(/\[Multi:.*?\]/gi,"").replace(/[#*`_~[\]()]/g,"").replace(/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}]/gu,"").trim().replace(/'/g,"\\'")}')" class="inline-flex items-center justify-center w-6 h-6 mr-1.5 bg-indigo-600 text-white hover:bg-indigo-700 rounded-md transition-all active:scale-90 align-middle shadow-sm" title="Listen"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg></button>`+a.trim())},M=s=>{if(!s)return"";let n=$(s);n=k(n),n=v(n),n=y(n),n=f(n);const i=n.split(`
`),r=[],a=[],e=(o=0)=>{for(;a.length>o;){const t=a.pop();r.push(t.type==="ul"?"</ul>":"</ol>")}};for(let o=0;o<i.length;o++){const t=i[o],l=t.trim();if(!l&&a.length===0){r.push('<br class="block my-2" />');continue}const c=x(i.slice(o));if(c){e(0),r.push(c.html),o+=c.consumed-1;continue}if(/^([-*_])\s*(\1\s*){2,}$/.test(l)){e(0),r.push('<hr class="my-6 border-t-2 border-neutral-100" />');continue}if(l.startsWith("# ")){e(0),r.push(`<h1 class="text-3xl font-black text-neutral-900 mb-4 mt-8 pb-2 border-b border-neutral-100 leading-tight">${l.substring(2)}</h1>`);continue}if(l.startsWith("## ")){e(0),r.push(`<h2 class="text-xl font-extrabold text-neutral-800 mb-3 mt-6 leading-tight">${l.substring(3)}</h2>`);continue}if(l.startsWith("### ")){e(0),r.push(`<h3 class="text-lg font-bold text-neutral-700 mb-2 mt-4 leading-tight">${l.substring(4)}</h3>`);continue}if(l.startsWith("> ")){e(0),r.push(`<blockquote class="border-l-4 border-amber-400 bg-amber-50 pl-4 py-3 pr-2 my-4 rounded-r-lg text-sm text-neutral-700 font-medium italic shadow-sm">${l.substring(2)}</blockquote>`);continue}const d=l.match(/^\[(?!(HIDDEN:|Quiz:|Select:|QUIZ:|Multi:|Audio-|(\/\])))(.*)\]$/);if(d){e(0);const u='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="shrink-0 mt-0.5 text-sky-500"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.8 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>',b=d[3].trim();r.push(`
                <div class="flex items-start gap-3 my-4 p-4 bg-sky-50 border-l-4 border-sky-400 rounded-r-lg shadow-sm">
                    ${u}
                    <div class="text-sm text-sky-900 font-medium leading-relaxed">
                        ${b}
                    </div>
                </div>
            `);continue}const h=t.match(/^(\s*)/),p=h?h[0].length:0,g=t.match(/^\s*[-*]\s+(.*)/),m=t.match(/^\s*(\d+)\.\s+(.*)/);if(g||m){const u=g?"ul":"ol",b=g?g[1]:m[2],w=m?m[1]:void 0;if(a.length===0||p>a[a.length-1].indent)r.push(u==="ul"?'<ul class="list-disc list-outside pl-5 my-3 space-y-1 text-neutral-700 marker:text-neutral-400">':'<ol class="list-decimal list-outside pl-5 my-3 space-y-1 text-neutral-700 marker:font-bold marker:text-neutral-500">'),a.push({type:u,indent:p});else if(p<a[a.length-1].indent)for(;a.length>0&&p<a[a.length-1].indent;)e(a.length-1);u==="ol"&&w?r.push(`<li value="${w}" class="pl-1">${b}</li>`):r.push(`<li class="pl-1">${b}</li>`);continue}l!==""&&(e(0),r.push(`<p class="mb-2 leading-relaxed text-neutral-600">${t}</p>`))}return e(0),r.join("").replace(/!\[(.*?)\]\((.*?)\)/g,'<img alt="$1" src="$2" class="max-w-full h-auto rounded-lg my-4 shadow-md border border-neutral-200" />').replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="text-indigo-600 font-bold hover:underline">$1</a>').replace(/\*\*(.*?)\*\*/g,'<strong class="font-black text-neutral-900">$1</strong>').replace(/\*(.*?)\*/g,'<span class="italic font-normal text-inherit">$1</span>').replace(/`([^`]+)`/g,'<code class="bg-neutral-100 text-pink-600 px-1.5 py-0.5 rounded text-xs font-mono font-bold border border-neutral-200">$1</code>')};export{M as p};
