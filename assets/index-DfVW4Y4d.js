const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-x7Qwc0o1.js","assets/list-todo-CPVusz-e.js","assets/file-clock-PSODHXwh.js","assets/split-DDyzIxSm.js","assets/keyboard-C545HiW-.js","assets/ReviewSession-2iUmKEwF.js","assets/trophy-DNpGRLN1.js","assets/WordList-BEbbkW6y.js","assets/WordTable-B0iUP2Pz.js","assets/WordTable_UI-C8sxsxZ6.js","assets/TagBrowser-C6SqcjC0.js","assets/tag-D269KBVn.js","assets/columns-2-DLW5DzJy.js","assets/calendar-CKMjJ1Lf.js","assets/square-check-big-DVtDNsZN.js","assets/chevron-left-Vm6DOqvS.js","assets/ReadingUnitPage-D6Bb8i4w.js","assets/minus-Cs3xUGx4.js","assets/ResourceActions-B_FL7AjW.js","assets/ViewMenu-DrW5tbmi.js","assets/filter-DIpV-Tz4.js","assets/UniversalCard-jnpqWVTZ.js","assets/FileSelector-7Slxiq_7.js","assets/server-CtZZdAE-.js","assets/music-C22fQTx-.js","assets/SettingsView-DGyr3oc7.js","assets/AvatarSelectionModal-DME0R6y4.js","assets/palette-BFqow9Vr.js","assets/Discover-CSgBxAjd.js","assets/layout-grid-DDOLql7W.js","assets/WritingStudioPage-BjBhwJFL.js","assets/chart-no-axes-column-increasing-CPifqu4S.js","assets/IrregularVerbs-B9LU3jZq.js","assets/MimicPractice-BD9accSx.js","assets/ear-C4Vc6AZc.js","assets/LessonLibraryV2-BhYurQ3Y.js","assets/headphones-BOKMQBuO.js","assets/getGenerateLessonTestPrompt-CGFp5VVS.js","assets/PlanningPage-DFZAzV2_.js","assets/grip-vertical-D-Se2GUC.js","assets/SpeakingCardPage-qFSWcOwx.js","assets/WordBookPage-DFlkEPu_.js","assets/CourseList-B2vNjzmq.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}})();function CE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Hp={exports:{}},jc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rv;function M2(){if(rv)return jc;rv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function s(a,o,l){var d=null;if(l!==void 0&&(d=""+l),o.key!==void 0&&(d=""+o.key),"key"in o){l={};for(var p in o)p!=="key"&&(l[p]=o[p])}else l=o;return o=l.ref,{$$typeof:n,type:a,key:d,ref:o!==void 0?o:null,props:l}}return jc.Fragment=e,jc.jsx=s,jc.jsxs=s,jc}var av;function D2(){return av||(av=1,Hp.exports=M2()),Hp.exports}var u=D2(),Gp={exports:{}},at={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iv;function U2(){if(iv)return at;iv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),d=Symbol.for("react.context"),p=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),S=Symbol.iterator;function I(j){return j===null||typeof j!="object"?null:(j=S&&j[S]||j["@@iterator"],typeof j=="function"?j:null)}var z={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U=Object.assign,C={};function M(j,V,$){this.props=j,this.context=V,this.refs=C,this.updater=$||z}M.prototype.isReactComponent={},M.prototype.setState=function(j,V){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,V,"setState")},M.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function B(){}B.prototype=M.prototype;function F(j,V,$){this.props=j,this.context=V,this.refs=C,this.updater=$||z}var H=F.prototype=new B;H.constructor=F,U(H,M.prototype),H.isPureReactComponent=!0;var q=Array.isArray;function Y(){}var A={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function E(j,V,$){var Z=$.ref;return{$$typeof:n,type:j,key:V,ref:Z!==void 0?Z:null,props:$}}function R(j,V){return E(j.type,V,j.props)}function N(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function D(j){var V={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function($){return V[$]})}var O=/\/+/g;function ve(j,V){return typeof j=="object"&&j!==null&&j.key!=null?D(""+j.key):V.toString(36)}function ye(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(Y,Y):(j.status="pending",j.then(function(V){j.status==="pending"&&(j.status="fulfilled",j.value=V)},function(V){j.status==="pending"&&(j.status="rejected",j.reason=V)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function G(j,V,$,Z,ee){var pe=typeof j;(pe==="undefined"||pe==="boolean")&&(j=null);var ie=!1;if(j===null)ie=!0;else switch(pe){case"bigint":case"string":case"number":ie=!0;break;case"object":switch(j.$$typeof){case n:case e:ie=!0;break;case x:return ie=j._init,G(ie(j._payload),V,$,Z,ee)}}if(ie)return ee=ee(j),ie=Z===""?"."+ve(j,0):Z,q(ee)?($="",ie!=null&&($=ie.replace(O,"$&/")+"/"),G(ee,V,$,"",function(fe){return fe})):ee!=null&&(N(ee)&&(ee=R(ee,$+(ee.key==null||j&&j.key===ee.key?"":(""+ee.key).replace(O,"$&/")+"/")+ie)),V.push(ee)),1;ie=0;var ce=Z===""?".":Z+":";if(q(j))for(var De=0;De<j.length;De++)Z=j[De],pe=ce+ve(Z,De),ie+=G(Z,V,$,pe,ee);else if(De=I(j),typeof De=="function")for(j=De.call(j),De=0;!(Z=j.next()).done;)Z=Z.value,pe=ce+ve(Z,De++),ie+=G(Z,V,$,pe,ee);else if(pe==="object"){if(typeof j.then=="function")return G(ye(j),V,$,Z,ee);throw V=String(j),Error("Objects are not valid as a React child (found: "+(V==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":V)+"). If you meant to render a collection of children, use an array instead.")}return ie}function ae(j,V,$){if(j==null)return j;var Z=[],ee=0;return G(j,Z,"","",function(pe){return V.call($,pe,ee++)}),Z}function ne(j){if(j._status===-1){var V=j._result;V=V(),V.then(function($){(j._status===0||j._status===-1)&&(j._status=1,j._result=$)},function($){(j._status===0||j._status===-1)&&(j._status=2,j._result=$)}),j._status===-1&&(j._status=0,j._result=V)}if(j._status===1)return j._result.default;throw j._result}var Q=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var V=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent(V))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)},X={map:ae,forEach:function(j,V,$){ae(j,function(){V.apply(this,arguments)},$)},count:function(j){var V=0;return ae(j,function(){V++}),V},toArray:function(j){return ae(j,function(V){return V})||[]},only:function(j){if(!N(j))throw Error("React.Children.only expected to receive a single React element child.");return j}};return at.Activity=v,at.Children=X,at.Component=M,at.Fragment=s,at.Profiler=o,at.PureComponent=F,at.StrictMode=a,at.Suspense=m,at.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,at.__COMPILER_RUNTIME={__proto__:null,c:function(j){return A.H.useMemoCache(j)}},at.cache=function(j){return function(){return j.apply(null,arguments)}},at.cacheSignal=function(){return null},at.cloneElement=function(j,V,$){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var Z=U({},j.props),ee=j.key;if(V!=null)for(pe in V.key!==void 0&&(ee=""+V.key),V)!T.call(V,pe)||pe==="key"||pe==="__self"||pe==="__source"||pe==="ref"&&V.ref===void 0||(Z[pe]=V[pe]);var pe=arguments.length-2;if(pe===1)Z.children=$;else if(1<pe){for(var ie=Array(pe),ce=0;ce<pe;ce++)ie[ce]=arguments[ce+2];Z.children=ie}return E(j.type,ee,Z)},at.createContext=function(j){return j={$$typeof:d,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:l,_context:j},j},at.createElement=function(j,V,$){var Z,ee={},pe=null;if(V!=null)for(Z in V.key!==void 0&&(pe=""+V.key),V)T.call(V,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(ee[Z]=V[Z]);var ie=arguments.length-2;if(ie===1)ee.children=$;else if(1<ie){for(var ce=Array(ie),De=0;De<ie;De++)ce[De]=arguments[De+2];ee.children=ce}if(j&&j.defaultProps)for(Z in ie=j.defaultProps,ie)ee[Z]===void 0&&(ee[Z]=ie[Z]);return E(j,pe,ee)},at.createRef=function(){return{current:null}},at.forwardRef=function(j){return{$$typeof:p,render:j}},at.isValidElement=N,at.lazy=function(j){return{$$typeof:x,_payload:{_status:-1,_result:j},_init:ne}},at.memo=function(j,V){return{$$typeof:y,type:j,compare:V===void 0?null:V}},at.startTransition=function(j){var V=A.T,$={};A.T=$;try{var Z=j(),ee=A.S;ee!==null&&ee($,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(Y,Q)}catch(pe){Q(pe)}finally{V!==null&&$.types!==null&&(V.types=$.types),A.T=V}},at.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},at.use=function(j){return A.H.use(j)},at.useActionState=function(j,V,$){return A.H.useActionState(j,V,$)},at.useCallback=function(j,V){return A.H.useCallback(j,V)},at.useContext=function(j){return A.H.useContext(j)},at.useDebugValue=function(){},at.useDeferredValue=function(j,V){return A.H.useDeferredValue(j,V)},at.useEffect=function(j,V){return A.H.useEffect(j,V)},at.useEffectEvent=function(j){return A.H.useEffectEvent(j)},at.useId=function(){return A.H.useId()},at.useImperativeHandle=function(j,V,$){return A.H.useImperativeHandle(j,V,$)},at.useInsertionEffect=function(j,V){return A.H.useInsertionEffect(j,V)},at.useLayoutEffect=function(j,V){return A.H.useLayoutEffect(j,V)},at.useMemo=function(j,V){return A.H.useMemo(j,V)},at.useOptimistic=function(j,V){return A.H.useOptimistic(j,V)},at.useReducer=function(j,V,$){return A.H.useReducer(j,V,$)},at.useRef=function(j){return A.H.useRef(j)},at.useState=function(j){return A.H.useState(j)},at.useSyncExternalStore=function(j,V,$){return A.H.useSyncExternalStore(j,V,$)},at.useTransition=function(){return A.H.useTransition()},at.version="19.2.4",at}var ov;function Ng(){return ov||(ov=1,Gp.exports=U2()),Gp.exports}var L=Ng();const qn=CE(L);var qp={exports:{}},kc={},$p={exports:{}},Yp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lv;function P2(){return lv||(lv=1,(function(n){function e(G,ae){var ne=G.length;G.push(ae);e:for(;0<ne;){var Q=ne-1>>>1,X=G[Q];if(0<o(X,ae))G[Q]=ae,G[ne]=X,ne=Q;else break e}}function s(G){return G.length===0?null:G[0]}function a(G){if(G.length===0)return null;var ae=G[0],ne=G.pop();if(ne!==ae){G[0]=ne;e:for(var Q=0,X=G.length,j=X>>>1;Q<j;){var V=2*(Q+1)-1,$=G[V],Z=V+1,ee=G[Z];if(0>o($,ne))Z<X&&0>o(ee,$)?(G[Q]=ee,G[Z]=ne,Q=Z):(G[Q]=$,G[V]=ne,Q=V);else if(Z<X&&0>o(ee,ne))G[Q]=ee,G[Z]=ne,Q=Z;else break e}}return ae}function o(G,ae){var ne=G.sortIndex-ae.sortIndex;return ne!==0?ne:G.id-ae.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var m=[],y=[],x=1,v=null,S=3,I=!1,z=!1,U=!1,C=!1,M=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;function H(G){for(var ae=s(y);ae!==null;){if(ae.callback===null)a(y);else if(ae.startTime<=G)a(y),ae.sortIndex=ae.expirationTime,e(m,ae);else break;ae=s(y)}}function q(G){if(U=!1,H(G),!z)if(s(m)!==null)z=!0,Y||(Y=!0,D());else{var ae=s(y);ae!==null&&ye(q,ae.startTime-G)}}var Y=!1,A=-1,T=5,E=-1;function R(){return C?!0:!(n.unstable_now()-E<T)}function N(){if(C=!1,Y){var G=n.unstable_now();E=G;var ae=!0;try{e:{z=!1,U&&(U=!1,B(A),A=-1),I=!0;var ne=S;try{t:{for(H(G),v=s(m);v!==null&&!(v.expirationTime>G&&R());){var Q=v.callback;if(typeof Q=="function"){v.callback=null,S=v.priorityLevel;var X=Q(v.expirationTime<=G);if(G=n.unstable_now(),typeof X=="function"){v.callback=X,H(G),ae=!0;break t}v===s(m)&&a(m),H(G)}else a(m);v=s(m)}if(v!==null)ae=!0;else{var j=s(y);j!==null&&ye(q,j.startTime-G),ae=!1}}break e}finally{v=null,S=ne,I=!1}ae=void 0}}finally{ae?D():Y=!1}}}var D;if(typeof F=="function")D=function(){F(N)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,ve=O.port2;O.port1.onmessage=N,D=function(){ve.postMessage(null)}}else D=function(){M(N,0)};function ye(G,ae){A=M(function(){G(n.unstable_now())},ae)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_next=function(G){switch(S){case 1:case 2:case 3:var ae=3;break;default:ae=S}var ne=S;S=ae;try{return G()}finally{S=ne}},n.unstable_requestPaint=function(){C=!0},n.unstable_runWithPriority=function(G,ae){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ne=S;S=G;try{return ae()}finally{S=ne}},n.unstable_scheduleCallback=function(G,ae,ne){var Q=n.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?Q+ne:Q):ne=Q,G){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=ne+X,G={id:x++,callback:ae,priorityLevel:G,startTime:ne,expirationTime:X,sortIndex:-1},ne>Q?(G.sortIndex=ne,e(y,G),s(m)===null&&G===s(y)&&(U?(B(A),A=-1):U=!0,ye(q,ne-Q))):(G.sortIndex=X,e(m,G),z||I||(z=!0,Y||(Y=!0,D()))),G},n.unstable_shouldYield=R,n.unstable_wrapCallback=function(G){var ae=S;return function(){var ne=S;S=ae;try{return G.apply(this,arguments)}finally{S=ne}}}})(Yp)),Yp}var cv;function V2(){return cv||(cv=1,$p.exports=P2()),$p.exports}var Wp={exports:{}},ns={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uv;function z2(){if(uv)return ns;uv=1;var n=Ng();function e(m){var y="https://react.dev/errors/"+m;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+m+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var a={d:{f:s,r:function(){throw Error(e(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(m,y,x){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:v==null?null:""+v,children:m,containerInfo:y,implementation:x}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function p(m,y){if(m==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return ns.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,ns.createPortal=function(m,y){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return l(m,y,null,x)},ns.flushSync=function(m){var y=d.T,x=a.p;try{if(d.T=null,a.p=2,m)return m()}finally{d.T=y,a.p=x,a.d.f()}},ns.preconnect=function(m,y){typeof m=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,a.d.C(m,y))},ns.prefetchDNS=function(m){typeof m=="string"&&a.d.D(m)},ns.preinit=function(m,y){if(typeof m=="string"&&y&&typeof y.as=="string"){var x=y.as,v=p(x,y.crossOrigin),S=typeof y.integrity=="string"?y.integrity:void 0,I=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;x==="style"?a.d.S(m,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:v,integrity:S,fetchPriority:I}):x==="script"&&a.d.X(m,{crossOrigin:v,integrity:S,fetchPriority:I,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},ns.preinitModule=function(m,y){if(typeof m=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var x=p(y.as,y.crossOrigin);a.d.M(m,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&a.d.M(m)},ns.preload=function(m,y){if(typeof m=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var x=y.as,v=p(x,y.crossOrigin);a.d.L(m,x,{crossOrigin:v,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},ns.preloadModule=function(m,y){if(typeof m=="string")if(y){var x=p(y.as,y.crossOrigin);a.d.m(m,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else a.d.m(m)},ns.requestFormReset=function(m){a.d.r(m)},ns.unstable_batchedUpdates=function(m,y){return m(y)},ns.useFormState=function(m,y,x){return d.H.useFormState(m,y,x)},ns.useFormStatus=function(){return d.H.useHostTransitionStatus()},ns.version="19.2.4",ns}var dv;function RE(){if(dv)return Wp.exports;dv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Wp.exports=z2(),Wp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fv;function B2(){if(fv)return kc;fv=1;var n=V2(),e=Ng(),s=RE();function a(t){var r="https://react.dev/errors/"+t;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)r+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+t+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function l(t){var r=t,i=t;if(t.alternate)for(;r.return;)r=r.return;else{t=r;do r=t,(r.flags&4098)!==0&&(i=r.return),t=r.return;while(t)}return r.tag===3?i:null}function d(t){if(t.tag===13){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function p(t){if(t.tag===31){var r=t.memoizedState;if(r===null&&(t=t.alternate,t!==null&&(r=t.memoizedState)),r!==null)return r.dehydrated}return null}function m(t){if(l(t)!==t)throw Error(a(188))}function y(t){var r=t.alternate;if(!r){if(r=l(t),r===null)throw Error(a(188));return r!==t?null:t}for(var i=t,c=r;;){var h=i.return;if(h===null)break;var g=h.alternate;if(g===null){if(c=h.return,c!==null){i=c;continue}break}if(h.child===g.child){for(g=h.child;g;){if(g===i)return m(h),t;if(g===c)return m(h),r;g=g.sibling}throw Error(a(188))}if(i.return!==c.return)i=h,c=g;else{for(var _=!1,k=h.child;k;){if(k===i){_=!0,i=h,c=g;break}if(k===c){_=!0,c=h,i=g;break}k=k.sibling}if(!_){for(k=g.child;k;){if(k===i){_=!0,i=g,c=h;break}if(k===c){_=!0,c=g,i=h;break}k=k.sibling}if(!_)throw Error(a(189))}}if(i.alternate!==c)throw Error(a(190))}if(i.tag!==3)throw Error(a(188));return i.stateNode.current===i?t:r}function x(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t;for(t=t.child;t!==null;){if(r=x(t),r!==null)return r;t=t.sibling}return null}var v=Object.assign,S=Symbol.for("react.element"),I=Symbol.for("react.transitional.element"),z=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),B=Symbol.for("react.consumer"),F=Symbol.for("react.context"),H=Symbol.for("react.forward_ref"),q=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),N=Symbol.iterator;function D(t){return t===null||typeof t!="object"?null:(t=N&&t[N]||t["@@iterator"],typeof t=="function"?t:null)}var O=Symbol.for("react.client.reference");function ve(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===O?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case U:return"Fragment";case M:return"Profiler";case C:return"StrictMode";case q:return"Suspense";case Y:return"SuspenseList";case E:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case z:return"Portal";case F:return t.displayName||"Context";case B:return(t._context.displayName||"Context")+".Consumer";case H:var r=t.render;return t=t.displayName,t||(t=r.displayName||r.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case A:return r=t.displayName||null,r!==null?r:ve(t.type)||"Memo";case T:r=t._payload,t=t._init;try{return ve(t(r))}catch{}}return null}var ye=Array.isArray,G=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},Q=[],X=-1;function j(t){return{current:t}}function V(t){0>X||(t.current=Q[X],Q[X]=null,X--)}function $(t,r){X++,Q[X]=t.current,t.current=r}var Z=j(null),ee=j(null),pe=j(null),ie=j(null);function ce(t,r){switch($(pe,r),$(ee,t),$(Z,null),r.nodeType){case 9:case 11:t=(t=r.documentElement)&&(t=t.namespaceURI)?Ib(t):0;break;default:if(t=r.tagName,r=r.namespaceURI)r=Ib(r),t=Nb(r,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}V(Z),$(Z,t)}function De(){V(Z),V(ee),V(pe)}function fe(t){t.memoizedState!==null&&$(ie,t);var r=Z.current,i=Nb(r,t.type);r!==i&&($(ee,t),$(Z,i))}function Se(t){ee.current===t&&(V(Z),V(ee)),ie.current===t&&(V(ie),Nc._currentValue=ne)}var Oe,me;function ue(t){if(Oe===void 0)try{throw Error()}catch(i){var r=i.stack.trim().match(/\n( *(at )?)/);Oe=r&&r[1]||"",me=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Oe+t+me}var ge=!1;function Ee(t,r){if(!t||ge)return"";ge=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var we=function(){throw Error()};if(Object.defineProperty(we.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(we,[])}catch(he){var le=he}Reflect.construct(t,[],we)}else{try{we.call()}catch(he){le=he}t.call(we.prototype)}}else{try{throw Error()}catch(he){le=he}(we=t())&&typeof we.catch=="function"&&we.catch(function(){})}}catch(he){if(he&&le&&typeof he.stack=="string")return[he.stack,le.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),_=g[0],k=g[1];if(_&&k){var W=_.split(`
`),re=k.split(`
`);for(h=c=0;c<W.length&&!W[c].includes("DetermineComponentFrameRoot");)c++;for(;h<re.length&&!re[h].includes("DetermineComponentFrameRoot");)h++;if(c===W.length||h===re.length)for(c=W.length-1,h=re.length-1;1<=c&&0<=h&&W[c]!==re[h];)h--;for(;1<=c&&0<=h;c--,h--)if(W[c]!==re[h]){if(c!==1||h!==1)do if(c--,h--,0>h||W[c]!==re[h]){var xe=`
`+W[c].replace(" at new "," at ");return t.displayName&&xe.includes("<anonymous>")&&(xe=xe.replace("<anonymous>",t.displayName)),xe}while(1<=c&&0<=h);break}}}finally{ge=!1,Error.prepareStackTrace=i}return(i=t?t.displayName||t.name:"")?ue(i):""}function Ae(t,r){switch(t.tag){case 26:case 27:case 5:return ue(t.type);case 16:return ue("Lazy");case 13:return t.child!==r&&r!==null?ue("Suspense Fallback"):ue("Suspense");case 19:return ue("SuspenseList");case 0:case 15:return Ee(t.type,!1);case 11:return Ee(t.type.render,!1);case 1:return Ee(t.type,!0);case 31:return ue("Activity");default:return""}}function Ge(t){try{var r="",i=null;do r+=Ae(t,i),i=t,t=t.return;while(t);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Ue=Object.prototype.hasOwnProperty,Ke=n.unstable_scheduleCallback,Nt=n.unstable_cancelCallback,Pe=n.unstable_shouldYield,oe=n.unstable_requestPaint,Ve=n.unstable_now,lt=n.unstable_getCurrentPriorityLevel,ct=n.unstable_ImmediatePriority,nt=n.unstable_UserBlockingPriority,pt=n.unstable_NormalPriority,qt=n.unstable_LowPriority,Pt=n.unstable_IdlePriority,Os=n.log,kn=n.unstable_setDisableYieldValue,Zt=null,be=null;function Le(t){if(typeof Os=="function"&&kn(t),be&&typeof be.setStrictMode=="function")try{be.setStrictMode(Zt,t)}catch{}}var Ne=Math.clz32?Math.clz32:Me,yt=Math.log,rt=Math.LN2;function Me(t){return t>>>=0,t===0?32:31-(yt(t)/rt|0)|0}var st=256,ht=262144,Xe=4194304;function Dt(t){var r=t&42;if(r!==0)return r;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function vt(t,r,i){var c=t.pendingLanes;if(c===0)return 0;var h=0,g=t.suspendedLanes,_=t.pingedLanes;t=t.warmLanes;var k=c&134217727;return k!==0?(c=k&~g,c!==0?h=Dt(c):(_&=k,_!==0?h=Dt(_):i||(i=k&~t,i!==0&&(h=Dt(i))))):(k=c&~g,k!==0?h=Dt(k):_!==0?h=Dt(_):i||(i=c&~t,i!==0&&(h=Dt(i)))),h===0?0:r!==0&&r!==h&&(r&g)===0&&(g=h&-h,i=r&-r,g>=i||g===32&&(i&4194048)!==0)?r:h}function ln(t,r){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&r)===0}function vs(t,r){switch(t){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _s(){var t=Xe;return Xe<<=1,(Xe&62914560)===0&&(Xe=4194304),t}function Xt(t){for(var r=[],i=0;31>i;i++)r.push(t);return r}function $n(t,r){t.pendingLanes|=r,r!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function na(t,r,i,c,h,g){var _=t.pendingLanes;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=i,t.entangledLanes&=i,t.errorRecoveryDisabledLanes&=i,t.shellSuspendCounter=0;var k=t.entanglements,W=t.expirationTimes,re=t.hiddenUpdates;for(i=_&~i;0<i;){var xe=31-Ne(i),we=1<<xe;k[xe]=0,W[xe]=-1;var le=re[xe];if(le!==null)for(re[xe]=null,xe=0;xe<le.length;xe++){var he=le[xe];he!==null&&(he.lane&=-536870913)}i&=~we}c!==0&&qs(t,c,0),g!==0&&h===0&&t.tag!==0&&(t.suspendedLanes|=g&~(_&~r))}function qs(t,r,i){t.pendingLanes|=r,t.suspendedLanes&=~r;var c=31-Ne(r);t.entangledLanes|=r,t.entanglements[c]=t.entanglements[c]|1073741824|i&261930}function sa(t,r){var i=t.entangledLanes|=r;for(t=t.entanglements;i;){var c=31-Ne(i),h=1<<c;h&r|t[c]&r&&(t[c]|=r),i&=~h}}function Dr(t,r){var i=r&-r;return i=(i&42)!==0?1:ra(i),(i&(t.suspendedLanes|r))!==0?0:i}function ra(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function pr(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function js(){var t=ae.p;return t!==0?t:(t=window.event,t===void 0?32:Zb(t.type))}function yn(t,r){var i=ae.p;try{return ae.p=t,r()}finally{ae.p=i}}var cs=Math.random().toString(36).slice(2),cn="__reactFiber$"+cs,wn="__reactProps$"+cs,$s="__reactContainer$"+cs,aa="__reactEvents$"+cs,Hl="__reactListeners$"+cs,Ai="__reactHandles$"+cs,Ii="__reactResources$"+cs,ks="__reactMarker$"+cs;function ia(t){delete t[cn],delete t[wn],delete t[aa],delete t[Hl],delete t[Ai]}function Ys(t){var r=t[cn];if(r)return r;for(var i=t.parentNode;i;){if(r=i[$s]||i[cn]){if(i=r.alternate,r.child!==null||i!==null&&i.child!==null)for(t=Mb(t);t!==null;){if(i=t[cn])return i;t=Mb(t)}return r}t=i,i=t.parentNode}return null}function Es(t){if(t=t[cn]||t[$s]){var r=t.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return t}return null}function us(t){var r=t.tag;if(r===5||r===26||r===27||r===6)return t.stateNode;throw Error(a(33))}function Ws(t){var r=t[Ii];return r||(r=t[Ii]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function un(t){t[ks]=!0}var Ni=new Set,Ci={};function Qs(t,r){Ks(t,r),Ks(t+"Capture",r)}function Ks(t,r){for(Ci[t]=r,t=0;t<r.length;t++)Ni.add(r[t])}var Ri=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Oi={},ji={};function ki(t){return Ue.call(ji,t)?!0:Ue.call(Oi,t)?!1:Ri.test(t)?ji[t]=!0:(Oi[t]=!0,!1)}function Da(t,r,i){if(ki(r))if(i===null)t.removeAttribute(r);else{switch(typeof i){case"undefined":case"function":case"symbol":t.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(r);return}}t.setAttribute(r,""+i)}}function ds(t,r,i){if(i===null)t.removeAttribute(r);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(r);return}t.setAttribute(r,""+i)}}function dn(t,r,i,c){if(c===null)t.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(i);return}t.setAttributeNS(r,i,""+c)}}function Sn(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ur(t){var r=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function Li(t,r,i){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,r);if(!t.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var h=c.get,g=c.set;return Object.defineProperty(t,r,{configurable:!0,get:function(){return h.call(this)},set:function(_){i=""+_,g.call(this,_)}}),Object.defineProperty(t,r,{enumerable:c.enumerable}),{getValue:function(){return i},setValue:function(_){i=""+_},stopTracking:function(){t._valueTracker=null,delete t[r]}}}}function Ot(t){if(!t._valueTracker){var r=Ur(t)?"checked":"value";t._valueTracker=Li(t,r,""+t[r])}}function oa(t){if(!t)return!1;var r=t._valueTracker;if(!r)return!0;var i=r.getValue(),c="";return t&&(c=Ur(t)?t.checked?"true":"false":t.value),t=c,t!==i?(r.setValue(t),!0):!1}function Zs(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Xs=/[\n"\\]/g;function ts(t){return t.replace(Xs,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function la(t,r,i,c,h,g,_,k){t.name="",_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"?t.type=_:t.removeAttribute("type"),r!=null?_==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+Sn(r)):t.value!==""+Sn(r)&&(t.value=""+Sn(r)):_!=="submit"&&_!=="reset"||t.removeAttribute("value"),r!=null?Co(t,_,Sn(r)):i!=null?Co(t,_,Sn(i)):c!=null&&t.removeAttribute("value"),h==null&&g!=null&&(t.defaultChecked=!!g),h!=null&&(t.checked=h&&typeof h!="function"&&typeof h!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?t.name=""+Sn(k):t.removeAttribute("name")}function Mi(t,r,i,c,h,g,_,k){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(t.type=g),r!=null||i!=null){if(!(g!=="submit"&&g!=="reset"||r!=null)){Ot(t);return}i=i!=null?""+Sn(i):"",r=r!=null?""+Sn(r):i,k||r===t.value||(t.value=r),t.defaultValue=r}c=c??h,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=k?t.checked:!!c,t.defaultChecked=!!c,_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(t.name=_),Ot(t)}function Co(t,r,i){r==="number"&&Zs(t.ownerDocument)===t||t.defaultValue===""+i||(t.defaultValue=""+i)}function ca(t,r,i,c){if(t=t.options,r){r={};for(var h=0;h<i.length;h++)r["$"+i[h]]=!0;for(i=0;i<t.length;i++)h=r.hasOwnProperty("$"+t[i].value),t[i].selected!==h&&(t[i].selected=h),h&&c&&(t[i].defaultSelected=!0)}else{for(i=""+Sn(i),r=null,h=0;h<t.length;h++){if(t[h].value===i){t[h].selected=!0,c&&(t[h].defaultSelected=!0);return}r!==null||t[h].disabled||(r=t[h])}r!==null&&(r.selected=!0)}}function Gl(t,r,i){if(r!=null&&(r=""+Sn(r),r!==t.value&&(t.value=r),i==null)){t.defaultValue!==r&&(t.defaultValue=r);return}t.defaultValue=i!=null?""+Sn(i):""}function ua(t,r,i,c){if(r==null){if(c!=null){if(i!=null)throw Error(a(92));if(ye(c)){if(1<c.length)throw Error(a(93));c=c[0]}i=c}i==null&&(i=""),r=i}i=Sn(r),t.defaultValue=i,c=t.textContent,c===i&&c!==""&&c!==null&&(t.value=c),Ot(t)}function fs(t,r){if(r){var i=t.firstChild;if(i&&i===t.lastChild&&i.nodeType===3){i.nodeValue=r;return}}t.textContent=r}var je=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ke(t,r,i){var c=r.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?c?t.setProperty(r,""):r==="float"?t.cssFloat="":t[r]="":c?t.setProperty(r,i):typeof i!="number"||i===0||je.has(r)?r==="float"?t.cssFloat=i:t[r]=(""+i).trim():t[r]=i+"px"}function $e(t,r,i){if(r!=null&&typeof r!="object")throw Error(a(62));if(t=t.style,i!=null){for(var c in i)!i.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var h in r)c=r[h],r.hasOwnProperty(h)&&i[h]!==c&&ke(t,h,c)}else for(var g in r)r.hasOwnProperty(g)&&ke(t,g,r[g])}function qe(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ye=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),tt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function We(t){return tt.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function jt(){}var Ln=null;function kt(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fn=null,Mn=null;function mr(t){var r=Es(t);if(r&&(t=r.stateNode)){var i=t[wn]||null;e:switch(t=r.stateNode,r.type){case"input":if(la(t,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),r=i.name,i.type==="radio"&&r!=null){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+ts(""+r)+'"][type="radio"]'),r=0;r<i.length;r++){var c=i[r];if(c!==t&&c.form===t.form){var h=c[wn]||null;if(!h)throw Error(a(90));la(c,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(r=0;r<i.length;r++)c=i[r],c.form===t.form&&oa(c)}break e;case"textarea":Gl(t,i.value,i.defaultValue);break e;case"select":r=i.value,r!=null&&ca(t,!!i.multiple,r,!1)}}}var Ro=!1;function Ua(t,r,i){if(Ro)return t(r,i);Ro=!0;try{var c=t(r);return c}finally{if(Ro=!1,(fn!==null||Mn!==null)&&(yd(),fn&&(r=fn,t=Mn,Mn=fn=null,mr(r),t)))for(r=0;r<t.length;r++)mr(t[r])}}function gr(t,r){var i=t.stateNode;if(i===null)return null;var c=i[wn]||null;if(c===null)return null;i=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(i&&typeof i!="function")throw Error(a(231,r,typeof i));return i}var Js=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Di=!1;if(Js)try{var Bt={};Object.defineProperty(Bt,"passive",{get:function(){Di=!0}}),window.addEventListener("test",Bt,Bt),window.removeEventListener("test",Bt,Bt)}catch{Di=!1}var Pr=null,ql=null,Ui=null;function $l(){if(Ui)return Ui;var t,r=ql,i=r.length,c,h="value"in Pr?Pr.value:Pr.textContent,g=h.length;for(t=0;t<i&&r[t]===h[t];t++);var _=i-t;for(c=1;c<=_&&r[i-c]===h[g-c];c++);return Ui=h.slice(t,1<c?1-c:void 0)}function Pi(t){var r=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&r===13&&(t=13)):t=r,t===10&&(t=13),32<=t||t===13?t:0}function da(){return!0}function yr(){return!1}function Yn(t){function r(i,c,h,g,_){this._reactName=i,this._targetInst=h,this.type=c,this.nativeEvent=g,this.target=_,this.currentTarget=null;for(var k in t)t.hasOwnProperty(k)&&(i=t[k],this[k]=i?i(g):g[k]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?da:yr,this.isPropagationStopped=yr,this}return v(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=da)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=da)},persist:function(){},isPersistent:da}),r}var fa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Vr=Yn(fa),Pa=v({},fa,{view:0,detail:0}),Yl=Yn(Pa),Va,Oo,zr,jo=v({},Pa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:za,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==zr&&(zr&&t.type==="mousemove"?(Va=t.screenX-zr.screenX,Oo=t.screenY-zr.screenY):Oo=Va=0,zr=t),Va)},movementY:function(t){return"movementY"in t?t.movementY:Oo}}),Wl=Yn(jo),Vi=v({},jo,{dataTransfer:0}),Tu=Yn(Vi),Au=v({},Pa,{relatedTarget:0}),zi=Yn(Au),Ql=v({},fa,{animationName:0,elapsedTime:0,pseudoElement:0}),Iu=Yn(Ql),ko=v({},fa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Nu=Yn(ko),Cu=v({},fa,{data:0}),Br=Yn(Cu),Ru={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ou={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ju={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ku(t){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(t):(t=ju[t])?!!r[t]:!1}function za(){return ku}var hs=v({},Pa,{key:function(t){if(t.key){var r=Ru[t.key]||t.key;if(r!=="Unidentified")return r}return t.type==="keypress"?(t=Pi(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ou[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:za,charCode:function(t){return t.type==="keypress"?Pi(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Pi(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Lu=Yn(hs),Mu=v({},jo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ha=Yn(Mu),f=v({},Pa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:za}),b=Yn(f),w=v({},fa,{propertyName:0,elapsedTime:0,pseudoElement:0}),P=Yn(w),te=v({},jo,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),de=Yn(te),Ce=v({},fa,{newState:0,oldState:0}),ut=Yn(Ce),xn=[9,13,27,32],Lt=Js&&"CompositionEvent"in window,Jt=null;Js&&"documentMode"in document&&(Jt=document.documentMode);var er=Js&&"TextEvent"in window&&!Jt,Fr=Js&&(!Lt||Jt&&8<Jt&&11>=Jt),xr=" ",br=!1;function Bi(t,r){switch(t){case"keyup":return xn.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lo(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Mo=!1;function aA(t,r){switch(t){case"compositionend":return Lo(r);case"keypress":return r.which!==32?null:(br=!0,xr);case"textInput":return t=r.data,t===xr&&br?null:t;default:return null}}function iA(t,r){if(Mo)return t==="compositionend"||!Lt&&Bi(t,r)?(t=$l(),Ui=ql=Pr=null,Mo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return Fr&&r.locale!=="ko"?null:r.data;default:return null}}var oA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function P0(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r==="input"?!!oA[t.type]:r==="textarea"}function V0(t,r,i,c){fn?Mn?Mn.push(c):Mn=[c]:fn=c,r=Sd(r,"onChange"),0<r.length&&(i=new Vr("onChange","change",null,i,c),t.push({event:i,listeners:r}))}var Kl=null,Zl=null;function lA(t){_b(t,0)}function Du(t){var r=us(t);if(oa(r))return t}function z0(t,r){if(t==="change")return r}var B0=!1;if(Js){var Kf;if(Js){var Zf="oninput"in document;if(!Zf){var F0=document.createElement("div");F0.setAttribute("oninput","return;"),Zf=typeof F0.oninput=="function"}Kf=Zf}else Kf=!1;B0=Kf&&(!document.documentMode||9<document.documentMode)}function H0(){Kl&&(Kl.detachEvent("onpropertychange",G0),Zl=Kl=null)}function G0(t){if(t.propertyName==="value"&&Du(Zl)){var r=[];V0(r,Zl,t,kt(t)),Ua(lA,r)}}function cA(t,r,i){t==="focusin"?(H0(),Kl=r,Zl=i,Kl.attachEvent("onpropertychange",G0)):t==="focusout"&&H0()}function uA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Du(Zl)}function dA(t,r){if(t==="click")return Du(r)}function fA(t,r){if(t==="input"||t==="change")return Du(r)}function hA(t,r){return t===r&&(t!==0||1/t===1/r)||t!==t&&r!==r}var Ls=typeof Object.is=="function"?Object.is:hA;function Xl(t,r){if(Ls(t,r))return!0;if(typeof t!="object"||t===null||typeof r!="object"||r===null)return!1;var i=Object.keys(t),c=Object.keys(r);if(i.length!==c.length)return!1;for(c=0;c<i.length;c++){var h=i[c];if(!Ue.call(r,h)||!Ls(t[h],r[h]))return!1}return!0}function q0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $0(t,r){var i=q0(t);t=0;for(var c;i;){if(i.nodeType===3){if(c=t+i.textContent.length,t<=r&&c>=r)return{node:i,offset:r-t};t=c}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=q0(i)}}function Y0(t,r){return t&&r?t===r?!0:t&&t.nodeType===3?!1:r&&r.nodeType===3?Y0(t,r.parentNode):"contains"in t?t.contains(r):t.compareDocumentPosition?!!(t.compareDocumentPosition(r)&16):!1:!1}function W0(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var r=Zs(t.document);r instanceof t.HTMLIFrameElement;){try{var i=typeof r.contentWindow.location.href=="string"}catch{i=!1}if(i)t=r.contentWindow;else break;r=Zs(t.document)}return r}function Xf(t){var r=t&&t.nodeName&&t.nodeName.toLowerCase();return r&&(r==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||r==="textarea"||t.contentEditable==="true")}var pA=Js&&"documentMode"in document&&11>=document.documentMode,Do=null,Jf=null,Jl=null,eh=!1;function Q0(t,r,i){var c=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;eh||Do==null||Do!==Zs(c)||(c=Do,"selectionStart"in c&&Xf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Jl&&Xl(Jl,c)||(Jl=c,c=Sd(Jf,"onSelect"),0<c.length&&(r=new Vr("onSelect","select",null,r,i),t.push({event:r,listeners:c}),r.target=Do)))}function Fi(t,r){var i={};return i[t.toLowerCase()]=r.toLowerCase(),i["Webkit"+t]="webkit"+r,i["Moz"+t]="moz"+r,i}var Uo={animationend:Fi("Animation","AnimationEnd"),animationiteration:Fi("Animation","AnimationIteration"),animationstart:Fi("Animation","AnimationStart"),transitionrun:Fi("Transition","TransitionRun"),transitionstart:Fi("Transition","TransitionStart"),transitioncancel:Fi("Transition","TransitionCancel"),transitionend:Fi("Transition","TransitionEnd")},th={},K0={};Js&&(K0=document.createElement("div").style,"AnimationEvent"in window||(delete Uo.animationend.animation,delete Uo.animationiteration.animation,delete Uo.animationstart.animation),"TransitionEvent"in window||delete Uo.transitionend.transition);function Hi(t){if(th[t])return th[t];if(!Uo[t])return t;var r=Uo[t],i;for(i in r)if(r.hasOwnProperty(i)&&i in K0)return th[t]=r[i];return t}var Z0=Hi("animationend"),X0=Hi("animationiteration"),J0=Hi("animationstart"),mA=Hi("transitionrun"),gA=Hi("transitionstart"),yA=Hi("transitioncancel"),ey=Hi("transitionend"),ty=new Map,nh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");nh.push("scrollEnd");function vr(t,r){ty.set(t,r),Qs(r,[t])}var Uu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},tr=[],Po=0,sh=0;function Pu(){for(var t=Po,r=sh=Po=0;r<t;){var i=tr[r];tr[r++]=null;var c=tr[r];tr[r++]=null;var h=tr[r];tr[r++]=null;var g=tr[r];if(tr[r++]=null,c!==null&&h!==null){var _=c.pending;_===null?h.next=h:(h.next=_.next,_.next=h),c.pending=h}g!==0&&ny(i,h,g)}}function Vu(t,r,i,c){tr[Po++]=t,tr[Po++]=r,tr[Po++]=i,tr[Po++]=c,sh|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function rh(t,r,i,c){return Vu(t,r,i,c),zu(t)}function Gi(t,r){return Vu(t,null,null,r),zu(t)}function ny(t,r,i){t.lanes|=i;var c=t.alternate;c!==null&&(c.lanes|=i);for(var h=!1,g=t.return;g!==null;)g.childLanes|=i,c=g.alternate,c!==null&&(c.childLanes|=i),g.tag===22&&(t=g.stateNode,t===null||t._visibility&1||(h=!0)),t=g,g=g.return;return t.tag===3?(g=t.stateNode,h&&r!==null&&(h=31-Ne(i),t=g.hiddenUpdates,c=t[h],c===null?t[h]=[r]:c.push(r),r.lane=i|536870912),g):null}function zu(t){if(50<_c)throw _c=0,hp=null,Error(a(185));for(var r=t.return;r!==null;)t=r,r=t.return;return t.tag===3?t.stateNode:null}var Vo={};function xA(t,r,i,c){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ms(t,r,i,c){return new xA(t,r,i,c)}function ah(t){return t=t.prototype,!(!t||!t.isReactComponent)}function pa(t,r){var i=t.alternate;return i===null?(i=Ms(t.tag,r,t.key,t.mode),i.elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=r,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=t.flags&65011712,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,r=t.dependencies,i.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i.refCleanup=t.refCleanup,i}function sy(t,r){t.flags&=65011714;var i=t.alternate;return i===null?(t.childLanes=0,t.lanes=r,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,t.type=i.type,r=i.dependencies,t.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t}function Bu(t,r,i,c,h,g){var _=0;if(c=t,typeof t=="function")ah(t)&&(_=1);else if(typeof t=="string")_=w2(t,i,Z.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case E:return t=Ms(31,i,r,h),t.elementType=E,t.lanes=g,t;case U:return qi(i.children,h,g,r);case C:_=8,h|=24;break;case M:return t=Ms(12,i,r,h|2),t.elementType=M,t.lanes=g,t;case q:return t=Ms(13,i,r,h),t.elementType=q,t.lanes=g,t;case Y:return t=Ms(19,i,r,h),t.elementType=Y,t.lanes=g,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case F:_=10;break e;case B:_=9;break e;case H:_=11;break e;case A:_=14;break e;case T:_=16,c=null;break e}_=29,i=Error(a(130,t===null?"null":typeof t,"")),c=null}return r=Ms(_,i,r,h),r.elementType=t,r.type=c,r.lanes=g,r}function qi(t,r,i,c){return t=Ms(7,t,c,r),t.lanes=i,t}function ih(t,r,i){return t=Ms(6,t,null,r),t.lanes=i,t}function ry(t){var r=Ms(18,null,null,0);return r.stateNode=t,r}function oh(t,r,i){return r=Ms(4,t.children!==null?t.children:[],t.key,r),r.lanes=i,r.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},r}var ay=new WeakMap;function nr(t,r){if(typeof t=="object"&&t!==null){var i=ay.get(t);return i!==void 0?i:(r={value:t,source:r,stack:Ge(r)},ay.set(t,r),r)}return{value:t,source:r,stack:Ge(r)}}var zo=[],Bo=0,Fu=null,ec=0,sr=[],rr=0,Ba=null,Hr=1,Gr="";function ma(t,r){zo[Bo++]=ec,zo[Bo++]=Fu,Fu=t,ec=r}function iy(t,r,i){sr[rr++]=Hr,sr[rr++]=Gr,sr[rr++]=Ba,Ba=t;var c=Hr;t=Gr;var h=32-Ne(c)-1;c&=~(1<<h),i+=1;var g=32-Ne(r)+h;if(30<g){var _=h-h%5;g=(c&(1<<_)-1).toString(32),c>>=_,h-=_,Hr=1<<32-Ne(r)+h|i<<h|c,Gr=g+t}else Hr=1<<g|i<<h|c,Gr=t}function lh(t){t.return!==null&&(ma(t,1),iy(t,1,0))}function ch(t){for(;t===Fu;)Fu=zo[--Bo],zo[Bo]=null,ec=zo[--Bo],zo[Bo]=null;for(;t===Ba;)Ba=sr[--rr],sr[rr]=null,Gr=sr[--rr],sr[rr]=null,Hr=sr[--rr],sr[rr]=null}function oy(t,r){sr[rr++]=Hr,sr[rr++]=Gr,sr[rr++]=Ba,Hr=r.id,Gr=r.overflow,Ba=t}var Wn=null,Wt=null,_t=!1,Fa=null,ar=!1,uh=Error(a(519));function Ha(t){var r=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw tc(nr(r,t)),uh}function ly(t){var r=t.stateNode,i=t.type,c=t.memoizedProps;switch(r[cn]=t,r[wn]=c,i){case"dialog":gt("cancel",r),gt("close",r);break;case"iframe":case"object":case"embed":gt("load",r);break;case"video":case"audio":for(i=0;i<wc.length;i++)gt(wc[i],r);break;case"source":gt("error",r);break;case"img":case"image":case"link":gt("error",r),gt("load",r);break;case"details":gt("toggle",r);break;case"input":gt("invalid",r),Mi(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":gt("invalid",r);break;case"textarea":gt("invalid",r),ua(r,c.value,c.defaultValue,c.children)}i=c.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||r.textContent===""+i||c.suppressHydrationWarning===!0||Tb(r.textContent,i)?(c.popover!=null&&(gt("beforetoggle",r),gt("toggle",r)),c.onScroll!=null&&gt("scroll",r),c.onScrollEnd!=null&&gt("scrollend",r),c.onClick!=null&&(r.onclick=jt),r=!0):r=!1,r||Ha(t,!0)}function cy(t){for(Wn=t.return;Wn;)switch(Wn.tag){case 5:case 31:case 13:ar=!1;return;case 27:case 3:ar=!0;return;default:Wn=Wn.return}}function Fo(t){if(t!==Wn)return!1;if(!_t)return cy(t),_t=!0,!1;var r=t.tag,i;if((i=r!==3&&r!==27)&&((i=r===5)&&(i=t.type,i=!(i!=="form"&&i!=="button")||Np(t.type,t.memoizedProps)),i=!i),i&&Wt&&Ha(t),cy(t),r===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(a(317));Wt=Lb(t)}else if(r===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(a(317));Wt=Lb(t)}else r===27?(r=Wt,si(t.type)?(t=kp,kp=null,Wt=t):Wt=r):Wt=Wn?or(t.stateNode.nextSibling):null;return!0}function $i(){Wt=Wn=null,_t=!1}function dh(){var t=Fa;return t!==null&&(As===null?As=t:As.push.apply(As,t),Fa=null),t}function tc(t){Fa===null?Fa=[t]:Fa.push(t)}var fh=j(null),Yi=null,ga=null;function Ga(t,r,i){$(fh,r._currentValue),r._currentValue=i}function ya(t){t._currentValue=fh.current,V(fh)}function hh(t,r,i){for(;t!==null;){var c=t.alternate;if((t.childLanes&r)!==r?(t.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),t===i)break;t=t.return}}function ph(t,r,i,c){var h=t.child;for(h!==null&&(h.return=t);h!==null;){var g=h.dependencies;if(g!==null){var _=h.child;g=g.firstContext;e:for(;g!==null;){var k=g;g=h;for(var W=0;W<r.length;W++)if(k.context===r[W]){g.lanes|=i,k=g.alternate,k!==null&&(k.lanes|=i),hh(g.return,i,t),c||(_=null);break e}g=k.next}}else if(h.tag===18){if(_=h.return,_===null)throw Error(a(341));_.lanes|=i,g=_.alternate,g!==null&&(g.lanes|=i),hh(_,i,t),_=null}else _=h.child;if(_!==null)_.return=h;else for(_=h;_!==null;){if(_===t){_=null;break}if(h=_.sibling,h!==null){h.return=_.return,_=h;break}_=_.return}h=_}}function Ho(t,r,i,c){t=null;for(var h=r,g=!1;h!==null;){if(!g){if((h.flags&524288)!==0)g=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var _=h.alternate;if(_===null)throw Error(a(387));if(_=_.memoizedProps,_!==null){var k=h.type;Ls(h.pendingProps.value,_.value)||(t!==null?t.push(k):t=[k])}}else if(h===ie.current){if(_=h.alternate,_===null)throw Error(a(387));_.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(t!==null?t.push(Nc):t=[Nc])}h=h.return}t!==null&&ph(r,t,i,c),r.flags|=262144}function Hu(t){for(t=t.firstContext;t!==null;){if(!Ls(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Wi(t){Yi=t,ga=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Qn(t){return uy(Yi,t)}function Gu(t,r){return Yi===null&&Wi(t),uy(t,r)}function uy(t,r){var i=r._currentValue;if(r={context:r,memoizedValue:i,next:null},ga===null){if(t===null)throw Error(a(308));ga=r,t.dependencies={lanes:0,firstContext:r},t.flags|=524288}else ga=ga.next=r;return i}var bA=typeof AbortController<"u"?AbortController:function(){var t=[],r=this.signal={aborted:!1,addEventListener:function(i,c){t.push(c)}};this.abort=function(){r.aborted=!0,t.forEach(function(i){return i()})}},vA=n.unstable_scheduleCallback,_A=n.unstable_NormalPriority,Tn={$$typeof:F,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function mh(){return{controller:new bA,data:new Map,refCount:0}}function nc(t){t.refCount--,t.refCount===0&&vA(_A,function(){t.controller.abort()})}var sc=null,gh=0,Go=0,qo=null;function EA(t,r){if(sc===null){var i=sc=[];gh=0,Go=bp(),qo={status:"pending",value:void 0,then:function(c){i.push(c)}}}return gh++,r.then(dy,dy),r}function dy(){if(--gh===0&&sc!==null){qo!==null&&(qo.status="fulfilled");var t=sc;sc=null,Go=0,qo=null;for(var r=0;r<t.length;r++)(0,t[r])()}}function wA(t,r){var i=[],c={status:"pending",value:null,reason:null,then:function(h){i.push(h)}};return t.then(function(){c.status="fulfilled",c.value=r;for(var h=0;h<i.length;h++)(0,i[h])(r)},function(h){for(c.status="rejected",c.reason=h,h=0;h<i.length;h++)(0,i[h])(void 0)}),c}var fy=G.S;G.S=function(t,r){Qx=Ve(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&EA(t,r),fy!==null&&fy(t,r)};var Qi=j(null);function yh(){var t=Qi.current;return t!==null?t:$t.pooledCache}function qu(t,r){r===null?$(Qi,Qi.current):$(Qi,r.pool)}function hy(){var t=yh();return t===null?null:{parent:Tn._currentValue,pool:t}}var $o=Error(a(460)),xh=Error(a(474)),$u=Error(a(542)),Yu={then:function(){}};function py(t){return t=t.status,t==="fulfilled"||t==="rejected"}function my(t,r,i){switch(i=t[i],i===void 0?t.push(r):i!==r&&(r.then(jt,jt),r=i),r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,yy(t),t;default:if(typeof r.status=="string")r.then(jt,jt);else{if(t=$t,t!==null&&100<t.shellSuspendCounter)throw Error(a(482));t=r,t.status="pending",t.then(function(c){if(r.status==="pending"){var h=r;h.status="fulfilled",h.value=c}},function(c){if(r.status==="pending"){var h=r;h.status="rejected",h.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw t=r.reason,yy(t),t}throw Zi=r,$o}}function Ki(t){try{var r=t._init;return r(t._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(Zi=i,$o):i}}var Zi=null;function gy(){if(Zi===null)throw Error(a(459));var t=Zi;return Zi=null,t}function yy(t){if(t===$o||t===$u)throw Error(a(483))}var Yo=null,rc=0;function Wu(t){var r=rc;return rc+=1,Yo===null&&(Yo=[]),my(Yo,t,r)}function ac(t,r){r=r.props.ref,t.ref=r!==void 0?r:null}function Qu(t,r){throw r.$$typeof===S?Error(a(525)):(t=Object.prototype.toString.call(r),Error(a(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t)))}function xy(t){function r(J,K){if(t){var se=J.deletions;se===null?(J.deletions=[K],J.flags|=16):se.push(K)}}function i(J,K){if(!t)return null;for(;K!==null;)r(J,K),K=K.sibling;return null}function c(J){for(var K=new Map;J!==null;)J.key!==null?K.set(J.key,J):K.set(J.index,J),J=J.sibling;return K}function h(J,K){return J=pa(J,K),J.index=0,J.sibling=null,J}function g(J,K,se){return J.index=se,t?(se=J.alternate,se!==null?(se=se.index,se<K?(J.flags|=67108866,K):se):(J.flags|=67108866,K)):(J.flags|=1048576,K)}function _(J){return t&&J.alternate===null&&(J.flags|=67108866),J}function k(J,K,se,_e){return K===null||K.tag!==6?(K=ih(se,J.mode,_e),K.return=J,K):(K=h(K,se),K.return=J,K)}function W(J,K,se,_e){var Ze=se.type;return Ze===U?xe(J,K,se.props.children,_e,se.key):K!==null&&(K.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===T&&Ki(Ze)===K.type)?(K=h(K,se.props),ac(K,se),K.return=J,K):(K=Bu(se.type,se.key,se.props,null,J.mode,_e),ac(K,se),K.return=J,K)}function re(J,K,se,_e){return K===null||K.tag!==4||K.stateNode.containerInfo!==se.containerInfo||K.stateNode.implementation!==se.implementation?(K=oh(se,J.mode,_e),K.return=J,K):(K=h(K,se.children||[]),K.return=J,K)}function xe(J,K,se,_e,Ze){return K===null||K.tag!==7?(K=qi(se,J.mode,_e,Ze),K.return=J,K):(K=h(K,se),K.return=J,K)}function we(J,K,se){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return K=ih(""+K,J.mode,se),K.return=J,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case I:return se=Bu(K.type,K.key,K.props,null,J.mode,se),ac(se,K),se.return=J,se;case z:return K=oh(K,J.mode,se),K.return=J,K;case T:return K=Ki(K),we(J,K,se)}if(ye(K)||D(K))return K=qi(K,J.mode,se,null),K.return=J,K;if(typeof K.then=="function")return we(J,Wu(K),se);if(K.$$typeof===F)return we(J,Gu(J,K),se);Qu(J,K)}return null}function le(J,K,se,_e){var Ze=K!==null?K.key:null;if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return Ze!==null?null:k(J,K,""+se,_e);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case I:return se.key===Ze?W(J,K,se,_e):null;case z:return se.key===Ze?re(J,K,se,_e):null;case T:return se=Ki(se),le(J,K,se,_e)}if(ye(se)||D(se))return Ze!==null?null:xe(J,K,se,_e,null);if(typeof se.then=="function")return le(J,K,Wu(se),_e);if(se.$$typeof===F)return le(J,K,Gu(J,se),_e);Qu(J,se)}return null}function he(J,K,se,_e,Ze){if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return J=J.get(se)||null,k(K,J,""+_e,Ze);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case I:return J=J.get(_e.key===null?se:_e.key)||null,W(K,J,_e,Ze);case z:return J=J.get(_e.key===null?se:_e.key)||null,re(K,J,_e,Ze);case T:return _e=Ki(_e),he(J,K,se,_e,Ze)}if(ye(_e)||D(_e))return J=J.get(se)||null,xe(K,J,_e,Ze,null);if(typeof _e.then=="function")return he(J,K,se,Wu(_e),Ze);if(_e.$$typeof===F)return he(J,K,se,Gu(K,_e),Ze);Qu(K,_e)}return null}function Be(J,K,se,_e){for(var Ze=null,Ct=null,He=K,ft=K=0,bt=null;He!==null&&ft<se.length;ft++){He.index>ft?(bt=He,He=null):bt=He.sibling;var Rt=le(J,He,se[ft],_e);if(Rt===null){He===null&&(He=bt);break}t&&He&&Rt.alternate===null&&r(J,He),K=g(Rt,K,ft),Ct===null?Ze=Rt:Ct.sibling=Rt,Ct=Rt,He=bt}if(ft===se.length)return i(J,He),_t&&ma(J,ft),Ze;if(He===null){for(;ft<se.length;ft++)He=we(J,se[ft],_e),He!==null&&(K=g(He,K,ft),Ct===null?Ze=He:Ct.sibling=He,Ct=He);return _t&&ma(J,ft),Ze}for(He=c(He);ft<se.length;ft++)bt=he(He,J,ft,se[ft],_e),bt!==null&&(t&&bt.alternate!==null&&He.delete(bt.key===null?ft:bt.key),K=g(bt,K,ft),Ct===null?Ze=bt:Ct.sibling=bt,Ct=bt);return t&&He.forEach(function(li){return r(J,li)}),_t&&ma(J,ft),Ze}function Je(J,K,se,_e){if(se==null)throw Error(a(151));for(var Ze=null,Ct=null,He=K,ft=K=0,bt=null,Rt=se.next();He!==null&&!Rt.done;ft++,Rt=se.next()){He.index>ft?(bt=He,He=null):bt=He.sibling;var li=le(J,He,Rt.value,_e);if(li===null){He===null&&(He=bt);break}t&&He&&li.alternate===null&&r(J,He),K=g(li,K,ft),Ct===null?Ze=li:Ct.sibling=li,Ct=li,He=bt}if(Rt.done)return i(J,He),_t&&ma(J,ft),Ze;if(He===null){for(;!Rt.done;ft++,Rt=se.next())Rt=we(J,Rt.value,_e),Rt!==null&&(K=g(Rt,K,ft),Ct===null?Ze=Rt:Ct.sibling=Rt,Ct=Rt);return _t&&ma(J,ft),Ze}for(He=c(He);!Rt.done;ft++,Rt=se.next())Rt=he(He,J,ft,Rt.value,_e),Rt!==null&&(t&&Rt.alternate!==null&&He.delete(Rt.key===null?ft:Rt.key),K=g(Rt,K,ft),Ct===null?Ze=Rt:Ct.sibling=Rt,Ct=Rt);return t&&He.forEach(function(L2){return r(J,L2)}),_t&&ma(J,ft),Ze}function Gt(J,K,se,_e){if(typeof se=="object"&&se!==null&&se.type===U&&se.key===null&&(se=se.props.children),typeof se=="object"&&se!==null){switch(se.$$typeof){case I:e:{for(var Ze=se.key;K!==null;){if(K.key===Ze){if(Ze=se.type,Ze===U){if(K.tag===7){i(J,K.sibling),_e=h(K,se.props.children),_e.return=J,J=_e;break e}}else if(K.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===T&&Ki(Ze)===K.type){i(J,K.sibling),_e=h(K,se.props),ac(_e,se),_e.return=J,J=_e;break e}i(J,K);break}else r(J,K);K=K.sibling}se.type===U?(_e=qi(se.props.children,J.mode,_e,se.key),_e.return=J,J=_e):(_e=Bu(se.type,se.key,se.props,null,J.mode,_e),ac(_e,se),_e.return=J,J=_e)}return _(J);case z:e:{for(Ze=se.key;K!==null;){if(K.key===Ze)if(K.tag===4&&K.stateNode.containerInfo===se.containerInfo&&K.stateNode.implementation===se.implementation){i(J,K.sibling),_e=h(K,se.children||[]),_e.return=J,J=_e;break e}else{i(J,K);break}else r(J,K);K=K.sibling}_e=oh(se,J.mode,_e),_e.return=J,J=_e}return _(J);case T:return se=Ki(se),Gt(J,K,se,_e)}if(ye(se))return Be(J,K,se,_e);if(D(se)){if(Ze=D(se),typeof Ze!="function")throw Error(a(150));return se=Ze.call(se),Je(J,K,se,_e)}if(typeof se.then=="function")return Gt(J,K,Wu(se),_e);if(se.$$typeof===F)return Gt(J,K,Gu(J,se),_e);Qu(J,se)}return typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint"?(se=""+se,K!==null&&K.tag===6?(i(J,K.sibling),_e=h(K,se),_e.return=J,J=_e):(i(J,K),_e=ih(se,J.mode,_e),_e.return=J,J=_e),_(J)):i(J,K)}return function(J,K,se,_e){try{rc=0;var Ze=Gt(J,K,se,_e);return Yo=null,Ze}catch(He){if(He===$o||He===$u)throw He;var Ct=Ms(29,He,null,J.mode);return Ct.lanes=_e,Ct.return=J,Ct}finally{}}}var Xi=xy(!0),by=xy(!1),qa=!1;function bh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function vh(t,r){t=t.updateQueue,r.updateQueue===t&&(r.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function $a(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Ya(t,r,i){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(Mt&2)!==0){var h=c.pending;return h===null?r.next=r:(r.next=h.next,h.next=r),c.pending=r,r=zu(t),ny(t,null,i),r}return Vu(t,c,r,i),zu(t)}function ic(t,r,i){if(r=r.updateQueue,r!==null&&(r=r.shared,(i&4194048)!==0)){var c=r.lanes;c&=t.pendingLanes,i|=c,r.lanes=i,sa(t,i)}}function _h(t,r){var i=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,i===c)){var h=null,g=null;if(i=i.firstBaseUpdate,i!==null){do{var _={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};g===null?h=g=_:g=g.next=_,i=i.next}while(i!==null);g===null?h=g=r:g=g.next=r}else h=g=r;i={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},t.updateQueue=i;return}t=i.lastBaseUpdate,t===null?i.firstBaseUpdate=r:t.next=r,i.lastBaseUpdate=r}var Eh=!1;function oc(){if(Eh){var t=qo;if(t!==null)throw t}}function lc(t,r,i,c){Eh=!1;var h=t.updateQueue;qa=!1;var g=h.firstBaseUpdate,_=h.lastBaseUpdate,k=h.shared.pending;if(k!==null){h.shared.pending=null;var W=k,re=W.next;W.next=null,_===null?g=re:_.next=re,_=W;var xe=t.alternate;xe!==null&&(xe=xe.updateQueue,k=xe.lastBaseUpdate,k!==_&&(k===null?xe.firstBaseUpdate=re:k.next=re,xe.lastBaseUpdate=W))}if(g!==null){var we=h.baseState;_=0,xe=re=W=null,k=g;do{var le=k.lane&-536870913,he=le!==k.lane;if(he?(xt&le)===le:(c&le)===le){le!==0&&le===Go&&(Eh=!0),xe!==null&&(xe=xe.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Be=t,Je=k;le=r;var Gt=i;switch(Je.tag){case 1:if(Be=Je.payload,typeof Be=="function"){we=Be.call(Gt,we,le);break e}we=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=Je.payload,le=typeof Be=="function"?Be.call(Gt,we,le):Be,le==null)break e;we=v({},we,le);break e;case 2:qa=!0}}le=k.callback,le!==null&&(t.flags|=64,he&&(t.flags|=8192),he=h.callbacks,he===null?h.callbacks=[le]:he.push(le))}else he={lane:le,tag:k.tag,payload:k.payload,callback:k.callback,next:null},xe===null?(re=xe=he,W=we):xe=xe.next=he,_|=le;if(k=k.next,k===null){if(k=h.shared.pending,k===null)break;he=k,k=he.next,he.next=null,h.lastBaseUpdate=he,h.shared.pending=null}}while(!0);xe===null&&(W=we),h.baseState=W,h.firstBaseUpdate=re,h.lastBaseUpdate=xe,g===null&&(h.shared.lanes=0),Xa|=_,t.lanes=_,t.memoizedState=we}}function vy(t,r){if(typeof t!="function")throw Error(a(191,t));t.call(r)}function _y(t,r){var i=t.callbacks;if(i!==null)for(t.callbacks=null,t=0;t<i.length;t++)vy(i[t],r)}var Wo=j(null),Ku=j(0);function Ey(t,r){t=Aa,$(Ku,t),$(Wo,r),Aa=t|r.baseLanes}function wh(){$(Ku,Aa),$(Wo,Wo.current)}function Sh(){Aa=Ku.current,V(Wo),V(Ku)}var Ds=j(null),ir=null;function Wa(t){var r=t.alternate;$(bn,bn.current&1),$(Ds,t),ir===null&&(r===null||Wo.current!==null||r.memoizedState!==null)&&(ir=t)}function Th(t){$(bn,bn.current),$(Ds,t),ir===null&&(ir=t)}function wy(t){t.tag===22?($(bn,bn.current),$(Ds,t),ir===null&&(ir=t)):Qa()}function Qa(){$(bn,bn.current),$(Ds,Ds.current)}function Us(t){V(Ds),ir===t&&(ir=null),V(bn)}var bn=j(0);function Zu(t){for(var r=t;r!==null;){if(r.tag===13){var i=r.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||Op(i)||jp(i)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var xa=0,dt=null,Ft=null,An=null,Xu=!1,Qo=!1,Ji=!1,Ju=0,cc=0,Ko=null,SA=0;function hn(){throw Error(a(321))}function Ah(t,r){if(r===null)return!1;for(var i=0;i<r.length&&i<t.length;i++)if(!Ls(t[i],r[i]))return!1;return!0}function Ih(t,r,i,c,h,g){return xa=g,dt=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,G.H=t===null||t.memoizedState===null?ix:Fh,Ji=!1,g=i(c,h),Ji=!1,Qo&&(g=Ty(r,i,c,h)),Sy(t),g}function Sy(t){G.H=fc;var r=Ft!==null&&Ft.next!==null;if(xa=0,An=Ft=dt=null,Xu=!1,cc=0,Ko=null,r)throw Error(a(300));t===null||In||(t=t.dependencies,t!==null&&Hu(t)&&(In=!0))}function Ty(t,r,i,c){dt=t;var h=0;do{if(Qo&&(Ko=null),cc=0,Qo=!1,25<=h)throw Error(a(301));if(h+=1,An=Ft=null,t.updateQueue!=null){var g=t.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}G.H=ox,g=r(i,c)}while(Qo);return g}function TA(){var t=G.H,r=t.useState()[0];return r=typeof r.then=="function"?uc(r):r,t=t.useState()[0],(Ft!==null?Ft.memoizedState:null)!==t&&(dt.flags|=1024),r}function Nh(){var t=Ju!==0;return Ju=0,t}function Ch(t,r,i){r.updateQueue=t.updateQueue,r.flags&=-2053,t.lanes&=~i}function Rh(t){if(Xu){for(t=t.memoizedState;t!==null;){var r=t.queue;r!==null&&(r.pending=null),t=t.next}Xu=!1}xa=0,An=Ft=dt=null,Qo=!1,cc=Ju=0,Ko=null}function ps(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return An===null?dt.memoizedState=An=t:An=An.next=t,An}function vn(){if(Ft===null){var t=dt.alternate;t=t!==null?t.memoizedState:null}else t=Ft.next;var r=An===null?dt.memoizedState:An.next;if(r!==null)An=r,Ft=t;else{if(t===null)throw dt.alternate===null?Error(a(467)):Error(a(310));Ft=t,t={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},An===null?dt.memoizedState=An=t:An=An.next=t}return An}function ed(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function uc(t){var r=cc;return cc+=1,Ko===null&&(Ko=[]),t=my(Ko,t,r),r=dt,(An===null?r.memoizedState:An.next)===null&&(r=r.alternate,G.H=r===null||r.memoizedState===null?ix:Fh),t}function td(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return uc(t);if(t.$$typeof===F)return Qn(t)}throw Error(a(438,String(t)))}function Oh(t){var r=null,i=dt.updateQueue;if(i!==null&&(r=i.memoCache),r==null){var c=dt.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(h){return h.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),i===null&&(i=ed(),dt.updateQueue=i),i.memoCache=r,i=r.data[r.index],i===void 0)for(i=r.data[r.index]=Array(t),c=0;c<t;c++)i[c]=R;return r.index++,i}function ba(t,r){return typeof r=="function"?r(t):r}function nd(t){var r=vn();return jh(r,Ft,t)}function jh(t,r,i){var c=t.queue;if(c===null)throw Error(a(311));c.lastRenderedReducer=i;var h=t.baseQueue,g=c.pending;if(g!==null){if(h!==null){var _=h.next;h.next=g.next,g.next=_}r.baseQueue=h=g,c.pending=null}if(g=t.baseState,h===null)t.memoizedState=g;else{r=h.next;var k=_=null,W=null,re=r,xe=!1;do{var we=re.lane&-536870913;if(we!==re.lane?(xt&we)===we:(xa&we)===we){var le=re.revertLane;if(le===0)W!==null&&(W=W.next={lane:0,revertLane:0,gesture:null,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null}),we===Go&&(xe=!0);else if((xa&le)===le){re=re.next,le===Go&&(xe=!0);continue}else we={lane:0,revertLane:re.revertLane,gesture:null,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},W===null?(k=W=we,_=g):W=W.next=we,dt.lanes|=le,Xa|=le;we=re.action,Ji&&i(g,we),g=re.hasEagerState?re.eagerState:i(g,we)}else le={lane:we,revertLane:re.revertLane,gesture:re.gesture,action:re.action,hasEagerState:re.hasEagerState,eagerState:re.eagerState,next:null},W===null?(k=W=le,_=g):W=W.next=le,dt.lanes|=we,Xa|=we;re=re.next}while(re!==null&&re!==r);if(W===null?_=g:W.next=k,!Ls(g,t.memoizedState)&&(In=!0,xe&&(i=qo,i!==null)))throw i;t.memoizedState=g,t.baseState=_,t.baseQueue=W,c.lastRenderedState=g}return h===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function kh(t){var r=vn(),i=r.queue;if(i===null)throw Error(a(311));i.lastRenderedReducer=t;var c=i.dispatch,h=i.pending,g=r.memoizedState;if(h!==null){i.pending=null;var _=h=h.next;do g=t(g,_.action),_=_.next;while(_!==h);Ls(g,r.memoizedState)||(In=!0),r.memoizedState=g,r.baseQueue===null&&(r.baseState=g),i.lastRenderedState=g}return[g,c]}function Ay(t,r,i){var c=dt,h=vn(),g=_t;if(g){if(i===void 0)throw Error(a(407));i=i()}else i=r();var _=!Ls((Ft||h).memoizedState,i);if(_&&(h.memoizedState=i,In=!0),h=h.queue,Dh(Cy.bind(null,c,h,t),[t]),h.getSnapshot!==r||_||An!==null&&An.memoizedState.tag&1){if(c.flags|=2048,Zo(9,{destroy:void 0},Ny.bind(null,c,h,i,r),null),$t===null)throw Error(a(349));g||(xa&127)!==0||Iy(c,r,i)}return i}function Iy(t,r,i){t.flags|=16384,t={getSnapshot:r,value:i},r=dt.updateQueue,r===null?(r=ed(),dt.updateQueue=r,r.stores=[t]):(i=r.stores,i===null?r.stores=[t]:i.push(t))}function Ny(t,r,i,c){r.value=i,r.getSnapshot=c,Ry(r)&&Oy(t)}function Cy(t,r,i){return i(function(){Ry(r)&&Oy(t)})}function Ry(t){var r=t.getSnapshot;t=t.value;try{var i=r();return!Ls(t,i)}catch{return!0}}function Oy(t){var r=Gi(t,2);r!==null&&Is(r,t,2)}function Lh(t){var r=ps();if(typeof t=="function"){var i=t;if(t=i(),Ji){Le(!0);try{i()}finally{Le(!1)}}}return r.memoizedState=r.baseState=t,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:t},r}function jy(t,r,i,c){return t.baseState=i,jh(t,Ft,typeof c=="function"?c:ba)}function AA(t,r,i,c,h){if(ad(t))throw Error(a(485));if(t=r.action,t!==null){var g={payload:h,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(_){g.listeners.push(_)}};G.T!==null?i(!0):g.isTransition=!1,c(g),i=r.pending,i===null?(g.next=r.pending=g,ky(r,g)):(g.next=i.next,r.pending=i.next=g)}}function ky(t,r){var i=r.action,c=r.payload,h=t.state;if(r.isTransition){var g=G.T,_={};G.T=_;try{var k=i(h,c),W=G.S;W!==null&&W(_,k),Ly(t,r,k)}catch(re){Mh(t,r,re)}finally{g!==null&&_.types!==null&&(g.types=_.types),G.T=g}}else try{g=i(h,c),Ly(t,r,g)}catch(re){Mh(t,r,re)}}function Ly(t,r,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(c){My(t,r,c)},function(c){return Mh(t,r,c)}):My(t,r,i)}function My(t,r,i){r.status="fulfilled",r.value=i,Dy(r),t.state=i,r=t.pending,r!==null&&(i=r.next,i===r?t.pending=null:(i=i.next,r.next=i,ky(t,i)))}function Mh(t,r,i){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=i,Dy(r),r=r.next;while(r!==c)}t.action=null}function Dy(t){t=t.listeners;for(var r=0;r<t.length;r++)(0,t[r])()}function Uy(t,r){return r}function Py(t,r){if(_t){var i=$t.formState;if(i!==null){e:{var c=dt;if(_t){if(Wt){t:{for(var h=Wt,g=ar;h.nodeType!==8;){if(!g){h=null;break t}if(h=or(h.nextSibling),h===null){h=null;break t}}g=h.data,h=g==="F!"||g==="F"?h:null}if(h){Wt=or(h.nextSibling),c=h.data==="F!";break e}}Ha(c)}c=!1}c&&(r=i[0])}}return i=ps(),i.memoizedState=i.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Uy,lastRenderedState:r},i.queue=c,i=sx.bind(null,dt,c),c.dispatch=i,c=Lh(!1),g=Bh.bind(null,dt,!1,c.queue),c=ps(),h={state:r,dispatch:null,action:t,pending:null},c.queue=h,i=AA.bind(null,dt,h,g,i),h.dispatch=i,c.memoizedState=t,[r,i,!1]}function Vy(t){var r=vn();return zy(r,Ft,t)}function zy(t,r,i){if(r=jh(t,r,Uy)[0],t=nd(ba)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=uc(r)}catch(_){throw _===$o?$u:_}else c=r;r=vn();var h=r.queue,g=h.dispatch;return i!==r.memoizedState&&(dt.flags|=2048,Zo(9,{destroy:void 0},IA.bind(null,h,i),null)),[c,g,t]}function IA(t,r){t.action=r}function By(t){var r=vn(),i=Ft;if(i!==null)return zy(r,i,t);vn(),r=r.memoizedState,i=vn();var c=i.queue.dispatch;return i.memoizedState=t,[r,c,!1]}function Zo(t,r,i,c){return t={tag:t,create:i,deps:c,inst:r,next:null},r=dt.updateQueue,r===null&&(r=ed(),dt.updateQueue=r),i=r.lastEffect,i===null?r.lastEffect=t.next=t:(c=i.next,i.next=t,t.next=c,r.lastEffect=t),t}function Fy(){return vn().memoizedState}function sd(t,r,i,c){var h=ps();dt.flags|=t,h.memoizedState=Zo(1|r,{destroy:void 0},i,c===void 0?null:c)}function rd(t,r,i,c){var h=vn();c=c===void 0?null:c;var g=h.memoizedState.inst;Ft!==null&&c!==null&&Ah(c,Ft.memoizedState.deps)?h.memoizedState=Zo(r,g,i,c):(dt.flags|=t,h.memoizedState=Zo(1|r,g,i,c))}function Hy(t,r){sd(8390656,8,t,r)}function Dh(t,r){rd(2048,8,t,r)}function NA(t){dt.flags|=4;var r=dt.updateQueue;if(r===null)r=ed(),dt.updateQueue=r,r.events=[t];else{var i=r.events;i===null?r.events=[t]:i.push(t)}}function Gy(t){var r=vn().memoizedState;return NA({ref:r,nextImpl:t}),function(){if((Mt&2)!==0)throw Error(a(440));return r.impl.apply(void 0,arguments)}}function qy(t,r){return rd(4,2,t,r)}function $y(t,r){return rd(4,4,t,r)}function Yy(t,r){if(typeof r=="function"){t=t();var i=r(t);return function(){typeof i=="function"?i():r(null)}}if(r!=null)return t=t(),r.current=t,function(){r.current=null}}function Wy(t,r,i){i=i!=null?i.concat([t]):null,rd(4,4,Yy.bind(null,r,t),i)}function Uh(){}function Qy(t,r){var i=vn();r=r===void 0?null:r;var c=i.memoizedState;return r!==null&&Ah(r,c[1])?c[0]:(i.memoizedState=[t,r],t)}function Ky(t,r){var i=vn();r=r===void 0?null:r;var c=i.memoizedState;if(r!==null&&Ah(r,c[1]))return c[0];if(c=t(),Ji){Le(!0);try{t()}finally{Le(!1)}}return i.memoizedState=[c,r],c}function Ph(t,r,i){return i===void 0||(xa&1073741824)!==0&&(xt&261930)===0?t.memoizedState=r:(t.memoizedState=i,t=Zx(),dt.lanes|=t,Xa|=t,i)}function Zy(t,r,i,c){return Ls(i,r)?i:Wo.current!==null?(t=Ph(t,i,c),Ls(t,r)||(In=!0),t):(xa&42)===0||(xa&1073741824)!==0&&(xt&261930)===0?(In=!0,t.memoizedState=i):(t=Zx(),dt.lanes|=t,Xa|=t,r)}function Xy(t,r,i,c,h){var g=ae.p;ae.p=g!==0&&8>g?g:8;var _=G.T,k={};G.T=k,Bh(t,!1,r,i);try{var W=h(),re=G.S;if(re!==null&&re(k,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var xe=wA(W,c);dc(t,r,xe,zs(t))}else dc(t,r,c,zs(t))}catch(we){dc(t,r,{then:function(){},status:"rejected",reason:we},zs())}finally{ae.p=g,_!==null&&k.types!==null&&(_.types=k.types),G.T=_}}function CA(){}function Vh(t,r,i,c){if(t.tag!==5)throw Error(a(476));var h=Jy(t).queue;Xy(t,h,r,ne,i===null?CA:function(){return ex(t),i(c)})}function Jy(t){var r=t.memoizedState;if(r!==null)return r;r={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:ne},next:null};var i={};return r.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:i},next:null},t.memoizedState=r,t=t.alternate,t!==null&&(t.memoizedState=r),r}function ex(t){var r=Jy(t);r.next===null&&(r=t.alternate.memoizedState),dc(t,r.next.queue,{},zs())}function zh(){return Qn(Nc)}function tx(){return vn().memoizedState}function nx(){return vn().memoizedState}function RA(t){for(var r=t.return;r!==null;){switch(r.tag){case 24:case 3:var i=zs();t=$a(i);var c=Ya(r,t,i);c!==null&&(Is(c,r,i),ic(c,r,i)),r={cache:mh()},t.payload=r;return}r=r.return}}function OA(t,r,i){var c=zs();i={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},ad(t)?rx(r,i):(i=rh(t,r,i,c),i!==null&&(Is(i,t,c),ax(i,r,c)))}function sx(t,r,i){var c=zs();dc(t,r,i,c)}function dc(t,r,i,c){var h={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(ad(t))rx(r,h);else{var g=t.alternate;if(t.lanes===0&&(g===null||g.lanes===0)&&(g=r.lastRenderedReducer,g!==null))try{var _=r.lastRenderedState,k=g(_,i);if(h.hasEagerState=!0,h.eagerState=k,Ls(k,_))return Vu(t,r,h,0),$t===null&&Pu(),!1}catch{}finally{}if(i=rh(t,r,h,c),i!==null)return Is(i,t,c),ax(i,r,c),!0}return!1}function Bh(t,r,i,c){if(c={lane:2,revertLane:bp(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},ad(t)){if(r)throw Error(a(479))}else r=rh(t,i,c,2),r!==null&&Is(r,t,2)}function ad(t){var r=t.alternate;return t===dt||r!==null&&r===dt}function rx(t,r){Qo=Xu=!0;var i=t.pending;i===null?r.next=r:(r.next=i.next,i.next=r),t.pending=r}function ax(t,r,i){if((i&4194048)!==0){var c=r.lanes;c&=t.pendingLanes,i|=c,r.lanes=i,sa(t,i)}}var fc={readContext:Qn,use:td,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useLayoutEffect:hn,useInsertionEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useSyncExternalStore:hn,useId:hn,useHostTransitionStatus:hn,useFormState:hn,useActionState:hn,useOptimistic:hn,useMemoCache:hn,useCacheRefresh:hn};fc.useEffectEvent=hn;var ix={readContext:Qn,use:td,useCallback:function(t,r){return ps().memoizedState=[t,r===void 0?null:r],t},useContext:Qn,useEffect:Hy,useImperativeHandle:function(t,r,i){i=i!=null?i.concat([t]):null,sd(4194308,4,Yy.bind(null,r,t),i)},useLayoutEffect:function(t,r){return sd(4194308,4,t,r)},useInsertionEffect:function(t,r){sd(4,2,t,r)},useMemo:function(t,r){var i=ps();r=r===void 0?null:r;var c=t();if(Ji){Le(!0);try{t()}finally{Le(!1)}}return i.memoizedState=[c,r],c},useReducer:function(t,r,i){var c=ps();if(i!==void 0){var h=i(r);if(Ji){Le(!0);try{i(r)}finally{Le(!1)}}}else h=r;return c.memoizedState=c.baseState=h,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:h},c.queue=t,t=t.dispatch=OA.bind(null,dt,t),[c.memoizedState,t]},useRef:function(t){var r=ps();return t={current:t},r.memoizedState=t},useState:function(t){t=Lh(t);var r=t.queue,i=sx.bind(null,dt,r);return r.dispatch=i,[t.memoizedState,i]},useDebugValue:Uh,useDeferredValue:function(t,r){var i=ps();return Ph(i,t,r)},useTransition:function(){var t=Lh(!1);return t=Xy.bind(null,dt,t.queue,!0,!1),ps().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,r,i){var c=dt,h=ps();if(_t){if(i===void 0)throw Error(a(407));i=i()}else{if(i=r(),$t===null)throw Error(a(349));(xt&127)!==0||Iy(c,r,i)}h.memoizedState=i;var g={value:i,getSnapshot:r};return h.queue=g,Hy(Cy.bind(null,c,g,t),[t]),c.flags|=2048,Zo(9,{destroy:void 0},Ny.bind(null,c,g,i,r),null),i},useId:function(){var t=ps(),r=$t.identifierPrefix;if(_t){var i=Gr,c=Hr;i=(c&~(1<<32-Ne(c)-1)).toString(32)+i,r="_"+r+"R_"+i,i=Ju++,0<i&&(r+="H"+i.toString(32)),r+="_"}else i=SA++,r="_"+r+"r_"+i.toString(32)+"_";return t.memoizedState=r},useHostTransitionStatus:zh,useFormState:Py,useActionState:Py,useOptimistic:function(t){var r=ps();r.memoizedState=r.baseState=t;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=i,r=Bh.bind(null,dt,!0,i),i.dispatch=r,[t,r]},useMemoCache:Oh,useCacheRefresh:function(){return ps().memoizedState=RA.bind(null,dt)},useEffectEvent:function(t){var r=ps(),i={impl:t};return r.memoizedState=i,function(){if((Mt&2)!==0)throw Error(a(440));return i.impl.apply(void 0,arguments)}}},Fh={readContext:Qn,use:td,useCallback:Qy,useContext:Qn,useEffect:Dh,useImperativeHandle:Wy,useInsertionEffect:qy,useLayoutEffect:$y,useMemo:Ky,useReducer:nd,useRef:Fy,useState:function(){return nd(ba)},useDebugValue:Uh,useDeferredValue:function(t,r){var i=vn();return Zy(i,Ft.memoizedState,t,r)},useTransition:function(){var t=nd(ba)[0],r=vn().memoizedState;return[typeof t=="boolean"?t:uc(t),r]},useSyncExternalStore:Ay,useId:tx,useHostTransitionStatus:zh,useFormState:Vy,useActionState:Vy,useOptimistic:function(t,r){var i=vn();return jy(i,Ft,t,r)},useMemoCache:Oh,useCacheRefresh:nx};Fh.useEffectEvent=Gy;var ox={readContext:Qn,use:td,useCallback:Qy,useContext:Qn,useEffect:Dh,useImperativeHandle:Wy,useInsertionEffect:qy,useLayoutEffect:$y,useMemo:Ky,useReducer:kh,useRef:Fy,useState:function(){return kh(ba)},useDebugValue:Uh,useDeferredValue:function(t,r){var i=vn();return Ft===null?Ph(i,t,r):Zy(i,Ft.memoizedState,t,r)},useTransition:function(){var t=kh(ba)[0],r=vn().memoizedState;return[typeof t=="boolean"?t:uc(t),r]},useSyncExternalStore:Ay,useId:tx,useHostTransitionStatus:zh,useFormState:By,useActionState:By,useOptimistic:function(t,r){var i=vn();return Ft!==null?jy(i,Ft,t,r):(i.baseState=t,[t,i.queue.dispatch])},useMemoCache:Oh,useCacheRefresh:nx};ox.useEffectEvent=Gy;function Hh(t,r,i,c){r=t.memoizedState,i=i(c,r),i=i==null?r:v({},r,i),t.memoizedState=i,t.lanes===0&&(t.updateQueue.baseState=i)}var Gh={enqueueSetState:function(t,r,i){t=t._reactInternals;var c=zs(),h=$a(c);h.payload=r,i!=null&&(h.callback=i),r=Ya(t,h,c),r!==null&&(Is(r,t,c),ic(r,t,c))},enqueueReplaceState:function(t,r,i){t=t._reactInternals;var c=zs(),h=$a(c);h.tag=1,h.payload=r,i!=null&&(h.callback=i),r=Ya(t,h,c),r!==null&&(Is(r,t,c),ic(r,t,c))},enqueueForceUpdate:function(t,r){t=t._reactInternals;var i=zs(),c=$a(i);c.tag=2,r!=null&&(c.callback=r),r=Ya(t,c,i),r!==null&&(Is(r,t,i),ic(r,t,i))}};function lx(t,r,i,c,h,g,_){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,g,_):r.prototype&&r.prototype.isPureReactComponent?!Xl(i,c)||!Xl(h,g):!0}function cx(t,r,i,c){t=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(i,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(i,c),r.state!==t&&Gh.enqueueReplaceState(r,r.state,null)}function eo(t,r){var i=r;if("ref"in r){i={};for(var c in r)c!=="ref"&&(i[c]=r[c])}if(t=t.defaultProps){i===r&&(i=v({},i));for(var h in t)i[h]===void 0&&(i[h]=t[h])}return i}function ux(t){Uu(t)}function dx(t){console.error(t)}function fx(t){Uu(t)}function id(t,r){try{var i=t.onUncaughtError;i(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function hx(t,r,i){try{var c=t.onCaughtError;c(i.value,{componentStack:i.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function qh(t,r,i){return i=$a(i),i.tag=3,i.payload={element:null},i.callback=function(){id(t,r)},i}function px(t){return t=$a(t),t.tag=3,t}function mx(t,r,i,c){var h=i.type.getDerivedStateFromError;if(typeof h=="function"){var g=c.value;t.payload=function(){return h(g)},t.callback=function(){hx(r,i,c)}}var _=i.stateNode;_!==null&&typeof _.componentDidCatch=="function"&&(t.callback=function(){hx(r,i,c),typeof h!="function"&&(Ja===null?Ja=new Set([this]):Ja.add(this));var k=c.stack;this.componentDidCatch(c.value,{componentStack:k!==null?k:""})})}function jA(t,r,i,c,h){if(i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=i.alternate,r!==null&&Ho(r,i,h,!0),i=Ds.current,i!==null){switch(i.tag){case 31:case 13:return ir===null?xd():i.alternate===null&&pn===0&&(pn=3),i.flags&=-257,i.flags|=65536,i.lanes=h,c===Yu?i.flags|=16384:(r=i.updateQueue,r===null?i.updateQueue=new Set([c]):r.add(c),gp(t,c,h)),!1;case 22:return i.flags|=65536,c===Yu?i.flags|=16384:(r=i.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},i.updateQueue=r):(i=r.retryQueue,i===null?r.retryQueue=new Set([c]):i.add(c)),gp(t,c,h)),!1}throw Error(a(435,i.tag))}return gp(t,c,h),xd(),!1}if(_t)return r=Ds.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=h,c!==uh&&(t=Error(a(422),{cause:c}),tc(nr(t,i)))):(c!==uh&&(r=Error(a(423),{cause:c}),tc(nr(r,i))),t=t.current.alternate,t.flags|=65536,h&=-h,t.lanes|=h,c=nr(c,i),h=qh(t.stateNode,c,h),_h(t,h),pn!==4&&(pn=2)),!1;var g=Error(a(520),{cause:c});if(g=nr(g,i),vc===null?vc=[g]:vc.push(g),pn!==4&&(pn=2),r===null)return!0;c=nr(c,i),i=r;do{switch(i.tag){case 3:return i.flags|=65536,t=h&-h,i.lanes|=t,t=qh(i.stateNode,c,t),_h(i,t),!1;case 1:if(r=i.type,g=i.stateNode,(i.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Ja===null||!Ja.has(g))))return i.flags|=65536,h&=-h,i.lanes|=h,h=px(h),mx(h,t,i,c),_h(i,h),!1}i=i.return}while(i!==null);return!1}var $h=Error(a(461)),In=!1;function Kn(t,r,i,c){r.child=t===null?by(r,null,i,c):Xi(r,t.child,i,c)}function gx(t,r,i,c,h){i=i.render;var g=r.ref;if("ref"in c){var _={};for(var k in c)k!=="ref"&&(_[k]=c[k])}else _=c;return Wi(r),c=Ih(t,r,i,_,g,h),k=Nh(),t!==null&&!In?(Ch(t,r,h),va(t,r,h)):(_t&&k&&lh(r),r.flags|=1,Kn(t,r,c,h),r.child)}function yx(t,r,i,c,h){if(t===null){var g=i.type;return typeof g=="function"&&!ah(g)&&g.defaultProps===void 0&&i.compare===null?(r.tag=15,r.type=g,xx(t,r,g,c,h)):(t=Bu(i.type,null,c,r,r.mode,h),t.ref=r.ref,t.return=r,r.child=t)}if(g=t.child,!ep(t,h)){var _=g.memoizedProps;if(i=i.compare,i=i!==null?i:Xl,i(_,c)&&t.ref===r.ref)return va(t,r,h)}return r.flags|=1,t=pa(g,c),t.ref=r.ref,t.return=r,r.child=t}function xx(t,r,i,c,h){if(t!==null){var g=t.memoizedProps;if(Xl(g,c)&&t.ref===r.ref)if(In=!1,r.pendingProps=c=g,ep(t,h))(t.flags&131072)!==0&&(In=!0);else return r.lanes=t.lanes,va(t,r,h)}return Yh(t,r,i,c,h)}function bx(t,r,i,c){var h=c.children,g=t!==null?t.memoizedState:null;if(t===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(g=g!==null?g.baseLanes|i:i,t!==null){for(c=r.child=t.child,h=0;c!==null;)h=h|c.lanes|c.childLanes,c=c.sibling;c=h&~g}else c=0,r.child=null;return vx(t,r,g,i,c)}if((i&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},t!==null&&qu(r,g!==null?g.cachePool:null),g!==null?Ey(r,g):wh(),wy(r);else return c=r.lanes=536870912,vx(t,r,g!==null?g.baseLanes|i:i,i,c)}else g!==null?(qu(r,g.cachePool),Ey(r,g),Qa(),r.memoizedState=null):(t!==null&&qu(r,null),wh(),Qa());return Kn(t,r,h,i),r.child}function hc(t,r){return t!==null&&t.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function vx(t,r,i,c,h){var g=yh();return g=g===null?null:{parent:Tn._currentValue,pool:g},r.memoizedState={baseLanes:i,cachePool:g},t!==null&&qu(r,null),wh(),wy(r),t!==null&&Ho(t,r,c,!0),r.childLanes=h,null}function od(t,r){return r=cd({mode:r.mode,children:r.children},t.mode),r.ref=t.ref,t.child=r,r.return=t,r}function _x(t,r,i){return Xi(r,t.child,null,i),t=od(r,r.pendingProps),t.flags|=2,Us(r),r.memoizedState=null,t}function kA(t,r,i){var c=r.pendingProps,h=(r.flags&128)!==0;if(r.flags&=-129,t===null){if(_t){if(c.mode==="hidden")return t=od(r,c),r.lanes=536870912,hc(null,t);if(Th(r),(t=Wt)?(t=kb(t,ar),t=t!==null&&t.data==="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:Ba!==null?{id:Hr,overflow:Gr}:null,retryLane:536870912,hydrationErrors:null},i=ry(t),i.return=r,r.child=i,Wn=r,Wt=null)):t=null,t===null)throw Ha(r);return r.lanes=536870912,null}return od(r,c)}var g=t.memoizedState;if(g!==null){var _=g.dehydrated;if(Th(r),h)if(r.flags&256)r.flags&=-257,r=_x(t,r,i);else if(r.memoizedState!==null)r.child=t.child,r.flags|=128,r=null;else throw Error(a(558));else if(In||Ho(t,r,i,!1),h=(i&t.childLanes)!==0,In||h){if(c=$t,c!==null&&(_=Dr(c,i),_!==0&&_!==g.retryLane))throw g.retryLane=_,Gi(t,_),Is(c,t,_),$h;xd(),r=_x(t,r,i)}else t=g.treeContext,Wt=or(_.nextSibling),Wn=r,_t=!0,Fa=null,ar=!1,t!==null&&oy(r,t),r=od(r,c),r.flags|=4096;return r}return t=pa(t.child,{mode:c.mode,children:c.children}),t.ref=r.ref,r.child=t,t.return=r,t}function ld(t,r){var i=r.ref;if(i===null)t!==null&&t.ref!==null&&(r.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(a(284));(t===null||t.ref!==i)&&(r.flags|=4194816)}}function Yh(t,r,i,c,h){return Wi(r),i=Ih(t,r,i,c,void 0,h),c=Nh(),t!==null&&!In?(Ch(t,r,h),va(t,r,h)):(_t&&c&&lh(r),r.flags|=1,Kn(t,r,i,h),r.child)}function Ex(t,r,i,c,h,g){return Wi(r),r.updateQueue=null,i=Ty(r,c,i,h),Sy(t),c=Nh(),t!==null&&!In?(Ch(t,r,g),va(t,r,g)):(_t&&c&&lh(r),r.flags|=1,Kn(t,r,i,g),r.child)}function wx(t,r,i,c,h){if(Wi(r),r.stateNode===null){var g=Vo,_=i.contextType;typeof _=="object"&&_!==null&&(g=Qn(_)),g=new i(c,g),r.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Gh,r.stateNode=g,g._reactInternals=r,g=r.stateNode,g.props=c,g.state=r.memoizedState,g.refs={},bh(r),_=i.contextType,g.context=typeof _=="object"&&_!==null?Qn(_):Vo,g.state=r.memoizedState,_=i.getDerivedStateFromProps,typeof _=="function"&&(Hh(r,i,_,c),g.state=r.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(_=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),_!==g.state&&Gh.enqueueReplaceState(g,g.state,null),lc(r,c,g,h),oc(),g.state=r.memoizedState),typeof g.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(t===null){g=r.stateNode;var k=r.memoizedProps,W=eo(i,k);g.props=W;var re=g.context,xe=i.contextType;_=Vo,typeof xe=="object"&&xe!==null&&(_=Qn(xe));var we=i.getDerivedStateFromProps;xe=typeof we=="function"||typeof g.getSnapshotBeforeUpdate=="function",k=r.pendingProps!==k,xe||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(k||re!==_)&&cx(r,g,c,_),qa=!1;var le=r.memoizedState;g.state=le,lc(r,c,g,h),oc(),re=r.memoizedState,k||le!==re||qa?(typeof we=="function"&&(Hh(r,i,we,c),re=r.memoizedState),(W=qa||lx(r,i,W,c,le,re,_))?(xe||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(r.flags|=4194308)):(typeof g.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=re),g.props=c,g.state=re,g.context=_,c=W):(typeof g.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{g=r.stateNode,vh(t,r),_=r.memoizedProps,xe=eo(i,_),g.props=xe,we=r.pendingProps,le=g.context,re=i.contextType,W=Vo,typeof re=="object"&&re!==null&&(W=Qn(re)),k=i.getDerivedStateFromProps,(re=typeof k=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(_!==we||le!==W)&&cx(r,g,c,W),qa=!1,le=r.memoizedState,g.state=le,lc(r,c,g,h),oc();var he=r.memoizedState;_!==we||le!==he||qa||t!==null&&t.dependencies!==null&&Hu(t.dependencies)?(typeof k=="function"&&(Hh(r,i,k,c),he=r.memoizedState),(xe=qa||lx(r,i,xe,c,le,he,W)||t!==null&&t.dependencies!==null&&Hu(t.dependencies))?(re||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,he,W),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,he,W)),typeof g.componentDidUpdate=="function"&&(r.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof g.componentDidUpdate!="function"||_===t.memoizedProps&&le===t.memoizedState||(r.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||_===t.memoizedProps&&le===t.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=he),g.props=c,g.state=he,g.context=W,c=xe):(typeof g.componentDidUpdate!="function"||_===t.memoizedProps&&le===t.memoizedState||(r.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||_===t.memoizedProps&&le===t.memoizedState||(r.flags|=1024),c=!1)}return g=c,ld(t,r),c=(r.flags&128)!==0,g||c?(g=r.stateNode,i=c&&typeof i.getDerivedStateFromError!="function"?null:g.render(),r.flags|=1,t!==null&&c?(r.child=Xi(r,t.child,null,h),r.child=Xi(r,null,i,h)):Kn(t,r,i,h),r.memoizedState=g.state,t=r.child):t=va(t,r,h),t}function Sx(t,r,i,c){return $i(),r.flags|=256,Kn(t,r,i,c),r.child}var Wh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qh(t){return{baseLanes:t,cachePool:hy()}}function Kh(t,r,i){return t=t!==null?t.childLanes&~i:0,r&&(t|=Vs),t}function Tx(t,r,i){var c=r.pendingProps,h=!1,g=(r.flags&128)!==0,_;if((_=g)||(_=t!==null&&t.memoizedState===null?!1:(bn.current&2)!==0),_&&(h=!0,r.flags&=-129),_=(r.flags&32)!==0,r.flags&=-33,t===null){if(_t){if(h?Wa(r):Qa(),(t=Wt)?(t=kb(t,ar),t=t!==null&&t.data!=="&"?t:null,t!==null&&(r.memoizedState={dehydrated:t,treeContext:Ba!==null?{id:Hr,overflow:Gr}:null,retryLane:536870912,hydrationErrors:null},i=ry(t),i.return=r,r.child=i,Wn=r,Wt=null)):t=null,t===null)throw Ha(r);return jp(t)?r.lanes=32:r.lanes=536870912,null}var k=c.children;return c=c.fallback,h?(Qa(),h=r.mode,k=cd({mode:"hidden",children:k},h),c=qi(c,h,i,null),k.return=r,c.return=r,k.sibling=c,r.child=k,c=r.child,c.memoizedState=Qh(i),c.childLanes=Kh(t,_,i),r.memoizedState=Wh,hc(null,c)):(Wa(r),Zh(r,k))}var W=t.memoizedState;if(W!==null&&(k=W.dehydrated,k!==null)){if(g)r.flags&256?(Wa(r),r.flags&=-257,r=Xh(t,r,i)):r.memoizedState!==null?(Qa(),r.child=t.child,r.flags|=128,r=null):(Qa(),k=c.fallback,h=r.mode,c=cd({mode:"visible",children:c.children},h),k=qi(k,h,i,null),k.flags|=2,c.return=r,k.return=r,c.sibling=k,r.child=c,Xi(r,t.child,null,i),c=r.child,c.memoizedState=Qh(i),c.childLanes=Kh(t,_,i),r.memoizedState=Wh,r=hc(null,c));else if(Wa(r),jp(k)){if(_=k.nextSibling&&k.nextSibling.dataset,_)var re=_.dgst;_=re,c=Error(a(419)),c.stack="",c.digest=_,tc({value:c,source:null,stack:null}),r=Xh(t,r,i)}else if(In||Ho(t,r,i,!1),_=(i&t.childLanes)!==0,In||_){if(_=$t,_!==null&&(c=Dr(_,i),c!==0&&c!==W.retryLane))throw W.retryLane=c,Gi(t,c),Is(_,t,c),$h;Op(k)||xd(),r=Xh(t,r,i)}else Op(k)?(r.flags|=192,r.child=t.child,r=null):(t=W.treeContext,Wt=or(k.nextSibling),Wn=r,_t=!0,Fa=null,ar=!1,t!==null&&oy(r,t),r=Zh(r,c.children),r.flags|=4096);return r}return h?(Qa(),k=c.fallback,h=r.mode,W=t.child,re=W.sibling,c=pa(W,{mode:"hidden",children:c.children}),c.subtreeFlags=W.subtreeFlags&65011712,re!==null?k=pa(re,k):(k=qi(k,h,i,null),k.flags|=2),k.return=r,c.return=r,c.sibling=k,r.child=c,hc(null,c),c=r.child,k=t.child.memoizedState,k===null?k=Qh(i):(h=k.cachePool,h!==null?(W=Tn._currentValue,h=h.parent!==W?{parent:W,pool:W}:h):h=hy(),k={baseLanes:k.baseLanes|i,cachePool:h}),c.memoizedState=k,c.childLanes=Kh(t,_,i),r.memoizedState=Wh,hc(t.child,c)):(Wa(r),i=t.child,t=i.sibling,i=pa(i,{mode:"visible",children:c.children}),i.return=r,i.sibling=null,t!==null&&(_=r.deletions,_===null?(r.deletions=[t],r.flags|=16):_.push(t)),r.child=i,r.memoizedState=null,i)}function Zh(t,r){return r=cd({mode:"visible",children:r},t.mode),r.return=t,t.child=r}function cd(t,r){return t=Ms(22,t,null,r),t.lanes=0,t}function Xh(t,r,i){return Xi(r,t.child,null,i),t=Zh(r,r.pendingProps.children),t.flags|=2,r.memoizedState=null,t}function Ax(t,r,i){t.lanes|=r;var c=t.alternate;c!==null&&(c.lanes|=r),hh(t.return,r,i)}function Jh(t,r,i,c,h,g){var _=t.memoizedState;_===null?t.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:i,tailMode:h,treeForkCount:g}:(_.isBackwards=r,_.rendering=null,_.renderingStartTime=0,_.last=c,_.tail=i,_.tailMode=h,_.treeForkCount=g)}function Ix(t,r,i){var c=r.pendingProps,h=c.revealOrder,g=c.tail;c=c.children;var _=bn.current,k=(_&2)!==0;if(k?(_=_&1|2,r.flags|=128):_&=1,$(bn,_),Kn(t,r,c,i),c=_t?ec:0,!k&&t!==null&&(t.flags&128)!==0)e:for(t=r.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ax(t,i,r);else if(t.tag===19)Ax(t,i,r);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===r)break e;for(;t.sibling===null;){if(t.return===null||t.return===r)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(h){case"forwards":for(i=r.child,h=null;i!==null;)t=i.alternate,t!==null&&Zu(t)===null&&(h=i),i=i.sibling;i=h,i===null?(h=r.child,r.child=null):(h=i.sibling,i.sibling=null),Jh(r,!1,h,i,g,c);break;case"backwards":case"unstable_legacy-backwards":for(i=null,h=r.child,r.child=null;h!==null;){if(t=h.alternate,t!==null&&Zu(t)===null){r.child=h;break}t=h.sibling,h.sibling=i,i=h,h=t}Jh(r,!0,i,null,g,c);break;case"together":Jh(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function va(t,r,i){if(t!==null&&(r.dependencies=t.dependencies),Xa|=r.lanes,(i&r.childLanes)===0)if(t!==null){if(Ho(t,r,i,!1),(i&r.childLanes)===0)return null}else return null;if(t!==null&&r.child!==t.child)throw Error(a(153));if(r.child!==null){for(t=r.child,i=pa(t,t.pendingProps),r.child=i,i.return=r;t.sibling!==null;)t=t.sibling,i=i.sibling=pa(t,t.pendingProps),i.return=r;i.sibling=null}return r.child}function ep(t,r){return(t.lanes&r)!==0?!0:(t=t.dependencies,!!(t!==null&&Hu(t)))}function LA(t,r,i){switch(r.tag){case 3:ce(r,r.stateNode.containerInfo),Ga(r,Tn,t.memoizedState.cache),$i();break;case 27:case 5:fe(r);break;case 4:ce(r,r.stateNode.containerInfo);break;case 10:Ga(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Th(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(Wa(r),r.flags|=128,null):(i&r.child.childLanes)!==0?Tx(t,r,i):(Wa(r),t=va(t,r,i),t!==null?t.sibling:null);Wa(r);break;case 19:var h=(t.flags&128)!==0;if(c=(i&r.childLanes)!==0,c||(Ho(t,r,i,!1),c=(i&r.childLanes)!==0),h){if(c)return Ix(t,r,i);r.flags|=128}if(h=r.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),$(bn,bn.current),c)break;return null;case 22:return r.lanes=0,bx(t,r,i,r.pendingProps);case 24:Ga(r,Tn,t.memoizedState.cache)}return va(t,r,i)}function Nx(t,r,i){if(t!==null)if(t.memoizedProps!==r.pendingProps)In=!0;else{if(!ep(t,i)&&(r.flags&128)===0)return In=!1,LA(t,r,i);In=(t.flags&131072)!==0}else In=!1,_t&&(r.flags&1048576)!==0&&iy(r,ec,r.index);switch(r.lanes=0,r.tag){case 16:e:{var c=r.pendingProps;if(t=Ki(r.elementType),r.type=t,typeof t=="function")ah(t)?(c=eo(t,c),r.tag=1,r=wx(null,r,t,c,i)):(r.tag=0,r=Yh(null,r,t,c,i));else{if(t!=null){var h=t.$$typeof;if(h===H){r.tag=11,r=gx(null,r,t,c,i);break e}else if(h===A){r.tag=14,r=yx(null,r,t,c,i);break e}}throw r=ve(t)||t,Error(a(306,r,""))}}return r;case 0:return Yh(t,r,r.type,r.pendingProps,i);case 1:return c=r.type,h=eo(c,r.pendingProps),wx(t,r,c,h,i);case 3:e:{if(ce(r,r.stateNode.containerInfo),t===null)throw Error(a(387));c=r.pendingProps;var g=r.memoizedState;h=g.element,vh(t,r),lc(r,c,null,i);var _=r.memoizedState;if(c=_.cache,Ga(r,Tn,c),c!==g.cache&&ph(r,[Tn],i,!0),oc(),c=_.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:_.cache},r.updateQueue.baseState=g,r.memoizedState=g,r.flags&256){r=Sx(t,r,c,i);break e}else if(c!==h){h=nr(Error(a(424)),r),tc(h),r=Sx(t,r,c,i);break e}else{switch(t=r.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(Wt=or(t.firstChild),Wn=r,_t=!0,Fa=null,ar=!0,i=by(r,null,c,i),r.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling}else{if($i(),c===h){r=va(t,r,i);break e}Kn(t,r,c,i)}r=r.child}return r;case 26:return ld(t,r),t===null?(i=Vb(r.type,null,r.pendingProps,null))?r.memoizedState=i:_t||(i=r.type,t=r.pendingProps,c=Td(pe.current).createElement(i),c[cn]=r,c[wn]=t,Zn(c,i,t),un(c),r.stateNode=c):r.memoizedState=Vb(r.type,t.memoizedProps,r.pendingProps,t.memoizedState),null;case 27:return fe(r),t===null&&_t&&(c=r.stateNode=Db(r.type,r.pendingProps,pe.current),Wn=r,ar=!0,h=Wt,si(r.type)?(kp=h,Wt=or(c.firstChild)):Wt=h),Kn(t,r,r.pendingProps.children,i),ld(t,r),t===null&&(r.flags|=4194304),r.child;case 5:return t===null&&_t&&((h=c=Wt)&&(c=u2(c,r.type,r.pendingProps,ar),c!==null?(r.stateNode=c,Wn=r,Wt=or(c.firstChild),ar=!1,h=!0):h=!1),h||Ha(r)),fe(r),h=r.type,g=r.pendingProps,_=t!==null?t.memoizedProps:null,c=g.children,Np(h,g)?c=null:_!==null&&Np(h,_)&&(r.flags|=32),r.memoizedState!==null&&(h=Ih(t,r,TA,null,null,i),Nc._currentValue=h),ld(t,r),Kn(t,r,c,i),r.child;case 6:return t===null&&_t&&((t=i=Wt)&&(i=d2(i,r.pendingProps,ar),i!==null?(r.stateNode=i,Wn=r,Wt=null,t=!0):t=!1),t||Ha(r)),null;case 13:return Tx(t,r,i);case 4:return ce(r,r.stateNode.containerInfo),c=r.pendingProps,t===null?r.child=Xi(r,null,c,i):Kn(t,r,c,i),r.child;case 11:return gx(t,r,r.type,r.pendingProps,i);case 7:return Kn(t,r,r.pendingProps,i),r.child;case 8:return Kn(t,r,r.pendingProps.children,i),r.child;case 12:return Kn(t,r,r.pendingProps.children,i),r.child;case 10:return c=r.pendingProps,Ga(r,r.type,c.value),Kn(t,r,c.children,i),r.child;case 9:return h=r.type._context,c=r.pendingProps.children,Wi(r),h=Qn(h),c=c(h),r.flags|=1,Kn(t,r,c,i),r.child;case 14:return yx(t,r,r.type,r.pendingProps,i);case 15:return xx(t,r,r.type,r.pendingProps,i);case 19:return Ix(t,r,i);case 31:return kA(t,r,i);case 22:return bx(t,r,i,r.pendingProps);case 24:return Wi(r),c=Qn(Tn),t===null?(h=yh(),h===null&&(h=$t,g=mh(),h.pooledCache=g,g.refCount++,g!==null&&(h.pooledCacheLanes|=i),h=g),r.memoizedState={parent:c,cache:h},bh(r),Ga(r,Tn,h)):((t.lanes&i)!==0&&(vh(t,r),lc(r,null,null,i),oc()),h=t.memoizedState,g=r.memoizedState,h.parent!==c?(h={parent:c,cache:c},r.memoizedState=h,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=h),Ga(r,Tn,c)):(c=g.cache,Ga(r,Tn,c),c!==h.cache&&ph(r,[Tn],i,!0))),Kn(t,r,r.pendingProps.children,i),r.child;case 29:throw r.pendingProps}throw Error(a(156,r.tag))}function _a(t){t.flags|=4}function tp(t,r,i,c,h){if((r=(t.mode&32)!==0)&&(r=!1),r){if(t.flags|=16777216,(h&335544128)===h)if(t.stateNode.complete)t.flags|=8192;else if(tb())t.flags|=8192;else throw Zi=Yu,xh}else t.flags&=-16777217}function Cx(t,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!Gb(r))if(tb())t.flags|=8192;else throw Zi=Yu,xh}function ud(t,r){r!==null&&(t.flags|=4),t.flags&16384&&(r=t.tag!==22?_s():536870912,t.lanes|=r,tl|=r)}function pc(t,r){if(!_t)switch(t.tailMode){case"hidden":r=t.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?r||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function Qt(t){var r=t.alternate!==null&&t.alternate.child===t.child,i=0,c=0;if(r)for(var h=t.child;h!==null;)i|=h.lanes|h.childLanes,c|=h.subtreeFlags&65011712,c|=h.flags&65011712,h.return=t,h=h.sibling;else for(h=t.child;h!==null;)i|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=t,h=h.sibling;return t.subtreeFlags|=c,t.childLanes=i,r}function MA(t,r,i){var c=r.pendingProps;switch(ch(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(r),null;case 1:return Qt(r),null;case 3:return i=r.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),ya(Tn),De(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Fo(r)?_a(r):t===null||t.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,dh())),Qt(r),null;case 26:var h=r.type,g=r.memoizedState;return t===null?(_a(r),g!==null?(Qt(r),Cx(r,g)):(Qt(r),tp(r,h,null,c,i))):g?g!==t.memoizedState?(_a(r),Qt(r),Cx(r,g)):(Qt(r),r.flags&=-16777217):(t=t.memoizedProps,t!==c&&_a(r),Qt(r),tp(r,h,t,c,i)),null;case 27:if(Se(r),i=pe.current,h=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==c&&_a(r);else{if(!c){if(r.stateNode===null)throw Error(a(166));return Qt(r),null}t=Z.current,Fo(r)?ly(r):(t=Db(h,c,i),r.stateNode=t,_a(r))}return Qt(r),null;case 5:if(Se(r),h=r.type,t!==null&&r.stateNode!=null)t.memoizedProps!==c&&_a(r);else{if(!c){if(r.stateNode===null)throw Error(a(166));return Qt(r),null}if(g=Z.current,Fo(r))ly(r);else{var _=Td(pe.current);switch(g){case 1:g=_.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:g=_.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":g=_.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":g=_.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":g=_.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof c.is=="string"?_.createElement("select",{is:c.is}):_.createElement("select"),c.multiple?g.multiple=!0:c.size&&(g.size=c.size);break;default:g=typeof c.is=="string"?_.createElement(h,{is:c.is}):_.createElement(h)}}g[cn]=r,g[wn]=c;e:for(_=r.child;_!==null;){if(_.tag===5||_.tag===6)g.appendChild(_.stateNode);else if(_.tag!==4&&_.tag!==27&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===r)break e;for(;_.sibling===null;){if(_.return===null||_.return===r)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}r.stateNode=g;e:switch(Zn(g,h,c),h){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&_a(r)}}return Qt(r),tp(r,r.type,t===null?null:t.memoizedProps,r.pendingProps,i),null;case 6:if(t&&r.stateNode!=null)t.memoizedProps!==c&&_a(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(a(166));if(t=pe.current,Fo(r)){if(t=r.stateNode,i=r.memoizedProps,c=null,h=Wn,h!==null)switch(h.tag){case 27:case 5:c=h.memoizedProps}t[cn]=r,t=!!(t.nodeValue===i||c!==null&&c.suppressHydrationWarning===!0||Tb(t.nodeValue,i)),t||Ha(r,!0)}else t=Td(t).createTextNode(c),t[cn]=r,r.stateNode=t}return Qt(r),null;case 31:if(i=r.memoizedState,t===null||t.memoizedState!==null){if(c=Fo(r),i!==null){if(t===null){if(!c)throw Error(a(318));if(t=r.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(a(557));t[cn]=r}else $i(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Qt(r),t=!1}else i=dh(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=i),t=!0;if(!t)return r.flags&256?(Us(r),r):(Us(r),null);if((r.flags&128)!==0)throw Error(a(558))}return Qt(r),null;case 13:if(c=r.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(h=Fo(r),c!==null&&c.dehydrated!==null){if(t===null){if(!h)throw Error(a(318));if(h=r.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(a(317));h[cn]=r}else $i(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Qt(r),h=!1}else h=dh(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=h),h=!0;if(!h)return r.flags&256?(Us(r),r):(Us(r),null)}return Us(r),(r.flags&128)!==0?(r.lanes=i,r):(i=c!==null,t=t!==null&&t.memoizedState!==null,i&&(c=r.child,h=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(h=c.alternate.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==h&&(c.flags|=2048)),i!==t&&i&&(r.child.flags|=8192),ud(r,r.updateQueue),Qt(r),null);case 4:return De(),t===null&&wp(r.stateNode.containerInfo),Qt(r),null;case 10:return ya(r.type),Qt(r),null;case 19:if(V(bn),c=r.memoizedState,c===null)return Qt(r),null;if(h=(r.flags&128)!==0,g=c.rendering,g===null)if(h)pc(c,!1);else{if(pn!==0||t!==null&&(t.flags&128)!==0)for(t=r.child;t!==null;){if(g=Zu(t),g!==null){for(r.flags|=128,pc(c,!1),t=g.updateQueue,r.updateQueue=t,ud(r,t),r.subtreeFlags=0,t=i,i=r.child;i!==null;)sy(i,t),i=i.sibling;return $(bn,bn.current&1|2),_t&&ma(r,c.treeForkCount),r.child}t=t.sibling}c.tail!==null&&Ve()>md&&(r.flags|=128,h=!0,pc(c,!1),r.lanes=4194304)}else{if(!h)if(t=Zu(g),t!==null){if(r.flags|=128,h=!0,t=t.updateQueue,r.updateQueue=t,ud(r,t),pc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!g.alternate&&!_t)return Qt(r),null}else 2*Ve()-c.renderingStartTime>md&&i!==536870912&&(r.flags|=128,h=!0,pc(c,!1),r.lanes=4194304);c.isBackwards?(g.sibling=r.child,r.child=g):(t=c.last,t!==null?t.sibling=g:r.child=g,c.last=g)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Ve(),t.sibling=null,i=bn.current,$(bn,h?i&1|2:i&1),_t&&ma(r,c.treeForkCount),t):(Qt(r),null);case 22:case 23:return Us(r),Sh(),c=r.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(i&536870912)!==0&&(r.flags&128)===0&&(Qt(r),r.subtreeFlags&6&&(r.flags|=8192)):Qt(r),i=r.updateQueue,i!==null&&ud(r,i.retryQueue),i=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==i&&(r.flags|=2048),t!==null&&V(Qi),null;case 24:return i=null,t!==null&&(i=t.memoizedState.cache),r.memoizedState.cache!==i&&(r.flags|=2048),ya(Tn),Qt(r),null;case 25:return null;case 30:return null}throw Error(a(156,r.tag))}function DA(t,r){switch(ch(r),r.tag){case 1:return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 3:return ya(Tn),De(),t=r.flags,(t&65536)!==0&&(t&128)===0?(r.flags=t&-65537|128,r):null;case 26:case 27:case 5:return Se(r),null;case 31:if(r.memoizedState!==null){if(Us(r),r.alternate===null)throw Error(a(340));$i()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 13:if(Us(r),t=r.memoizedState,t!==null&&t.dehydrated!==null){if(r.alternate===null)throw Error(a(340));$i()}return t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 19:return V(bn),null;case 4:return De(),null;case 10:return ya(r.type),null;case 22:case 23:return Us(r),Sh(),t!==null&&V(Qi),t=r.flags,t&65536?(r.flags=t&-65537|128,r):null;case 24:return ya(Tn),null;case 25:return null;default:return null}}function Rx(t,r){switch(ch(r),r.tag){case 3:ya(Tn),De();break;case 26:case 27:case 5:Se(r);break;case 4:De();break;case 31:r.memoizedState!==null&&Us(r);break;case 13:Us(r);break;case 19:V(bn);break;case 10:ya(r.type);break;case 22:case 23:Us(r),Sh(),t!==null&&V(Qi);break;case 24:ya(Tn)}}function mc(t,r){try{var i=r.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var h=c.next;i=h;do{if((i.tag&t)===t){c=void 0;var g=i.create,_=i.inst;c=g(),_.destroy=c}i=i.next}while(i!==h)}}catch(k){zt(r,r.return,k)}}function Ka(t,r,i){try{var c=r.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&t)===t){var _=c.inst,k=_.destroy;if(k!==void 0){_.destroy=void 0,h=r;var W=i,re=k;try{re()}catch(xe){zt(h,W,xe)}}}c=c.next}while(c!==g)}}catch(xe){zt(r,r.return,xe)}}function Ox(t){var r=t.updateQueue;if(r!==null){var i=t.stateNode;try{_y(r,i)}catch(c){zt(t,t.return,c)}}}function jx(t,r,i){i.props=eo(t.type,t.memoizedProps),i.state=t.memoizedState;try{i.componentWillUnmount()}catch(c){zt(t,r,c)}}function gc(t,r){try{var i=t.ref;if(i!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof i=="function"?t.refCleanup=i(c):i.current=c}}catch(h){zt(t,r,h)}}function qr(t,r){var i=t.ref,c=t.refCleanup;if(i!==null)if(typeof c=="function")try{c()}catch(h){zt(t,r,h)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(h){zt(t,r,h)}else i.current=null}function kx(t){var r=t.type,i=t.memoizedProps,c=t.stateNode;try{e:switch(r){case"button":case"input":case"select":case"textarea":i.autoFocus&&c.focus();break e;case"img":i.src?c.src=i.src:i.srcSet&&(c.srcset=i.srcSet)}}catch(h){zt(t,t.return,h)}}function np(t,r,i){try{var c=t.stateNode;r2(c,t.type,i,r),c[wn]=r}catch(h){zt(t,t.return,h)}}function Lx(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&si(t.type)||t.tag===4}function sp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Lx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&si(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function rp(t,r,i){var c=t.tag;if(c===5||c===6)t=t.stateNode,r?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(t,r):(r=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,r.appendChild(t),i=i._reactRootContainer,i!=null||r.onclick!==null||(r.onclick=jt));else if(c!==4&&(c===27&&si(t.type)&&(i=t.stateNode,r=null),t=t.child,t!==null))for(rp(t,r,i),t=t.sibling;t!==null;)rp(t,r,i),t=t.sibling}function dd(t,r,i){var c=t.tag;if(c===5||c===6)t=t.stateNode,r?i.insertBefore(t,r):i.appendChild(t);else if(c!==4&&(c===27&&si(t.type)&&(i=t.stateNode),t=t.child,t!==null))for(dd(t,r,i),t=t.sibling;t!==null;)dd(t,r,i),t=t.sibling}function Mx(t){var r=t.stateNode,i=t.memoizedProps;try{for(var c=t.type,h=r.attributes;h.length;)r.removeAttributeNode(h[0]);Zn(r,c,i),r[cn]=t,r[wn]=i}catch(g){zt(t,t.return,g)}}var Ea=!1,Nn=!1,ap=!1,Dx=typeof WeakSet=="function"?WeakSet:Set,Fn=null;function UA(t,r){if(t=t.containerInfo,Ap=jd,t=W0(t),Xf(t)){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else e:{i=(i=t.ownerDocument)&&i.defaultView||window;var c=i.getSelection&&i.getSelection();if(c&&c.rangeCount!==0){i=c.anchorNode;var h=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{i.nodeType,g.nodeType}catch{i=null;break e}var _=0,k=-1,W=-1,re=0,xe=0,we=t,le=null;t:for(;;){for(var he;we!==i||h!==0&&we.nodeType!==3||(k=_+h),we!==g||c!==0&&we.nodeType!==3||(W=_+c),we.nodeType===3&&(_+=we.nodeValue.length),(he=we.firstChild)!==null;)le=we,we=he;for(;;){if(we===t)break t;if(le===i&&++re===h&&(k=_),le===g&&++xe===c&&(W=_),(he=we.nextSibling)!==null)break;we=le,le=we.parentNode}we=he}i=k===-1||W===-1?null:{start:k,end:W}}else i=null}i=i||{start:0,end:0}}else i=null;for(Ip={focusedElem:t,selectionRange:i},jd=!1,Fn=r;Fn!==null;)if(r=Fn,t=r.child,(r.subtreeFlags&1028)!==0&&t!==null)t.return=r,Fn=t;else for(;Fn!==null;){switch(r=Fn,g=r.alternate,t=r.flags,r.tag){case 0:if((t&4)!==0&&(t=r.updateQueue,t=t!==null?t.events:null,t!==null))for(i=0;i<t.length;i++)h=t[i],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&g!==null){t=void 0,i=r,h=g.memoizedProps,g=g.memoizedState,c=i.stateNode;try{var Be=eo(i.type,h);t=c.getSnapshotBeforeUpdate(Be,g),c.__reactInternalSnapshotBeforeUpdate=t}catch(Je){zt(i,i.return,Je)}}break;case 3:if((t&1024)!==0){if(t=r.stateNode.containerInfo,i=t.nodeType,i===9)Rp(t);else if(i===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Rp(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(a(163))}if(t=r.sibling,t!==null){t.return=r.return,Fn=t;break}Fn=r.return}}function Ux(t,r,i){var c=i.flags;switch(i.tag){case 0:case 11:case 15:Sa(t,i),c&4&&mc(5,i);break;case 1:if(Sa(t,i),c&4)if(t=i.stateNode,r===null)try{t.componentDidMount()}catch(_){zt(i,i.return,_)}else{var h=eo(i.type,r.memoizedProps);r=r.memoizedState;try{t.componentDidUpdate(h,r,t.__reactInternalSnapshotBeforeUpdate)}catch(_){zt(i,i.return,_)}}c&64&&Ox(i),c&512&&gc(i,i.return);break;case 3:if(Sa(t,i),c&64&&(t=i.updateQueue,t!==null)){if(r=null,i.child!==null)switch(i.child.tag){case 27:case 5:r=i.child.stateNode;break;case 1:r=i.child.stateNode}try{_y(t,r)}catch(_){zt(i,i.return,_)}}break;case 27:r===null&&c&4&&Mx(i);case 26:case 5:Sa(t,i),r===null&&c&4&&kx(i),c&512&&gc(i,i.return);break;case 12:Sa(t,i);break;case 31:Sa(t,i),c&4&&zx(t,i);break;case 13:Sa(t,i),c&4&&Bx(t,i),c&64&&(t=i.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(i=$A.bind(null,i),f2(t,i))));break;case 22:if(c=i.memoizedState!==null||Ea,!c){r=r!==null&&r.memoizedState!==null||Nn,h=Ea;var g=Nn;Ea=c,(Nn=r)&&!g?Ta(t,i,(i.subtreeFlags&8772)!==0):Sa(t,i),Ea=h,Nn=g}break;case 30:break;default:Sa(t,i)}}function Px(t){var r=t.alternate;r!==null&&(t.alternate=null,Px(r)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(r=t.stateNode,r!==null&&ia(r)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var en=null,ws=!1;function wa(t,r,i){for(i=i.child;i!==null;)Vx(t,r,i),i=i.sibling}function Vx(t,r,i){if(be&&typeof be.onCommitFiberUnmount=="function")try{be.onCommitFiberUnmount(Zt,i)}catch{}switch(i.tag){case 26:Nn||qr(i,r),wa(t,r,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:Nn||qr(i,r);var c=en,h=ws;si(i.type)&&(en=i.stateNode,ws=!1),wa(t,r,i),Tc(i.stateNode),en=c,ws=h;break;case 5:Nn||qr(i,r);case 6:if(c=en,h=ws,en=null,wa(t,r,i),en=c,ws=h,en!==null)if(ws)try{(en.nodeType===9?en.body:en.nodeName==="HTML"?en.ownerDocument.body:en).removeChild(i.stateNode)}catch(g){zt(i,r,g)}else try{en.removeChild(i.stateNode)}catch(g){zt(i,r,g)}break;case 18:en!==null&&(ws?(t=en,Ob(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,i.stateNode),cl(t)):Ob(en,i.stateNode));break;case 4:c=en,h=ws,en=i.stateNode.containerInfo,ws=!0,wa(t,r,i),en=c,ws=h;break;case 0:case 11:case 14:case 15:Ka(2,i,r),Nn||Ka(4,i,r),wa(t,r,i);break;case 1:Nn||(qr(i,r),c=i.stateNode,typeof c.componentWillUnmount=="function"&&jx(i,r,c)),wa(t,r,i);break;case 21:wa(t,r,i);break;case 22:Nn=(c=Nn)||i.memoizedState!==null,wa(t,r,i),Nn=c;break;default:wa(t,r,i)}}function zx(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{cl(t)}catch(i){zt(r,r.return,i)}}}function Bx(t,r){if(r.memoizedState===null&&(t=r.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{cl(t)}catch(i){zt(r,r.return,i)}}function PA(t){switch(t.tag){case 31:case 13:case 19:var r=t.stateNode;return r===null&&(r=t.stateNode=new Dx),r;case 22:return t=t.stateNode,r=t._retryCache,r===null&&(r=t._retryCache=new Dx),r;default:throw Error(a(435,t.tag))}}function fd(t,r){var i=PA(t);r.forEach(function(c){if(!i.has(c)){i.add(c);var h=YA.bind(null,t,c);c.then(h,h)}})}function Ss(t,r){var i=r.deletions;if(i!==null)for(var c=0;c<i.length;c++){var h=i[c],g=t,_=r,k=_;e:for(;k!==null;){switch(k.tag){case 27:if(si(k.type)){en=k.stateNode,ws=!1;break e}break;case 5:en=k.stateNode,ws=!1;break e;case 3:case 4:en=k.stateNode.containerInfo,ws=!0;break e}k=k.return}if(en===null)throw Error(a(160));Vx(g,_,h),en=null,ws=!1,g=h.alternate,g!==null&&(g.return=null),h.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)Fx(r,t),r=r.sibling}var _r=null;function Fx(t,r){var i=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:Ss(r,t),Ts(t),c&4&&(Ka(3,t,t.return),mc(3,t),Ka(5,t,t.return));break;case 1:Ss(r,t),Ts(t),c&512&&(Nn||i===null||qr(i,i.return)),c&64&&Ea&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(i=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=i===null?c:i.concat(c))));break;case 26:var h=_r;if(Ss(r,t),Ts(t),c&512&&(Nn||i===null||qr(i,i.return)),c&4){var g=i!==null?i.memoizedState:null;if(c=t.memoizedState,i===null)if(c===null)if(t.stateNode===null){e:{c=t.type,i=t.memoizedProps,h=h.ownerDocument||h;t:switch(c){case"title":g=h.getElementsByTagName("title")[0],(!g||g[ks]||g[cn]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=h.createElement(c),h.head.insertBefore(g,h.querySelector("head > title"))),Zn(g,c,i),g[cn]=t,un(g),c=g;break e;case"link":var _=Fb("link","href",h).get(c+(i.href||""));if(_){for(var k=0;k<_.length;k++)if(g=_[k],g.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&g.getAttribute("rel")===(i.rel==null?null:i.rel)&&g.getAttribute("title")===(i.title==null?null:i.title)&&g.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){_.splice(k,1);break t}}g=h.createElement(c),Zn(g,c,i),h.head.appendChild(g);break;case"meta":if(_=Fb("meta","content",h).get(c+(i.content||""))){for(k=0;k<_.length;k++)if(g=_[k],g.getAttribute("content")===(i.content==null?null:""+i.content)&&g.getAttribute("name")===(i.name==null?null:i.name)&&g.getAttribute("property")===(i.property==null?null:i.property)&&g.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&g.getAttribute("charset")===(i.charSet==null?null:i.charSet)){_.splice(k,1);break t}}g=h.createElement(c),Zn(g,c,i),h.head.appendChild(g);break;default:throw Error(a(468,c))}g[cn]=t,un(g),c=g}t.stateNode=c}else Hb(h,t.type,t.stateNode);else t.stateNode=Bb(h,c,t.memoizedProps);else g!==c?(g===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):g.count--,c===null?Hb(h,t.type,t.stateNode):Bb(h,c,t.memoizedProps)):c===null&&t.stateNode!==null&&np(t,t.memoizedProps,i.memoizedProps)}break;case 27:Ss(r,t),Ts(t),c&512&&(Nn||i===null||qr(i,i.return)),i!==null&&c&4&&np(t,t.memoizedProps,i.memoizedProps);break;case 5:if(Ss(r,t),Ts(t),c&512&&(Nn||i===null||qr(i,i.return)),t.flags&32){h=t.stateNode;try{fs(h,"")}catch(Be){zt(t,t.return,Be)}}c&4&&t.stateNode!=null&&(h=t.memoizedProps,np(t,h,i!==null?i.memoizedProps:h)),c&1024&&(ap=!0);break;case 6:if(Ss(r,t),Ts(t),c&4){if(t.stateNode===null)throw Error(a(162));c=t.memoizedProps,i=t.stateNode;try{i.nodeValue=c}catch(Be){zt(t,t.return,Be)}}break;case 3:if(Nd=null,h=_r,_r=Ad(r.containerInfo),Ss(r,t),_r=h,Ts(t),c&4&&i!==null&&i.memoizedState.isDehydrated)try{cl(r.containerInfo)}catch(Be){zt(t,t.return,Be)}ap&&(ap=!1,Hx(t));break;case 4:c=_r,_r=Ad(t.stateNode.containerInfo),Ss(r,t),Ts(t),_r=c;break;case 12:Ss(r,t),Ts(t);break;case 31:Ss(r,t),Ts(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,fd(t,c)));break;case 13:Ss(r,t),Ts(t),t.child.flags&8192&&t.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(pd=Ve()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,fd(t,c)));break;case 22:h=t.memoizedState!==null;var W=i!==null&&i.memoizedState!==null,re=Ea,xe=Nn;if(Ea=re||h,Nn=xe||W,Ss(r,t),Nn=xe,Ea=re,Ts(t),c&8192)e:for(r=t.stateNode,r._visibility=h?r._visibility&-2:r._visibility|1,h&&(i===null||W||Ea||Nn||to(t)),i=null,r=t;;){if(r.tag===5||r.tag===26){if(i===null){W=i=r;try{if(g=W.stateNode,h)_=g.style,typeof _.setProperty=="function"?_.setProperty("display","none","important"):_.display="none";else{k=W.stateNode;var we=W.memoizedProps.style,le=we!=null&&we.hasOwnProperty("display")?we.display:null;k.style.display=le==null||typeof le=="boolean"?"":(""+le).trim()}}catch(Be){zt(W,W.return,Be)}}}else if(r.tag===6){if(i===null){W=r;try{W.stateNode.nodeValue=h?"":W.memoizedProps}catch(Be){zt(W,W.return,Be)}}}else if(r.tag===18){if(i===null){W=r;try{var he=W.stateNode;h?jb(he,!0):jb(W.stateNode,!1)}catch(Be){zt(W,W.return,Be)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===t)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;i===r&&(i=null),r=r.return}i===r&&(i=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=t.updateQueue,c!==null&&(i=c.retryQueue,i!==null&&(c.retryQueue=null,fd(t,i))));break;case 19:Ss(r,t),Ts(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,fd(t,c)));break;case 30:break;case 21:break;default:Ss(r,t),Ts(t)}}function Ts(t){var r=t.flags;if(r&2){try{for(var i,c=t.return;c!==null;){if(Lx(c)){i=c;break}c=c.return}if(i==null)throw Error(a(160));switch(i.tag){case 27:var h=i.stateNode,g=sp(t);dd(t,g,h);break;case 5:var _=i.stateNode;i.flags&32&&(fs(_,""),i.flags&=-33);var k=sp(t);dd(t,k,_);break;case 3:case 4:var W=i.stateNode.containerInfo,re=sp(t);rp(t,re,W);break;default:throw Error(a(161))}}catch(xe){zt(t,t.return,xe)}t.flags&=-3}r&4096&&(t.flags&=-4097)}function Hx(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var r=t;Hx(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),t=t.sibling}}function Sa(t,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Ux(t,r.alternate,r),r=r.sibling}function to(t){for(t=t.child;t!==null;){var r=t;switch(r.tag){case 0:case 11:case 14:case 15:Ka(4,r,r.return),to(r);break;case 1:qr(r,r.return);var i=r.stateNode;typeof i.componentWillUnmount=="function"&&jx(r,r.return,i),to(r);break;case 27:Tc(r.stateNode);case 26:case 5:qr(r,r.return),to(r);break;case 22:r.memoizedState===null&&to(r);break;case 30:to(r);break;default:to(r)}t=t.sibling}}function Ta(t,r,i){for(i=i&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,h=t,g=r,_=g.flags;switch(g.tag){case 0:case 11:case 15:Ta(h,g,i),mc(4,g);break;case 1:if(Ta(h,g,i),c=g,h=c.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(re){zt(c,c.return,re)}if(c=g,h=c.updateQueue,h!==null){var k=c.stateNode;try{var W=h.shared.hiddenCallbacks;if(W!==null)for(h.shared.hiddenCallbacks=null,h=0;h<W.length;h++)vy(W[h],k)}catch(re){zt(c,c.return,re)}}i&&_&64&&Ox(g),gc(g,g.return);break;case 27:Mx(g);case 26:case 5:Ta(h,g,i),i&&c===null&&_&4&&kx(g),gc(g,g.return);break;case 12:Ta(h,g,i);break;case 31:Ta(h,g,i),i&&_&4&&zx(h,g);break;case 13:Ta(h,g,i),i&&_&4&&Bx(h,g);break;case 22:g.memoizedState===null&&Ta(h,g,i),gc(g,g.return);break;case 30:break;default:Ta(h,g,i)}r=r.sibling}}function ip(t,r){var i=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),t=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(t=r.memoizedState.cachePool.pool),t!==i&&(t!=null&&t.refCount++,i!=null&&nc(i))}function op(t,r){t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&nc(t))}function Er(t,r,i,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Gx(t,r,i,c),r=r.sibling}function Gx(t,r,i,c){var h=r.flags;switch(r.tag){case 0:case 11:case 15:Er(t,r,i,c),h&2048&&mc(9,r);break;case 1:Er(t,r,i,c);break;case 3:Er(t,r,i,c),h&2048&&(t=null,r.alternate!==null&&(t=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==t&&(r.refCount++,t!=null&&nc(t)));break;case 12:if(h&2048){Er(t,r,i,c),t=r.stateNode;try{var g=r.memoizedProps,_=g.id,k=g.onPostCommit;typeof k=="function"&&k(_,r.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(W){zt(r,r.return,W)}}else Er(t,r,i,c);break;case 31:Er(t,r,i,c);break;case 13:Er(t,r,i,c);break;case 23:break;case 22:g=r.stateNode,_=r.alternate,r.memoizedState!==null?g._visibility&2?Er(t,r,i,c):yc(t,r):g._visibility&2?Er(t,r,i,c):(g._visibility|=2,Xo(t,r,i,c,(r.subtreeFlags&10256)!==0||!1)),h&2048&&ip(_,r);break;case 24:Er(t,r,i,c),h&2048&&op(r.alternate,r);break;default:Er(t,r,i,c)}}function Xo(t,r,i,c,h){for(h=h&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var g=t,_=r,k=i,W=c,re=_.flags;switch(_.tag){case 0:case 11:case 15:Xo(g,_,k,W,h),mc(8,_);break;case 23:break;case 22:var xe=_.stateNode;_.memoizedState!==null?xe._visibility&2?Xo(g,_,k,W,h):yc(g,_):(xe._visibility|=2,Xo(g,_,k,W,h)),h&&re&2048&&ip(_.alternate,_);break;case 24:Xo(g,_,k,W,h),h&&re&2048&&op(_.alternate,_);break;default:Xo(g,_,k,W,h)}r=r.sibling}}function yc(t,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var i=t,c=r,h=c.flags;switch(c.tag){case 22:yc(i,c),h&2048&&ip(c.alternate,c);break;case 24:yc(i,c),h&2048&&op(c.alternate,c);break;default:yc(i,c)}r=r.sibling}}var xc=8192;function Jo(t,r,i){if(t.subtreeFlags&xc)for(t=t.child;t!==null;)qx(t,r,i),t=t.sibling}function qx(t,r,i){switch(t.tag){case 26:Jo(t,r,i),t.flags&xc&&t.memoizedState!==null&&S2(i,_r,t.memoizedState,t.memoizedProps);break;case 5:Jo(t,r,i);break;case 3:case 4:var c=_r;_r=Ad(t.stateNode.containerInfo),Jo(t,r,i),_r=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=xc,xc=16777216,Jo(t,r,i),xc=c):Jo(t,r,i));break;default:Jo(t,r,i)}}function $x(t){var r=t.alternate;if(r!==null&&(t=r.child,t!==null)){r.child=null;do r=t.sibling,t.sibling=null,t=r;while(t!==null)}}function bc(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var i=0;i<r.length;i++){var c=r[i];Fn=c,Wx(c,t)}$x(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Yx(t),t=t.sibling}function Yx(t){switch(t.tag){case 0:case 11:case 15:bc(t),t.flags&2048&&Ka(9,t,t.return);break;case 3:bc(t);break;case 12:bc(t);break;case 22:var r=t.stateNode;t.memoizedState!==null&&r._visibility&2&&(t.return===null||t.return.tag!==13)?(r._visibility&=-3,hd(t)):bc(t);break;default:bc(t)}}function hd(t){var r=t.deletions;if((t.flags&16)!==0){if(r!==null)for(var i=0;i<r.length;i++){var c=r[i];Fn=c,Wx(c,t)}$x(t)}for(t=t.child;t!==null;){switch(r=t,r.tag){case 0:case 11:case 15:Ka(8,r,r.return),hd(r);break;case 22:i=r.stateNode,i._visibility&2&&(i._visibility&=-3,hd(r));break;default:hd(r)}t=t.sibling}}function Wx(t,r){for(;Fn!==null;){var i=Fn;switch(i.tag){case 0:case 11:case 15:Ka(8,i,r);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var c=i.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:nc(i.memoizedState.cache)}if(c=i.child,c!==null)c.return=i,Fn=c;else e:for(i=t;Fn!==null;){c=Fn;var h=c.sibling,g=c.return;if(Px(c),c===i){Fn=null;break e}if(h!==null){h.return=g,Fn=h;break e}Fn=g}}}var VA={getCacheForType:function(t){var r=Qn(Tn),i=r.data.get(t);return i===void 0&&(i=t(),r.data.set(t,i)),i},cacheSignal:function(){return Qn(Tn).controller.signal}},zA=typeof WeakMap=="function"?WeakMap:Map,Mt=0,$t=null,mt=null,xt=0,Vt=0,Ps=null,Za=!1,el=!1,lp=!1,Aa=0,pn=0,Xa=0,no=0,cp=0,Vs=0,tl=0,vc=null,As=null,up=!1,pd=0,Qx=0,md=1/0,gd=null,Ja=null,Dn=0,ei=null,nl=null,Ia=0,dp=0,fp=null,Kx=null,_c=0,hp=null;function zs(){return(Mt&2)!==0&&xt!==0?xt&-xt:G.T!==null?bp():js()}function Zx(){if(Vs===0)if((xt&536870912)===0||_t){var t=ht;ht<<=1,(ht&3932160)===0&&(ht=262144),Vs=t}else Vs=536870912;return t=Ds.current,t!==null&&(t.flags|=32),Vs}function Is(t,r,i){(t===$t&&(Vt===2||Vt===9)||t.cancelPendingCommit!==null)&&(sl(t,0),ti(t,xt,Vs,!1)),$n(t,i),((Mt&2)===0||t!==$t)&&(t===$t&&((Mt&2)===0&&(no|=i),pn===4&&ti(t,xt,Vs,!1)),$r(t))}function Xx(t,r,i){if((Mt&6)!==0)throw Error(a(327));var c=!i&&(r&127)===0&&(r&t.expiredLanes)===0||ln(t,r),h=c?HA(t,r):mp(t,r,!0),g=c;do{if(h===0){el&&!c&&ti(t,r,0,!1);break}else{if(i=t.current.alternate,g&&!BA(i)){h=mp(t,r,!1),g=!1;continue}if(h===2){if(g=r,t.errorRecoveryDisabledLanes&g)var _=0;else _=t.pendingLanes&-536870913,_=_!==0?_:_&536870912?536870912:0;if(_!==0){r=_;e:{var k=t;h=vc;var W=k.current.memoizedState.isDehydrated;if(W&&(sl(k,_).flags|=256),_=mp(k,_,!1),_!==2){if(lp&&!W){k.errorRecoveryDisabledLanes|=g,no|=g,h=4;break e}g=As,As=h,g!==null&&(As===null?As=g:As.push.apply(As,g))}h=_}if(g=!1,h!==2)continue}}if(h===1){sl(t,0),ti(t,r,0,!0);break}e:{switch(c=t,g=h,g){case 0:case 1:throw Error(a(345));case 4:if((r&4194048)!==r)break;case 6:ti(c,r,Vs,!Za);break e;case 2:As=null;break;case 3:case 5:break;default:throw Error(a(329))}if((r&62914560)===r&&(h=pd+300-Ve(),10<h)){if(ti(c,r,Vs,!Za),vt(c,0,!0)!==0)break e;Ia=r,c.timeoutHandle=Cb(Jx.bind(null,c,i,As,gd,up,r,Vs,no,tl,Za,g,"Throttled",-0,0),h);break e}Jx(c,i,As,gd,up,r,Vs,no,tl,Za,g,null,-0,0)}}break}while(!0);$r(t)}function Jx(t,r,i,c,h,g,_,k,W,re,xe,we,le,he){if(t.timeoutHandle=-1,we=r.subtreeFlags,we&8192||(we&16785408)===16785408){we={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:jt},qx(r,g,we);var Be=(g&62914560)===g?pd-Ve():(g&4194048)===g?Qx-Ve():0;if(Be=T2(we,Be),Be!==null){Ia=g,t.cancelPendingCommit=Be(ob.bind(null,t,r,g,i,c,h,_,k,W,xe,we,null,le,he)),ti(t,g,_,!re);return}}ob(t,r,g,i,c,h,_,k,W)}function BA(t){for(var r=t;;){var i=r.tag;if((i===0||i===11||i===15)&&r.flags&16384&&(i=r.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var c=0;c<i.length;c++){var h=i[c],g=h.getSnapshot;h=h.value;try{if(!Ls(g(),h))return!1}catch{return!1}}if(i=r.child,r.subtreeFlags&16384&&i!==null)i.return=r,r=i;else{if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function ti(t,r,i,c){r&=~cp,r&=~no,t.suspendedLanes|=r,t.pingedLanes&=~r,c&&(t.warmLanes|=r),c=t.expirationTimes;for(var h=r;0<h;){var g=31-Ne(h),_=1<<g;c[g]=-1,h&=~_}i!==0&&qs(t,i,r)}function yd(){return(Mt&6)===0?(Ec(0),!1):!0}function pp(){if(mt!==null){if(Vt===0)var t=mt.return;else t=mt,ga=Yi=null,Rh(t),Yo=null,rc=0,t=mt;for(;t!==null;)Rx(t.alternate,t),t=t.return;mt=null}}function sl(t,r){var i=t.timeoutHandle;i!==-1&&(t.timeoutHandle=-1,o2(i)),i=t.cancelPendingCommit,i!==null&&(t.cancelPendingCommit=null,i()),Ia=0,pp(),$t=t,mt=i=pa(t.current,null),xt=r,Vt=0,Ps=null,Za=!1,el=ln(t,r),lp=!1,tl=Vs=cp=no=Xa=pn=0,As=vc=null,up=!1,(r&8)!==0&&(r|=r&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=r;0<c;){var h=31-Ne(c),g=1<<h;r|=t[h],c&=~g}return Aa=r,Pu(),i}function eb(t,r){dt=null,G.H=fc,r===$o||r===$u?(r=gy(),Vt=3):r===xh?(r=gy(),Vt=4):Vt=r===$h?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,Ps=r,mt===null&&(pn=1,id(t,nr(r,t.current)))}function tb(){var t=Ds.current;return t===null?!0:(xt&4194048)===xt?ir===null:(xt&62914560)===xt||(xt&536870912)!==0?t===ir:!1}function nb(){var t=G.H;return G.H=fc,t===null?fc:t}function sb(){var t=G.A;return G.A=VA,t}function xd(){pn=4,Za||(xt&4194048)!==xt&&Ds.current!==null||(el=!0),(Xa&134217727)===0&&(no&134217727)===0||$t===null||ti($t,xt,Vs,!1)}function mp(t,r,i){var c=Mt;Mt|=2;var h=nb(),g=sb();($t!==t||xt!==r)&&(gd=null,sl(t,r)),r=!1;var _=pn;e:do try{if(Vt!==0&&mt!==null){var k=mt,W=Ps;switch(Vt){case 8:pp(),_=6;break e;case 3:case 2:case 9:case 6:Ds.current===null&&(r=!0);var re=Vt;if(Vt=0,Ps=null,rl(t,k,W,re),i&&el){_=0;break e}break;default:re=Vt,Vt=0,Ps=null,rl(t,k,W,re)}}FA(),_=pn;break}catch(xe){eb(t,xe)}while(!0);return r&&t.shellSuspendCounter++,ga=Yi=null,Mt=c,G.H=h,G.A=g,mt===null&&($t=null,xt=0,Pu()),_}function FA(){for(;mt!==null;)rb(mt)}function HA(t,r){var i=Mt;Mt|=2;var c=nb(),h=sb();$t!==t||xt!==r?(gd=null,md=Ve()+500,sl(t,r)):el=ln(t,r);e:do try{if(Vt!==0&&mt!==null){r=mt;var g=Ps;t:switch(Vt){case 1:Vt=0,Ps=null,rl(t,r,g,1);break;case 2:case 9:if(py(g)){Vt=0,Ps=null,ab(r);break}r=function(){Vt!==2&&Vt!==9||$t!==t||(Vt=7),$r(t)},g.then(r,r);break e;case 3:Vt=7;break e;case 4:Vt=5;break e;case 7:py(g)?(Vt=0,Ps=null,ab(r)):(Vt=0,Ps=null,rl(t,r,g,7));break;case 5:var _=null;switch(mt.tag){case 26:_=mt.memoizedState;case 5:case 27:var k=mt;if(_?Gb(_):k.stateNode.complete){Vt=0,Ps=null;var W=k.sibling;if(W!==null)mt=W;else{var re=k.return;re!==null?(mt=re,bd(re)):mt=null}break t}}Vt=0,Ps=null,rl(t,r,g,5);break;case 6:Vt=0,Ps=null,rl(t,r,g,6);break;case 8:pp(),pn=6;break e;default:throw Error(a(462))}}GA();break}catch(xe){eb(t,xe)}while(!0);return ga=Yi=null,G.H=c,G.A=h,Mt=i,mt!==null?0:($t=null,xt=0,Pu(),pn)}function GA(){for(;mt!==null&&!Pe();)rb(mt)}function rb(t){var r=Nx(t.alternate,t,Aa);t.memoizedProps=t.pendingProps,r===null?bd(t):mt=r}function ab(t){var r=t,i=r.alternate;switch(r.tag){case 15:case 0:r=Ex(i,r,r.pendingProps,r.type,void 0,xt);break;case 11:r=Ex(i,r,r.pendingProps,r.type.render,r.ref,xt);break;case 5:Rh(r);default:Rx(i,r),r=mt=sy(r,Aa),r=Nx(i,r,Aa)}t.memoizedProps=t.pendingProps,r===null?bd(t):mt=r}function rl(t,r,i,c){ga=Yi=null,Rh(r),Yo=null,rc=0;var h=r.return;try{if(jA(t,h,r,i,xt)){pn=1,id(t,nr(i,t.current)),mt=null;return}}catch(g){if(h!==null)throw mt=h,g;pn=1,id(t,nr(i,t.current)),mt=null;return}r.flags&32768?(_t||c===1?t=!0:el||(xt&536870912)!==0?t=!1:(Za=t=!0,(c===2||c===9||c===3||c===6)&&(c=Ds.current,c!==null&&c.tag===13&&(c.flags|=16384))),ib(r,t)):bd(r)}function bd(t){var r=t;do{if((r.flags&32768)!==0){ib(r,Za);return}t=r.return;var i=MA(r.alternate,r,Aa);if(i!==null){mt=i;return}if(r=r.sibling,r!==null){mt=r;return}mt=r=t}while(r!==null);pn===0&&(pn=5)}function ib(t,r){do{var i=DA(t.alternate,t);if(i!==null){i.flags&=32767,mt=i;return}if(i=t.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!r&&(t=t.sibling,t!==null)){mt=t;return}mt=t=i}while(t!==null);pn=6,mt=null}function ob(t,r,i,c,h,g,_,k,W){t.cancelPendingCommit=null;do vd();while(Dn!==0);if((Mt&6)!==0)throw Error(a(327));if(r!==null){if(r===t.current)throw Error(a(177));if(g=r.lanes|r.childLanes,g|=sh,na(t,i,g,_,k,W),t===$t&&(mt=$t=null,xt=0),nl=r,ei=t,Ia=i,dp=g,fp=h,Kx=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,WA(pt,function(){return fb(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=G.T,G.T=null,h=ae.p,ae.p=2,_=Mt,Mt|=4;try{UA(t,r,i)}finally{Mt=_,ae.p=h,G.T=c}}Dn=1,lb(),cb(),ub()}}function lb(){if(Dn===1){Dn=0;var t=ei,r=nl,i=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||i){i=G.T,G.T=null;var c=ae.p;ae.p=2;var h=Mt;Mt|=4;try{Fx(r,t);var g=Ip,_=W0(t.containerInfo),k=g.focusedElem,W=g.selectionRange;if(_!==k&&k&&k.ownerDocument&&Y0(k.ownerDocument.documentElement,k)){if(W!==null&&Xf(k)){var re=W.start,xe=W.end;if(xe===void 0&&(xe=re),"selectionStart"in k)k.selectionStart=re,k.selectionEnd=Math.min(xe,k.value.length);else{var we=k.ownerDocument||document,le=we&&we.defaultView||window;if(le.getSelection){var he=le.getSelection(),Be=k.textContent.length,Je=Math.min(W.start,Be),Gt=W.end===void 0?Je:Math.min(W.end,Be);!he.extend&&Je>Gt&&(_=Gt,Gt=Je,Je=_);var J=$0(k,Je),K=$0(k,Gt);if(J&&K&&(he.rangeCount!==1||he.anchorNode!==J.node||he.anchorOffset!==J.offset||he.focusNode!==K.node||he.focusOffset!==K.offset)){var se=we.createRange();se.setStart(J.node,J.offset),he.removeAllRanges(),Je>Gt?(he.addRange(se),he.extend(K.node,K.offset)):(se.setEnd(K.node,K.offset),he.addRange(se))}}}}for(we=[],he=k;he=he.parentNode;)he.nodeType===1&&we.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<we.length;k++){var _e=we[k];_e.element.scrollLeft=_e.left,_e.element.scrollTop=_e.top}}jd=!!Ap,Ip=Ap=null}finally{Mt=h,ae.p=c,G.T=i}}t.current=r,Dn=2}}function cb(){if(Dn===2){Dn=0;var t=ei,r=nl,i=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||i){i=G.T,G.T=null;var c=ae.p;ae.p=2;var h=Mt;Mt|=4;try{Ux(t,r.alternate,r)}finally{Mt=h,ae.p=c,G.T=i}}Dn=3}}function ub(){if(Dn===4||Dn===3){Dn=0,oe();var t=ei,r=nl,i=Ia,c=Kx;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?Dn=5:(Dn=0,nl=ei=null,db(t,t.pendingLanes));var h=t.pendingLanes;if(h===0&&(Ja=null),pr(i),r=r.stateNode,be&&typeof be.onCommitFiberRoot=="function")try{be.onCommitFiberRoot(Zt,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=G.T,h=ae.p,ae.p=2,G.T=null;try{for(var g=t.onRecoverableError,_=0;_<c.length;_++){var k=c[_];g(k.value,{componentStack:k.stack})}}finally{G.T=r,ae.p=h}}(Ia&3)!==0&&vd(),$r(t),h=t.pendingLanes,(i&261930)!==0&&(h&42)!==0?t===hp?_c++:(_c=0,hp=t):_c=0,Ec(0)}}function db(t,r){(t.pooledCacheLanes&=r)===0&&(r=t.pooledCache,r!=null&&(t.pooledCache=null,nc(r)))}function vd(){return lb(),cb(),ub(),fb()}function fb(){if(Dn!==5)return!1;var t=ei,r=dp;dp=0;var i=pr(Ia),c=G.T,h=ae.p;try{ae.p=32>i?32:i,G.T=null,i=fp,fp=null;var g=ei,_=Ia;if(Dn=0,nl=ei=null,Ia=0,(Mt&6)!==0)throw Error(a(331));var k=Mt;if(Mt|=4,Yx(g.current),Gx(g,g.current,_,i),Mt=k,Ec(0,!1),be&&typeof be.onPostCommitFiberRoot=="function")try{be.onPostCommitFiberRoot(Zt,g)}catch{}return!0}finally{ae.p=h,G.T=c,db(t,r)}}function hb(t,r,i){r=nr(i,r),r=qh(t.stateNode,r,2),t=Ya(t,r,2),t!==null&&($n(t,2),$r(t))}function zt(t,r,i){if(t.tag===3)hb(t,t,i);else for(;r!==null;){if(r.tag===3){hb(r,t,i);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ja===null||!Ja.has(c))){t=nr(i,t),i=px(2),c=Ya(r,i,2),c!==null&&(mx(i,c,r,t),$n(c,2),$r(c));break}}r=r.return}}function gp(t,r,i){var c=t.pingCache;if(c===null){c=t.pingCache=new zA;var h=new Set;c.set(r,h)}else h=c.get(r),h===void 0&&(h=new Set,c.set(r,h));h.has(i)||(lp=!0,h.add(i),t=qA.bind(null,t,r,i),r.then(t,t))}function qA(t,r,i){var c=t.pingCache;c!==null&&c.delete(r),t.pingedLanes|=t.suspendedLanes&i,t.warmLanes&=~i,$t===t&&(xt&i)===i&&(pn===4||pn===3&&(xt&62914560)===xt&&300>Ve()-pd?(Mt&2)===0&&sl(t,0):cp|=i,tl===xt&&(tl=0)),$r(t)}function pb(t,r){r===0&&(r=_s()),t=Gi(t,r),t!==null&&($n(t,r),$r(t))}function $A(t){var r=t.memoizedState,i=0;r!==null&&(i=r.retryLane),pb(t,i)}function YA(t,r){var i=0;switch(t.tag){case 31:case 13:var c=t.stateNode,h=t.memoizedState;h!==null&&(i=h.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(a(314))}c!==null&&c.delete(r),pb(t,i)}function WA(t,r){return Ke(t,r)}var _d=null,al=null,yp=!1,Ed=!1,xp=!1,ni=0;function $r(t){t!==al&&t.next===null&&(al===null?_d=al=t:al=al.next=t),Ed=!0,yp||(yp=!0,KA())}function Ec(t,r){if(!xp&&Ed){xp=!0;do for(var i=!1,c=_d;c!==null;){if(t!==0){var h=c.pendingLanes;if(h===0)var g=0;else{var _=c.suspendedLanes,k=c.pingedLanes;g=(1<<31-Ne(42|t)+1)-1,g&=h&~(_&~k),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(i=!0,xb(c,g))}else g=xt,g=vt(c,c===$t?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||ln(c,g)||(i=!0,xb(c,g));c=c.next}while(i);xp=!1}}function QA(){mb()}function mb(){Ed=yp=!1;var t=0;ni!==0&&i2()&&(t=ni);for(var r=Ve(),i=null,c=_d;c!==null;){var h=c.next,g=gb(c,r);g===0?(c.next=null,i===null?_d=h:i.next=h,h===null&&(al=i)):(i=c,(t!==0||(g&3)!==0)&&(Ed=!0)),c=h}Dn!==0&&Dn!==5||Ec(t),ni!==0&&(ni=0)}function gb(t,r){for(var i=t.suspendedLanes,c=t.pingedLanes,h=t.expirationTimes,g=t.pendingLanes&-62914561;0<g;){var _=31-Ne(g),k=1<<_,W=h[_];W===-1?((k&i)===0||(k&c)!==0)&&(h[_]=vs(k,r)):W<=r&&(t.expiredLanes|=k),g&=~k}if(r=$t,i=xt,i=vt(t,t===r?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,i===0||t===r&&(Vt===2||Vt===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&Nt(c),t.callbackNode=null,t.callbackPriority=0;if((i&3)===0||ln(t,i)){if(r=i&-i,r===t.callbackPriority)return r;switch(c!==null&&Nt(c),pr(i)){case 2:case 8:i=nt;break;case 32:i=pt;break;case 268435456:i=Pt;break;default:i=pt}return c=yb.bind(null,t),i=Ke(i,c),t.callbackPriority=r,t.callbackNode=i,r}return c!==null&&c!==null&&Nt(c),t.callbackPriority=2,t.callbackNode=null,2}function yb(t,r){if(Dn!==0&&Dn!==5)return t.callbackNode=null,t.callbackPriority=0,null;var i=t.callbackNode;if(vd()&&t.callbackNode!==i)return null;var c=xt;return c=vt(t,t===$t?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(Xx(t,c,r),gb(t,Ve()),t.callbackNode!=null&&t.callbackNode===i?yb.bind(null,t):null)}function xb(t,r){if(vd())return null;Xx(t,r,!0)}function KA(){l2(function(){(Mt&6)!==0?Ke(ct,QA):mb()})}function bp(){if(ni===0){var t=Go;t===0&&(t=st,st<<=1,(st&261888)===0&&(st=256)),ni=t}return ni}function bb(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:We(""+t)}function vb(t,r){var i=r.ownerDocument.createElement("input");return i.name=r.name,i.value=r.value,t.id&&i.setAttribute("form",t.id),r.parentNode.insertBefore(i,r),t=new FormData(t),i.parentNode.removeChild(i),t}function ZA(t,r,i,c,h){if(r==="submit"&&i&&i.stateNode===h){var g=bb((h[wn]||null).action),_=c.submitter;_&&(r=(r=_[wn]||null)?bb(r.formAction):_.getAttribute("formAction"),r!==null&&(g=r,_=null));var k=new Vr("action","action",null,c,h);t.push({event:k,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(ni!==0){var W=_?vb(h,_):new FormData(h);Vh(i,{pending:!0,data:W,method:h.method,action:g},null,W)}}else typeof g=="function"&&(k.preventDefault(),W=_?vb(h,_):new FormData(h),Vh(i,{pending:!0,data:W,method:h.method,action:g},g,W))},currentTarget:h}]})}}for(var vp=0;vp<nh.length;vp++){var _p=nh[vp],XA=_p.toLowerCase(),JA=_p[0].toUpperCase()+_p.slice(1);vr(XA,"on"+JA)}vr(Z0,"onAnimationEnd"),vr(X0,"onAnimationIteration"),vr(J0,"onAnimationStart"),vr("dblclick","onDoubleClick"),vr("focusin","onFocus"),vr("focusout","onBlur"),vr(mA,"onTransitionRun"),vr(gA,"onTransitionStart"),vr(yA,"onTransitionCancel"),vr(ey,"onTransitionEnd"),Ks("onMouseEnter",["mouseout","mouseover"]),Ks("onMouseLeave",["mouseout","mouseover"]),Ks("onPointerEnter",["pointerout","pointerover"]),Ks("onPointerLeave",["pointerout","pointerover"]),Qs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Qs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Qs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Qs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Qs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Qs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),e2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(wc));function _b(t,r){r=(r&4)!==0;for(var i=0;i<t.length;i++){var c=t[i],h=c.event;c=c.listeners;e:{var g=void 0;if(r)for(var _=c.length-1;0<=_;_--){var k=c[_],W=k.instance,re=k.currentTarget;if(k=k.listener,W!==g&&h.isPropagationStopped())break e;g=k,h.currentTarget=re;try{g(h)}catch(xe){Uu(xe)}h.currentTarget=null,g=W}else for(_=0;_<c.length;_++){if(k=c[_],W=k.instance,re=k.currentTarget,k=k.listener,W!==g&&h.isPropagationStopped())break e;g=k,h.currentTarget=re;try{g(h)}catch(xe){Uu(xe)}h.currentTarget=null,g=W}}}}function gt(t,r){var i=r[aa];i===void 0&&(i=r[aa]=new Set);var c=t+"__bubble";i.has(c)||(Eb(r,t,2,!1),i.add(c))}function Ep(t,r,i){var c=0;r&&(c|=4),Eb(i,t,c,r)}var wd="_reactListening"+Math.random().toString(36).slice(2);function wp(t){if(!t[wd]){t[wd]=!0,Ni.forEach(function(i){i!=="selectionchange"&&(e2.has(i)||Ep(i,!1,t),Ep(i,!0,t))});var r=t.nodeType===9?t:t.ownerDocument;r===null||r[wd]||(r[wd]=!0,Ep("selectionchange",!1,r))}}function Eb(t,r,i,c){switch(Zb(r)){case 2:var h=N2;break;case 8:h=C2;break;default:h=Pp}i=h.bind(null,r,i,t),h=void 0,!Di||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(h=!0),c?h!==void 0?t.addEventListener(r,i,{capture:!0,passive:h}):t.addEventListener(r,i,!0):h!==void 0?t.addEventListener(r,i,{passive:h}):t.addEventListener(r,i,!1)}function Sp(t,r,i,c,h){var g=c;if((r&1)===0&&(r&2)===0&&c!==null)e:for(;;){if(c===null)return;var _=c.tag;if(_===3||_===4){var k=c.stateNode.containerInfo;if(k===h)break;if(_===4)for(_=c.return;_!==null;){var W=_.tag;if((W===3||W===4)&&_.stateNode.containerInfo===h)return;_=_.return}for(;k!==null;){if(_=Ys(k),_===null)return;if(W=_.tag,W===5||W===6||W===26||W===27){c=g=_;continue e}k=k.parentNode}}c=c.return}Ua(function(){var re=g,xe=kt(i),we=[];e:{var le=ty.get(t);if(le!==void 0){var he=Vr,Be=t;switch(t){case"keypress":if(Pi(i)===0)break e;case"keydown":case"keyup":he=Lu;break;case"focusin":Be="focus",he=zi;break;case"focusout":Be="blur",he=zi;break;case"beforeblur":case"afterblur":he=zi;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=Wl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=Tu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=b;break;case Z0:case X0:case J0:he=Iu;break;case ey:he=P;break;case"scroll":case"scrollend":he=Yl;break;case"wheel":he=de;break;case"copy":case"cut":case"paste":he=Nu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=ha;break;case"toggle":case"beforetoggle":he=ut}var Je=(r&4)!==0,Gt=!Je&&(t==="scroll"||t==="scrollend"),J=Je?le!==null?le+"Capture":null:le;Je=[];for(var K=re,se;K!==null;){var _e=K;if(se=_e.stateNode,_e=_e.tag,_e!==5&&_e!==26&&_e!==27||se===null||J===null||(_e=gr(K,J),_e!=null&&Je.push(Sc(K,_e,se))),Gt)break;K=K.return}0<Je.length&&(le=new he(le,Be,null,i,xe),we.push({event:le,listeners:Je}))}}if((r&7)===0){e:{if(le=t==="mouseover"||t==="pointerover",he=t==="mouseout"||t==="pointerout",le&&i!==Ln&&(Be=i.relatedTarget||i.fromElement)&&(Ys(Be)||Be[$s]))break e;if((he||le)&&(le=xe.window===xe?xe:(le=xe.ownerDocument)?le.defaultView||le.parentWindow:window,he?(Be=i.relatedTarget||i.toElement,he=re,Be=Be?Ys(Be):null,Be!==null&&(Gt=l(Be),Je=Be.tag,Be!==Gt||Je!==5&&Je!==27&&Je!==6)&&(Be=null)):(he=null,Be=re),he!==Be)){if(Je=Wl,_e="onMouseLeave",J="onMouseEnter",K="mouse",(t==="pointerout"||t==="pointerover")&&(Je=ha,_e="onPointerLeave",J="onPointerEnter",K="pointer"),Gt=he==null?le:us(he),se=Be==null?le:us(Be),le=new Je(_e,K+"leave",he,i,xe),le.target=Gt,le.relatedTarget=se,_e=null,Ys(xe)===re&&(Je=new Je(J,K+"enter",Be,i,xe),Je.target=se,Je.relatedTarget=Gt,_e=Je),Gt=_e,he&&Be)t:{for(Je=t2,J=he,K=Be,se=0,_e=J;_e;_e=Je(_e))se++;_e=0;for(var Ze=K;Ze;Ze=Je(Ze))_e++;for(;0<se-_e;)J=Je(J),se--;for(;0<_e-se;)K=Je(K),_e--;for(;se--;){if(J===K||K!==null&&J===K.alternate){Je=J;break t}J=Je(J),K=Je(K)}Je=null}else Je=null;he!==null&&wb(we,le,he,Je,!1),Be!==null&&Gt!==null&&wb(we,Gt,Be,Je,!0)}}e:{if(le=re?us(re):window,he=le.nodeName&&le.nodeName.toLowerCase(),he==="select"||he==="input"&&le.type==="file")var Ct=z0;else if(P0(le))if(B0)Ct=fA;else{Ct=uA;var He=cA}else he=le.nodeName,!he||he.toLowerCase()!=="input"||le.type!=="checkbox"&&le.type!=="radio"?re&&qe(re.elementType)&&(Ct=z0):Ct=dA;if(Ct&&(Ct=Ct(t,re))){V0(we,Ct,i,xe);break e}He&&He(t,le,re),t==="focusout"&&re&&le.type==="number"&&re.memoizedProps.value!=null&&Co(le,"number",le.value)}switch(He=re?us(re):window,t){case"focusin":(P0(He)||He.contentEditable==="true")&&(Do=He,Jf=re,Jl=null);break;case"focusout":Jl=Jf=Do=null;break;case"mousedown":eh=!0;break;case"contextmenu":case"mouseup":case"dragend":eh=!1,Q0(we,i,xe);break;case"selectionchange":if(pA)break;case"keydown":case"keyup":Q0(we,i,xe)}var ft;if(Lt)e:{switch(t){case"compositionstart":var bt="onCompositionStart";break e;case"compositionend":bt="onCompositionEnd";break e;case"compositionupdate":bt="onCompositionUpdate";break e}bt=void 0}else Mo?Bi(t,i)&&(bt="onCompositionEnd"):t==="keydown"&&i.keyCode===229&&(bt="onCompositionStart");bt&&(Fr&&i.locale!=="ko"&&(Mo||bt!=="onCompositionStart"?bt==="onCompositionEnd"&&Mo&&(ft=$l()):(Pr=xe,ql="value"in Pr?Pr.value:Pr.textContent,Mo=!0)),He=Sd(re,bt),0<He.length&&(bt=new Br(bt,t,null,i,xe),we.push({event:bt,listeners:He}),ft?bt.data=ft:(ft=Lo(i),ft!==null&&(bt.data=ft)))),(ft=er?aA(t,i):iA(t,i))&&(bt=Sd(re,"onBeforeInput"),0<bt.length&&(He=new Br("onBeforeInput","beforeinput",null,i,xe),we.push({event:He,listeners:bt}),He.data=ft)),ZA(we,t,re,i,xe)}_b(we,r)})}function Sc(t,r,i){return{instance:t,listener:r,currentTarget:i}}function Sd(t,r){for(var i=r+"Capture",c=[];t!==null;){var h=t,g=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||g===null||(h=gr(t,i),h!=null&&c.unshift(Sc(t,h,g)),h=gr(t,r),h!=null&&c.push(Sc(t,h,g))),t.tag===3)return c;t=t.return}return[]}function t2(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function wb(t,r,i,c,h){for(var g=r._reactName,_=[];i!==null&&i!==c;){var k=i,W=k.alternate,re=k.stateNode;if(k=k.tag,W!==null&&W===c)break;k!==5&&k!==26&&k!==27||re===null||(W=re,h?(re=gr(i,g),re!=null&&_.unshift(Sc(i,re,W))):h||(re=gr(i,g),re!=null&&_.push(Sc(i,re,W)))),i=i.return}_.length!==0&&t.push({event:r,listeners:_})}var n2=/\r\n?/g,s2=/\u0000|\uFFFD/g;function Sb(t){return(typeof t=="string"?t:""+t).replace(n2,`
`).replace(s2,"")}function Tb(t,r){return r=Sb(r),Sb(t)===r}function Ht(t,r,i,c,h,g){switch(i){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||fs(t,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&fs(t,""+c);break;case"className":ds(t,"class",c);break;case"tabIndex":ds(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":ds(t,i,c);break;case"style":$e(t,c,g);break;case"data":if(r!=="object"){ds(t,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||i!=="href")){t.removeAttribute(i);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(i);break}c=We(""+c),t.setAttribute(i,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(i==="formAction"?(r!=="input"&&Ht(t,r,"name",h.name,h,null),Ht(t,r,"formEncType",h.formEncType,h,null),Ht(t,r,"formMethod",h.formMethod,h,null),Ht(t,r,"formTarget",h.formTarget,h,null)):(Ht(t,r,"encType",h.encType,h,null),Ht(t,r,"method",h.method,h,null),Ht(t,r,"target",h.target,h,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(i);break}c=We(""+c),t.setAttribute(i,c);break;case"onClick":c!=null&&(t.onclick=jt);break;case"onScroll":c!=null&&gt("scroll",t);break;case"onScrollEnd":c!=null&&gt("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(a(61));if(i=c.__html,i!=null){if(h.children!=null)throw Error(a(60));t.innerHTML=i}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}i=We(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(i,""+c):t.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(i,""):t.removeAttribute(i);break;case"capture":case"download":c===!0?t.setAttribute(i,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(i,c):t.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(i,c):t.removeAttribute(i);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(i):t.setAttribute(i,c);break;case"popover":gt("beforetoggle",t),gt("toggle",t),Da(t,"popover",c);break;case"xlinkActuate":dn(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":dn(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":dn(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":dn(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":dn(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":dn(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":dn(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":dn(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":dn(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Da(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=Ye.get(i)||i,Da(t,i,c))}}function Tp(t,r,i,c,h,g){switch(i){case"style":$e(t,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(a(61));if(i=c.__html,i!=null){if(h.children!=null)throw Error(a(60));t.innerHTML=i}}break;case"children":typeof c=="string"?fs(t,c):(typeof c=="number"||typeof c=="bigint")&&fs(t,""+c);break;case"onScroll":c!=null&&gt("scroll",t);break;case"onScrollEnd":c!=null&&gt("scrollend",t);break;case"onClick":c!=null&&(t.onclick=jt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ci.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(h=i.endsWith("Capture"),r=i.slice(2,h?i.length-7:void 0),g=t[wn]||null,g=g!=null?g[i]:null,typeof g=="function"&&t.removeEventListener(r,g,h),typeof c=="function")){typeof g!="function"&&g!==null&&(i in t?t[i]=null:t.hasAttribute(i)&&t.removeAttribute(i)),t.addEventListener(r,c,h);break e}i in t?t[i]=c:c===!0?t.setAttribute(i,""):Da(t,i,c)}}}function Zn(t,r,i){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":gt("error",t),gt("load",t);var c=!1,h=!1,g;for(g in i)if(i.hasOwnProperty(g)){var _=i[g];if(_!=null)switch(g){case"src":c=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Ht(t,r,g,_,i,null)}}h&&Ht(t,r,"srcSet",i.srcSet,i,null),c&&Ht(t,r,"src",i.src,i,null);return;case"input":gt("invalid",t);var k=g=_=h=null,W=null,re=null;for(c in i)if(i.hasOwnProperty(c)){var xe=i[c];if(xe!=null)switch(c){case"name":h=xe;break;case"type":_=xe;break;case"checked":W=xe;break;case"defaultChecked":re=xe;break;case"value":g=xe;break;case"defaultValue":k=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(a(137,r));break;default:Ht(t,r,c,xe,i,null)}}Mi(t,g,k,W,re,_,h,!1);return;case"select":gt("invalid",t),c=_=g=null;for(h in i)if(i.hasOwnProperty(h)&&(k=i[h],k!=null))switch(h){case"value":g=k;break;case"defaultValue":_=k;break;case"multiple":c=k;default:Ht(t,r,h,k,i,null)}r=g,i=_,t.multiple=!!c,r!=null?ca(t,!!c,r,!1):i!=null&&ca(t,!!c,i,!0);return;case"textarea":gt("invalid",t),g=h=c=null;for(_ in i)if(i.hasOwnProperty(_)&&(k=i[_],k!=null))switch(_){case"value":c=k;break;case"defaultValue":h=k;break;case"children":g=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(a(91));break;default:Ht(t,r,_,k,i,null)}ua(t,c,h,g);return;case"option":for(W in i)if(i.hasOwnProperty(W)&&(c=i[W],c!=null))switch(W){case"selected":t.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Ht(t,r,W,c,i,null)}return;case"dialog":gt("beforetoggle",t),gt("toggle",t),gt("cancel",t),gt("close",t);break;case"iframe":case"object":gt("load",t);break;case"video":case"audio":for(c=0;c<wc.length;c++)gt(wc[c],t);break;case"image":gt("error",t),gt("load",t);break;case"details":gt("toggle",t);break;case"embed":case"source":case"link":gt("error",t),gt("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(re in i)if(i.hasOwnProperty(re)&&(c=i[re],c!=null))switch(re){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,r));default:Ht(t,r,re,c,i,null)}return;default:if(qe(r)){for(xe in i)i.hasOwnProperty(xe)&&(c=i[xe],c!==void 0&&Tp(t,r,xe,c,i,void 0));return}}for(k in i)i.hasOwnProperty(k)&&(c=i[k],c!=null&&Ht(t,r,k,c,i,null))}function r2(t,r,i,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,g=null,_=null,k=null,W=null,re=null,xe=null;for(he in i){var we=i[he];if(i.hasOwnProperty(he)&&we!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":W=we;default:c.hasOwnProperty(he)||Ht(t,r,he,null,c,we)}}for(var le in c){var he=c[le];if(we=i[le],c.hasOwnProperty(le)&&(he!=null||we!=null))switch(le){case"type":g=he;break;case"name":h=he;break;case"checked":re=he;break;case"defaultChecked":xe=he;break;case"value":_=he;break;case"defaultValue":k=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(a(137,r));break;default:he!==we&&Ht(t,r,le,he,c,we)}}la(t,_,k,W,re,xe,g,h);return;case"select":he=_=k=le=null;for(g in i)if(W=i[g],i.hasOwnProperty(g)&&W!=null)switch(g){case"value":break;case"multiple":he=W;default:c.hasOwnProperty(g)||Ht(t,r,g,null,c,W)}for(h in c)if(g=c[h],W=i[h],c.hasOwnProperty(h)&&(g!=null||W!=null))switch(h){case"value":le=g;break;case"defaultValue":k=g;break;case"multiple":_=g;default:g!==W&&Ht(t,r,h,g,c,W)}r=k,i=_,c=he,le!=null?ca(t,!!i,le,!1):!!c!=!!i&&(r!=null?ca(t,!!i,r,!0):ca(t,!!i,i?[]:"",!1));return;case"textarea":he=le=null;for(k in i)if(h=i[k],i.hasOwnProperty(k)&&h!=null&&!c.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:Ht(t,r,k,null,c,h)}for(_ in c)if(h=c[_],g=i[_],c.hasOwnProperty(_)&&(h!=null||g!=null))switch(_){case"value":le=h;break;case"defaultValue":he=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(a(91));break;default:h!==g&&Ht(t,r,_,h,c,g)}Gl(t,le,he);return;case"option":for(var Be in i)if(le=i[Be],i.hasOwnProperty(Be)&&le!=null&&!c.hasOwnProperty(Be))switch(Be){case"selected":t.selected=!1;break;default:Ht(t,r,Be,null,c,le)}for(W in c)if(le=c[W],he=i[W],c.hasOwnProperty(W)&&le!==he&&(le!=null||he!=null))switch(W){case"selected":t.selected=le&&typeof le!="function"&&typeof le!="symbol";break;default:Ht(t,r,W,le,c,he)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Je in i)le=i[Je],i.hasOwnProperty(Je)&&le!=null&&!c.hasOwnProperty(Je)&&Ht(t,r,Je,null,c,le);for(re in c)if(le=c[re],he=i[re],c.hasOwnProperty(re)&&le!==he&&(le!=null||he!=null))switch(re){case"children":case"dangerouslySetInnerHTML":if(le!=null)throw Error(a(137,r));break;default:Ht(t,r,re,le,c,he)}return;default:if(qe(r)){for(var Gt in i)le=i[Gt],i.hasOwnProperty(Gt)&&le!==void 0&&!c.hasOwnProperty(Gt)&&Tp(t,r,Gt,void 0,c,le);for(xe in c)le=c[xe],he=i[xe],!c.hasOwnProperty(xe)||le===he||le===void 0&&he===void 0||Tp(t,r,xe,le,c,he);return}}for(var J in i)le=i[J],i.hasOwnProperty(J)&&le!=null&&!c.hasOwnProperty(J)&&Ht(t,r,J,null,c,le);for(we in c)le=c[we],he=i[we],!c.hasOwnProperty(we)||le===he||le==null&&he==null||Ht(t,r,we,le,c,he)}function Ab(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function a2(){if(typeof performance.getEntriesByType=="function"){for(var t=0,r=0,i=performance.getEntriesByType("resource"),c=0;c<i.length;c++){var h=i[c],g=h.transferSize,_=h.initiatorType,k=h.duration;if(g&&k&&Ab(_)){for(_=0,k=h.responseEnd,c+=1;c<i.length;c++){var W=i[c],re=W.startTime;if(re>k)break;var xe=W.transferSize,we=W.initiatorType;xe&&Ab(we)&&(W=W.responseEnd,_+=xe*(W<k?1:(k-re)/(W-re)))}if(--c,r+=8*(g+_)/(h.duration/1e3),t++,10<t)break}}if(0<t)return r/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Ap=null,Ip=null;function Td(t){return t.nodeType===9?t:t.ownerDocument}function Ib(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Nb(t,r){if(t===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&r==="foreignObject"?0:t}function Np(t,r){return t==="textarea"||t==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Cp=null;function i2(){var t=window.event;return t&&t.type==="popstate"?t===Cp?!1:(Cp=t,!0):(Cp=null,!1)}var Cb=typeof setTimeout=="function"?setTimeout:void 0,o2=typeof clearTimeout=="function"?clearTimeout:void 0,Rb=typeof Promise=="function"?Promise:void 0,l2=typeof queueMicrotask=="function"?queueMicrotask:typeof Rb<"u"?function(t){return Rb.resolve(null).then(t).catch(c2)}:Cb;function c2(t){setTimeout(function(){throw t})}function si(t){return t==="head"}function Ob(t,r){var i=r,c=0;do{var h=i.nextSibling;if(t.removeChild(i),h&&h.nodeType===8)if(i=h.data,i==="/$"||i==="/&"){if(c===0){t.removeChild(h),cl(r);return}c--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")c++;else if(i==="html")Tc(t.ownerDocument.documentElement);else if(i==="head"){i=t.ownerDocument.head,Tc(i);for(var g=i.firstChild;g;){var _=g.nextSibling,k=g.nodeName;g[ks]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&g.rel.toLowerCase()==="stylesheet"||i.removeChild(g),g=_}}else i==="body"&&Tc(t.ownerDocument.body);i=h}while(i);cl(r)}function jb(t,r){var i=t;t=0;do{var c=i.nextSibling;if(i.nodeType===1?r?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(r?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),c&&c.nodeType===8)if(i=c.data,i==="/$"){if(t===0)break;t--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||t++;i=c}while(i)}function Rp(t){var r=t.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var i=r;switch(r=r.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":Rp(i),ia(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}t.removeChild(i)}}function u2(t,r,i,c){for(;t.nodeType===1;){var h=i;if(t.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[ks])switch(r){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(g=t.getAttribute("rel"),g==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(g!==h.rel||t.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||t.getAttribute("title")!==(h.title==null?null:h.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(g=t.getAttribute("src"),(g!==(h.src==null?null:h.src)||t.getAttribute("type")!==(h.type==null?null:h.type)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&g&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(r==="input"&&t.type==="hidden"){var g=h.name==null?null:""+h.name;if(h.type==="hidden"&&t.getAttribute("name")===g)return t}else return t;if(t=or(t.nextSibling),t===null)break}return null}function d2(t,r,i){if(r==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!i||(t=or(t.nextSibling),t===null))return null;return t}function kb(t,r){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!r||(t=or(t.nextSibling),t===null))return null;return t}function Op(t){return t.data==="$?"||t.data==="$~"}function jp(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function f2(t,r){var i=t.ownerDocument;if(t.data==="$~")t._reactRetry=r;else if(t.data!=="$?"||i.readyState!=="loading")r();else{var c=function(){r(),i.removeEventListener("DOMContentLoaded",c)};i.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function or(t){for(;t!=null;t=t.nextSibling){var r=t.nodeType;if(r===1||r===3)break;if(r===8){if(r=t.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return t}var kp=null;function Lb(t){t=t.nextSibling;for(var r=0;t;){if(t.nodeType===8){var i=t.data;if(i==="/$"||i==="/&"){if(r===0)return or(t.nextSibling);r--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||r++}t=t.nextSibling}return null}function Mb(t){t=t.previousSibling;for(var r=0;t;){if(t.nodeType===8){var i=t.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(r===0)return t;r--}else i!=="/$"&&i!=="/&"||r++}t=t.previousSibling}return null}function Db(t,r,i){switch(r=Td(i),t){case"html":if(t=r.documentElement,!t)throw Error(a(452));return t;case"head":if(t=r.head,!t)throw Error(a(453));return t;case"body":if(t=r.body,!t)throw Error(a(454));return t;default:throw Error(a(451))}}function Tc(t){for(var r=t.attributes;r.length;)t.removeAttributeNode(r[0]);ia(t)}var lr=new Map,Ub=new Set;function Ad(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var Na=ae.d;ae.d={f:h2,r:p2,D:m2,C:g2,L:y2,m:x2,X:v2,S:b2,M:_2};function h2(){var t=Na.f(),r=yd();return t||r}function p2(t){var r=Es(t);r!==null&&r.tag===5&&r.type==="form"?ex(r):Na.r(t)}var il=typeof document>"u"?null:document;function Pb(t,r,i){var c=il;if(c&&typeof r=="string"&&r){var h=ts(r);h='link[rel="'+t+'"][href="'+h+'"]',typeof i=="string"&&(h+='[crossorigin="'+i+'"]'),Ub.has(h)||(Ub.add(h),t={rel:t,crossOrigin:i,href:r},c.querySelector(h)===null&&(r=c.createElement("link"),Zn(r,"link",t),un(r),c.head.appendChild(r)))}}function m2(t){Na.D(t),Pb("dns-prefetch",t,null)}function g2(t,r){Na.C(t,r),Pb("preconnect",t,r)}function y2(t,r,i){Na.L(t,r,i);var c=il;if(c&&t&&r){var h='link[rel="preload"][as="'+ts(r)+'"]';r==="image"&&i&&i.imageSrcSet?(h+='[imagesrcset="'+ts(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(h+='[imagesizes="'+ts(i.imageSizes)+'"]')):h+='[href="'+ts(t)+'"]';var g=h;switch(r){case"style":g=ol(t);break;case"script":g=ll(t)}lr.has(g)||(t=v({rel:"preload",href:r==="image"&&i&&i.imageSrcSet?void 0:t,as:r},i),lr.set(g,t),c.querySelector(h)!==null||r==="style"&&c.querySelector(Ac(g))||r==="script"&&c.querySelector(Ic(g))||(r=c.createElement("link"),Zn(r,"link",t),un(r),c.head.appendChild(r)))}}function x2(t,r){Na.m(t,r);var i=il;if(i&&t){var c=r&&typeof r.as=="string"?r.as:"script",h='link[rel="modulepreload"][as="'+ts(c)+'"][href="'+ts(t)+'"]',g=h;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=ll(t)}if(!lr.has(g)&&(t=v({rel:"modulepreload",href:t},r),lr.set(g,t),i.querySelector(h)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(Ic(g)))return}c=i.createElement("link"),Zn(c,"link",t),un(c),i.head.appendChild(c)}}}function b2(t,r,i){Na.S(t,r,i);var c=il;if(c&&t){var h=Ws(c).hoistableStyles,g=ol(t);r=r||"default";var _=h.get(g);if(!_){var k={loading:0,preload:null};if(_=c.querySelector(Ac(g)))k.loading=5;else{t=v({rel:"stylesheet",href:t,"data-precedence":r},i),(i=lr.get(g))&&Lp(t,i);var W=_=c.createElement("link");un(W),Zn(W,"link",t),W._p=new Promise(function(re,xe){W.onload=re,W.onerror=xe}),W.addEventListener("load",function(){k.loading|=1}),W.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Id(_,r,c)}_={type:"stylesheet",instance:_,count:1,state:k},h.set(g,_)}}}function v2(t,r){Na.X(t,r);var i=il;if(i&&t){var c=Ws(i).hoistableScripts,h=ll(t),g=c.get(h);g||(g=i.querySelector(Ic(h)),g||(t=v({src:t,async:!0},r),(r=lr.get(h))&&Mp(t,r),g=i.createElement("script"),un(g),Zn(g,"link",t),i.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(h,g))}}function _2(t,r){Na.M(t,r);var i=il;if(i&&t){var c=Ws(i).hoistableScripts,h=ll(t),g=c.get(h);g||(g=i.querySelector(Ic(h)),g||(t=v({src:t,async:!0,type:"module"},r),(r=lr.get(h))&&Mp(t,r),g=i.createElement("script"),un(g),Zn(g,"link",t),i.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(h,g))}}function Vb(t,r,i,c){var h=(h=pe.current)?Ad(h):null;if(!h)throw Error(a(446));switch(t){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(r=ol(i.href),i=Ws(h).hoistableStyles,c=i.get(r),c||(c={type:"style",instance:null,count:0,state:null},i.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){t=ol(i.href);var g=Ws(h).hoistableStyles,_=g.get(t);if(_||(h=h.ownerDocument||h,_={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(t,_),(g=h.querySelector(Ac(t)))&&!g._p&&(_.instance=g,_.state.loading=5),lr.has(t)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},lr.set(t,i),g||E2(h,t,i,_.state))),r&&c===null)throw Error(a(528,""));return _}if(r&&c!==null)throw Error(a(529,""));return null;case"script":return r=i.async,i=i.src,typeof i=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ll(i),i=Ws(h).hoistableScripts,c=i.get(r),c||(c={type:"script",instance:null,count:0,state:null},i.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,t))}}function ol(t){return'href="'+ts(t)+'"'}function Ac(t){return'link[rel="stylesheet"]['+t+"]"}function zb(t){return v({},t,{"data-precedence":t.precedence,precedence:null})}function E2(t,r,i,c){t.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=t.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Zn(r,"link",i),un(r),t.head.appendChild(r))}function ll(t){return'[src="'+ts(t)+'"]'}function Ic(t){return"script[async]"+t}function Bb(t,r,i){if(r.count++,r.instance===null)switch(r.type){case"style":var c=t.querySelector('style[data-href~="'+ts(i.href)+'"]');if(c)return r.instance=c,un(c),c;var h=v({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),un(c),Zn(c,"style",h),Id(c,i.precedence,t),r.instance=c;case"stylesheet":h=ol(i.href);var g=t.querySelector(Ac(h));if(g)return r.state.loading|=4,r.instance=g,un(g),g;c=zb(i),(h=lr.get(h))&&Lp(c,h),g=(t.ownerDocument||t).createElement("link"),un(g);var _=g;return _._p=new Promise(function(k,W){_.onload=k,_.onerror=W}),Zn(g,"link",c),r.state.loading|=4,Id(g,i.precedence,t),r.instance=g;case"script":return g=ll(i.src),(h=t.querySelector(Ic(g)))?(r.instance=h,un(h),h):(c=i,(h=lr.get(g))&&(c=v({},i),Mp(c,h)),t=t.ownerDocument||t,h=t.createElement("script"),un(h),Zn(h,"link",c),t.head.appendChild(h),r.instance=h);case"void":return null;default:throw Error(a(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,Id(c,i.precedence,t));return r.instance}function Id(t,r,i){for(var c=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=c.length?c[c.length-1]:null,g=h,_=0;_<c.length;_++){var k=c[_];if(k.dataset.precedence===r)g=k;else if(g!==h)break}g?g.parentNode.insertBefore(t,g.nextSibling):(r=i.nodeType===9?i.head:i,r.insertBefore(t,r.firstChild))}function Lp(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.title==null&&(t.title=r.title)}function Mp(t,r){t.crossOrigin==null&&(t.crossOrigin=r.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=r.referrerPolicy),t.integrity==null&&(t.integrity=r.integrity)}var Nd=null;function Fb(t,r,i){if(Nd===null){var c=new Map,h=Nd=new Map;h.set(i,c)}else h=Nd,c=h.get(i),c||(c=new Map,h.set(i,c));if(c.has(t))return c;for(c.set(t,null),i=i.getElementsByTagName(t),h=0;h<i.length;h++){var g=i[h];if(!(g[ks]||g[cn]||t==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var _=g.getAttribute(r)||"";_=t+_;var k=c.get(_);k?k.push(g):c.set(_,[g])}}return c}function Hb(t,r,i){t=t.ownerDocument||t,t.head.insertBefore(i,r==="title"?t.querySelector("head > title"):null)}function w2(t,r,i){if(i===1||r.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;switch(r.rel){case"stylesheet":return t=r.disabled,typeof r.precedence=="string"&&t==null;default:return!0}case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function Gb(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function S2(t,r,i,c){if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var h=ol(c.href),g=r.querySelector(Ac(h));if(g){r=g._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(t.count++,t=Cd.bind(t),r.then(t,t)),i.state.loading|=4,i.instance=g,un(g);return}g=r.ownerDocument||r,c=zb(c),(h=lr.get(h))&&Lp(c,h),g=g.createElement("link"),un(g);var _=g;_._p=new Promise(function(k,W){_.onload=k,_.onerror=W}),Zn(g,"link",c),i.instance=g}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(i,r),(r=i.state.preload)&&(i.state.loading&3)===0&&(t.count++,i=Cd.bind(t),r.addEventListener("load",i),r.addEventListener("error",i))}}var Dp=0;function T2(t,r){return t.stylesheets&&t.count===0&&Od(t,t.stylesheets),0<t.count||0<t.imgCount?function(i){var c=setTimeout(function(){if(t.stylesheets&&Od(t,t.stylesheets),t.unsuspend){var g=t.unsuspend;t.unsuspend=null,g()}},6e4+r);0<t.imgBytes&&Dp===0&&(Dp=62500*a2());var h=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Od(t,t.stylesheets),t.unsuspend)){var g=t.unsuspend;t.unsuspend=null,g()}},(t.imgBytes>Dp?50:800)+r);return t.unsuspend=i,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(h)}}:null}function Cd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Od(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Rd=null;function Od(t,r){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Rd=new Map,r.forEach(A2,t),Rd=null,Cd.call(t))}function A2(t,r){if(!(r.state.loading&4)){var i=Rd.get(t);if(i)var c=i.get(null);else{i=new Map,Rd.set(t,i);for(var h=t.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<h.length;g++){var _=h[g];(_.nodeName==="LINK"||_.getAttribute("media")!=="not all")&&(i.set(_.dataset.precedence,_),c=_)}c&&i.set(null,c)}h=r.instance,_=h.getAttribute("data-precedence"),g=i.get(_)||c,g===c&&i.set(null,h),i.set(_,h),this.count++,c=Cd.bind(this),h.addEventListener("load",c),h.addEventListener("error",c),g?g.parentNode.insertBefore(h,g.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(h,t.firstChild)),r.state.loading|=4}}var Nc={$$typeof:F,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function I2(t,r,i,c,h,g,_,k,W){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Xt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xt(0),this.hiddenUpdates=Xt(null),this.identifierPrefix=c,this.onUncaughtError=h,this.onCaughtError=g,this.onRecoverableError=_,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function qb(t,r,i,c,h,g,_,k,W,re,xe,we){return t=new I2(t,r,i,_,W,re,xe,we,k),r=1,g===!0&&(r|=24),g=Ms(3,null,null,r),t.current=g,g.stateNode=t,r=mh(),r.refCount++,t.pooledCache=r,r.refCount++,g.memoizedState={element:c,isDehydrated:i,cache:r},bh(g),t}function $b(t){return t?(t=Vo,t):Vo}function Yb(t,r,i,c,h,g){h=$b(h),c.context===null?c.context=h:c.pendingContext=h,c=$a(r),c.payload={element:i},g=g===void 0?null:g,g!==null&&(c.callback=g),i=Ya(t,c,r),i!==null&&(Is(i,t,r),ic(i,t,r))}function Wb(t,r){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var i=t.retryLane;t.retryLane=i!==0&&i<r?i:r}}function Up(t,r){Wb(t,r),(t=t.alternate)&&Wb(t,r)}function Qb(t){if(t.tag===13||t.tag===31){var r=Gi(t,67108864);r!==null&&Is(r,t,67108864),Up(t,67108864)}}function Kb(t){if(t.tag===13||t.tag===31){var r=zs();r=ra(r);var i=Gi(t,r);i!==null&&Is(i,t,r),Up(t,r)}}var jd=!0;function N2(t,r,i,c){var h=G.T;G.T=null;var g=ae.p;try{ae.p=2,Pp(t,r,i,c)}finally{ae.p=g,G.T=h}}function C2(t,r,i,c){var h=G.T;G.T=null;var g=ae.p;try{ae.p=8,Pp(t,r,i,c)}finally{ae.p=g,G.T=h}}function Pp(t,r,i,c){if(jd){var h=Vp(c);if(h===null)Sp(t,r,c,kd,i),Xb(t,c);else if(O2(h,t,r,i,c))c.stopPropagation();else if(Xb(t,c),r&4&&-1<R2.indexOf(t)){for(;h!==null;){var g=Es(h);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var _=Dt(g.pendingLanes);if(_!==0){var k=g;for(k.pendingLanes|=2,k.entangledLanes|=2;_;){var W=1<<31-Ne(_);k.entanglements[1]|=W,_&=~W}$r(g),(Mt&6)===0&&(md=Ve()+500,Ec(0))}}break;case 31:case 13:k=Gi(g,2),k!==null&&Is(k,g,2),yd(),Up(g,2)}if(g=Vp(c),g===null&&Sp(t,r,c,kd,i),g===h)break;h=g}h!==null&&c.stopPropagation()}else Sp(t,r,c,null,i)}}function Vp(t){return t=kt(t),zp(t)}var kd=null;function zp(t){if(kd=null,t=Ys(t),t!==null){var r=l(t);if(r===null)t=null;else{var i=r.tag;if(i===13){if(t=d(r),t!==null)return t;t=null}else if(i===31){if(t=p(r),t!==null)return t;t=null}else if(i===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;t=null}else r!==t&&(t=null)}}return kd=t,null}function Zb(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(lt()){case ct:return 2;case nt:return 8;case pt:case qt:return 32;case Pt:return 268435456;default:return 32}default:return 32}}var Bp=!1,ri=null,ai=null,ii=null,Cc=new Map,Rc=new Map,oi=[],R2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Xb(t,r){switch(t){case"focusin":case"focusout":ri=null;break;case"dragenter":case"dragleave":ai=null;break;case"mouseover":case"mouseout":ii=null;break;case"pointerover":case"pointerout":Cc.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rc.delete(r.pointerId)}}function Oc(t,r,i,c,h,g){return t===null||t.nativeEvent!==g?(t={blockedOn:r,domEventName:i,eventSystemFlags:c,nativeEvent:g,targetContainers:[h]},r!==null&&(r=Es(r),r!==null&&Qb(r)),t):(t.eventSystemFlags|=c,r=t.targetContainers,h!==null&&r.indexOf(h)===-1&&r.push(h),t)}function O2(t,r,i,c,h){switch(r){case"focusin":return ri=Oc(ri,t,r,i,c,h),!0;case"dragenter":return ai=Oc(ai,t,r,i,c,h),!0;case"mouseover":return ii=Oc(ii,t,r,i,c,h),!0;case"pointerover":var g=h.pointerId;return Cc.set(g,Oc(Cc.get(g)||null,t,r,i,c,h)),!0;case"gotpointercapture":return g=h.pointerId,Rc.set(g,Oc(Rc.get(g)||null,t,r,i,c,h)),!0}return!1}function Jb(t){var r=Ys(t.target);if(r!==null){var i=l(r);if(i!==null){if(r=i.tag,r===13){if(r=d(i),r!==null){t.blockedOn=r,yn(t.priority,function(){Kb(i)});return}}else if(r===31){if(r=p(i),r!==null){t.blockedOn=r,yn(t.priority,function(){Kb(i)});return}}else if(r===3&&i.stateNode.current.memoizedState.isDehydrated){t.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ld(t){if(t.blockedOn!==null)return!1;for(var r=t.targetContainers;0<r.length;){var i=Vp(t.nativeEvent);if(i===null){i=t.nativeEvent;var c=new i.constructor(i.type,i);Ln=c,i.target.dispatchEvent(c),Ln=null}else return r=Es(i),r!==null&&Qb(r),t.blockedOn=i,!1;r.shift()}return!0}function ev(t,r,i){Ld(t)&&i.delete(r)}function j2(){Bp=!1,ri!==null&&Ld(ri)&&(ri=null),ai!==null&&Ld(ai)&&(ai=null),ii!==null&&Ld(ii)&&(ii=null),Cc.forEach(ev),Rc.forEach(ev)}function Md(t,r){t.blockedOn===r&&(t.blockedOn=null,Bp||(Bp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,j2)))}var Dd=null;function tv(t){Dd!==t&&(Dd=t,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Dd===t&&(Dd=null);for(var r=0;r<t.length;r+=3){var i=t[r],c=t[r+1],h=t[r+2];if(typeof c!="function"){if(zp(c||i)===null)continue;break}var g=Es(i);g!==null&&(t.splice(r,3),r-=3,Vh(g,{pending:!0,data:h,method:i.method,action:c},c,h))}}))}function cl(t){function r(W){return Md(W,t)}ri!==null&&Md(ri,t),ai!==null&&Md(ai,t),ii!==null&&Md(ii,t),Cc.forEach(r),Rc.forEach(r);for(var i=0;i<oi.length;i++){var c=oi[i];c.blockedOn===t&&(c.blockedOn=null)}for(;0<oi.length&&(i=oi[0],i.blockedOn===null);)Jb(i),i.blockedOn===null&&oi.shift();if(i=(t.ownerDocument||t).$$reactFormReplay,i!=null)for(c=0;c<i.length;c+=3){var h=i[c],g=i[c+1],_=h[wn]||null;if(typeof g=="function")_||tv(i);else if(_){var k=null;if(g&&g.hasAttribute("formAction")){if(h=g,_=g[wn]||null)k=_.formAction;else if(zp(h)!==null)continue}else k=_.action;typeof k=="function"?i[c+1]=k:(i.splice(c,3),c-=3),tv(i)}}}function nv(){function t(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(_){return h=_})},focusReset:"manual",scroll:"manual"})}function r(){h!==null&&(h(),h=null),c||setTimeout(i,20)}function i(){if(!c&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,h=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(i,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),h!==null&&(h(),h=null)}}}function Fp(t){this._internalRoot=t}Ud.prototype.render=Fp.prototype.render=function(t){var r=this._internalRoot;if(r===null)throw Error(a(409));var i=r.current,c=zs();Yb(i,c,t,r,null,null)},Ud.prototype.unmount=Fp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var r=t.containerInfo;Yb(t.current,2,null,t,null,null),yd(),r[$s]=null}};function Ud(t){this._internalRoot=t}Ud.prototype.unstable_scheduleHydration=function(t){if(t){var r=js();t={blockedOn:null,target:t,priority:r};for(var i=0;i<oi.length&&r!==0&&r<oi[i].priority;i++);oi.splice(i,0,t),i===0&&Jb(t)}};var sv=e.version;if(sv!=="19.2.4")throw Error(a(527,sv,"19.2.4"));ae.findDOMNode=function(t){var r=t._reactInternals;if(r===void 0)throw typeof t.render=="function"?Error(a(188)):(t=Object.keys(t).join(","),Error(a(268,t)));return t=y(r),t=t!==null?x(t):null,t=t===null?null:t.stateNode,t};var k2={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pd.isDisabled&&Pd.supportsFiber)try{Zt=Pd.inject(k2),be=Pd}catch{}}return kc.createRoot=function(t,r){if(!o(t))throw Error(a(299));var i=!1,c="",h=ux,g=dx,_=fx;return r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(h=r.onUncaughtError),r.onCaughtError!==void 0&&(g=r.onCaughtError),r.onRecoverableError!==void 0&&(_=r.onRecoverableError)),r=qb(t,1,!1,null,null,i,c,null,h,g,_,nv),t[$s]=r.current,wp(t),new Fp(r)},kc.hydrateRoot=function(t,r,i){if(!o(t))throw Error(a(299));var c=!1,h="",g=ux,_=dx,k=fx,W=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(_=i.onCaughtError),i.onRecoverableError!==void 0&&(k=i.onRecoverableError),i.formState!==void 0&&(W=i.formState)),r=qb(t,1,!0,r,i??null,c,h,W,g,_,k,nv),r.context=$b(null),i=r.current,c=zs(),c=ra(c),h=$a(c),h.callback=null,Ya(i,h,c),i=c,r.current.lanes=i,$n(r,i),$r(r),t[$s]=r.current,wp(t),new Ud(r)},kc.version="19.2.4",kc}var hv;function F2(){if(hv)return qp.exports;hv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),qp.exports=B2(),qp.exports}var H2=F2();const G2=CE(H2);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),OE=(...n)=>n.filter((e,s,a)=>!!e&&e.trim()!==""&&a.indexOf(e)===s).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=L.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,iconNode:d,...p},m)=>L.createElement("svg",{ref:m,...$2,width:e,height:e,stroke:n,strokeWidth:a?Number(s)*24/Number(e):s,className:OE("lucide",o),...p},[...d.map(([y,x])=>L.createElement(y,x)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=(n,e)=>{const s=L.forwardRef(({className:a,...o},l)=>L.createElement(Y2,{ref:l,iconNode:e,className:OE(`lucide-${q2(n)}`,a),...o}));return s.displayName=`${n}`,s};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W2=Ie("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jE=Ie("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $c=Ie("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=Ie("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=Ie("AudioLines",[["path",{d:"M2 10v3",key:"1fnikh"}],["path",{d:"M6 6v11",key:"11sgs0"}],["path",{d:"M10 3v18",key:"yhl04a"}],["path",{d:"M14 8v7",key:"3a1oy3"}],["path",{d:"M18 5v13",key:"123xd1"}],["path",{d:"M22 10v3",key:"154ddg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qp=Ie("Binary",[["rect",{x:"14",y:"14",width:"4",height:"6",rx:"2",key:"p02svl"}],["rect",{x:"6",y:"4",width:"4",height:"6",rx:"2",key:"xm4xkj"}],["path",{d:"M6 20h4",key:"1i6q5t"}],["path",{d:"M14 10h4",key:"ru81e7"}],["path",{d:"M6 14h2v6",key:"16z9wg"}],["path",{d:"M14 4h2v6",key:"1idq9u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K2=Ie("Bolt",[["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=Ie("BookCopy",[["path",{d:"M2 16V4a2 2 0 0 1 2-2h11",key:"spzkk5"}],["path",{d:"M22 18H11a2 2 0 1 0 0 4h10.5a.5.5 0 0 0 .5-.5v-15a.5.5 0 0 0-.5-.5H11a2 2 0 0 0-2 2v12",key:"1wz07i"}],["path",{d:"M5 14H4a2 2 0 1 0 0 4h1",key:"16gqf9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=Ie("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lf=Ie("BookText",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=Ie("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=Ie("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=Ie("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=Ie("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cl=Ie("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=Ie("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=Ie("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=Ie("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=Ie("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=Ie("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=Ie("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=Ie("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=Ie("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vm=Ie("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=Ie("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pv=Ie("CloudDownload",[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mv=Ie("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=Ie("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=Ie("Combine",[["path",{d:"M10 18H5a3 3 0 0 1-3-3v-1",key:"ru65g8"}],["path",{d:"M14 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"e30een"}],["path",{d:"M20 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"2ahx8o"}],["path",{d:"m7 21 3-3-3-3",key:"127cv2"}],["rect",{x:"14",y:"14",width:"8",height:"8",rx:"2",key:"1b0bso"}],["rect",{x:"2",y:"2",width:"8",height:"8",rx:"2",key:"1x09vl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=Ie("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rg=Ie("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=Ie("CornerDownLeft",[["polyline",{points:"9 10 4 15 9 20",key:"r3jprv"}],["path",{d:"M20 4v7a4 4 0 0 1-4 4H4",key:"6o5b7l"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UE=Ie("CornerLeftUp",[["polyline",{points:"14 9 9 4 4 9",key:"m9oyvo"}],["path",{d:"M20 20h-7a4 4 0 0 1-4-4V4",key:"1blwi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=Ie("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=Ie("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=Ie("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=Ie("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ru=Ie("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=Ie("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=Ie("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=Ie("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=Ie("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=Ie("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=Ie("Ghost",[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zE=Ie("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=Ie("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=Ie("Grid2x2",[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 12h18",key:"1i2n21"}],["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FE=Ie("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=Ie("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=Ie("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gv=Ie("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=Ie("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=Ie("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=Ie("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yI=Ie("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=Ie("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=Ie("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=Ie("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=Ie("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=Ie("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=Ie("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kg=Ie("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=Ie("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=Ie("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=Ie("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=Ie("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=Ie("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=Ie("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rl=Ie("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=Ie("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=Ie("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=Ie("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=Ie("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kp=Ie("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=Ie("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=Ie("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QE=Ie("ShieldX",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AI=Ie("Shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ol=Ie("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lg=Ie("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=Ie("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=Ie("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CI=Ie("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=Ie("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=Ie("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=Ie("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ug=Ie("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OI=Ie("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=Ie("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kI=Ie("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KE=Ie("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=Ie("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=Ie("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=Ie("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yv=Ie("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LI=Ie("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=Ie("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nf=Ie("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);var Ut=(n=>(n.FORGOT="FORGOT",n.HARD="HARD",n.EASY="EASY",n.LEARNED="LEARNED",n))(Ut||{}),Yt=(n=>(n.RAW="RAW",n.REFINED="REFINED",n.VERIFIED="VERIFIED",n.FAILED="FAILED",n))(Yt||{}),Bm=(n=>(n.VARIETY="VARIETY",n.MORE_ACADEMIC="MORE_ACADEMIC",n.LESS_ACADEMIC="LESS_ACADEMIC",n))(Bm||{});const Yc="u-vocab-master",MI="/data/data.json",DI=[],_l=[{id:"topic_family",title:"Family & Roots",description:"Relationships, upbringing, and the foundations of society.",backgroundTheme:"from-orange-100 to-rose-50",icon:"",segments:[{id:"seg_fam_1",title:"Family Ties",description:"The core units of human connection.",tagCriteria:"family",basicWords:["mother","father","brother","sister","child"],intermediateWords:["upbringing","nuclear family","sibling","guardian","relative"],advancedWords:["genealogy","consanguinity","authoritarian","matriarch","progeny"],visualIcon:"",boss:{name:"Family Elder",hp:20,dialogueIntro:"Do you truly know those you share your blood with?",dialogueWin:"The bonds of kinship are well understood.",dialogueLose:"You ignore your foundations.",image:"",dropBadgeId:"family_crest"}},{id:"seg_fam_2",title:"Modern Society",description:"How we live together in the 21st century.",tagCriteria:"society",basicWords:["people","city","house","friend","neighbor"],intermediateWords:["community","urbanization","demographics","infrastructure","diversity"],advancedWords:["egalitarian","stratification","cosmopolitan","secular","socioeconomic"],visualIcon:"",boss:{name:"The Architect",hp:20,dialogueIntro:"A city is more than stone and mortar. It is a collective mind.",dialogueWin:"You see the patterns in the crowd.",dialogueLose:"Lost in the concrete jungle.",image:"",dropBadgeId:"family_crest"}}]},{id:"topic_education",title:"The Academy",description:"Learning systems, pedagogy, and academic pursuits.",backgroundTheme:"from-yellow-100 to-amber-50",icon:"",segments:[{id:"seg_edu_1",title:"Primary School",description:"The beginning of the educational journey.",tagCriteria:"school",basicWords:["study","learn","teacher","book","class"],intermediateWords:["curriculum","assignment","literacy","discipline","tuition"],advancedWords:["pedagogy","didactic","erudition","rote learning","epistemology"],visualIcon:"",boss:{name:"The Headmaster",hp:20,dialogueIntro:"Class is in session. Don't be late.",dialogueWin:"A star student indeed.",dialogueLose:"Detention for you.",image:"",dropBadgeId:"education_scroll"}},{id:"seg_edu_2",title:"Higher Education",description:"University life and specialized research.",tagCriteria:"university",basicWords:["college","exam","paper","degree","lesson"],intermediateWords:["undergraduate","scholarship","dissertation","vocational","faculty"],advancedWords:["theoretical","specialization","prestigious","alumnus","doctoral"],visualIcon:"",boss:{name:"The Dean",hp:20,dialogueIntro:"Submit your thesis or fail the semester.",dialogueWin:"Your research is groundbreaking.",dialogueLose:"Insufficient evidence for your claims.",image:"",dropBadgeId:"education_scroll"}}]}],UI="IELTSVocabProDB_V2",tn="vocabulary",Tr="users",Fs="units",yo="paraphrase_logs",xo="speaking_logs",bo="speaking_topics",Hs="writing_topics",ja="writing_logs",Gs="irregular_verbs",Ar="lessons",vo="listening_items",Ir="native_speak_items",Nr="conversation_items",Cr="free_talk_items",Rr="compositions",Or="word_books",_o="reading_books",Fm="lesson_books",Hm="listening_books",Gm="speaking_books",qm="writing_books",jr="planning_goals",PI=27;let cr=null,Ca=null;const XE=async()=>{if(navigator.storage&&navigator.storage.persist)try{await navigator.storage.persisted()||await navigator.storage.persist()}catch{}},pu=()=>cr?Promise.resolve(cr):Ca||(Ca=new Promise((n,e)=>{try{const s=indexedDB.open(UI,PI);s.onblocked=()=>{console.warn("[DB] Database upgrade blocked. Please close other tabs/windows of this app.")},s.onupgradeneeded=a=>{const o=a.target.result;if(!o){console.error("Database not available during onupgradeneeded");return}if(o.objectStoreNames.contains(tn)){const l=s.transaction.objectStore(tn);l.indexNames.contains("word")||l.createIndex("word","word",{unique:!1})}else{const l=o.createObjectStore(tn,{keyPath:"id"});l.createIndex("userId","userId",{unique:!1}),l.createIndex("nextReview","nextReview",{unique:!1}),l.createIndex("userId_word",["userId","word"],{unique:!1}),l.createIndex("word","word",{unique:!1})}if(o.objectStoreNames.contains(Tr)||o.createObjectStore(Tr,{keyPath:"id"}),o.objectStoreNames.contains(Fs)||o.createObjectStore(Fs,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),!o.objectStoreNames.contains(yo)){const l=o.createObjectStore(yo,{keyPath:"id"});l.createIndex("userId","userId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1})}if(!o.objectStoreNames.contains(xo)){const l=o.createObjectStore(xo,{keyPath:"id"});l.createIndex("userId","userId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1})}if(a.oldVersion<9&&(o.objectStoreNames.contains(bo)||o.createObjectStore(bo,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<10&&(o.objectStoreNames.contains(Hs)||o.createObjectStore(Hs,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),!o.objectStoreNames.contains(ja))){const l=o.createObjectStore(ja,{keyPath:"id"});l.createIndex("userId","userId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1})}a.oldVersion<12&&o.objectStoreNames.contains("word_comparison_groups")&&o.deleteObjectStore("word_comparison_groups"),a.oldVersion<13&&(o.objectStoreNames.contains(Gs)||o.createObjectStore(Gs,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<14&&(o.objectStoreNames.contains(Ar)||o.createObjectStore(Ar,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<15&&(o.objectStoreNames.contains(vo)||o.createObjectStore(vo,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<16&&(o.objectStoreNames.contains(Ir)||o.createObjectStore(Ir,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<17&&(o.objectStoreNames.contains(Rr)||o.createObjectStore(Rr,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),o.objectStoreNames.contains("calendar_events")&&o.deleteObjectStore("calendar_events"),a.oldVersion<19&&(o.objectStoreNames.contains(Or)||o.createObjectStore(Or,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<20&&(o.objectStoreNames.contains(_o)||o.createObjectStore(_o,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<21&&(o.objectStoreNames.contains(Fm)||o.createObjectStore(Fm,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<22&&(o.objectStoreNames.contains(Hm)||o.createObjectStore(Hm,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),o.objectStoreNames.contains(Gm)||o.createObjectStore(Gm,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),o.objectStoreNames.contains(qm)||o.createObjectStore(qm,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<23&&(o.objectStoreNames.contains(jr)||o.createObjectStore(jr,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<24&&(o.objectStoreNames.contains(Nr)||o.createObjectStore(Nr,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),a.oldVersion<26&&(o.objectStoreNames.contains(Cr)||o.createObjectStore(Cr,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),o.objectStoreNames.contains("comparison_groups")&&o.deleteObjectStore("comparison_groups")},s.onsuccess=()=>{cr=s.result,cr.onclose=()=>{console.warn("[DB] Database connection closed unexpectedly."),cr=null,Ca=null,window.dispatchEvent(new CustomEvent("db-connection-lost"))},cr.onversionchange=()=>{console.warn("[DB] Database version change detected. Closing connection."),cr==null||cr.close(),cr=null,Ca=null,window.location.reload()},n(cr)},s.onerror=a=>{console.error("[DB] Open DB Error:",a.target.error),Ca=null,e(a.target.error)}}catch(s){console.error("[DB] Open DB Exception:",s),Ca=null,e(s)}}),Ca),JE=async()=>Cf(async()=>{const n=await pu();return new Promise((e,s)=>{const a=[Tr,tn,Fs,yo,xo,bo,ja,Hs,Gs,Ar,vo,Ir,Nr,Cr,Rr,Or,_o,Fm,Hm,Gm,qm,jr],o=n.transaction(a,"readwrite");a.forEach(l=>{n.objectStoreNames.contains(l)&&o.objectStore(l).clear()}),o.oncomplete=()=>{localStorage.removeItem("vocab_pro_mimic_practice_queue"),localStorage.removeItem("vocab_pro_db_marker"),localStorage.removeItem("vocab_pro_emergency_backup"),e()},o.onerror=()=>s(o.error)})}),Cf=async(n,e=3,s=200)=>{var a,o,l;for(let d=0;d<e;d++)try{return await n()}catch(p){if(console.warn(`[DB] Operation failed, retrying (${d+1}/${e}). Error:`,p),((p==null?void 0:p.name)==="InvalidStateError"||(a=p==null?void 0:p.message)!=null&&a.toLowerCase().includes("closed")||((l=(o=p==null?void 0:p.target)==null?void 0:o.error)==null?void 0:l.name)==="InvalidStateError")&&(cr=null,Ca=null),d===e-1)throw p;await new Promise(m=>setTimeout(m,s*Math.pow(2,d)))}throw new Error("Operation failed after retries")},Fe=async(n,e,s="readwrite")=>Cf(async()=>{const a=await pu();return new Promise((o,l)=>{try{const d=a.transaction(n,s),p=e(d);d.oncomplete=()=>o(p?p.result:void 0),d.onerror=()=>l(d.error),d.onabort=()=>l(new Error("Transaction aborted"))}catch(d){l(d)}})}),Pg=async(n=!1)=>{try{const e=await pu(),s=e.transaction(Tr,"readonly"),a=await new Promise((x,v)=>{const S=s.objectStore(Tr).getAll();S.onsuccess=()=>x(S.result||[]),S.onerror=()=>v(S.error)}),o=localStorage.getItem("vocab_pro_emergency_backup"),l=localStorage.getItem("vocab_pro_db_marker");if(a.length===0&&o)try{const x=JSON.parse(o);if(Array.isArray(x)&&x.length>0&&(await Eo(x),a.length===0)){const v={id:x[0].userId||Yc,name:"Recovered User",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Recovered",lastLogin:Date.now(),role:"Language Learner",experience:0,level:1,adventure:{currentNodeIndex:0,energy:5,energyShards:0,unlockedChapterIds:_l.map(S=>S.id),completedSegmentIds:[],segmentStars:{},badges:[],keys:1,keyFragments:0,map:[]}};return await fr(v),v}}catch(x){console.error("[DB]  Failed to restore from Emergency Backup:",x)}if(a.length===0&&l==="exists"&&!n)return console.error("[DB]  CRITICAL: LocalStorage marker found but IDB returned 0 users. Aborting auto-seed to prevent data loss."),null;const p=e.transaction(tn,"readonly").objectStore(tn).count(),m=await new Promise(x=>{p.onsuccess=()=>x(p.result>0),p.onerror=()=>{console.error("[DB] Failed to check for existing data. Assuming data exists to prevent overwrite."),x(!0)}});if(!n&&a.length>0&&(l!=="exists"&&localStorage.setItem("vocab_pro_db_marker","exists"),m||sessionStorage.getItem("ielts_pro_skip_seed")==="true"))return null;let y;if(a.length===0?(y={id:Yc,name:"Vocab Master",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Master",lastLogin:Date.now(),role:"Language Learner",currentLevel:"Intermediate",target:"Advanced Fluency",experience:0,level:1,peakLevel:1,adventure:{currentNodeIndex:0,energy:5,energyShards:0,unlockedChapterIds:_l.map(x=>x.id),completedSegmentIds:[],segmentStars:{},badges:[],keys:1,keyFragments:0,map:[]}},await fr(y),localStorage.setItem("vocab_pro_db_marker","exists")):(y=a[0],y.experience===void 0&&(y.experience=0),y.level===void 0&&(y.level=1),y.peakLevel===void 0&&(y.peakLevel=y.level),y.adventure||(y.adventure={currentNodeIndex:0,energy:5,energyShards:0,unlockedChapterIds:_l.map(x=>x.id),completedSegmentIds:[],segmentStars:{},badges:[],keys:1,keyFragments:0,map:[]}),await fr(y)),!m){let x=[];try{const S=await fetch(MI);if(S.ok){const I=await S.json();x=Array.isArray(I)?I:I.vocabulary||[]}}catch(S){console.error("Failed to fetch local seed data:",S)}x.length===0&&(x=DI);const v=x.map(S=>({...S,nextReview:S.nextReview||Date.now(),lastXpEarnedTime:S.lastXpEarnedTime||void 0,quality:S.quality||Yt.VERIFIED,source:"app"}));await Eo(v)}return y}catch(e){return console.error("[DB] Seed check failed completely:",e),null}},El=async()=>Fe(Tr,n=>n.objectStore(Tr).getAll(),"readonly"),fr=async n=>(n&&n.id&&localStorage.setItem("vocab_pro_db_marker","exists"),Fe(Tr,e=>e.objectStore(Tr).put(n))),ew=async(n,e)=>Cf(async()=>{const s=await pu();return new Promise(a=>{const d=s.transaction(tn,"readonly").objectStore(tn).openCursor(),p=e.trim().toLowerCase();d.onsuccess=m=>{const y=m.target.result;y?y.value.userId===n&&y.value.word.trim().toLowerCase()===p?a(y.value):y.continue():a(null)},d.onerror=()=>{a(null)}})}),tw=async(n,e)=>Cf(async()=>{const s=await pu();return new Promise(a=>{const l=s.transaction(tn,"readonly").objectStore(tn).getAll();l.onsuccess=()=>{const d=l.result,p=["To express an idea or feeling","A state of great comfort and luxury","Happening or developing gradually","To influence or change someone or something","A formal meeting for discussion","Necessary for a particular purpose","The ability to do something well","A careful and detailed study of something","To make something new or original"],x=[...Array.from(new Set(d.filter(v=>v.id!==e&&v.quality===Yt.VERIFIED&&v.meaningVi&&v.meaningVi.trim().length>0&&v.meaningVi.length<150).map(v=>v.meaningVi.trim())))].sort(()=>Math.random()-.5).slice(0,n);if(x.length<n){const v=n-x.length,S=[...p].sort(()=>Math.random()-.5);for(let I=0;I<v;I++){const z=S[I%S.length];x.includes(z)||x.push(z)}}a([...x].sort(()=>Math.random()-.5))},l.onerror=()=>{a([])}})}),nw=(n,e,s,a,o,l,d="all",p=null,m="all",y=null,x="all",v=null)=>{var z;const S=e.toLowerCase().trim();if(S&&!(n.word.toLowerCase().includes(S)||n.meaningVi.toLowerCase().includes(S))||n.isPassive&&!s.includes("archive")||a!=="all"&&(a==="refined"&&n.quality!==Yt.REFINED||a==="verified"&&n.quality!==Yt.VERIFIED||a==="failed"&&n.quality!==Yt.FAILED||a==="raw"&&n.quality!==Yt.RAW||a==="not_refined"&&n.quality!==Yt.RAW))return!1;if(o!=="all"){const U=!n.lastReview,C=!!n.lastReview&&n.consecutiveCorrect===1&&n.lastGrade!==Ut.FORGOT,M=!!n.lastReview&&n.consecutiveCorrect>1&&n.lastGrade===Ut.EASY,B=!!n.lastReview&&n.consecutiveCorrect>1&&n.lastGrade===Ut.HARD,F=!!n.lastReview&&n.lastGrade===Ut.FORGOT;if(o==="new"&&!U||o==="learned"&&!C||o==="easy"&&!M||o==="hard"&&!B||o==="forgot"&&!F)return!1}if(l!=="all"&&(n.register||"raw")!==l||d!=="all"&&(n.source||"raw")!==d)return!1;if(p){if(p==="Uncategorized"){if(n.groups&&n.groups.length>0)return!1}else if(!((z=n.groups)!=null&&z.some(U=>U.startsWith(p))))return!1}if(m!=="all"&&y){const U=y.has(n.id);if(m==="composed"&&!U||m==="not_composed"&&U)return!1}if(x!=="all"&&v){const U=v.has(n.word.toLowerCase());if(x==="in_book"&&!U||x==="not_in_book"&&U)return!1}if(s.includes("all")||s.length===0)return!n.isPassive;for(const U of s)if(U==="archive"&&n.isPassive||U==="idiom"&&n.isIdiom||U==="phrasal"&&n.isPhrasalVerb||U==="colloc"&&n.isCollocation||U==="phrase"&&n.isStandardPhrase||U==="vocab"&&!n.isIdiom&&!n.isPhrasalVerb&&!n.isCollocation&&!n.isStandardPhrase)return!0;return!1},sw=async(n,e)=>{e&&e.id&&localStorage.setItem("vocab_pro_db_marker","exists"),await Fe([tn,Tr],s=>{s.objectStore(tn).put(n),s.objectStore(Tr).put(e)})},rw=async(n,e)=>{await Fe([tn,Fs],s=>{n&&s.objectStore(tn).put(n),s.objectStore(Fs).put(e)})},aw=async n=>{n.updatedAt=Date.now(),await Fe(tn,e=>e.objectStore(tn).put(n))},iw=async n=>{await Fe(tn,e=>e.objectStore(tn).delete(n))},ow=async n=>{await Fe(tn,e=>{const s=e.objectStore(tn);n.forEach(a=>s.delete(a))})},Eo=async n=>{n.length!==0&&await Fe(tn,e=>{const s=e.objectStore(tn);n.forEach(a=>s.put(a))})},jl=async()=>await Fe(tn,n=>n.objectStore(tn).getAll(),"readonly"),lw=async n=>{n.updatedAt=Date.now(),await Fe(Fs,e=>e.objectStore(Fs).put(n))},VI=async n=>{await Fe(Fs,e=>e.objectStore(Fs).delete(n))},Rf=async()=>await Fe(Fs,n=>n.objectStore(Fs).getAll(),"readonly"),zI=async n=>(await Rf()).filter(s=>s.wordIds.includes(n)),cw=async n=>{await Fe(Fs,e=>{const s=e.objectStore(Fs);n.forEach(a=>s.put(a))})},Vg=async()=>(await Fe(yo,e=>e.objectStore(yo).getAll(),"readonly")).sort((e,s)=>s.timestamp-e.timestamp),uw=async n=>{await Fe(yo,e=>{const s=e.objectStore(yo);n.forEach(a=>s.put(a))})},zg=async()=>await Fe(xo,n=>n.objectStore(xo).getAll(),"readonly"),dw=async n=>{await Fe(xo,e=>{const s=e.objectStore(xo);n.forEach(a=>s.put(a))})},Bg=async()=>await Fe(bo,n=>n.objectStore(bo).getAll(),"readonly"),fw=async n=>{await Fe(bo,e=>{const s=e.objectStore(bo);n.forEach(a=>s.put(a))})},hw=async n=>{n.updatedAt=Date.now(),await Fe(Ir,e=>e.objectStore(Ir).put(n))},Fg=async()=>await Fe(Ir,n=>n.objectStore(Ir).getAll(),"readonly"),pw=async n=>{await Fe(Ir,e=>e.objectStore(Ir).delete(n))},mw=async n=>{await Fe(Ir,e=>{const s=e.objectStore(Ir);n.forEach(a=>s.put(a))})},gw=async n=>{n.updatedAt=Date.now(),await Fe(Nr,e=>e.objectStore(Nr).put(n))},Hg=async()=>await Fe(Nr,n=>n.objectStore(Nr).getAll(),"readonly"),yw=async n=>{await Fe(Nr,e=>e.objectStore(Nr).delete(n))},xw=async n=>{await Fe(Nr,e=>{const s=e.objectStore(Nr);n.forEach(a=>s.put(a))})},bw=async n=>{n.updatedAt=Date.now(),await Fe(Cr,e=>e.objectStore(Cr).put(n))},Gg=async()=>await Fe(Cr,n=>n.objectStore(Cr).getAll(),"readonly"),vw=async n=>{await Fe(Cr,e=>e.objectStore(Cr).delete(n))},_w=async n=>{await Fe(Cr,e=>{const s=e.objectStore(Cr);n.forEach(a=>s.put(a))})},BI=async n=>{await Fe(ja,e=>e.objectStore(ja).put(n))},qg=async()=>await Fe(ja,n=>n.objectStore(ja).getAll(),"readonly"),Ew=async n=>{await Fe(ja,e=>{const s=e.objectStore(ja);n.forEach(a=>s.put(a))})},ww=async n=>{n.updatedAt=Date.now(),await Fe(Hs,e=>e.objectStore(Hs).put(n))},Sw=async n=>{await Fe(Hs,e=>e.objectStore(Hs).delete(n))},FI=async()=>await Fe(Hs,n=>n.objectStore(Hs).getAll(),"readonly"),$g=async()=>await Fe(Hs,n=>n.objectStore(Hs).getAll(),"readonly"),Tw=async n=>{await Fe(Hs,e=>{const s=e.objectStore(Hs);n.forEach(a=>s.put(a))})},HI=async n=>{n.updatedAt=Date.now(),await Fe(Gs,e=>e.objectStore(Gs).put(n))},Yg=async()=>await Fe(Gs,n=>n.objectStore(Gs).getAll(),"readonly"),GI=async n=>{await Fe(Gs,e=>e.objectStore(Gs).delete(n))},Aw=async n=>{await Fe(Gs,e=>{const s=e.objectStore(Gs);n.forEach(a=>s.put(a))})},qI=async n=>{await Fe(Gs,e=>{const s=e.objectStore(Gs);n.forEach(a=>s.delete(a))})},Iw=async n=>{n.updatedAt=Date.now(),await Fe(Ar,e=>e.objectStore(Ar).put(n))},Wg=async()=>await Fe(Ar,n=>n.objectStore(Ar).getAll(),"readonly"),Nw=async n=>{await Fe(Ar,e=>e.objectStore(Ar).delete(n))},Cw=async n=>{await Fe(Ar,e=>{const s=e.objectStore(Ar);n.forEach(a=>s.put(a))})},Qg=async()=>await Fe(vo,n=>n.objectStore(vo).getAll(),"readonly"),Rw=async n=>{await Fe(vo,e=>{const s=e.objectStore(vo);n.forEach(a=>s.put(a))})},Ow=async n=>{n.updatedAt=Date.now(),await Fe(Rr,e=>e.objectStore(Rr).put(n))},mu=async()=>await Fe(Rr,n=>n.objectStore(Rr).getAll(),"readonly"),jw=async n=>{await Fe(Rr,e=>e.objectStore(Rr).delete(n))},kw=async n=>{await Fe(Rr,e=>{const s=e.objectStore(Rr);n.forEach(a=>s.put(a))})},Lw=async n=>{await Fe(Or,e=>e.objectStore(Or).put(n))},gu=async()=>await Fe(Or,n=>n.objectStore(Or).getAll(),"readonly"),$I=async n=>{await Fe(Or,e=>e.objectStore(Or).delete(n))},Mw=async n=>{await Fe(Or,e=>{const s=e.objectStore(Or);n.forEach(a=>s.put(a))})},Kg=async()=>await Fe(_o,n=>n.objectStore(_o).getAll(),"readonly"),Dw=async n=>{await Fe(_o,e=>{const s=e.objectStore(_o);n.forEach(a=>s.put(a))})},Uw=async n=>{await Fe(jr,e=>e.objectStore(jr).put(n))},Zg=async()=>await Fe(jr,n=>n.objectStore(jr).getAll(),"readonly"),Pw=async n=>{await Fe(jr,e=>e.objectStore(jr).delete(n))},Vw=async n=>{await Fe(jr,e=>{const s=e.objectStore(jr);n.forEach(a=>s.put(a))})},YI=Object.freeze(Object.defineProperty({__proto__:null,bulkDeleteIrregularVerbs:qI,bulkDeleteWords:ow,bulkSaveCompositions:kw,bulkSaveConversationItems:xw,bulkSaveFreeTalkItems:_w,bulkSaveIrregularVerbs:Aw,bulkSaveLessons:Cw,bulkSaveListeningItems:Rw,bulkSaveNativeSpeakItems:mw,bulkSaveParaphraseLogs:uw,bulkSavePlanningGoals:Vw,bulkSaveReadingBooks:Dw,bulkSaveSpeakingLogs:dw,bulkSaveSpeakingTopics:fw,bulkSaveUnits:cw,bulkSaveWordBooks:Mw,bulkSaveWords:Eo,bulkSaveWritingLogs:Ew,bulkSaveWritingTopics:Tw,clearVocabularyOnly:JE,deleteComposition:jw,deleteConversationItem:yw,deleteFreeTalkItem:vw,deleteIrregularVerb:GI,deleteLesson:Nw,deleteNativeSpeakItem:pw,deletePlanningGoal:Pw,deleteUnit:VI,deleteWordBook:$I,deleteWordFromDB:iw,deleteWritingTopic:Sw,filterItem:nw,findWordByText:ew,getAllSpeakingLogsForExport:zg,getAllSpeakingTopicsForExport:Bg,getAllUsers:El,getAllWordsForExport:jl,getAllWritingLogsForExport:qg,getAllWritingTopicsForExport:$g,getCompositionsByUserId:mu,getConversationItemsByUserId:Hg,getFreeTalkItemsByUserId:Gg,getIrregularVerbsByUserId:Yg,getLessonsByUserId:Wg,getListeningItemsByUserId:Qg,getNativeSpeakItemsByUserId:Fg,getParaphraseLogs:Vg,getPlanningGoalsByUserId:Zg,getRandomMeanings:tw,getReadingBooksByUserId:Kg,getUnitsByUserId:Rf,getUnitsContainingWord:zI,getWordBooksByUserId:gu,getWritingTopicsByUserId:FI,saveComposition:Ow,saveConversationItem:gw,saveFreeTalkItem:bw,saveIrregularVerb:HI,saveLesson:Iw,saveNativeSpeakItem:hw,savePlanningGoal:Uw,saveUnit:lw,saveUser:fr,saveWord:aw,saveWordAndUnit:rw,saveWordAndUser:sw,saveWordBook:Lw,saveWritingLog:BI,saveWritingTopic:ww,seedDatabaseIfEmpty:Pg,tryPersistStorage:XE},Symbol.toStringTag,{value:"Module"})),WI=["Vietnamese","Spanish","Chinese (Simplified)","Chinese (Traditional)","Japanese","Korean","French","German","Italian","Portuguese","Russian","Arabic","Hindi","Thai","Indonesian","Turkish"],QI=[{id:"learner",label:"General Learner",icon:kE},{id:"professional",label:"Professional",icon:eI},{id:"student",label:"Student",icon:BE}],KI=({users:n,isCreating:e,setIsCreating:s,loading:a,hasApiKey:o,newName:l,setNewName:d,newRole:p,setNewRole:m,newLevel:y,setNewLevel:x,newTarget:v,setNewTarget:S,newLanguage:I,setNewLanguage:z,newAudience:U,setNewAudience:C,selectedPersona:M,handleSelectKey:B,handlePersonaSelect:F,handleCreateProfile:H,onLogin:q})=>a?u.jsx("div",{className:"h-screen flex items-center justify-center bg-neutral-50",children:u.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[u.jsx(mn,{className:"animate-spin text-neutral-300",size:40}),u.jsx("p",{className:"text-xs font-black text-neutral-400 uppercase tracking-widest",children:"Initializing Lab..."})]})}):u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-neutral-50 p-6",children:u.jsxs("div",{className:"max-w-md w-full space-y-10",children:[u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("div",{className:"inline-flex p-4 bg-white rounded-3xl shadow-sm border border-neutral-100 mb-4",children:u.jsx(Ol,{className:"text-neutral-900",size:32})}),u.jsx("h1",{className:"text-4xl font-black text-neutral-900 tracking-tight",children:"Vocab Pro"}),u.jsx("p",{className:"text-neutral-500 font-medium italic",children:"Your words. Your context. Your mastery."})]}),!o&&n.length===0&&u.jsxs("div",{className:"bg-amber-50 border-2 border-amber-100 p-6 rounded-[2rem] space-y-4 animate-in fade-in slide-in-from-top-4",children:[u.jsxs("div",{className:"flex items-start space-x-3 text-amber-800",children:[u.jsx(Ra,{size:24,className:"shrink-0 mt-1"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-black text-lg",children:"AI Configuration Required"}),u.jsx("p",{className:"text-sm font-medium mt-1 opacity-80",children:"To enable AI word analysis and suggestions, you must select a Gemini API key."})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("button",{onClick:B,className:"w-full py-4 bg-amber-600 text-white font-black rounded-2xl shadow-lg hover:bg-amber-700 transition-all flex items-center justify-center space-x-2 active:scale-95",children:[u.jsx(mI,{size:18}),u.jsx("span",{children:"CONNECT GEMINI API"})]}),u.jsxs("a",{href:"https://ai.google.dev/gemini-api/docs/billing",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center space-x-1.5 text-[10px] font-black text-amber-600 uppercase tracking-widest hover:underline",children:[u.jsx("span",{children:"Billing Documentation"}),u.jsx(cI,{size:10})]})]})]}),e?u.jsxs("form",{onSubmit:H,className:"bg-white p-8 rounded-[2.5rem] shadow-xl border border-neutral-200 animate-in zoom-in-95 duration-300 space-y-6",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center",children:[u.jsx(OI,{className:"mr-2",size:20})," Create Profile"]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2",children:"Display Name"}),u.jsx("input",{autoFocus:!0,type:"text",value:l,onChange:Y=>d(Y.target.value),placeholder:"Enter your name",className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-md font-bold focus:ring-2 focus:ring-neutral-900 focus:outline-none"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2 flex items-center gap-2",children:[u.jsx(zE,{size:14})," Language"]}),u.jsx("select",{value:I,onChange:Y=>z(Y.target.value),className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none appearance-none",children:WI.map(Y=>u.jsx("option",{value:Y,children:Y},Y))})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2 flex items-center gap-2",children:[u.jsx(KE,{size:14})," Audience"]}),u.jsxs("select",{value:U,onChange:Y=>C(Y.target.value),className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none appearance-none",children:[u.jsx("option",{value:"Kid",children:"Kid"}),u.jsx("option",{value:"Adult",children:"Adult"})]})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest",children:"About Me (Quick Start)"}),u.jsx("div",{className:"grid grid-cols-3 gap-2",children:QI.map(Y=>{const A=Y.icon;return u.jsxs("button",{type:"button",onClick:()=>F(Y.id),className:`p-3 border-2 rounded-2xl flex flex-col items-center justify-center space-y-1.5 transition-all text-center ${M===Y.id?"bg-neutral-900 border-neutral-900 text-white shadow-lg":"bg-white border-neutral-100 text-neutral-400 hover:border-neutral-200 hover:text-neutral-900"}`,children:[u.jsx(A,{size:20}),u.jsx("span",{className:"text-[10px] font-black uppercase tracking-tight",children:Y.label})]},Y.id)})})]}),u.jsxs("div",{className:"space-y-4 pt-4 border-t border-neutral-100",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2",children:"Starting Role"}),u.jsx("input",{type:"text",value:p,onChange:Y=>m(Y.target.value),placeholder:"e.g., Working Professional, Student",className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-md font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2",children:"Current Level"}),u.jsx("input",{type:"text",value:y,onChange:Y=>x(Y.target.value),placeholder:"e.g., Intermediate",className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-md font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none"})]})]}),u.jsxs("div",{className:"flex space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 py-4 text-neutral-500 font-bold hover:bg-neutral-50 rounded-2xl transition-colors",children:"Back"}),u.jsx("button",{type:"submit",disabled:!l.trim(),className:"flex-[2] py-4 bg-neutral-900 text-white font-bold rounded-2xl shadow-lg hover:scale-[1.02] active:scale-95 transition-all disabled:opacity-50",children:"Start Learning"})]})]}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"grid grid-cols-1 gap-3",children:n.map(Y=>u.jsxs("button",{onClick:()=>q(Y),className:"bg-white p-5 rounded-3xl border border-neutral-200 shadow-sm flex items-center justify-between hover:border-neutral-900 hover:shadow-md transition-all group",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("img",{src:Y.avatar,className:"w-12 h-12 rounded-2xl bg-neutral-100 p-1",alt:Y.name}),u.jsxs("div",{className:"text-left",children:[u.jsx("div",{className:"font-bold text-neutral-900",children:Y.name}),u.jsxs("div",{className:"text-xs text-neutral-400",children:[Y.role?Y.role:"Learner","  Last seen: ",new Date(Y.lastLogin).toLocaleDateString()]})]})]}),u.jsx(cf,{size:20,className:"text-neutral-300 group-hover:text-neutral-900 transition-colors"})]},Y.id))}),u.jsxs("button",{onClick:()=>s(!0),className:"w-full p-5 bg-neutral-100 border border-dashed border-neutral-300 text-neutral-500 rounded-3xl font-bold flex items-center justify-center space-x-2 hover:bg-neutral-200 transition-all",children:[u.jsx(Xr,{size:20}),u.jsx("span",{children:"Add New User"})]})]})]})}),ZI=({onLogin:n})=>{const[e,s]=L.useState([]),[a,o]=L.useState(!1),[l,d]=L.useState(""),[p,m]=L.useState(""),[y,x]=L.useState(""),[v,S]=L.useState(""),[I,z]=L.useState("English"),[U,C]=L.useState("Adult"),[M,B]=L.useState("learner"),[F,H]=L.useState(!0),[q,Y]=L.useState(!0),A=[{id:"learner",role:"Vocab Learner",level:"Intermediate English",target:"Expand active vocabulary"},{id:"professional",role:"Working Professional",level:"Intermediate English",target:"Fluent business communication"},{id:"student",role:"Primary Student",level:"Beginner English",target:"Build school vocabulary"}];L.useEffect(()=>{T()},[]),L.useEffect(()=>{a&&R("learner")},[a]);const T=async()=>{H(!0);try{if(window.aistudio){const O=await window.aistudio.hasSelectedApiKey();Y(O)}const D=(await El()).filter(O=>!O.name.toLowerCase().includes("book"));s(D)}catch(D){console.error("Auth initialization error:",D)}finally{H(!1)}},E=async()=>{window.aistudio&&(await window.aistudio.openSelectKey(),Y(!0))},R=D=>{const O=A.find(ve=>ve.id===D);O&&(B(D),m(O.role),x(O.level),S(O.target),C(D==="student"?"Kid":"Adult"))},N=async D=>{if(D.preventDefault(),!l.trim())return;const O={id:"u-"+Date.now(),name:l.trim(),avatar:`https://api.dicebear.com/7.x/avataaars/svg?seed=${l}`,lastLogin:Date.now(),role:p.trim(),currentLevel:y.trim(),target:v.trim(),nativeLanguage:I,experience:0,level:1,peakLevel:1,adventure:{currentNodeIndex:0,energyShards:0,energy:5,keys:1,keyFragments:0,badges:[],unlockedChapterIds:_l.map(ve=>ve.id),completedSegmentIds:[],segmentStars:{}},lessonPreferences:{language:I,targetAudience:U,tone:U==="Kid"?"friendly_elementary":"professional_professor"}};await fr(O),n(O)};return u.jsx(KI,{users:e,isCreating:a,setIsCreating:o,loading:F,hasApiKey:q,newName:l,setNewName:d,newRole:p,setNewRole:m,newLevel:y,setNewLevel:x,newTarget:v,setNewTarget:S,newLanguage:I,setNewLanguage:z,newAudience:U,setNewAudience:C,selectedPersona:M,handleSelectKey:E,handlePersonaSelect:R,handleCreateProfile:N,onLogin:n})};var XI=RE();const zw=L.createContext(void 0),JI=({children:n})=>{const[e,s]=L.useState([]),a=L.useCallback(l=>{s(d=>d.filter(p=>p.id!==l))},[]),o=L.useCallback((l,d="info",p=3e3)=>{const m=Date.now().toString()+Math.random(),y={id:m,type:d,message:l};s(x=>[...x,y]),p>0&&setTimeout(()=>{a(m)},p)},[a]);return u.jsxs(zw.Provider,{value:{showToast:o},children:[n,XI.createPortal(u.jsx("div",{className:"fixed inset-0 z-[2147483647] pointer-events-none flex flex-col items-center pt-6",children:u.jsx("div",{className:"flex flex-col gap-2 w-full max-w-sm px-4",children:e.map(l=>u.jsxs("div",{className:`
                  pointer-events-auto flex items-center justify-between p-4 rounded-2xl shadow-xl border backdrop-blur-md animate-in slide-in-from-top-2 fade-in duration-300
                  ${l.type==="success"?"bg-neutral-900/90 text-white border-neutral-800":""}
                  ${l.type==="error"?"bg-red-500/90 text-white border-red-600":""}
                  ${l.type==="info"?"bg-white/90 text-neutral-900 border-neutral-200":""}
                `,children:[u.jsxs("div",{className:"flex items-center gap-3",children:[l.type==="success"&&u.jsx(wr,{size:20,className:"text-green-400"}),l.type==="error"&&u.jsx(Ra,{size:20,className:"text-white"}),l.type==="info"&&u.jsx(HE,{size:20,className:"text-blue-500"}),u.jsx("span",{className:"text-sm font-bold leading-tight",children:l.message})]}),u.jsx("button",{onClick:()=>a(l.id),className:"p-1 hover:opacity-70 transition-opacity ml-4",children:u.jsx(jn,{size:16})})]},l.id))})}),document.body)]})},kr=()=>{const n=L.useContext(zw);if(!n)throw new Error("useToast must be used within a ToastProvider");return n},z5={locked_chest:{name:"Locked Chest",icon:""},lucky_dice:{name:"Lucky Dice",icon:""},badge_of_courage:{name:"Badge of Courage",icon:""},badge_of_wisdom:{name:"Badge of Wisdom",icon:""},badge_of_strength:{name:"Badge of Strength",icon:""},badge_of_speed:{name:"Badge of Speed",icon:""},badge_of_endurance:{name:"Badge of Endurance",icon:""},badge_of_precision:{name:"Badge of Precision",icon:""},badge_of_focus:{name:"Badge of Focus",icon:""},badge_of_logic:{name:"Badge of Logic",icon:""},badge_of_creativity:{name:"Badge of Creativity",icon:""},badge_of_eloquence:{name:"Badge of Eloquence",icon:""},badge_of_resilience:{name:"Badge of Resilience",icon:""},badge_of_harmony:{name:"Badge of Harmony",icon:""},badge_of_vitality:{name:"Badge of Vitality",icon:""},badge_of_willpower:{name:"Badge of Willpower",icon:""},badge_of_serenity:{name:"Badge of Serenity",icon:""},badge_of_insight:{name:"Badge of Insight",icon:""},badge_of_mystery:{name:"Badge of Mystery",icon:""},badge_of_adventure:{name:"Badge of Adventure",icon:""},badge_of_fortune:{name:"Badge of Fortune",icon:""},badge_of_innovation:{name:"Badge of Innovation",icon:""}},xv=[{name:"Cyber Sentinel",image:"",hp:20,dialogueIntro:"Logic is absolute. Prove yours.",dialogueWin:"Error... System... Crash...",dialogueLose:"Your logic is flawed."},{name:"Inferno Dragon",image:"",hp:25,dialogueIntro:"I breathe fire. What do you breathe?",dialogueWin:"Your spirit burns brighter...",dialogueLose:"Burn to ash!"},{name:"Abyssal Kraken",image:"",hp:20,dialogueIntro:"The depths hold many secrets.",dialogueWin:"You have navigated the abyss.",dialogueLose:"Join the sunken ones."},{name:"Spectral Wraith",image:"",hp:15,dialogueIntro:"Can you touch what isn't there?",dialogueWin:"I fade into the light...",dialogueLose:"Your soul is mine."},{name:"Ancient Mummy",image:"",hp:20,dialogueIntro:"My curse is eternal.",dialogueWin:"Rest... finally...",dialogueLose:"Join my tomb."},{name:"Alien Warlord",image:"",hp:20,dialogueIntro:"Your language is primitive.",dialogueWin:"Acknowledged. You are superior.",dialogueLose:"Earth is ours."},{name:"Primal T-Rex",image:"",hp:25,dialogueIntro:"ROOOARRR! The earth shakes beneath me!",dialogueWin:"Extinction... comes for me...",dialogueLose:"You are merely prey."},{name:"Shadow Ninja",image:"",hp:18,dialogueIntro:"Silence is the loudest scream.",dialogueWin:"Honorable defeat...",dialogueLose:"Too slow."},{name:"Vampire Lord",image:"",hp:20,dialogueIntro:"The night is young.",dialogueWin:"The sun... it burns...",dialogueLose:"Delicious."},{name:"Oni Warlord",image:"",hp:22,dialogueIntro:"Face the demon within!",dialogueWin:"Your spirit is unbreakable.",dialogueLose:"Another soul for the mask."},{name:"Syntax Serpent",image:"",hp:20,dialogueIntro:"Untangle my sentences if you can.",dialogueWin:"Your logic is impeccable.",dialogueLose:"Your structure is flawed."},{name:"Dread Scorpion",image:"",hp:25,dialogueIntro:"One sting is all it takes.",dialogueWin:"My venom... ineffective?",dialogueLose:"Paralyzed by fear."}];function Wc(n){const e=[];let s=0;for(let a=0;a<n;a++){const o={id:a,type:"standard"};if((a+1)%10===0)o.type="boss",o.boss_details=xv[s%xv.length],s++;else{const l=Math.random();l<.1?o.type="treasure":l<.3&&(o.type="key_fragment")}e.push(o)}return e}Wc(100);const Cs={userId:"uid",word:"w",ipaUs:"i_us",ipaUk:"i_uk",pronSim:"ps",ipaMistakes:"im",meaningVi:"m",example:"ex",collocationsArray:"col",idiomsList:"idm",note:"nt",tags:"tg",groups:"gr",createdAt:"ca",updatedAt:"ua",wordFamily:"fam",prepositions:"prp",paraphrases:"prph",register:"reg",isIdiom:"is_id",isPhrasalVerb:"is_pv",isCollocation:"is_col",isStandardPhrase:"is_phr",isIrregular:"is_irr",isExampleLocked:"is_exl",isPassive:"is_pas",quality:"q",source:"s",nextReview:"nr",interval:"iv",easeFactor:"ef",consecutiveCorrect:"cc",lastReview:"lr",lastGrade:"lg",forgotCount:"fc",lastTestResults:"ltr",lastXpEarnedTime:"lxp",gameEligibility:"ge",masteryScore:"ms",complexity:"cx",topic:"tp",icon:"ic",words:"wds",color:"clr",titleColor:"tc",titleSize:"ts",d:"ds",text:"x",isIgnored:"g",prep:"p",usage:"u",tone:"t",context:"c",anchor:"anch",sentence:"sent",nouns:"ns",verbs:"v",adjs:"j",advs:"d",standard:"std",answers:"ans",speakers:"spks",sentences:"snts",speakerName:"sn",voiceName:"vn",accentCode:"ac",sex:"sx",title:"tl",content:"ct",sentenceScores:"ss"},Xg=Object.fromEntries(Object.entries(Cs).map(([n,e])=>[e,n])),$m={name:"n",avatar:"av",lastLogin:"ll",role:"r",currentLevel:"cl",target:"t",nativeLanguage:"nl",experience:"xp",level:"lv",peakLevel:"pl",adventure:"adv",adventureLastDailyStar:"alds",unlockedChapterIds:"uc",completedSegmentIds:"cs",segmentStars:"ss",badges:"b",keys:"k",keyFragments:"kf",currentNodeIndex:"cni",energy:"e",energyShards:"es",map:"m"},bv=Object.fromEntries(Object.entries($m).map(([n,e])=>[e,n])),Bw={COLLO_CONNECT:"cc",MEANING_MATCH:"mm",IPA_SORTER:"is",SENTENCE_SCRAMBLE:"ss",PREPOSITION_POWER:"pp",WORD_TRANSFORMER:"wt",IDIOM_CONNECT:"ic",PARAPHRASE_CONTEXT:"pc"},eN=Object.fromEntries(Object.entries(Bw).map(([n,e])=>[e,n])),Fw={SPELLING:"sp",IPA_QUIZ:"iq",PREPOSITION_QUIZ:"pq",WORD_FAMILY:"wf",MEANING_QUIZ:"mq",PARAPHRASE_QUIZ:"prq",SENTENCE_SCRAMBLE:"sc",HETERONYM_QUIZ:"hq",PRONUNCIATION:"p",COLLOCATION_QUIZ:"cq",IDIOM_QUIZ:"idq",PARAPHRASE_CONTEXT_QUIZ:"pcq",COLLOCATION_CONTEXT_QUIZ:"ccq",COLLOCATION_MULTICHOICE_QUIZ:"cmq",IDIOM_CONTEXT_QUIZ:"icq",WORD_FAMILY_NOUNS:"wf_n",WORD_FAMILY_VERBS:"wf_v",WORD_FAMILY_ADJS:"wf_j",WORD_FAMILY_ADVS:"wf_d"},tN=Object.fromEntries(Object.entries(Fw).map(([n,e])=>[e,n])),Hw={intensified:"int",softened:"sft",synonym:"syn",academic:"acd",casual:"cas",idiomatic:"idm"},nN=Object.fromEntries(Object.entries(Hw).map(([n,e])=>[e,n])),uf={user:!0,vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,mimic:!0,wordBook:!0,planning:!0};function Gw(n,e){return n&&(e==="paraphrases"?n.map(s=>{const a={[Cs.word]:s.word,[Cs.tone]:Hw[s.tone]||s.tone,[Cs.context]:s.context};return s.isIgnored===!0&&(a[Cs.isIgnored]=!0),a}):n.map(s=>{if(typeof s!="object"||s===null)return s;const a={};for(const o in s)if(Object.prototype.hasOwnProperty.call(s,o)){const l=s[o];if(l===!1)continue;a[Cs[o]||o]=l}return a}))}function sN(n){if(!n)return n;const e={},s=["nouns","verbs","adjs","advs"];for(const a of s)if(n[a]){const o=Cs[a]||a;e[o]=Gw(n[a],a)}return e}function Qr(n){const e={};for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s)||s==="tags"||s==="v2"||s==="v3"||s==="ipa"||s==="needsPronunciationFocus")continue;const a=n[s];if(a===!1)continue;const o=Cs[s]||s;if(["collocationsArray","idiomsList","prepositions","paraphrases","words","speakers","sentences","answers"].includes(s))e[o]=Gw(a,s);else if(s==="wordFamily")e[o]=sN(a);else if(s==="lastTestResults"&&a){const l={},d=new Set(["WORD_FAMILY","WORD_FAMILY_NOUNS","WORD_FAMILY_VERBS","WORD_FAMILY_ADJS","WORD_FAMILY_ADVS","wf","wf_n","wf_v","wf_j","wf_d"]);for(const p in a)if(Object.prototype.hasOwnProperty.call(a,p)){if(d.has(p))continue;const m=p.split(":");if(m[0]==="WORD_FAMILY"&&m.length===2)continue;const y=m[0],v=[Fw[y]||y,...m.slice(1)].join(":");l[v]=a[p]}e[o]=l}else s==="gameEligibility"&&Array.isArray(a)?e[o]=a.map(l=>Bw[l]||l):e[o]=a}return e}function qw(n){const e={};for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s))continue;const a=n[s],o=$m[s]||s;if(s==="adventure"&&a){const l={};for(const d in a){if(!Object.prototype.hasOwnProperty.call(a,d))continue;const p=$m[d]||d;l[p]=a[d]}e[o]=l}else e[o]=a}return e}function $w(n,e){return n&&(e==="paraphrases"?n.map(s=>{const a={word:s[Cs.word],tone:nN[s[Cs.tone]]||s[Cs.tone],context:s[Cs.context]};return s[Cs.isIgnored]!==void 0?a.isIgnored=s[Cs.isIgnored]:a.isIgnored=!1,a}):n.map(s=>{if(typeof s!="object"||s===null)return s;const a={};for(const o in s)if(Object.prototype.hasOwnProperty.call(s,o)){const l=Xg[o]||o;if(["nouns","verbs","adjs","advs"].includes(e)&&(l==="ipa"||l==="ipaUs"||l==="ipaUk"))continue;a[l]=s[o]}return a}))}function rN(n){const e={};for(const s in n){const a=Xg[s]||s;e[a]=$w(n[s],a)}return e}function dl(n){const e={};for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s))continue;const a=n[s],o=Xg[s]||s;if(!(o==="tags"||o==="v2"||o==="v3"||o==="needsPronunciationFocus")){if(s==="i"&&!e.ipaUs){e.ipaUs=a;continue}if(o==="ipa"){e.ipaUs||(e.ipaUs=a);continue}if(["collocationsArray","idiomsList","prepositions","paraphrases","words","speakers","sentences","answers"].includes(o))e[o]=$w(a,o);else if(o==="wordFamily"&&a)e[o]=rN(a);else if(o==="lastTestResults"&&a){const l={};for(const d in a)if(Object.prototype.hasOwnProperty.call(a,d)){const p=d.split(":"),m=p[0],x=[tN[m]||m,...p.slice(1)].join(":");l[x]=a[d]}e[o]=l}else o==="gameEligibility"&&Array.isArray(a)?e[o]=a.map(l=>eN[l]||l):e[o]=a}}return e}function aN(n){const e={};for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s))continue;const a=n[s],o=bv[s]||s;if(o==="adventure"&&a){const l={};for(const d in a){if(!Object.prototype.hasOwnProperty.call(a,d))continue;const p=bv[d]||d;l[p]=a[d]}e[o]=l}else e[o]=a}return e}function iN(n){if(!n)return n;const e={...n};if(e.ipa&&!e.ipaUs&&(e.ipaUs=e.ipa),delete e.v2,delete e.v3,delete e.tags,delete e.ipa,delete e.needsPronunciationFocus,e.isIdiom===void 0&&(e.isIdiom=!1),e.isPhrasalVerb===void 0&&(e.isPhrasalVerb=!1),e.isCollocation===void 0&&(e.isCollocation=!1),e.isStandardPhrase===void 0&&(e.isStandardPhrase=!1),e.isIrregular===void 0&&(e.isIrregular=!1),e.isPassive===void 0&&(e.isPassive=!1),e.wordFamily){const s=a=>Array.isArray(a)?a.map(o=>{const l={...o};return delete l.ipa,delete l.ipaUs,delete l.ipaUk,l}):a;e.wordFamily.nouns&&(e.wordFamily.nouns=s(e.wordFamily.nouns)),e.wordFamily.verbs&&(e.wordFamily.verbs=s(e.wordFamily.verbs)),e.wordFamily.adjs&&(e.wordFamily.adjs=s(e.wordFamily.adjs)),e.wordFamily.advs&&(e.wordFamily.advs=s(e.wordFamily.advs))}return e}const Yw=async(n,e,s=uf)=>new Promise(a=>{const o=s&&typeof s=="object"&&typeof s.vocabulary=="boolean"?s:uf,l=new FileReader;l.onload=async d=>{var p;try{const m=JSON.parse((p=d.target)==null?void 0:p.result),y=m.ca?new Date(m.ca).getTime():void 0,x=Array.isArray(m)?m:m.vocabulary||m.vocab||[];let S=x.length>0&&(x[0].uid||!x[0].userId)?x.map(dl):x;S=S.map(iN);const I=Array.isArray(m)?void 0:m.units||m.u,z=Array.isArray(m)?void 0:m.paraphraseLogs||m.pl,U=Array.isArray(m)?void 0:m.speakingTopics||m.st,C=Array.isArray(m)?void 0:m.speakingLogs||m.sl,M=Array.isArray(m)?void 0:m.writingTopics||m.wt,B=Array.isArray(m)?void 0:m.writingLogs||m.wl,F=Array.isArray(m)?void 0:m.irregularVerbs||m.iv,H=Array.isArray(m)?void 0:m.lessons,q=Array.isArray(m)?void 0:m.listeningItems,Y=Array.isArray(m)?void 0:m.nativeSpeakItems||m.nsi,A=Y?Y.map(dl):void 0,T=Array.isArray(m)?void 0:m.conversationItems||m.ci,E=T?T.map(dl):void 0,R=Array.isArray(m)?void 0:m.freeTalkItems||m.fti,N=R?R.map(dl):void 0,D=Array.isArray(m)?void 0:m.compositions,O=Array.isArray(m)?void 0:m.mimicQueue,ve=Array.isArray(m)?void 0:m.wordBooks||m.wb,ye=ve?ve.map(dl):void 0,G=Array.isArray(m)?void 0:m.readingShelves||m.rs,ae=Array.isArray(m)?void 0:m.readingBooks||m.rb,ne=Array.isArray(m)?void 0:m.planningGoals||m.pg,Q=Array.isArray(m)?void 0:m.user;let X;Q&&(X="n"in Q||"av"in Q?aN(Q):Q);const j=X?X.id:e,V=Array.isArray(m)?void 0:m.customAdventure||m.adv,$=Array.isArray(m)?void 0:m.settings||m.sys;if(!Array.isArray(S))throw new Error("Invalid JSON: 'vocabulary' array missing.");let Z=0,ee=0,pe=0;if(o.vocabulary){const ce=await jl(e),De=new Map(ce.map(Se=>[Se.word.toLowerCase().trim(),Se])),fe=[];for(const Se of S){if(!Se.word)continue;const Oe=De.get(Se.word.toLowerCase().trim());if(Oe)(Se.updatedAt||0)>(Oe.updatedAt||0)?(fe.push({...Oe,...Se,id:Oe.id,userId:j,updatedAt:Date.now()}),ee++):pe++;else{const me=Date.now();fe.push({...Se,id:Se.id||`w-${me}-${Math.random()}`,userId:j,createdAt:Se.createdAt||me,updatedAt:me}),Z++}}fe.length>0&&await Eo(fe)}o.reading&&(I&&await cw(I.map(ce=>({...ce,userId:j}))),ae&&await Dw(ae.map(ce=>({...ce,userId:j}))),G&&localStorage.setItem("reading_books_shelves",JSON.stringify(G))),(o.lesson||o.writing)&&z&&await uw(z.map(ce=>({...ce,userId:j}))),o.speaking&&(U&&await fw(U.map(ce=>({...ce,userId:j}))),C&&await dw(C.map(ce=>({...ce,userId:j}))),A&&await mw(A.map(ce=>({...ce,userId:j}))),E&&await xw(E.map(ce=>({...ce,userId:j}))),N&&await _w(N.map(ce=>({...ce,userId:j})))),o.writing&&(M&&await Tw(M.map(ce=>({...ce,userId:j}))),B&&await Ew(B.map(ce=>({...ce,userId:j}))),D&&await kw(D.map(ce=>({...ce,userId:j})))),o.lesson&&(F&&await Aw(F.map(ce=>({...ce,userId:j}))),H&&await Cw(H.map(ce=>({...ce,userId:j})))),o.listening&&q&&await Rw(q.map(ce=>({...ce,userId:j}))),o.mimic&&O&&localStorage.setItem("vocab_pro_mimic_practice_queue",JSON.stringify(O)),o.wordBook&&ye&&await Mw(ye.map(ce=>({...ce,userId:j}))),o.planning&&ne&&await Vw(ne.map(ce=>({...ce,userId:j})));let ie;if(o.user&&X){const ce={...X,id:j};await fr(ce),ie=ce}V&&o.user&&(V.ch&&localStorage.setItem("vocab_pro_adventure_chapters",JSON.stringify(V.ch)),V.b&&localStorage.setItem("vocab_pro_custom_badges",JSON.stringify(V.b))),o.user&&$&&(localStorage.setItem("vocab_pro_system_config",JSON.stringify($)),window.dispatchEvent(new Event("config-updated"))),a({type:"success",message:"Restore data successfully",detail:`Words: ${Z} new, ${ee} updated.`,updatedUser:ie,backupTimestamp:y})}catch(m){a({type:"error",message:"JSON Import Error",detail:m.message})}},l.readAsText(n)}),oN=async(n,e,s=uf)=>{const a=s&&typeof s=="object"&&typeof s.vocabulary=="boolean"?s:uf,[o,l,d,p,m,y,x,v,S,I,z,U,C,M,B,F,H]=await Promise.all([a.vocabulary?jl():[],a.reading?Rf():[],a.reading?Kg():[],a.lesson||a.writing?Vg():[],a.speaking?Bg():[],a.speaking?zg():[],a.speaking?Fg():[],a.speaking?Hg():[],a.speaking?Gg():[],a.writing?$g():[],a.writing?qg():[],a.writing?mu():[],a.lesson?Yg():[],a.lesson?Wg():[],a.listening?Qg():[],a.wordBook?gu():[],a.planning?Zg():[]]),q=localStorage.getItem("vocab_pro_mimic_practice_queue"),Y=localStorage.getItem("vocab_pro_adventure_chapters"),A=localStorage.getItem("vocab_pro_custom_badges"),T=localStorage.getItem("reading_books_shelves"),E=localStorage.getItem("vocab_pro_system_config");return{v:8,ca:new Date().toISOString(),user:qw(e),vocab:o.map(R=>Qr(R)),u:l,pl:p,st:m,sl:y,wt:I,wl:z,iv:C,lessons:M,listeningItems:B,nativeSpeakItems:x.map(R=>Qr(R)),conversationItems:v.map(R=>Qr(R)),freeTalkItems:S.map(R=>Qr(R)),compositions:U,mimicQueue:q?JSON.parse(q):[],wordBooks:F.map(R=>Qr(R)),readingBooks:d,pg:H,adv:{ch:Y?JSON.parse(Y):null,b:A?JSON.parse(A):null},readingShelves:T?JSON.parse(T):null,settings:E?JSON.parse(E):null}},B5=async(n,e)=>{const s={v:8,ca:new Date().toISOString(),u:n,user:{id:e}},a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),o=URL.createObjectURL(a),l=document.createElement("a");l.href=o,l.download=`vocab-pro-units-${new Date().toISOString().split("T")[0]}.json`,l.click(),URL.revokeObjectURL(o)},lN={initialEasy:4,initialHard:1,easyEasy:2.5,hardEasy:2,hardHard:1.3,easyHardPenalty:.5,forgotInterval:1},cN={host:"localhost",port:3e3,useCustomUrl:!1,customUrl:"",backupPath:"backups"},uN={mode:"system",preferredSystemVoice:"",appliedAccent:"US"},dN={max_learn_per_day:10,max_review_per_day:10},fN={preferredTypes:[]},hN={topic1Options:["Grammar","Vocabulary","Pronunciation"],topic2Options:{Grammar:["Tenses","Conditionals","Passive Voice","Reported Speech"],Vocabulary:["Topic: Work","Topic: Environment","Collocations","Idioms"],Pronunciation:["Vowel Sounds","Consonant Sounds","Intonation"]}},pN={autoBackupEnabled:!1,autoBackupInterval:60,lastSyncTime:null},vv={server:cN,ai:{enableGeminiApi:!0,modelForComplexTasks:"gemini-3-pro-preview",modelForBasicTasks:"gemini-3-flash-preview",modelForTts:"gemini-2.5-flash-preview-tts"},srs:lN,audio:uN,audioCoach:{activeCoach:"female",coaches:{male:{name:"Victor",avatar:"man_teacher",persona:"professional_professor",enVoice:"",enAccent:"en_US",viVoice:"",viAccent:"vi_VN"},female:{name:"Sofia",avatar:"woman_teacher",persona:"friendly_elementary",enVoice:"",enAccent:"en_US",viVoice:"",viAccent:"vi_VN"}}},dailyGoals:dN,interface:{studyBuddyLanguage:"vi",buddyVoiceEnabled:!1,studyBuddyAvatar:"woman_teacher",junkTags:["ielts","general","common"],rightClickCommandEnabled:!0},test:fN,lesson:hN,sync:pN},Ww="vocab_pro_system_config";function Xp(n){return n&&typeof n=="object"&&!Array.isArray(n)}function Qw(n,e){const s={...n};if(Xp(n)&&Xp(e))for(const a of Object.keys(e))Xp(e[a])?a in n?s[a]=Qw(n[a],e[a]):Object.assign(s,{[a]:e[a]}):Object.assign(s,{[a]:e[a]});return s}const Vn=n=>n.server.useCustomUrl&&n.server.customUrl?n.server.customUrl.replace(/\/$/,""):`https://${n.server.host}:${n.server.port}`;function Tt(){const n=localStorage.getItem(Ww),e=n?JSON.parse(n):null;if(!e)return vv;const s=Qw(vv,e);return e.audio&&e.audio.serverPort&&e.audio.serverUrl,s}function Yr(n,e=!1){try{localStorage.setItem(Ww,JSON.stringify(n)),window.dispatchEvent(new Event("config-updated")),e||window.dispatchEvent(new Event("vocab-pro-trigger-backup"))}catch(s){console.error("Failed to save system config.",s)}}const mN=["i:","","u:","","","e","",":","",":","e","","s","","t","d","","","t","d","n","l","","v","w"],gN=n=>!n||n.length<2?!1:mN.some(e=>{if(e==="t"||e==="d")return n.includes(e);const s=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");let a;return e==="d"?a=new RegExp(`${s}(?!)`):e==="t"?a=new RegExp(`${s}(?!)`):e===""?a=new RegExp(`(?<!t)${s}`):e===""?a=new RegExp(`(?<!d)${s}`):e===""?a=new RegExp(`(?<![ae])${s}`):e===""?a=new RegExp(`(?<![a])${s}`):e==="e"?a=new RegExp(`${s}(?!)`):a=new RegExp(s),a.test(n)}),Lr=n=>{if(n.quality!==Yt.VERIFIED||!n.lastReview)return[];const e=[];return n.collocationsArray&&n.collocationsArray.some(s=>!s.isIgnored)&&e.push("COLLO_CONNECT"),n.word&&n.meaningVi&&n.meaningVi.trim().length>0&&e.push("MEANING_MATCH"),n.ipaUs&&gN(n.ipaUs)&&e.push("IPA_SORTER"),n.example&&n.example.trim().split(/\s+/).filter(Boolean).length>=5&&e.push("SENTENCE_SCRAMBLE"),n.example&&n.example.trim().split(/\s+/).filter(Boolean).length>=4&&e.push("DICTATION"),n.example&&n.prepositions&&n.prepositions.some(s=>!s.isIgnored)&&e.push("PREPOSITION_POWER"),n.paraphrases&&n.paraphrases.filter(s=>!s.isIgnored&&s.context&&s.context.trim()).length>=2&&e.push("PARAPHRASE_CONTEXT"),e};function _v(n,e){const s=.95+Math.random()*.1,a=Math.max(1,e*s),o=new Date(n);return o.setHours(0,0,0,0),o.setDate(o.getDate()+Math.round(a)),o.getTime()}function Kw(n,e){const s=Tt().srs,a={...n},o=Date.now();if(e===Ut.LEARNED)a.consecutiveCorrect=1,a.interval=s.initialHard,a.nextReview=_v(o,s.initialHard);else{let l=n.interval||0,d=1;const p=1440*60*1e3,m=n.lastReview||o,y=Math.max(0,(o-m)/p),x=y>l;if(e===Ut.FORGOT)d=s.forgotInterval,a.consecutiveCorrect=0,a.forgotCount+=1;else if(e===Ut.HARD)n.lastGrade===Ut.EASY?d=Math.max(1,Math.floor(l*s.easyHardPenalty)):d=l===0?s.initialHard:Math.max(1,Math.floor(l*s.hardHard)),a.consecutiveCorrect+=1;else if(e===Ut.EASY){let v=l;x&&(v=Math.max(l,y)),n.lastGrade===Ut.HARD?d=l===0?s.initialEasy:Math.max(s.initialEasy,Math.floor(v*s.hardEasy)):d=l===0?s.initialEasy:Math.max(s.initialEasy,Math.floor(v*s.easyEasy)),a.consecutiveCorrect+=1}a.interval=Math.round(d),a.nextReview=_v(o,a.interval)}return a.lastGrade=e,a.lastReview=o,a.updatedAt=o,a.complexity=Mr(a),a.masteryScore=Rs(a),a.gameEligibility=Lr(a),a}function Zw(n){const e=Date.now(),s={...n,nextReview:e,interval:0,easeFactor:2.5,consecutiveCorrect:0,forgotCount:0,lastGrade:void 0,lastReview:void 0,updatedAt:e,lastXpEarnedTime:void 0,lastTestResults:n.lastTestResults??{},masteryScore:n.masteryScore};return s.complexity=Mr(s),s.gameEligibility=Lr(s),s}function yN(n){const e=Date.now(),s=n-e,a=1440*60*1e3;if(s<=0)return{label:"DUE",urgency:"due"};const o=Math.ceil(s/a);return{label:`${o}d`,urgency:o<=1?"soon":"later"}}async function Jg(n,e,s,a,o,l,d=!1,p=!1,m=!1,y=!1,x=!1,v="manual"){var C;let S=e.trim(),I=s.trim();if(!I)try{const M=n.trim(),B=await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(M)}&langpair=en|vi`);if(B.ok){const F=await B.json();(C=F==null?void 0:F.responseData)!=null&&C.translatedText&&(I=F.responseData.translatedText,console.log("[createNewWord] Auto meaning from MyMemory:",I))}}catch(M){console.error("[createNewWord] Meaning auto-translate failed:",M)}if(!S)try{const M=n.trim().toLowerCase(),B=Tt(),F=Vn(B),H=await fetch(`${F}/api/lookup/cambridge/simple?word=${encodeURIComponent(M)}`,{cache:"no-store"});if(H.ok){const q=await H.json();if(q!=null&&q.exists&&Array.isArray(q==null?void 0:q.pronunciations)){const Y=q.pronunciations.find(A=>A==null?void 0:A.ipaUs);Y!=null&&Y.ipaUs&&(S=Y.ipaUs,console.log("[createNewWord] IPA from Cambridge:",S))}}if(!S){const q=await fetch(`${F}/api/convert/ipa?text=${encodeURIComponent(M)}&mode=2`);if(q.ok){const Y=await q.json();Y!=null&&Y.ipa&&(S=Y.ipa,console.log("[createNewWord] IPA from fallback convert:",S))}}console.log("[createNewWord] Final auto IPA result:",S),S&&!S.startsWith("/")&&(S=`/${S.replace(/^\/+|\/+$/g,"")}/`)}catch(M){console.error("[createNewWord] IPA fetch failed:",M)}const z=Date.now(),U={id:crypto.randomUUID?crypto.randomUUID():"id-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),userId:"",word:n.trim(),ipaUs:S,meaningVi:I,example:a.trim(),note:o,groups:l,isIdiom:d,isPhrasalVerb:p,isCollocation:m,isStandardPhrase:y,isPassive:x,register:"raw",quality:Yt.RAW,source:v,isExampleLocked:!1,createdAt:z,updatedAt:z,nextReview:z,interval:0,easeFactor:2.5,consecutiveCorrect:0,forgotCount:0,lastTestResults:{}};return U.complexity=Mr(U),U.masteryScore=Rs(U),U.gameEligibility=Lr(U),U}function Of(n){const e=[];if(e.push({key:"spelling",testKeys:["SPELLING"]}),n.ipaUs&&e.push({key:"pronunciation",testKeys:["PRONUNCIATION"]}),n.ipaUs&&n.ipaUs.trim()&&n.ipaMistakes&&n.ipaMistakes.length>0&&e.push({key:"ipa_recognition",testKeys:["IPA_QUIZ"]}),n.meaningVi&&n.meaningVi.trim()&&e.push({key:"meaning",testKeys:["MEANING_QUIZ"]}),n.example&&n.example.trim()&&e.push({key:"context",testKeys:["SENTENCE_SCRAMBLE"]}),n.collocationsArray&&n.collocationsArray.filter(s=>!s.isIgnored&&s.d&&s.d.trim()).forEach(s=>{const a=s.text;e.push({key:`colloc:${a}`,testKeys:[`COLLOCATION_QUIZ:${a}`,`COLLOCATION_MULTICHOICE_QUIZ:${a}`,`COLLOCATION_CONTEXT_QUIZ:${a}`]})}),n.idiomsList&&n.idiomsList.filter(s=>!s.isIgnored&&s.d&&s.d.trim()).forEach(s=>{const a=s.text;e.push({key:`idiom:${a}`,testKeys:[`IDIOM_QUIZ:${a}`,`IDIOM_CONTEXT_QUIZ:${a}`]})}),n.prepositions&&n.prepositions.filter(s=>!s.isIgnored).forEach(s=>{const a=s.prep;e.push({key:`prep:${a}`,testKeys:[`PREPOSITION_QUIZ:${a}`]})}),n.paraphrases&&n.paraphrases.filter(s=>!s.isIgnored&&s.context&&s.context.trim()).forEach(s=>{const a=s.word;e.push({key:`para:${a}`,testKeys:[`PARAPHRASE_QUIZ:${a}`,`PARAPHRASE_CONTEXT_QUIZ:${a}`]})}),n.wordFamily){const s=["nouns","verbs","adjs","advs"],a={nouns:"n",verbs:"v",adjs:"j",advs:"d"},o=n.word.toLowerCase(),l=s.flatMap(d=>{const p=n.wordFamily[d];return Array.isArray(p)?p.filter(m=>!m.isIgnored&&m.word):[]});l.length===1&&l[0].word.toLowerCase()===o||s.forEach(d=>{const p=n.wordFamily[d];Array.isArray(p)&&p.filter(m=>!m.isIgnored&&m.word).forEach(m=>{const y=m.word,x=a[d];e.push({key:`fam:${x}:${y}`,testKeys:[`WORD_FAMILY:${x}:${y}`]})})})}return e}function F5(n){const e=Of(n),s=new Set;return e.forEach(a=>{a.testKeys.forEach(o=>s.add(o))}),s}function Mr(n){return Of(n).length}function Rs(n){const e=Of(n);if(e.length===0)return 0;const s=n.lastTestResults||{};let a=0;const o=[],l=[];e.forEach(p=>{p.testKeys.length>0&&p.testKeys.some(y=>s[y]===!0)?(a++,o.push(p.key)):l.push({key:p.key,reason:`None of [${p.testKeys.join(", ")}] passed.`})});const d=Math.round(a/e.length*100);return Math.max(0,Math.min(100,d))}let wl=!1,Jd=!1,ls=new Map;const ka=new Set,bi=new Set,wo=new Map;let Qc=null,Xw={reviewCounts:{total:0,due:0,new:0,learned:0,mastered:0,statusForgot:0,statusHard:0,statusEasy:0,statusLearned:0},dashboardStats:{categories:{vocab:{total:0,learned:0},idiom:{total:0,learned:0},phrasal:{total:0,learned:0},colloc:{total:0,learned:0},phrase:{total:0,learned:0},preposition:{total:0,learned:0}},refinedCount:0,rawCount:0},dayProgress:{learned:0,reviewed:0,learnedWords:[],reviewedWords:[]}};function gn(){localStorage.setItem("vocab_pro_local_last_modified",String(Date.now()))}let Oa=null,di=null;async function Ev(){Oa&&(clearTimeout(Oa),Oa=null),di&&(clearTimeout(di),di=null);try{const n=Array.from(ls.values()),e=JSON.stringify(n);if(localStorage.setItem("vocab_pro_emergency_backup",e),Qc){const s=(await El()).find(a=>a.id===Qc);s&&await ef(Qc,s)}}catch(n){console.warn("[DataStore] Backup failed:",n)}}function Ym(){Oa&&(clearTimeout(Oa),Oa=null),di&&(clearTimeout(di),di=null),co&&(clearTimeout(co),co=null)}function an(){if(window.isRestoring)return;const e=(Tt().sync.autoBackupInterval||60)*1e3,s=Math.max(e*3,3e5);Oa&&clearTimeout(Oa);const a=Date.now()+e;window.dispatchEvent(new CustomEvent("backup-scheduled",{detail:{targetTime:a}})),Oa=window.setTimeout(Ev,e),di||(di=window.setTimeout(()=>{Ev()},s))}function Io(n){const e=Date.now(),a=Array.from(ls.values()).filter(q=>!q.isPassive&&q.userId===n),o=a.length,l=a.filter(q=>q.lastReview&&q.nextReview<=e&&q.quality!==Yt.FAILED).length,d=a.filter(q=>!q.lastReview&&q.quality===Yt.VERIFIED).length,p=a.filter(q=>q.interval>21).length,m=a.filter(q=>!!q.lastReview&&q.interval<=21),y=m.length,x=m.filter(q=>q.lastGrade===Ut.FORGOT).length,v=m.filter(q=>q.lastGrade===Ut.HARD).length,S=m.filter(q=>q.lastGrade===Ut.EASY).length,I=m.filter(q=>q.lastGrade===Ut.LEARNED).length,z=a.filter(q=>q.quality===Yt.REFINED).length,U=a.filter(q=>q.quality===Yt.RAW).length,C={vocab:{total:0,learned:0},idiom:{total:0,learned:0},phrasal:{total:0,learned:0},colloc:{total:0,learned:0},phrase:{total:0,learned:0},preposition:{total:0,learned:0}};a.forEach(q=>{const Y=!!q.lastReview,A=T=>{C[T].total++,Y&&C[T].learned++};q.isIdiom&&A("idiom"),q.isPhrasalVerb&&A("phrasal"),q.isCollocation&&A("colloc"),q.isStandardPhrase&&A("phrase"),q.prepositions&&q.prepositions.length>0&&!q.isPhrasalVerb&&A("preposition"),!q.isIdiom&&!q.isPhrasalVerb&&!q.isCollocation&&!q.isStandardPhrase&&A("vocab")});const M=new Date;M.setHours(0,0,0,0);const B=M.getTime(),F=[],H=[];a.forEach(q=>{q.lastReview&&q.lastReview>=B&&q.lastReviewSessionType!=="boss_battle"&&(q.lastGrade===Ut.LEARNED?F.push(q):H.push(q))}),Xw={reviewCounts:{total:o,due:l,new:d,learned:y,mastered:p,statusForgot:x,statusHard:v,statusEasy:S,statusLearned:I},dashboardStats:{categories:C,refinedCount:z,rawCount:U},dayProgress:{learned:F.length,reviewed:H.length,learnedWords:F,reviewedWords:H}}}let co=null;function on(){co&&clearTimeout(co),co=window.setTimeout(()=>{window.dispatchEvent(new CustomEvent("datastore-updated")),co=null},100)}let wv=0;const Bn=()=>{const n=Date.now();return n-wv<1e3?(window.dispatchEvent(new CustomEvent("datastore-cooldown")),!1):(wv=n,!0)};typeof window<"u"&&window.addEventListener("vocab-pro-trigger-backup",()=>{wl&&(on(),an())});async function Jw(n){if(!(wl||Jd)){Jd=!0,Qc=n;try{let e=await jl(n);if(e.length===0){const l=localStorage.getItem("vocab_pro_emergency_backup");if(l)try{const d=JSON.parse(l);Array.isArray(d)&&d.length>0&&(await Eo(d),e=await jl(n))}catch(d){console.error("[DataStore] Failed to restore from emergency backup:",d)}}const[s,a]=await Promise.all([mu(n),gu(n)]);ka.clear(),s.forEach(l=>{(l.linkedWordIds||[]).forEach(d=>ka.add(d))}),bi.clear(),wo.clear(),a.forEach(l=>{const d=new Set;(l.words||[]).forEach(p=>{const m=p.word.toLowerCase();bi.add(m),d.add(m)}),wo.set(l.id,d)});const o=[];for(const l of e){let d=!1;const p=l.ipa;p&&!l.ipaUs&&(l.ipaUs=p,delete l.ipa,d=!0),p&&l.ipaUs&&(delete l.ipa,d=!0),l.needsPronunciationFocus!==void 0&&(delete l.needsPronunciationFocus,d=!0);const m=Mr(l),y=Rs(l),x=Lr(l);l.complexity!==m&&(l.complexity=m,d=!0),l.masteryScore!==y&&(l.masteryScore=y,d=!0),JSON.stringify(l.gameEligibility)!==JSON.stringify(x)&&(l.gameEligibility=x,d=!0),typeof l.register>"u"&&(l.register="raw",d=!0),d&&o.push(l)}o.length>0&&await Eo(o),ls=new Map(e.map(l=>[l.id,l])),Io(n),wl=!0}catch(e){console.error("DataStore initialization failed:",e),wl=!1}finally{Jd=!1}}}async function Wm(n){wl=!1,Jd=!1,ls.clear(),ka.clear(),bi.clear(),wo.clear(),await Jw(n),on()}async function eS(){ls.clear(),ka.clear(),bi.clear(),wo.clear(),wl=!1,Qc=null,await JE();const n=["vocab_pro_system_config","gemini_api_keys"],e=[];for(let s=0;s<localStorage.length;s++){const a=localStorage.key(s);a&&!n.includes(a)&&e.push(a)}e.forEach(s=>localStorage.removeItem(s)),sessionStorage.clear()}async function tS(n){try{const e=await mu(n);ka.clear(),e.forEach(s=>{(s.linkedWordIds||[]).forEach(a=>ka.add(a))}),on()}catch(e){console.error("Failed to refresh composition index",e)}}async function xN(n){try{const e=await gu(n);bi.clear(),wo.clear(),e.forEach(s=>{const a=new Set;(s.words||[]).forEach(o=>{const l=o.word.toLowerCase();bi.add(l),a.add(l)}),wo.set(s.id,a)}),on()}catch(e){console.error("Failed to refresh word book index",e)}}function bN(n){return ka.has(n)}function H5(){return ka}function G5(){return bi}function nS(){return Xw}function fi(){return Array.from(ls.values())}function Sv(n){return ls.get(n)}function q5(n,e,s,a="",o=["all"],l="all",d="all",p="all",m="all",y=null,x="all",v="all",S=""){const I=Array.from(ls.values()).filter(F=>F.userId===n);let z=I;if(o.includes("duplicate")){const F=new Map;I.forEach(q=>{const Y=q.word.toLowerCase().trim();F.set(Y,(F.get(Y)||0)+1)});const H=new Set;for(const[q,Y]of F.entries())Y>1&&H.add(q);z=z.filter(q=>H.has(q.word.toLowerCase().trim()))}const U=o.filter(F=>F!=="duplicate");let C=null;v==="specific"&&S&&(C=wo.get(S)||null);const M=z.filter(F=>nw(F,a,U,l,d,p,m,y,x,ka,v==="specific"?"all":v,bi)?v==="specific"&&C?C.has(F.word.toLowerCase()):!0:!1);o.includes("duplicate")?M.sort((F,H)=>F.word.localeCompare(H.word)||F.createdAt-H.createdAt):M.sort((F,H)=>H.createdAt-F.createdAt);const B=e*s;return{words:M.slice(B,B+s),totalCount:M.length}}async function au(n,e){return ew(n,e)}async function vN(n,e){Bn()&&(gn(),n.complexity=Mr(n),n.masteryScore=Rs(n),n.gameEligibility=Lr(n),await sw(n,e),ls.set(n.id,n),Io(n.userId),an(),on())}async function $5(n,e){Bn()&&(gn(),n&&(n.complexity=Mr(n),n.masteryScore=Rs(n),n.gameEligibility=Lr(n)),await rw(n,e),n&&ls.set(n.id,n),an(),Io(e.userId),on())}async function jf(n){Bn()&&(gn(),n.complexity=Mr(n),n.masteryScore=Rs(n),n.gameEligibility=Lr(n),await aw(n),ls.set(n.id,n),Io(n.userId),an(),on())}async function sS(n){n.length!==0&&(gn(),n.forEach(e=>{e.complexity=Mr(e),e.masteryScore=Rs(e),e.gameEligibility=Lr(e)}),await Eo(n),n.forEach(e=>ls.set(e.id,e)),n[0]&&Io(n[0].userId),an(),on())}async function _N(n){const e=ls.get(n);!e||!Bn()||(gn(),await iw(n),ls.delete(n),Io(e.userId),an(),on())}async function EN(n){if(n.length===0)return;const e=ls.get(n[0]);e&&(gn(),await ow(n),n.forEach(s=>ls.delete(s)),Io(e.userId),an(),on())}async function Y5(n){Bn()&&(gn(),await lw(n),an(),on())}async function W5(n){Bn()&&(gn(),await Ow(n),await tS(n.userId),an())}async function Q5(n,e){gn(),await jw(n),await tS(e),an()}async function K5(n){Bn()&&(gn(),await Lw(n),await xN(n.userId),an())}async function Z5(n){Bn()&&(gn(),await hw(n),an(),on())}async function X5(n){Bn()&&(gn(),await pw(n),an(),on())}async function J5(n){Bn()&&(gn(),await gw(n),an(),on())}async function eM(n){Bn()&&(gn(),await yw(n),an(),on())}async function tM(n){Bn()&&(gn(),await bw(n),an(),on())}async function nM(n){Bn()&&(gn(),await vw(n),an(),on())}async function sM(n){Bn()&&(gn(),await Iw(n),an(),on())}async function rM(n){Bn()&&(gn(),await Nw(n),an(),on())}async function aM(n){Bn()&&(gn(),await ww(n),an(),on())}async function iM(n){Bn()&&(gn(),await Sw(n),an(),on())}async function oM(n){Bn()&&(gn(),await Uw(n),an(),on())}async function lM(n){Bn()&&(gn(),await Pw(n),an(),on())}const{getUnitsContainingWord:wN,seedDatabaseIfEmpty:SN,clearVocabularyOnly:rS,bulkSavePlanningGoals:cM}=YI,TN={user:!0,vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,mimic:!0,wordBook:!0,planning:!0};let Jp=!1;const ef=async(n,e,s=!1)=>{if(window.isRestoring||Jp)return;const a=Tt();if(!a.sync.autoBackupEnabled&&!s)return;Jp=!0;const o=Vn(a);try{const l=await IN(n,e),d=JSON.stringify(l),p=(new Blob([d]).size/(1024*1024)).toFixed(2),m=e.name?`&username=${encodeURIComponent(e.name)}`:"",y=await fetch(`${o}/api/backup?userId=${encodeURIComponent(n)}${m}&app=vocab`,{method:"POST",headers:{"Content-Type":"application/json"},body:d});if(!y.ok)throw new Error(`Server error: ${y.statusText}`);const x=Date.now(),v={...a};v.sync.lastSyncTime=x,Yr(v,!0),localStorage.setItem("vocab_pro_local_last_modified",String(x)),window.dispatchEvent(new CustomEvent("backup-complete",{detail:{success:!0,size:p}}))}catch(l){console.warn("[Backup] Upload failed:",l),window.dispatchEvent(new CustomEvent("backup-complete",{detail:{success:!1}}))}finally{Jp=!1}},Vd=async()=>{try{const n=Tt(),e=Vn(n),s=await fetch(`${e}/api/backups?app=vocab`);return s.ok?(await s.json()).backups||[]:[]}catch(n){return console.warn("[Backup] Failed to fetch list:",n),[]}},aS=async n=>{try{const e=Tt(),a=`${Vn(e)}/api/backup/${encodeURIComponent(n)}?t=${Date.now()}&app=vocab`,o=await fetch(a,{method:"GET",headers:{"Cache-Control":"no-cache"},mode:"cors"});if(!o.ok)return null;const l=await o.blob(),d=new File([l],"restore.json",{type:"application/json"}),p=await Yw(d,n,TN);return p.type==="success"&&p.updatedUser?(await Wm(p.updatedUser.id),p):null}catch(e){return console.error("[Backup] Restore exception:",e),null}},AN=async n=>{try{const e=Tt(),s=Vn(e),a=await fetch(`${s}/api/library/lookup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({words:n})});if(a.ok){const o=await a.json();if(Array.isArray(o.found))return o.found.map(l=>dl(l))}return[]}catch(e){return console.warn("[Backup] Library lookup failed:",e),[]}};async function IN(n,e){const[s,a,o,l,d,p,m,y,x,v,S,I,z,U,C,M,B]=await Promise.all([jl(),Rf(),Kg(),Vg(),Bg(),zg(),Fg(),Hg(),Gg(),$g(),qg(),mu(),Yg(),Wg(),Qg(),gu(),Zg()]),F=localStorage.getItem("vocab_pro_mimic_practice_queue"),H=localStorage.getItem("vocab_pro_adventure_chapters"),q=localStorage.getItem("vocab_pro_custom_badges"),Y=localStorage.getItem("reading_books_shelves"),A=localStorage.getItem("vocab_pro_system_config");return{v:8,ca:new Date().toISOString(),user:qw(e),vocab:s.map(T=>Qr(T)),u:a,pl:l,st:d,sl:p,wt:v,wl:S,iv:z,lessons:U,listeningItems:C,nativeSpeakItems:m.map(T=>Qr(T)),conversationItems:y.map(T=>Qr(T)),freeTalkItems:x.map(T=>Qr(T)),compositions:I,mimicQueue:F?JSON.parse(F):[],wordBooks:M.map(T=>Qr(T)),readingBooks:o,pg:B,adv:{ch:H?JSON.parse(H):null,b:q?JSON.parse(q):null},readingShelves:Y?JSON.parse(Y):null,settings:A?JSON.parse(A):null}}const NN=()=>{const[n,e]=L.useState(null),[s,a]=L.useState(!1),[o,l]=L.useState(!1),d=L.useCallback(async()=>{a(!1),l(!1);const x=localStorage.getItem("vocab_pro_current_user_id"),v=localStorage.getItem("vocab_pro_current_user_name"),S=localStorage.getItem("vocab_pro_auto_restore");let I=(await El()).filter(H=>!H.name.toLowerCase().includes("book"));const z=I.length===0,U=S==="true"||z,C=v||x||"Vocab Master";if(U){window.isRestoring=!0;try{const H=await aS(C);H&&H.type==="success"&&(H.backupTimestamp&&localStorage.setItem("vocab_pro_last_backup_timestamp",String(H.backupTimestamp)),I=(await El()).filter(q=>!q.name.toLowerCase().includes("book")),H.updatedUser&&(localStorage.setItem("vocab_pro_current_user_id",H.updatedUser.id),localStorage.setItem("vocab_pro_current_user_name",H.updatedUser.name)))}catch{}finally{setTimeout(()=>{window.isRestoring=!1},2e3)}S&&localStorage.removeItem("vocab_pro_auto_restore")}await Pg();const M=(await El()).filter(H=>!H.name.toLowerCase().includes("book"));let B=null;const F=localStorage.getItem("vocab_pro_current_user_id");if(M.length===1?(B=M[0],l(!0)):F&&M.length>1&&(B=M.find(H=>H.id===F)||null,B&&l(!0)),B){let H=!1;B.adventure?(B.adventure.completedSegmentIds.length===0&&(B.adventure.keys===0||B.adventure.keys===void 0)&&(B.adventure.keys=1,H=!0),B.adventure.map||(B.adventure.map=Wc(100),H=!0)):(B.adventure={currentNodeIndex:0,energy:5,energyShards:0,unlockedChapterIds:_l.map(q=>q.id),completedSegmentIds:[],segmentStars:{},badges:[],keys:1,keyFragments:0,map:Wc(100)},H=!0),H&&await fr(B),e(B),localStorage.setItem("vocab_pro_current_user_id",B.id),localStorage.setItem("vocab_pro_current_user_name",B.name)}a(!0)},[]);return L.useEffect(()=>{d()},[d]),{currentUser:n,isLoaded:s,handleLogin:async x=>{x.adventure.map||(x.adventure.map=Wc(100),await fr(x)),e(x),localStorage.setItem("vocab_pro_current_user_id",x.id),localStorage.setItem("vocab_pro_current_user_name",x.name);const v={...x,lastLogin:Date.now()};fr(v)},handleLogout:()=>{e(null),localStorage.removeItem("vocab_pro_current_user_id")},handleUpdateUser:async x=>{await fr(x),e(x),x.id===localStorage.getItem("vocab_pro_current_user_id")&&localStorage.setItem("vocab_pro_current_user_name",x.name)},setCurrentUser:e,shouldSkipAuth:o}},CN=({setView:n,setIsSidebarOpen:e})=>{const[s,a]=L.useState(null),[o,l]=L.useState(null),[d,p]=L.useState(null);L.useEffect(()=>{try{const x=sessionStorage.getItem("vocab_pro_active_session");if(x){const{words:v,type:S}=JSON.parse(x);Array.isArray(v)&&v.length>0&&(a(v),p(S))}}catch(x){console.error("Failed to restore session",x),sessionStorage.removeItem("vocab_pro_active_session")}},[]);const m=L.useCallback((x,v,S=null)=>{if(x.length>0){const z=[...Array.from(new Map(x.map(U=>[U.id,U])).values())].sort(()=>Math.random()-.5);a(z),p(v),l(S),sessionStorage.setItem("vocab_pro_active_session",JSON.stringify({words:z,type:v})),sessionStorage.removeItem("vocab_pro_session_progress"),sessionStorage.removeItem("vocab_pro_session_outcomes"),n("REVIEW"),e(!1)}},[n,e]),y=L.useCallback(()=>{sessionStorage.removeItem("vocab_pro_active_session"),sessionStorage.removeItem("vocab_pro_session_progress"),sessionStorage.removeItem("vocab_pro_session_outcomes"),a(null),p(null),l(null)},[]);return{sessionWords:s,setSessionWords:a,sessionType:d,sessionFocus:o,startSession:m,clearSessionState:y}},fl=n=>n<1?0:n<=5?100+n*50:n<=10?350+(n-5)*100:850+(n-10)*200,RN=[{level:1,title:"Vocab Novice"},{level:5,title:"Word Apprentice"},{level:10,title:"Lexical Explorer"},{level:20,title:"Master Grammarian"},{level:30,title:"IELTS Wordsmith"},{level:50,title:"IELTS Luminary"}],em=n=>{let e="Vocab Novice";for(const s of RN)if(n>=s.level)e=s.title;else break;return e},Tv=(n,e)=>{let s=0;for(let a=1;a<n;a++)s+=fl(a);return s+=e,s},ON=({currentUser:n,onUpdateUser:e,onSaveWordAndUser:s})=>{const[a,o]=L.useState(null),{showToast:l}=kr(),d=L.useRef(n);L.useEffect(()=>{d.current=n},[n]);const p=L.useCallback(async(x,v,S,I)=>{const z=d.current;if(!z)return 0;let U=x;if(v){const N=Date.now(),D=new Date(N).toDateString();if(v.lastXpEarnedTime&&new Date(v.lastXpEarnedTime).toDateString()===D)return 0;if(I&&I.tested>0){const O=I.correct/I.tested;U*=1+(O-.7)}S===Ut.EASY&&(U*=1.1),S===Ut.FORGOT&&(U*=.1),U=Math.round(Math.max(5,U)),v.lastXpEarnedTime=N}const M=Tv(z.level,z.experience)+Math.round(U);let B=1,F=M,H=fl(B);for(;F>=H;)F-=H,B++,H=fl(B);const q=Math.floor(F),Y=z.level,A=B>Y,T=em(B),E={...z,experience:q,level:B,peakLevel:Math.max(z.peakLevel||Y,B),role:T};let R=!1;if(!v&&x>0&&Math.random()<.2){const N={...E.adventure};N.keyFragments=(N.keyFragments||0)+1,l("You found a Key Fragment! ","success",2e3),N.keyFragments>=3&&(N.keyFragments-=3,N.keys=(N.keys||0)+1,R=!0),E.adventure=N}return v?await s(v,E):await e(E),R&&l(" Key Fragments assembled into a Magic Key!","success",4e3),o({amount:Math.round(U),levelUp:A,newLevel:A?B:null}),setTimeout(()=>o(null),A?5e3:2e3),A&&l(` Level Up to ${B}! New title: "${T}"`,"success",5e3),Math.round(U)},[e,s,l]),m=L.useCallback(async x=>{const v=d.current;if(!v)return;const S=Tv(v.level,v.experience),I=x-S;if(I===0)return;let z=1,U=x,C=fl(z);for(;U>=C;)U-=C,z++,C=fl(z);const M=Math.floor(U),B=v.level,F=v.peakLevel||B,H=Math.max(F,z),q=em(z),Y=z>B,A=z>F,T=q!==em(F),E={...v,experience:M,level:z,peakLevel:H,role:q};if(A){let R=1,N=!1,D=` New Peak Level: ${z}! +1 Key Fragment`;for(T&&(R++,D=`New Title: "${q}"! +2 Key Fragments`),E.adventure.keyFragments=(E.adventure.keyFragments||0)+R;E.adventure.keyFragments>=3;)E.adventure.keyFragments-=3,E.adventure.keys=(E.adventure.keys||0)+1,N=!0;l(D,"success",6e3),N&&l(" Key Fragments assembled into a Magic Key!","success",4e3)}else if(Y)l(` Level Up to ${z}!`,"success",4e3);else if(I!==0){const R=I>0?"+":"";l(`XP Recalculated: ${R}${I} XP`,"info",2e3)}await e(E),o({amount:I,levelUp:Y,newLevel:Y?z:null}),setTimeout(()=>o(null),Y?5e3:2e3)},[l,e]),y=L.useMemo(()=>n?fl(n.level):0,[n]);return{recalculateXpAndLevelUp:m,gainExperienceAndLevelUp:p,xpGained:a,xpToNextLevel:y}};function yu(n,e){try{const s=localStorage.getItem(n);if(s)return JSON.parse(s)}catch(s){console.error(`Error parsing JSON from localStorage for key "${n}":`,s)}return e}function e0(n,e){try{localStorage.setItem(n,JSON.stringify(e))}catch(s){console.error(`Error saving JSON to localStorage for key "${n}":`,s)}}const jN="vocab_pro_adventure_chapters";function kN(){return yu(jN,_l)}const LN=({currentUser:n,onUpdateUser:e})=>{const[s,a]=L.useState({total:0,due:0,new:0,learned:0}),[o,l]=L.useState(null),[d,p]=L.useState(null),[m,y]=L.useState(!1),[x,v]=L.useState({count:0,date:""}),{showToast:S}=kr(),I=L.useCallback(async()=>{if(!n)return;await Jw(n.id);const C=nS();a(C.reviewCounts);const M=fi().filter(A=>A.userId===n.id),F=M.filter(A=>!A.isPassive).filter(A=>A.quality===Yt.VERIFIED);let H=null;if(d)H=d;else if(F.length>0){const A=new Date().toISOString().slice(0,10).replace(/-/g,""),T=n.id.length>4&&parseInt(n.id.substring(n.id.length-4),16)||1234,R=(parseInt(A)+T)%F.length;H=F[R]}l(H),y(H?bN(H.id):!1);const q=kN(),Y=n.adventure;if(Y){const A=new Map(M.map(D=>[D.word.toLowerCase(),D])),T={...Y};let E=!1,R=!1;const N=new Date().toISOString().split("T")[0];for(const D of q)for(const O of D.segments){if(!T.completedSegmentIds.includes(O.id))continue;let ve=T.segmentStars[O.id]||0;const ye=(G,ae)=>{T.segmentStars[O.id]=G,T.keyFragments=(T.keyFragments||0)+1,E=!0,S(ae,"success",5e3),!R&&n.adventureLastDailyStar!==N&&(T.keyFragments++,R=!0,S("Bonus: First star of the day! (+1 Key Fragment)","success",6e3))};ve<3&&(ve<1&&O.basicWords.length>0&&O.basicWords.every(G=>{var ae;return(((ae=A.get(G.toLowerCase()))==null?void 0:ae.consecutiveCorrect)??0)>0})&&(ye(1,` 1-Star Mastery for "${O.title}"! (+1 Key Fragment)`),ve=1),ve===1&&O.intermediateWords.length>0&&O.intermediateWords.every(G=>{var ae;return(((ae=A.get(G.toLowerCase()))==null?void 0:ae.consecutiveCorrect)??0)>0})&&(ye(2,` 2-Star Mastery for "${O.title}"! (+1 Key Fragment)`),ve=2),ve===2&&O.advancedWords.length>0&&O.advancedWords.every(G=>{var ae;return(((ae=A.get(G.toLowerCase()))==null?void 0:ae.consecutiveCorrect)??0)>0})&&ye(3,` Boss unlocked for "${O.title}"! (+1 Key Fragment)`))}if(E){for(;T.keyFragments>=3;)T.keyFragments-=3,T.keys=(T.keys||0)+1,S(" Key Fragments assembled into a Magic Key!","success",4e3);const D={...n,adventure:T,adventureLastDailyStar:R?N:n.adventureLastDailyStar};e(D)}}},[n,S,e,d]);L.useEffect(()=>{d&&I()},[d]),L.useEffect(()=>{n&&I();const C=()=>{S("Saving too quickly. Please wait.","info",1500)};return window.addEventListener("datastore-updated",I),window.addEventListener("datastore-cooldown",C),()=>{window.removeEventListener("datastore-updated",I),window.removeEventListener("datastore-cooldown",C)}},[n,I,S]);const z=L.useCallback(()=>{const C=new Date().toISOString().split("T")[0];let M=yu("vocab_pro_api_usage",{count:0,date:"1970-01-01"});M.date!==C&&(M={count:0,date:C}),v(M)},[]);return L.useEffect(()=>(z(),window.addEventListener("apiUsageUpdated",z),()=>{window.removeEventListener("apiUsageUpdated",z)}),[z]),{stats:s,wotd:o,setWotd:l,apiUsage:x,refreshGlobalStats:I,isWotdComposed:m,randomizeWotd:()=>{if(!n)return;const M=fi().filter(B=>B.userId===n.id).filter(B=>!B.isPassive&&B.quality===Yt.VERIFIED);if(M.length>0){const B=M[Math.floor(Math.random()*M.length)];p(B)}}}},MN=n=>{const{currentUser:e,setView:s,refreshGlobalStats:a,sessionWords:o,setSessionWords:l,globalViewWord:d,setGlobalViewWord:p,onUpdateUser:m}=n,{showToast:y}=kr(),x=()=>{var N;const A=Number(localStorage.getItem("vocab_pro_last_backup_timestamp"))||0,E=((N=Tt().sync)==null?void 0:N.lastSyncTime)||0,R=Math.max(A,E);return R>0?R:null},[v,S]=L.useState(x()),I=L.useCallback(()=>{S(x())},[]),z=async A=>{if(!e)return;const T=A||{vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,wordBook:!0,planning:!0},E=await oN(e.id,e,T),R=JSON.stringify(E,null,2),N=new Blob([R],{type:"application/json"}),D=URL.createObjectURL(N),O=document.createElement("a");O.href=D,O.download=`vocab-pro-backup-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(D);const ve=Date.now();localStorage.setItem("vocab_pro_last_backup_timestamp",String(ve)),localStorage.setItem("vocab_pro_local_last_modified",String(ve)),I(),sessionStorage.removeItem("vocab_pro_just_restored"),y("Backup file downloaded.","success")},U=async(A,T,E)=>{var ve;Ym();const R=Tt();if(T)try{const ye=JSON.parse(T),G={...R,server:ye.server};localStorage.setItem("vocab_pro_system_config",JSON.stringify(G)),window.dispatchEvent(new Event("config-updated"))}catch(ye){console.error("[Restore] Failed to merge config",ye)}sessionStorage.setItem("vocab_pro_just_restored","true");const N=E||A.backupTimestamp||Date.now();localStorage.setItem("vocab_pro_last_backup_timestamp",String(N)),localStorage.setItem("vocab_pro_local_last_modified",String(N));const D=Tt();Yr({...D,sync:{...D.sync,lastSyncTime:N}},!0);const O=((ve=A.updatedUser)==null?void 0:ve.id)||(e==null?void 0:e.id);O&&await Wm(O),A.updatedUser&&(localStorage.setItem("vocab_pro_current_user_id",A.updatedUser.id),localStorage.setItem("vocab_pro_current_user_name",A.updatedUser.name),await m(A.updatedUser)),y("Restore successful!","success",2e3),a(),window.dispatchEvent(new Event("vocab-pro-restore-complete")),window.dispatchEvent(new Event("vocab-pro-force-ui-reload")),setTimeout(()=>{window.isRestoring=!1},1e3)};return{lastBackupTime:v,refreshBackupTime:I,handleBackup:z,restoreFromServerAction:async(A,T)=>{const E=Tt(),R=JSON.stringify(E);window.isRestoring=!0,Ym();try{const N=A||(e?e.name||e.id:null);if(!N){window.isRestoring=!1;return}await eS(),R&&(localStorage.setItem("vocab_pro_system_config",R),window.dispatchEvent(new Event("config-updated")));const D=await aS(N);D&&D.type==="success"?await U(D,R,T):(y("Server restore failed. Manual restore may be required.","error"),window.isRestoring=!1)}catch(N){console.error("[DataActions] Restore error:",N),y("Restore encountered a fatal error.","error"),window.isRestoring=!1}},triggerLocalRestore:()=>{const A=Tt(),T=JSON.stringify(A),E=document.createElement("input");E.type="file",E.accept=".json",E.style.display="none",E.onchange=async R=>{var N;E.parentNode&&E.parentNode.removeChild(E);try{const D=(N=R.target.files)==null?void 0:N[0];if(!D)return;const O={user:!0,vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,mimic:!0,wordBook:!0,planning:!0};window.isRestoring=!0;const ve=e?e.id:"temp-restore",ye=await Yw(D,ve,O);ye.type==="success"?await U(ye,T):(y(`Restore failed: ${ye.message}`,"error",5e3),window.isRestoring=!1)}catch(D){console.error("Fatal error during local restore:",D),window.isRestoring=!1}},document.body.appendChild(E),E.click()},handleLibraryReset:async()=>{if(e)try{await rS(),sessionStorage.removeItem("vocab_pro_skip_seed"),await SN(!0),await Wm(e.id),a(),s("DASHBOARD")}catch{window.location.reload()}},updateWord:async A=>{await jf(A),o&&l(T=>(T||[]).map(E=>E.id===A.id?A:E)),d&&d.id===A.id&&(A.masteryScore=Rs(A),p(A))},deleteWord:async A=>{d&&d.id===A&&p(null),await _N(A)},bulkDeleteWords:async A=>{await EN(A)},bulkUpdateWords:async A=>{await sS(A)}}},DN=()=>{};var Av={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iS=function(n){const e=[];let s=0;for(let a=0;a<n.length;a++){let o=n.charCodeAt(a);o<128?e[s++]=o:o<2048?(e[s++]=o>>6|192,e[s++]=o&63|128):(o&64512)===55296&&a+1<n.length&&(n.charCodeAt(a+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++a)&1023),e[s++]=o>>18|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128,e[s++]=o&63|128):(e[s++]=o>>12|224,e[s++]=o>>6&63|128,e[s++]=o&63|128)}return e},UN=function(n){const e=[];let s=0,a=0;for(;s<n.length;){const o=n[s++];if(o<128)e[a++]=String.fromCharCode(o);else if(o>191&&o<224){const l=n[s++];e[a++]=String.fromCharCode((o&31)<<6|l&63)}else if(o>239&&o<365){const l=n[s++],d=n[s++],p=n[s++],m=((o&7)<<18|(l&63)<<12|(d&63)<<6|p&63)-65536;e[a++]=String.fromCharCode(55296+(m>>10)),e[a++]=String.fromCharCode(56320+(m&1023))}else{const l=n[s++],d=n[s++];e[a++]=String.fromCharCode((o&15)<<12|(l&63)<<6|d&63)}}return e.join("")},oS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let o=0;o<n.length;o+=3){const l=n[o],d=o+1<n.length,p=d?n[o+1]:0,m=o+2<n.length,y=m?n[o+2]:0,x=l>>2,v=(l&3)<<4|p>>4;let S=(p&15)<<2|y>>6,I=y&63;m||(I=64,d||(S=64)),a.push(s[x],s[v],s[S],s[I])}return a.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(iS(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):UN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const s=e?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let o=0;o<n.length;){const l=s[n.charAt(o++)],p=o<n.length?s[n.charAt(o)]:0;++o;const y=o<n.length?s[n.charAt(o)]:64;++o;const v=o<n.length?s[n.charAt(o)]:64;if(++o,l==null||p==null||y==null||v==null)throw new PN;const S=l<<2|p>>4;if(a.push(S),y!==64){const I=p<<4&240|y>>2;if(a.push(I),v!==64){const z=y<<6&192|v;a.push(z)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class PN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const VN=function(n){const e=iS(n);return oS.encodeByteArray(e,!0)},df=function(n){return VN(n).replace(/\./g,"")},zN=function(n){try{return oS.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FN=()=>BN().__FIREBASE_DEFAULTS__,HN=()=>{if(typeof process>"u"||typeof Av>"u")return;const n=Av.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},GN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&zN(n[1]);return e&&JSON.parse(e)},t0=()=>{try{return DN()||FN()||HN()||GN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},qN=n=>{var e,s;return(s=(e=t0())==null?void 0:e.emulatorHosts)==null?void 0:s[n]},$N=n=>{const e=qN(n);if(!e)return;const s=e.lastIndexOf(":");if(s<=0||s+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const a=parseInt(e.substring(s+1),10);return e[0]==="["?[e.substring(1,s-1),a]:[e.substring(0,s),a]},lS=()=>{var n;return(n=t0())==null?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,s)=>{this.resolve=e,this.reject=s})}wrapCallback(e){return(s,a)=>{s?this.reject(s):this.resolve(a),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(s):e(s,a))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n0(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function WN(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QN(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s={alg:"none",type:"JWT"},a=e||"demo-project",o=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${a}`,aud:a,iat:o,exp:o+3600,auth_time:o,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[df(JSON.stringify(s)),df(JSON.stringify(d)),""].join(".")}const Kc={};function KN(){const n={prod:[],emulator:[]};for(const e of Object.keys(Kc))Kc[e]?n.emulator.push(e):n.prod.push(e);return n}function ZN(n){let e=document.getElementById(n),s=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),s=!0),{created:s,element:e}}let Iv=!1;function XN(n,e){if(typeof window>"u"||typeof document>"u"||!n0(window.location.host)||Kc[n]===e||Kc[n]||Iv)return;Kc[n]=e;function s(S){return`__firebase__banner__${S}`}const a="__firebase__banner",l=KN().prod.length>0;function d(){const S=document.getElementById(a);S&&S.remove()}function p(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function m(S,I){S.setAttribute("width","24"),S.setAttribute("id",I),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function y(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{Iv=!0,d()},S}function x(S,I){S.setAttribute("id",I),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function v(){const S=ZN(a),I=s("text"),z=document.getElementById(I)||document.createElement("span"),U=s("learnmore"),C=document.getElementById(U)||document.createElement("a"),M=s("preprendIcon"),B=document.getElementById(M)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const F=S.element;p(F),x(C,U);const H=y();m(B,M),F.append(B,z,C,H),document.body.appendChild(F)}l?(z.innerText="Preview backend disconnected.",B.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(B.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,z.innerText="Preview backend running in this workspace."),z.setAttribute("id",I)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JN(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function eC(){var e;const n=(e=t0())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function tC(){return!eC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nC(){try{return typeof indexedDB=="object"}catch{return!1}}function sC(){return new Promise((n,e)=>{try{let s=!0;const a="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(a);o.onsuccess=()=>{o.result.close(),s||self.indexedDB.deleteDatabase(a),n(!0)},o.onupgradeneeded=()=>{s=!1},o.onerror=()=>{var l;e(((l=o.error)==null?void 0:l.message)||"")}}catch(s){e(s)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC="FirebaseError";class Vl extends Error{constructor(e,s,a){super(s),this.code=e,this.customData=a,this.name=rC,Object.setPrototypeOf(this,Vl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,cS.prototype.create)}}class cS{constructor(e,s,a){this.service=e,this.serviceName=s,this.errors=a}create(e,...s){const a=s[0]||{},o=`${this.service}/${e}`,l=this.errors[e],d=l?aC(l,a):"Error",p=`${this.serviceName}: ${d} (${o}).`;return new Vl(o,p,a)}}function aC(n,e){return n.replace(iC,(s,a)=>{const o=e[a];return o!=null?String(o):`<${a}?>`})}const iC=/\{\$([^}]+)}/g;function ff(n,e){if(n===e)return!0;const s=Object.keys(n),a=Object.keys(e);for(const o of s){if(!a.includes(o))return!1;const l=n[o],d=e[o];if(Nv(l)&&Nv(d)){if(!ff(l,d))return!1}else if(l!==d)return!1}for(const o of a)if(!s.includes(o))return!1;return!0}function Nv(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(n){return n&&n._delegate?n._delegate:n}class iu{constructor(e,s,a){this.name=e,this.instanceFactory=s,this.type=a,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e,s){this.name=e,this.container=s,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const s=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(s)){const a=new YN;if(this.instancesDeferred.set(s,a),this.isInitialized(s)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:s});o&&a.resolve(o)}catch{}}return this.instancesDeferred.get(s).promise}getImmediate(e){const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),a=(e==null?void 0:e.optional)??!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(o){if(a)return null;throw o}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cC(e))try{this.getOrInitializeService({instanceIdentifier:so})}catch{}for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);try{const l=this.getOrInitializeService({instanceIdentifier:o});a.resolve(l)}catch{}}}}clearInstance(e=so){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(s=>"INTERNAL"in s).map(s=>s.INTERNAL.delete()),...e.filter(s=>"_delete"in s).map(s=>s._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=so){return this.instances.has(e)}getOptions(e=so){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:s={}}=e,a=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(a))throw Error(`${this.name}(${a}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:a,options:s});for(const[l,d]of this.instancesDeferred.entries()){const p=this.normalizeInstanceIdentifier(l);a===p&&d.resolve(o)}return o}onInit(e,s){const a=this.normalizeInstanceIdentifier(s),o=this.onInitCallbacks.get(a)??new Set;o.add(e),this.onInitCallbacks.set(a,o);const l=this.instances.get(a);return l&&e(l,a),()=>{o.delete(e)}}invokeOnInitCallbacks(e,s){const a=this.onInitCallbacks.get(s);if(a)for(const o of a)try{o(e,s)}catch{}}getOrInitializeService({instanceIdentifier:e,options:s={}}){let a=this.instances.get(e);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:lC(e),options:s}),this.instances.set(e,a),this.instancesOptions.set(e,s),this.invokeOnInitCallbacks(a,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,a)}catch{}return a||null}normalizeInstanceIdentifier(e=so){return this.component?this.component.multipleInstances?e:so:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lC(n){return n===so?void 0:n}function cC(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const s=this.getProvider(e.name);if(s.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);s.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const s=new oC(e,this);return this.providers.set(e,s),s}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var St;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(St||(St={}));const dC={debug:St.DEBUG,verbose:St.VERBOSE,info:St.INFO,warn:St.WARN,error:St.ERROR,silent:St.SILENT},fC=St.INFO,hC={[St.DEBUG]:"log",[St.VERBOSE]:"log",[St.INFO]:"info",[St.WARN]:"warn",[St.ERROR]:"error"},pC=(n,e,...s)=>{if(e<n.logLevel)return;const a=new Date().toISOString(),o=hC[e];if(o)console[o](`[${a}]  ${n.name}:`,...s);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dS{constructor(e){this.name=e,this._logLevel=fC,this._logHandler=pC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in St))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,St.DEBUG,...e),this._logHandler(this,St.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,St.VERBOSE,...e),this._logHandler(this,St.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,St.INFO,...e),this._logHandler(this,St.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,St.WARN,...e),this._logHandler(this,St.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,St.ERROR,...e),this._logHandler(this,St.ERROR,...e)}}const mC=(n,e)=>e.some(s=>n instanceof s);let Cv,Rv;function gC(){return Cv||(Cv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yC(){return Rv||(Rv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const fS=new WeakMap,Qm=new WeakMap,hS=new WeakMap,tm=new WeakMap,s0=new WeakMap;function xC(n){const e=new Promise((s,a)=>{const o=()=>{n.removeEventListener("success",l),n.removeEventListener("error",d)},l=()=>{s(hi(n.result)),o()},d=()=>{a(n.error),o()};n.addEventListener("success",l),n.addEventListener("error",d)});return e.then(s=>{s instanceof IDBCursor&&fS.set(s,n)}).catch(()=>{}),s0.set(e,n),e}function bC(n){if(Qm.has(n))return;const e=new Promise((s,a)=>{const o=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",d),n.removeEventListener("abort",d)},l=()=>{s(),o()},d=()=>{a(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",l),n.addEventListener("error",d),n.addEventListener("abort",d)});Qm.set(n,e)}let Km={get(n,e,s){if(n instanceof IDBTransaction){if(e==="done")return Qm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||hS.get(n);if(e==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return hi(n[e])},set(n,e,s){return n[e]=s,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function vC(n){Km=n(Km)}function _C(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...s){const a=n.call(nm(this),e,...s);return hS.set(a,e.sort?e.sort():[e]),hi(a)}:yC().includes(n)?function(...e){return n.apply(nm(this),e),hi(fS.get(this))}:function(...e){return hi(n.apply(nm(this),e))}}function EC(n){return typeof n=="function"?_C(n):(n instanceof IDBTransaction&&bC(n),mC(n,gC())?new Proxy(n,Km):n)}function hi(n){if(n instanceof IDBRequest)return xC(n);if(tm.has(n))return tm.get(n);const e=EC(n);return e!==n&&(tm.set(n,e),s0.set(e,n)),e}const nm=n=>s0.get(n);function wC(n,e,{blocked:s,upgrade:a,blocking:o,terminated:l}={}){const d=indexedDB.open(n,e),p=hi(d);return a&&d.addEventListener("upgradeneeded",m=>{a(hi(d.result),m.oldVersion,m.newVersion,hi(d.transaction),m)}),s&&d.addEventListener("blocked",m=>s(m.oldVersion,m.newVersion,m)),p.then(m=>{l&&m.addEventListener("close",()=>l()),o&&m.addEventListener("versionchange",y=>o(y.oldVersion,y.newVersion,y))}).catch(()=>{}),p}const SC=["get","getKey","getAll","getAllKeys","count"],TC=["put","add","delete","clear"],sm=new Map;function Ov(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(sm.get(e))return sm.get(e);const s=e.replace(/FromIndex$/,""),a=e!==s,o=TC.includes(s);if(!(s in(a?IDBIndex:IDBObjectStore).prototype)||!(o||SC.includes(s)))return;const l=async function(d,...p){const m=this.transaction(d,o?"readwrite":"readonly");let y=m.store;return a&&(y=y.index(p.shift())),(await Promise.all([y[s](...p),o&&m.done]))[0]};return sm.set(e,l),l}vC(n=>({...n,get:(e,s,a)=>Ov(e,s)||n.get(e,s,a),has:(e,s)=>!!Ov(e,s)||n.has(e,s)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(s=>{if(IC(s)){const a=s.getImmediate();return`${a.library}/${a.version}`}else return null}).filter(s=>s).join(" ")}}function IC(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Zm="@firebase/app",jv="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La=new dS("@firebase/app"),NC="@firebase/app-compat",CC="@firebase/analytics-compat",RC="@firebase/analytics",OC="@firebase/app-check-compat",jC="@firebase/app-check",kC="@firebase/auth",LC="@firebase/auth-compat",MC="@firebase/database",DC="@firebase/data-connect",UC="@firebase/database-compat",PC="@firebase/functions",VC="@firebase/functions-compat",zC="@firebase/installations",BC="@firebase/installations-compat",FC="@firebase/messaging",HC="@firebase/messaging-compat",GC="@firebase/performance",qC="@firebase/performance-compat",$C="@firebase/remote-config",YC="@firebase/remote-config-compat",WC="@firebase/storage",QC="@firebase/storage-compat",KC="@firebase/firestore",ZC="@firebase/ai",XC="@firebase/firestore-compat",JC="firebase",eR="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xm="[DEFAULT]",tR={[Zm]:"fire-core",[NC]:"fire-core-compat",[RC]:"fire-analytics",[CC]:"fire-analytics-compat",[jC]:"fire-app-check",[OC]:"fire-app-check-compat",[kC]:"fire-auth",[LC]:"fire-auth-compat",[MC]:"fire-rtdb",[DC]:"fire-data-connect",[UC]:"fire-rtdb-compat",[PC]:"fire-fn",[VC]:"fire-fn-compat",[zC]:"fire-iid",[BC]:"fire-iid-compat",[FC]:"fire-fcm",[HC]:"fire-fcm-compat",[GC]:"fire-perf",[qC]:"fire-perf-compat",[$C]:"fire-rc",[YC]:"fire-rc-compat",[WC]:"fire-gcs",[QC]:"fire-gcs-compat",[KC]:"fire-fst",[XC]:"fire-fst-compat",[ZC]:"fire-vertex","fire-js":"fire-js",[JC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hf=new Map,nR=new Map,Jm=new Map;function kv(n,e){try{n.container.addComponent(e)}catch(s){La.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,s)}}function pf(n){const e=n.name;if(Jm.has(e))return La.debug(`There were multiple attempts to register component ${e}.`),!1;Jm.set(e,n);for(const s of hf.values())kv(s,n);for(const s of nR.values())kv(s,n);return!0}function sR(n,e){const s=n.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),n.container.getProvider(e)}function rR(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pi=new cS("app","Firebase",aR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e,s,a){this._isDeleted=!1,this._options={...e},this._config={...s},this._name=s.name,this._automaticDataCollectionEnabled=s.automaticDataCollectionEnabled,this._container=a,this.container.addComponent(new iu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oR=eR;function pS(n,e={}){let s=n;typeof e!="object"&&(e={name:e});const a={name:Xm,automaticDataCollectionEnabled:!0,...e},o=a.name;if(typeof o!="string"||!o)throw pi.create("bad-app-name",{appName:String(o)});if(s||(s=lS()),!s)throw pi.create("no-options");const l=hf.get(o);if(l){if(ff(s,l.options)&&ff(a,l.config))return l;throw pi.create("duplicate-app",{appName:o})}const d=new uC(o);for(const m of Jm.values())d.addComponent(m);const p=new iR(s,a,d);return hf.set(o,p),p}function lR(n=Xm){const e=hf.get(n);if(!e&&n===Xm&&lS())return pS();if(!e)throw pi.create("no-app",{appName:n});return e}function Sl(n,e,s){let a=tR[n]??n;s&&(a+=`-${s}`);const o=a.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const d=[`Unable to register library "${a}" with version "${e}":`];o&&d.push(`library name "${a}" contains illegal characters (whitespace or "/")`),o&&l&&d.push("and"),l&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),La.warn(d.join(" "));return}pf(new iu(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR="firebase-heartbeat-database",uR=1,ou="firebase-heartbeat-store";let rm=null;function mS(){return rm||(rm=wC(cR,uR,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ou)}catch(s){console.warn(s)}}}}).catch(n=>{throw pi.create("idb-open",{originalErrorMessage:n.message})})),rm}async function dR(n){try{const s=(await mS()).transaction(ou),a=await s.objectStore(ou).get(gS(n));return await s.done,a}catch(e){if(e instanceof Vl)La.warn(e.message);else{const s=pi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});La.warn(s.message)}}}async function Lv(n,e){try{const a=(await mS()).transaction(ou,"readwrite");await a.objectStore(ou).put(e,gS(n)),await a.done}catch(s){if(s instanceof Vl)La.warn(s.message);else{const a=pi.create("idb-set",{originalErrorMessage:s==null?void 0:s.message});La.warn(a.message)}}}function gS(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fR=1024,hR=30;class pR{constructor(e){this.container=e,this._heartbeatsCache=null;const s=this.container.getProvider("app").getImmediate();this._storage=new gR(s),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){var e,s;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=Mv();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((s=this._heartbeatsCache)==null?void 0:s.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:o}),this._heartbeatsCache.heartbeats.length>hR){const d=yR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){La.warn(a)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const s=Mv(),{heartbeatsToSend:a,unsentEntries:o}=mR(this._heartbeatsCache.heartbeats),l=df(JSON.stringify({version:2,heartbeats:a}));return this._heartbeatsCache.lastSentHeartbeatDate=s,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(s){return La.warn(s),""}}}function Mv(){return new Date().toISOString().substring(0,10)}function mR(n,e=fR){const s=[];let a=n.slice();for(const o of n){const l=s.find(d=>d.agent===o.agent);if(l){if(l.dates.push(o.date),Dv(s)>e){l.dates.pop();break}}else if(s.push({agent:o.agent,dates:[o.date]}),Dv(s)>e){s.pop();break}a=a.slice(1)}return{heartbeatsToSend:s,unsentEntries:a}}class gR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nC()?sC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const s=await dR(this.app);return s!=null&&s.heartbeats?s:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return Lv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const a=await this.read();return Lv(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function Dv(n){return df(JSON.stringify({version:2,heartbeats:n})).length}function yR(n){if(n.length===0)return-1;let e=0,s=n[0].date;for(let a=1;a<n.length;a++)n[a].date<s&&(s=n[a].date,e=a);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xR(n){pf(new iu("platform-logger",e=>new AC(e),"PRIVATE")),pf(new iu("heartbeat",e=>new pR(e),"PRIVATE")),Sl(Zm,jv,n),Sl(Zm,jv,"esm2020"),Sl("fire-js","")}xR("");var bR="firebase",vR="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sl(bR,vR,"app");var Uv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var mi,yS;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,T){function E(){}E.prototype=T.prototype,A.F=T.prototype,A.prototype=new E,A.prototype.constructor=A,A.D=function(R,N,D){for(var O=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)O[ve-2]=arguments[ve];return T.prototype[N].apply(R,O)}}function s(){this.blockSize=-1}function a(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(a,s),a.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(A,T,E){E||(E=0);const R=Array(16);if(typeof T=="string")for(var N=0;N<16;++N)R[N]=T.charCodeAt(E++)|T.charCodeAt(E++)<<8|T.charCodeAt(E++)<<16|T.charCodeAt(E++)<<24;else for(N=0;N<16;++N)R[N]=T[E++]|T[E++]<<8|T[E++]<<16|T[E++]<<24;T=A.g[0],E=A.g[1],N=A.g[2];let D=A.g[3],O;O=T+(D^E&(N^D))+R[0]+3614090360&4294967295,T=E+(O<<7&4294967295|O>>>25),O=D+(N^T&(E^N))+R[1]+3905402710&4294967295,D=T+(O<<12&4294967295|O>>>20),O=N+(E^D&(T^E))+R[2]+606105819&4294967295,N=D+(O<<17&4294967295|O>>>15),O=E+(T^N&(D^T))+R[3]+3250441966&4294967295,E=N+(O<<22&4294967295|O>>>10),O=T+(D^E&(N^D))+R[4]+4118548399&4294967295,T=E+(O<<7&4294967295|O>>>25),O=D+(N^T&(E^N))+R[5]+1200080426&4294967295,D=T+(O<<12&4294967295|O>>>20),O=N+(E^D&(T^E))+R[6]+2821735955&4294967295,N=D+(O<<17&4294967295|O>>>15),O=E+(T^N&(D^T))+R[7]+4249261313&4294967295,E=N+(O<<22&4294967295|O>>>10),O=T+(D^E&(N^D))+R[8]+1770035416&4294967295,T=E+(O<<7&4294967295|O>>>25),O=D+(N^T&(E^N))+R[9]+2336552879&4294967295,D=T+(O<<12&4294967295|O>>>20),O=N+(E^D&(T^E))+R[10]+4294925233&4294967295,N=D+(O<<17&4294967295|O>>>15),O=E+(T^N&(D^T))+R[11]+2304563134&4294967295,E=N+(O<<22&4294967295|O>>>10),O=T+(D^E&(N^D))+R[12]+1804603682&4294967295,T=E+(O<<7&4294967295|O>>>25),O=D+(N^T&(E^N))+R[13]+4254626195&4294967295,D=T+(O<<12&4294967295|O>>>20),O=N+(E^D&(T^E))+R[14]+2792965006&4294967295,N=D+(O<<17&4294967295|O>>>15),O=E+(T^N&(D^T))+R[15]+1236535329&4294967295,E=N+(O<<22&4294967295|O>>>10),O=T+(N^D&(E^N))+R[1]+4129170786&4294967295,T=E+(O<<5&4294967295|O>>>27),O=D+(E^N&(T^E))+R[6]+3225465664&4294967295,D=T+(O<<9&4294967295|O>>>23),O=N+(T^E&(D^T))+R[11]+643717713&4294967295,N=D+(O<<14&4294967295|O>>>18),O=E+(D^T&(N^D))+R[0]+3921069994&4294967295,E=N+(O<<20&4294967295|O>>>12),O=T+(N^D&(E^N))+R[5]+3593408605&4294967295,T=E+(O<<5&4294967295|O>>>27),O=D+(E^N&(T^E))+R[10]+38016083&4294967295,D=T+(O<<9&4294967295|O>>>23),O=N+(T^E&(D^T))+R[15]+3634488961&4294967295,N=D+(O<<14&4294967295|O>>>18),O=E+(D^T&(N^D))+R[4]+3889429448&4294967295,E=N+(O<<20&4294967295|O>>>12),O=T+(N^D&(E^N))+R[9]+568446438&4294967295,T=E+(O<<5&4294967295|O>>>27),O=D+(E^N&(T^E))+R[14]+3275163606&4294967295,D=T+(O<<9&4294967295|O>>>23),O=N+(T^E&(D^T))+R[3]+4107603335&4294967295,N=D+(O<<14&4294967295|O>>>18),O=E+(D^T&(N^D))+R[8]+1163531501&4294967295,E=N+(O<<20&4294967295|O>>>12),O=T+(N^D&(E^N))+R[13]+2850285829&4294967295,T=E+(O<<5&4294967295|O>>>27),O=D+(E^N&(T^E))+R[2]+4243563512&4294967295,D=T+(O<<9&4294967295|O>>>23),O=N+(T^E&(D^T))+R[7]+1735328473&4294967295,N=D+(O<<14&4294967295|O>>>18),O=E+(D^T&(N^D))+R[12]+2368359562&4294967295,E=N+(O<<20&4294967295|O>>>12),O=T+(E^N^D)+R[5]+4294588738&4294967295,T=E+(O<<4&4294967295|O>>>28),O=D+(T^E^N)+R[8]+2272392833&4294967295,D=T+(O<<11&4294967295|O>>>21),O=N+(D^T^E)+R[11]+1839030562&4294967295,N=D+(O<<16&4294967295|O>>>16),O=E+(N^D^T)+R[14]+4259657740&4294967295,E=N+(O<<23&4294967295|O>>>9),O=T+(E^N^D)+R[1]+2763975236&4294967295,T=E+(O<<4&4294967295|O>>>28),O=D+(T^E^N)+R[4]+1272893353&4294967295,D=T+(O<<11&4294967295|O>>>21),O=N+(D^T^E)+R[7]+4139469664&4294967295,N=D+(O<<16&4294967295|O>>>16),O=E+(N^D^T)+R[10]+3200236656&4294967295,E=N+(O<<23&4294967295|O>>>9),O=T+(E^N^D)+R[13]+681279174&4294967295,T=E+(O<<4&4294967295|O>>>28),O=D+(T^E^N)+R[0]+3936430074&4294967295,D=T+(O<<11&4294967295|O>>>21),O=N+(D^T^E)+R[3]+3572445317&4294967295,N=D+(O<<16&4294967295|O>>>16),O=E+(N^D^T)+R[6]+76029189&4294967295,E=N+(O<<23&4294967295|O>>>9),O=T+(E^N^D)+R[9]+3654602809&4294967295,T=E+(O<<4&4294967295|O>>>28),O=D+(T^E^N)+R[12]+3873151461&4294967295,D=T+(O<<11&4294967295|O>>>21),O=N+(D^T^E)+R[15]+530742520&4294967295,N=D+(O<<16&4294967295|O>>>16),O=E+(N^D^T)+R[2]+3299628645&4294967295,E=N+(O<<23&4294967295|O>>>9),O=T+(N^(E|~D))+R[0]+4096336452&4294967295,T=E+(O<<6&4294967295|O>>>26),O=D+(E^(T|~N))+R[7]+1126891415&4294967295,D=T+(O<<10&4294967295|O>>>22),O=N+(T^(D|~E))+R[14]+2878612391&4294967295,N=D+(O<<15&4294967295|O>>>17),O=E+(D^(N|~T))+R[5]+4237533241&4294967295,E=N+(O<<21&4294967295|O>>>11),O=T+(N^(E|~D))+R[12]+1700485571&4294967295,T=E+(O<<6&4294967295|O>>>26),O=D+(E^(T|~N))+R[3]+2399980690&4294967295,D=T+(O<<10&4294967295|O>>>22),O=N+(T^(D|~E))+R[10]+4293915773&4294967295,N=D+(O<<15&4294967295|O>>>17),O=E+(D^(N|~T))+R[1]+2240044497&4294967295,E=N+(O<<21&4294967295|O>>>11),O=T+(N^(E|~D))+R[8]+1873313359&4294967295,T=E+(O<<6&4294967295|O>>>26),O=D+(E^(T|~N))+R[15]+4264355552&4294967295,D=T+(O<<10&4294967295|O>>>22),O=N+(T^(D|~E))+R[6]+2734768916&4294967295,N=D+(O<<15&4294967295|O>>>17),O=E+(D^(N|~T))+R[13]+1309151649&4294967295,E=N+(O<<21&4294967295|O>>>11),O=T+(N^(E|~D))+R[4]+4149444226&4294967295,T=E+(O<<6&4294967295|O>>>26),O=D+(E^(T|~N))+R[11]+3174756917&4294967295,D=T+(O<<10&4294967295|O>>>22),O=N+(T^(D|~E))+R[2]+718787259&4294967295,N=D+(O<<15&4294967295|O>>>17),O=E+(D^(N|~T))+R[9]+3951481745&4294967295,A.g[0]=A.g[0]+T&4294967295,A.g[1]=A.g[1]+(N+(O<<21&4294967295|O>>>11))&4294967295,A.g[2]=A.g[2]+N&4294967295,A.g[3]=A.g[3]+D&4294967295}a.prototype.v=function(A,T){T===void 0&&(T=A.length);const E=T-this.blockSize,R=this.C;let N=this.h,D=0;for(;D<T;){if(N==0)for(;D<=E;)o(this,A,D),D+=this.blockSize;if(typeof A=="string"){for(;D<T;)if(R[N++]=A.charCodeAt(D++),N==this.blockSize){o(this,R),N=0;break}}else for(;D<T;)if(R[N++]=A[D++],N==this.blockSize){o(this,R),N=0;break}}this.h=N,this.o+=T},a.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var T=1;T<A.length-8;++T)A[T]=0;T=this.o*8;for(var E=A.length-8;E<A.length;++E)A[E]=T&255,T/=256;for(this.v(A),A=Array(16),T=0,E=0;E<4;++E)for(let R=0;R<32;R+=8)A[T++]=this.g[E]>>>R&255;return A};function l(A,T){var E=p;return Object.prototype.hasOwnProperty.call(E,A)?E[A]:E[A]=T(A)}function d(A,T){this.h=T;const E=[];let R=!0;for(let N=A.length-1;N>=0;N--){const D=A[N]|0;R&&D==T||(E[N]=D,R=!1)}this.g=E}var p={};function m(A){return-128<=A&&A<128?l(A,function(T){return new d([T|0],T<0?-1:0)}):new d([A|0],A<0?-1:0)}function y(A){if(isNaN(A)||!isFinite(A))return v;if(A<0)return C(y(-A));const T=[];let E=1;for(let R=0;A>=E;R++)T[R]=A/E|0,E*=4294967296;return new d(T,0)}function x(A,T){if(A.length==0)throw Error("number format error: empty string");if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(A.charAt(0)=="-")return C(x(A.substring(1),T));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const E=y(Math.pow(T,8));let R=v;for(let D=0;D<A.length;D+=8){var N=Math.min(8,A.length-D);const O=parseInt(A.substring(D,D+N),T);N<8?(N=y(Math.pow(T,N)),R=R.j(N).add(y(O))):(R=R.j(E),R=R.add(y(O)))}return R}var v=m(0),S=m(1),I=m(16777216);n=d.prototype,n.m=function(){if(U(this))return-C(this).m();let A=0,T=1;for(let E=0;E<this.g.length;E++){const R=this.i(E);A+=(R>=0?R:4294967296+R)*T,T*=4294967296}return A},n.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(z(this))return"0";if(U(this))return"-"+C(this).toString(A);const T=y(Math.pow(A,6));var E=this;let R="";for(;;){const N=H(E,T).g;E=M(E,N.j(T));let D=((E.g.length>0?E.g[0]:E.h)>>>0).toString(A);if(E=N,z(E))return D+R;for(;D.length<6;)D="0"+D;R=D+R}},n.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function z(A){if(A.h!=0)return!1;for(let T=0;T<A.g.length;T++)if(A.g[T]!=0)return!1;return!0}function U(A){return A.h==-1}n.l=function(A){return A=M(this,A),U(A)?-1:z(A)?0:1};function C(A){const T=A.g.length,E=[];for(let R=0;R<T;R++)E[R]=~A.g[R];return new d(E,~A.h).add(S)}n.abs=function(){return U(this)?C(this):this},n.add=function(A){const T=Math.max(this.g.length,A.g.length),E=[];let R=0;for(let N=0;N<=T;N++){let D=R+(this.i(N)&65535)+(A.i(N)&65535),O=(D>>>16)+(this.i(N)>>>16)+(A.i(N)>>>16);R=O>>>16,D&=65535,O&=65535,E[N]=O<<16|D}return new d(E,E[E.length-1]&-2147483648?-1:0)};function M(A,T){return A.add(C(T))}n.j=function(A){if(z(this)||z(A))return v;if(U(this))return U(A)?C(this).j(C(A)):C(C(this).j(A));if(U(A))return C(this.j(C(A)));if(this.l(I)<0&&A.l(I)<0)return y(this.m()*A.m());const T=this.g.length+A.g.length,E=[];for(var R=0;R<2*T;R++)E[R]=0;for(R=0;R<this.g.length;R++)for(let N=0;N<A.g.length;N++){const D=this.i(R)>>>16,O=this.i(R)&65535,ve=A.i(N)>>>16,ye=A.i(N)&65535;E[2*R+2*N]+=O*ye,B(E,2*R+2*N),E[2*R+2*N+1]+=D*ye,B(E,2*R+2*N+1),E[2*R+2*N+1]+=O*ve,B(E,2*R+2*N+1),E[2*R+2*N+2]+=D*ve,B(E,2*R+2*N+2)}for(A=0;A<T;A++)E[A]=E[2*A+1]<<16|E[2*A];for(A=T;A<2*T;A++)E[A]=0;return new d(E,0)};function B(A,T){for(;(A[T]&65535)!=A[T];)A[T+1]+=A[T]>>>16,A[T]&=65535,T++}function F(A,T){this.g=A,this.h=T}function H(A,T){if(z(T))throw Error("division by zero");if(z(A))return new F(v,v);if(U(A))return T=H(C(A),T),new F(C(T.g),C(T.h));if(U(T))return T=H(A,C(T)),new F(C(T.g),T.h);if(A.g.length>30){if(U(A)||U(T))throw Error("slowDivide_ only works with positive integers.");for(var E=S,R=T;R.l(A)<=0;)E=q(E),R=q(R);var N=Y(E,1),D=Y(R,1);for(R=Y(R,2),E=Y(E,2);!z(R);){var O=D.add(R);O.l(A)<=0&&(N=N.add(E),D=O),R=Y(R,1),E=Y(E,1)}return T=M(A,N.j(T)),new F(N,T)}for(N=v;A.l(T)>=0;){for(E=Math.max(1,Math.floor(A.m()/T.m())),R=Math.ceil(Math.log(E)/Math.LN2),R=R<=48?1:Math.pow(2,R-48),D=y(E),O=D.j(T);U(O)||O.l(A)>0;)E-=R,D=y(E),O=D.j(T);z(D)&&(D=S),N=N.add(D),A=M(A,O)}return new F(N,A)}n.B=function(A){return H(this,A).h},n.and=function(A){const T=Math.max(this.g.length,A.g.length),E=[];for(let R=0;R<T;R++)E[R]=this.i(R)&A.i(R);return new d(E,this.h&A.h)},n.or=function(A){const T=Math.max(this.g.length,A.g.length),E=[];for(let R=0;R<T;R++)E[R]=this.i(R)|A.i(R);return new d(E,this.h|A.h)},n.xor=function(A){const T=Math.max(this.g.length,A.g.length),E=[];for(let R=0;R<T;R++)E[R]=this.i(R)^A.i(R);return new d(E,this.h^A.h)};function q(A){const T=A.g.length+1,E=[];for(let R=0;R<T;R++)E[R]=A.i(R)<<1|A.i(R-1)>>>31;return new d(E,A.h)}function Y(A,T){const E=T>>5;T%=32;const R=A.g.length-E,N=[];for(let D=0;D<R;D++)N[D]=T>0?A.i(D+E)>>>T|A.i(D+E+1)<<32-T:A.i(D+E);return new d(N,A.h)}a.prototype.digest=a.prototype.A,a.prototype.reset=a.prototype.u,a.prototype.update=a.prototype.v,yS=a,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,mi=d}).apply(typeof Uv<"u"?Uv:typeof self<"u"?self:typeof window<"u"?window:{});var zd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xS,Uc,bS,tf,eg,vS,_S,ES;(function(){var n,e=Object.defineProperty;function s(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof zd=="object"&&zd];for(var b=0;b<f.length;++b){var w=f[b];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var a=s(this);function o(f,b){if(b)e:{var w=a;f=f.split(".");for(var P=0;P<f.length-1;P++){var te=f[P];if(!(te in w))break e;w=w[te]}f=f[f.length-1],P=w[f],b=b(P),b!=P&&b!=null&&e(w,f,{configurable:!0,writable:!0,value:b})}}o("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(f){return f||function(b){var w=[],P;for(P in b)Object.prototype.hasOwnProperty.call(b,P)&&w.push([P,b[P]]);return w}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},d=this||self;function p(f){var b=typeof f;return b=="object"&&f!=null||b=="function"}function m(f,b,w){return f.call.apply(f.bind,arguments)}function y(f,b,w){return y=m,y.apply(null,arguments)}function x(f,b){var w=Array.prototype.slice.call(arguments,1);return function(){var P=w.slice();return P.push.apply(P,arguments),f.apply(this,P)}}function v(f,b){function w(){}w.prototype=b.prototype,f.Z=b.prototype,f.prototype=new w,f.prototype.constructor=f,f.Ob=function(P,te,de){for(var Ce=Array(arguments.length-2),ut=2;ut<arguments.length;ut++)Ce[ut-2]=arguments[ut];return b.prototype[te].apply(P,Ce)}}var S=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function I(f){const b=f.length;if(b>0){const w=Array(b);for(let P=0;P<b;P++)w[P]=f[P];return w}return[]}function z(f,b){for(let P=1;P<arguments.length;P++){const te=arguments[P];var w=typeof te;if(w=w!="object"?w:te?Array.isArray(te)?"array":w:"null",w=="array"||w=="object"&&typeof te.length=="number"){w=f.length||0;const de=te.length||0;f.length=w+de;for(let Ce=0;Ce<de;Ce++)f[w+Ce]=te[Ce]}else f.push(te)}}class U{constructor(b,w){this.i=b,this.j=w,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function C(f){d.setTimeout(()=>{throw f},0)}function M(){var f=A;let b=null;return f.g&&(b=f.g,f.g=f.g.next,f.g||(f.h=null),b.next=null),b}class B{constructor(){this.h=this.g=null}add(b,w){const P=F.get();P.set(b,w),this.h?this.h.next=P:this.g=P,this.h=P}}var F=new U(()=>new H,f=>f.reset());class H{constructor(){this.next=this.g=this.h=null}set(b,w){this.h=b,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let q,Y=!1,A=new B,T=()=>{const f=Promise.resolve(void 0);q=()=>{f.then(E)}};function E(){for(var f;f=M();){try{f.h.call(f.g)}catch(w){C(w)}var b=F;b.j(f),b.h<100&&(b.h++,f.next=b.g,b.g=f)}Y=!1}function R(){this.u=this.u,this.C=this.C}R.prototype.u=!1,R.prototype.dispose=function(){this.u||(this.u=!0,this.N())},R.prototype[Symbol.dispose]=function(){this.dispose()},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function N(f,b){this.type=f,this.g=this.target=b,this.defaultPrevented=!1}N.prototype.h=function(){this.defaultPrevented=!0};var D=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var f=!1,b=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const w=()=>{};d.addEventListener("test",w,b),d.removeEventListener("test",w,b)}catch{}return f})();function O(f){return/^[\s\xa0]*$/.test(f)}function ve(f,b){N.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,b)}v(ve,N),ve.prototype.init=function(f,b){const w=this.type=f.type,P=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=b,b=f.relatedTarget,b||(w=="mouseover"?b=f.fromElement:w=="mouseout"&&(b=f.toElement)),this.relatedTarget=b,P?(this.clientX=P.clientX!==void 0?P.clientX:P.pageX,this.clientY=P.clientY!==void 0?P.clientY:P.pageY,this.screenX=P.screenX||0,this.screenY=P.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&ve.Z.h.call(this)},ve.prototype.h=function(){ve.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ye="closure_listenable_"+(Math.random()*1e6|0),G=0;function ae(f,b,w,P,te){this.listener=f,this.proxy=null,this.src=b,this.type=w,this.capture=!!P,this.ha=te,this.key=++G,this.da=this.fa=!1}function ne(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Q(f,b,w){for(const P in f)b.call(w,f[P],P,f)}function X(f,b){for(const w in f)b.call(void 0,f[w],w,f)}function j(f){const b={};for(const w in f)b[w]=f[w];return b}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(f,b){let w,P;for(let te=1;te<arguments.length;te++){P=arguments[te];for(w in P)f[w]=P[w];for(let de=0;de<V.length;de++)w=V[de],Object.prototype.hasOwnProperty.call(P,w)&&(f[w]=P[w])}}function Z(f){this.src=f,this.g={},this.h=0}Z.prototype.add=function(f,b,w,P,te){const de=f.toString();f=this.g[de],f||(f=this.g[de]=[],this.h++);const Ce=pe(f,b,P,te);return Ce>-1?(b=f[Ce],w||(b.fa=!1)):(b=new ae(b,this.src,de,!!P,te),b.fa=w,f.push(b)),b};function ee(f,b){const w=b.type;if(w in f.g){var P=f.g[w],te=Array.prototype.indexOf.call(P,b,void 0),de;(de=te>=0)&&Array.prototype.splice.call(P,te,1),de&&(ne(b),f.g[w].length==0&&(delete f.g[w],f.h--))}}function pe(f,b,w,P){for(let te=0;te<f.length;++te){const de=f[te];if(!de.da&&de.listener==b&&de.capture==!!w&&de.ha==P)return te}return-1}var ie="closure_lm_"+(Math.random()*1e6|0),ce={};function De(f,b,w,P,te){if(Array.isArray(b)){for(let de=0;de<b.length;de++)De(f,b[de],w,P,te);return null}return w=Ge(w),f&&f[ye]?f.J(b,w,p(P)?!!P.capture:!1,te):fe(f,b,w,!1,P,te)}function fe(f,b,w,P,te,de){if(!b)throw Error("Invalid event type");const Ce=p(te)?!!te.capture:!!te;let ut=Ee(f);if(ut||(f[ie]=ut=new Z(f)),w=ut.add(b,w,P,Ce,de),w.proxy)return w;if(P=Se(),w.proxy=P,P.src=f,P.listener=w,f.addEventListener)D||(te=Ce),te===void 0&&(te=!1),f.addEventListener(b.toString(),P,te);else if(f.attachEvent)f.attachEvent(ue(b.toString()),P);else if(f.addListener&&f.removeListener)f.addListener(P);else throw Error("addEventListener and attachEvent are unavailable.");return w}function Se(){function f(w){return b.call(f.src,f.listener,w)}const b=ge;return f}function Oe(f,b,w,P,te){if(Array.isArray(b))for(var de=0;de<b.length;de++)Oe(f,b[de],w,P,te);else P=p(P)?!!P.capture:!!P,w=Ge(w),f&&f[ye]?(f=f.i,de=String(b).toString(),de in f.g&&(b=f.g[de],w=pe(b,w,P,te),w>-1&&(ne(b[w]),Array.prototype.splice.call(b,w,1),b.length==0&&(delete f.g[de],f.h--)))):f&&(f=Ee(f))&&(b=f.g[b.toString()],f=-1,b&&(f=pe(b,w,P,te)),(w=f>-1?b[f]:null)&&me(w))}function me(f){if(typeof f!="number"&&f&&!f.da){var b=f.src;if(b&&b[ye])ee(b.i,f);else{var w=f.type,P=f.proxy;b.removeEventListener?b.removeEventListener(w,P,f.capture):b.detachEvent?b.detachEvent(ue(w),P):b.addListener&&b.removeListener&&b.removeListener(P),(w=Ee(b))?(ee(w,f),w.h==0&&(w.src=null,b[ie]=null)):ne(f)}}}function ue(f){return f in ce?ce[f]:ce[f]="on"+f}function ge(f,b){if(f.da)f=!0;else{b=new ve(b,this);const w=f.listener,P=f.ha||f.src;f.fa&&me(f),f=w.call(P,b)}return f}function Ee(f){return f=f[ie],f instanceof Z?f:null}var Ae="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ge(f){return typeof f=="function"?f:(f[Ae]||(f[Ae]=function(b){return f.handleEvent(b)}),f[Ae])}function Ue(){R.call(this),this.i=new Z(this),this.M=this,this.G=null}v(Ue,R),Ue.prototype[ye]=!0,Ue.prototype.removeEventListener=function(f,b,w,P){Oe(this,f,b,w,P)};function Ke(f,b){var w,P=f.G;if(P)for(w=[];P;P=P.G)w.push(P);if(f=f.M,P=b.type||b,typeof b=="string")b=new N(b,f);else if(b instanceof N)b.target=b.target||f;else{var te=b;b=new N(P,f),$(b,te)}te=!0;let de,Ce;if(w)for(Ce=w.length-1;Ce>=0;Ce--)de=b.g=w[Ce],te=Nt(de,P,!0,b)&&te;if(de=b.g=f,te=Nt(de,P,!0,b)&&te,te=Nt(de,P,!1,b)&&te,w)for(Ce=0;Ce<w.length;Ce++)de=b.g=w[Ce],te=Nt(de,P,!1,b)&&te}Ue.prototype.N=function(){if(Ue.Z.N.call(this),this.i){var f=this.i;for(const b in f.g){const w=f.g[b];for(let P=0;P<w.length;P++)ne(w[P]);delete f.g[b],f.h--}}this.G=null},Ue.prototype.J=function(f,b,w,P){return this.i.add(String(f),b,!1,w,P)},Ue.prototype.K=function(f,b,w,P){return this.i.add(String(f),b,!0,w,P)};function Nt(f,b,w,P){if(b=f.i.g[String(b)],!b)return!0;b=b.concat();let te=!0;for(let de=0;de<b.length;++de){const Ce=b[de];if(Ce&&!Ce.da&&Ce.capture==w){const ut=Ce.listener,xn=Ce.ha||Ce.src;Ce.fa&&ee(f.i,Ce),te=ut.call(xn,P)!==!1&&te}}return te&&!P.defaultPrevented}function Pe(f,b){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=y(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(f,b||0)}function oe(f){f.g=Pe(()=>{f.g=null,f.i&&(f.i=!1,oe(f))},f.l);const b=f.h;f.h=null,f.m.apply(null,b)}class Ve extends R{constructor(b,w){super(),this.m=b,this.l=w,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:oe(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function lt(f){R.call(this),this.h=f,this.g={}}v(lt,R);var ct=[];function nt(f){Q(f.g,function(b,w){this.g.hasOwnProperty(w)&&me(b)},f),f.g={}}lt.prototype.N=function(){lt.Z.N.call(this),nt(this)},lt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pt=d.JSON.stringify,qt=d.JSON.parse,Pt=class{stringify(f){return d.JSON.stringify(f,void 0)}parse(f){return d.JSON.parse(f,void 0)}};function Os(){}function kn(){}var Zt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function be(){N.call(this,"d")}v(be,N);function Le(){N.call(this,"c")}v(Le,N);var Ne={},yt=null;function rt(){return yt=yt||new Ue}Ne.Ia="serverreachability";function Me(f){N.call(this,Ne.Ia,f)}v(Me,N);function st(f){const b=rt();Ke(b,new Me(b))}Ne.STAT_EVENT="statevent";function ht(f,b){N.call(this,Ne.STAT_EVENT,f),this.stat=b}v(ht,N);function Xe(f){const b=rt();Ke(b,new ht(b,f))}Ne.Ja="timingevent";function Dt(f,b){N.call(this,Ne.Ja,f),this.size=b}v(Dt,N);function vt(f,b){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){f()},b)}function ln(){this.g=!0}ln.prototype.ua=function(){this.g=!1};function vs(f,b,w,P,te,de){f.info(function(){if(f.g)if(de){var Ce="",ut=de.split("&");for(let Lt=0;Lt<ut.length;Lt++){var xn=ut[Lt].split("=");if(xn.length>1){const Jt=xn[0];xn=xn[1];const er=Jt.split("_");Ce=er.length>=2&&er[1]=="type"?Ce+(Jt+"="+xn+"&"):Ce+(Jt+"=redacted&")}}}else Ce=null;else Ce=de;return"XMLHTTP REQ ("+P+") [attempt "+te+"]: "+b+`
`+w+`
`+Ce})}function _s(f,b,w,P,te,de,Ce){f.info(function(){return"XMLHTTP RESP ("+P+") [ attempt "+te+"]: "+b+`
`+w+`
`+de+" "+Ce})}function Xt(f,b,w,P){f.info(function(){return"XMLHTTP TEXT ("+b+"): "+na(f,w)+(P?" "+P:"")})}function $n(f,b){f.info(function(){return"TIMEOUT: "+b})}ln.prototype.info=function(){};function na(f,b){if(!f.g)return b;if(!b)return null;try{const de=JSON.parse(b);if(de){for(f=0;f<de.length;f++)if(Array.isArray(de[f])){var w=de[f];if(!(w.length<2)){var P=w[1];if(Array.isArray(P)&&!(P.length<1)){var te=P[0];if(te!="noop"&&te!="stop"&&te!="close")for(let Ce=1;Ce<P.length;Ce++)P[Ce]=""}}}}return pt(de)}catch{return b}}var qs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},sa={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Dr;function ra(){}v(ra,Os),ra.prototype.g=function(){return new XMLHttpRequest},Dr=new ra;function pr(f){return encodeURIComponent(String(f))}function js(f){var b=1;f=f.split(":");const w=[];for(;b>0&&f.length;)w.push(f.shift()),b--;return f.length&&w.push(f.join(":")),w}function yn(f,b,w,P){this.j=f,this.i=b,this.l=w,this.S=P||1,this.V=new lt(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new cs}function cs(){this.i=null,this.g="",this.h=!1}var cn={},wn={};function $s(f,b,w){f.M=1,f.A=oa(dn(b)),f.u=w,f.R=!0,aa(f,null)}function aa(f,b){f.F=Date.now(),ks(f),f.B=dn(f.A);var w=f.B,P=f.S;Array.isArray(P)||(P=[String(P)]),qe(w.i,"t",P),f.C=0,w=f.j.L,f.h=new cs,f.g=ju(f.j,w?b:null,!f.u),f.P>0&&(f.O=new Ve(y(f.Y,f,f.g),f.P)),b=f.V,w=f.g,P=f.ba;var te="readystatechange";Array.isArray(te)||(te&&(ct[0]=te.toString()),te=ct);for(let de=0;de<te.length;de++){const Ce=De(w,te[de],P||b.handleEvent,!1,b.h||b);if(!Ce)break;b.g[Ce.key]=Ce}b=f.J?j(f.J):{},f.u?(f.v||(f.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,b)):(f.v="GET",f.g.ea(f.B,f.v,null,b)),st(),vs(f.i,f.v,f.B,f.l,f.S,f.u)}yn.prototype.ba=function(f){f=f.target;const b=this.O;b&&yr(f)==3?b.j():this.Y(f)},yn.prototype.Y=function(f){try{if(f==this.g)e:{const ut=yr(this.g),xn=this.g.ya(),Lt=this.g.ca();if(!(ut<3)&&(ut!=3||this.g&&(this.h.h||this.g.la()||Yn(this.g)))){this.K||ut!=4||xn==7||(xn==8||Lt<=0?st(3):st(2)),Ys(this);var b=this.g.ca();this.X=b;var w=Hl(this);if(this.o=b==200,_s(this.i,this.v,this.B,this.l,this.S,ut,b),this.o){if(this.U&&!this.L){t:{if(this.g){var P,te=this.g;if((P=te.g?te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(P)){var de=P;break t}}de=null}if(f=de)Xt(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ws(this,f);else{this.o=!1,this.m=3,Xe(12),us(this),Es(this);break e}}if(this.R){f=!0;let Jt;for(;!this.K&&this.C<w.length;)if(Jt=Ii(this,w),Jt==wn){ut==4&&(this.m=4,Xe(14),f=!1),Xt(this.i,this.l,null,"[Incomplete Response]");break}else if(Jt==cn){this.m=4,Xe(15),Xt(this.i,this.l,w,"[Invalid Chunk]"),f=!1;break}else Xt(this.i,this.l,Jt,null),Ws(this,Jt);if(Ai(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ut!=4||w.length!=0||this.h.h||(this.m=1,Xe(16),f=!1),this.o=this.o&&f,!f)Xt(this.i,this.l,w,"[Invalid Chunked Response]"),us(this),Es(this);else if(w.length>0&&!this.W){this.W=!0;var Ce=this.j;Ce.g==this&&Ce.aa&&!Ce.P&&(Ce.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),Ql(Ce),Ce.P=!0,Xe(11))}}else Xt(this.i,this.l,w,null),Ws(this,w);ut==4&&us(this),this.o&&!this.K&&(ut==4?Nu(this.j,this):(this.o=!1,ks(this)))}else fa(this.g),b==400&&w.indexOf("Unknown SID")>0?(this.m=3,Xe(12)):(this.m=0,Xe(13)),us(this),Es(this)}}}catch{}finally{}};function Hl(f){if(!Ai(f))return f.g.la();const b=Yn(f.g);if(b==="")return"";let w="";const P=b.length,te=yr(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return us(f),Es(f),"";f.h.i=new d.TextDecoder}for(let de=0;de<P;de++)f.h.h=!0,w+=f.h.i.decode(b[de],{stream:!(te&&de==P-1)});return b.length=0,f.h.g+=w,f.C=0,f.h.g}function Ai(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function Ii(f,b){var w=f.C,P=b.indexOf(`
`,w);return P==-1?wn:(w=Number(b.substring(w,P)),isNaN(w)?cn:(P+=1,P+w>b.length?wn:(b=b.slice(P,P+w),f.C=P+w,b)))}yn.prototype.cancel=function(){this.K=!0,us(this)};function ks(f){f.T=Date.now()+f.H,ia(f,f.H)}function ia(f,b){if(f.D!=null)throw Error("WatchDog timer not null");f.D=vt(y(f.aa,f),b)}function Ys(f){f.D&&(d.clearTimeout(f.D),f.D=null)}yn.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?($n(this.i,this.B),this.M!=2&&(st(),Xe(17)),us(this),this.m=2,Es(this)):ia(this,this.T-f)};function Es(f){f.j.I==0||f.K||Nu(f.j,f)}function us(f){Ys(f);var b=f.O;b&&typeof b.dispose=="function"&&b.dispose(),f.O=null,nt(f.V),f.g&&(b=f.g,f.g=null,b.abort(),b.dispose())}function Ws(f,b){try{var w=f.j;if(w.I!=0&&(w.g==f||Ks(w.h,f))){if(!f.L&&Ks(w.h,f)&&w.I==3){try{var P=w.Ba.g.parse(b)}catch{P=null}if(Array.isArray(P)&&P.length==3){var te=P;if(te[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<f.F)ko(w),Va(w);else break e;zi(w),Xe(18)}}else w.xa=te[1],0<w.xa-w.K&&te[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=vt(y(w.Va,w),6e3));Qs(w.h)<=1&&w.ta&&(w.ta=void 0)}else Br(w,11)}else if((f.L||w.g==f)&&ko(w),!O(b))for(te=w.Ba.g.parse(b),b=0;b<te.length;b++){let Lt=te[b];const Jt=Lt[0];if(!(Jt<=w.K))if(w.K=Jt,Lt=Lt[1],w.I==2)if(Lt[0]=="c"){w.M=Lt[1],w.ba=Lt[2];const er=Lt[3];er!=null&&(w.ka=er,w.j.info("VER="+w.ka));const Fr=Lt[4];Fr!=null&&(w.za=Fr,w.j.info("SVER="+w.za));const xr=Lt[5];xr!=null&&typeof xr=="number"&&xr>0&&(P=1.5*xr,w.O=P,w.j.info("backChannelRequestTimeoutMs_="+P)),P=w;const br=f.g;if(br){const Bi=br.g?br.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bi){var de=P.h;de.g||Bi.indexOf("spdy")==-1&&Bi.indexOf("quic")==-1&&Bi.indexOf("h2")==-1||(de.j=de.l,de.g=new Set,de.h&&(Ri(de,de.h),de.h=null))}if(P.G){const Lo=br.g?br.g.getResponseHeader("X-HTTP-Session-Id"):null;Lo&&(P.wa=Lo,Ot(P.J,P.G,Lo))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-f.F,w.j.info("Handshake RTT: "+w.T+"ms")),P=w;var Ce=f;if(P.na=Ou(P,P.L?P.ba:null,P.W),Ce.L){Oi(P.h,Ce);var ut=Ce,xn=P.O;xn&&(ut.H=xn),ut.D&&(Ys(ut),ks(ut)),P.g=Ce}else Au(P);w.i.length>0&&zr(w)}else Lt[0]!="stop"&&Lt[0]!="close"||Br(w,7);else w.I==3&&(Lt[0]=="stop"||Lt[0]=="close"?Lt[0]=="stop"?Br(w,7):Yl(w):Lt[0]!="noop"&&w.l&&w.l.qa(Lt),w.A=0)}}st(4)}catch{}}var un=class{constructor(f,b){this.g=f,this.map=b}};function Ni(f){this.l=f||10,d.PerformanceNavigationTiming?(f=d.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ci(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Qs(f){return f.h?1:f.g?f.g.size:0}function Ks(f,b){return f.h?f.h==b:f.g?f.g.has(b):!1}function Ri(f,b){f.g?f.g.add(b):f.h=b}function Oi(f,b){f.h&&f.h==b?f.h=null:f.g&&f.g.has(b)&&f.g.delete(b)}Ni.prototype.cancel=function(){if(this.i=ji(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function ji(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let b=f.i;for(const w of f.g.values())b=b.concat(w.G);return b}return I(f.i)}var ki=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Da(f,b){if(f){f=f.split("&");for(let w=0;w<f.length;w++){const P=f[w].indexOf("=");let te,de=null;P>=0?(te=f[w].substring(0,P),de=f[w].substring(P+1)):te=f[w],b(te,de?decodeURIComponent(de.replace(/\+/g," ")):"")}}}function ds(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;f instanceof ds?(this.l=f.l,Sn(this,f.j),this.o=f.o,this.g=f.g,Ur(this,f.u),this.h=f.h,Li(this,Ye(f.i)),this.m=f.m):f&&(b=String(f).match(ki))?(this.l=!1,Sn(this,b[1]||"",!0),this.o=Zs(b[2]||""),this.g=Zs(b[3]||"",!0),Ur(this,b[4]),this.h=Zs(b[5]||"",!0),Li(this,b[6]||"",!0),this.m=Zs(b[7]||"")):(this.l=!1,this.i=new ua(null,this.l))}ds.prototype.toString=function(){const f=[];var b=this.j;b&&f.push(Xs(b,la,!0),":");var w=this.g;return(w||b=="file")&&(f.push("//"),(b=this.o)&&f.push(Xs(b,la,!0),"@"),f.push(pr(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&f.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&f.push("/"),f.push(Xs(w,w.charAt(0)=="/"?Co:Mi,!0))),(w=this.i.toString())&&f.push("?",w),(w=this.m)&&f.push("#",Xs(w,Gl)),f.join("")},ds.prototype.resolve=function(f){const b=dn(this);let w=!!f.j;w?Sn(b,f.j):w=!!f.o,w?b.o=f.o:w=!!f.g,w?b.g=f.g:w=f.u!=null;var P=f.h;if(w)Ur(b,f.u);else if(w=!!f.h){if(P.charAt(0)!="/")if(this.g&&!this.h)P="/"+P;else{var te=b.h.lastIndexOf("/");te!=-1&&(P=b.h.slice(0,te+1)+P)}if(te=P,te==".."||te==".")P="";else if(te.indexOf("./")!=-1||te.indexOf("/.")!=-1){P=te.lastIndexOf("/",0)==0,te=te.split("/");const de=[];for(let Ce=0;Ce<te.length;){const ut=te[Ce++];ut=="."?P&&Ce==te.length&&de.push(""):ut==".."?((de.length>1||de.length==1&&de[0]!="")&&de.pop(),P&&Ce==te.length&&de.push("")):(de.push(ut),P=!0)}P=de.join("/")}else P=te}return w?b.h=P:w=f.i.toString()!=="",w?Li(b,Ye(f.i)):w=!!f.m,w&&(b.m=f.m),b};function dn(f){return new ds(f)}function Sn(f,b,w){f.j=w?Zs(b,!0):b,f.j&&(f.j=f.j.replace(/:$/,""))}function Ur(f,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);f.u=b}else f.u=null}function Li(f,b,w){b instanceof ua?(f.i=b,We(f.i,f.l)):(w||(b=Xs(b,ca)),f.i=new ua(b,f.l))}function Ot(f,b,w){f.i.set(b,w)}function oa(f){return Ot(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function Zs(f,b){return f?b?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Xs(f,b,w){return typeof f=="string"?(f=encodeURI(f).replace(b,ts),w&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function ts(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var la=/[#\/\?@]/g,Mi=/[#\?:]/g,Co=/[#\?]/g,ca=/[#\?@]/g,Gl=/#/g;function ua(f,b){this.h=this.g=null,this.i=f||null,this.j=!!b}function fs(f){f.g||(f.g=new Map,f.h=0,f.i&&Da(f.i,function(b,w){f.add(decodeURIComponent(b.replace(/\+/g," ")),w)}))}n=ua.prototype,n.add=function(f,b){fs(this),this.i=null,f=tt(this,f);let w=this.g.get(f);return w||this.g.set(f,w=[]),w.push(b),this.h+=1,this};function je(f,b){fs(f),b=tt(f,b),f.g.has(b)&&(f.i=null,f.h-=f.g.get(b).length,f.g.delete(b))}function ke(f,b){return fs(f),b=tt(f,b),f.g.has(b)}n.forEach=function(f,b){fs(this),this.g.forEach(function(w,P){w.forEach(function(te){f.call(b,te,P,this)},this)},this)};function $e(f,b){fs(f);let w=[];if(typeof b=="string")ke(f,b)&&(w=w.concat(f.g.get(tt(f,b))));else for(f=Array.from(f.g.values()),b=0;b<f.length;b++)w=w.concat(f[b]);return w}n.set=function(f,b){return fs(this),this.i=null,f=tt(this,f),ke(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[b]),this.h+=1,this},n.get=function(f,b){return f?(f=$e(this,f),f.length>0?String(f[0]):b):b};function qe(f,b,w){je(f,b),w.length>0&&(f.i=null,f.g.set(tt(f,b),I(w)),f.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],b=Array.from(this.g.keys());for(let P=0;P<b.length;P++){var w=b[P];const te=pr(w);w=$e(this,w);for(let de=0;de<w.length;de++){let Ce=te;w[de]!==""&&(Ce+="="+pr(w[de])),f.push(Ce)}}return this.i=f.join("&")};function Ye(f){const b=new ua;return b.i=f.i,f.g&&(b.g=new Map(f.g),b.h=f.h),b}function tt(f,b){return b=String(b),f.j&&(b=b.toLowerCase()),b}function We(f,b){b&&!f.j&&(fs(f),f.i=null,f.g.forEach(function(w,P){const te=P.toLowerCase();P!=te&&(je(this,P),qe(this,te,w))},f)),f.j=b}function jt(f,b){const w=new ln;if(d.Image){const P=new Image;P.onload=x(kt,w,"TestLoadImage: loaded",!0,b,P),P.onerror=x(kt,w,"TestLoadImage: error",!1,b,P),P.onabort=x(kt,w,"TestLoadImage: abort",!1,b,P),P.ontimeout=x(kt,w,"TestLoadImage: timeout",!1,b,P),d.setTimeout(function(){P.ontimeout&&P.ontimeout()},1e4),P.src=f}else b(!1)}function Ln(f,b){const w=new ln,P=new AbortController,te=setTimeout(()=>{P.abort(),kt(w,"TestPingServer: timeout",!1,b)},1e4);fetch(f,{signal:P.signal}).then(de=>{clearTimeout(te),de.ok?kt(w,"TestPingServer: ok",!0,b):kt(w,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(te),kt(w,"TestPingServer: error",!1,b)})}function kt(f,b,w,P,te){try{te&&(te.onload=null,te.onerror=null,te.onabort=null,te.ontimeout=null),P(w)}catch{}}function fn(){this.g=new Pt}function Mn(f){this.i=f.Sb||null,this.h=f.ab||!1}v(Mn,Os),Mn.prototype.g=function(){return new mr(this.i,this.h)};function mr(f,b){Ue.call(this),this.H=f,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(mr,Ue),n=mr.prototype,n.open=function(f,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=b,this.readyState=1,gr(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(b.body=f),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ua(this)),this.readyState=0},n.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,gr(this)),this.g&&(this.readyState=3,gr(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ro(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ro(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}n.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var b=f.value?f.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!f.done}))&&(this.response=this.responseText+=b)}f.done?Ua(this):gr(this),this.readyState==3&&Ro(this)}},n.Oa=function(f){this.g&&(this.response=this.responseText=f,Ua(this))},n.Na=function(f){this.g&&(this.response=f,Ua(this))},n.ga=function(){this.g&&Ua(this)};function Ua(f){f.readyState=4,f.l=null,f.j=null,f.B=null,gr(f)}n.setRequestHeader=function(f,b){this.A.append(f,b)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],b=this.h.entries();for(var w=b.next();!w.done;)w=w.value,f.push(w[0]+": "+w[1]),w=b.next();return f.join(`\r
`)};function gr(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(mr.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Js(f){let b="";return Q(f,function(w,P){b+=P,b+=":",b+=w,b+=`\r
`}),b}function Di(f,b,w){e:{for(P in w){var P=!1;break e}P=!0}P||(w=Js(w),typeof f=="string"?w!=null&&pr(w):Ot(f,b,w))}function Bt(f){Ue.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(Bt,Ue);var Pr=/^https?$/i,ql=["POST","PUT"];n=Bt.prototype,n.Fa=function(f){this.H=f},n.ea=function(f,b,w,P){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);b=b?b.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Dr.g(),this.g.onreadystatechange=S(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(f),!0),this.B=!1}catch(de){Ui(this,de);return}if(f=w||"",w=new Map(this.headers),P)if(Object.getPrototypeOf(P)===Object.prototype)for(var te in P)w.set(te,P[te]);else if(typeof P.keys=="function"&&typeof P.get=="function")for(const de of P.keys())w.set(de,P.get(de));else throw Error("Unknown input type for opt_headers: "+String(P));P=Array.from(w.keys()).find(de=>de.toLowerCase()=="content-type"),te=d.FormData&&f instanceof d.FormData,!(Array.prototype.indexOf.call(ql,b,void 0)>=0)||P||te||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[de,Ce]of w)this.g.setRequestHeader(de,Ce);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(de){Ui(this,de)}};function Ui(f,b){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=b,f.o=5,$l(f),da(f)}function $l(f){f.A||(f.A=!0,Ke(f,"complete"),Ke(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,Ke(this,"complete"),Ke(this,"abort"),da(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),da(this,!0)),Bt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Pi(this):this.Xa())},n.Xa=function(){Pi(this)};function Pi(f){if(f.h&&typeof l<"u"){if(f.v&&yr(f)==4)setTimeout(f.Ca.bind(f),0);else if(Ke(f,"readystatechange"),yr(f)==4){f.h=!1;try{const de=f.ca();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var w;if(!(w=b)){var P;if(P=de===0){let Ce=String(f.D).match(ki)[1]||null;!Ce&&d.self&&d.self.location&&(Ce=d.self.location.protocol.slice(0,-1)),P=!Pr.test(Ce?Ce.toLowerCase():"")}w=P}if(w)Ke(f,"complete"),Ke(f,"success");else{f.o=6;try{var te=yr(f)>2?f.g.statusText:""}catch{te=""}f.l=te+" ["+f.ca()+"]",$l(f)}}finally{da(f)}}}}function da(f,b){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const w=f.g;f.g=null,b||Ke(f,"ready");try{w.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function yr(f){return f.g?f.g.readyState:0}n.ca=function(){try{return yr(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(f){if(this.g){var b=this.g.responseText;return f&&b.indexOf(f)==0&&(b=b.substring(f.length)),qt(b)}};function Yn(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function fa(f){const b={};f=(f.g&&yr(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let P=0;P<f.length;P++){if(O(f[P]))continue;var w=js(f[P]);const te=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const de=b[te]||[];b[te]=de,de.push(w)}X(b,function(P){return P.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vr(f,b,w){return w&&w.internalChannelParams&&w.internalChannelParams[f]||b}function Pa(f){this.za=0,this.i=[],this.j=new ln,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Vr("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Vr("baseRetryDelayMs",5e3,f),this.Za=Vr("retryDelaySeedMs",1e4,f),this.Ta=Vr("forwardChannelMaxRetries",2,f),this.va=Vr("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new Ni(f&&f.concurrentRequestLimit),this.Ba=new fn,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Pa.prototype,n.ka=8,n.I=1,n.connect=function(f,b,w,P){Xe(0),this.W=f,this.H=b||{},w&&P!==void 0&&(this.H.OSID=w,this.H.OAID=P),this.F=this.X,this.J=Ou(this,null,this.W),zr(this)};function Yl(f){if(Oo(f),f.I==3){var b=f.V++,w=dn(f.J);if(Ot(w,"SID",f.M),Ot(w,"RID",b),Ot(w,"TYPE","terminate"),Vi(f,w),b=new yn(f,f.j,b),b.M=2,b.A=oa(dn(w)),w=!1,d.navigator&&d.navigator.sendBeacon)try{w=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!w&&d.Image&&(new Image().src=b.A,w=!0),w||(b.g=ju(b.j,null),b.g.ea(b.A)),b.F=Date.now(),ks(b)}Ru(f)}function Va(f){f.g&&(Ql(f),f.g.cancel(),f.g=null)}function Oo(f){Va(f),f.v&&(d.clearTimeout(f.v),f.v=null),ko(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&d.clearTimeout(f.m),f.m=null)}function zr(f){if(!Ci(f.h)&&!f.m){f.m=!0;var b=f.Ea;q||T(),Y||(q(),Y=!0),A.add(b,f),f.D=0}}function jo(f,b){return Qs(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=b.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=vt(y(f.Ea,f,b),Cu(f,f.D)),f.D++,!0)}n.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const te=new yn(this,this.j,f);let de=this.o;if(this.U&&(de?(de=j(de),$(de,this.U)):de=this.U),this.u!==null||this.R||(te.J=de,de=null),this.S)e:{for(var b=0,w=0;w<this.i.length;w++){t:{var P=this.i[w];if("__data__"in P.map&&(P=P.map.__data__,typeof P=="string")){P=P.length;break t}P=void 0}if(P===void 0)break;if(b+=P,b>4096){b=w;break e}if(b===4096||w===this.i.length-1){b=w+1;break e}}b=1e3}else b=1e3;b=Tu(this,te,b),w=dn(this.J),Ot(w,"RID",f),Ot(w,"CVER",22),this.G&&Ot(w,"X-HTTP-Session-Id",this.G),Vi(this,w),de&&(this.R?b="headers="+pr(Js(de))+"&"+b:this.u&&Di(w,this.u,de)),Ri(this.h,te),this.Ra&&Ot(w,"TYPE","init"),this.S?(Ot(w,"$req",b),Ot(w,"SID","null"),te.U=!0,$s(te,w,null)):$s(te,w,b),this.I=2}}else this.I==3&&(f?Wl(this,f):this.i.length==0||Ci(this.h)||Wl(this))};function Wl(f,b){var w;b?w=b.l:w=f.V++;const P=dn(f.J);Ot(P,"SID",f.M),Ot(P,"RID",w),Ot(P,"AID",f.K),Vi(f,P),f.u&&f.o&&Di(P,f.u,f.o),w=new yn(f,f.j,w,f.D+1),f.u===null&&(w.J=f.o),b&&(f.i=b.G.concat(f.i)),b=Tu(f,w,1e3),w.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),Ri(f.h,w),$s(w,P,b)}function Vi(f,b){f.H&&Q(f.H,function(w,P){Ot(b,P,w)}),f.l&&Q({},function(w,P){Ot(b,P,w)})}function Tu(f,b,w){w=Math.min(f.i.length,w);const P=f.l?y(f.l.Ka,f.l,f):null;e:{var te=f.i;let ut=-1;for(;;){const xn=["count="+w];ut==-1?w>0?(ut=te[0].g,xn.push("ofs="+ut)):ut=0:xn.push("ofs="+ut);let Lt=!0;for(let Jt=0;Jt<w;Jt++){var de=te[Jt].g;const er=te[Jt].map;if(de-=ut,de<0)ut=Math.max(0,te[Jt].g-100),Lt=!1;else try{de="req"+de+"_"||"";try{var Ce=er instanceof Map?er:Object.entries(er);for(const[Fr,xr]of Ce){let br=xr;p(xr)&&(br=pt(xr)),xn.push(de+Fr+"="+encodeURIComponent(br))}}catch(Fr){throw xn.push(de+"type="+encodeURIComponent("_badmap")),Fr}}catch{P&&P(er)}}if(Lt){Ce=xn.join("&");break e}}Ce=void 0}return f=f.i.splice(0,w),b.G=f,Ce}function Au(f){if(!f.g&&!f.v){f.Y=1;var b=f.Da;q||T(),Y||(q(),Y=!0),A.add(b,f),f.A=0}}function zi(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=vt(y(f.Da,f),Cu(f,f.A)),f.A++,!0)}n.Da=function(){if(this.v=null,Iu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=vt(y(this.Wa,this),f)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Xe(10),Va(this),Iu(this))};function Ql(f){f.B!=null&&(d.clearTimeout(f.B),f.B=null)}function Iu(f){f.g=new yn(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var b=dn(f.na);Ot(b,"RID","rpc"),Ot(b,"SID",f.M),Ot(b,"AID",f.K),Ot(b,"CI",f.F?"0":"1"),!f.F&&f.ia&&Ot(b,"TO",f.ia),Ot(b,"TYPE","xmlhttp"),Vi(f,b),f.u&&f.o&&Di(b,f.u,f.o),f.O&&(f.g.H=f.O);var w=f.g;f=f.ba,w.M=1,w.A=oa(dn(b)),w.u=null,w.R=!0,aa(w,f)}n.Va=function(){this.C!=null&&(this.C=null,Va(this),zi(this),Xe(19))};function ko(f){f.C!=null&&(d.clearTimeout(f.C),f.C=null)}function Nu(f,b){var w=null;if(f.g==b){ko(f),Ql(f),f.g=null;var P=2}else if(Ks(f.h,b))w=b.G,Oi(f.h,b),P=1;else return;if(f.I!=0){if(b.o)if(P==1){w=b.u?b.u.length:0,b=Date.now()-b.F;var te=f.D;P=rt(),Ke(P,new Dt(P,w)),zr(f)}else Au(f);else if(te=b.m,te==3||te==0&&b.X>0||!(P==1&&jo(f,b)||P==2&&zi(f)))switch(w&&w.length>0&&(b=f.h,b.i=b.i.concat(w)),te){case 1:Br(f,5);break;case 4:Br(f,10);break;case 3:Br(f,6);break;default:Br(f,2)}}}function Cu(f,b){let w=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(w*=2),w*b}function Br(f,b){if(f.j.info("Error code "+b),b==2){var w=y(f.bb,f),P=f.Ua;const te=!P;P=new ds(P||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Sn(P,"https"),oa(P),te?jt(P.toString(),w):Ln(P.toString(),w)}else Xe(2);f.I=0,f.l&&f.l.pa(b),Ru(f),Oo(f)}n.bb=function(f){f?(this.j.info("Successfully pinged google.com"),Xe(2)):(this.j.info("Failed to ping google.com"),Xe(1))};function Ru(f){if(f.I=0,f.ja=[],f.l){const b=ji(f.h);(b.length!=0||f.i.length!=0)&&(z(f.ja,b),z(f.ja,f.i),f.h.i.length=0,I(f.i),f.i.length=0),f.l.oa()}}function Ou(f,b,w){var P=w instanceof ds?dn(w):new ds(w);if(P.g!="")b&&(P.g=b+"."+P.g),Ur(P,P.u);else{var te=d.location;P=te.protocol,b=b?b+"."+te.hostname:te.hostname,te=+te.port;const de=new ds(null);P&&Sn(de,P),b&&(de.g=b),te&&Ur(de,te),w&&(de.h=w),P=de}return w=f.G,b=f.wa,w&&b&&Ot(P,w,b),Ot(P,"VER",f.ka),Vi(f,P),P}function ju(f,b,w){if(b&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=f.Aa&&!f.ma?new Bt(new Mn({ab:w})):new Bt(f.ma),b.Fa(f.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ku(){}n=ku.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function za(){}za.prototype.g=function(f,b){return new hs(f,b)};function hs(f,b){Ue.call(this),this.g=new Pa(b),this.l=f,this.h=b&&b.messageUrlParams||null,f=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(f?f["X-WebChannel-Content-Type"]=b.messageContentType:f={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(f?f["X-WebChannel-Client-Profile"]=b.sa:f={"X-WebChannel-Client-Profile":b.sa}),this.g.U=f,(f=b&&b.Qb)&&!O(f)&&(this.g.u=f),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!O(b)&&(this.g.G=b,f=this.h,f!==null&&b in f&&(f=this.h,b in f&&delete f[b])),this.j=new ha(this)}v(hs,Ue),hs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},hs.prototype.close=function(){Yl(this.g)},hs.prototype.o=function(f){var b=this.g;if(typeof f=="string"){var w={};w.__data__=f,f=w}else this.v&&(w={},w.__data__=pt(f),f=w);b.i.push(new un(b.Ya++,f)),b.I==3&&zr(b)},hs.prototype.N=function(){this.g.l=null,delete this.j,Yl(this.g),delete this.g,hs.Z.N.call(this)};function Lu(f){be.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var b=f.__sm__;if(b){e:{for(const w in b){f=w;break e}f=void 0}(this.i=f)&&(f=this.i,b=b!==null&&f in b?b[f]:void 0),this.data=b}else this.data=f}v(Lu,be);function Mu(){Le.call(this),this.status=1}v(Mu,Le);function ha(f){this.g=f}v(ha,ku),ha.prototype.ra=function(){Ke(this.g,"a")},ha.prototype.qa=function(f){Ke(this.g,new Lu(f))},ha.prototype.pa=function(f){Ke(this.g,new Mu)},ha.prototype.oa=function(){Ke(this.g,"b")},za.prototype.createWebChannel=za.prototype.g,hs.prototype.send=hs.prototype.o,hs.prototype.open=hs.prototype.m,hs.prototype.close=hs.prototype.close,ES=function(){return new za},_S=function(){return rt()},vS=Ne,eg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},qs.NO_ERROR=0,qs.TIMEOUT=8,qs.HTTP_ERROR=6,tf=qs,sa.COMPLETE="complete",bS=sa,kn.EventType=Zt,Zt.OPEN="a",Zt.CLOSE="b",Zt.ERROR="c",Zt.MESSAGE="d",Ue.prototype.listen=Ue.prototype.J,Uc=kn,Bt.prototype.listenOnce=Bt.prototype.K,Bt.prototype.getLastError=Bt.prototype.Ha,Bt.prototype.getLastErrorCode=Bt.prototype.ya,Bt.prototype.getStatus=Bt.prototype.ca,Bt.prototype.getResponseJson=Bt.prototype.La,Bt.prototype.getResponseText=Bt.prototype.la,Bt.prototype.send=Bt.prototype.ea,Bt.prototype.setWithCredentials=Bt.prototype.Fa,xS=Bt}).apply(typeof zd<"u"?zd:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}is.UNAUTHENTICATED=new is(null),is.GOOGLE_CREDENTIALS=new is("google-credentials-uid"),is.FIRST_PARTY=new is("first-party-uid"),is.MOCK_USER=new is("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zl="12.9.0";function _R(n){zl=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const So=new dS("@firebase/firestore");function hl(){return So.logLevel}function ze(n,...e){if(So.logLevel<=St.DEBUG){const s=e.map(r0);So.debug(`Firestore (${zl}): ${n}`,...s)}}function Ma(n,...e){if(So.logLevel<=St.ERROR){const s=e.map(r0);So.error(`Firestore (${zl}): ${n}`,...s)}}function To(n,...e){if(So.logLevel<=St.WARN){const s=e.map(r0);So.warn(`Firestore (${zl}): ${n}`,...s)}}function r0(n){if(typeof n=="string")return n;try{return(function(s){return JSON.stringify(s)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ot(n,e,s){let a="Unexpected state";typeof e=="string"?a=e:s=e,wS(n,a,s)}function wS(n,e,s){let a=`FIRESTORE (${zl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(s!==void 0)try{a+=" CONTEXT: "+JSON.stringify(s)}catch{a+=" CONTEXT: "+s}throw Ma(a),new Error(a)}function rn(n,e,s,a){let o="Unexpected state";typeof s=="string"?o=s:a=s,n||wS(e,o,a)}function At(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Qe extends Vl{constructor(e,s){super(e,s),this.code=e,this.message=s,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(){this.promise=new Promise(((e,s)=>{this.resolve=e,this.reject=s}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SS{constructor(e,s){this.user=s,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ER{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,s){e.enqueueRetryable((()=>s(is.UNAUTHENTICATED)))}shutdown(){}}class wR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,s){this.changeListener=s,e.enqueueRetryable((()=>s(this.token.user)))}shutdown(){this.changeListener=null}}class SR{constructor(e){this.t=e,this.currentUser=is.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,s){rn(this.o===void 0,42304);let a=this.i;const o=m=>this.i!==a?(a=this.i,s(m)):Promise.resolve();let l=new ho;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new ho,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await o(this.currentUser)}))},p=m=>{ze("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((m=>p(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?p(m):(ze("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new ho)}}),0),d()}getToken(){const e=this.i,s=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(s).then((a=>this.i!==e?(ze("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(rn(typeof a.accessToken=="string",31837,{l:a}),new SS(a.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return rn(e===null||typeof e=="string",2055,{h:e}),new is(e)}}class TR{constructor(e,s,a){this.P=e,this.T=s,this.I=a,this.type="FirstParty",this.user=is.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class AR{constructor(e,s,a){this.P=e,this.T=s,this.I=a}getToken(){return Promise.resolve(new TR(this.P,this.T,this.I))}start(e,s){e.enqueueRetryable((()=>s(is.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Pv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class IR{constructor(e,s){this.V=s,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,rR(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,s){rn(this.o===void 0,3512);const a=l=>{l.error!=null&&ze("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,ze("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?s(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>a(l)))};const o=l=>{ze("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>o(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?o(l):ze("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Pv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((s=>s?(rn(typeof s.token=="string",44558,{tokenResult:s}),this.m=s.token,new Pv(s.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),s=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(s);else for(let a=0;a<n;a++)s[a]=Math.floor(256*Math.random());return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=62*Math.floor(4.129032258064516);let a="";for(;a.length<20;){const o=NR(40);for(let l=0;l<o.length;++l)a.length<20&&o[l]<s&&(a+=e.charAt(o[l]%62))}return a}}function Et(n,e){return n<e?-1:n>e?1:0}function tg(n,e){const s=Math.min(n.length,e.length);for(let a=0;a<s;a++){const o=n.charAt(a),l=e.charAt(a);if(o!==l)return am(o)===am(l)?Et(o,l):am(o)?1:-1}return Et(n.length,e.length)}const CR=55296,RR=57343;function am(n){const e=n.charCodeAt(0);return e>=CR&&e<=RR}function kl(n,e,s){return n.length===e.length&&n.every(((a,o)=>s(a,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv="__name__";class Wr{constructor(e,s,a){s===void 0?s=0:s>e.length&&ot(637,{offset:s,range:e.length}),a===void 0?a=e.length-s:a>e.length-s&&ot(1746,{length:a,range:e.length-s}),this.segments=e,this.offset=s,this.len=a}get length(){return this.len}isEqual(e){return Wr.comparator(this,e)===0}child(e){const s=this.segments.slice(this.offset,this.limit());return e instanceof Wr?e.forEach((a=>{s.push(a)})):s.push(e),this.construct(s)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}forEach(e){for(let s=this.offset,a=this.limit();s<a;s++)e(this.segments[s])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,s){const a=Math.min(e.length,s.length);for(let o=0;o<a;o++){const l=Wr.compareSegments(e.get(o),s.get(o));if(l!==0)return l}return Et(e.length,s.length)}static compareSegments(e,s){const a=Wr.isNumericId(e),o=Wr.isNumericId(s);return a&&!o?-1:!a&&o?1:a&&o?Wr.extractNumericId(e).compare(Wr.extractNumericId(s)):tg(e,s)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return mi.fromString(e.substring(4,e.length-2))}}class sn extends Wr{construct(e,s,a){return new sn(e,s,a)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const s=[];for(const a of e){if(a.indexOf("//")>=0)throw new Qe(Re.INVALID_ARGUMENT,`Invalid segment (${a}). Paths must not contain // in them.`);s.push(...a.split("/").filter((o=>o.length>0)))}return new sn(s)}static emptyPath(){return new sn([])}}const OR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gs extends Wr{construct(e,s,a){return new gs(e,s,a)}static isValidIdentifier(e){return OR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gs.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Vv}static keyField(){return new gs([Vv])}static fromServerFormat(e){const s=[];let a="",o=0;const l=()=>{if(a.length===0)throw new Qe(Re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);s.push(a),a=""};let d=!1;for(;o<e.length;){const p=e[o];if(p==="\\"){if(o+1===e.length)throw new Qe(Re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[o+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Qe(Re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);a+=m,o+=2}else p==="`"?(d=!d,o++):p!=="."||d?(a+=p,o++):(l(),o++)}if(l(),d)throw new Qe(Re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gs(s)}static emptyPath(){return new gs([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e){this.path=e}static fromPath(e){return new et(sn.fromString(e))}static fromName(e){return new et(sn.fromString(e).popFirst(5))}static empty(){return new et(sn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&sn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,s){return sn.comparator(e.path,s.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new et(new sn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jR(n,e,s){if(!s)throw new Qe(Re.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function kR(n,e,s,a){if(e===!0&&a===!0)throw new Qe(Re.INVALID_ARGUMENT,`${n} and ${s} cannot be used together.`)}function zv(n){if(!et.isDocumentKey(n))throw new Qe(Re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function LR(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function MR(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(a){return a.constructor?a.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ot(12329,{type:typeof n})}function ng(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Qe(Re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const s=MR(n);throw new Qe(Re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${s}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function On(n,e){const s={typeString:n};return e&&(s.value=e),s}function xu(n,e){if(!LR(n))throw new Qe(Re.INVALID_ARGUMENT,"JSON must be an object");let s;for(const a in e)if(e[a]){const o=e[a].typeString,l="value"in e[a]?{value:e[a].value}:void 0;if(!(a in n)){s=`JSON missing required field: '${a}'`;break}const d=n[a];if(o&&typeof d!==o){s=`JSON field '${a}' must be a ${o}.`;break}if(l!==void 0&&d!==l.value){s=`Expected '${a}' field to equal '${l.value}'`;break}}if(s)throw new Qe(Re.INVALID_ARGUMENT,s);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bv=-62135596800,Fv=1e6;class Rn{static now(){return Rn.fromMillis(Date.now())}static fromDate(e){return Rn.fromMillis(e.getTime())}static fromMillis(e){const s=Math.floor(e/1e3),a=Math.floor((e-1e3*s)*Fv);return new Rn(s,a)}constructor(e,s){if(this.seconds=e,this.nanoseconds=s,s<0)throw new Qe(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(s>=1e9)throw new Qe(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(e<Bv)throw new Qe(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Qe(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Fv}_compareTo(e){return this.seconds===e.seconds?Et(this.nanoseconds,e.nanoseconds):Et(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Rn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(xu(e,Rn._jsonSchema))return new Rn(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Bv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Rn._jsonSchemaVersion="firestore/timestamp/1.0",Rn._jsonSchema={type:On("string",Rn._jsonSchemaVersion),seconds:On("number"),nanoseconds:On("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{static fromTimestamp(e){return new it(e)}static min(){return new it(new Rn(0,0))}static max(){return new it(new Rn(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lu=-1;function DR(n,e){const s=n.toTimestamp().seconds,a=n.toTimestamp().nanoseconds+1,o=it.fromTimestamp(a===1e9?new Rn(s+1,0):new Rn(s,a));return new vi(o,et.empty(),e)}function UR(n){return new vi(n.readTime,n.key,lu)}class vi{constructor(e,s,a){this.readTime=e,this.documentKey=s,this.largestBatchId=a}static min(){return new vi(it.min(),et.empty(),lu)}static max(){return new vi(it.max(),et.empty(),lu)}}function PR(n,e){let s=n.readTime.compareTo(e.readTime);return s!==0?s:(s=et.comparator(n.documentKey,e.documentKey),s!==0?s:Et(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class zR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kf(n){if(n.code!==Re.FAILED_PRECONDITION||n.message!==VR)throw n;ze("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Te{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((s=>{this.isDone=!0,this.result=s,this.nextCallback&&this.nextCallback(s)}),(s=>{this.isDone=!0,this.error=s,this.catchCallback&&this.catchCallback(s)}))}catch(e){return this.next(void 0,e)}next(e,s){return this.callbackAttached&&ot(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(s,this.error):this.wrapSuccess(e,this.result):new Te(((a,o)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(a,o)},this.catchCallback=l=>{this.wrapFailure(s,l).next(a,o)}}))}toPromise(){return new Promise(((e,s)=>{this.next(e,s)}))}wrapUserFunction(e){try{const s=e();return s instanceof Te?s:Te.resolve(s)}catch(s){return Te.reject(s)}}wrapSuccess(e,s){return e?this.wrapUserFunction((()=>e(s))):Te.resolve(s)}wrapFailure(e,s){return e?this.wrapUserFunction((()=>e(s))):Te.reject(s)}static resolve(e){return new Te(((s,a)=>{s(e)}))}static reject(e){return new Te(((s,a)=>{a(e)}))}static waitFor(e){return new Te(((s,a)=>{let o=0,l=0,d=!1;e.forEach((p=>{++o,p.next((()=>{++l,d&&l===o&&s()}),(m=>a(m)))})),d=!0,l===o&&s()}))}static or(e){let s=Te.resolve(!1);for(const a of e)s=s.next((o=>o?Te.resolve(o):a()));return s}static forEach(e,s){const a=[];return e.forEach(((o,l)=>{a.push(s.call(this,o,l))})),this.waitFor(a)}static mapArray(e,s){return new Te(((a,o)=>{const l=e.length,d=new Array(l);let p=0;for(let m=0;m<l;m++){const y=m;s(e[y]).next((x=>{d[y]=x,++p,p===l&&a(d)}),(x=>o(x)))}}))}static doWhile(e,s){return new Te(((a,o)=>{const l=()=>{e()===!0?s().next((()=>{l()}),o):a()};l()}))}}function BR(n){const e=n.match(/Android ([\d.]+)/i),s=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(s)}function Bl(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(e,s){this.previousValue=e,s&&(s.sequenceNumberHandler=a=>this.ae(a),this.ue=a=>s.writeSequenceNumber(a))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Lf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR=-1;function Mf(n){return n==null}function sg(n){return n===0&&1/n==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TS="";function HR(n){let e="";for(let s=0;s<n.length;s++)e.length>0&&(e=Hv(e)),e=GR(n.get(s),e);return Hv(e)}function GR(n,e){let s=e;const a=n.length;for(let o=0;o<a;o++){const l=n.charAt(o);switch(l){case"\0":s+="";break;case TS:s+="";break;default:s+=l}}return s}function Hv(n){return n+TS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gv(n){let e=0;for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&e++;return e}function bu(n,e){for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&e(s,n[s])}function qR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class En{constructor(e,s){this.comparator=e,this.root=s||Xn.EMPTY}insert(e,s){return new En(this.comparator,this.root.insert(e,s,this.comparator).copy(null,null,Xn.BLACK,null,null))}remove(e){return new En(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xn.BLACK,null,null))}get(e){let s=this.root;for(;!s.isEmpty();){const a=this.comparator(e,s.key);if(a===0)return s.value;a<0?s=s.left:a>0&&(s=s.right)}return null}indexOf(e){let s=0,a=this.root;for(;!a.isEmpty();){const o=this.comparator(e,a.key);if(o===0)return s+a.left.size;o<0?a=a.left:(s+=a.left.size+1,a=a.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((s,a)=>(e(s,a),!1)))}toString(){const e=[];return this.inorderTraversal(((s,a)=>(e.push(`${s}:${a}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bd(this.root,e,this.comparator,!0)}}class Bd{constructor(e,s,a,o){this.isReverse=o,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=s?a(e.key,s):1,s&&o&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const s={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return s}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xn{constructor(e,s,a,o,l){this.key=e,this.value=s,this.color=a??Xn.RED,this.left=o??Xn.EMPTY,this.right=l??Xn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,s,a,o,l){return new Xn(e??this.key,s??this.value,a??this.color,o??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,s,a){let o=this;const l=a(e,o.key);return o=l<0?o.copy(null,null,null,o.left.insert(e,s,a),null):l===0?o.copy(null,s,null,null,null):o.copy(null,null,null,null,o.right.insert(e,s,a)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Xn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,s){let a,o=this;if(s(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,s),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),s(e,o.key)===0){if(o.right.isEmpty())return Xn.EMPTY;a=o.right.min(),o=o.copy(a.key,a.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,s))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,s)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ot(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ot(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ot(27949);return e+(this.isRed()?0:1)}}Xn.EMPTY=null,Xn.RED=!0,Xn.BLACK=!1;Xn.EMPTY=new class{constructor(){this.size=0}get key(){throw ot(57766)}get value(){throw ot(16141)}get color(){throw ot(16727)}get left(){throw ot(29726)}get right(){throw ot(36894)}copy(e,s,a,o,l){return this}insert(e,s,a){return new Xn(e,s)}remove(e,s){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zn{constructor(e){this.comparator=e,this.data=new En(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((s,a)=>(e(s),!1)))}forEachInRange(e,s){const a=this.data.getIteratorFrom(e[0]);for(;a.hasNext();){const o=a.getNext();if(this.comparator(o.key,e[1])>=0)return;s(o.key)}}forEachWhile(e,s){let a;for(a=s!==void 0?this.data.getIteratorFrom(s):this.data.getIterator();a.hasNext();)if(!e(a.getNext().key))return}firstAfterOrEqual(e){const s=this.data.getIteratorFrom(e);return s.hasNext()?s.getNext().key:null}getIterator(){return new qv(this.data.getIterator())}getIteratorFrom(e){return new qv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let s=this;return s.size<e.size&&(s=e,e=this),e.forEach((a=>{s=s.add(a)})),s}isEqual(e){if(!(e instanceof zn)||this.size!==e.size)return!1;const s=this.data.getIterator(),a=e.data.getIterator();for(;s.hasNext();){const o=s.getNext().key,l=a.getNext().key;if(this.comparator(o,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((s=>{e.push(s)})),e}toString(){const e=[];return this.forEach((s=>e.push(s))),"SortedSet("+e.toString()+")"}copy(e){const s=new zn(this.comparator);return s.data=e,s}}class qv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e){this.fields=e,e.sort(gs.comparator)}static empty(){return new ci([])}unionWith(e){let s=new zn(gs.comparator);for(const a of this.fields)s=s.add(a);for(const a of e)s=s.add(a);return new ci(s.toArray())}covers(e){for(const s of this.fields)if(s.isPrefixOf(e))return!0;return!1}isEqual(e){return kl(this.fields,e.fields,((s,a)=>s.isEqual(a)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.binaryString=e}static fromBase64String(e){const s=(function(o){try{return atob(o)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new AS("Invalid base64 string: "+l):l}})(e);return new Jn(s)}static fromUint8Array(e){const s=(function(o){let l="";for(let d=0;d<o.length;++d)l+=String.fromCharCode(o[d]);return l})(e);return new Jn(s)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(s){return btoa(s)})(this.binaryString)}toUint8Array(){return(function(s){const a=new Uint8Array(s.length);for(let o=0;o<s.length;o++)a[o]=s.charCodeAt(o);return a})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Et(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jn.EMPTY_BYTE_STRING=new Jn("");const $R=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _i(n){if(rn(!!n,39018),typeof n=="string"){let e=0;const s=$R.exec(n);if(rn(!!s,46558,{timestamp:n}),s[1]){let o=s[1];o=(o+"000000000").substr(0,9),e=Number(o)}const a=new Date(n);return{seconds:Math.floor(a.getTime()/1e3),nanos:e}}return{seconds:_n(n.seconds),nanos:_n(n.nanos)}}function _n(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ei(n){return typeof n=="string"?Jn.fromBase64String(n):Jn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IS="server_timestamp",NS="__type__",CS="__previous_value__",RS="__local_write_time__";function i0(n){var s,a;return((a=(((s=n==null?void 0:n.mapValue)==null?void 0:s.fields)||{})[NS])==null?void 0:a.stringValue)===IS}function Df(n){const e=n.mapValue.fields[CS];return i0(e)?Df(e):e}function cu(n){const e=_i(n.mapValue.fields[RS].timestampValue);return new Rn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(e,s,a,o,l,d,p,m,y,x,v){this.databaseId=e,this.appId=s,this.persistenceKey=a,this.host=o,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=p,this.longPollingOptions=m,this.useFetchStreams=y,this.isUsingEmulator=x,this.apiKey=v}}const mf="(default)";class uu{constructor(e,s){this.projectId=e,this.database=s||mf}static empty(){return new uu("","")}get isDefaultDatabase(){return this.database===mf}isEqual(e){return e instanceof uu&&e.projectId===this.projectId&&e.database===this.database}}function WR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Qe(Re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new uu(n.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR="__type__",KR="__max__",Fd={mapValue:{}},ZR="__vector__",rg="value";function wi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?i0(n)?4:JR(n)?9007199254740991:XR(n)?10:11:ot(28295,{value:n})}function ea(n,e){if(n===e)return!0;const s=wi(n);if(s!==wi(e))return!1;switch(s){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return cu(n).isEqual(cu(e));case 3:return(function(o,l){if(typeof o.timestampValue=="string"&&typeof l.timestampValue=="string"&&o.timestampValue.length===l.timestampValue.length)return o.timestampValue===l.timestampValue;const d=_i(o.timestampValue),p=_i(l.timestampValue);return d.seconds===p.seconds&&d.nanos===p.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,l){return Ei(o.bytesValue).isEqual(Ei(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,l){return _n(o.geoPointValue.latitude)===_n(l.geoPointValue.latitude)&&_n(o.geoPointValue.longitude)===_n(l.geoPointValue.longitude)})(n,e);case 2:return(function(o,l){if("integerValue"in o&&"integerValue"in l)return _n(o.integerValue)===_n(l.integerValue);if("doubleValue"in o&&"doubleValue"in l){const d=_n(o.doubleValue),p=_n(l.doubleValue);return d===p?sg(d)===sg(p):isNaN(d)&&isNaN(p)}return!1})(n,e);case 9:return kl(n.arrayValue.values||[],e.arrayValue.values||[],ea);case 10:case 11:return(function(o,l){const d=o.mapValue.fields||{},p=l.mapValue.fields||{};if(Gv(d)!==Gv(p))return!1;for(const m in d)if(d.hasOwnProperty(m)&&(p[m]===void 0||!ea(d[m],p[m])))return!1;return!0})(n,e);default:return ot(52216,{left:n})}}function du(n,e){return(n.values||[]).find((s=>ea(s,e)))!==void 0}function Ll(n,e){if(n===e)return 0;const s=wi(n),a=wi(e);if(s!==a)return Et(s,a);switch(s){case 0:case 9007199254740991:return 0;case 1:return Et(n.booleanValue,e.booleanValue);case 2:return(function(l,d){const p=_n(l.integerValue||l.doubleValue),m=_n(d.integerValue||d.doubleValue);return p<m?-1:p>m?1:p===m?0:isNaN(p)?isNaN(m)?0:-1:1})(n,e);case 3:return $v(n.timestampValue,e.timestampValue);case 4:return $v(cu(n),cu(e));case 5:return tg(n.stringValue,e.stringValue);case 6:return(function(l,d){const p=Ei(l),m=Ei(d);return p.compareTo(m)})(n.bytesValue,e.bytesValue);case 7:return(function(l,d){const p=l.split("/"),m=d.split("/");for(let y=0;y<p.length&&y<m.length;y++){const x=Et(p[y],m[y]);if(x!==0)return x}return Et(p.length,m.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,d){const p=Et(_n(l.latitude),_n(d.latitude));return p!==0?p:Et(_n(l.longitude),_n(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Yv(n.arrayValue,e.arrayValue);case 10:return(function(l,d){var S,I,z,U;const p=l.fields||{},m=d.fields||{},y=(S=p[rg])==null?void 0:S.arrayValue,x=(I=m[rg])==null?void 0:I.arrayValue,v=Et(((z=y==null?void 0:y.values)==null?void 0:z.length)||0,((U=x==null?void 0:x.values)==null?void 0:U.length)||0);return v!==0?v:Yv(y,x)})(n.mapValue,e.mapValue);case 11:return(function(l,d){if(l===Fd.mapValue&&d===Fd.mapValue)return 0;if(l===Fd.mapValue)return 1;if(d===Fd.mapValue)return-1;const p=l.fields||{},m=Object.keys(p),y=d.fields||{},x=Object.keys(y);m.sort(),x.sort();for(let v=0;v<m.length&&v<x.length;++v){const S=tg(m[v],x[v]);if(S!==0)return S;const I=Ll(p[m[v]],y[x[v]]);if(I!==0)return I}return Et(m.length,x.length)})(n.mapValue,e.mapValue);default:throw ot(23264,{he:s})}}function $v(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Et(n,e);const s=_i(n),a=_i(e),o=Et(s.seconds,a.seconds);return o!==0?o:Et(s.nanos,a.nanos)}function Yv(n,e){const s=n.values||[],a=e.values||[];for(let o=0;o<s.length&&o<a.length;++o){const l=Ll(s[o],a[o]);if(l)return l}return Et(s.length,a.length)}function Ml(n){return ag(n)}function ag(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(s){const a=_i(s);return`time(${a.seconds},${a.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(s){return Ei(s).toBase64()})(n.bytesValue):"referenceValue"in n?(function(s){return et.fromName(s).toString()})(n.referenceValue):"geoPointValue"in n?(function(s){return`geo(${s.latitude},${s.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(s){let a="[",o=!0;for(const l of s.values||[])o?o=!1:a+=",",a+=ag(l);return a+"]"})(n.arrayValue):"mapValue"in n?(function(s){const a=Object.keys(s.fields||{}).sort();let o="{",l=!0;for(const d of a)l?l=!1:o+=",",o+=`${d}:${ag(s.fields[d])}`;return o+"}"})(n.mapValue):ot(61005,{value:n})}function nf(n){switch(wi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Df(n);return e?16+nf(e):16;case 5:return 2*n.stringValue.length;case 6:return Ei(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(a){return(a.values||[]).reduce(((o,l)=>o+nf(l)),0)})(n.arrayValue);case 10:case 11:return(function(a){let o=0;return bu(a.fields,((l,d)=>{o+=l.length+nf(d)})),o})(n.mapValue);default:throw ot(13486,{value:n})}}function ig(n){return!!n&&"integerValue"in n}function o0(n){return!!n&&"arrayValue"in n}function Wv(n){return!!n&&"nullValue"in n}function Qv(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function im(n){return!!n&&"mapValue"in n}function XR(n){var s,a;return((a=(((s=n==null?void 0:n.mapValue)==null?void 0:s.fields)||{})[QR])==null?void 0:a.stringValue)===ZR}function Zc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return bu(n.mapValue.fields,((s,a)=>e.mapValue.fields[s]=Zc(a))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let s=0;s<(n.arrayValue.values||[]).length;++s)e.arrayValue.values[s]=Zc(n.arrayValue.values[s]);return e}return{...n}}function JR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===KR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e){this.value=e}static empty(){return new Kr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let s=this.value;for(let a=0;a<e.length-1;++a)if(s=(s.mapValue.fields||{})[e.get(a)],!im(s))return null;return s=(s.mapValue.fields||{})[e.lastSegment()],s||null}}set(e,s){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zc(s)}setAll(e){let s=gs.emptyPath(),a={},o=[];e.forEach(((d,p)=>{if(!s.isImmediateParentOf(p)){const m=this.getFieldsMap(s);this.applyChanges(m,a,o),a={},o=[],s=p.popLast()}d?a[p.lastSegment()]=Zc(d):o.push(p.lastSegment())}));const l=this.getFieldsMap(s);this.applyChanges(l,a,o)}delete(e){const s=this.field(e.popLast());im(s)&&s.mapValue.fields&&delete s.mapValue.fields[e.lastSegment()]}isEqual(e){return ea(this.value,e.value)}getFieldsMap(e){let s=this.value;s.mapValue.fields||(s.mapValue={fields:{}});for(let a=0;a<e.length;++a){let o=s.mapValue.fields[e.get(a)];im(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},s.mapValue.fields[e.get(a)]=o),s=o}return s.mapValue.fields}applyChanges(e,s,a){bu(s,((o,l)=>e[o]=l));for(const o of a)delete e[o]}clone(){return new Kr(Zc(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,s,a,o,l,d,p){this.key=e,this.documentType=s,this.version=a,this.readTime=o,this.createTime=l,this.data=d,this.documentState=p}static newInvalidDocument(e){return new os(e,0,it.min(),it.min(),it.min(),Kr.empty(),0)}static newFoundDocument(e,s,a,o){return new os(e,1,s,it.min(),a,o,0)}static newNoDocument(e,s){return new os(e,2,s,it.min(),it.min(),Kr.empty(),0)}static newUnknownDocument(e,s){return new os(e,3,s,it.min(),it.min(),Kr.empty(),2)}convertToFoundDocument(e,s){return!this.createTime.isEqual(it.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=s,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=it.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof os&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new os(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e,s){this.position=e,this.inclusive=s}}function Kv(n,e,s){let a=0;for(let o=0;o<n.position.length;o++){const l=e[o],d=n.position[o];if(l.field.isKeyField()?a=et.comparator(et.fromName(d.referenceValue),s.key):a=Ll(d,s.data.field(l.field)),l.dir==="desc"&&(a*=-1),a!==0)break}return a}function Zv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let s=0;s<n.position.length;s++)if(!ea(n.position[s],e.position[s]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,s="asc"){this.field=e,this.dir=s}}function eO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{}class Un extends OS{constructor(e,s,a){super(),this.field=e,this.op=s,this.value=a}static create(e,s,a){return e.isKeyField()?s==="in"||s==="not-in"?this.createKeyFieldInFilter(e,s,a):new nO(e,s,a):s==="array-contains"?new aO(e,a):s==="in"?new iO(e,a):s==="not-in"?new oO(e,a):s==="array-contains-any"?new lO(e,a):new Un(e,s,a)}static createKeyFieldInFilter(e,s,a){return s==="in"?new sO(e,a):new rO(e,a)}matches(e){const s=e.data.field(this.field);return this.op==="!="?s!==null&&s.nullValue===void 0&&this.matchesComparison(Ll(s,this.value)):s!==null&&wi(this.value)===wi(s)&&this.matchesComparison(Ll(s,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ot(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ta extends OS{constructor(e,s){super(),this.filters=e,this.op=s,this.Pe=null}static create(e,s){return new ta(e,s)}matches(e){return jS(this)?this.filters.find((s=>!s.matches(e)))===void 0:this.filters.find((s=>s.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,s)=>e.concat(s.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function jS(n){return n.op==="and"}function kS(n){return tO(n)&&jS(n)}function tO(n){for(const e of n.filters)if(e instanceof ta)return!1;return!0}function og(n){if(n instanceof Un)return n.field.canonicalString()+n.op.toString()+Ml(n.value);if(kS(n))return n.filters.map((e=>og(e))).join(",");{const e=n.filters.map((s=>og(s))).join(",");return`${n.op}(${e})`}}function LS(n,e){return n instanceof Un?(function(a,o){return o instanceof Un&&a.op===o.op&&a.field.isEqual(o.field)&&ea(a.value,o.value)})(n,e):n instanceof ta?(function(a,o){return o instanceof ta&&a.op===o.op&&a.filters.length===o.filters.length?a.filters.reduce(((l,d,p)=>l&&LS(d,o.filters[p])),!0):!1})(n,e):void ot(19439)}function MS(n){return n instanceof Un?(function(s){return`${s.field.canonicalString()} ${s.op} ${Ml(s.value)}`})(n):n instanceof ta?(function(s){return s.op.toString()+" {"+s.getFilters().map(MS).join(" ,")+"}"})(n):"Filter"}class nO extends Un{constructor(e,s,a){super(e,s,a),this.key=et.fromName(a.referenceValue)}matches(e){const s=et.comparator(e.key,this.key);return this.matchesComparison(s)}}class sO extends Un{constructor(e,s){super(e,"in",s),this.keys=DS("in",s)}matches(e){return this.keys.some((s=>s.isEqual(e.key)))}}class rO extends Un{constructor(e,s){super(e,"not-in",s),this.keys=DS("not-in",s)}matches(e){return!this.keys.some((s=>s.isEqual(e.key)))}}function DS(n,e){var s;return(((s=e.arrayValue)==null?void 0:s.values)||[]).map((a=>et.fromName(a.referenceValue)))}class aO extends Un{constructor(e,s){super(e,"array-contains",s)}matches(e){const s=e.data.field(this.field);return o0(s)&&du(s.arrayValue,this.value)}}class iO extends Un{constructor(e,s){super(e,"in",s)}matches(e){const s=e.data.field(this.field);return s!==null&&du(this.value.arrayValue,s)}}class oO extends Un{constructor(e,s){super(e,"not-in",s)}matches(e){if(du(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const s=e.data.field(this.field);return s!==null&&s.nullValue===void 0&&!du(this.value.arrayValue,s)}}class lO extends Un{constructor(e,s){super(e,"array-contains-any",s)}matches(e){const s=e.data.field(this.field);return!(!o0(s)||!s.arrayValue.values)&&s.arrayValue.values.some((a=>du(this.value.arrayValue,a)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e,s=null,a=[],o=[],l=null,d=null,p=null){this.path=e,this.collectionGroup=s,this.orderBy=a,this.filters=o,this.limit=l,this.startAt=d,this.endAt=p,this.Te=null}}function Xv(n,e=null,s=[],a=[],o=null,l=null,d=null){return new cO(n,e,s,a,o,l,d)}function l0(n){const e=At(n);if(e.Te===null){let s=e.path.canonicalString();e.collectionGroup!==null&&(s+="|cg:"+e.collectionGroup),s+="|f:",s+=e.filters.map((a=>og(a))).join(","),s+="|ob:",s+=e.orderBy.map((a=>(function(l){return l.field.canonicalString()+l.dir})(a))).join(","),Mf(e.limit)||(s+="|l:",s+=e.limit),e.startAt&&(s+="|lb:",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map((a=>Ml(a))).join(",")),e.endAt&&(s+="|ub:",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map((a=>Ml(a))).join(",")),e.Te=s}return e.Te}function c0(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!eO(n.orderBy[s],e.orderBy[s]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if(!LS(n.filters[s],e.filters[s]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Zv(n.startAt,e.startAt)&&Zv(n.endAt,e.endAt)}function lg(n){return et.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,s=null,a=[],o=[],l=null,d="F",p=null,m=null){this.path=e,this.collectionGroup=s,this.explicitOrderBy=a,this.filters=o,this.limit=l,this.limitType=d,this.startAt=p,this.endAt=m,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function uO(n,e,s,a,o,l,d,p){return new Uf(n,e,s,a,o,l,d,p)}function u0(n){return new Uf(n)}function Jv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function dO(n){return et.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function fO(n){return n.collectionGroup!==null}function Xc(n){const e=At(n);if(e.Ie===null){e.Ie=[];const s=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),s.add(l.field.canonicalString());const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let p=new zn(gs.comparator);return d.filters.forEach((m=>{m.getFlattenedFilters().forEach((y=>{y.isInequality()&&(p=p.add(y.field))}))})),p})(e).forEach((l=>{s.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new yf(l,a))})),s.has(gs.keyField().canonicalString())||e.Ie.push(new yf(gs.keyField(),a))}return e.Ie}function Jr(n){const e=At(n);return e.Ee||(e.Ee=hO(e,Xc(n))),e.Ee}function hO(n,e){if(n.limitType==="F")return Xv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const l=o.dir==="desc"?"asc":"desc";return new yf(o.field,l)}));const s=n.endAt?new gf(n.endAt.position,n.endAt.inclusive):null,a=n.startAt?new gf(n.startAt.position,n.startAt.inclusive):null;return Xv(n.path,n.collectionGroup,e,n.filters,n.limit,s,a)}}function cg(n,e,s){return new Uf(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,s,n.startAt,n.endAt)}function Pf(n,e){return c0(Jr(n),Jr(e))&&n.limitType===e.limitType}function US(n){return`${l0(Jr(n))}|lt:${n.limitType}`}function pl(n){return`Query(target=${(function(s){let a=s.path.canonicalString();return s.collectionGroup!==null&&(a+=" collectionGroup="+s.collectionGroup),s.filters.length>0&&(a+=`, filters: [${s.filters.map((o=>MS(o))).join(", ")}]`),Mf(s.limit)||(a+=", limit: "+s.limit),s.orderBy.length>0&&(a+=`, orderBy: [${s.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),s.startAt&&(a+=", startAt: ",a+=s.startAt.inclusive?"b:":"a:",a+=s.startAt.position.map((o=>Ml(o))).join(",")),s.endAt&&(a+=", endAt: ",a+=s.endAt.inclusive?"a:":"b:",a+=s.endAt.position.map((o=>Ml(o))).join(",")),`Target(${a})`})(Jr(n))}; limitType=${n.limitType})`}function Vf(n,e){return e.isFoundDocument()&&(function(a,o){const l=o.key.path;return a.collectionGroup!==null?o.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(l):et.isDocumentKey(a.path)?a.path.isEqual(l):a.path.isImmediateParentOf(l)})(n,e)&&(function(a,o){for(const l of Xc(a))if(!l.field.isKeyField()&&o.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(a,o){for(const l of a.filters)if(!l.matches(o))return!1;return!0})(n,e)&&(function(a,o){return!(a.startAt&&!(function(d,p,m){const y=Kv(d,p,m);return d.inclusive?y<=0:y<0})(a.startAt,Xc(a),o)||a.endAt&&!(function(d,p,m){const y=Kv(d,p,m);return d.inclusive?y>=0:y>0})(a.endAt,Xc(a),o))})(n,e)}function pO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function PS(n){return(e,s)=>{let a=!1;for(const o of Xc(n)){const l=mO(o,e,s);if(l!==0)return l;a=a||o.field.isKeyField()}return 0}}function mO(n,e,s){const a=n.field.isKeyField()?et.comparator(e.key,s.key):(function(l,d,p){const m=d.data.field(l),y=p.data.field(l);return m!==null&&y!==null?Ll(m,y):ot(42886)})(n.field,e,s);switch(n.dir){case"asc":return a;case"desc":return-1*a;default:return ot(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(e,s){this.mapKeyFn=e,this.equalsFn=s,this.inner={},this.innerSize=0}get(e){const s=this.mapKeyFn(e),a=this.inner[s];if(a!==void 0){for(const[o,l]of a)if(this.equalsFn(o,e))return l}}has(e){return this.get(e)!==void 0}set(e,s){const a=this.mapKeyFn(e),o=this.inner[a];if(o===void 0)return this.inner[a]=[[e,s]],void this.innerSize++;for(let l=0;l<o.length;l++)if(this.equalsFn(o[l][0],e))return void(o[l]=[e,s]);o.push([e,s]),this.innerSize++}delete(e){const s=this.mapKeyFn(e),a=this.inner[s];if(a===void 0)return!1;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return a.length===1?delete this.inner[s]:a.splice(o,1),this.innerSize--,!0;return!1}forEach(e){bu(this.inner,((s,a)=>{for(const[o,l]of a)e(o,l)}))}isEmpty(){return qR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gO=new En(et.comparator);function Si(){return gO}const VS=new En(et.comparator);function Pc(...n){let e=VS;for(const s of n)e=e.insert(s.key,s);return e}function yO(n){let e=VS;return n.forEach(((s,a)=>e=e.insert(s,a.overlayedDocument))),e}function uo(){return Jc()}function zS(){return Jc()}function Jc(){return new No((n=>n.toString()),((n,e)=>n.isEqual(e)))}const xO=new zn(et.comparator);function It(...n){let e=xO;for(const s of n)e=e.add(s);return e}const bO=new zn(Et);function vO(){return bO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _O(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sg(e)?"-0":e}}function EO(n){return{integerValue:""+n}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(){this._=void 0}}function wO(n,e,s){return n instanceof ug?(function(o,l){const d={fields:{[NS]:{stringValue:IS},[RS]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return l&&i0(l)&&(l=Df(l)),l&&(d.fields[CS]=l),{mapValue:d}})(s,e):n instanceof xf?BS(n,e):n instanceof bf?FS(n,e):(function(o,l){const d=TO(o,l),p=e1(d)+e1(o.Ae);return ig(d)&&ig(o.Ae)?EO(p):_O(o.serializer,p)})(n,e)}function SO(n,e,s){return n instanceof xf?BS(n,e):n instanceof bf?FS(n,e):s}function TO(n,e){return n instanceof dg?(function(a){return ig(a)||(function(l){return!!l&&"doubleValue"in l})(a)})(e)?e:{integerValue:0}:null}class ug extends zf{}class xf extends zf{constructor(e){super(),this.elements=e}}function BS(n,e){const s=HS(e);for(const a of n.elements)s.some((o=>ea(o,a)))||s.push(a);return{arrayValue:{values:s}}}class bf extends zf{constructor(e){super(),this.elements=e}}function FS(n,e){let s=HS(e);for(const a of n.elements)s=s.filter((o=>!ea(o,a)));return{arrayValue:{values:s}}}class dg extends zf{constructor(e,s){super(),this.serializer=e,this.Ae=s}}function e1(n){return _n(n.integerValue||n.doubleValue)}function HS(n){return o0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function AO(n,e){return n.field.isEqual(e.field)&&(function(a,o){return a instanceof xf&&o instanceof xf||a instanceof bf&&o instanceof bf?kl(a.elements,o.elements,ea):a instanceof dg&&o instanceof dg?ea(a.Ae,o.Ae):a instanceof ug&&o instanceof ug})(n.transform,e.transform)}class po{constructor(e,s){this.updateTime=e,this.exists=s}static none(){return new po}static exists(e){return new po(void 0,e)}static updateTime(e){return new po(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class d0{}function GS(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new NO(n.key,po.none()):new f0(n.key,n.data,po.none());{const s=n.data,a=Kr.empty();let o=new zn(gs.comparator);for(let l of e.fields)if(!o.has(l)){let d=s.field(l);d===null&&l.length>1&&(l=l.popLast(),d=s.field(l)),d===null?a.delete(l):a.set(l,d),o=o.add(l)}return new Bf(n.key,a,new ci(o.toArray()),po.none())}}function IO(n,e,s){n instanceof f0?(function(o,l,d){const p=o.value.clone(),m=n1(o.fieldTransforms,l,d.transformResults);p.setAll(m),l.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,s):n instanceof Bf?(function(o,l,d){if(!sf(o.precondition,l))return void l.convertToUnknownDocument(d.version);const p=n1(o.fieldTransforms,l,d.transformResults),m=l.data;m.setAll(qS(o)),m.setAll(p),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,s):(function(o,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,s)}function eu(n,e,s,a){return n instanceof f0?(function(l,d,p,m){if(!sf(l.precondition,d))return p;const y=l.value.clone(),x=s1(l.fieldTransforms,m,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,s,a):n instanceof Bf?(function(l,d,p,m){if(!sf(l.precondition,d))return p;const y=s1(l.fieldTransforms,m,d),x=d.data;return x.setAll(qS(l)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),p===null?null:p.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(n,e,s,a):(function(l,d,p){return sf(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):p})(n,e,s)}function t1(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(a,o){return a===void 0&&o===void 0||!(!a||!o)&&kl(a,o,((l,d)=>AO(l,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class f0 extends d0{constructor(e,s,a,o=[]){super(),this.key=e,this.value=s,this.precondition=a,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class Bf extends d0{constructor(e,s,a,o,l=[]){super(),this.key=e,this.data=s,this.fieldMask=a,this.precondition=o,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function qS(n){const e=new Map;return n.fieldMask.fields.forEach((s=>{if(!s.isEmpty()){const a=n.data.field(s);e.set(s,a)}})),e}function n1(n,e,s){const a=new Map;rn(n.length===s.length,32656,{Ve:s.length,de:n.length});for(let o=0;o<s.length;o++){const l=n[o],d=l.transform,p=e.data.field(l.field);a.set(l.field,SO(d,p,s[o]))}return a}function s1(n,e,s){const a=new Map;for(const o of n){const l=o.transform,d=s.data.field(o.field);a.set(o.field,wO(l,d,e))}return a}class NO extends d0{constructor(e,s){super(),this.key=e,this.precondition=s,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{constructor(e,s,a,o){this.batchId=e,this.localWriteTime=s,this.baseMutations=a,this.mutations=o}applyToRemoteDocument(e,s){const a=s.mutationResults;for(let o=0;o<this.mutations.length;o++){const l=this.mutations[o];l.key.isEqual(e.key)&&IO(l,e,a[o])}}applyToLocalView(e,s){for(const a of this.baseMutations)a.key.isEqual(e.key)&&(s=eu(a,e,s,this.localWriteTime));for(const a of this.mutations)a.key.isEqual(e.key)&&(s=eu(a,e,s,this.localWriteTime));return s}applyToLocalDocumentSet(e,s){const a=zS();return this.mutations.forEach((o=>{const l=e.get(o.key),d=l.overlayedDocument;let p=this.applyToLocalView(d,l.mutatedFields);p=s.has(o.key)?null:p;const m=GS(d,p);m!==null&&a.set(o.key,m),d.isValidDocument()||d.convertToNoDocument(it.min())})),a}keys(){return this.mutations.reduce(((e,s)=>e.add(s.key)),It())}isEqual(e){return this.batchId===e.batchId&&kl(this.mutations,e.mutations,((s,a)=>t1(s,a)))&&kl(this.baseMutations,e.baseMutations,((s,a)=>t1(s,a)))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e,s){this.largestBatchId=e,this.mutation=s}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OO{constructor(e,s){this.count=e,this.unchangedNames=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Cn,wt;function $S(n){if(n===void 0)return Ma("GRPC error has no .code"),Re.UNKNOWN;switch(n){case Cn.OK:return Re.OK;case Cn.CANCELLED:return Re.CANCELLED;case Cn.UNKNOWN:return Re.UNKNOWN;case Cn.DEADLINE_EXCEEDED:return Re.DEADLINE_EXCEEDED;case Cn.RESOURCE_EXHAUSTED:return Re.RESOURCE_EXHAUSTED;case Cn.INTERNAL:return Re.INTERNAL;case Cn.UNAVAILABLE:return Re.UNAVAILABLE;case Cn.UNAUTHENTICATED:return Re.UNAUTHENTICATED;case Cn.INVALID_ARGUMENT:return Re.INVALID_ARGUMENT;case Cn.NOT_FOUND:return Re.NOT_FOUND;case Cn.ALREADY_EXISTS:return Re.ALREADY_EXISTS;case Cn.PERMISSION_DENIED:return Re.PERMISSION_DENIED;case Cn.FAILED_PRECONDITION:return Re.FAILED_PRECONDITION;case Cn.ABORTED:return Re.ABORTED;case Cn.OUT_OF_RANGE:return Re.OUT_OF_RANGE;case Cn.UNIMPLEMENTED:return Re.UNIMPLEMENTED;case Cn.DATA_LOSS:return Re.DATA_LOSS;default:return ot(39323,{code:n})}}(wt=Cn||(Cn={}))[wt.OK=0]="OK",wt[wt.CANCELLED=1]="CANCELLED",wt[wt.UNKNOWN=2]="UNKNOWN",wt[wt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wt[wt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wt[wt.NOT_FOUND=5]="NOT_FOUND",wt[wt.ALREADY_EXISTS=6]="ALREADY_EXISTS",wt[wt.PERMISSION_DENIED=7]="PERMISSION_DENIED",wt[wt.UNAUTHENTICATED=16]="UNAUTHENTICATED",wt[wt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wt[wt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wt[wt.ABORTED=10]="ABORTED",wt[wt.OUT_OF_RANGE=11]="OUT_OF_RANGE",wt[wt.UNIMPLEMENTED=12]="UNIMPLEMENTED",wt[wt.INTERNAL=13]="INTERNAL",wt[wt.UNAVAILABLE=14]="UNAVAILABLE",wt[wt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO=new mi([4294967295,4294967295],0);function r1(n){const e=jO().encode(n),s=new yS;return s.update(e),new Uint8Array(s.digest())}function a1(n){const e=new DataView(n.buffer),s=e.getUint32(0,!0),a=e.getUint32(4,!0),o=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new mi([s,a],0),new mi([o,l],0)]}class h0{constructor(e,s,a){if(this.bitmap=e,this.padding=s,this.hashCount=a,s<0||s>=8)throw new Vc(`Invalid padding: ${s}`);if(a<0)throw new Vc(`Invalid hash count: ${a}`);if(e.length>0&&this.hashCount===0)throw new Vc(`Invalid hash count: ${a}`);if(e.length===0&&s!==0)throw new Vc(`Invalid padding when bitmap length is 0: ${s}`);this.ge=8*e.length-s,this.pe=mi.fromNumber(this.ge)}ye(e,s,a){let o=e.add(s.multiply(mi.fromNumber(a)));return o.compare(kO)===1&&(o=new mi([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const s=r1(e),[a,o]=a1(s);for(let l=0;l<this.hashCount;l++){const d=this.ye(a,o,l);if(!this.we(d))return!1}return!0}static create(e,s,a){const o=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new h0(l,o,s);return a.forEach((p=>d.insert(p))),d}insert(e){if(this.ge===0)return;const s=r1(e),[a,o]=a1(s);for(let l=0;l<this.hashCount;l++){const d=this.ye(a,o,l);this.be(d)}}be(e){const s=Math.floor(e/8),a=e%8;this.bitmap[s]|=1<<a}}class Vc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff{constructor(e,s,a,o,l){this.snapshotVersion=e,this.targetChanges=s,this.targetMismatches=a,this.documentUpdates=o,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,s,a){const o=new Map;return o.set(e,vu.createSynthesizedTargetChangeForCurrentChange(e,s,a)),new Ff(it.min(),o,new En(Et),Si(),It())}}class vu{constructor(e,s,a,o,l){this.resumeToken=e,this.current=s,this.addedDocuments=a,this.modifiedDocuments=o,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,s,a){return new vu(a,s,It(),It(),It())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e,s,a,o){this.Se=e,this.removedTargetIds=s,this.key=a,this.De=o}}class YS{constructor(e,s){this.targetId=e,this.Ce=s}}class WS{constructor(e,s,a=Jn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=s,this.resumeToken=a,this.cause=o}}class i1{constructor(){this.ve=0,this.Fe=o1(),this.Me=Jn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=It(),s=It(),a=It();return this.Fe.forEach(((o,l)=>{switch(l){case 0:e=e.add(o);break;case 2:s=s.add(o);break;case 1:a=a.add(o);break;default:ot(38017,{changeType:l})}})),new vu(this.Me,this.xe,e,s,a)}Ke(){this.Oe=!1,this.Fe=o1()}qe(e,s){this.Oe=!0,this.Fe=this.Fe.insert(e,s)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,rn(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class LO{constructor(e){this.Ge=e,this.ze=new Map,this.je=Si(),this.He=Hd(),this.Je=Hd(),this.Ze=new En(Et)}Xe(e){for(const s of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(s,e.De):this.et(s,e.key,e.De);for(const s of e.removedTargetIds)this.et(s,e.key,e.De)}tt(e){this.forEachTarget(e,(s=>{const a=this.nt(s);switch(e.state){case 0:this.rt(s)&&a.Le(e.resumeToken);break;case 1:a.We(),a.Ne||a.Ke(),a.Le(e.resumeToken);break;case 2:a.We(),a.Ne||this.removeTarget(s);break;case 3:this.rt(s)&&(a.Qe(),a.Le(e.resumeToken));break;case 4:this.rt(s)&&(this.it(s),a.Le(e.resumeToken));break;default:ot(56790,{state:e.state})}}))}forEachTarget(e,s){e.targetIds.length>0?e.targetIds.forEach(s):this.ze.forEach(((a,o)=>{this.rt(o)&&s(o)}))}st(e){const s=e.targetId,a=e.Ce.count,o=this.ot(s);if(o){const l=o.target;if(lg(l))if(a===0){const d=new et(l.path);this.et(s,d,os.newNoDocument(d,it.min()))}else rn(a===1,20013,{expectedCount:a});else{const d=this._t(s);if(d!==a){const p=this.ut(e),m=p?this.ct(p,e,d):1;if(m!==0){this.it(s);const y=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(s,y)}}}}}ut(e){const s=e.Ce.unchangedNames;if(!s||!s.bits)return null;const{bits:{bitmap:a="",padding:o=0},hashCount:l=0}=s;let d,p;try{d=Ei(a).toUint8Array()}catch(m){if(m instanceof AS)return To("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{p=new h0(d,o,l)}catch(m){return To(m instanceof Vc?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return p.ge===0?null:p}ct(e,s,a){return s.Ce.count===a-this.Pt(e,s.targetId)?0:2}Pt(e,s){const a=this.Ge.getRemoteKeysForTarget(s);let o=0;return a.forEach((l=>{const d=this.Ge.ht(),p=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(p)||(this.et(s,l,null),o++)})),o}Tt(e){const s=new Map;this.ze.forEach(((l,d)=>{const p=this.ot(d);if(p){if(l.current&&lg(p.target)){const m=new et(p.target.path);this.It(m).has(d)||this.Et(d,m)||this.et(d,m,os.newNoDocument(m,e))}l.Be&&(s.set(d,l.ke()),l.Ke())}}));let a=It();this.Je.forEach(((l,d)=>{let p=!0;d.forEachWhile((m=>{const y=this.ot(m);return!y||y.purpose==="TargetPurposeLimboResolution"||(p=!1,!1)})),p&&(a=a.add(l))})),this.je.forEach(((l,d)=>d.setReadTime(e)));const o=new Ff(e,s,this.Ze,this.je,a);return this.je=Si(),this.He=Hd(),this.Je=Hd(),this.Ze=new En(Et),o}Ye(e,s){if(!this.rt(e))return;const a=this.Et(e,s.key)?2:0;this.nt(e).qe(s.key,a),this.je=this.je.insert(s.key,s),this.He=this.He.insert(s.key,this.It(s.key).add(e)),this.Je=this.Je.insert(s.key,this.Rt(s.key).add(e))}et(e,s,a){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,s)?o.qe(s,1):o.Ue(s),this.Je=this.Je.insert(s,this.Rt(s).delete(e)),this.Je=this.Je.insert(s,this.Rt(s).add(e)),a&&(this.je=this.je.insert(s,a))}removeTarget(e){this.ze.delete(e)}_t(e){const s=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+s.addedDocuments.size-s.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let s=this.ze.get(e);return s||(s=new i1,this.ze.set(e,s)),s}Rt(e){let s=this.Je.get(e);return s||(s=new zn(Et),this.Je=this.Je.insert(e,s)),s}It(e){let s=this.He.get(e);return s||(s=new zn(Et),this.He=this.He.insert(e,s)),s}rt(e){const s=this.ot(e)!==null;return s||ze("WatchChangeAggregator","Detected inactive target",e),s}ot(e){const s=this.ze.get(e);return s&&s.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new i1),this.Ge.getRemoteKeysForTarget(e).forEach((s=>{this.et(e,s,null)}))}Et(e,s){return this.Ge.getRemoteKeysForTarget(e).has(s)}}function Hd(){return new En(et.comparator)}function o1(){return new En(et.comparator)}const MO={asc:"ASCENDING",desc:"DESCENDING"},DO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},UO={and:"AND",or:"OR"};class PO{constructor(e,s){this.databaseId=e,this.useProto3Json=s}}function fg(n,e){return n.useProto3Json||Mf(e)?e:{value:e}}function VO(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zO(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function Tl(n){return rn(!!n,49232),it.fromTimestamp((function(s){const a=_i(s);return new Rn(a.seconds,a.nanos)})(n))}function BO(n,e){return hg(n,e).canonicalString()}function hg(n,e){const s=(function(o){return new sn(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?s:s.child(e)}function QS(n){const e=sn.fromString(n);return rn(eT(e),10190,{key:e.toString()}),e}function om(n,e){const s=QS(e);if(s.get(1)!==n.databaseId.projectId)throw new Qe(Re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+s.get(1)+" vs "+n.databaseId.projectId);if(s.get(3)!==n.databaseId.database)throw new Qe(Re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+s.get(3)+" vs "+n.databaseId.database);return new et(ZS(s))}function KS(n,e){return BO(n.databaseId,e)}function FO(n){const e=QS(n);return e.length===4?sn.emptyPath():ZS(e)}function l1(n){return new sn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ZS(n){return rn(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function HO(n,e){let s;if("targetChange"in e){e.targetChange;const a=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:ot(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],l=(function(y,x){return y.useProto3Json?(rn(x===void 0||typeof x=="string",58123),Jn.fromBase64String(x||"")):(rn(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),Jn.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,p=d&&(function(y){const x=y.code===void 0?Re.UNKNOWN:$S(y.code);return new Qe(x,y.message||"")})(d);s=new WS(a,o,l,p||null)}else if("documentChange"in e){e.documentChange;const a=e.documentChange;a.document,a.document.name,a.document.updateTime;const o=om(n,a.document.name),l=Tl(a.document.updateTime),d=a.document.createTime?Tl(a.document.createTime):it.min(),p=new Kr({mapValue:{fields:a.document.fields}}),m=os.newFoundDocument(o,l,d,p),y=a.targetIds||[],x=a.removedTargetIds||[];s=new rf(y,x,m.key,m)}else if("documentDelete"in e){e.documentDelete;const a=e.documentDelete;a.document;const o=om(n,a.document),l=a.readTime?Tl(a.readTime):it.min(),d=os.newNoDocument(o,l),p=a.removedTargetIds||[];s=new rf([],p,d.key,d)}else if("documentRemove"in e){e.documentRemove;const a=e.documentRemove;a.document;const o=om(n,a.document),l=a.removedTargetIds||[];s=new rf([],l,o,null)}else{if(!("filter"in e))return ot(11601,{Vt:e});{e.filter;const a=e.filter;a.targetId;const{count:o=0,unchangedNames:l}=a,d=new OO(o,l),p=a.targetId;s=new YS(p,d)}}return s}function GO(n,e){return{documents:[KS(n,e.path)]}}function qO(n,e){const s={structuredQuery:{}},a=e.path;let o;e.collectionGroup!==null?(o=a,s.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=a.popLast(),s.structuredQuery.from=[{collectionId:a.lastSegment()}]),s.parent=KS(n,o);const l=(function(y){if(y.length!==0)return JS(ta.create(y,"and"))})(e.filters);l&&(s.structuredQuery.where=l);const d=(function(y){if(y.length!==0)return y.map((x=>(function(S){return{field:ml(S.field),direction:WO(S.dir)}})(x)))})(e.orderBy);d&&(s.structuredQuery.orderBy=d);const p=fg(n,e.limit);return p!==null&&(s.structuredQuery.limit=p),e.startAt&&(s.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(s.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:s,parent:o}}function $O(n){let e=FO(n.parent);const s=n.structuredQuery,a=s.from?s.from.length:0;let o=null;if(a>0){rn(a===1,65062);const x=s.from[0];x.allDescendants?o=x.collectionId:e=e.child(x.collectionId)}let l=[];s.where&&(l=(function(v){const S=XS(v);return S instanceof ta&&kS(S)?S.getFilters():[S]})(s.where));let d=[];s.orderBy&&(d=(function(v){return v.map((S=>(function(z){return new yf(gl(z.field),(function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(z.direction))})(S)))})(s.orderBy));let p=null;s.limit&&(p=(function(v){let S;return S=typeof v=="object"?v.value:v,Mf(S)?null:S})(s.limit));let m=null;s.startAt&&(m=(function(v){const S=!!v.before,I=v.values||[];return new gf(I,S)})(s.startAt));let y=null;return s.endAt&&(y=(function(v){const S=!v.before,I=v.values||[];return new gf(I,S)})(s.endAt)),uO(e,o,d,l,p,"F",m,y)}function YO(n,e){const s=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ot(28987,{purpose:o})}})(e.purpose);return s==null?null:{"goog-listen-tags":s}}function XS(n){return n.unaryFilter!==void 0?(function(s){switch(s.unaryFilter.op){case"IS_NAN":const a=gl(s.unaryFilter.field);return Un.create(a,"==",{doubleValue:NaN});case"IS_NULL":const o=gl(s.unaryFilter.field);return Un.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=gl(s.unaryFilter.field);return Un.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=gl(s.unaryFilter.field);return Un.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ot(61313);default:return ot(60726)}})(n):n.fieldFilter!==void 0?(function(s){return Un.create(gl(s.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ot(58110);default:return ot(50506)}})(s.fieldFilter.op),s.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(s){return ta.create(s.compositeFilter.filters.map((a=>XS(a))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return ot(1026)}})(s.compositeFilter.op))})(n):ot(30097,{filter:n})}function WO(n){return MO[n]}function QO(n){return DO[n]}function KO(n){return UO[n]}function ml(n){return{fieldPath:n.canonicalString()}}function gl(n){return gs.fromServerFormat(n.fieldPath)}function JS(n){return n instanceof Un?(function(s){if(s.op==="=="){if(Qv(s.value))return{unaryFilter:{field:ml(s.field),op:"IS_NAN"}};if(Wv(s.value))return{unaryFilter:{field:ml(s.field),op:"IS_NULL"}}}else if(s.op==="!="){if(Qv(s.value))return{unaryFilter:{field:ml(s.field),op:"IS_NOT_NAN"}};if(Wv(s.value))return{unaryFilter:{field:ml(s.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ml(s.field),op:QO(s.op),value:s.value}}})(n):n instanceof ta?(function(s){const a=s.getFilters().map((o=>JS(o)));return a.length===1?a[0]:{compositeFilter:{op:KO(s.op),filters:a}}})(n):ot(54877,{filter:n})}function eT(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,s,a,o,l=it.min(),d=it.min(),p=Jn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=s,this.purpose=a,this.sequenceNumber=o,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=p,this.expectedCount=m}withSequenceNumber(e){return new ui(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,s){return new ui(this.target,this.targetId,this.purpose,this.sequenceNumber,s,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ui(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ui(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e){this.yt=e}}function XO(n){const e=$O({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?cg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(){this.Sn=new ej}addToCollectionParentIndex(e,s){return this.Sn.add(s),Te.resolve()}getCollectionParents(e,s){return Te.resolve(this.Sn.getEntries(s))}addFieldIndex(e,s){return Te.resolve()}deleteFieldIndex(e,s){return Te.resolve()}deleteAllFieldIndexes(e){return Te.resolve()}createTargetIndexes(e,s){return Te.resolve()}getDocumentsMatchingTarget(e,s){return Te.resolve(null)}getIndexType(e,s){return Te.resolve(0)}getFieldIndexes(e,s){return Te.resolve([])}getNextCollectionGroupToUpdate(e){return Te.resolve(null)}getMinOffset(e,s){return Te.resolve(vi.min())}getMinOffsetFromCollectionGroup(e,s){return Te.resolve(vi.min())}updateCollectionGroup(e,s,a){return Te.resolve()}updateIndexEntries(e,s){return Te.resolve()}}class ej{constructor(){this.index={}}add(e){const s=e.lastSegment(),a=e.popLast(),o=this.index[s]||new zn(sn.comparator),l=!o.has(a);return this.index[s]=o.add(a),l}has(e){const s=e.lastSegment(),a=e.popLast(),o=this.index[s];return o&&o.has(a)}getEntries(e){return(this.index[e]||new zn(sn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},tT=41943040;class Ns{static withCacheSize(e){return new Ns(e,Ns.DEFAULT_COLLECTION_PERCENTILE,Ns.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,s,a){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=s,this.maximumSequenceNumbersToCollect=a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ns.DEFAULT_COLLECTION_PERCENTILE=10,Ns.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ns.DEFAULT=new Ns(tT,Ns.DEFAULT_COLLECTION_PERCENTILE,Ns.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ns.DISABLED=new Ns(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Dl(0)}static ar(){return new Dl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1="LruGarbageCollector",tj=1048576;function d1([n,e],[s,a]){const o=Et(n,s);return o===0?Et(e,a):o}class nj{constructor(e){this.Pr=e,this.buffer=new zn(d1),this.Tr=0}Ir(){return++this.Tr}Er(e){const s=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(s);else{const a=this.buffer.last();d1(s,a)<0&&(this.buffer=this.buffer.delete(a).add(s))}}get maxValue(){return this.buffer.last()[0]}}class sj{constructor(e,s,a){this.garbageCollector=e,this.asyncQueue=s,this.localStore=a,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ze(u1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(s){Bl(s)?ze(u1,"Ignoring IndexedDB error during garbage collection: ",s):await kf(s)}await this.Ar(3e5)}))}}class rj{constructor(e,s){this.Vr=e,this.params=s}calculateTargetCount(e,s){return this.Vr.dr(e).next((a=>Math.floor(s/100*a)))}nthSequenceNumber(e,s){if(s===0)return Te.resolve(Lf.ce);const a=new nj(s);return this.Vr.forEachTarget(e,(o=>a.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>a.Er(o))))).next((()=>a.maxValue))}removeTargets(e,s,a){return this.Vr.removeTargets(e,s,a)}removeOrphanedDocuments(e,s){return this.Vr.removeOrphanedDocuments(e,s)}collect(e,s){return this.params.cacheSizeCollectionThreshold===-1?(ze("LruGarbageCollector","Garbage collection skipped; disabled"),Te.resolve(c1)):this.getCacheSize(e).next((a=>a<this.params.cacheSizeCollectionThreshold?(ze("LruGarbageCollector",`Garbage collection skipped; Cache size ${a} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),c1):this.gr(e,s)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,s){let a,o,l,d,p,m,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(ze("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),o=this.params.maximumSequenceNumbersToCollect):o=v,d=Date.now(),this.nthSequenceNumber(e,o)))).next((v=>(a=v,p=Date.now(),this.removeTargets(e,a,s)))).next((v=>(l=v,m=Date.now(),this.removeOrphanedDocuments(e,a)))).next((v=>(y=Date.now(),hl()<=St.DEBUG&&ze("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${o} in `+(p-d)+`ms
	Removed ${l} targets in `+(m-p)+`ms
	Removed ${v} documents in `+(y-m)+`ms
Total Duration: ${y-x}ms`),Te.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:l,documentsRemoved:v}))))}}function aj(n,e){return new rj(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(){this.changes=new No((e=>e.toString()),((e,s)=>e.isEqual(s))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,s){this.assertNotApplied(),this.changes.set(e,os.newInvalidDocument(e).setReadTime(s))}getEntry(e,s){this.assertNotApplied();const a=this.changes.get(s);return a!==void 0?Te.resolve(a):this.getFromCache(e,s)}getEntries(e,s){return this.getAllFromCache(e,s)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e,s){this.overlayedDocument=e,this.mutatedFields=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(e,s,a,o){this.remoteDocumentCache=e,this.mutationQueue=s,this.documentOverlayCache=a,this.indexManager=o}getDocument(e,s){let a=null;return this.documentOverlayCache.getOverlay(e,s).next((o=>(a=o,this.remoteDocumentCache.getEntry(e,s)))).next((o=>(a!==null&&eu(a.mutation,o,ci.empty(),Rn.now()),o)))}getDocuments(e,s){return this.remoteDocumentCache.getEntries(e,s).next((a=>this.getLocalViewOfDocuments(e,a,It()).next((()=>a))))}getLocalViewOfDocuments(e,s,a=It()){const o=uo();return this.populateOverlays(e,o,s).next((()=>this.computeViews(e,s,o,a).next((l=>{let d=Pc();return l.forEach(((p,m)=>{d=d.insert(p,m.overlayedDocument)})),d}))))}getOverlayedDocuments(e,s){const a=uo();return this.populateOverlays(e,a,s).next((()=>this.computeViews(e,s,a,It())))}populateOverlays(e,s,a){const o=[];return a.forEach((l=>{s.has(l)||o.push(l)})),this.documentOverlayCache.getOverlays(e,o).next((l=>{l.forEach(((d,p)=>{s.set(d,p)}))}))}computeViews(e,s,a,o){let l=Si();const d=Jc(),p=(function(){return Jc()})();return s.forEach(((m,y)=>{const x=a.get(y.key);o.has(y.key)&&(x===void 0||x.mutation instanceof Bf)?l=l.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),eu(x.mutation,y,x.mutation.getFieldMask(),Rn.now())):d.set(y.key,ci.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((y,x)=>d.set(y,x))),s.forEach(((y,x)=>p.set(y,new oj(x,d.get(y)??null)))),p)))}recalculateAndSaveOverlays(e,s){const a=Jc();let o=new En(((d,p)=>d-p)),l=It();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,s).next((d=>{for(const p of d)p.keys().forEach((m=>{const y=s.get(m);if(y===null)return;let x=a.get(m)||ci.empty();x=p.applyToLocalView(y,x),a.set(m,x);const v=(o.get(p.batchId)||It()).add(m);o=o.insert(p.batchId,v)}))})).next((()=>{const d=[],p=o.getReverseIterator();for(;p.hasNext();){const m=p.getNext(),y=m.key,x=m.value,v=zS();x.forEach((S=>{if(!l.has(S)){const I=GS(s.get(S),a.get(S));I!==null&&v.set(S,I),l=l.add(S)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,v))}return Te.waitFor(d)})).next((()=>a))}recalculateAndSaveOverlaysForDocumentKeys(e,s){return this.remoteDocumentCache.getEntries(e,s).next((a=>this.recalculateAndSaveOverlays(e,a)))}getDocumentsMatchingQuery(e,s,a,o){return dO(s)?this.getDocumentsMatchingDocumentQuery(e,s.path):fO(s)?this.getDocumentsMatchingCollectionGroupQuery(e,s,a,o):this.getDocumentsMatchingCollectionQuery(e,s,a,o)}getNextDocuments(e,s,a,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,s,a,o).next((l=>{const d=o-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,s,a.largestBatchId,o-l.size):Te.resolve(uo());let p=lu,m=l;return d.next((y=>Te.forEach(y,((x,v)=>(p<v.largestBatchId&&(p=v.largestBatchId),l.get(x)?Te.resolve():this.remoteDocumentCache.getEntry(e,x).next((S=>{m=m.insert(x,S)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,m,y,It()))).next((x=>({batchId:p,changes:yO(x)})))))}))}getDocumentsMatchingDocumentQuery(e,s){return this.getDocument(e,new et(s)).next((a=>{let o=Pc();return a.isFoundDocument()&&(o=o.insert(a.key,a)),o}))}getDocumentsMatchingCollectionGroupQuery(e,s,a,o){const l=s.collectionGroup;let d=Pc();return this.indexManager.getCollectionParents(e,l).next((p=>Te.forEach(p,(m=>{const y=(function(v,S){return new Uf(S,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(s,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,a,o).next((x=>{x.forEach(((v,S)=>{d=d.insert(v,S)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,s,a,o){let l;return this.documentOverlayCache.getOverlaysForCollection(e,s.path,a.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,s,a,l,o)))).next((d=>{l.forEach(((m,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,os.newInvalidDocument(x)))}));let p=Pc();return d.forEach(((m,y)=>{const x=l.get(m);x!==void 0&&eu(x.mutation,y,ci.empty(),Rn.now()),Vf(s,y)&&(p=p.insert(m,y))})),p}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,s){return Te.resolve(this.Nr.get(s))}saveBundleMetadata(e,s){return this.Nr.set(s.id,(function(o){return{id:o.id,version:o.version,createTime:Tl(o.createTime)}})(s)),Te.resolve()}getNamedQuery(e,s){return Te.resolve(this.Br.get(s))}saveNamedQuery(e,s){return this.Br.set(s.name,(function(o){return{name:o.name,query:XO(o.bundledQuery),readTime:Tl(o.readTime)}})(s)),Te.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(){this.overlays=new En(et.comparator),this.Lr=new Map}getOverlay(e,s){return Te.resolve(this.overlays.get(s))}getOverlays(e,s){const a=uo();return Te.forEach(s,(o=>this.getOverlay(e,o).next((l=>{l!==null&&a.set(o,l)})))).next((()=>a))}saveOverlays(e,s,a){return a.forEach(((o,l)=>{this.bt(e,s,l)})),Te.resolve()}removeOverlaysForBatchId(e,s,a){const o=this.Lr.get(a);return o!==void 0&&(o.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(a)),Te.resolve()}getOverlaysForCollection(e,s,a){const o=uo(),l=s.length+1,d=new et(s.child("")),p=this.overlays.getIteratorFrom(d);for(;p.hasNext();){const m=p.getNext().value,y=m.getKey();if(!s.isPrefixOf(y.path))break;y.path.length===l&&m.largestBatchId>a&&o.set(m.getKey(),m)}return Te.resolve(o)}getOverlaysForCollectionGroup(e,s,a,o){let l=new En(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===s&&y.largestBatchId>a){let x=l.get(y.largestBatchId);x===null&&(x=uo(),l=l.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const p=uo(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((y,x)=>p.set(y,x))),!(p.size()>=o)););return Te.resolve(p)}bt(e,s,a){const o=this.overlays.get(a.key);if(o!==null){const d=this.Lr.get(o.largestBatchId).delete(a.key);this.Lr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(a.key,new RO(s,a));let l=this.Lr.get(s);l===void 0&&(l=It(),this.Lr.set(s,l)),this.Lr.set(s,l.add(a.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(){this.sessionToken=Jn.EMPTY_BYTE_STRING}getSessionToken(e){return Te.resolve(this.sessionToken)}setSessionToken(e,s){return this.sessionToken=s,Te.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p0{constructor(){this.kr=new zn(Hn.Kr),this.qr=new zn(Hn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,s){const a=new Hn(e,s);this.kr=this.kr.add(a),this.qr=this.qr.add(a)}$r(e,s){e.forEach((a=>this.addReference(a,s)))}removeReference(e,s){this.Wr(new Hn(e,s))}Qr(e,s){e.forEach((a=>this.removeReference(a,s)))}Gr(e){const s=new et(new sn([])),a=new Hn(s,e),o=new Hn(s,e+1),l=[];return this.qr.forEachInRange([a,o],(d=>{this.Wr(d),l.push(d.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const s=new et(new sn([])),a=new Hn(s,e),o=new Hn(s,e+1);let l=It();return this.qr.forEachInRange([a,o],(d=>{l=l.add(d.key)})),l}containsKey(e){const s=new Hn(e,0),a=this.kr.firstAfterOrEqual(s);return a!==null&&e.isEqual(a.key)}}class Hn{constructor(e,s){this.key=e,this.Hr=s}static Kr(e,s){return et.comparator(e.key,s.key)||Et(e.Hr,s.Hr)}static Ur(e,s){return Et(e.Hr,s.Hr)||et.comparator(e.key,s.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{constructor(e,s){this.indexManager=e,this.referenceDelegate=s,this.mutationQueue=[],this.Yn=1,this.Jr=new zn(Hn.Kr)}checkEmpty(e){return Te.resolve(this.mutationQueue.length===0)}addMutationBatch(e,s,a,o){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new CO(l,s,a,o);this.mutationQueue.push(d);for(const p of o)this.Jr=this.Jr.add(new Hn(p.key,l)),this.indexManager.addToCollectionParentIndex(e,p.key.path.popLast());return Te.resolve(d)}lookupMutationBatch(e,s){return Te.resolve(this.Zr(s))}getNextMutationBatchAfterBatchId(e,s){const a=s+1,o=this.Xr(a),l=o<0?0:o;return Te.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return Te.resolve(this.mutationQueue.length===0?FR:this.Yn-1)}getAllMutationBatches(e){return Te.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,s){const a=new Hn(s,0),o=new Hn(s,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([a,o],(d=>{const p=this.Zr(d.Hr);l.push(p)})),Te.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,s){let a=new zn(Et);return s.forEach((o=>{const l=new Hn(o,0),d=new Hn(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,d],(p=>{a=a.add(p.Hr)}))})),Te.resolve(this.Yr(a))}getAllMutationBatchesAffectingQuery(e,s){const a=s.path,o=a.length+1;let l=a;et.isDocumentKey(l)||(l=l.child(""));const d=new Hn(new et(l),0);let p=new zn(Et);return this.Jr.forEachWhile((m=>{const y=m.key.path;return!!a.isPrefixOf(y)&&(y.length===o&&(p=p.add(m.Hr)),!0)}),d),Te.resolve(this.Yr(p))}Yr(e){const s=[];return e.forEach((a=>{const o=this.Zr(a);o!==null&&s.push(o)})),s}removeMutationBatch(e,s){rn(this.ei(s.batchId,"removed")===0,55003),this.mutationQueue.shift();let a=this.Jr;return Te.forEach(s.mutations,(o=>{const l=new Hn(o.key,s.batchId);return a=a.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=a}))}nr(e){}containsKey(e,s){const a=new Hn(s,0),o=this.Jr.firstAfterOrEqual(a);return Te.resolve(s.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Te.resolve()}ei(e,s){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const s=this.Xr(e);return s<0||s>=this.mutationQueue.length?null:this.mutationQueue[s]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(e){this.ti=e,this.docs=(function(){return new En(et.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,s){const a=s.key,o=this.docs.get(a),l=o?o.size:0,d=this.ti(s);return this.docs=this.docs.insert(a,{document:s.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,a.path.popLast())}removeEntry(e){const s=this.docs.get(e);s&&(this.docs=this.docs.remove(e),this.size-=s.size)}getEntry(e,s){const a=this.docs.get(s);return Te.resolve(a?a.document.mutableCopy():os.newInvalidDocument(s))}getEntries(e,s){let a=Si();return s.forEach((o=>{const l=this.docs.get(o);a=a.insert(o,l?l.document.mutableCopy():os.newInvalidDocument(o))})),Te.resolve(a)}getDocumentsMatchingQuery(e,s,a,o){let l=Si();const d=s.path,p=new et(d.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(p);for(;m.hasNext();){const{key:y,value:{document:x}}=m.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||PR(UR(x),a)<=0||(o.has(x.key)||Vf(s,x))&&(l=l.insert(x.key,x.mutableCopy()))}return Te.resolve(l)}getAllFromCollectionGroup(e,s,a,o){ot(9500)}ni(e,s){return Te.forEach(this.docs,(a=>s(a)))}newChangeBuffer(e){return new pj(this)}getSize(e){return Te.resolve(this.size)}}class pj extends ij{constructor(e){super(),this.Mr=e}applyChanges(e){const s=[];return this.changes.forEach(((a,o)=>{o.isValidDocument()?s.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(a)})),Te.waitFor(s)}getFromCache(e,s){return this.Mr.getEntry(e,s)}getAllFromCache(e,s){return this.Mr.getEntries(e,s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mj{constructor(e){this.persistence=e,this.ri=new No((s=>l0(s)),c0),this.lastRemoteSnapshotVersion=it.min(),this.highestTargetId=0,this.ii=0,this.si=new p0,this.targetCount=0,this.oi=Dl._r()}forEachTarget(e,s){return this.ri.forEach(((a,o)=>s(o))),Te.resolve()}getLastRemoteSnapshotVersion(e){return Te.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Te.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Te.resolve(this.highestTargetId)}setTargetsMetadata(e,s,a){return a&&(this.lastRemoteSnapshotVersion=a),s>this.ii&&(this.ii=s),Te.resolve()}lr(e){this.ri.set(e.target,e);const s=e.targetId;s>this.highestTargetId&&(this.oi=new Dl(s),this.highestTargetId=s),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,s){return this.lr(s),this.targetCount+=1,Te.resolve()}updateTargetData(e,s){return this.lr(s),Te.resolve()}removeTargetData(e,s){return this.ri.delete(s.target),this.si.Gr(s.targetId),this.targetCount-=1,Te.resolve()}removeTargets(e,s,a){let o=0;const l=[];return this.ri.forEach(((d,p)=>{p.sequenceNumber<=s&&a.get(p.targetId)===null&&(this.ri.delete(d),l.push(this.removeMatchingKeysForTargetId(e,p.targetId)),o++)})),Te.waitFor(l).next((()=>o))}getTargetCount(e){return Te.resolve(this.targetCount)}getTargetData(e,s){const a=this.ri.get(s)||null;return Te.resolve(a)}addMatchingKeys(e,s,a){return this.si.$r(s,a),Te.resolve()}removeMatchingKeys(e,s,a){this.si.Qr(s,a);const o=this.persistence.referenceDelegate,l=[];return o&&s.forEach((d=>{l.push(o.markPotentiallyOrphaned(e,d))})),Te.waitFor(l)}removeMatchingKeysForTargetId(e,s){return this.si.Gr(s),Te.resolve()}getMatchingKeysForTargetId(e,s){const a=this.si.jr(s);return Te.resolve(a)}containsKey(e,s){return Te.resolve(this.si.containsKey(s))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nT{constructor(e,s){this._i={},this.overlays={},this.ai=new Lf(0),this.ui=!1,this.ui=!0,this.ci=new dj,this.referenceDelegate=e(this),this.li=new mj(this),this.indexManager=new JO,this.remoteDocumentCache=(function(o){return new hj(o)})((a=>this.referenceDelegate.hi(a))),this.serializer=new ZO(s),this.Pi=new cj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let s=this.overlays[e.toKey()];return s||(s=new uj,this.overlays[e.toKey()]=s),s}getMutationQueue(e,s){let a=this._i[e.toKey()];return a||(a=new fj(s,this.referenceDelegate),this._i[e.toKey()]=a),a}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,s,a){ze("MemoryPersistence","Starting transaction:",e);const o=new gj(this.ai.next());return this.referenceDelegate.Ti(),a(o).next((l=>this.referenceDelegate.Ii(o).next((()=>l)))).toPromise().then((l=>(o.raiseOnCommittedEvent(),l)))}Ei(e,s){return Te.or(Object.values(this._i).map((a=>()=>a.containsKey(e,s))))}}class gj extends zR{constructor(e){super(),this.currentSequenceNumber=e}}class m0{constructor(e){this.persistence=e,this.Ri=new p0,this.Ai=null}static Vi(e){return new m0(e)}get di(){if(this.Ai)return this.Ai;throw ot(60996)}addReference(e,s,a){return this.Ri.addReference(a,s),this.di.delete(a.toString()),Te.resolve()}removeReference(e,s,a){return this.Ri.removeReference(a,s),this.di.add(a.toString()),Te.resolve()}markPotentiallyOrphaned(e,s){return this.di.add(s.toString()),Te.resolve()}removeTarget(e,s){this.Ri.Gr(s.targetId).forEach((o=>this.di.add(o.toString())));const a=this.persistence.getTargetCache();return a.getMatchingKeysForTargetId(e,s.targetId).next((o=>{o.forEach((l=>this.di.add(l.toString())))})).next((()=>a.removeTargetData(e,s)))}Ti(){this.Ai=new Set}Ii(e){const s=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Te.forEach(this.di,(a=>{const o=et.fromPath(a);return this.mi(e,o).next((l=>{l||s.removeEntry(o,it.min())}))})).next((()=>(this.Ai=null,s.apply(e))))}updateLimboDocument(e,s){return this.mi(e,s).next((a=>{a?this.di.delete(s.toString()):this.di.add(s.toString())}))}hi(e){return 0}mi(e,s){return Te.or([()=>Te.resolve(this.Ri.containsKey(s)),()=>this.persistence.getTargetCache().containsKey(e,s),()=>this.persistence.Ei(e,s)])}}class vf{constructor(e,s){this.persistence=e,this.fi=new No((a=>HR(a.path)),((a,o)=>a.isEqual(o))),this.garbageCollector=aj(this,s)}static Vi(e,s){return new vf(e,s)}Ti(){}Ii(e){return Te.resolve()}forEachTarget(e,s){return this.persistence.getTargetCache().forEachTarget(e,s)}dr(e){const s=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((a=>s.next((o=>a+o))))}pr(e){let s=0;return this.mr(e,(a=>{s++})).next((()=>s))}mr(e,s){return Te.forEach(this.fi,((a,o)=>this.wr(e,a,o).next((l=>l?Te.resolve():s(o)))))}removeTargets(e,s,a){return this.persistence.getTargetCache().removeTargets(e,s,a)}removeOrphanedDocuments(e,s){let a=0;const o=this.persistence.getRemoteDocumentCache(),l=o.newChangeBuffer();return o.ni(e,(d=>this.wr(e,d,s).next((p=>{p||(a++,l.removeEntry(d,it.min()))})))).next((()=>l.apply(e))).next((()=>a))}markPotentiallyOrphaned(e,s){return this.fi.set(s,e.currentSequenceNumber),Te.resolve()}removeTarget(e,s){const a=s.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,a)}addReference(e,s,a){return this.fi.set(a,e.currentSequenceNumber),Te.resolve()}removeReference(e,s,a){return this.fi.set(a,e.currentSequenceNumber),Te.resolve()}updateLimboDocument(e,s){return this.fi.set(s,e.currentSequenceNumber),Te.resolve()}hi(e){let s=e.key.toString().length;return e.isFoundDocument()&&(s+=nf(e.data.value)),s}wr(e,s,a){return Te.or([()=>this.persistence.Ei(e,s),()=>this.persistence.getTargetCache().containsKey(e,s),()=>{const o=this.fi.get(s);return Te.resolve(o!==void 0&&o>a)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g0{constructor(e,s,a,o){this.targetId=e,this.fromCache=s,this.Ts=a,this.Is=o}static Es(e,s){let a=It(),o=It();for(const l of s.docChanges)switch(l.type){case 0:a=a.add(l.doc.key);break;case 1:o=o.add(l.doc.key)}return new g0(e,s.fromCache,a,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return tC()?8:BR(JN())>0?6:4})()}initialize(e,s){this.fs=e,this.indexManager=s,this.Rs=!0}getDocumentsMatchingQuery(e,s,a,o){const l={result:null};return this.gs(e,s).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ps(e,s,o,a).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new yj;return this.ys(e,s,d).next((p=>{if(l.result=p,this.As)return this.ws(e,s,d,p.size)}))})).next((()=>l.result))}ws(e,s,a,o){return a.documentReadCount<this.Vs?(hl()<=St.DEBUG&&ze("QueryEngine","SDK will not create cache indexes for query:",pl(s),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Te.resolve()):(hl()<=St.DEBUG&&ze("QueryEngine","Query:",pl(s),"scans",a.documentReadCount,"local documents and returns",o,"documents as results."),a.documentReadCount>this.ds*o?(hl()<=St.DEBUG&&ze("QueryEngine","The SDK decides to create cache indexes for query:",pl(s),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Jr(s))):Te.resolve())}gs(e,s){if(Jv(s))return Te.resolve(null);let a=Jr(s);return this.indexManager.getIndexType(e,a).next((o=>o===0?null:(s.limit!==null&&o===1&&(s=cg(s,null,"F"),a=Jr(s)),this.indexManager.getDocumentsMatchingTarget(e,a).next((l=>{const d=It(...l);return this.fs.getDocuments(e,d).next((p=>this.indexManager.getMinOffset(e,a).next((m=>{const y=this.bs(s,p);return this.Ss(s,y,d,m.readTime)?this.gs(e,cg(s,null,"F")):this.Ds(e,y,s,m)}))))})))))}ps(e,s,a,o){return Jv(s)||o.isEqual(it.min())?Te.resolve(null):this.fs.getDocuments(e,a).next((l=>{const d=this.bs(s,l);return this.Ss(s,d,a,o)?Te.resolve(null):(hl()<=St.DEBUG&&ze("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),pl(s)),this.Ds(e,d,s,DR(o,lu)).next((p=>p)))}))}bs(e,s){let a=new zn(PS(e));return s.forEach(((o,l)=>{Vf(e,l)&&(a=a.add(l))})),a}Ss(e,s,a,o){if(e.limit===null)return!1;if(a.size!==s.size)return!0;const l=e.limitType==="F"?s.last():s.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(o)>0)}ys(e,s,a){return hl()<=St.DEBUG&&ze("QueryEngine","Using full collection scan to execute query:",pl(s)),this.fs.getDocumentsMatchingQuery(e,s,vi.min(),a)}Ds(e,s,a,o){return this.fs.getDocumentsMatchingQuery(e,a,o).next((l=>(s.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y0="LocalStore",bj=3e8;class vj{constructor(e,s,a,o){this.persistence=e,this.Cs=s,this.serializer=o,this.vs=new En(Et),this.Fs=new No((l=>l0(l)),c0),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(a)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lj(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(s=>e.collect(s,this.vs)))}}function _j(n,e,s,a){return new vj(n,e,s,a)}async function sT(n,e){const s=At(n);return await s.persistence.runTransaction("Handle user change","readonly",(a=>{let o;return s.mutationQueue.getAllMutationBatches(a).next((l=>(o=l,s.Os(e),s.mutationQueue.getAllMutationBatches(a)))).next((l=>{const d=[],p=[];let m=It();for(const y of o){d.push(y.batchId);for(const x of y.mutations)m=m.add(x.key)}for(const y of l){p.push(y.batchId);for(const x of y.mutations)m=m.add(x.key)}return s.localDocuments.getDocuments(a,m).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:p})))}))}))}function rT(n){const e=At(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(s=>e.li.getLastRemoteSnapshotVersion(s)))}function Ej(n,e){const s=At(n),a=e.snapshotVersion;let o=s.vs;return s.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=s.xs.newChangeBuffer({trackRemovals:!0});o=s.vs;const p=[];e.targetChanges.forEach(((x,v)=>{const S=o.get(v);if(!S)return;p.push(s.li.removeMatchingKeys(l,x.removedDocuments,v).next((()=>s.li.addMatchingKeys(l,x.addedDocuments,v))));let I=S.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?I=I.withResumeToken(Jn.EMPTY_BYTE_STRING,it.min()).withLastLimboFreeSnapshotVersion(it.min()):x.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(x.resumeToken,a)),o=o.insert(v,I),(function(U,C,M){return U.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=bj?!0:M.addedDocuments.size+M.modifiedDocuments.size+M.removedDocuments.size>0})(S,I,x)&&p.push(s.li.updateTargetData(l,I))}));let m=Si(),y=It();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&p.push(s.persistence.referenceDelegate.updateLimboDocument(l,x))})),p.push(wj(l,d,e.documentUpdates).next((x=>{m=x.Bs,y=x.Ls}))),!a.isEqual(it.min())){const x=s.li.getLastRemoteSnapshotVersion(l).next((v=>s.li.setTargetsMetadata(l,l.currentSequenceNumber,a)));p.push(x)}return Te.waitFor(p).next((()=>d.apply(l))).next((()=>s.localDocuments.getLocalViewOfDocuments(l,m,y))).next((()=>m))})).then((l=>(s.vs=o,l)))}function wj(n,e,s){let a=It(),o=It();return s.forEach((l=>a=a.add(l))),e.getEntries(n,a).next((l=>{let d=Si();return s.forEach(((p,m)=>{const y=l.get(p);m.isFoundDocument()!==y.isFoundDocument()&&(o=o.add(p)),m.isNoDocument()&&m.version.isEqual(it.min())?(e.removeEntry(p,m.readTime),d=d.insert(p,m)):!y.isValidDocument()||m.version.compareTo(y.version)>0||m.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(m),d=d.insert(p,m)):ze(y0,"Ignoring outdated watch update for ",p,". Current version:",y.version," Watch version:",m.version)})),{Bs:d,Ls:o}}))}function Sj(n,e){const s=At(n);return s.persistence.runTransaction("Allocate target","readwrite",(a=>{let o;return s.li.getTargetData(a,e).next((l=>l?(o=l,Te.resolve(o)):s.li.allocateTargetId(a).next((d=>(o=new ui(e,d,"TargetPurposeListen",a.currentSequenceNumber),s.li.addTargetData(a,o).next((()=>o)))))))})).then((a=>{const o=s.vs.get(a.targetId);return(o===null||a.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(s.vs=s.vs.insert(a.targetId,a),s.Fs.set(e,a.targetId)),a}))}async function pg(n,e,s){const a=At(n),o=a.vs.get(e),l=s?"readwrite":"readwrite-primary";try{s||await a.persistence.runTransaction("Release target",l,(d=>a.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!Bl(d))throw d;ze(y0,`Failed to update sequence numbers for target ${e}: ${d}`)}a.vs=a.vs.remove(e),a.Fs.delete(o.target)}function f1(n,e,s){const a=At(n);let o=it.min(),l=It();return a.persistence.runTransaction("Execute query","readwrite",(d=>(function(m,y,x){const v=At(m),S=v.Fs.get(x);return S!==void 0?Te.resolve(v.vs.get(S)):v.li.getTargetData(y,x)})(a,d,Jr(e)).next((p=>{if(p)return o=p.lastLimboFreeSnapshotVersion,a.li.getMatchingKeysForTargetId(d,p.targetId).next((m=>{l=m}))})).next((()=>a.Cs.getDocumentsMatchingQuery(d,e,s?o:it.min(),s?l:It()))).next((p=>(Tj(a,pO(e),p),{documents:p,ks:l})))))}function Tj(n,e,s){let a=n.Ms.get(e)||it.min();s.forEach(((o,l)=>{l.readTime.compareTo(a)>0&&(a=l.readTime)})),n.Ms.set(e,a)}class h1{constructor(){this.activeTargetIds=vO()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Aj{constructor(){this.vo=new h1,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,s,a){}addLocalQueryTarget(e,s=!0){return s&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,s,a){this.Fo[e]=s}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new h1,Promise.resolve()}handleUserChange(e,s,a){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ij{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1="ConnectivityMonitor";class m1{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ze(p1,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ze(p1,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gd=null;function mg(){return Gd===null?Gd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Gd++,"0x"+Gd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lm="RestConnection",Nj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class Cj{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const s=e.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=s+"://"+e.host,this.Uo=`projects/${a}/databases/${o}`,this.$o=this.databaseId.database===mf?`project_id=${a}`:`project_id=${a}&database_id=${o}`}Wo(e,s,a,o,l){const d=mg(),p=this.Qo(e,s.toUriEncodedString());ze(lm,`Sending RPC '${e}' ${d}:`,p,a);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(m,o,l);const{host:y}=new URL(p),x=n0(y);return this.zo(e,p,m,a,x).then((v=>(ze(lm,`Received RPC '${e}' ${d}: `,v),v)),(v=>{throw To(lm,`RPC '${e}' ${d} failed with error: `,v,"url: ",p,"request:",a),v}))}jo(e,s,a,o,l,d){return this.Wo(e,s,a,o,l)}Go(e,s,a){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+zl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach(((o,l)=>e[l]=o)),a&&a.headers.forEach(((o,l)=>e[l]=o))}Qo(e,s){const a=Nj[e];let o=`${this.qo}/v1/${s}:${a}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ss="WebChannelConnection",Lc=(n,e,s)=>{n.listen(e,(a=>{try{s(a)}catch(o){setTimeout((()=>{throw o}),0)}}))};class Al extends Cj{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Al.c_){const e=_S();Lc(e,vS.STAT_EVENT,(s=>{s.stat===eg.PROXY?ze(ss,"STAT_EVENT: detected buffering proxy"):s.stat===eg.NOPROXY&&ze(ss,"STAT_EVENT: detected no buffering proxy")})),Al.c_=!0}}zo(e,s,a,o,l){const d=mg();return new Promise(((p,m)=>{const y=new xS;y.setWithCredentials(!0),y.listenOnce(bS.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case tf.NO_ERROR:const v=y.getResponseJson();ze(ss,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(v)),p(v);break;case tf.TIMEOUT:ze(ss,`RPC '${e}' ${d} timed out`),m(new Qe(Re.DEADLINE_EXCEEDED,"Request time out"));break;case tf.HTTP_ERROR:const S=y.getStatus();if(ze(ss,`RPC '${e}' ${d} failed with status:`,S,"response text:",y.getResponseText()),S>0){let I=y.getResponseJson();Array.isArray(I)&&(I=I[0]);const z=I==null?void 0:I.error;if(z&&z.status&&z.message){const U=(function(M){const B=M.toLowerCase().replace(/_/g,"-");return Object.values(Re).indexOf(B)>=0?B:Re.UNKNOWN})(z.status);m(new Qe(U,z.message))}else m(new Qe(Re.UNKNOWN,"Server responded with status "+y.getStatus()))}else m(new Qe(Re.UNAVAILABLE,"Connection failed."));break;default:ot(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ze(ss,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(o);ze(ss,`RPC '${e}' ${d} sending request:`,o),y.send(s,"POST",x,a,15)}))}T_(e,s,a){const o=mg(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(p.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Go(p.initMessageHeaders,s,a),p.encodeInitMessageHeaders=!0;const y=l.join("");ze(ss,`Creating RPC '${e}' stream ${o}: ${y}`,p);const x=d.createWebChannel(y,p);this.I_(x);let v=!1,S=!1;const I=new Rj({Ho:z=>{S?ze(ss,`Not sending because RPC '${e}' stream ${o} is closed:`,z):(v||(ze(ss,`Opening RPC '${e}' stream ${o} transport.`),x.open(),v=!0),ze(ss,`RPC '${e}' stream ${o} sending:`,z),x.send(z))},Jo:()=>x.close()});return Lc(x,Uc.EventType.OPEN,(()=>{S||(ze(ss,`RPC '${e}' stream ${o} transport opened.`),I.i_())})),Lc(x,Uc.EventType.CLOSE,(()=>{S||(S=!0,ze(ss,`RPC '${e}' stream ${o} transport closed`),I.o_(),this.E_(x))})),Lc(x,Uc.EventType.ERROR,(z=>{S||(S=!0,To(ss,`RPC '${e}' stream ${o} transport errored. Name:`,z.name,"Message:",z.message),I.o_(new Qe(Re.UNAVAILABLE,"The operation could not be completed")))})),Lc(x,Uc.EventType.MESSAGE,(z=>{var U;if(!S){const C=z.data[0];rn(!!C,16349);const M=C,B=(M==null?void 0:M.error)||((U=M[0])==null?void 0:U.error);if(B){ze(ss,`RPC '${e}' stream ${o} received error:`,B);const F=B.status;let H=(function(A){const T=Cn[A];if(T!==void 0)return $S(T)})(F),q=B.message;F==="NOT_FOUND"&&q.includes("database")&&q.includes("does not exist")&&q.includes(this.databaseId.database)&&To(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),H===void 0&&(H=Re.INTERNAL,q="Unknown error status: "+F+" with message "+B.message),S=!0,I.o_(new Qe(H,q)),x.close()}else ze(ss,`RPC '${e}' stream ${o} received:`,C),I.__(C)}})),Al.u_(),setTimeout((()=>{I.s_()}),0),I}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((s=>s===e))}Go(e,s,a){super.Go(e,s,a),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return ES()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oj(n){return new Al(n)}function cm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aT(n){return new PO(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Al.c_=!1;class iT{constructor(e,s,a=1e3,o=1.5,l=6e4){this.Ci=e,this.timerId=s,this.R_=a,this.A_=o,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const s=Math.floor(this.d_+this.y_()),a=Math.max(0,Date.now()-this.f_),o=Math.max(0,s-a);o>0&&ze("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${s} ms, last attempt: ${a} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1="PersistentStream";class jj{constructor(e,s,a,o,l,d,p,m){this.Ci=e,this.b_=a,this.S_=o,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=p,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new iT(e,s)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,s){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():s&&s.code===Re.RESOURCE_EXHAUSTED?(Ma(s.toString()),Ma("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):s&&s.code===Re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(s)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),s=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([a,o])=>{this.D_===s&&this.G_(a,o)}),(a=>{e((()=>{const o=new Qe(Re.UNKNOWN,"Fetching auth token failed: "+a.message);return this.z_(o)}))}))}G_(e,s){const a=this.Q_(this.D_);this.stream=this.j_(e,s),this.stream.Zo((()=>{a((()=>this.listener.Zo()))})),this.stream.Yo((()=>{a((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{a((()=>this.z_(o)))})),this.stream.onMessage((o=>{a((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ze(g1,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return s=>{this.Ci.enqueueAndForget((()=>this.D_===e?s():(ze(g1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class kj extends jj{constructor(e,s,a,o,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",s,a,o,d),this.serializer=l}j_(e,s){return this.connection.T_("Listen",e,s)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const s=HO(this.serializer,e),a=(function(l){if(!("targetChange"in l))return it.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?it.min():d.readTime?Tl(d.readTime):it.min()})(e);return this.listener.J_(s,a)}Z_(e){const s={};s.database=l1(this.serializer),s.addTarget=(function(l,d){let p;const m=d.target;if(p=lg(m)?{documents:GO(l,m)}:{query:qO(l,m).ft},p.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){p.resumeToken=zO(l,d.resumeToken);const y=fg(l,d.expectedCount);y!==null&&(p.expectedCount=y)}else if(d.snapshotVersion.compareTo(it.min())>0){p.readTime=VO(l,d.snapshotVersion.toTimestamp());const y=fg(l,d.expectedCount);y!==null&&(p.expectedCount=y)}return p})(this.serializer,e);const a=YO(this.serializer,e);a&&(s.labels=a),this.K_(s)}X_(e){const s={};s.database=l1(this.serializer),s.removeTarget=e,this.K_(s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{}class Mj extends Lj{constructor(e,s,a,o){super(),this.authCredentials=e,this.appCheckCredentials=s,this.connection=a,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Qe(Re.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,s,a,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,hg(s,a),o,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Qe(Re.UNKNOWN,l.toString())}))}jo(e,s,a,o,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,p])=>this.connection.jo(e,hg(s,a),o,d,p,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Qe(Re.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function Dj(n,e,s,a){return new Mj(n,e,s,a)}class Uj{constructor(e,s){this.asyncQueue=e,this.onlineStateHandler=s,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const s=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ma(s),this.aa=!1):ze("OnlineStateTracker",s)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ul="RemoteStore";class Pj{constructor(e,s,a,o,l){this.localStore=e,this.datastore=s,this.asyncQueue=a,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((d=>{a.enqueueAndForget((async()=>{Eu(this)&&(ze(Ul,"Restarting streams for network reachability change."),await(async function(m){const y=At(m);y.Ea.add(4),await _u(y),y.Va.set("Unknown"),y.Ea.delete(4),await Hf(y)})(this))}))})),this.Va=new Uj(a,o)}}async function Hf(n){if(Eu(n))for(const e of n.Ra)await e(!0)}async function _u(n){for(const e of n.Ra)await e(!1)}function oT(n,e){const s=At(n);s.Ia.has(e.targetId)||(s.Ia.set(e.targetId,e),_0(s)?v0(s):Fl(s).O_()&&b0(s,e))}function x0(n,e){const s=At(n),a=Fl(s);s.Ia.delete(e),a.O_()&&lT(s,e),s.Ia.size===0&&(a.O_()?a.L_():Eu(s)&&s.Va.set("Unknown"))}function b0(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(it.min())>0){const s=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(s)}Fl(n).Z_(e)}function lT(n,e){n.da.$e(e),Fl(n).X_(e)}function v0(n){n.da=new LO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Fl(n).start(),n.Va.ua()}function _0(n){return Eu(n)&&!Fl(n).x_()&&n.Ia.size>0}function Eu(n){return At(n).Ea.size===0}function cT(n){n.da=void 0}async function Vj(n){n.Va.set("Online")}async function zj(n){n.Ia.forEach(((e,s)=>{b0(n,e)}))}async function Bj(n,e){cT(n),_0(n)?(n.Va.ha(e),v0(n)):n.Va.set("Unknown")}async function Fj(n,e,s){if(n.Va.set("Online"),e instanceof WS&&e.state===2&&e.cause)try{await(async function(o,l){const d=l.cause;for(const p of l.targetIds)o.Ia.has(p)&&(await o.remoteSyncer.rejectListen(p,d),o.Ia.delete(p),o.da.removeTarget(p))})(n,e)}catch(a){ze(Ul,"Failed to remove targets %s: %s ",e.targetIds.join(","),a),await y1(n,a)}else if(e instanceof rf?n.da.Xe(e):e instanceof YS?n.da.st(e):n.da.tt(e),!s.isEqual(it.min()))try{const a=await rT(n.localStore);s.compareTo(a)>=0&&await(function(l,d){const p=l.da.Tt(d);return p.targetChanges.forEach(((m,y)=>{if(m.resumeToken.approximateByteSize()>0){const x=l.Ia.get(y);x&&l.Ia.set(y,x.withResumeToken(m.resumeToken,d))}})),p.targetMismatches.forEach(((m,y)=>{const x=l.Ia.get(m);if(!x)return;l.Ia.set(m,x.withResumeToken(Jn.EMPTY_BYTE_STRING,x.snapshotVersion)),lT(l,m);const v=new ui(x.target,m,y,x.sequenceNumber);b0(l,v)})),l.remoteSyncer.applyRemoteEvent(p)})(n,s)}catch(a){ze(Ul,"Failed to raise snapshot:",a),await y1(n,a)}}async function y1(n,e,s){if(!Bl(e))throw e;n.Ea.add(1),await _u(n),n.Va.set("Offline"),s||(s=()=>rT(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ze(Ul,"Retrying IndexedDB access"),await s(),n.Ea.delete(1),await Hf(n)}))}async function x1(n,e){const s=At(n);s.asyncQueue.verifyOperationInProgress(),ze(Ul,"RemoteStore received new credentials");const a=Eu(s);s.Ea.add(3),await _u(s),a&&s.Va.set("Unknown"),await s.remoteSyncer.handleCredentialChange(e),s.Ea.delete(3),await Hf(s)}async function Hj(n,e){const s=At(n);e?(s.Ea.delete(2),await Hf(s)):e||(s.Ea.add(2),await _u(s),s.Va.set("Unknown"))}function Fl(n){return n.ma||(n.ma=(function(s,a,o){const l=At(s);return l.sa(),new kj(a,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Zo:Vj.bind(null,n),Yo:zj.bind(null,n),t_:Bj.bind(null,n),J_:Fj.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),_0(n)?v0(n):n.Va.set("Unknown")):(await n.ma.stop(),cT(n))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(e,s,a,o,l){this.asyncQueue=e,this.timerId=s,this.targetTimeMs=a,this.op=o,this.removalCallback=l,this.deferred=new ho,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,s,a,o,l){const d=Date.now()+a,p=new E0(e,s,d,o,l);return p.start(a),p}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Qe(Re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uT(n,e){if(Ma("AsyncQueue",`${e}: ${n}`),Bl(n))return new Qe(Re.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il{static emptySet(e){return new Il(e.comparator)}constructor(e){this.comparator=e?(s,a)=>e(s,a)||et.comparator(s.key,a.key):(s,a)=>et.comparator(s.key,a.key),this.keyedMap=Pc(),this.sortedSet=new En(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const s=this.keyedMap.get(e);return s?this.sortedSet.indexOf(s):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((s,a)=>(e(s),!1)))}add(e){const s=this.delete(e.key);return s.copy(s.keyedMap.insert(e.key,e),s.sortedSet.insert(e,null))}delete(e){const s=this.get(e);return s?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(s)):this}isEqual(e){if(!(e instanceof Il)||this.size!==e.size)return!1;const s=this.sortedSet.getIterator(),a=e.sortedSet.getIterator();for(;s.hasNext();){const o=s.getNext().key,l=a.getNext().key;if(!o.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((s=>{e.push(s.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,s){const a=new Il;return a.comparator=this.comparator,a.keyedMap=e,a.sortedSet=s,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(){this.ga=new En(et.comparator)}track(e){const s=e.doc.key,a=this.ga.get(s);a?e.type!==0&&a.type===3?this.ga=this.ga.insert(s,e):e.type===3&&a.type!==1?this.ga=this.ga.insert(s,{type:a.type,doc:e.doc}):e.type===2&&a.type===2?this.ga=this.ga.insert(s,{type:2,doc:e.doc}):e.type===2&&a.type===0?this.ga=this.ga.insert(s,{type:0,doc:e.doc}):e.type===1&&a.type===0?this.ga=this.ga.remove(s):e.type===1&&a.type===2?this.ga=this.ga.insert(s,{type:1,doc:a.doc}):e.type===0&&a.type===1?this.ga=this.ga.insert(s,{type:2,doc:e.doc}):ot(63341,{Vt:e,pa:a}):this.ga=this.ga.insert(s,e)}ya(){const e=[];return this.ga.inorderTraversal(((s,a)=>{e.push(a)})),e}}class Pl{constructor(e,s,a,o,l,d,p,m,y){this.query=e,this.docs=s,this.oldDocs=a,this.docChanges=o,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=p,this.excludesMetadataChanges=m,this.hasCachedResults=y}static fromInitialDocuments(e,s,a,o,l){const d=[];return s.forEach((p=>{d.push({type:0,doc:p})})),new Pl(e,s,Il.emptySet(s),d,a,o,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const s=this.docChanges,a=e.docChanges;if(s.length!==a.length)return!1;for(let o=0;o<s.length;o++)if(s[o].type!==a[o].type||!s[o].doc.isEqual(a[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gj{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class qj{constructor(){this.queries=v1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(s,a){const o=At(s),l=o.queries;o.queries=v1(),l.forEach(((d,p)=>{for(const m of p.ba)m.onError(a)}))})(this,new Qe(Re.ABORTED,"Firestore shutting down"))}}function v1(){return new No((n=>US(n)),Pf)}async function $j(n,e){const s=At(n);let a=3;const o=e.query;let l=s.queries.get(o);l?!l.Sa()&&e.Da()&&(a=2):(l=new Gj,a=e.Da()?0:1);try{switch(a){case 0:l.wa=await s.onListen(o,!0);break;case 1:l.wa=await s.onListen(o,!1);break;case 2:await s.onFirstRemoteStoreListen(o)}}catch(d){const p=uT(d,`Initialization of query '${pl(e.query)}' failed`);return void e.onError(p)}s.queries.set(o,l),l.ba.push(e),e.va(s.onlineState),l.wa&&e.Fa(l.wa)&&w0(s)}async function Yj(n,e){const s=At(n),a=e.query;let o=3;const l=s.queries.get(a);if(l){const d=l.ba.indexOf(e);d>=0&&(l.ba.splice(d,1),l.ba.length===0?o=e.Da()?0:1:!l.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return s.queries.delete(a),s.onUnlisten(a,!0);case 1:return s.queries.delete(a),s.onUnlisten(a,!1);case 2:return s.onLastRemoteStoreUnlisten(a);default:return}}function Wj(n,e){const s=At(n);let a=!1;for(const o of e){const l=o.query,d=s.queries.get(l);if(d){for(const p of d.ba)p.Fa(o)&&(a=!0);d.wa=o}}a&&w0(s)}function Qj(n,e,s){const a=At(n),o=a.queries.get(e);if(o)for(const l of o.ba)l.onError(s);a.queries.delete(e)}function w0(n){n.Ca.forEach((e=>{e.next()}))}var gg,_1;(_1=gg||(gg={})).Ma="default",_1.Cache="cache";class Kj{constructor(e,s,a){this.query=e,this.xa=s,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=a||{}}Fa(e){if(!this.options.includeMetadataChanges){const a=[];for(const o of e.docChanges)o.type!==3&&a.push(o);e=new Pl(e.query,e.docs,e.oldDocs,a,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let s=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),s=!0):this.La(e,this.onlineState)&&(this.ka(e),s=!0),this.Na=e,s}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let s=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),s=!0),s}La(e,s){if(!e.fromCache||!this.Da())return!0;const a=s!=="Offline";return(!this.options.Ka||!a)&&(!e.docs.isEmpty()||e.hasCachedResults||s==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const s=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!s)&&this.options.includeMetadataChanges===!0}ka(e){e=Pl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==gg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e){this.key=e}}class fT{constructor(e){this.key=e}}class Zj{constructor(e,s){this.query=e,this.Za=s,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=It(),this.mutatedKeys=It(),this.eu=PS(e),this.tu=new Il(this.eu)}get nu(){return this.Za}ru(e,s){const a=s?s.iu:new b1,o=s?s.tu:this.tu;let l=s?s.mutatedKeys:this.mutatedKeys,d=o,p=!1;const m=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,y=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((x,v)=>{const S=o.get(x),I=Vf(this.query,v)?v:null,z=!!S&&this.mutatedKeys.has(S.key),U=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let C=!1;S&&I?S.data.isEqual(I.data)?z!==U&&(a.track({type:3,doc:I}),C=!0):this.su(S,I)||(a.track({type:2,doc:I}),C=!0,(m&&this.eu(I,m)>0||y&&this.eu(I,y)<0)&&(p=!0)):!S&&I?(a.track({type:0,doc:I}),C=!0):S&&!I&&(a.track({type:1,doc:S}),C=!0,(m||y)&&(p=!0)),C&&(I?(d=d.add(I),l=U?l.add(x):l.delete(x)):(d=d.delete(x),l=l.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),l=l.delete(x.key),a.track({type:1,doc:x})}return{tu:d,iu:a,Ss:p,mutatedKeys:l}}su(e,s){return e.hasLocalMutations&&s.hasCommittedMutations&&!s.hasLocalMutations}applyChanges(e,s,a,o){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((x,v)=>(function(I,z){const U=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ot(20277,{Vt:C})}};return U(I)-U(z)})(x.type,v.type)||this.eu(x.doc,v.doc))),this.ou(a),o=o??!1;const p=s&&!o?this._u():[],m=this.Ya.size===0&&this.current&&!o?1:0,y=m!==this.Xa;return this.Xa=m,d.length!==0||y?{snapshot:new Pl(this.query,e.tu,l,d,e.mutatedKeys,m===0,y,!1,!!a&&a.resumeToken.approximateByteSize()>0),au:p}:{au:p}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new b1,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((s=>this.Za=this.Za.add(s))),e.modifiedDocuments.forEach((s=>{})),e.removedDocuments.forEach((s=>this.Za=this.Za.delete(s))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=It(),this.tu.forEach((a=>{this.uu(a.key)&&(this.Ya=this.Ya.add(a.key))}));const s=[];return e.forEach((a=>{this.Ya.has(a)||s.push(new fT(a))})),this.Ya.forEach((a=>{e.has(a)||s.push(new dT(a))})),s}cu(e){this.Za=e.ks,this.Ya=It();const s=this.ru(e.documents);return this.applyChanges(s,!0)}lu(){return Pl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const S0="SyncEngine";class Xj{constructor(e,s,a){this.query=e,this.targetId=s,this.view=a}}class Jj{constructor(e){this.key=e,this.hu=!1}}class ek{constructor(e,s,a,o,l,d){this.localStore=e,this.remoteStore=s,this.eventManager=a,this.sharedClientState=o,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new No((p=>US(p)),Pf),this.Iu=new Map,this.Eu=new Set,this.Ru=new En(et.comparator),this.Au=new Map,this.Vu=new p0,this.du={},this.mu=new Map,this.fu=Dl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function tk(n,e,s=!0){const a=yT(n);let o;const l=a.Tu.get(e);return l?(a.sharedClientState.addLocalQueryTarget(l.targetId),o=l.view.lu()):o=await hT(a,e,s,!0),o}async function nk(n,e){const s=yT(n);await hT(s,e,!0,!1)}async function hT(n,e,s,a){const o=await Sj(n.localStore,Jr(e)),l=o.targetId,d=n.sharedClientState.addLocalQueryTarget(l,s);let p;return a&&(p=await sk(n,e,l,d==="current",o.resumeToken)),n.isPrimaryClient&&s&&oT(n.remoteStore,o),p}async function sk(n,e,s,a,o){n.pu=(v,S,I)=>(async function(U,C,M,B){let F=C.view.ru(M);F.Ss&&(F=await f1(U.localStore,C.query,!1).then((({documents:A})=>C.view.ru(A,F))));const H=B&&B.targetChanges.get(C.targetId),q=B&&B.targetMismatches.get(C.targetId)!=null,Y=C.view.applyChanges(F,U.isPrimaryClient,H,q);return w1(U,C.targetId,Y.au),Y.snapshot})(n,v,S,I);const l=await f1(n.localStore,e,!0),d=new Zj(e,l.ks),p=d.ru(l.documents),m=vu.createSynthesizedTargetChangeForCurrentChange(s,a&&n.onlineState!=="Offline",o),y=d.applyChanges(p,n.isPrimaryClient,m);w1(n,s,y.au);const x=new Xj(e,s,d);return n.Tu.set(e,x),n.Iu.has(s)?n.Iu.get(s).push(e):n.Iu.set(s,[e]),y.snapshot}async function rk(n,e,s){const a=At(n),o=a.Tu.get(e),l=a.Iu.get(o.targetId);if(l.length>1)return a.Iu.set(o.targetId,l.filter((d=>!Pf(d,e)))),void a.Tu.delete(e);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(o.targetId),a.sharedClientState.isActiveQueryTarget(o.targetId)||await pg(a.localStore,o.targetId,!1).then((()=>{a.sharedClientState.clearQueryState(o.targetId),s&&x0(a.remoteStore,o.targetId),yg(a,o.targetId)})).catch(kf)):(yg(a,o.targetId),await pg(a.localStore,o.targetId,!0))}async function ak(n,e){const s=At(n),a=s.Tu.get(e),o=s.Iu.get(a.targetId);s.isPrimaryClient&&o.length===1&&(s.sharedClientState.removeLocalQueryTarget(a.targetId),x0(s.remoteStore,a.targetId))}async function pT(n,e){const s=At(n);try{const a=await Ej(s.localStore,e);e.targetChanges.forEach(((o,l)=>{const d=s.Au.get(l);d&&(rn(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?rn(d.hu,14607):o.removedDocuments.size>0&&(rn(d.hu,42227),d.hu=!1))})),await gT(s,a,e)}catch(a){await kf(a)}}function E1(n,e,s){const a=At(n);if(a.isPrimaryClient&&s===0||!a.isPrimaryClient&&s===1){const o=[];a.Tu.forEach(((l,d)=>{const p=d.view.va(e);p.snapshot&&o.push(p.snapshot)})),(function(d,p){const m=At(d);m.onlineState=p;let y=!1;m.queries.forEach(((x,v)=>{for(const S of v.ba)S.va(p)&&(y=!0)})),y&&w0(m)})(a.eventManager,e),o.length&&a.Pu.J_(o),a.onlineState=e,a.isPrimaryClient&&a.sharedClientState.setOnlineState(e)}}async function ik(n,e,s){const a=At(n);a.sharedClientState.updateQueryState(e,"rejected",s);const o=a.Au.get(e),l=o&&o.key;if(l){let d=new En(et.comparator);d=d.insert(l,os.newNoDocument(l,it.min()));const p=It().add(l),m=new Ff(it.min(),new Map,new En(Et),d,p);await pT(a,m),a.Ru=a.Ru.remove(l),a.Au.delete(e),T0(a)}else await pg(a.localStore,e,!1).then((()=>yg(a,e,s))).catch(kf)}function yg(n,e,s=null){n.sharedClientState.removeLocalQueryTarget(e);for(const a of n.Iu.get(e))n.Tu.delete(a),s&&n.Pu.yu(a,s);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((a=>{n.Vu.containsKey(a)||mT(n,a)}))}function mT(n,e){n.Eu.delete(e.path.canonicalString());const s=n.Ru.get(e);s!==null&&(x0(n.remoteStore,s),n.Ru=n.Ru.remove(e),n.Au.delete(s),T0(n))}function w1(n,e,s){for(const a of s)a instanceof dT?(n.Vu.addReference(a.key,e),ok(n,a)):a instanceof fT?(ze(S0,"Document no longer in limbo: "+a.key),n.Vu.removeReference(a.key,e),n.Vu.containsKey(a.key)||mT(n,a.key)):ot(19791,{wu:a})}function ok(n,e){const s=e.key,a=s.path.canonicalString();n.Ru.get(s)||n.Eu.has(a)||(ze(S0,"New document in limbo: "+s),n.Eu.add(a),T0(n))}function T0(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const s=new et(sn.fromString(e)),a=n.fu.next();n.Au.set(a,new Jj(s)),n.Ru=n.Ru.insert(s,a),oT(n.remoteStore,new ui(Jr(u0(s.path)),a,"TargetPurposeLimboResolution",Lf.ce))}}async function gT(n,e,s){const a=At(n),o=[],l=[],d=[];a.Tu.isEmpty()||(a.Tu.forEach(((p,m)=>{d.push(a.pu(m,e,s).then((y=>{var x;if((y||s)&&a.isPrimaryClient){const v=y?!y.fromCache:(x=s==null?void 0:s.targetChanges.get(m.targetId))==null?void 0:x.current;a.sharedClientState.updateQueryState(m.targetId,v?"current":"not-current")}if(y){o.push(y);const v=g0.Es(m.targetId,y);l.push(v)}})))})),await Promise.all(d),a.Pu.J_(o),await(async function(m,y){const x=At(m);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>Te.forEach(y,(S=>Te.forEach(S.Ts,(I=>x.persistence.referenceDelegate.addReference(v,S.targetId,I))).next((()=>Te.forEach(S.Is,(I=>x.persistence.referenceDelegate.removeReference(v,S.targetId,I)))))))))}catch(v){if(!Bl(v))throw v;ze(y0,"Failed to update sequence numbers: "+v)}for(const v of y){const S=v.targetId;if(!v.fromCache){const I=x.vs.get(S),z=I.snapshotVersion,U=I.withLastLimboFreeSnapshotVersion(z);x.vs=x.vs.insert(S,U)}}})(a.localStore,l))}async function lk(n,e){const s=At(n);if(!s.currentUser.isEqual(e)){ze(S0,"User change. New user:",e.toKey());const a=await sT(s.localStore,e);s.currentUser=e,(function(l,d){l.mu.forEach((p=>{p.forEach((m=>{m.reject(new Qe(Re.CANCELLED,d))}))})),l.mu.clear()})(s,"'waitForPendingWrites' promise is rejected due to a user change."),s.sharedClientState.handleUserChange(e,a.removedBatchIds,a.addedBatchIds),await gT(s,a.Ns)}}function ck(n,e){const s=At(n),a=s.Au.get(e);if(a&&a.hu)return It().add(a.key);{let o=It();const l=s.Iu.get(e);if(!l)return o;for(const d of l){const p=s.Tu.get(d);o=o.unionWith(p.view.nu)}return o}}function yT(n){const e=At(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=pT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ck.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ik.bind(null,e),e.Pu.J_=Wj.bind(null,e.eventManager),e.Pu.yu=Qj.bind(null,e.eventManager),e}class _f{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=aT(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,s){return null}Mu(e,s){return null}vu(e){return _j(this.persistence,new xj,e.initialUser,this.serializer)}Cu(e){return new nT(m0.Vi,this.serializer)}Du(e){return new Aj}async terminate(){var e,s;(e=this.gcScheduler)==null||e.stop(),(s=this.indexBackfillerScheduler)==null||s.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_f.provider={build:()=>new _f};class uk extends _f{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,s){rn(this.persistence.referenceDelegate instanceof vf,46915);const a=this.persistence.referenceDelegate.garbageCollector;return new sj(a,e.asyncQueue,s)}Cu(e){const s=this.cacheSizeBytes!==void 0?Ns.withCacheSize(this.cacheSizeBytes):Ns.DEFAULT;return new nT((a=>vf.Vi(a,s)),this.serializer)}}class xg{async initialize(e,s){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(s),this.remoteStore=this.createRemoteStore(s),this.eventManager=this.createEventManager(s),this.syncEngine=this.createSyncEngine(s,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>E1(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=lk.bind(null,this.syncEngine),await Hj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new qj})()}createDatastore(e){const s=aT(e.databaseInfo.databaseId),a=Oj(e.databaseInfo);return Dj(e.authCredentials,e.appCheckCredentials,a,s)}createRemoteStore(e){return(function(a,o,l,d,p){return new Pj(a,o,l,d,p)})(this.localStore,this.datastore,e.asyncQueue,(s=>E1(this.syncEngine,s,0)),(function(){return m1.v()?new m1:new Ij})())}createSyncEngine(e,s){return(function(o,l,d,p,m,y,x){const v=new ek(o,l,d,p,m,y);return x&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,s)}async terminate(){var e,s;await(async function(o){const l=At(o);ze(Ul,"RemoteStore shutting down."),l.Ea.add(5),await _u(l),l.Aa.shutdown(),l.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(s=this.eventManager)==null||s.terminate()}}xg.provider={build:()=>new xg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dk{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ma("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,s){setTimeout((()=>{this.muted||e(s)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti="FirestoreClient";class fk{constructor(e,s,a,o,l){this.authCredentials=e,this.appCheckCredentials=s,this.asyncQueue=a,this._databaseInfo=o,this.user=is.UNAUTHENTICATED,this.clientId=a0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(a,(async d=>{ze(Ti,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(a,(d=>(ze(Ti,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ho;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(s){const a=uT(s,"Failed to shutdown persistence");e.reject(a)}})),e.promise}}async function um(n,e){n.asyncQueue.verifyOperationInProgress(),ze(Ti,"Initializing OfflineComponentProvider");const s=n.configuration;await e.initialize(s);let a=s.initialUser;n.setCredentialChangeListener((async o=>{a.isEqual(o)||(await sT(e.localStore,o),a=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function S1(n,e){n.asyncQueue.verifyOperationInProgress();const s=await hk(n);ze(Ti,"Initializing OnlineComponentProvider"),await e.initialize(s,n.configuration),n.setCredentialChangeListener((a=>x1(e.remoteStore,a))),n.setAppCheckTokenChangeListener(((a,o)=>x1(e.remoteStore,o))),n._onlineComponents=e}async function hk(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ze(Ti,"Using user provided OfflineComponentProvider");try{await um(n,n._uninitializedComponentsProvider._offline)}catch(e){const s=e;if(!(function(o){return o.name==="FirebaseError"?o.code===Re.FAILED_PRECONDITION||o.code===Re.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(s))throw s;To("Error using user provided cache. Falling back to memory cache: "+s),await um(n,new _f)}}else ze(Ti,"Using default OfflineComponentProvider"),await um(n,new uk(void 0));return n._offlineComponents}async function pk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ze(Ti,"Using user provided OnlineComponentProvider"),await S1(n,n._uninitializedComponentsProvider._online)):(ze(Ti,"Using default OnlineComponentProvider"),await S1(n,new xg))),n._onlineComponents}async function mk(n){const e=await pk(n),s=e.eventManager;return s.onListen=tk.bind(null,e.syncEngine),s.onUnlisten=rk.bind(null,e.syncEngine),s.onFirstRemoteStoreListen=nk.bind(null,e.syncEngine),s.onLastRemoteStoreUnlisten=ak.bind(null,e.syncEngine),s}function gk(n,e,s={}){const a=new ho;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,p,m,y){const x=new dk({next:S=>{x.Nu(),d.enqueueAndForget((()=>Yj(l,v)));const I=S.docs.has(p);!I&&S.fromCache?y.reject(new Qe(Re.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&S.fromCache&&m&&m.source==="server"?y.reject(new Qe(Re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(S)},error:S=>y.reject(S)}),v=new Kj(u0(p.path),x,{includeMetadataChanges:!0,Ka:!0});return $j(l,v)})(await mk(n),n.asyncQueue,e,s,a))),a.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xT(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yk="ComponentProvider",T1=new Map;function xk(n,e,s,a,o){return new YR(n,e,s,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,xT(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,a)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT="firestore.googleapis.com",A1=!0;class I1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Qe(Re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=bT,this.ssl=A1}else this.host=e.host,this.ssl=e.ssl??A1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=tT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<tj)throw new Qe(Re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=xT(e.experimentalLongPollingOptions??{}),(function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Qe(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Qe(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Qe(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(a,o){return a.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class A0{constructor(e,s,a,o){this._authCredentials=e,this._appCheckCredentials=s,this._databaseId=a,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new I1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Qe(Re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Qe(Re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new I1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(a){if(!a)return new ER;switch(a.type){case"firstParty":return new AR(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new Qe(Re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(s){const a=T1.get(s);a&&(ze(yk,"Removing Datastore"),T1.delete(s),a.terminate())})(this),Promise.resolve()}}function bk(n,e,s,a={}){var y;n=ng(n,A0);const o=n0(e),l=n._getSettings(),d={...l,emulatorOptions:n._getEmulatorOptions()},p=`${e}:${s}`;o&&(WN(`https://${p}`),XN("Firestore",!0)),l.host!==bT&&l.host!==p&&To("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...l,host:p,ssl:o,emulatorOptions:a};if(!ff(m,d)&&(n._setSettings(m),a.mockUserToken)){let x,v;if(typeof a.mockUserToken=="string")x=a.mockUserToken,v=is.MOCK_USER;else{x=QN(a.mockUserToken,(y=n._app)==null?void 0:y.options.projectId);const S=a.mockUserToken.sub||a.mockUserToken.user_id;if(!S)throw new Qe(Re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new is(S)}n._authCredentials=new wR(new SS(x,v))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(e,s,a){this.converter=s,this._query=a,this.type="query",this.firestore=e}withConverter(e){return new I0(this.firestore,e,this._query)}}class ys{constructor(e,s,a){this.converter=s,this._key=a,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ys(this.firestore,e,this._key)}toJSON(){return{type:ys._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,s,a){if(xu(s,ys._jsonSchema))return new ys(e,a||null,new et(sn.fromString(s.referencePath)))}}ys._jsonSchemaVersion="firestore/documentReference/1.0",ys._jsonSchema={type:On("string",ys._jsonSchemaVersion),referencePath:On("string")};class fu extends I0{constructor(e,s,a){super(e,s,u0(a)),this._path=a,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ys(this.firestore,null,new et(e))}withConverter(e){return new fu(this.firestore,e,this._path)}}function vk(n,e,...s){if(n=uS(n),arguments.length===1&&(e=a0.newId()),jR("doc","path",e),n instanceof A0){const a=sn.fromString(e,...s);return zv(a),new ys(n,null,new et(a))}{if(!(n instanceof ys||n instanceof fu))throw new Qe(Re.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const a=n._path.child(sn.fromString(e,...s));return zv(a),new ys(n.firestore,n instanceof fu?n.converter:null,new et(a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N1="AsyncQueue";class C1{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new iT(this,"async_queue_retry"),this._c=()=>{const a=cm();a&&ze(N1,"Visibility state changed to "+a.visibilityState),this.M_.w_()},this.ac=e;const s=cm();s&&typeof s.addEventListener=="function"&&s.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const s=cm();s&&typeof s.removeEventListener=="function"&&s.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const s=new ho;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(s.resolve,s.reject),s.promise))).then((()=>s.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Bl(e))throw e;ze(N1,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const s=this.ac.then((()=>(this.rc=!0,e().catch((a=>{throw this.nc=a,this.rc=!1,Ma("INTERNAL UNHANDLED ERROR: ",R1(a)),a})).then((a=>(this.rc=!1,a))))));return this.ac=s,s}enqueueAfterDelay(e,s,a){this.uc(),this.oc.indexOf(e)>-1&&(s=0);const o=E0.createAndSchedule(this,e,s,a,(l=>this.hc(l)));return this.tc.push(o),o}uc(){this.nc&&ot(47125,{Pc:R1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const s of this.tc)if(s.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((s,a)=>s.targetTimeMs-a.targetTimeMs));for(const s of this.tc)if(s.skipDelay(),e!=="all"&&s.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const s=this.tc.indexOf(e);this.tc.splice(s,1)}}function R1(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class vT extends A0{constructor(e,s,a,o){super(e,s,a,o),this.type="firestore",this._queue=new C1,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new C1(e),this._firestoreClient=void 0,await e}}}function _k(n,e){const s=typeof n=="object"?n:lR(),a=typeof n=="string"?n:mf,o=sR(s,"firestore").getImmediate({identifier:a});if(!o._initialized){const l=$N("firestore");l&&bk(o,...l)}return o}function Ek(n){if(n._terminated)throw new Qe(Re.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||wk(n),n._firestoreClient}function wk(n){var a,o,l,d;const e=n._freezeSettings(),s=xk(n._databaseId,((a=n._app)==null?void 0:a.options.appId)||"",n._persistenceKey,(o=n._app)==null?void 0:o.options.apiKey,e);n._componentsProvider||(l=e.localCache)!=null&&l._offlineComponentProvider&&((d=e.localCache)!=null&&d._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new fk(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(m){const y=m==null?void 0:m._online.build();return{_offline:m==null?void 0:m._offline.build(y),_online:y}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zr(Jn.fromBase64String(e))}catch(s){throw new Qe(Re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+s)}}static fromUint8Array(e){return new Zr(Jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Zr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(xu(e,Zr._jsonSchema))return Zr.fromBase64String(e.bytes)}}Zr._jsonSchemaVersion="firestore/bytes/1.0",Zr._jsonSchema={type:On("string",Zr._jsonSchemaVersion),bytes:On("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(...e){for(let s=0;s<e.length;++s)if(e[s].length===0)throw new Qe(Re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gs(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,s){if(!isFinite(e)||e<-90||e>90)throw new Qe(Re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(s)||s<-180||s>180)throw new Qe(Re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+s);this._lat=e,this._long=s}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Et(this._lat,e._lat)||Et(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:gi._jsonSchemaVersion}}static fromJSON(e){if(xu(e,gi._jsonSchema))return new gi(e.latitude,e.longitude)}}gi._jsonSchemaVersion="firestore/geoPoint/1.0",gi._jsonSchema={type:On("string",gi._jsonSchemaVersion),latitude:On("number"),longitude:On("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e){this._values=(e||[]).map((s=>s))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(a,o){if(a.length!==o.length)return!1;for(let l=0;l<a.length;++l)if(a[l]!==o[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:yi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(xu(e,yi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((s=>typeof s=="number")))return new yi(e.vectorValues);throw new Qe(Re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}yi._jsonSchemaVersion="firestore/vectorValue/1.0",yi._jsonSchema={type:On("string",yi._jsonSchemaVersion),vectorValues:On("object")};function ET(n,e,s){if((e=uS(e))instanceof _T)return e._internalPath;if(typeof e=="string")return Tk(n,e);throw bg("Field path arguments must be of type string or ",n)}const Sk=new RegExp("[~\\*/\\[\\]]");function Tk(n,e,s){if(e.search(Sk)>=0)throw bg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new _T(...e.split("."))._internalPath}catch{throw bg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function bg(n,e,s,a,o){let l=`Function ${e}() called with invalid data`;l+=". ";let d="";return new Qe(Re.INVALID_ARGUMENT,l+n+d)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{convertValue(e,s="none"){switch(wi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _n(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,s);case 5:return e.stringValue;case 6:return this.convertBytes(Ei(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,s);case 11:return this.convertObject(e.mapValue,s);case 10:return this.convertVectorValue(e.mapValue);default:throw ot(62114,{value:e})}}convertObject(e,s){return this.convertObjectMap(e.fields,s)}convertObjectMap(e,s="none"){const a={};return bu(e,((o,l)=>{a[o]=this.convertValue(l,s)})),a}convertVectorValue(e){var a,o,l;const s=(l=(o=(a=e.fields)==null?void 0:a[rg].arrayValue)==null?void 0:o.values)==null?void 0:l.map((d=>_n(d.doubleValue)));return new yi(s)}convertGeoPoint(e){return new gi(_n(e.latitude),_n(e.longitude))}convertArray(e,s){return(e.values||[]).map((a=>this.convertValue(a,s)))}convertServerTimestamp(e,s){switch(s){case"previous":const a=Df(e);return a==null?null:this.convertValue(a,s);case"estimate":return this.convertTimestamp(cu(e));default:return null}}convertTimestamp(e){const s=_i(e);return new Rn(s.seconds,s.nanos)}convertDocumentKey(e,s){const a=sn.fromString(e);rn(eT(a),9688,{name:e});const o=new uu(a.get(1),a.get(3)),l=new et(a.popFirst(5));return o.isEqual(s)||Ma(`Document ${l} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${s.projectId}/${s.database}) instead.`),l}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik extends Ak{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zr(e)}convertReference(e){const s=this.convertDocumentKey(e,this.firestore._databaseId);return new ys(this.firestore,null,s)}}const O1="@firebase/firestore",j1="4.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(e,s,a,o,l){this._firestore=e,this._userDataWriter=s,this._key=a,this._document=o,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new ys(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Nk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const s=this._document.data.field(ET("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s)}}}class Nk extends wT{data(){return super.data()}}class zc{constructor(e,s){this.hasPendingWrites=e,this.fromCache=s}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class mo extends wT{constructor(e,s,a,o,l,d){super(e,s,a,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const s=new af(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(s,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,s={}){if(this._document){const a=this._document.data.field(ET("DocumentSnapshot.get",e));if(a!==null)return this._userDataWriter.convertValue(a,s.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Qe(Re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,s={};return s.type=mo._jsonSchemaVersion,s.bundle="",s.bundleSource="DocumentSnapshot",s.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?s:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),s.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),s)}}mo._jsonSchemaVersion="firestore/documentSnapshot/1.0",mo._jsonSchema={type:On("string",mo._jsonSchemaVersion),bundleSource:On("string","DocumentSnapshot"),bundleName:On("string"),bundle:On("string")};class af extends mo{data(e={}){return super.data(e)}}class tu{constructor(e,s,a,o){this._firestore=e,this._userDataWriter=s,this._snapshot=o,this.metadata=new zc(o.hasPendingWrites,o.fromCache),this.query=a}get docs(){const e=[];return this.forEach((s=>e.push(s))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,s){this._snapshot.docs.forEach((a=>{e.call(s,new af(this._firestore,this._userDataWriter,a.key,a,new zc(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const s=!!e.includeMetadataChanges;if(s&&this._snapshot.excludesMetadataChanges)throw new Qe(Re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===s||(this._cachedChanges=(function(o,l){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((p=>{const m=new af(o._firestore,o._userDataWriter,p.doc.key,p.doc,new zc(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);return p.doc,{type:"added",doc:m,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((p=>l||p.type!==3)).map((p=>{const m=new af(o._firestore,o._userDataWriter,p.doc.key,p.doc,new zc(o._snapshot.mutatedKeys.has(p.doc.key),o._snapshot.fromCache),o.query.converter);let y=-1,x=-1;return p.type!==0&&(y=d.indexOf(p.doc.key),d=d.delete(p.doc.key)),p.type!==1&&(d=d.add(p.doc),x=d.indexOf(p.doc.key)),{type:Ck(p.type),doc:m,oldIndex:y,newIndex:x}}))}})(this,s),this._cachedChangesIncludeMetadataChanges=s),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Qe(Re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=tu._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=a0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const s=[],a=[],o=[];return this.docs.forEach((l=>{l._document!==null&&(s.push(l._document),a.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),o.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Ck(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ot(61501,{type:n})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */tu._jsonSchemaVersion="firestore/querySnapshot/1.0",tu._jsonSchema={type:On("string",tu._jsonSchemaVersion),bundleSource:On("string","QuerySnapshot"),bundleName:On("string"),bundle:On("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rk(n){n=ng(n,ys);const e=ng(n.firestore,vT),s=Ek(e);return gk(s,n._key).then((a=>Ok(e,n,a)))}function Ok(n,e,s){const a=s.docs.get(e._key),o=new Ik(n);return new mo(n,o,e._key,a,new zc(s.hasPendingWrites,s.fromCache),e.converter)}(function(e,s=!0){_R(oR),pf(new iu("firestore",((a,{instanceIdentifier:o,options:l})=>{const d=a.getProvider("app").getImmediate(),p=new vT(new SR(a.getProvider("auth-internal")),new IR(d,a.getProvider("app-check-internal")),WR(d,o),d);return l={useFetchStreams:s,...l},p._setSettings(l),p}),"PUBLIC").setMultipleInstances(!0)),Sl(O1,j1,e),Sl(O1,j1,"esm2020")})();const jk={apiKey:"...",authDomain:"...",projectId:"vocabpro-5604c"},kk=pS(jk),Lk=_k(kk);async function k1(){try{console.log("Attempting to get current host from Firebase...");const n=vk(Lk,"vocabpro","server");console.log("Fetching document from Firestore...");const e=await Rk(n);if(console.log("Received response from Firestore:",e.exists()?e.data():"No document"),!e.exists())return console.log("Document does not exist"),null;const s=e.data();return{host:s.host||null,local:s.local||null}}catch(n){return console.error("Firebase error:",n),null}}const Mk=()=>{const{showToast:n}=kr(),{currentUser:e,isLoaded:s,handleLogin:a,handleUpdateUser:o,setCurrentUser:l,shouldSkipAuth:d}=NN(),[p,m]=L.useState("AUTH"),[y,x]=L.useState(!1),[v,S]=L.useState(null),[I,z]=L.useState(null),[U,C]=L.useState(!1),[M,B]=L.useState(Date.now()),[F,H]=L.useState("disconnected"),[q,Y]=L.useState(""),[A,T]=L.useState(()=>Tt().server.useCustomUrl?"outside":"home"),[E,R]=L.useState(null),[N,D]=L.useState(!1),[O,ve]=L.useState(!1),[ye,G]=L.useState("idle"),[ae,ne]=L.useState(""),[Q,X]=L.useState(null),j=L.useRef(!1),V=L.useRef(!1),$=L.useRef(null),[Z,ee]=L.useState(null),[pe,ie]=L.useState(!1),ce=L.useRef(!1),[De,fe]=L.useState(!1),[Se,Oe]=L.useState(!1),[me,ue]=L.useState(null),[ge,Ee]=L.useState(null),[Ae,Ge]=L.useState(null),Ue=L.useCallback(()=>Ge(null),[]),[Ke,Nt]=L.useState(null),Pe=L.useCallback(()=>Nt(null),[]),[oe,Ve]=L.useState(null),lt=L.useCallback(()=>Ve(null),[]),[ct,nt]=L.useState(null),pt=L.useCallback(()=>nt(null),[]),[qt,Pt]=L.useState(null),Os=L.useCallback(()=>Pt(null),[]),[kn,Zt]=L.useState(null),be=L.useCallback(()=>Zt(null),[]),[Le,Ne]=L.useState([]),[yt,rt]=L.useState(!1),Me=L.useRef(!1),[st,ht]=L.useState(!1),[Xe,Dt]=L.useState(""),{sessionWords:vt,setSessionWords:ln,sessionType:vs,sessionFocus:_s,startSession:Xt,clearSessionState:$n}=CN({setView:m,setIsSidebarOpen:x}),{stats:na,wotd:qs,apiUsage:sa,refreshGlobalStats:Dr,isWotdComposed:ra,randomizeWotd:pr}=LN({currentUser:e,onUpdateUser:o}),js=L.useCallback(async(je,ke)=>{const $e=new AbortController,qe=setTimeout(()=>$e.abort(),1200),Ye=()=>$e.abort();ke==null||ke.addEventListener("abort",Ye);try{const tt=await fetch(`${je}/api/health`,{signal:$e.signal,mode:"cors"});return clearTimeout(qe),ke==null||ke.removeEventListener("abort",Ye),tt.ok}catch(tt){clearTimeout(qe),ke==null||ke.removeEventListener("abort",Ye);const We=tt&&tt.message?String(tt.message).toLowerCase():"";return je.startsWith("https://")&&!$e.signal.aborted&&(We.includes("certificate")||We.includes("ssl")||We.includes("secure"))?(console.warn("[SSL] Confirmed certificate issue at:",je,tt),X(je),"ssl_error"):!1}},[]),yn=L.useCallback(async(je=!1,ke,$e=!1,qe)=>{if(V.current)return console.log("[AutoConnect] Skip: already connecting"),!1;V.current=!0;const Ye=Tt();let tt;if(A==="home"){const We={...Ye,server:{...Ye.server,useCustomUrl:!1}};tt=Vn(We)}else tt=ke||Vn(Ye);if(Y(tt),!$e){ne(tt);const We=await js(tt,qe);if(We===!0){if(H("connected"),Ye.sync.autoBackupEnabled||Yr({...Ye,sync:{...Ye.sync,autoBackupEnabled:!0}},!0),ke){const jt={...Ye,server:{...Ye.server,useCustomUrl:!0,customUrl:ke},sync:{...Ye.sync,autoBackupEnabled:!0}};Yr(jt,!0),n(`Connected to ${ke}`,"success")}return V.current=!1,!0}if(We==="ssl_error")return console.warn("[AutoConnect] SSL error during initial attempt. Hard stop."),H("disconnected"),V.current=!1,!1}if(!ke&&je||$e){if(qe!=null&&qe.aborted)return!1;try{const We=await k1();if(console.log("[AutoConnect] Firebase data:",We),We!=null&&We.local){console.log("[AutoConnect] Firebase LOCAL raw:",We.local);const jt=new URL(We.local),Ln=jt.port||"443",kt=`https://localhost:${Ln}`;console.log("[AutoConnect] Trying LOCALHOST first:",kt),ne(kt);let fn=await js(kt,qe);if(console.log("[AutoConnect] LOCALHOST result:",fn),fn===!0){Y(kt),H("connected"),T("home");const Mn={...Ye,server:{...Ye.server,host:"localhost",port:Number(Ln)||443,useCustomUrl:!1,customUrl:""}};return(Ye.server.host!=="localhost"||Ye.server.port!==(Number(Ln)||443)||Ye.server.useCustomUrl||!!Ye.server.customUrl)&&Yr(Mn,!0),n(`Connected to ${kt}`,"success"),V.current=!1,!0}if(fn==="ssl_error")return console.warn("[AutoConnect] SSL error at localhost. Hard stop."),H("disconnected"),V.current=!1,!1;if(console.log("[AutoConnect] Fallback to Firebase LOCAL hostname:",We.local),ne(We.local),fn=await js(We.local,qe),console.log("[AutoConnect] Firebase LOCAL result:",fn),fn===!0){Y(We.local),H("connected"),T("home");const Mn={...Ye,server:{...Ye.server,host:jt.hostname,port:Number(Ln)||443,useCustomUrl:!1,customUrl:""}};return(Ye.server.host!==jt.hostname||Ye.server.port!==(Number(Ln)||443)||Ye.server.useCustomUrl||!!Ye.server.customUrl)&&Yr(Mn,!0),n(`Connected to ${We.local}`,"success"),V.current=!1,!0}if(fn==="ssl_error")return console.warn("[AutoConnect] SSL error detected. Hard stop."),H("disconnected"),V.current=!1,!1}if(!Q&&(We!=null&&We.host)){console.log("[AutoConnect] Trying PUBLIC:",We.host),ne(We.host);const jt=await js(We.host,qe);if(console.log("[AutoConnect] PUBLIC result:",jt),jt){Y(We.host),H("connected"),T("outside");const Ln={...Ye,server:{...Ye.server,useCustomUrl:!0,customUrl:We.host}};return(!Ye.server.useCustomUrl||Ye.server.customUrl!==We.host)&&Yr(Ln,!0),n(`Connected to ${We.host}`,"success"),V.current=!1,!0}}}catch(We){console.warn("[Firebase] Failed to fetch host:",We)}}return qe!=null&&qe.aborted||H("disconnected"),V.current=!1,!1},[n,A,js,Q]),cs=L.useCallback(async je=>{if(N||V.current)return!1;D(!0),R(je),G("scanning");try{const ke=await k1(),$e=Tt();if(je==="home"){if(!(ke!=null&&ke.local))return n("Home server URL not found on Firebase.","error"),G("failed"),!1;const We=new URL(ke.local).port||"443",jt=[`https://localhost:${We}`,ke.local];let Ln=null;for(const kt of jt){ne(kt),kt.startsWith("https://")&&(Ln=kt);const fn=await js(kt);if(fn===!0){const Mn=new URL(kt),mr={...$e,server:{...$e.server,host:Mn.hostname,port:Number(Mn.port||We)||443,useCustomUrl:!1,customUrl:""}};return Yr(mr,!0),T("home"),Y(kt),H("connected"),G("success"),n(`Connected to ${kt}`,"success"),!0}if(fn==="ssl_error")return G("failed"),!1}return Ln&&!Q?(X(Ln),G("failed"),!1):(n("Failed to switch to Home server.","error"),R(null),G("failed"),!1)}if(!(ke!=null&&ke.host))return n("Public server URL not found on Firebase.","error"),R(null),G("failed"),!1;ne(ke.host);const qe=await js(ke.host);if(qe!==!0){if(qe!=="ssl_error"){if(ke.host.startsWith("https://")&&!Q)return X(ke.host),G("failed"),!1;n("Failed to switch to Public server.","error"),R(null)}return G("failed"),!1}const Ye={...$e,server:{...$e.server,useCustomUrl:!0,customUrl:ke.host}};return Yr(Ye,!0),T("outside"),Y(ke.host),H("connected"),R(null),G("success"),n(`Connected to ${ke.host}`,"success"),!0}catch(ke){return console.warn("[ServerToggle] Failed to switch mode:",ke),n("Failed to switch server mode.","error"),R(null),G("failed"),!1}finally{D(!1)}},[N,js,n,Q]),cn=L.useCallback(async()=>{if(E){await cs(E);return}await yn(!0)},[E,cs,yn]),wn=async je=>{if(je)T("outside");else{T("home");const $e=Tt(),qe={...$e,server:{...$e.server,useCustomUrl:!1,customUrl:""}};Yr(qe,!0)}$.current&&$.current.abort(),$.current=new AbortController;const ke=$.current.signal;G("scanning");try{await new Promise((qe,Ye)=>{const tt=setTimeout(qe,800);ke.addEventListener("abort",()=>{clearTimeout(tt),Ye(new Error("aborted"))})});const $e=await yn(!je,je,!je,ke);return ke.aborted?!1:$e?(G("success"),setTimeout(()=>ve(!1),1e3),!0):(G("failed"),!1)}catch($e){return $e.message==="aborted"||G("failed"),!1}},$s=()=>{$.current&&($.current.abort(),$.current=null),G("failed")},aa=L.useCallback(()=>e&&e.id===Yc&&e.name==="Vocab Master",[e]);L.useEffect(()=>{if(s&&!j.current){j.current=!0;const je=new AbortController,ke=async()=>{try{const We=Tt().server.useCustomUrl?"outside":"home";T(We),await yn(!0,void 0,We==="home",je.signal)}catch(tt){console.warn("[AutoConnect] Failed:",tt)}},$e=window.setTimeout(()=>{ke()},80),qe=setInterval(()=>{const We=Tt().server.useCustomUrl?"outside":"home";T(We),yn(!1,void 0,!1)},3e4),Ye=()=>{const We=Tt().server.useCustomUrl?"outside":"home";T(We),yn(!0,void 0,!1)};return window.addEventListener("config-updated",Ye),()=>{clearTimeout($e),je.abort(),clearInterval(qe),window.removeEventListener("config-updated",Ye)}}},[s,yn]),L.useEffect(()=>{const ke=setTimeout(async()=>{if(!(!s||F!=="connected"||!e||ce.current||O||yt)){ce.current=!0;try{const $e=await Vd(),qe=e.name||e.id,Ye=$e.find(tt=>tt.id===qe||tt.name===qe);if(Ye){const tt=new Date(Ye.date).getTime(),We=Number(localStorage.getItem("vocab_pro_local_last_modified")||0),jt=2e3;tt>We+jt?ee({isOpen:!0,type:"restore",localDate:We===0?"Never":new Date(We).toLocaleString(),serverDate:new Date(tt).toLocaleString(),serverId:Ye.id,serverMtime:tt}):We>tt+jt&&ee({isOpen:!0,type:"push",localDate:new Date(We).toLocaleString(),serverDate:new Date(tt).toLocaleString(),serverId:Ye.id,serverMtime:tt})}}catch($e){console.warn("[Sync] Initial check failed:",$e)}}},2e3);return()=>clearTimeout(ke)},[s,F,e==null?void 0:e.id,O,yt]),L.useEffect(()=>{const ke=setTimeout(async()=>{if(Me.current)return;const $e=sessionStorage.getItem("vocab_pro_suppress_auto_restore")==="true";if(s&&F==="connected"&&aa()&&!O&&!$e){Me.current=!0;try{const qe=await Vd();qe&&qe.length>0&&(Ne(qe),rt(!0))}catch(qe){console.warn("[AutoRestore] Failed to fetch backups on init:",qe)}}},1e3);return()=>clearTimeout(ke)},[s,F,aa,O]);const{lastBackupTime:Hl,refreshBackupTime:Ai,handleBackup:Ii,restoreFromServerAction:ks,triggerLocalRestore:ia,handleLibraryReset:Ys,deleteWord:Es,bulkDeleteWords:us,bulkUpdateWords:Ws}=MN({currentUser:e,setView:m,refreshGlobalStats:Dr,sessionWords:vt,setSessionWords:ln,globalViewWord:v,setGlobalViewWord:S,onUpdateUser:o}),un=async je=>{ee(null),rt(!1),ie(!0);try{const $e=(await Vd()).find(Ye=>Ye.id===je),qe=$e?new Date($e.date).getTime():void 0;await ks(je,qe),ie(!1)}catch{ie(!1),n("Restore failed.","error")}},Ni=()=>{rt(!1),ia()},Ci=async()=>{sessionStorage.setItem("vocab_pro_suppress_auto_restore","true"),rt(!1),ht(!0),Dt("Wiping all data and preparing new profile...");try{await eS();const je=await Pg(!0);je&&(a(je),m("SETTINGS"),n("Welcome! Your data has been wiped. Please set up your new profile.","success"))}catch{n("Failed to prepare new profile.","error")}finally{ht(!1)}},Qs=async()=>{if(!await yn(!0)){ve(!0),G("failed");return}if(sessionStorage.removeItem("vocab_pro_suppress_auto_restore"),Me.current=!1,e&&e.id!==Yc){n("Syncing current profile...","info");try{await ef(e.id,e,!0)}catch{n("Backup failed, proceeding...","error")}}try{await rS();const ke=await Vd();Ne(ke),rt(!0)}catch{n("Failed to fetch user list from server.","error")}},Ks=async()=>{if(e){ie(!0);try{await ef(e.id,e,!0),n("Cloud backup updated!","success"),ee(null)}catch{n("Push failed.","error")}finally{ie(!1)}}},Ri=async()=>{if(Z){ie(!0);try{await ks(Z.serverId,Z.serverMtime),ee(null),ie(!1)}catch{n("Restore failed.","error"),ie(!1)}}};L.useEffect(()=>{const je=()=>{window.isRestoring||fe(!0)},ke=()=>{fe(!1),ue(null)},$e=Ye=>{const tt=Ye;tt.detail&&tt.detail.targetTime&&ue(tt.detail.targetTime)},qe=Ye=>{const tt=Ye;tt.detail&&(tt.detail.success?(fe(!1),ue(null),Ai(),n("Cloud sync complete!","success",2e3)):fe(!0))};return window.addEventListener("datastore-updated",je),window.addEventListener("vocab-pro-restore-complete",ke),window.addEventListener("backup-scheduled",$e),window.addEventListener("backup-complete",qe),()=>{window.removeEventListener("datastore-updated",je),window.removeEventListener("vocab-pro-restore-complete",ke),window.removeEventListener("backup-scheduled",$e),window.removeEventListener("backup-complete",qe)}},[Ai,n]);const Oi=async()=>{if(!e)return;const je=nS(),{learned:ke,reviewed:$e}=je.dayProgress,qe=new Date().toISOString().split("T")[0],Ye=Math.floor(ke/3),tt=Math.floor($e/10),We=Ye+tt,jt=e.adventure,Ln=jt.lastDailyEnergyAwardDate||"";let kt=jt.dailyEnergyAwarded||0;if(Ln!==qe&&(kt=0),We>kt){const fn=We-kt,Mn={...e,adventure:{...jt,energy:(jt.energy||0)+fn,dailyEnergyAwarded:We,lastDailyEnergyAwardDate:qe}};await o(Mn),n(`Daily Progress: +${fn} Energy `,"success",2e3)}};L.useEffect(()=>{s&&e&&Oi()},[na,s,e==null?void 0:e.id]);const ji=async je=>{const ke=Sv(je.id);(!ke||ke.masteryScore!==je.masteryScore)&&B(Date.now()),await jf(je),vt&&ln($e=>($e||[]).map(qe=>qe.id===je.id?je:qe)),v&&v.id===je.id&&S(je)},ki=async()=>{e&&(Ym(),fe(!1),ue(null),await ef(e.id,e,!0))},Da=async()=>{F==="connected"&&e?await ki():await Ii()},ds=async je=>{await Ws(je)},dn=async(je,ke)=>{await vN(je,ke),l(ke);const $e=Sv(je.id);(!$e||$e.masteryScore!==je.masteryScore)&&B(Date.now()),vt&&ln(qe=>(qe||[]).map(Ye=>Ye.id===je.id?je:Ye)),v&&v.id===je.id&&S(je)},{gainExperienceAndLevelUp:Sn,recalculateXpAndLevelUp:Ur,xpGained:Li,xpToNextLevel:Ot}=ON({currentUser:e,onUpdateUser:o,onSaveWordAndUser:dn});L.useEffect(()=>{s&&(d&&e?m("DASHBOARD"):e||m("AUTH"))},[s,d,e==null?void 0:e.id]);const oa=async je=>{je.id!==Yc&&sessionStorage.removeItem("vocab_pro_suppress_auto_restore"),je.adventure.map||(je.adventure.map=Wc(100),await fr(je)),l(je),localStorage.setItem("vocab_pro_current_user_id",je.id),localStorage.setItem("vocab_pro_current_user_name",je.name),await fr({...je,lastLogin:Date.now()})},Zs=()=>{l(null),localStorage.removeItem("vocab_pro_current_user_id")},Xs=L.useCallback(()=>{$n(),m("DASHBOARD"),Dr()},[$n,Dr]),ts=L.useCallback(()=>{if(!vt||vt.length===0||!vs){Xs();return}const je=vt.map($e=>$e.id),ke=fi().filter($e=>je.includes($e.id));ke.length>0?Xt(ke,vs,_s):Xs()},[vt,vs,_s,Xt,Xs]),la=L.useCallback(async()=>{if(!e)return;const je=fi(),ke=Date.now(),$e=je.filter(qe=>!qe.isPassive&&qe.lastReview&&qe.nextReview<=ke&&qe.quality!=="FAILED").sort((qe,Ye)=>qe.nextReview-Ye.nextReview).slice(0,30);if($e.length===0){n("No words due for review!","success");return}Xt($e,"due")},[e,Xt,n]),Mi=L.useCallback(async()=>{if(!e)return;const ke=fi().filter($e=>!$e.isPassive&&!$e.lastReview&&$e.quality==="VERIFIED").sort(($e,qe)=>$e.createdAt-qe.createdAt).slice(0,20);if(ke.length===0){n("No new words to learn!","success");return}Xt(ke,"new")},[e,Xt,n]);return{view:p,setView:m,currentUser:e,isLoaded:s,isResetting:st,resetStep:Xe,isSidebarOpen:y,setIsSidebarOpen:x,handleLogin:oa,handleLogout:Zs,handleUpdateUser:o,sessionWords:vt,sessionFocus:_s,sessionType:vs,startSession:Xt,handleSessionComplete:Xs,stats:na,wotd:qs,refreshGlobalStats:Dr,isWotdComposed:ra,randomizeWotd:pr,globalViewWord:v,setGlobalViewWord:S,lastBackupTime:Hl,handleBackup:Da,triggerLocalBackup:Ii,triggerServerBackup:ki,restoreFromServerAction:un,triggerLocalRestore:ia,handleLibraryReset:Ys,initialListFilter:I,setInitialListFilter:z,forceExpandAdd:U,setForceExpandAdd:C,apiUsage:sa,updateWord:ji,deleteWord:Es,bulkDeleteWords:us,bulkUpdateWords:ds,handleNavigateToList:je=>{z(je),m("BROWSE")},openAddWordLibrary:()=>{m("BROWSE"),C(!0)},clearSessionState:$n,handleRetrySession:ts,gainExperienceAndLevelUp:Sn,recalculateXpAndLevelUp:Ur,xpGained:Li,xpToNextLevel:Ot,startDueReviewSession:la,startNewLearnSession:Mi,lastMasteryScoreUpdateTimestamp:M,writingContextWord:ge,handleComposeWithWord:je=>{Ee(je),m("WRITING")},consumeWritingContext:()=>Ee(null),targetLessonId:Ae,setTargetLessonId:Ge,consumeTargetLessonId:Ue,targetLessonTag:Ke,consumeTargetLessonTag:Pe,targetLessonType:oe,consumeTargetLessonType:lt,targetCourseId:ct,consumeTargetCourseId:pt,targetGameMode:qt,consumeTargetGameMode:Os,planningAction:kn,setPlanningAction:Zt,consumePlanningAction:be,serverStatus:F,serverUrl:q,networkMode:A,isSwitchingServerMode:N,handleToggleServerMode:cs,sslIssueUrl:Q,setSslIssueUrl:X,hasUnsavedChanges:De,hasWritingUnsavedChanges:Se,setHasWritingUnsavedChanges:Oe,nextAutoBackupTime:me,isAutoRestoreOpen:yt,setIsAutoRestoreOpen:rt,autoRestoreCandidates:Le,handleNewUserSetup:Ci,handleLocalRestoreSetup:Ni,handleSwitchUser:Qs,isConnectionModalOpen:O,setIsConnectionModalOpen:ve,connectionScanStatus:ye,scanningUrl:ae,handleScanAndConnect:wn,handleStopScan:$s,syncPrompt:Z,setSyncPrompt:ee,isSyncing:pe,handleSyncPush:Ks,handleSyncRestore:Ri,checkServerConnection:yn,retrySslConnection:cn,handleSpecialAction:(je,ke)=>{switch(je){case"REVIEW":la();break;case"BROWSE":Mi();break;case"LESSON":ke&&ke.lessonId&&Ge(ke.lessonId),m("LESSON");break;case"LESSON_ONLY":Ve("ESSAY"),m("LESSON");break;case"LESSON_GRAMMAR":nt("grammar"),m("COURSE");break;case"LESSON_SCALE":Ve("INTENSITY"),m("LESSON");break;case"LESSON_DIFF":Ve("COMPARISON"),m("LESSON");break;case"LESSON_MISTAKE":Ve("MISTAKE"),m("LESSON");break;case"IRREGULAR_VERBS":m("IRREGULAR_VERBS");break;case"MIMIC":m("MIMIC");break;case"PRONUNCIATION_ROADMAP":nt("pronunciation_roadmap"),m("COURSE");break;case"PLAN_AI":Zt("AI"),m("PLANNING");break;case"PLAN_IMPORT":Zt("IMPORT"),m("PLANNING");break;case"COLLO_CONNECT":case"DICTATION":case"SENTENCE_SCRAMBLE":case"MEANING_MATCH":case"IPA_SORTER":case"PREPOSITION_POWER":case"WORD_TRANSFORMER":case"PARAPHRASE_CONTEXT":case"IDIOM_CONNECT":case"WORD_SCATTER":case"NATURAL_EXPRESSION":case"INTENSITY_SCALE":case"COMPARISON_LAB":case"MISTAKE_RECOGNITION":case"ADVENTURE":sessionStorage.setItem("dashboard_active_tab","PRACTICE"),Pt(je),m("DISCOVER");break;default:m(je)}}}},Dk="modulepreload",Uk=function(n){return"/ielts-pro/"+n},L1={},bs=function(e,s,a){let o=Promise.resolve();if(s&&s.length>0){let d=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const p=document.querySelector("meta[property=csp-nonce]"),m=(p==null?void 0:p.nonce)||(p==null?void 0:p.getAttribute("nonce"));o=d(s.map(y=>{if(y=Uk(y),y in L1)return;L1[y]=!0;const x=y.endsWith(".css"),v=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${v}`))return;const S=document.createElement("link");if(S.rel=x?"stylesheet":Dk,x||(S.as="script"),S.crossOrigin="",S.href=y,m&&S.setAttribute("nonce",m),document.head.appendChild(S),x)return new Promise((I,z)=>{S.addEventListener("load",I),S.addEventListener("error",()=>z(new Error(`Unable to preload CSS for ${y}`)))})}))}function l(d){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=d,window.dispatchEvent(p),!p.defaultPrevented)throw d}return o.then(d=>{for(const p of d||[])p.status==="rejected"&&l(p.reason);return e().catch(l)})};function Pk(n,e="Vietnamese"){return`You are an expert IELTS coach, examiner, and native English speaker.
    
    Analyze this list of vocabulary items: [${n.map(a=>`"${a}"`).join(", ")}].

    IMPORTANT RULES FOR HEADWORD (hw) IDENTIFICATION:
    1. FOR PHRASES/IDIOMS/EXPRESSIONS: If the input is a multi-word unit (e.g., "cut the road", "break the ice", "get over"), the headword (hw) MUST be the EXACT phrase provided. DO NOT reduce it to a single word.
    2. FOR SINGLE WORDS: If the input is a single inflected word, identify its base form and ensure it is in SINGULAR form (e.g., "running" -> "run", "cities" -> "city", "problems" -> "problem").
    3. All details (meaning, IPA, examples) MUST correspond to the identified headword (the whole phrase or the base word).
    4. If input has multiple distinct meanings as a phrase vs a single word, prioritize the meaning of the input as provided.
    5. If input is adverb, use the base adjective as headword.

    LANGUAGE RULES:
    - All content in English, except "m" (Meaning) which must be in ${e}.

    FIELD GENERATION RULES:
    - If the headword (hw) is a PHRASE, PHRASAL VERB, or IDIOM (e.g., "break the ice"):
      - DO NOT generate 'fam' (word family). Return an empty object {} or null.
      - DO NOT generate 'col' (collocations). Return an empty array [].
    - Do NOT generate 'para' (paraphrase) for orthographic variants (e.g., space vs no space, hyphen vs no hyphen).

    RESPONSE OPTIMIZATION:
    - Omit "og" if it is identical to "hw".
    - Omit "ipa_uk" if "pron_sim" is "same".

    FIELD DEFINITIONS:
    - og: The EXACT string from the input list. (Include ONLY if different from "hw").
    - hw: The headword (Full phrase for expressions; base form for single words).
    - ipa_us: Primary IPA transcription (General American).
    - ipa_uk: Received Pronunciation (UK) IPA. (Omit if "pron_sim" is "same").
    - pron_sim: Similarity between US and UK pronunciation. MUST be: "same", "near", or "different".
    - ipa_m: Array of 2-4 common mispronunciation transcriptions (to test the user).
    - m: Definition of the headword in ${e}.
    - reg: Register. MUST be one of: "academic", "casual", or "neutral".
    - ex: A high-quality example sentence using the headword.
    - col: Array of 3-5 collocations. ONLY for single-word headwords. Items: {"text": "phrase", "d": "minimal descriptive cue for recall (5-10 words)"}.
    - idm: Array of 1-3 common idioms containing the headword (only if hw is a single word). Items: {"text": "phrase", "d": "descriptive cue"}.
    - prep: Array of dependent prepositions. If the headword does NOT take a fixed preposition, return an empty array []. Format: [{"p": "preposition", "c": "short usage example"}].
    - para: Controlled paraphrase system (max 5 items total). ONLY generate categories if a natural equivalent exists. Try to force all tone types but avoid unnatural versions.        - Each item MUST be an object: {"w": "word_or_phrase", "t": "tone_type", "c": "recall cue"}.
        - 't' (tone) MUST be one of: "academic", "casual", "synonym" (no hypernyms or hyponyms)
        - 'c' (context) = a short (2-5 words) situational recall cue (e.g., "job interview", "arguing with friend").
    - fam: Word family. ONLY for single-word headwords. 'n'=nouns, 'v'=verbs, 'j'=adjectives, 'adv'=adverbs. Format: [{"w": "word"}].
    - type: The grammatical classification. MUST be one of: "idiom", "phrasal_verb", "collocation", "phrase", "vocabulary", "irregular_verb".
    - is_pas: Boolean. True if the word is "Passive" (vulgar, slang, or should be archived).

    Response Example (Return in code block format Strict JSON Array):
    [{
      "hw": "unhappy",
      "ipa_us": "/nhpi/",
      "pron_sim": "same",
      "ipa_m": ["/nhepi/"],
      "m": "khng vui, bun",
      "reg": "neutral",
      "ex": "She was unhappy with the results of the experiment.",
      "col": [{"text": "deeply unhappy", "d": "extreme sadness about a life event"}],
      "idm": [],
      "prep": [{"p": "with", "c": "unhappy with the service"}], 
      "para": [
        { "w": "dissatisfied", "t": "academic", "c": "complaining about product quality" },
        { "w": "miserable", "t": "intensified", "c": "sitting alone in the rain" }
      ],
      "type": "vocabulary",
      "is_pas": false,
      "fam": { "n": [{"w": "unhappiness"}], "adv": [{"w": "unhappily"}] }
    }]`}function Vk(n){return`You are an expert English linguist.
    
    TASK: Provide the principal parts (past simple and past participle) for the following list of irregular verbs: [${n.map(s=>`"${s}"`).join(", ")}].

    RULES:
    1.  For each verb, provide its V1 (base form), V2 (past simple), and V3 (past participle).
    2.  If a verb has multiple common forms (e.g., "dreamt" / "dreamed"), provide the most common one first.
    3.  If a word is not an irregular verb, return its regular "-ed" forms.
    
    Return in code block format your analysis as a strict JSON array of objects. Each object must contain "v1", "v2", and "v3".

    Response Example (Strict JSON Array):
    [
      {
        "v1": "go",
        "v2": "went",
        "v3": "gone"
      },
      {
        "v1": "begin",
        "v2": "began",
        "v3": "begun"
      },
      {
        "v1": "dream",
        "v2": "dreamt",
        "v3": "dreamt"
      }
    ]`}function zk(n,e){var a,o,l;const s={word:n.word,meaning:n.meaningVi,family:n.wordFamily,collocations:(a=n.collocationsArray)==null?void 0:a.map(d=>d.text),idioms:(o=n.idiomsList)==null?void 0:o.map(d=>d.text),paraphrases:(l=n.paraphrases)==null?void 0:l.map(d=>({word:d.word,tone:d.tone,context:d.context}))};return`You are an expert IELTS coach and English teacher. Your task is to provide learning recommendations for a vocabulary item based on a user's profile.

    USER PROFILE:
    - Role: ${e.role||"N/A"}
    - Current Level: ${e.currentLevel||"N/A"}
    - Target: ${e.target||"N/A"}

    VOCABULARY ITEM TO ANALYZE:
    ${JSON.stringify(s,null,2)}

    INSTRUCTIONS:
    1.  Analyze all components of the vocabulary item (word family, collocations, idioms, paraphrases).
    2.  Based on the USER PROFILE, decide whether each component is essential to learn ('learn') or can be ignored for now ('ignore').
    3.  Provide a concise, sharp 'reason' for each decision. Your reasoning is the most important part.
    4.  Be strict. For an IELTS learner, prioritize academic, high-impact, and flexible vocabulary. For a beginner, prioritize core meanings and common usage.

    EXAMPLE REASONING:
    - For an IELTS goal, if a paraphrase is "the process of a liquid turning into a gas," you should suggest 'ignore' and reason: "This is too descriptive and wordy for IELTS. A single academic term like 'evaporation' is more effective and scores higher for lexical resource."
    - For a primary school student goal, you might suggest 'learn' for the same phrase, reasoning: "This simple explanation is great for building foundational understanding before learning the scientific term."
    - For a common idiom, you might suggest 'learn' for an IELTS student: "Essential for demonstrating natural, native-like language in Speaking Part 1."

    Return in code block format a single, strict JSON object. Do not include any text outside the JSON block.

    STRICT JSON OUTPUT FORMAT:
    {
      "overall_summary": "string (A one-sentence summary of the learning strategy for this word, based on the user's goal.)",
      "wordFamily": [
        { "item": "string (the word form)", "suggestion": "learn" | "ignore", "reason": "string (your concise explanation)" }
      ],
      "collocations": [
        { "item": "string (the collocation)", "suggestion": "learn" | "ignore", "reason": "string" }
      ],
      "idioms": [
        { "item": "string (the idiom)", "suggestion": "learn" | "ignore", "reason": "string" }
      ],
      "paraphrases": [
        { "item": "string (the paraphrase word)", "suggestion": "learn" | "ignore", "reason": "string" }
      ]
    }
    `}function Bk(n,e,s){var l,d,p,m;const a=e.language||"English",o={word:n.word,meaning:n.meaningVi,family:n.wordFamily,collocations:(l=n.collocationsArray)==null?void 0:l.filter(y=>!y.isIgnored).map(y=>({text:y.text,hint:y.d})),idioms:(d=n.idiomsList)==null?void 0:d.filter(y=>!y.isIgnored).map(y=>({text:y.text,hint:y.d})),paraphrases:(p=n.paraphrases)==null?void 0:p.filter(y=>!y.isIgnored).map(y=>({word:y.word,tone:y.tone,context:y.context})),prepositions:(m=n.prepositions)==null?void 0:m.filter(y=>!y.isIgnored)};return`You are an expert IELTS coach${s?` named '${s}'`:""}. 
  
  TASK: Generate a highly structured "Usage Guide" for the word: "${n.word}".
  
  DATA: ${JSON.stringify(o)}

  INSTRUCTIONS:
  1. Create 5 distinct sections, each containing a Markdown Table:
     - **Prepositions**
     - **Word Family**
     - **Collocations**
     - **Variations (Paraphrases)**
     - **Idioms**
  
  2. Each table MUST have exactly these 3 columns:
     - **Word**: The specific form, collocation, or phrase.
     - **Context**: A brief explanation of *when* or *how* to use it (nuance, tone, or grammatical rule).
     - **Examples**: EXACTLY one high-quality, natural example sentence using that specific item.

  3. CONSTRAINTS:
     - Use ONLY Markdown tables for the usage data.
     - For line breaks WITHIN a table cell, use \`<br>\`. Do NOT use \`\\n\` or \`\\\\n\` inside table rows.
     - You MUST provide at least 1 example for every single item listed in the tables.
     - Keep the "Context" column concise (max 15 words).
     - If no data exists for a category (e.g., no idioms), you may skip that section or note it as "No common idioms".
     - All instructional text and headers should be in ${a}. All material/examples in English.

  Return in code block format a JSON object:
  {
    "content": "string (Markdown formatted with headers and tables, use \\n for newlines)"
  }`}function Fk(n,e,s){var l,d,p;const a=e.language||"English",o={word:n.word,meaning:n.meaningVi,collocations:(l=n.collocationsArray)==null?void 0:l.filter(m=>!m.isIgnored).map(m=>({text:m.text,hint:m.d})),idioms:(d=n.idiomsList)==null?void 0:d.filter(m=>!m.isIgnored).map(m=>({text:m.text,hint:m.d})),paraphrases:(p=n.paraphrases)==null?void 0:p.filter(m=>!m.isIgnored).map(m=>({word:m.word,tone:m.tone,context:m.context}))};return`You are an expert IELTS examiner${s?` working with coach '${s}'`:""}. Design an interactive PRACTICE TEST for: "${n.word}".
    
    DATA: ${JSON.stringify(o)}

    AVAILABLE TAGS:
    - [Select: Correct | Wrong 1 | Wrong 2] (Dropdown)
    - [Multi: Correct | Option 2 | Option 3] (Multiple Choice Buttons)
    - [Quiz: Answer] (Fill-in)

    TASK:
    Generate 5-8 questions covering:
    1. Nuanced collocation choice.
    2. Meaning selection.
    3. Sentence completion with correct word forms.
    4. Synonym selection for specific contexts.

    LANGUAGE: Instructions in ${a}, questions in English.

    Return a JSON object:
    {
      "content": "string (Markdown with interactive tags)"
    }`}const Hk=()=>`Transcribe the text contained in this image exactly as it appears. 
    - Maintain the original language.
    - Do not add introductory or concluding remarks. 
    - If there is no text, return "No text detected."`,Gk=n=>{if(!n)return null;const e=C=>Array.isArray(C)?C.map(M=>typeof M=="string"?{word:M}:M&&(M.w||M.word)?{word:M.w||M.word,isIgnored:M.g??M.isIgnored}:null).filter(M=>M!==null&&!!M.word):[],s=C=>(C==null?void 0:C.map(M=>({word:M.w||M.word,tone:M.t||M.tone,context:M.c||M.context,isIgnored:M.g??M.isIgnored??!1})))||[],a=C=>Array.isArray(C)?C.map(M=>typeof M=="string"?{prep:M.trim(),usage:""}:{prep:(M.p||M.prep||"").trim(),usage:(M.c||M.usage||"").trim(),isIgnored:M.g??M.isIgnored??!1}).filter(M=>M.prep.length>0):[],o=C=>Array.isArray(C)?C.map(B=>{if(typeof B=="string")return{text:B,isIgnored:!1};const F=B.text||B.x;if(F){const H=B.d||B.ds;return{text:F,d:H,isIgnored:B.g??B.isIgnored??!1}}return null}).filter(B=>B!==null&&!!B.text):void 0;let l;Array.isArray(n.prepositionsArray)?l=n.prepositionsArray:Array.isArray(n.prep)&&(l=a(n.prep));const d=n.col||n.collocations;let p,m;Array.isArray(d)?(p=o(d),p&&(m=p.map(C=>C.text).join(`
`))):typeof d=="string"&&(m=d);const y=n.idm||n.idioms;let x;Array.isArray(y)&&(x=o(y));const v=n.hw||n.headword,S=n.pron_sim||n.pronSim||n.ps,I=n.ipa_us||n.ipaUs||n.ipa||n.i,z=n.type,U={isIdiom:z==="idiom",isPhrasalVerb:z==="phrasal_verb",isCollocation:z==="collocation",isStandardPhrase:z==="phrase",isIrregular:z==="irregular_verb"};return{original:n.og||n.original||v,headword:v,ipaUs:I,ipaUk:n.ipa_uk||n.ipaUk||(S==="same"?I:void 0),pronSim:S,ipaMistakes:n.ipa_m||n.ipaMistakes||n.im,meaningVi:n.m||n.meaningVi,register:n.reg||n.register,example:n.ex||n.example,collocations:m,collocationsArray:p,idioms:x?x.map(C=>C.text).join(`
`):void 0,idiomsList:x,prepositionString:typeof n.prep=="string"?n.prep:void 0,prepositionsArray:l,isIdiom:z?U.isIdiom:n.is_id??n.isIdiom,isPhrasalVerb:z?U.isPhrasalVerb:n.is_pv??n.isPhrasalVerb,isCollocation:z?U.isCollocation:n.is_col??n.isCollocation,isStandardPhrase:z?U.isStandardPhrase:n.is_phr??n.isStandardPhrase,isIrregular:z?U.isIrregular:n.is_irr??n.isIrregular,isPassive:n.is_pas??n.isPassive,paraphrases:s(n.para||n.paraphrases),wordFamily:n.fam?{nouns:e(n.fam.n||n.fam.ns||[]),verbs:e(n.fam.v||[]),adjs:e(n.fam.j||[]),advs:e(n.fam.adv||n.fam.d||[])}:n.wordFamily||void 0}},qk=(n,e)=>{const s=Gk(e);if(!s)return n;const a={...n};a.ipaUs=s.ipaUs??n.ipaUs,a.ipaUk=s.ipaUk??n.ipaUk,a.pronSim=s.pronSim??n.pronSim,a.ipaMistakes=s.ipaMistakes??n.ipaMistakes,a.meaningVi=s.meaningVi??n.meaningVi,a.register=s.register??n.register;let l=[...n.collocationsArray||(n.collocations?n.collocations.split(`
`).map(y=>({text:y.trim(),isIgnored:!1})).filter(y=>y.text):[])];s.collocationsArray&&s.collocationsArray.forEach(y=>{const x=l.findIndex(v=>v.text.toLowerCase()===y.text.toLowerCase());x!==-1?(y.d&&!l[x].d&&(l[x].d=y.d),y.isIgnored&&(l[x].isIgnored=!0)):l.push({text:y.text,d:y.d,isIgnored:y.isIgnored||!1})}),a.collocationsArray=l,a.collocations=l.map(y=>y.text).join(`
`);let p=[...n.idiomsList||(n.idioms?n.idioms.split(`
`).map(y=>({text:y.trim(),isIgnored:!1})).filter(y=>y.text):[])];s.idiomsList&&s.idiomsList.forEach(y=>{const x=p.findIndex(v=>v.text.toLowerCase()===y.text.toLowerCase());x!==-1?(y.d&&!p[x].d&&(p[x].d=y.d),y.isIgnored&&(p[x].isIgnored=!0)):p.push({text:y.text,d:y.d,isIgnored:y.isIgnored||!1})}),a.idiomsList=p,a.idioms=p.map(y=>y.text).join(`
`);let m=n.prepositions||[];if(s.prepositionsArray&&Array.isArray(s.prepositionsArray)&&s.prepositionsArray.length>0){const y=s.prepositionsArray,x=[...m];y.forEach(v=>{v.prep&&(x.some(I=>I.prep.toLowerCase()===v.prep.toLowerCase()&&I.usage.toLowerCase()===v.usage.toLowerCase())||x.push({...v,isIgnored:v.isIgnored||!1}))}),m=x}if(a.prepositions=m.length>0?m:void 0,s.wordFamily&&(a.wordFamily=s.wordFamily),s.paraphrases&&Array.isArray(s.paraphrases)){const y=n.paraphrases||[],x=s.paraphrases,v=[...y];x.forEach(S=>{v.some(I=>I.word.toLowerCase()===S.word.toLowerCase())||v.push(S)}),a.paraphrases=v}if(s.example){let y=n.example||"";y.toLowerCase().includes(s.example.toLowerCase())||(y=y.trim()?`${y}
${s.example}`:s.example),a.example=y}return a.isIdiom=s.isIdiom!==void 0?!!s.isIdiom:n.isIdiom,a.isPhrasalVerb=s.isPhrasalVerb!==void 0?!!s.isPhrasalVerb:n.isPhrasalVerb,a.isCollocation=s.isCollocation!==void 0?!!s.isCollocation:n.isCollocation,a.isStandardPhrase=s.isStandardPhrase!==void 0?!!s.isStandardPhrase:n.isStandardPhrase,a.isIrregular=s.isIrregular!==void 0?!!s.isIrregular:n.isIrregular,a.isPassive=s.isPassive!==void 0?!!s.isPassive:n.isPassive,a.quality=Yt.REFINED,a.complexity=Mr(a),a.masteryScore=Rs(a),a.gameEligibility=Lr(a),a.updatedAt=Date.now(),a},M1=({label:n,options:e,selectedId:s,onSelect:a,buttonClass:o,disabled:l=!1})=>{const[d,p]=L.useState(!1),m=L.useRef(null),y=e.find(x=>x.id===s)||e[0];return L.useEffect(()=>{const x=v=>{m.current&&!m.current.contains(v.target)&&p(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),u.jsxs("div",{className:"relative",ref:m,children:[u.jsxs("button",{type:"button",onClick:()=>p(!d),className:o,disabled:l,children:[n&&u.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-neutral-400",children:n}),y.icon,u.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:y.label}),u.jsx(LE,{size:14,className:`transition-transform duration-200 ${d?"rotate-180":""}`})]}),d&&!l&&u.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-2xl shadow-xl border border-neutral-100 z-50 p-2 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col gap-1",children:e.map(x=>u.jsxs("button",{type:"button",onClick:()=>{a(x.id),p(!1)},className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-xs font-bold transition-colors ${s===x.id?"bg-neutral-100 text-neutral-900":"text-neutral-600 hover:bg-neutral-50 hover:text-neutral-900"}`,children:[x.icon,u.jsx("span",{children:x.label})]},x.id))})]})},ul=({title:n,items:e,onUpdate:s,onToggleIgnore:a,onRemove:o,onAdd:l,placeholders:d,showDescription:p=!1})=>u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:n}),u.jsxs("div",{className:"space-y-2 p-3 bg-neutral-50 border border-neutral-200 rounded-2xl",children:[(e||[]).map((m,y)=>u.jsxs("div",{className:`bg-white p-2 rounded-lg border border-neutral-100 flex items-start gap-2 group transition-opacity ${m.isIgnored?"opacity-50":""}`,children:[u.jsxs("div",{className:"flex-1 space-y-1",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("input",{type:"text",value:m.text,onChange:x=>s(y,"text",x.target.value),placeholder:d.text,className:"flex-1 px-3 py-2 bg-neutral-50/50 border border-neutral-200 rounded-lg text-xs font-bold focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"})}),p&&u.jsx("input",{type:"text",value:m.d||"",onChange:x=>s(y,"d",x.target.value),placeholder:d.d,className:"w-full px-3 py-1 bg-neutral-50/50 border border-transparent rounded-lg text-[10px] font-medium text-neutral-500 focus:bg-white focus:ring-1 focus:ring-neutral-900 focus:border-neutral-200 outline-none"})]}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("button",{type:"button",onClick:()=>a(y),className:"p-2 text-neutral-400 hover:text-neutral-700 rounded-lg hover:bg-neutral-100",children:m.isIgnored?u.jsx(zm,{size:14}):u.jsx(ru,{size:14})}),u.jsx("button",{type:"button",onClick:()=>o(y),className:"p-2 text-neutral-400 hover:text-red-500 rounded-lg hover:bg-red-50",children:u.jsx(jn,{size:14})})]})]},y)),u.jsxs("button",{type:"button",onClick:l,className:"w-full text-center py-2 bg-white hover:bg-neutral-100 text-neutral-400 hover:text-neutral-700 rounded-lg text-xs font-bold transition-colors flex items-center justify-center gap-1.5 border border-neutral-200 shadow-sm",children:[u.jsx(Xr,{size:12})," Add"]})]})]}),$k=n=>{var q,Y,A,T;const{onClose:e,onSwitchToView:s,formData:a,setFormData:o,setFlag:l,familyHandler:d,prepList:p,collocList:m,idiomList:y,paraList:x,handleSubmit:v,onOpenAiRefine:S,onSuggestLearn:I,hasSuggestions:z}=n,[U,C]=L.useState("MAIN"),M=[{id:"MAIN",label:"Main",icon:X2},{id:"DETAILS",label:"Details",icon:HE},{id:"CONNECTIONS",label:"Links",icon:yI},{id:"USAGE",label:"Usage & Test",icon:lf}],B=[{id:Yt.RAW,label:"Raw",icon:u.jsx(VE,{size:14,className:"text-neutral-400"})},{id:Yt.REFINED,label:"Refined",icon:u.jsx(ZE,{size:14,className:"text-indigo-500"})},{id:Yt.VERIFIED,label:"Verified",icon:u.jsx(WE,{size:14,className:"text-emerald-500"})},{id:Yt.FAILED,label:"Incorrect",icon:u.jsx(QE,{size:14,className:"text-rose-500"})}],F=[{id:"NEW",label:"New",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"})},{id:Ut.LEARNED,label:"Learned",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-cyan-500"})},{id:Ut.FORGOT,label:"Forgot",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-rose-500"})},{id:Ut.HARD,label:"Hard",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"})},{id:Ut.EASY,label:"Easy",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}],H=["intensified","softened","synonym","academic","casual"];return u.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-4xl rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[95vh]",children:[u.jsxs("header",{className:"px-6 py-4 border-b border-neutral-100 flex flex-col gap-4 shrink-0 bg-white/80 backdrop-blur-sm z-10",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("button",{onClick:s,className:"p-2 bg-neutral-100 hover:bg-neutral-200 rounded-lg text-neutral-500 transition-colors",children:u.jsx(jE,{size:16})}),u.jsx("h3",{className:"font-black text-lg text-neutral-900 leading-none",children:"Edit Word"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{type:"button",onClick:I,title:z?"View Suggestions":"Get Learning Suggestions",className:`px-3 py-2 border rounded-lg font-black text-[10px] flex items-center justify-center space-x-1.5 hover:bg-neutral-50 active:scale-95 transition-all shadow-sm ${z?"bg-amber-50 border-amber-200 text-amber-700":"bg-white border-neutral-200 text-neutral-600"}`,children:[u.jsx(Og,{size:12,className:z?"text-amber-500":"text-neutral-400"}),u.jsx("span",{children:z?"View Suggestion":"Suggest"})]}),u.jsxs("button",{type:"button",onClick:S,className:"px-3 py-2 bg-white border border-neutral-200 text-neutral-600 rounded-lg font-black text-[10px] flex items-center justify-center space-x-1.5 hover:bg-neutral-50 active:scale-95 transition-all shadow-sm",children:[u.jsx(Ol,{size:12,className:"text-amber-500"}),u.jsx("span",{children:"Manual AI"})]}),u.jsxs("button",{type:"button",onClick:()=>v(),className:"px-5 py-2 bg-neutral-900 text-white rounded-lg font-black text-[10px] flex items-center justify-center space-x-1.5 hover:bg-neutral-800 active:scale-95 transition-all shadow-md shadow-neutral-900/10",children:[u.jsx(YE,{size:12}),u.jsx("span",{children:"Save"})]}),u.jsx("button",{onClick:e,className:"p-2 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 rounded-full transition-colors ml-2",children:u.jsx(jn,{size:18})})]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[u.jsx("div",{className:"flex bg-neutral-100 p-1 rounded-xl w-fit",children:M.map(({id:E,label:R,icon:N})=>u.jsxs("button",{onClick:()=>C(E),className:`px-4 py-2 text-xs font-black rounded-lg transition-all flex items-center gap-2 ${U===E?"bg-white shadow-sm text-neutral-900":"text-neutral-500 hover:text-neutral-800"}`,children:[u.jsx(N,{size:14})," ",R]},E))}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(M1,{label:"Quality",options:B,selectedId:a.quality,onSelect:E=>o("quality",E),buttonClass:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg hover:bg-neutral-100 transition-colors shadow-sm border border-neutral-200"}),u.jsx(M1,{label:"Learn Status",options:F,selectedId:a.studiedStatus,onSelect:E=>o("studiedStatus",E),buttonClass:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg hover:bg-neutral-100 transition-colors shadow-sm border border-neutral-200"})]})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar bg-neutral-50/50",children:u.jsxs("div",{className:"p-6 space-y-6",children:[U==="MAIN"&&u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Headword"}),u.jsx("input",{type:"text",value:a.word,onChange:E=>o("word",E.target.value),className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-lg font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Primary IPA / US"}),u.jsx("input",{type:"text",value:a.ipaUs||"",onChange:E=>o("ipaUs",E.target.value),placeholder:"/.../",className:"w-full px-4 py-2 bg-white border border-neutral-200 rounded-xl font-mono text-base text-neutral-600 focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"IPA UK (Optional)"}),u.jsx("input",{type:"text",value:a.ipaUk||"",onChange:E=>o("ipaUk",E.target.value),placeholder:"/.../",className:"w-full px-4 py-2 bg-white border border-neutral-200 rounded-xl font-mono text-base text-neutral-600 focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Pronunciation Similarity"}),u.jsx("div",{className:"flex bg-neutral-100 p-1 rounded-xl w-full",children:["same","near","different"].map(E=>u.jsx("button",{type:"button",onClick:()=>o("pronSim",E),className:`flex-1 px-4 py-2 text-xs font-black rounded-lg transition-all flex items-center justify-center gap-2 ${a.pronSim===E?"bg-white shadow-sm text-neutral-900":"text-neutral-500 hover:text-neutral-800"}`,children:E.charAt(0).toUpperCase()+E.slice(1)},E))})]})]}),u.jsxs("div",{className:"md:col-span-2 space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Definition / Meaning"}),u.jsx("input",{type:"text",value:a.meaningVi,onChange:E=>o("meaningVi",E.target.value),className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-base font-medium focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"md:col-span-2 space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Examples"}),u.jsx("textarea",{rows:5,value:a.example,onChange:E=>o("example",E.target.value),className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm leading-relaxed resize-y focus:ring-2 focus:ring-neutral-900 outline-none"})]})]}),U==="DETAILS"&&u.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Flags"}),u.jsx("div",{className:"flex flex-wrap gap-2 p-3 bg-white border border-neutral-200 rounded-2xl",children:[{id:"isIdiom",label:"Idiom",icon:If},{id:"isCollocation",label:"Colloc.",icon:Af},{id:"isStandardPhrase",label:"Phrase",icon:jg},{id:"isPhrasalVerb",label:"Phrasal",icon:GE},{id:"isIrregular",label:"Irregular",icon:$E},{id:"isPassive",label:"Archive",icon:a.isPassive?W2:Mg}].map(E=>u.jsxs("button",{type:"button",onClick:()=>l(E.id),className:`flex items-center space-x-1.5 py-1.5 px-3 rounded-lg border transition-all font-bold text-[9px] uppercase tracking-wider ${a[E.id]?"bg-neutral-900 border-neutral-900 text-white shadow-sm":"bg-white border-neutral-200 text-neutral-500 hover:border-neutral-300"}`,children:[u.jsx(E.icon,{size:10}),u.jsx("span",{children:E.label})]},E.id))})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center",children:[u.jsx(kI,{size:10,className:"mr-1"}),"User Groups"]}),u.jsx("input",{type:"text",value:a.groupsString,onChange:E=>o("groupsString",E.target.value),placeholder:"bird_species, env_academic...",className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm focus:ring-1 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"md:col-span-2 space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Register"}),u.jsx("div",{className:"flex bg-neutral-100 p-1 rounded-xl w-fit",children:["raw","neutral","academic","casual"].map(E=>u.jsx("button",{type:"button",onClick:()=>o("register",E),className:`px-4 py-2 text-xs font-black rounded-lg transition-all flex items-center gap-2 ${a.register===E||!a.register&&E==="raw"?"bg-white shadow-sm text-neutral-900":"text-neutral-500 hover:text-neutral-800"}`,children:E.charAt(0).toUpperCase()+E.slice(1)},E))})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center",children:[u.jsx(Cg,{size:10,className:"mr-1"})," Prepositions / Patterns"]}),u.jsxs("div",{className:"space-y-2 p-3 bg-white border border-neutral-200 rounded-2xl",children:[a.prepositionsList.map((E,R)=>u.jsxs("div",{className:`flex items-center gap-2 transition-opacity ${E.isIgnored?"opacity-40":""}`,children:[u.jsx("input",{type:"text",value:E.prep,onChange:N=>p.update(R,{prep:N.target.value}),placeholder:"Prep",className:"w-24 px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-bold focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"}),u.jsx("input",{type:"text",value:E.usage,onChange:N=>p.update(R,{usage:N.target.value}),placeholder:"Usage Context",className:"flex-1 px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-medium focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"}),u.jsx("button",{type:"button",onClick:()=>p.toggleIgnore(R),className:"p-2 text-neutral-400 hover:text-neutral-700 rounded-lg hover:bg-neutral-100",children:E.isIgnored?u.jsx(zm,{size:14}):u.jsx(ru,{size:14})}),u.jsx("button",{type:"button",onClick:()=>p.remove(R),className:"p-2 text-neutral-400 hover:text-red-500 rounded-lg hover:bg-red-50",children:u.jsx(jn,{size:14})})]},R)),u.jsxs("button",{type:"button",onClick:()=>p.add({prep:"",usage:"",isIgnored:!1}),className:"w-full text-center py-2 bg-neutral-50 hover:bg-neutral-100 text-neutral-400 hover:text-neutral-700 rounded-lg text-xs font-bold transition-colors flex items-center justify-center gap-1.5 border border-neutral-200 shadow-sm",children:[u.jsx(Xr,{size:12})," Add Pattern"]})]})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center",children:[u.jsx(II,{size:10,className:"mr-1"})," Private Note"]}),u.jsx("textarea",{rows:3,value:a.note,onChange:E=>o("note",E.target.value),className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm text-neutral-600 resize-y focus:ring-1 focus:ring-neutral-900 outline-none"})]})]}),U==="CONNECTIONS"&&u.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[u.jsx(ul,{title:"Collocations",items:a.collocationsArray,onUpdate:(E,R,N)=>m.update(E,{[R]:N}),onToggleIgnore:m.toggleIgnore,onRemove:m.remove,onAdd:()=>m.add({text:"",d:"",isIgnored:!1}),placeholders:{text:"Collocation phrase...",d:"Descriptive hint..."},showDescription:!0}),u.jsx(ul,{title:"Related Idioms",items:a.idiomsList,onUpdate:(E,R,N)=>y.update(E,{[R]:N}),onToggleIgnore:y.toggleIgnore,onRemove:y.remove,onAdd:()=>y.add({text:"",d:"",isIgnored:!1}),placeholders:{text:"Idiom or phrase...",d:"Descriptive hint..."},showDescription:!0}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Word Family"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(ul,{title:"Nouns",items:(((q=a.wordFamily)==null?void 0:q.nouns)||[]).map(E=>({text:E.word,isIgnored:E.isIgnored})),onUpdate:(E,R,N)=>{R==="text"&&d("nouns").update(E,"word",N)},onToggleIgnore:d("nouns").toggleIgnore,onRemove:d("nouns").remove,onAdd:d("nouns").add,placeholders:{text:"Noun form..."}}),u.jsx(ul,{title:"Verbs",items:(((Y=a.wordFamily)==null?void 0:Y.verbs)||[]).map(E=>({text:E.word,isIgnored:E.isIgnored})),onUpdate:(E,R,N)=>{R==="text"&&d("verbs").update(E,"word",N)},onToggleIgnore:d("verbs").toggleIgnore,onRemove:d("verbs").remove,onAdd:d("verbs").add,placeholders:{text:"Verb form..."}}),u.jsx(ul,{title:"Adjectives",items:(((A=a.wordFamily)==null?void 0:A.adjs)||[]).map(E=>({text:E.word,isIgnored:E.isIgnored})),onUpdate:(E,R,N)=>{R==="text"&&d("adjs").update(E,"word",N)},onToggleIgnore:d("adjs").toggleIgnore,onRemove:d("adjs").remove,onAdd:d("adjs").add,placeholders:{text:"Adjective form..."}}),u.jsx(ul,{title:"Adverbs",items:(((T=a.wordFamily)==null?void 0:T.advs)||[]).map(E=>({text:E.word,isIgnored:E.isIgnored})),onUpdate:(E,R,N)=>{R==="text"&&d("advs").update(E,"word",N)},onToggleIgnore:d("advs").toggleIgnore,onRemove:d("advs").remove,onAdd:d("advs").add,placeholders:{text:"Adverb form..."}})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Nf,{size:10,className:"text-amber-500"})," Word Power & Variations"]}),u.jsxs("div",{className:"space-y-2 p-3 bg-white border border-neutral-200 rounded-2xl",children:[(a.paraphrases||[]).map((E,R)=>u.jsxs("div",{className:`grid grid-cols-[1fr,auto,1fr,auto,auto] items-center gap-2 transition-opacity ${E.isIgnored?"opacity-40":""}`,children:[u.jsx("input",{type:"text",value:E.word,onChange:N=>x.update(R,{word:N.target.value}),placeholder:"Variation...",className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-bold focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"}),u.jsx("select",{value:E.tone,onChange:N=>x.update(R,{tone:N.target.value}),className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-bold focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none appearance-none",children:H.map(N=>u.jsx("option",{value:N,children:N.charAt(0).toUpperCase()+N.slice(1)},N))}),u.jsx("input",{type:"text",value:E.context,onChange:N=>x.update(R,{context:N.target.value}),placeholder:"Context...",className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-medium focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"}),u.jsx("button",{type:"button",onClick:()=>x.toggleIgnore(R),className:"p-2 text-neutral-400 hover:text-neutral-700 rounded-lg hover:bg-neutral-100",children:E.isIgnored?u.jsx(zm,{size:14}):u.jsx(ru,{size:14})}),u.jsx("button",{type:"button",onClick:()=>x.remove(R),className:"p-2 text-neutral-400 hover:text-red-500 rounded-lg hover:bg-red-50",children:u.jsx(jn,{size:14})})]},R)),u.jsxs("button",{type:"button",onClick:()=>x.add({word:"",context:"",tone:"synonym",isIgnored:!1}),className:"w-full text-center py-2 bg-neutral-50 hover:bg-neutral-100 text-neutral-400 hover:text-neutral-700 rounded-lg text-xs font-bold transition-colors flex items-center justify-center gap-1.5 border border-neutral-200 shadow-sm",children:[u.jsx(Xr,{size:12})," Add Variation"]})]})]})]}),U==="USAGE"&&u.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300 h-full flex flex-col",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"flex justify-between items-center px-1",children:u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[u.jsx(lf,{size:12})," Usage Guide (Markdown)"]})}),u.jsx("textarea",{value:a.essayEdit,onChange:E=>o("essayEdit",E.target.value),rows:12,className:"w-full p-4 bg-white border border-neutral-200 rounded-2xl font-mono text-xs leading-relaxed focus:ring-2 focus:ring-neutral-900 outline-none resize-y",placeholder:"Enter the Usage Guide Markdown content here..."})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"flex justify-between items-center px-1",children:u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[u.jsx(Vm,{size:12})," Practice Test (Markdown)"]})}),u.jsx("textarea",{value:a.testEdit,onChange:E=>o("testEdit",E.target.value),rows:12,className:"w-full p-4 bg-white border border-neutral-200 rounded-2xl font-mono text-xs leading-relaxed focus:ring-2 focus:ring-neutral-900 outline-none resize-y",placeholder:"Enter the Practice Test Markdown content here..."})]})]})]})})]})})};async function Gf(n){if(navigator.clipboard&&navigator.clipboard.writeText)try{return await navigator.clipboard.writeText(n),!0}catch{console.warn("Clipboard API failed, trying fallback strategy")}try{const e=document.createElement("textarea");e.value=n,e.style.position="fixed",e.style.left="-9999px",e.style.top="0",document.body.appendChild(e),e.focus(),e.select();const s=document.execCommand("copy");return document.body.removeChild(e),s}catch(e){return console.error("Copy failed",e),!1}}const Yk=n=>n?n.split(/[;\n\r\t,]+/).map(e=>e.trim()).filter(Boolean):[],dM=n=>{const e=new Map;return n&&Yk(n).forEach(a=>{const o=a.split(":").map(p=>p.trim()),l=o[0],d=o.length>1?o[1]:o[0];if(l&&d){const p=l.toLowerCase(),m=d.toLowerCase();e.set(p,m),e.has(m)||e.set(m,m)}}),e},fM=n=>{const e=Array.from(n.keys()).sort((a,o)=>o.length-a.length);if(e.length===0)return null;const s=e.map(a=>a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"));return new RegExp(`\\b(${s.join("|")})\\b`,"gi")},Wk=n=>(n||"").replace(/\[SOUND\s+[^\]]+\]/gi,"").replace(/\[IMG\s+[^\]]+\]/gi,"").replace(/\[W_AUDIO\][\s\S]*?\[\/\]/gi,"").replace(/\n{3,}/g,`

`).trim(),vg=({isOpen:n,onClose:e,type:s,title:a,description:o,initialData:l,onGeneratePrompt:d,onJsonReceived:p,hidePrimaryInput:m=!1,closeOnSuccess:y=!1,contentModeOptions:x})=>{const[v,S]=L.useState(""),[I,z]=L.useState(""),[U,C]=L.useState(""),[M,B]=L.useState(""),[F,H]=L.useState("CASUAL"),[q,Y]=L.useState(""),[A,T]=L.useState(Bm.VARIETY),[E,R]=L.useState(""),[N,D]=L.useState("Adult"),[O,ve]=L.useState("English"),[ye,G]=L.useState("friendly_elementary"),[ae,ne]=L.useState(""),[Q,X]=L.useState((x==null?void 0:x.value)||"replace"),[j,V]=L.useState(""),[$,Z]=L.useState(null),[ee,pe]=L.useState(!1),[ie,ce]=L.useState(!1),[De,fe]=L.useState(!1),[Se,Oe]=L.useState(""),[me,ue]=L.useState(!1),ge=L.useRef(null),Ee=L.useRef(void 0),Ae=["GENERATE_LESSON","GENERATE_WORD_LESSON","GENERATE_AUDIO_SCRIPT"].includes(s);if(L.useEffect(()=>{if(n&&!Ee.current){if(S(""),z(""),C(""),B(""),H("CASUAL"),Y(""),T(Bm.VARIETY),ne(""),X((x==null?void 0:x.value)||"replace"),s==="REFINE_WORDS"&&(l!=null&&l.words)){const Pe=l.words.replace(/\n/g,"; ");S(Pe)}else Ae&&(R(""),D((l==null?void 0:l.targetAudience)||"Adult"),ve((l==null?void 0:l.language)||"English"),G((l==null?void 0:l.tone)||"friendly_elementary"));V(""),Z(null),fe(!1),pe(!1),ce(!1),ue(!1)}Ee.current=n},[n,s,l,Ae,x==null?void 0:x.value]),L.useEffect(()=>{x!=null&&x.enabled&&x.onChange(Q)},[Q,x]),L.useEffect(()=>{let Pe={};s==="REFINE_WORDS"?Pe={words:m?l==null?void 0:l.words:v}:s==="REFINE_UNIT"?Pe={request:I,language:O,targetAudience:N,tone:ye,format:"reading",contentMode:Q}:s==="GENERATE_AUDIO_SCRIPT"?Pe={request:I,language:O,targetAudience:N,tone:ye,format:"listening"}:s==="GENERATE_CHAPTER"?Pe={request:U}:s==="GENERATE_SEGMENT"?Pe={request:M}:s==="GENERATE_PARAPHRASE"?Pe={tone:F,context:q,mode:A}:s==="EVALUATE_PARAPHRASE"?Pe=l:s==="GENERATE_LESSON"||s==="GENERATE_WORD_LESSON"?Pe={topic:E,language:O,targetAudience:N,tone:ye,format:"reading"}:s==="GENERATE_UNIT"?Pe={request:I}:s==="GENERATE_PLAN"&&(Pe={request:ae}),Oe(d(Pe))},[s,v,I,U,M,F,q,A,l,m,E,N,O,ye,ae,Q,d]),!n)return null;const Ge=async()=>{const Pe=me?Wk(Se):Se;await Gf(Pe),fe(!0),setTimeout(()=>fe(!1),2e3),setTimeout(()=>{var oe;return(oe=ge.current)==null?void 0:oe.focus()},100)},Ue=async()=>{ee||!j.trim()||(Z(null),pe(!0),setTimeout(async()=>{try{let Pe=j.trim();Pe=Pe.replace(/^```json\s*/,"").replace(/^```\s*/,"").replace(/\s*```$/,"");let oe;try{oe=JSON.parse(Pe)}catch{try{Pe=Pe.replace(/,\s*([}\]])/g,"$1"),oe=JSON.parse(Pe)}catch(Ve){throw new Error("Cannot read AI response. Please ensure you copied the full code.",{cause:Ve})}}Ae?await p({result:oe,preferences:{language:O,targetAudience:N,tone:ye}}):await p(oe),y?e():(pe(!1),ce(!0))}catch(Pe){console.error(Pe),pe(!1),Z(Pe.message||"Failed to process.")}},50))},Ke=Pe=>{Pe.key==="Enter"&&(Pe.metaKey||Pe.ctrlKey)&&(Pe.preventDefault(),Ue())},Nt=()=>u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[u.jsx(zE,{size:10})," Language"]}),u.jsxs("select",{value:O,onChange:Pe=>ve(Pe.target.value),className:"w-full px-3 py-2 bg-white border border-neutral-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none appearance-none cursor-pointer",children:[u.jsx("option",{value:"English",children:"English"}),u.jsx("option",{value:"Vietnamese",children:"Vietnamese"})]})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[u.jsx(CI,{size:10})," Audience"]}),u.jsxs("select",{value:N,onChange:Pe=>D(Pe.target.value),className:"w-full px-3 py-2 bg-white border border-neutral-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none appearance-none cursor-pointer",children:[u.jsx("option",{value:"Adult",children:"Adult"}),u.jsx("option",{value:"Kid",children:"Kid"})]})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[u.jsx(EI,{size:10})," Persona"]}),u.jsxs("select",{value:ye,onChange:Pe=>G(Pe.target.value),className:"w-full px-3 py-2 bg-white border border-neutral-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none appearance-none cursor-pointer",children:[u.jsx("option",{value:"friendly_elementary",children:"Friendly"}),u.jsx("option",{value:"professional_professor",children:"Professional"})]})]})]});return u.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center p-4 bg-white/10 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl flex flex-col overflow-hidden border border-neutral-200 relative ring-4 ring-neutral-100",children:[u.jsx("button",{onClick:e,disabled:ee,className:"absolute top-4 right-4 p-2 text-neutral-300 hover:text-neutral-900 hover:bg-neutral-50 rounded-full transition-all z-10 disabled:opacity-0",children:u.jsx(jn,{size:18})}),u.jsxs("div",{className:"p-6 md:p-8 flex flex-col gap-6",children:[u.jsxs("div",{className:"space-y-1 pr-8",children:[u.jsxs("div",{className:"flex items-center gap-2 text-neutral-900",children:[u.jsx("div",{className:"p-1.5 bg-neutral-900 rounded-lg text-white",children:u.jsx(Ol,{size:14})}),u.jsx("h3",{className:"font-black text-lg tracking-tight",children:a})]}),u.jsx("p",{className:"text-xs font-medium text-neutral-400 pl-9",children:o})]}),u.jsxs("div",{className:"py-2 space-y-4",children:[!m&&s==="REFINE_WORDS"&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Vocabulary List"}),u.jsx("textarea",{value:v,onChange:Pe=>S(Pe.target.value),disabled:ee||ie,className:"w-full h-32 p-4 bg-neutral-50/50 border border-neutral-200 rounded-2xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none resize-none shadow-inner leading-relaxed transition-all focus:bg-white disabled:opacity-50",placeholder:"word1; word2; word3..."}),u.jsx("p",{className:"text-[9px] text-neutral-400 px-2 text-right",children:"Edit freely. Separated by semicolon (;) or newline."})]}),["REFINE_UNIT","GENERATE_AUDIO_SCRIPT"].includes(s)&&u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Your Instructions"}),u.jsx("textarea",{value:I,onChange:Pe=>z(Pe.target.value),disabled:ee||ie,placeholder:s==="GENERATE_AUDIO_SCRIPT"?'e.g., "Focus on the definition of key terms"':'e.g., "Add more advanced vocabulary and examples."',className:"w-full h-24 p-4 bg-neutral-50/50 border border-neutral-200 rounded-2xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none resize-none transition-all focus:bg-white disabled:opacity-50"}),s==="REFINE_UNIT"&&(x==null?void 0:x.enabled)&&u.jsxs("div",{className:"grid grid-cols-2 gap-2 pt-1",children:[u.jsx("button",{type:"button",onClick:()=>X("replace"),disabled:ee||ie,className:`px-3 py-2 rounded-xl border text-[10px] font-black uppercase tracking-wider transition-all ${Q==="replace"?"bg-neutral-900 text-white border-neutral-900":"bg-white text-neutral-500 border-neutral-200 hover:text-neutral-900 hover:bg-neutral-50"}`,children:"Replace"}),u.jsx("button",{type:"button",onClick:()=>X("append"),disabled:ee||ie,className:`px-3 py-2 rounded-xl border text-[10px] font-black uppercase tracking-wider transition-all ${Q==="append"?"bg-neutral-900 text-white border-neutral-900":"bg-white text-neutral-500 border-neutral-200 hover:text-neutral-900 hover:bg-neutral-50"}`,children:"Append"})]})]}),(s==="GENERATE_LESSON"||s==="GENERATE_WORD_LESSON")&&u.jsx(u.Fragment,{children:u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[u.jsx(Tf,{size:10})," Topic"]}),u.jsx("input",{value:E,onChange:Pe=>R(Pe.target.value),placeholder:"e.g. Present Perfect Tense, Space Travel",className:"w-full px-4 py-2 bg-neutral-50/50 border border-neutral-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]})}),Ae&&Nt(),s==="GENERATE_UNIT"&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Topic or Request"}),u.jsx("input",{value:I,onChange:Pe=>z(Pe.target.value),disabled:ee||ie,placeholder:'e.g., "Trees", "Technology", "The Ocean"',className:"w-full px-4 py-3 bg-neutral-50/50 border border-neutral-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]}),s==="GENERATE_PLAN"&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"What is your goal?"}),u.jsx("textarea",{value:ae,onChange:Pe=>ne(Pe.target.value),disabled:ee||ie,placeholder:'e.g., "Prepare for IELTS in 30 days focusing on academic writing"',className:"w-full h-24 p-4 bg-neutral-50/50 border border-neutral-200 rounded-2xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none resize-none transition-all focus:bg-white disabled:opacity-50"})]})]}),u.jsxs("div",{className:"space-y-3 pt-4 border-t border-neutral-100",children:[u.jsxs("label",{className:"flex items-center gap-2 px-1 text-[10px] font-bold text-neutral-500 uppercase tracking-widest",children:[u.jsx("input",{type:"checkbox",checked:me,onChange:Pe=>ue(Pe.target.checked),className:"w-3.5 h-3.5 rounded border-neutral-300 text-neutral-900 focus:ring-neutral-900"}),"Shorter",u.jsx("span",{className:"normal-case tracking-normal font-medium text-neutral-400",children:"(remove [SOUND], [IMG], [W_AUDIO])"})]}),u.jsx("div",{className:"space-y-2",children:u.jsx("button",{onClick:Ge,disabled:ee||ie,className:`w-full py-3 px-4 rounded-xl font-bold text-xs flex items-center justify-between transition-all group ${De?"bg-green-50 text-green-700 border border-green-200":"bg-neutral-50 text-neutral-600 border border-neutral-200 hover:border-neutral-300 hover:bg-white"} disabled:opacity-50`,children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:`p-1.5 rounded-md ${De?"bg-green-200 text-green-800":"bg-white text-neutral-400 shadow-sm"}`,children:De?u.jsx(Cl,{size:14}):u.jsx(aI,{size:14})}),u.jsx("span",{className:"uppercase tracking-widest text-[10px]",children:De?"Command Copied":"Step 1: Copy Command"})]})})}),u.jsxs("div",{className:`relative flex items-start gap-2 p-1.5 rounded-2xl border-2 transition-all ${$?"border-red-100 bg-red-50/30":ie?"border-green-200 bg-green-50":"border-neutral-100 bg-white focus-within:border-neutral-900 focus-within:shadow-md"}`,children:[u.jsx("div",{className:"pl-3 py-3 shrink-0",children:ie?u.jsx(Cl,{size:18,className:"text-green-600"}):u.jsx(J2,{size:18,className:$?"text-red-400":"text-neutral-400"})}),u.jsx("textarea",{ref:ge,value:ie?"Data applied! Success.":j,onChange:Pe=>{V(Pe.target.value),Z(null)},onKeyDown:Ke,disabled:ee||ie,placeholder:ee?"Processing data...":"Step 2: Paste AI response...",className:`w-full bg-transparent border-none text-xs font-medium placeholder:text-neutral-400 focus:ring-0 outline-none resize-none min-h-[70px] p-2 ${ie?"text-green-700 font-bold":"text-neutral-800"}`,rows:3,autoComplete:"off"}),u.jsx("button",{onClick:Ue,disabled:!j.trim()||ee,className:"p-2.5 rounded-xl transition-all shadow-md active:scale-90 flex items-center justify-center w-10 h-10 self-end bg-neutral-900 text-white hover:bg-neutral-800 disabled:opacity-20 disabled:scale-95",children:ee?u.jsx(mn,{size:16,className:"animate-spin"}):u.jsx(iI,{size:16})})]})]})]})]})})},qd=({title:n,icon:e,suggestions:s})=>!s||s.length===0?null:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("h4",{className:"text-xs font-black uppercase tracking-widest text-neutral-500 flex items-center gap-2 border-b border-neutral-200 pb-2",children:[e,n]}),u.jsx("ul",{className:"space-y-3",children:s.map((a,o)=>u.jsxs("li",{className:"flex items-start gap-3",children:[a.suggestion==="learn"?u.jsx(Cl,{size:16,className:"text-green-500 shrink-0 mt-0.5"}):u.jsx(sI,{size:16,className:"text-neutral-400 shrink-0 mt-0.5"}),u.jsxs("div",{children:[u.jsx("p",{className:`font-bold text-sm ${a.suggestion==="ignore"?"text-neutral-500":"text-neutral-900"}`,children:a.item}),u.jsxs("p",{className:"text-xs text-neutral-600 italic",children:['"',a.reason,'"']})]})]},o))})]}),Qk=({isOpen:n,onClose:e,suggestions:s})=>!n||!s?null:u.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col max-h-[90vh]",children:[u.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-start shrink-0",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-xl font-black text-neutral-900 flex items-center gap-2",children:[u.jsx(Og,{size:20,className:"text-amber-500"})," Learning Suggestions"]}),u.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:s.overall_summary})]}),u.jsx("button",{type:"button",onClick:e,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:u.jsx(jn,{size:20})})]}),u.jsxs("main",{className:"p-8 overflow-y-auto space-y-6",children:[u.jsx(qd,{title:"Word Family",icon:u.jsx(Tf,{size:14}),suggestions:s.wordFamily}),u.jsx(qd,{title:"Collocations",icon:u.jsx(Af,{size:14}),suggestions:s.collocations}),u.jsx(qd,{title:"Idioms",icon:u.jsx(If,{size:14}),suggestions:s.idioms}),u.jsx(qd,{title:"Paraphrases (Word Power)",icon:u.jsx(Nf,{size:14}),suggestions:s.paraphrases})]})]})});function D1(n,e){var s,a,o;switch(e.type){case"REINITIALIZE":const l=e.payload;return{...l,register:l.register||"raw",groupsString:((s=l.groups)==null?void 0:s.join(", "))||"",studiedStatus:l.lastReview&&l.lastGrade||"NEW",collocationsArray:l.collocationsArray||(l.collocations?l.collocations.split(`
`).map(y=>({text:y.trim(),isIgnored:!1})):[]),idiomsList:l.idiomsList||(l.idioms?l.idioms.split(`
`).map(y=>({text:y.trim(),isIgnored:!1})):[]),prepositionsList:l.prepositions||[],wordFamily:l.wordFamily||{nouns:[],verbs:[],adjs:[],advs:[]},paraphrases:l.paraphrases||[],essayEdit:((a=l.lesson)==null?void 0:a.essay)||"",testEdit:((o=l.lesson)==null?void 0:o.test)||""};case"SET_FIELD":return{...n,[e.payload.field]:e.payload.value};case"SET_FLAG":const{flag:d}=e.payload,p={...n,[d]:!n[d]};return["isIdiom","isPhrasalVerb","isCollocation","isStandardPhrase"].includes(d)&&p[d]&&(d!=="isIdiom"&&(p.isIdiom=!1),d!=="isPhrasalVerb"&&(p.isPhrasalVerb=!1),d!=="isCollocation"&&(p.isCollocation=!1),d!=="isStandardPhrase"&&(p.isStandardPhrase=!1)),p;case"SET_LIST_ITEM":return{...n,[e.payload.list]:e.payload.data};case"APPLY_AI_MERGE":const m=qk(n,e.payload);return{...n,...m,register:m.register,prepositionsList:m.prepositions||[]};default:return n}}const Kk=({word:n,user:e,onSave:s,onClose:a,onSwitchToView:o})=>{const{showToast:l}=kr(),[d,p]=L.useReducer(D1,n,D=>D1({},{type:"REINITIALIZE",payload:D})),[m,y]=L.useState(!1),[x,v]=L.useState(null),[S,I]=L.useState(!1),[z,U]=L.useState(!1);L.useEffect(()=>{p({type:"REINITIALIZE",payload:n}),v(null)},[n]);const C=D=>Pk(D.words.split(/[,\n]+/).map(O=>O.trim()).filter(Boolean),e.nativeLanguage||"Vietnamese"),M=D=>{const O=Array.isArray(D)?D[0]:D;O&&(p({type:"APPLY_AI_MERGE",payload:O}),y(!1))},B=()=>{x?I(!0):U(!0)},F=D=>zk(d,e),H=D=>{D&&D.overall_summary?(v(D),U(!1),I(!0)):l("Invalid suggestion format from AI.","error")},q=D=>{D&&D.preventDefault();const{groupsString:O,studiedStatus:ve,collocationsArray:ye,idiomsList:G,prepositionsList:ae,essayEdit:ne,testEdit:Q,...X}=d;let j=X.wordFamily;if(j){const fe={};let Se=!1;["nouns","verbs","adjs","advs"].forEach(Oe=>{var ue;const me=((ue=j[Oe])==null?void 0:ue.filter(ge=>ge.word.trim()))||[];me.length>0&&(fe[Oe]=me,Se=!0)}),j=Se?fe:void 0}let V={...X,wordFamily:j,prepositions:ae.filter(fe=>fe.prep.trim()).length>0?ae.filter(fe=>fe.prep.trim()):void 0,collocationsArray:ye.filter(fe=>fe.text.trim()),collocations:ye.filter(fe=>fe.text.trim()).map(fe=>fe.text).join(`
`),idiomsList:G.filter(fe=>fe.text.trim()),idioms:G.filter(fe=>fe.text.trim()).map(fe=>fe.text).join(`
`),lesson:{essay:ne,test:Q},groups:O.split(",").map(fe=>fe.trim()).filter(Boolean),updatedAt:Date.now()};const $={...V.lastTestResults||{}},Z=new Set((V.collocationsArray||[]).filter(fe=>!fe.isIgnored).map(fe=>fe.text.toLowerCase())),ee=new Set((V.idiomsList||[]).filter(fe=>!fe.isIgnored).map(fe=>fe.text.toLowerCase())),pe=new Set((V.prepositions||[]).filter(fe=>!fe.isIgnored).map(fe=>fe.prep.toLowerCase())),ie=new Set((V.paraphrases||[]).filter(fe=>!fe.isIgnored).map(fe=>fe.word.toLowerCase())),ce=new Set;V.wordFamily&&["nouns","verbs","adjs","advs"].forEach(fe=>{(V.wordFamily[fe]||[]).forEach(Se=>{!Se.isIgnored&&Se.word.trim()&&ce.add(Se.word.trim().toLowerCase())})});for(const fe in $){const Se=fe.split(":"),Oe=Se[0],me=Se.slice(1).join(":").toLowerCase();let ue=!1;switch(Oe){case"COLLOCATION_QUIZ":Z.has(me)||(ue=!0);break;case"IDIOM_QUIZ":ee.has(me)||(ue=!0);break;case"PREPOSITION_QUIZ":pe.has(me)||(ue=!0);break;case"PARAPHRASE_QUIZ":ie.has(me)||(ue=!0);break;case"WORD_FAMILY":ce.has(me)||(ue=!0);break}ue&&delete $[fe]}V.lastTestResults=$;const De=n.lastReview&&n.lastGrade||"NEW";ve!==De?ve==="NEW"?V=Zw(V):V=Kw(V,ve):(V.complexity=Mr(V),V.masteryScore=Rs(V),V.gameEligibility=Lr(V)),s(V),l("Word saved successfully!","success")},Y=D=>{const O=d[D]||[];return{update:(ve,ye)=>p({type:"SET_LIST_ITEM",payload:{list:D,data:[...O].map((G,ae)=>ae===ve?{...G,...ye}:G)}}),toggleIgnore:ve=>p({type:"SET_LIST_ITEM",payload:{list:D,data:[...O].map((ye,G)=>G===ve?{...ye,isIgnored:!ye.isIgnored}:ye)}}),remove:ve=>p({type:"SET_LIST_ITEM",payload:{list:D,data:O.filter((ye,G)=>G!==ve)}}),add:ve=>p({type:"SET_LIST_ITEM",payload:{list:D,data:[...O,ve]}})}},A=D=>{const O=d.wordFamily||{nouns:[],verbs:[],adjs:[],advs:[]},ve=ye=>p({type:"SET_LIST_ITEM",payload:{list:"wordFamily",data:{...O,...ye}}});return{update:(ye,G,ae)=>{const ne=[...O[D]||[]];ne[ye]={...ne[ye],[G]:ae},ve({[D]:ne})},toggleIgnore:ye=>{const G=[...O[D]||[]];G[ye]={...G[ye],isIgnored:!G[ye].isIgnored},ve({[D]:G})},remove:ye=>{ve({[D]:(O[D]||[]).filter((G,ae)=>ae!==ye)})},add:()=>{const ye={word:"",isIgnored:D==="advs"};ve({[D]:[...O[D]||[],ye]})}}},T=Y("prepositionsList"),E=Y("collocationsArray"),R=Y("idiomsList"),N=Y("paraphrases");return u.jsxs(u.Fragment,{children:[u.jsx($k,{onClose:a,onSwitchToView:()=>o(n),formData:d,setFormData:(D,O)=>p({type:"SET_FIELD",payload:{field:D,value:O}}),setFlag:D=>p({type:"SET_FLAG",payload:{flag:D}}),familyHandler:A,prepList:T,collocList:E,idiomList:R,paraList:N,handleSubmit:q,onOpenAiRefine:()=>y(!0),onSuggestLearn:B,hasSuggestions:!!x}),u.jsx(Qk,{isOpen:S,onClose:()=>I(!1),suggestions:x}),m&&u.jsx(vg,{isOpen:m,onClose:()=>y(!1),type:"REFINE_WORDS",title:"Manual AI Refinement",description:`Refining details for "${d.word}"`,initialData:{words:d.word},user:e,onGeneratePrompt:C,onJsonReceived:M,actionLabel:"Apply to Word",hidePrimaryInput:!0}),z&&u.jsx(vg,{isOpen:z,onClose:()=>U(!1),type:"REFINE_WORDS",title:"Get Learning Suggestions",description:"AI will suggest what to focus on based on your profile.",initialData:{words:n.word},user:e,onGeneratePrompt:F,onJsonReceived:H,hidePrimaryInput:!0})]})},Zk=1500;let ro=[],Kt=null,Ef=!1,Pn=!1,N0=[],Bc=null,Bs=!1,dr=0,yl=0,go=1,ao=null;function Xk(n){const e=n.numberOfChannels,s=n.length*e*2+44,a=new ArrayBuffer(s),o=new DataView(a),l=[];let d,p,m=0,y=0;for(v(1179011410),v(s-8),v(1163280727),v(544501094),v(16),x(1),x(e),v(n.sampleRate),v(n.sampleRate*2*e),x(e*2),x(16),v(1635017060),v(s-y-4),d=0;d<n.numberOfChannels;d++)l.push(n.getChannelData(d));for(;y<s;){for(d=0;d<e;d++)p=Math.max(-1,Math.min(1,l[d][m])),p=(p<0?p*32768:p*32767)|0,o.setInt16(y,p,!0),y+=2;m++}return new Blob([a],{type:"audio/wav"});function x(S){o.setUint16(y,S,!0),y+=2}function v(S){o.setUint32(y,S,!0),y+=4}}const Jk=()=>{ao=null},C0=async n=>{if(n)return ao=n.replace(/\/$/,""),ao;if(ao)return ao;const e=Tt();return ao=Vn(e),ao};function eL(){if(typeof window>"u"||!window.speechSynthesis)return;const n=()=>{const e=window.speechSynthesis.getVoices();e&&e.length>0&&(ro=Array.from(e))};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)}eL();const tL=()=>new Promise(n=>{const e=window.speechSynthesis.getVoices();if(e.length>0)ro=Array.from(e),n(ro);else{const s=()=>{const a=window.speechSynthesis.getVoices();a.length>0&&(ro=Array.from(a),n(ro),window.speechSynthesis.onvoiceschanged=null)};window.speechSynthesis.onvoiceschanged=s,setTimeout(()=>{const a=window.speechSynthesis.getVoices();ro=Array.from(a),n(ro)},1e3)}}),nL=async n=>{try{const s=`${await C0(n)}/voices`,a=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(2e3)});if(!a.ok)throw new Error(`HTTP ${a.status}`);return await a.json()}catch{return null}},Gn=n=>{Ef=n,window.dispatchEvent(new CustomEvent("audio-status-changed",{detail:{isSpeaking:Ef,isAudioPaused:Pn,isSingleWordPlayback:Bs}}))},qf=n=>String(n||"").trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(//g,"d").replace(//g,"D").toLowerCase().replace(/[^a-z0-9'-]/g,""),sL=n=>{if(!n)return null;const e=decodeURIComponent(n);if(!/quality_sound/i.test(e))return null;const o=(e.split("?")[0].split("#")[0].split("/").pop()||"").replace(/\.[a-z0-9]+$/i,"");if(!o)return null;const l=o.replace(/_(N|V|ADJ|ADV|PRO|PREP|CONJ|INTJ|X)_(US|UK)$/i,"").replace(/_(US|UK)$/i,"");return qf(l)||null},rL=n=>{const e=qf(n);return e?!/\s/.test(String(n||"").trim())&&e.length>0:!1},nu=async n=>{const e=qf(n);if(!e)return!1;if(Su(n)==="vi")return console.log("[VI FLOW] Skip CoachLookup because detected Vietnamese:",n),!1;const a=Tt(),o=Vn(a);try{const l=await fetch(`${o}/api/lookup/cambridge/cache?word=${encodeURIComponent(e)}`,{signal:AbortSignal.timeout(6e3),cache:"no-store"});if(l.ok){const d=await l.text(),p=d?JSON.parse(d):null;if(p!=null&&p.exists)return window.dispatchEvent(new CustomEvent("coach-cambridge-lookup-request",{detail:{word:e,data:p}})),!0}}catch{}try{const l=await fetch(`${o}/api/lookup/cambridge/simple?word=${encodeURIComponent(e)}`,{signal:AbortSignal.timeout(12e3),cache:"no-store"});if(!l.ok)return!1;const d=await l.text(),p=d?JSON.parse(d):null;if(!(p!=null&&p.exists))try{const m=await fetch(`${o}/api/convert/ipa?text=${encodeURIComponent(e)}&mode=2`,{signal:AbortSignal.timeout(6e3),cache:"no-store"});if(!m.ok)return!1;const y=await m.json().catch(()=>null);return y!=null&&y.ipa?(window.dispatchEvent(new CustomEvent("coach-ipa-fallback-request",{detail:{word:e,ipa:y.ipa}})),!0):!1}catch{return!1}return window.dispatchEvent(new CustomEvent("coach-cambridge-lookup-request",{detail:{word:e,data:p}})),!0}catch{return!1}},wu=n=>{dr+=1,yl+=1,Kt&&(Kt.pause(),Kt.src="",Kt=null),typeof window<"u"&&window.speechSynthesis&&window.speechSynthesis.cancel(),Bc=null,Bs=!1,Pn=!1,N0=[],n||Gn(!1)},ST=()=>{wu(!1)},Fc=()=>Ef,Hc=()=>Pn,Gc=()=>Bs,TT=()=>N0,of=()=>go,AT=n=>{const e=Number.isFinite(n)?Math.min(2,Math.max(.5,n)):1;go=Math.round(e*100)/100,Kt&&(Kt.playbackRate=go),window.dispatchEvent(new CustomEvent("audio-status-changed",{detail:{isSpeaking:Ef,isAudioPaused:Pn,isSingleWordPlayback:Bs,playbackRate:go}}))},IT=()=>{!Kt||Kt.paused||(Kt.pause(),Pn=!0,Gn(!0))},NT=async()=>{if(!(!Kt||!Kt.paused))try{await Kt.play(),Pn=!1,Gn(!0)}catch(n){throw Gn(!1),n}},aL=async(n,e)=>{const s=Tt(),a=Vn(s),o=e==="vi"||e==="vn"?"vi":e==="en"?"en":void 0,l=o||Su(n),d=s.audioCoach.activeCoach,p=s.audioCoach.coaches[d],m=l==="vi"?p.viVoice:p.enVoice,y=l==="vi"?p.viAccent:p.enAccent;try{const x=`${a}/speak`,v=await fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,language:l,accent:y,voice:m}),signal:AbortSignal.timeout(2e4)});if(v.ok)return await v.blob()}catch(x){console.error("Prefetch failed",x)}return null},CT=(n,e)=>{wu(!0);const s=++dr;Pn=!1,Bc=e!=null&&e.isSingleWord&&(e!=null&&e.word)?e.word:null,Bs=!!(e!=null&&e.isSingleWord),Gn(!0);const a=Bc,o=a?nu(a):Promise.resolve(!1),l=URL.createObjectURL(n),d=new Audio(l);return d.playbackRate=go,Kt=d,new Promise((p,m)=>{d.play().then(()=>{d.onended=()=>{if(s!==dr||Kt!==d){URL.revokeObjectURL(l),p(!0);return}URL.revokeObjectURL(l),Bc=null,Pn=!1,Gn(!1),a&&o.then(y=>{y||nu(a)}),p(!0)}}).catch(y=>{if(s!==dr||Kt!==d){URL.revokeObjectURL(l),p(!1);return}URL.revokeObjectURL(l),Bc=null,Bs=!1,Pn=!1,Gn(!1),m(y)})})},iL=async(n,e,s,a,o)=>{wu(!0);const l=++yl,d=e==="en"&&rL(n);Bs=d,Pn=!1,Gn(!0);try{const m=`${await C0(o)}/speak`,x=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,language:e,accent:s,voice:a}),signal:AbortSignal.timeout(2e4)});if(l!==yl)return!0;if(!x.ok)throw new Error("Server unreachable");const v=x.headers.get("Content-Type");if(v&&v.includes("audio")){const S=await x.blob();if(l!==yl)return!0;const I=x.headers.get("X-TTS-Source")||void 0,z=x.headers.get("X-TTS-Word")||void 0,U=d?qf(n):void 0;return await CT(S,{source:I,word:z||U,isSingleWord:d})}else return l!==yl||(Bs=!1,Pn=!1,Gn(!1)),!0}catch(p){if(l!==yl)return!0;throw Pn=!1,Gn(!1),p}},oL=(n,e,s="en")=>new Promise(a=>{if(typeof window>"u"||!window.speechSynthesis)return a(!1);wu(!0);const o=++dr;Pn=!1,Gn(!0);const l=new SpeechSynthesisUtterance(n);l.lang=s==="vi"?"vi-VN":"en-US";const d=window.speechSynthesis.getVoices(),p=e&&d.find(m=>m.name===e)||d.find(m=>m.lang.startsWith(s));p&&(l.voice=p),l.rate=Math.min(2,Math.max(.5,.95*go)),l.onend=()=>{if(o!==dr)return a(!0);Pn=!1,Gn(!1),a(!0)},l.onerror=()=>{if(o!==dr)return a(!1);Pn=!1,Gn(!1),a(!1)},window.speechSynthesis.speak(l)}),Su=n=>/[]/i.test(n)?"vi":"en",lL=n=>n?n.substring(0,Zk).normalize("NFD").replace(/\*+/g,"").replace(//g,", ").replace(/[^a-zA-Z0-9.,!?%'\-\s\u00C0-\u1EF9]/g,"").trim():"",as=async(n,e=!1,s,a,o,l)=>{if(typeof window>"u"||!n)return;const d=lL(n);if(!d)return;if(l)try{await CT(l);return}catch{console.warn("Play preloaded failed, falling back to standard")}const p=Tt(),m=p.audioCoach.activeCoach,y=p.audioCoach.coaches[m],x=Vn(p),v=s==="vi"||s==="vn"?"vi":s==="en"?"en":void 0,S=v||Su(n),I=a!==void 0?a:S==="vi"?y.viVoice:y.enVoice,z=o!==void 0?o:S==="vi"?y.viAccent:y.enAccent;try{await iL(d,S,z,I,x);return}catch{await oL(d,I,S)}},RT=async(n,e,s,a)=>{wu(!0);const o=++dr;N0=a||[];const l=sL(n);Bs=!!l;const d=l?nu(l):Promise.resolve(!1),p=await C0();let m=n;if(!n.startsWith("http")){const x=n.startsWith("/")?n.slice(1):n;x.startsWith("api/")?m=`${p}/${x}`:m=`${p}/api/audio/stream/${x}`}const y=new Audio(m);return y.playbackRate=go,Kt=y,new Promise((x,v)=>{const S=()=>{if(e!==void 0&&(y.currentTime=e),s!==void 0){const I=(e||0)+s,z=()=>{if(y.currentTime>=I){if(o!==dr||Kt!==y){x(!0);return}y.pause(),Gn(!1),y.removeEventListener("timeupdate",z),l&&d.then(U=>{U||nu(l)}),Bs=!1,x(!0)}};y.addEventListener("timeupdate",z)}Gn(!0),Pn=!1,y.play().then(()=>{y.onended=()=>{if(o!==dr||Kt!==y){x(!0);return}Bs=!1,Pn=!1,Gn(!1),l&&d.then(I=>{I||nu(l)}),x(!0)}}).catch(I=>{if(o!==dr||Kt!==y){x(!1);return}Bs=!1,Pn=!1,Gn(!1),v(I)})};y.readyState>=1?S():y.onloadedmetadata=S,y.onerror=I=>{if(o!==dr||Kt!==y){x(!1);return}Bs=!1,Pn=!1,Gn(!1),v(I)}})},R0=async()=>{const n=await navigator.mediaDevices.getUserMedia({audio:!0}),e=["audio/webm;codecs=opus","audio/webm","audio/mp4"].find(s=>MediaRecorder.isTypeSupported(s));ur=new MediaRecorder(n,e?{mimeType:e}:void 0),_g=[],ur.ondataavailable=s=>{s.data.size>0&&_g.push(s.data)},ur.start()};let ur=null,_g=[];const O0=()=>new Promise(n=>{if(!ur)return n(null);const e=ur.mimeType||"audio/webm";ur.onstop=()=>{const s=new Blob(_g,{type:e}),a=new FileReader;a.readAsDataURL(s),a.onloadend=()=>{const l=a.result.split(",")[1]||"";n({base64:l,mimeType:e})},ur==null||ur.stream.getTracks().forEach(o=>o.stop()),ur=null},ur.state!=="inactive"?ur.stop():n(null)}),xl=n=>{Kt&&(Kt.currentTime=n)},OT=()=>Kt?{currentTime:Kt.currentTime,duration:Kt.duration||0}:null,cL=Object.freeze(Object.defineProperty({__proto__:null,bufferToWav:Xk,detectLanguage:Su,fetchServerVoices:nL,getAudioProgress:OT,getAvailableVoices:tL,getIsAudioPaused:Hc,getIsSingleWordPlayback:Gc,getIsSpeaking:Fc,getMarkPoints:TT,getPlaybackRate:of,pauseSpeaking:IT,playSound:RT,prefetchSpeech:aL,resetAudioProtocolCache:Jk,resumeSpeaking:NT,seekAudio:xl,setPlaybackRate:AT,speak:as,startRecording:R0,stopRecording:O0,stopSpeaking:ST},Symbol.toStringTag,{value:"Module"}));typeof window<"u"&&(window.checkMarkdownQuiz=n=>{const e=n.getAttribute("data-answer");if(!e)return;const a=n.value.trim().toLowerCase()===e.trim().toLowerCase();n.classList.remove("border-neutral-300","text-neutral-900","focus:border-indigo-600"),n.classList.remove("border-green-500","text-green-700","bg-green-50"),n.classList.remove("border-red-500","text-red-700","bg-red-50"),a?n.classList.add("border-green-500","text-green-700","bg-green-50"):n.classList.add("border-red-500","text-red-700","bg-red-50")},window.checkDropdownQuiz=n=>{const e=n.parentElement;if(!e)return;const s=e.querySelector("select");if(!s)return;const a=s.getAttribute("data-answer"),o=s.value;if(!o)return;const l=o===a;if(s.disabled=!0,n.disabled=!0,n.classList.add("opacity-0","pointer-events-none"),s.classList.remove("border-neutral-300","text-neutral-900","focus:border-indigo-600"),s.classList.remove("bg-white"),l)s.classList.add("border-green-500","text-green-700","bg-green-50","font-bold");else{s.classList.add("border-red-500","text-red-700","bg-red-50","line-through");const d=document.createElement("span");d.className="ml-2 text-xs font-bold text-green-600 bg-green-50 px-1.5 py-0.5 rounded border border-green-200 animate-in fade-in",d.innerText=a||"",e.appendChild(d)}},window.checkMultiChoice=n=>{var l;const e=n.parentElement;if(!e)return;const s=e.getAttribute("data-answer"),a=(l=n.textContent)==null?void 0:l.trim();e.querySelectorAll("button").forEach(d=>{var p;d.disabled=!0,d.classList.add("opacity-50","cursor-not-allowed"),((p=d.textContent)==null?void 0:p.trim())===s&&(d.classList.remove("bg-white","text-neutral-700","opacity-50"),d.classList.add("bg-green-500","text-white","border-green-600"))}),a===s?(n.classList.remove("opacity-50"),n.classList.add("ring-2","ring-green-300")):(n.classList.remove("bg-white","text-neutral-700","opacity-50"),n.classList.add("bg-red-500","text-white","border-red-600"))},window.handleLessonSound=(n,e,s,a)=>{RT(n,e,s,a).catch(o=>console.error("Sound play failed",o))},window.handleWordAudioSpeak=n=>{const e=window.handleLessonSpeak;typeof e=="function"?e(n):console.warn("handleLessonSpeak is not registered in current view.")},window.handleMarkdownNav=n=>{const e=String(n||"").trim().toLowerCase();if(!e)return;const s=window.resolveMarkdownNav;if(typeof s=="function"&&s(e))return;const a=Array.from(document.querySelectorAll("h1, h2, h3, h4")),o=a.find(p=>(p.textContent||"").trim().toLowerCase()===e),l=a.find(p=>(p.textContent||"").trim().toLowerCase().includes(e)),d=o||l;d&&d.scrollIntoView({behavior:"smooth",block:"start"})});const uL=n=>{if(!n[0].trim().startsWith("|"))return null;const e=[];for(const m of n)if(m.trim().startsWith("|"))e.push(m);else break;if(e.length===0)return null;const s=m=>{const y=m.split("|");return m.trim().startsWith("|")&&y.shift(),m.trim().endsWith("|")&&y.pop(),y.map(x=>x.trim())},a=/^\|?(\s*:?-+:?\s*\|)+\s*$/;let o=!1;e.length>1&&a.test(e[1].trim())&&(o=!0);let l='<div class="overflow-x-auto my-4 border border-neutral-200 rounded-xl shadow-sm"><table class="w-full text-sm text-left border-collapse">';const d=s(e[0]);l+='<thead class="bg-neutral-50 text-neutral-900 uppercase font-bold text-xs"><tr>',d.forEach(m=>l+=`<th class="px-6 py-3 border-b border-neutral-200 min-w-[100px]">${m}</th>`),l+="</tr></thead>",l+='<tbody class="divide-y divide-neutral-100 bg-white">';const p=o?2:1;for(let m=p;m<e.length;m++){const y=s(e[m]);l+='<tr class="hover:bg-neutral-50/50 transition-colors">';for(let x=0;x<d.length;x++){const v=y[x]||"";l+=`<td class="px-6 py-4 font-medium text-neutral-600 align-top">${v}</td>`}l+="</tr>"}return l+="</tbody></table></div>",{html:l,consumed:e.length}},dL=n=>n.replace(/\[HIDDEN:\s*(.*?)\]/gi,(e,s)=>`<button type="button" onclick="this.outerHTML='<span class=\\'px-1.5 py-0.5 bg-green-50 border border-green-200 text-green-800 rounded-md text-sm font-bold animate-in fade-in zoom-in-95 inline-block align-baseline mx-1\\'>${s.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"\\'")}</span>'" class="inline-flex flex-nowrap whitespace-nowrap items-center gap-1.5 px-2 py-0.5 bg-indigo-50 hover:bg-indigo-100 text-indigo-600 rounded-md text-[10px] font-black uppercase tracking-wider transition-colors select-none border border-indigo-100 shadow-sm align-middle my-0.5 mx-1"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="shrink-0"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>Reveal</button>`),fL=n=>n.replace(/\[Quiz:\s*(.*?)\]/gi,(e,s)=>{const a=s.trim(),o=Math.max(3,a.length);return`<span class="inline-flex items-center gap-1 align-middle mx-1 whitespace-nowrap"><input type="text" data-answer="${a.replace(/"/g,"&quot;")}" placeholder="?" class="border-b-2 border-neutral-300 bg-transparent text-center font-bold text-neutral-900 outline-none focus:border-indigo-600 transition-all rounded-t-md px-1 py-0.5 text-sm" style="width: ${o}ch; min-width: 40px;" onkeydown="if(event.key==='Enter') window.checkMarkdownQuiz(this)" /><button onclick="window.checkMarkdownQuiz(this.previousElementSibling)" class="p-1 text-neutral-400 hover:text-indigo-600 transition-colors bg-neutral-100 hover:bg-indigo-50 rounded-full shadow-sm" title="Check Answer"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg></button></span>`}),hL=n=>n.replace(/\[Select:\s*(.*?)\]/gi,(e,s)=>{const a=s.split("|").map(p=>p.trim()).filter(p=>p.length>0);if(a.length<2)return`[Invalid Select: ${s}]`;const o=a[0],l=[...a];for(let p=l.length-1;p>0;p--){const m=Math.floor(Math.random()*(p+1));[l[p],l[m]]=[l[m],l[p]]}let d='<span class="inline-flex items-center gap-1 align-middle mx-1 whitespace-nowrap">';return d+=`<select data-answer="${o.replace(/"/g,"&quot;")}" class="border-b-2 border-neutral-300 bg-transparent font-bold text-neutral-900 outline-none focus:border-indigo-600 transition-all rounded-t-md px-2 py-0.5 text-sm cursor-pointer hover:bg-neutral-50 appearance-none pr-6 relative" style="min-width: 80px;">`,d+='<option value="" disabled selected>Select...</option>',l.forEach(p=>{d+=`<option value="${p.replace(/"/g,"&quot;")}">${p}</option>`}),d+="</select>",d+='<button onclick="window.checkDropdownQuiz(this)" class="p-1 text-neutral-400 hover:text-indigo-600 transition-colors bg-neutral-100 hover:bg-indigo-50 rounded-full shadow-sm" title="Check Answer"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg></button>',d+="</span>",d}),pL=n=>n.replace(/\[Multi:\s*(.*?)\]/gi,(e,s)=>{const a=s.split("|").map(p=>p.trim()).filter(p=>p.length>0);if(a.length<2)return`[Invalid Multi: ${s}]`;const o=a[0],l=[...a];for(let p=l.length-1;p>0;p--){const m=Math.floor(Math.random()*(p+1));[l[p],l[m]]=[l[m],l[p]]}let d=`<span class="inline-flex flex-wrap items-center gap-1.5 align-middle mx-1" data-answer="${o.replace(/"/g,"&quot;")}">`;return l.forEach(p=>{d+=`<button onclick="window.checkMultiChoice(this)" class="px-2 py-1 bg-white border border-neutral-200 text-neutral-700 rounded-md text-xs font-bold hover:bg-neutral-50 hover:border-neutral-300 transition-all shadow-sm select-none">${p}</button>`}),d+="</span>",d}),mL=n=>n.replace(/\[Formula:?\s*(.*?)\]/gi,(e,s)=>{const a=s.split("|").map(l=>l.trim());let o='<div class="flex flex-wrap items-center gap-2 p-3 my-3 bg-amber-50 border-l-4 border-amber-400 rounded-r-xl shadow-sm">';return o+='<span class="text-[10px] font-black text-amber-500 uppercase tracking-widest mr-1 select-none">Formula</span>',a.forEach(l=>{/^[+,.]+$/.test(l)?o+=`<span class="font-bold text-amber-700">${l}</span>`:o+=`<span class="px-2 py-1 bg-white border border-amber-200 rounded-lg text-amber-900 font-mono text-sm font-bold shadow-sm">${l}</span>`}),o+="</div>",o}),gL=n=>{const e=/\[Audio-(VN|EN)\]([\s\S]*?)\[\/(?:Audio-(?:VN|EN))?\]/gi;return n.replace(e,(s,a,o)=>`<button onclick="window.handleLessonSpeak('${o.replace(/\[HIDDEN:.*?\]/gi,"").replace(/\[Quiz:.*?\]/gi,"").replace(/\[Select:.*?\]/gi,"").replace(/\[Multi:.*?\]/gi,"").replace(/\[Formula:.*?\]/gi,"").replace(/[#*`_~[\]()]/g,"").replace(/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}]/gu,"").replace(/\n/g," ").trim().replace(/'/g,"\\'")}', '${a.toLowerCase()}')" class="inline-flex items-center justify-center w-6 h-6 mr-1.5 bg-indigo-600 text-white hover:bg-indigo-700 rounded-md transition-all active:scale-90 align-middle shadow-sm" title="Listen"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg></button>`+o.trim())},yL=n=>{const e=/\[W_AUDIO\]([\s\S]*?)\[\/\]/gi;return n.replace(e,(s,a)=>{const o=String(a||"").split(",").map(d=>d.trim()).filter(d=>d.length>0);return o.length?`<span class="inline-flex flex-wrap items-center gap-1.5 align-middle my-1">${o.map(d=>`<button onclick="window.handleWordAudioSpeak('${d.replace(/'/g,"\\'")}')" class="inline-flex items-center px-2.5 py-1 bg-white border border-neutral-200 hover:border-indigo-300 hover:bg-indigo-50 text-neutral-700 hover:text-indigo-700 rounded-lg text-xs font-bold transition-all shadow-sm active:scale-95">${d}</button>`).join("")}</span>`:""})},xL=n=>{const e=/\[NAV(?:\s+([^\]]+))?\]([\s\S]*?)\[\/\]/gi;return n.replace(e,(s,a,o)=>{const l=String(o||"").trim(),d=String(a||l).trim();return!l||!d?"":`<button onclick="window.handleMarkdownNav('${d.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/\n/g," ")}')" class="inline-flex items-center gap-1 px-2.5 py-1 bg-neutral-100 border border-neutral-200 hover:bg-neutral-900 hover:text-white hover:border-neutral-900 text-neutral-700 rounded-lg text-xs font-bold transition-all active:scale-95 my-1">${l}</button>`})},bL=n=>n.replace(/\[SOUND\s*(.*?)\]/gi,(e,s)=>{let a=[],o=s;if(s.includes("<")){const v=s.split("<");o=v[0],a=v[1].split(",").map(S=>parseFloat(S.trim())).filter(S=>!isNaN(S)).slice(0,10)}const l=o.split("|").map(v=>v.trim());if(l.length<2)return`[Invalid Sound: ${s}]`;const d=l[0],p=l[1],m=l[2]?parseFloat(l[2]):void 0,y=l[3]?parseFloat(l[3]):void 0,x=[`'${p.replace(/'/g,"\\'")}'`];return(a.length>0||y!==void 0||m!==void 0)&&x.push(m!==void 0?m.toString():"undefined"),(a.length>0||y!==void 0)&&x.push(y!==void 0?y.toString():"undefined"),a.length>0&&x.push(`[${a.join(",")}]`),`<button onclick="window.handleLessonSound(${x.join(", ")})" class="inline-flex items-center gap-2 px-3 py-1.5 bg-white border border-neutral-200 hover:border-indigo-300 hover:bg-indigo-50 text-neutral-700 hover:text-indigo-600 rounded-xl text-xs font-bold transition-all shadow-sm active:scale-95 my-1 mx-1 select-none"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-indigo-500"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>${d}</button>`}),vL=n=>n.replace(/\[IMG\s*(.*?)\]/gi,(e,s)=>{const a=s.split("|").map(y=>y.trim()),o=a[0],l=a[1];let d=o;if(!o.startsWith("http")){const y=Tt(),x=Vn(y),v=o.startsWith("/")?o.slice(1):o;v.startsWith("api/")?d=`${x}/${v}`:d=`${x}/api/audio/stream/${v}`}const p=l?`style="width: ${l}; max-width: 100%; height: auto;"`:"";return`<img src="${d}" ${p} ${l?'class="rounded-lg my-4 shadow-md border border-neutral-200"':'class="max-w-full h-auto rounded-lg my-4 shadow-md border border-neutral-200"'} />`}),U1=n=>{if(!n)return"";const e=n.replace(/\\n/g,`
`);let s=gL(e);s=yL(s),s=xL(s),s=bL(s),s=vL(s),s=fL(s),s=hL(s),s=pL(s),s=mL(s),s=dL(s);const a=s.split(`
`),o=[],l=[],d=(p=0)=>{for(;l.length>p;){const m=l.pop();o.push(m.type==="ul"?"</ul>":"</ol>")}};for(let p=0;p<a.length;p++){const m=a[p],y=m.trim();if(!y&&l.length===0){o.push('<br class="block my-2" />');continue}const x=uL(a.slice(p));if(x){d(0),o.push(x.html),p+=x.consumed-1;continue}if(/^([-*_])\s*(\1\s*){2,}$/.test(y)){d(0),o.push('<hr class="my-6 border-t-2 border-neutral-100" />');continue}if(y.startsWith("# ")){d(0),o.push(`<h1 class="text-3xl font-black text-neutral-900 mb-4 mt-8 pb-2 border-b border-neutral-100 leading-tight">${y.substring(2)}</h1>`);continue}if(y.startsWith("## ")){d(0),o.push(`<h2 class="text-xl font-extrabold text-neutral-800 mb-3 mt-6 leading-tight">${y.substring(3)}</h2>`);continue}if(y.startsWith("### ")){d(0),o.push(`<h3 class="text-lg font-bold text-neutral-700 mb-2 mt-4 leading-tight">${y.substring(4)}</h3>`);continue}if(y.startsWith("#### ")){d(0),o.push(`<h4 class="text-sm font-bold text-neutral-600 mb-1 mt-3 uppercase tracking-wider">${y.substring(5)}</h4>`);continue}if(y.startsWith("> ")){d(0),o.push(`<blockquote class="border-l-4 border-amber-400 bg-amber-50 pl-4 py-3 pr-2 my-4 rounded-r-lg text-sm text-neutral-700 font-medium italic shadow-sm">${y.substring(2)}</blockquote>`);continue}const v=y.match(/^\[(?!(HIDDEN:|Quiz:|Select:|QUIZ:|Multi:|Formula:|Audio-|IMG|(\/\])))(.*)\]$/);if(v){d(0);const C='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="shrink-0 mt-0.5 text-sky-500"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.8 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>',M=v[3].trim();o.push(`
                <div class="flex items-start gap-3 my-4 p-4 bg-sky-50 border-l-4 border-sky-400 rounded-r-lg shadow-sm">
                    ${C}
                    <div class="text-sm text-sky-900 font-medium leading-relaxed">
                        ${M}
                    </div>
                </div>
            `);continue}const S=m.match(/^(\s*)/),I=S?S[0].length:0,z=m.match(/^\s*[-*]\s+(.*)/),U=m.match(/^\s*(\d+)\.\s+(.*)/);if(z||U){const C=z?"ul":"ol",M=z?z[1]:U[2],B=U?U[1]:void 0;if(l.length===0||I>l[l.length-1].indent)o.push(C==="ul"?'<ul class="list-disc list-outside pl-5 my-3 space-y-1 text-neutral-700 marker:text-neutral-400">':'<ol class="list-decimal list-outside pl-5 my-3 space-y-1 text-neutral-700 marker:font-bold marker:text-neutral-500">'),l.push({type:C,indent:I});else if(I<l[l.length-1].indent)for(;l.length>0&&I<l[l.length-1].indent;)d(l.length-1);C==="ol"&&B?o.push(`<li value="${B}" class="pl-1">${M}</li>`):o.push(`<li class="pl-1">${M}</li>`);continue}y!==""&&(d(0),o.push(`<p class="mb-2 leading-relaxed text-neutral-600">${m}</p>`))}return d(0),o.join("").replace(/!\[(.*?)\]\((.*?)\)/g,(p,m,y)=>{let x=y;if(!y.startsWith("http")){const v=Tt(),S=Vn(v),I=y.startsWith("/")?y.slice(1):y;I.startsWith("api/")?x=`${S}/${I}`:x=`${S}/api/audio/stream/${I}`}return`<img alt="${m}" src="${x}" class="max-w-full h-auto rounded-lg my-4 shadow-md border border-neutral-200" />`}).replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="text-indigo-600 font-bold hover:underline">$1</a>').replace(/\*\*(.*?)\*\*/g,'<strong class="font-black text-neutral-900">$1</strong>').replace(/\*(.*?)\*/g,'<span class="italic font-normal text-inherit">$1</span>').replace(/`([^`]+)`/g,'<code class="bg-neutral-100 text-pink-600 px-1.5 py-0.5 rounded text-xs font-mono font-bold border border-neutral-200">$1</code>')},_L=({score:n})=>{const o=2*Math.PI*16,l=o-n/100*o;let d="text-neutral-400";return n>=80?d="text-green-500":n>=50?d="text-yellow-500":n>0&&(d="text-orange-500"),u.jsxs("div",{className:"relative flex items-center justify-center",style:{width:36,height:36},children:[u.jsxs("svg",{className:"absolute",width:36,height:36,children:[u.jsx("circle",{className:"text-neutral-100",stroke:"currentColor",strokeWidth:4,fill:"transparent",r:16,cx:36/2,cy:36/2}),u.jsx("circle",{className:d,stroke:"currentColor",strokeWidth:4,fill:"transparent",r:16,cx:36/2,cy:36/2,strokeDasharray:o,strokeDashoffset:l,strokeLinecap:"round",style:{transform:"rotate(-90deg)",transformOrigin:"50% 50%",transition:"stroke-dashoffset 0.5s ease-out"}})]}),u.jsx("span",{className:`text-[10px] font-black ${d}`,children:n})]})},EL=({word:n})=>{const e=n.masteryScore??0;return u.jsxs("div",{className:"relative group/score",children:[u.jsx(_L,{score:e}),u.jsxs("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 bg-neutral-800 text-white text-[10px] font-black rounded-lg opacity-0 group-hover/score:opacity-100 transition-opacity pointer-events-none z-10 uppercase tracking-wider",children:["Mastery Score",u.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 w-2 h-2 bg-neutral-800 rotate-45"})]})]})},wL=({register:n})=>{if(!n||n==="neutral"||n==="raw")return null;const e={academic:"bg-purple-100 text-purple-800 border-purple-200",casual:"bg-sky-100 text-sky-800 border-sky-200"},s={academic:"ACADEMIC",casual:"CASUAL"};return u.jsx("span",{className:`px-2 py-0.5 rounded text-[8px] font-black uppercase border ${e[n]}`,children:s[n]})},SL=n=>{const e={intensified:"bg-orange-100 text-orange-700 border-orange-200",softened:"bg-blue-100 text-blue-700 border-blue-200",synonym:"bg-neutral-100 text-neutral-600 border-neutral-200",academic:"bg-purple-100 text-purple-700 border-purple-200",casual:"bg-sky-100 text-sky-700 border-sky-200"};return u.jsx("span",{className:`px-2 py-0.5 rounded text-[8px] font-black uppercase border ${e[n]||e.synonym}`,children:n})},P1=({label:n,options:e,selectedId:s,onSelect:a,buttonClass:o,disabled:l=!1})=>{const[d,p]=L.useState(!1),m=L.useRef(null),y=e.find(x=>x.id===s)||e[0];return L.useEffect(()=>{const x=v=>{m.current&&!m.current.contains(v.target)&&p(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),u.jsxs("div",{className:"relative",ref:m,children:[u.jsxs("button",{type:"button",onClick:()=>p(!d),className:o,disabled:l,children:[n&&u.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-neutral-400 mr-2",children:n}),y.icon,u.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:y.label}),u.jsx(LE,{size:14,className:`transition-transform duration-200 ${d?"rotate-180":""}`})]}),d&&!l&&u.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-2xl shadow-xl border border-neutral-100 z-50 p-2 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col gap-1",children:e.map(x=>u.jsxs("button",{type:"button",onClick:()=>{a(x.id),p(!1)},className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-xs font-bold transition-colors ${s===x.id?"bg-neutral-100 text-neutral-900":"text-neutral-600 hover:bg-neutral-50 hover:text-neutral-900"}`,children:[x.icon,u.jsx("span",{children:x.label})]},x.id))})]})},TL=({word:n,onClose:e,onChallengeRequest:s,onMimicRequest:a,onEditRequest:o,onUpdate:l,linkedUnits:d,relatedWords:p,relatedByGroup:m,onNavigateToWord:y,onAddVariantToLibrary:x,addingVariant:v,existingVariants:S,isViewOnly:I=!1,appliedAccent:z,initialTab:U="OVERVIEW",onGenerateLesson:C})=>{var fe,Se,Oe,me,ue,ge,Ee,Ae,Ge,Ue,Ke,Nt,Pe;const[M,B]=L.useState(()=>yu("ielts_pro_word_view_settings",{showHidden:!1,highlightFailed:!0,isLearnView:!0})),[F,H]=L.useState(!1),[q,Y]=L.useState(U),[A,T]=L.useState(new Set),E=L.useRef(null);L.useEffect(()=>{console.log("=== ViewWordModalUI LOAD ==="),console.log("word.id:",n==null?void 0:n.id),console.log("lastTestResults:",n==null?void 0:n.lastTestResults)},[n]);const R=oe=>{as(oe)};L.useEffect(()=>{e0("ielts_pro_word_view_settings",M)},[M]);const N=(oe,Ve)=>B(lt=>({...lt,[oe]:Ve}));L.useEffect(()=>{const oe=Ve=>{E.current&&!E.current.contains(Ve.target)&&H(!1)};return document.addEventListener("mousedown",oe),()=>document.removeEventListener("mousedown",oe)},[]),L.useEffect(()=>(window.handleLessonSpeak=(oe,Ve)=>{as(oe,!1,Ve)},()=>{delete window.handleLessonSpeak}),[]);const D=[{id:"NEW",label:"New",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"})},{id:Ut.LEARNED,label:"Learned",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-cyan-500"})},{id:Ut.FORGOT,label:"Forgot",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-rose-500"})},{id:Ut.HARD,label:"Hard",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"})},{id:Ut.EASY,label:"Easy",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}],O=n.lastReview&&n.lastGrade||"NEW",ve=oe=>{if(!I)if(oe==="NEW"){const Ve=Zw(n);l(Ve)}else{const Ve=Kw(n,oe);l(Ve)}},ye=[{id:Yt.RAW,label:"Raw",icon:u.jsx(VE,{size:14,className:"text-neutral-400"})},{id:Yt.REFINED,label:"Needs Review",icon:u.jsx(ZE,{size:14,className:"text-indigo-500"})},{id:Yt.VERIFIED,label:"Verified",icon:u.jsx(WE,{size:14,className:"text-emerald-500"})},{id:Yt.FAILED,label:"Incorrect",icon:u.jsx(QE,{size:14,className:"text-rose-500"})}],G=(oe,Ve,lt,ct)=>{const nt=Array.isArray(Ve)?Ve.filter(Pt=>M.showHidden||!Pt.isIgnored):[];if(nt.length===0)return null;const qt={nouns:"n",verbs:"v",adjs:"j",advs:"d"}[ct]||ct;return u.jsxs("div",{className:"space-y-1",children:[u.jsx("span",{className:`text-[8px] font-black uppercase text-${lt}-600 tracking-widest ml-1`,children:oe}),u.jsx("div",{className:"flex flex-col gap-1",children:nt.map((Pt,Os)=>{var st,ht;const kn=S.has(Pt.word.toLowerCase()),Zt=Pt.word.toLowerCase().trim(),Le=[`WORD_FAMILY:${ct}:${Zt}`,`WORD_FAMILY:${qt}:${Zt}`].map(Xe=>{var Dt;return(Dt=n.lastTestResults)==null?void 0:Dt[Xe]}).find(Xe=>Xe!==void 0);let Ne=!1;if(Le!==void 0)Ne=Le===!1;else{const Xe=`WORD_FAMILY_${ct.toUpperCase()}`,Dt=(st=n.lastTestResults)==null?void 0:st[Xe];(Dt===!1||Dt===void 0&&((ht=n.lastTestResults)==null?void 0:ht.WORD_FAMILY)===!1)&&(Ne=!0)}const yt=M.highlightFailed&&Ne&&!Pt.isIgnored,rt=Pt.isIgnored;let Me="bg-white border-neutral-100 hover:border-neutral-300";return yt?Me="bg-red-50 border-red-200 hover:border-red-300":rt&&(Me="bg-neutral-50/50 border-neutral-100 opacity-60"),u.jsxs("div",{className:`flex items-center justify-between px-2 py-1.5 rounded-lg border group transition-colors ${Me}`,children:[u.jsx("div",{className:"flex flex-col overflow-hidden",children:u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx("span",{className:`text-[10px] font-bold truncate ${yt?"text-red-700":"text-neutral-900"} ${rt?"line-through decoration-neutral-400":""}`,children:Pt.word}),u.jsx("button",{onClick:Xe=>{Xe.stopPropagation(),as(Pt.word)},className:"text-neutral-300 hover:text-indigo-500 transition-colors p-0.5",children:u.jsx(Sr,{size:10})}),yt&&u.jsx(Ra,{size:10,className:"text-red-500 fill-red-100 shrink-0"})]})}),u.jsx("button",{type:"button",disabled:v===Pt.word||kn,onClick:()=>x({word:Pt.word,ipa:""},"family"),className:`p-1 rounded-md transition-all ${kn?"text-green-500 cursor-default":"text-neutral-300 hover:text-neutral-900 hover:bg-neutral-100"}`,children:v===Pt.word?u.jsx(mn,{size:10,className:"animate-spin"}):kn?u.jsx(wr,{size:10}):u.jsx(Xr,{size:10})})]},Os)})})]})},ae=({title:oe,icon:Ve,children:lt,className:ct})=>u.jsxs("div",{className:`space-y-2 ${ct||""}`,children:[u.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-black uppercase tracking-widest text-neutral-400 border-b border-neutral-100 pb-1 mb-2",children:[u.jsx(Ve,{size:12}),u.jsx("span",{children:oe})]}),lt]}),ne=yN(n.nextReview),Q=!!(n.wordFamily&&((fe=n.wordFamily.nouns)!=null&&fe.length||(Se=n.wordFamily.verbs)!=null&&Se.length||(Oe=n.wordFamily.adjs)!=null&&Oe.length||(me=n.wordFamily.advs)!=null&&me.length)),X=(n.prepositions||[]).filter(oe=>M.showHidden||!oe.isIgnored),j=(n.collocationsArray||[]).filter(oe=>M.showHidden||!oe.isIgnored),V=(n.idiomsList||[]).filter(oe=>M.showHidden||!oe.isIgnored),$=(n.paraphrases||[]).filter(oe=>M.showHidden||!oe.isIgnored),Z=oe=>{var Ve;return(Ve=n.lastTestResults)==null?void 0:Ve[oe]},ee=(oe,Ve)=>oe.some(lt=>Z(`${lt}:${Ve}`)===!1),pe=oe=>oe.some(Ve=>Z(Ve)===!1),ie=M.highlightFailed&&((ue=n.lastTestResults)==null?void 0:ue.SPELLING)===!1;M.highlightFailed&&(((ge=n.lastTestResults)==null?void 0:ge.IPA_QUIZ)===!1||((Ee=n.lastTestResults)==null||Ee.PRONUNCIATION)),L.useMemo(()=>{if(!n.wordFamily)return[];const oe=[],Ve=["nouns","verbs","adjs","advs"],lt={nouns:"Noun",verbs:"Verb",adjs:"Adjective",advs:"Adverb"};return Ve.forEach(ct=>{(n.wordFamily[ct]||[]).forEach(nt=>{(M.showHidden||!nt.isIgnored)&&oe.push({word:nt.word,type:lt[ct],ipa:nt.ipaUs})})}),oe},[n.wordFamily,M.showHidden]);const ce=L.useMemo(()=>{var oe;return(oe=n.lesson)!=null&&oe.essay?U1(n.lesson.essay):null},[(Ae=n.lesson)==null?void 0:Ae.essay]),De=L.useMemo(()=>{var oe;return(oe=n.lesson)!=null&&oe.test?U1(n.lesson.test):null},[(Ge=n.lesson)==null?void 0:Ge.test]);return u.jsx("div",{className:"fixed inset-0 z-[100] flex items-start sm:items-center justify-center p-2 sm:p-4 bg-black/40 backdrop-blur-sm animate-in fade-in duration-200 overflow-y-auto",children:u.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-2xl sm:rounded-[2.5rem] shadow-2xl flex flex-col max-h-[95vh] sm:max-h-[90vh] overflow-hidden",children:[u.jsx("header",{className:"px-4 sm:px-8 py-4 border-b border-neutral-100 bg-neutral-50/30 flex flex-col gap-2 shrink-0",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-start w-full gap-4",children:[u.jsx("div",{className:"flex-1 w-full",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h2",{className:`text-2xl font-black tracking-tight leading-none ${ie?"text-red-600":"text-neutral-900"}`,children:n.word}),ie&&u.jsx(Ra,{size:16,className:"text-red-500 fill-red-100"}),!n.isPassive&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:oe=>{oe.stopPropagation(),R(n.word)},className:"p-2 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 rounded-full transition-colors",title:"Pronounce",children:u.jsx(Sr,{size:18})}),u.jsx("button",{onClick:oe=>{oe.stopPropagation(),a()},className:"p-2 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 rounded-full transition-colors",title:"Mimic",children:u.jsx(Ao,{size:18})})]}),u.jsxs("div",{className:"relative group",children:[u.jsx("button",{onClick:oe=>{oe.stopPropagation(),as(n.meaningVi,!1,"vi")},className:"p-2 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 rounded-full transition-colors",title:"Read Vietnamese meaning",children:u.jsx(Tf,{size:18})}),u.jsxs("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-max max-w-xs px-3 py-2 bg-neutral-800 text-white text-xs font-bold rounded-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10",children:[n.meaningVi,u.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 w-2 h-2 bg-neutral-800 rotate-45"})]})]}),u.jsx(EL,{word:n})]})}),u.jsxs("div",{className:"flex items-center gap-2 flex-wrap sm:flex-nowrap justify-end w-full sm:w-auto",children:[u.jsx(P1,{options:D,selectedId:O,onSelect:ve,buttonClass:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg hover:bg-neutral-100 transition-colors shadow-sm border border-neutral-200",disabled:I}),u.jsxs("div",{className:"relative",ref:E,children:[u.jsx("button",{onClick:()=>H(!F),className:`p-2 rounded-lg transition-colors ${F?"bg-neutral-900 text-white shadow-sm":"bg-white border border-neutral-200 text-neutral-400 hover:text-neutral-900"}`,title:"View Options",children:u.jsx(ru,{size:16})}),F&&u.jsxs("div",{className:"absolute right-0 top-full mt-2 w-56 bg-white rounded-2xl shadow-xl border border-neutral-100 z-50 p-2 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col gap-1",children:[u.jsx("div",{className:"px-3 py-2 text-[9px] font-black text-neutral-400 uppercase tracking-widest border-b border-neutral-50",children:"View Options"}),u.jsxs("button",{onClick:()=>N("isLearnView",!M.isLearnView),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-neutral-50 text-xs font-bold text-neutral-700 transition-colors",children:[u.jsx("span",{children:"Learn View"}),M.isLearnView?u.jsx(wr,{size:14,className:"text-green-500"}):u.jsx("div",{className:"w-4 h-4 rounded-full border border-neutral-200"})]}),u.jsxs("button",{onClick:()=>N("showHidden",!M.showHidden),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-neutral-50 text-xs font-bold text-neutral-700 transition-colors",children:[u.jsx("span",{children:"Show Ignored Items"}),M.showHidden?u.jsx(wr,{size:14,className:"text-green-500"}):u.jsx("div",{className:"w-4 h-4 rounded-full border border-neutral-200"})]}),u.jsxs("button",{onClick:()=>N("highlightFailed",!M.highlightFailed),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-neutral-50 text-xs font-bold text-neutral-700 transition-colors",children:[u.jsx("span",{children:"Highlight Failed"}),M.highlightFailed?u.jsx(wr,{size:14,className:"text-green-500"}):u.jsx("div",{className:"w-4 h-4 rounded-full border border-neutral-200"})]})]})]}),!I&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:s,className:"p-2 bg-amber-100 text-amber-600 hover:text-amber-900 rounded-lg hover:bg-amber-200 transition-colors",title:"Practice",children:u.jsx(kE,{size:16})}),u.jsx("button",{onClick:o,className:"p-2 bg-neutral-100 text-neutral-600 hover:text-neutral-900 rounded-lg hover:bg-neutral-200 transition-colors",children:u.jsx(vI,{size:16})})]}),u.jsx("button",{onClick:e,className:"p-2 bg-white border border-neutral-200 text-neutral-400 hover:text-neutral-900 rounded-lg transition-colors",children:u.jsx(jn,{size:16})})]})]})}),u.jsxs("nav",{className:"px-4 sm:px-8 border-b border-neutral-100 bg-white flex items-center gap-4 sm:gap-6 shrink-0 overflow-x-auto no-scrollbar",children:[u.jsx("button",{onClick:()=>Y("OVERVIEW"),className:`py-3 px-1 text-[10px] font-black uppercase tracking-widest border-b-2 transition-all ${q==="OVERVIEW"?"border-neutral-900 text-neutral-900":"border-transparent text-neutral-400 hover:text-neutral-600"}`,children:"Overview"}),u.jsxs("button",{onClick:()=>Y("USAGE"),className:`py-3 px-1 text-[10px] font-black uppercase tracking-widest border-b-2 transition-all flex items-center gap-2 ${q==="USAGE"?"border-indigo-600 text-indigo-600":"border-transparent text-neutral-400 hover:text-neutral-600"}`,children:[u.jsx(lf,{size:14})," Usage"]}),u.jsxs("button",{onClick:()=>Y("TEST"),className:`py-3 px-1 text-[10px] font-black uppercase tracking-widest border-b-2 transition-all flex items-center gap-2 ${q==="TEST"?"border-emerald-600 text-emerald-600":"border-transparent text-neutral-400 hover:text-neutral-600"}`,children:[u.jsx(Vm,{size:14})," Practice Test"]})]}),u.jsxs("div",{className:"flex-1 overflow-auto no-scrollbar px-4 sm:px-6 pt-4 pb-8 bg-neutral-50/20",children:[q==="OVERVIEW"&&u.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"px-2 py-3 bg-white border border-neutral-100 rounded-2xl flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 shadow-sm",children:[u.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[u.jsx("div",{className:"flex flex-col",children:u.jsx("p",{className:"px-2 py-1 bg-neutral-50 rounded-lg text-sm font-mono font-medium border border-neutral-200 text-neutral-500",children:n.ipaUs||"/?/"})}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx(wL,{register:n.register}),(!n.register||n.register==="raw")&&u.jsx("span",{className:"px-2 py-1 bg-neutral-100 text-neutral-400 rounded-lg text-[10px] font-black uppercase tracking-tighter border border-neutral-200",children:"Neutral"})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(P1,{label:"Quality",options:ye,selectedId:n.quality,onSelect:oe=>l({...n,quality:oe}),buttonClass:"flex items-center gap-2 p-1.5 bg-neutral-50 border border-neutral-200 hover:bg-neutral-100 rounded-xl transition-all",disabled:I}),!n.isPassive&&u.jsx("div",{className:"flex flex-col items-end",children:u.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-bold text-neutral-500",title:`Next Review: ${ne.label}`,children:[u.jsx(ME,{size:12}),u.jsx("span",{className:`text-[11px] font-black uppercase ${ne.urgency==="due"?"text-rose-500":"text-green-600"}`,children:ne.label})]})})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[n.note&&u.jsx("div",{className:"md:col-span-4",children:u.jsx("p",{className:"text-sm text-neutral-700 bg-yellow-50/50 p-4 rounded-xl border border-yellow-100 italic leading-relaxed whitespace-pre-wrap",children:n.note})}),u.jsx(ae,{title:"Examples",icon:If,className:"md:col-span-4",children:n.example?u.jsx("div",{className:"flex flex-col gap-2",children:n.example.split(`
`).filter(oe=>oe.trim()!=="").map((oe,Ve)=>u.jsxs("div",{className:"flex items-start gap-2 px-3 py-2 bg-neutral-50 border border-neutral-100 rounded-xl group hover:border-neutral-200 transition-all",children:[u.jsx("span",{className:"text-sm font-medium text-neutral-700 leading-relaxed flex-1 select-text cursor-text",children:oe}),u.jsx("button",{onClick:()=>as(oe),className:"p-1.5 text-neutral-400 hover:text-indigo-500 hover:bg-white rounded-lg transition-all shrink-0",children:u.jsx(Sr,{size:14})})]},Ve))}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic px-1",children:"No examples added."})}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Cg,{size:10})," Prepositions"]}),X.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 bg-white border border-neutral-100 p-3 rounded-xl shadow-sm",children:X.map((oe,Ve)=>{var pt,qt;const lt=`PREPOSITION_QUIZ:${oe.prep}`,ct=(pt=n.lastTestResults)==null?void 0:pt[lt],nt=M.highlightFailed&&(ct===!1||ct===void 0&&((qt=n.lastTestResults)==null?void 0:qt.PREPOSITION_QUIZ)===!1)&&!oe.isIgnored;return u.jsxs("div",{className:`flex items-center justify-between gap-3 p-2 rounded-lg border transition-colors ${nt?"bg-red-50 border-red-200":"bg-neutral-50/30 border-neutral-100"} ${oe.isIgnored?"opacity-50":""}`,children:[u.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[nt&&u.jsx(Ra,{size:10,className:"text-red-500 shrink-0"}),u.jsx("span",{className:`font-bold text-xs shrink-0 ${nt?"text-red-700":"text-neutral-900"} ${oe.isIgnored?"line-through":""}`,children:oe.prep}),u.jsx("span",{className:`font-medium text-[10px] truncate ${nt?"text-red-400":"text-neutral-500"}`,children:oe.usage})]}),oe.usage&&u.jsx("button",{onClick:()=>as(oe.usage),className:"text-neutral-300 hover:text-indigo-500 transition-colors p-1 shrink-0",children:u.jsx(Sr,{size:12})})]},Ve)})}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic px-1",children:"No prepositions."})]}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(qE,{size:10})," Word Family"]}),u.jsx("div",{className:"p-3 bg-neutral-50 rounded-xl border border-neutral-100",children:Q?u.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[G("Nouns",(Ue=n.wordFamily)==null?void 0:Ue.nouns,"blue","nouns"),G("Verbs",(Ke=n.wordFamily)==null?void 0:Ke.verbs,"green","verbs"),G("Adjectives",(Nt=n.wordFamily)==null?void 0:Nt.adjs,"orange","adjs"),G("Adverbs",(Pe=n.wordFamily)==null?void 0:Pe.advs,"purple","advs")]}):u.jsx("span",{className:"text-[10px] text-neutral-300 italic",children:"No family data available."})})]}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Af,{size:10})," Collocations"]}),j.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 bg-white border border-neutral-200 p-3 rounded-xl",children:j.map((oe,Ve)=>{const lt=S.has(oe.text.toLowerCase());let ct=!1;if(M.highlightFailed&&!oe.isIgnored){const pt=["COLLOCATION_QUIZ","COLLOCATION_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ"];(ee(pt,oe.text)||!pt.some(qt=>Z(`${qt}:${oe.text}`)!==void 0)&&pe(pt))&&(ct=!0)}let nt="bg-indigo-50/50 border-indigo-100 text-indigo-900";return ct?nt="bg-red-50 border-red-200 text-red-700":oe.isIgnored&&(nt="bg-neutral-50 border-neutral-100 text-neutral-400"),u.jsxs("div",{className:`flex items-start justify-between gap-2 px-3 py-2 rounded-lg border text-xs font-bold transition-colors ${nt}`,children:[u.jsxs("div",{className:"flex-1 overflow-hidden",children:[ct&&u.jsx(Ra,{size:12,className:"text-red-500 shrink-0"}),u.jsx("span",{className:`truncate ${oe.isIgnored?"line-through":""}`,title:oe.text,children:oe.text}),oe.d&&!oe.isIgnored&&u.jsx("div",{className:"text-[10px] italic text-neutral-400 mt-0.5 normal-case font-medium",children:oe.d})]}),u.jsx("button",{onClick:()=>as(oe.text),className:"text-neutral-300 hover:text-indigo-500 transition-colors p-0.5",children:u.jsx(Sr,{size:10})}),u.jsx("button",{type:"button",disabled:v===oe.text||lt||oe.isIgnored,onClick:()=>x({word:oe.text,ipa:""},"collocation"),className:`p-1 rounded-md transition-all shrink-0 ${lt?"text-green-500 cursor-default":oe.isIgnored?"text-neutral-300 cursor-not-allowed":"text-neutral-400 hover:text-neutral-900 hover:bg-white/50"}`,title:lt?"Already in library":"Add to library",children:v===oe.text?u.jsx(mn,{size:12,className:"animate-spin"}):lt?u.jsx(wr,{size:12}):u.jsx(Xr,{size:12})})]},Ve)})}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic px-1",children:"No collocations."})]}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Nf,{size:10,className:"text-amber-500"})," Variations"]}),$.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:$.map((oe,Ve)=>{const lt=S.has(oe.word.toLowerCase()),ct=["PARAPHRASE_QUIZ","PARAPHRASE_CONTEXT_QUIZ"],nt=ct.some(Pt=>Z(`${Pt}:${oe.word}`)!==void 0),pt=M.highlightFailed&&!oe.isIgnored&&(ee(ct,oe.word)||!nt&&pe(ct)),qt=oe.isIgnored;return u.jsxs("div",{className:`flex items-start justify-between gap-2 border px-3 py-2 rounded-xl shadow-sm ${pt?"bg-red-50 border-red-200":qt?"bg-neutral-50 border-neutral-100 opacity-60":"bg-white border-neutral-200"}`,children:[u.jsxs("div",{className:"flex-1 overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-1",children:[SL(oe.tone),pt&&u.jsx(Ra,{size:12,className:"text-red-500 fill-red-100"})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("div",{className:`text-xs font-bold ${pt?"text-red-800":"text-neutral-800"} ${qt?"line-through":""}`,children:oe.word}),u.jsx("button",{onClick:()=>as(oe.word),className:"text-neutral-300 hover:text-indigo-500 transition-colors p-0.5",children:u.jsx(Sr,{size:10})})]}),u.jsx("div",{className:`text-[10px] italic truncate ${pt?"text-red-400":"text-neutral-400"}`,title:oe.context,children:oe.context})]}),u.jsx("button",{type:"button",disabled:v===oe.word||lt,onClick:()=>x({word:oe.word,ipa:""},"paraphrase"),className:`p-1 rounded-md transition-all mt-1 shrink-0 ${lt?"text-green-500 cursor-default":"text-neutral-300 hover:text-neutral-900 hover:bg-neutral-100"}`,children:v===oe.word?u.jsx(mn,{size:10,className:"animate-spin"}):lt?u.jsx(wr,{size:10}):u.jsx(Xr,{size:10})})]},Ve)})}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic",children:"No variations available."})]}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(jg,{size:10})," Related Idioms"]}),V.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 bg-white border border-neutral-200 p-3 rounded-xl",children:V.map((oe,Ve)=>{const lt=S.has(oe.text.toLowerCase());let ct=!1;if(M.highlightFailed&&!oe.isIgnored){const pt=["IDIOM_QUIZ","IDIOM_CONTEXT_QUIZ"];(ee(pt,oe.text)||!pt.some(qt=>Z(`${qt}:${oe.text}`)!==void 0)&&pe(pt))&&(ct=!0)}let nt="bg-amber-50/50 border-amber-100 text-amber-900";return ct?nt="bg-red-50 border-red-200 text-red-700":oe.isIgnored&&(nt="bg-neutral-50 border-neutral-100 text-neutral-400"),u.jsxs("div",{className:`flex items-start justify-between gap-2 px-3 py-2 rounded-lg border text-xs font-bold transition-colors ${nt}`,children:[u.jsxs("div",{className:"flex-1 overflow-hidden",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[ct&&u.jsx(Ra,{size:12,className:"text-red-500 shrink-0"}),u.jsx("span",{className:`truncate ${oe.isIgnored?"line-through":""}`,title:oe.text,children:oe.text}),u.jsx("button",{onClick:()=>as(oe.text),className:"text-neutral-300 hover:text-indigo-500 transition-colors p-0.5",children:u.jsx(Sr,{size:10})})]}),oe.d&&!oe.isIgnored&&u.jsx("div",{className:"text-[10px] italic text-neutral-400 mt-0.5 normal-case font-medium",children:oe.d})]}),u.jsx("button",{type:"button",disabled:v===oe.text||lt||oe.isIgnored,onClick:()=>x({word:oe.text,ipa:""},"idiom"),className:`p-1 rounded-md transition-all shrink-0 ${lt?"text-green-500 cursor-default":oe.isIgnored?"text-neutral-300 cursor-not-allowed":"text-neutral-400 hover:text-neutral-900 hover:bg-white/50"}`,title:lt?"Already in library":"Add to library",children:v===oe.text?u.jsx(mn,{size:12,className:"animate-spin"}):lt?u.jsx(wr,{size:12}):u.jsx(Xr,{size:12})})]},Ve)})}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic px-1",children:"No related idioms found."})]})]})]}),q==="USAGE"&&u.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-2 duration-500 flex flex-col h-full space-y-8",children:[ce?u.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-black prose-headings:text-neutral-900 prose-p:text-neutral-600 prose-p:leading-relaxed prose-img:rounded-xl prose-img:shadow-md prose-strong:text-neutral-900 prose-a:text-indigo-600 overflow-x-auto",dangerouslySetInnerHTML:{__html:ce}}):u.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white border-2 border-dashed border-neutral-200 rounded-[2.5rem] space-y-4",children:[u.jsx("div",{className:"p-4 bg-indigo-50 rounded-full text-indigo-600",children:u.jsx(lf,{size:32})}),u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"font-black text-neutral-900",children:"No Usage Guide"}),u.jsx("p",{className:"text-xs text-neutral-400 font-medium",children:"Generate a structural guide with tables and examples."})]}),!I&&u.jsxs("button",{onClick:()=>C==null?void 0:C("ESSAY"),className:"px-6 py-3 bg-neutral-900 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center gap-2 hover:bg-neutral-800 transition-all active:scale-95 shadow-lg",children:[u.jsx(Ol,{size:16})," Generate Usage Guide"]})]}),ce&&!I&&u.jsx("div",{className:"flex justify-center border-t border-neutral-100 pt-6",children:u.jsxs("button",{onClick:()=>C==null?void 0:C("ESSAY"),className:"flex items-center gap-2 px-4 py-2 bg-neutral-50 text-neutral-500 hover:text-indigo-600 hover:bg-indigo-50 border border-neutral-200 hover:border-indigo-200 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all",children:[u.jsx(Rl,{size:12})," ",u.jsx("span",{children:"Refresh Usage Guide"})]})})]}),q==="TEST"&&u.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-2 duration-500 flex flex-col h-full space-y-8",children:[De?u.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-black prose-headings:text-neutral-900 prose-p:text-neutral-600 prose-p:leading-relaxed prose-img:rounded-xl prose-img:shadow-md prose-strong:text-neutral-900 prose-a:text-indigo-600",dangerouslySetInnerHTML:{__html:De}}):u.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white border-2 border-dashed border-neutral-200 rounded-[2.5rem] space-y-4",children:[u.jsx("div",{className:"p-4 bg-emerald-50 rounded-full text-emerald-600",children:u.jsx(Vm,{size:32})}),u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"font-black text-neutral-900",children:"No Practice Test"}),u.jsx("p",{className:"text-xs text-neutral-400 font-medium",children:"Create an interactive test based on this word's usage."})]}),!I&&u.jsxs("button",{onClick:()=>C==null?void 0:C("TEST"),className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs uppercase tracking-widest flex items-center gap-2 hover:bg-neutral-800 transition-all active:scale-95 shadow-lg",children:[u.jsx(Ol,{size:16})," Generate Test"]})]}),De&&!I&&u.jsx("div",{className:"flex justify-center border-t border-neutral-100 pt-6",children:u.jsxs("button",{onClick:()=>C==null?void 0:C("TEST"),className:"flex items-center gap-2 px-4 py-2 bg-neutral-50 text-neutral-500 hover:text-emerald-600 hover:bg-emerald-50 border border-neutral-200 hover:border-emerald-200 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all",children:[u.jsx(Rl,{size:12})," ",u.jsx("span",{children:"Regenerate Test"})]})})]})]})]})})},AL=({title:n,type:e,currentStep:s,totalSteps:a,onClose:o,onFinish:l,label:d="Challenge",isQuickFire:p,elapsedTime:m})=>u.jsxs("div",{className:"px-6 py-5 border-b border-neutral-100 flex items-center justify-between bg-neutral-50/50 shrink-0",children:[u.jsx("button",{onClick:o,className:"p-2 -ml-2 text-neutral-400 hover:text-neutral-900 transition-colors",title:p?"Exit to Dashboard":"Close",children:u.jsx(jn,{size:20})}),u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:[d," ",s," of ",a]}),m&&u.jsxs("div",{className:"flex items-center gap-1 bg-neutral-200/50 px-1.5 py-0.5 rounded-md",children:[u.jsx(ME,{size:10,className:"text-neutral-500"}),u.jsx("span",{className:"text-[10px] font-mono font-bold text-neutral-600",children:m})]})]}),u.jsx("span",{className:"text-xs font-black text-neutral-900",children:n})]}),u.jsx("button",{onClick:()=>l(p),className:"p-2 -mr-2 text-amber-500 hover:text-amber-700 transition-colors",title:p?"Finish Session & See Results":"Finish & Save",children:u.jsx(hI,{size:20,className:p?"fill-amber-500":""})})]});class j0{constructor(){this.recognition=null,this.finalTranscript="",this.onResultCallback=null,this.onEndCallback=null,this.initBrowserRecognition()}initBrowserRecognition(){const e=window.SpeechRecognition||window.webkitSpeechRecognition;e&&(this.recognition=new e,this.recognition.continuous=!0,this.recognition.interimResults=!0,this.recognition.lang="en-US",this.recognition.onresult=s=>{let a="",o="";for(let l=s.resultIndex;l<s.results.length;++l)s.results[l].isFinal?o+=s.results[l][0].transcript:a+=s.results[l][0].transcript;this.finalTranscript+=o,this.onResultCallback&&this.onResultCallback(this.finalTranscript,a)},this.recognition.onend=()=>{this.onEndCallback&&this.onEndCallback(this.finalTranscript)},this.recognition.onerror=s=>{console.error("Speech Recognition Error:",s.error),this.stop()})}async start(e,s){if(this.onResultCallback=e,this.onEndCallback=s,this.finalTranscript="",!this.recognition){console.error("Speech Recognition not supported in this browser.");return}try{this.recognition.start()}catch(a){console.error("Speech Recognition start failed:",a)}}stop(){if(this.recognition)try{this.recognition.stop()}catch{}}}const k0=({isListening:n,onClick:e,disabled:s,className:a})=>u.jsx("button",{onClick:e,disabled:s,className:`p-2.5 rounded-xl transition-all shadow-sm flex items-center justify-center
            ${n?"bg-red-500 text-white animate-pulse ring-2 ring-red-200 border-transparent":"bg-white border border-neutral-200 text-neutral-400 hover:text-indigo-600 hover:border-indigo-300"} ${a}`,title:n?"Stop Recording":"Use Voice Input",tabIndex:-1,children:n?u.jsx(Lg,{size:18,fill:"currentColor"}):u.jsx(Ao,{size:18})}),$f=()=>{const[n,e]=L.useState({});return{validationState:n,clearValidation:d=>{e(p=>{if(!p[d])return p;const m={...p};return delete m[d],m})},getValidationClass:d=>{const p=n[d];return p==="correct"?"!border-green-500 !ring-2 !ring-green-100 !bg-green-50 text-green-900":p==="incorrect"?"!border-red-500 !ring-2 !ring-red-100 !bg-red-50 text-red-900":""},handleSmartChange:(d,p,m)=>{const y=d.target.value;if(y===" ")p(m);else if(y.endsWith("  ")){const x=y.substring(0,y.length-2),v=x.length>0?" ":"";p(x+v+m)}else p(y)},handleValidationKeyDown:(d,p,m)=>{if(d.key==="Escape"){d.preventDefault(),d.stopPropagation();const y=d.currentTarget.value,x=S=>S.trim().toLowerCase().replace(/[^a-z0-9]/g,"");let v=!1;if(Array.isArray(m)){const S=y.split(",").map(x).filter(Boolean);if(S.length===0){e(z=>({...z,[p]:null}));return}const I=new Set(m.map(x));v=S.every(z=>I.has(z))}else{const S=x(y);if(!S){e(I=>({...I,[p]:null}));return}v=x(m)===S}e(S=>({...S,[p]:v?"correct":"incorrect"}))}}}},IL=({group:n,userAnswers:e,results:s,onAnswerChange:a,isFinishing:o,showHint:l,toggleListening:d,listeningId:p,containerRef:m})=>{const{clearValidation:y,handleSmartChange:x,handleValidationKeyDown:v,getValidationClass:S}=$f();return u.jsxs("div",{ref:m,className:"flex flex-col animate-in fade-in duration-300",children:[u.jsxs("div",{className:"text-center space-y-2 mb-6",children:[u.jsx("h3",{className:"text-lg font-black text-neutral-900",children:"Preposition Drill"}),u.jsx("p",{className:"text-xs text-neutral-500 font-medium max-w-xs mx-auto",children:"Complete the collocations. Type the missing preposition(s)."})]}),u.jsx("div",{className:"space-y-4",children:n.map(I=>{var A,T;const z=e[I.index]||"",U=s?s[I.index]:null,C=typeof U=="boolean"?U:U&&typeof U=="object"?U.correct:!1,M=U!==null&&!C,B=I.challenge.example.split("___"),F=(A=B[0])==null?void 0:A.trim(),H=(T=B[1])==null?void 0:T.trim(),q=`prep-${I.index}`,Y=p===q;return u.jsxs("div",{className:"w-full bg-neutral-50 border-2 border-neutral-100 rounded-2xl p-5 flex flex-wrap items-center justify-center gap-x-2 gap-y-3 shadow-sm transition-all focus-within:border-neutral-300 focus-within:shadow-md focus-within:bg-white",children:[F&&u.jsx("span",{className:"text-lg font-medium text-neutral-600 text-right",children:F}),u.jsxs("div",{className:"relative mx-1 flex items-center gap-2",children:[u.jsx("input",{type:"text",value:z,onChange:E=>{y(q),x(E,R=>a(I.index,R),I.challenge.answer)},onKeyDown:E=>{v(E,q,I.challenge.answer)},disabled:o,className:`h-10 min-w-[80px] max-w-[160px] w-[12ch] text-center text-lg font-bold rounded-lg border-b-2 outline-none transition-colors ${o?C?"bg-green-50 border-green-500 text-green-700":"bg-red-50 border-red-500 text-red-700 decoration-red-500 line-through decoration-2":`bg-white border-neutral-300 text-neutral-900 focus:border-neutral-900 focus:bg-neutral-50 ${S(q)}`}`,placeholder:"?",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"}),!o&&u.jsx(k0,{isListening:Y,onClick:()=>d(q,E=>a(I.index,E)),disabled:o}),(o&&M||l)&&u.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 top-full mt-2 z-10",children:[u.jsxs("div",{className:"bg-neutral-900 text-white text-xs font-bold py-1 px-3 rounded-lg shadow-lg whitespace-nowrap flex items-center gap-1 animate-in zoom-in-95",children:[u.jsx($c,{size:10,className:"text-green-400"})," ",I.challenge.answer]}),u.jsx("div",{className:"w-2 h-2 bg-neutral-900 rotate-45 absolute left-1/2 -translate-x-1/2 -top-1"})]})]}),H&&u.jsx("span",{className:"text-lg font-medium text-neutral-800 text-left",children:H})]},I.index)})})]})},dm=({challenge:n,answer:e,onAnswer:s,isFinishing:a,result:o,showHint:l,itemLabel:d,instructionText:p,containerRef:m})=>{const[y,x]=L.useState(n.contexts.map(H=>({...H}))),[v,S]=L.useState(n.items.map(H=>({...H}))),[I,z]=L.useState(null),U=(H,q)=>{const Y=new Map(e);if(q===null)Y.delete(H);else{for(const[A,T]of Y.entries())T===q&&Y.delete(A);Y.set(H,q)}s(Y)};L.useEffect(()=>{const H=n.contexts.map(Y=>({...Y})),q=n.items.map(Y=>({...Y}));if(e)for(const[Y,A]of e.entries()){const T=H.findIndex(E=>E.id===Y);T!==-1&&(H[T].matchId=A)}x(H),S(q)},[e,n]);const C=H=>{a||z(q=>q===H?null:H)},M=H=>{a||!I||(U(H,I),z(null))},B=o&&typeof o=="object"&&"details"in o?o.details:{},F=()=>{a||s(new Map)};return u.jsxs("div",{ref:m,className:"flex flex-col gap-4 animate-in fade-in duration-300",children:[u.jsx("div",{className:"text-center",children:u.jsx("p",{className:"text-xs text-neutral-500 font-medium",children:p})}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsx("div",{className:"space-y-3",children:y.map(H=>{var R;const q=a&&B[H.id]===!0,Y=a&&B[H.id]===!1,A=n.items.find(N=>N.id===H.matchId),T=(R=n.items.find(N=>N.pairId===H.pairId))==null?void 0:R.text;let E="border-neutral-200";return a?(q&&(E="border-green-400 bg-green-50"),Y&&(E="border-red-400 bg-red-50")):l?E="border-yellow-400 bg-yellow-50":H.matchId&&(E="border-neutral-400 bg-neutral-50"),u.jsxs("button",{onClick:()=>M(H.id),disabled:a||!I,className:`relative w-full p-3 rounded-xl border-2 text-left transition-all duration-200 ${E} disabled:cursor-not-allowed`,children:[d(H),u.jsx("p",{className:"font-medium text-xs leading-snug text-neutral-600",children:H.text}),H.matchId&&!a&&!l&&u.jsx("p",{className:"font-bold text-xs mt-2 pt-2 border-t border-neutral-200",children:A==null?void 0:A.text}),l&&!a&&u.jsxs("div",{className:"mt-2 pt-2 border-t flex items-center gap-2 text-yellow-700 animate-in fade-in",children:[u.jsx(Cl,{size:14,className:"text-yellow-600"}),u.jsx("p",{className:"font-bold text-xs",children:T})]}),a&&u.jsxs("div",{className:"mt-2 pt-2 border-t flex items-center gap-2",children:[q?u.jsx(Cl,{size:14,className:"text-green-500"}):u.jsx(jn,{size:14,className:"text-red-500"}),u.jsx("p",{className:`font-bold text-xs ${Y?"text-red-700":"text-green-700"}`,children:(A==null?void 0:A.text)||"No selection"})]}),a&&Y&&u.jsxs("p",{className:"text-[10px] text-green-700 font-bold mt-1",children:["Correct: ",T]})]},H.id)})}),u.jsx("div",{className:"space-y-3",children:v.map(H=>{var T;const q=I===H.id,Y=e==null?void 0:e.has(((T=y.find(E=>E.matchId===H.id))==null?void 0:T.id)||"");let A="bg-white border-neutral-200 text-neutral-800 hover:border-neutral-900";return a&&Y?A="bg-neutral-100 border-neutral-200 text-neutral-400 opacity-60":q?A="bg-indigo-600 border-indigo-600 text-white ring-4 ring-indigo-100":Y&&(A="bg-neutral-100 border-neutral-200 text-neutral-400 opacity-60"),u.jsx("button",{onClick:()=>C(H.id),disabled:a||Y,className:`w-full p-3 rounded-xl border-2 text-left transition-all duration-200 disabled:cursor-not-allowed ${A}`,children:u.jsx("p",{className:"font-bold text-sm leading-snug",children:H.text})},H.id)})})]}),e&&e.size>0&&!a&&u.jsx("div",{className:"flex justify-center pt-2",children:u.jsxs("button",{onClick:F,className:"flex items-center gap-1.5 text-xs font-bold text-neutral-500 hover:text-neutral-900 transition-colors",children:[u.jsx(Rl,{size:12})," Reset"]})})]})},NL=({challenge:n,onAnswer:e,isFinishing:s,result:a,containerRef:o})=>{const[l,d]=L.useState(!1),[p,m]=L.useState(""),y=L.useRef(null);L.useEffect(()=>{try{y.current=new j0}catch(z){console.error("Speech Recognition not supported",z)}return()=>{var z;(z=y.current)==null||z.stop()}},[]);const x=()=>{y.current&&(m(""),d(!0),y.current.start((z,U)=>m(z+U),z=>{d(!1),e(z)}))},v=()=>{var z;(z=y.current)==null||z.stop()},S=()=>{l?v():x()},I=a===!0;return u.jsxs("div",{ref:o,className:"text-center space-y-8 animate-in fade-in duration-300 flex flex-col items-center",children:[u.jsx("p",{className:"text-sm font-bold text-neutral-500",children:"Press the button and pronounce the word below."}),u.jsx("h2",{className:"text-4xl font-black text-neutral-900 tracking-tight",children:n.word.word}),u.jsx("button",{onClick:S,disabled:s,className:`w-24 h-24 rounded-full flex items-center justify-center shadow-lg transition-all active:scale-95 disabled:opacity-50
                    ${l?"bg-neutral-900 text-white animate-pulse":"bg-red-600 text-white hover:scale-105 shadow-red-500/30"}`,children:l?u.jsx(Lg,{size:32,fill:"white"}):u.jsx(Ao,{size:32})}),u.jsx("div",{className:"w-full max-w-sm min-h-[6rem] p-4 bg-neutral-50 border border-neutral-200 rounded-xl text-lg font-medium text-neutral-600 italic",children:p||"..."}),s&&u.jsxs("div",{className:`flex items-center gap-2 font-bold text-lg animate-in fade-in slide-in-from-bottom-2 ${I?"text-green-600":"text-red-600"}`,children:[I?u.jsx(tI,{size:20}):u.jsx(rI,{size:20}),u.jsx("span",{children:I?"Correct!":`Not quite. The word was "${n.word.word}".`})]})]})},fm=({word:n,title:e,cue:s,options:a,answer:o,selected:l,onAnswer:d,isFinishing:p,showHint:m,containerRef:y})=>u.jsxs("div",{ref:y,className:"text-center space-y-6 animate-in fade-in duration-300 flex flex-col",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:e}),u.jsx("h2",{className:"text-3xl font-black text-neutral-900",children:n.word}),s&&u.jsx("div",{className:"inline-flex items-center gap-2 bg-neutral-100 px-3 py-1.5 rounded-lg border border-neutral-200 max-w-sm mx-auto mt-2",children:u.jsx("span",{className:"text-xs font-bold text-neutral-700 italic",children:s})})]}),u.jsx("div",{className:"grid grid-cols-1 gap-3",children:a.map((x,v)=>{let S="bg-white border-neutral-200 hover:border-neutral-400 text-neutral-700";return p?x===o?S="bg-green-50 border-green-500 text-green-700 shadow-md ring-1 ring-green-500":x===l&&x!==o?S="bg-red-50 border-red-500 text-red-700 opacity-60":S="bg-neutral-50 border-neutral-100 text-neutral-400 opacity-40":m&&x===o?S="bg-yellow-50 border-yellow-400 text-yellow-800 shadow-md ring-1 ring-yellow-400":l===x&&(S="bg-neutral-900 border-neutral-900 text-white shadow-lg"),u.jsx("button",{disabled:p,onClick:()=>d(x),className:`p-4 rounded-2xl border-2 text-sm font-medium transition-all duration-200 text-left leading-snug active:scale-[0.98] ${S}`,children:x},v)})})]}),hm=({word:n,title:e,cue:s,contextTag:a,answer:o,userAnswer:l,onAnswer:d,isFinishing:p,result:m,showHint:y,containerRef:x,toggleListening:v,listeningId:S})=>{const{clearValidation:I,handleSmartChange:z,handleValidationKeyDown:U,getValidationClass:C}=$f(),M=m===!0,B=m===!1,F="main",H=S===F;return u.jsxs("div",{ref:x,className:"text-center space-y-8 animate-in fade-in duration-300 flex flex-col items-center",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:e}),u.jsx("h2",{className:"text-3xl font-black text-neutral-900",children:n.word}),(s||a)&&u.jsxs("div",{className:"inline-flex items-center gap-2 bg-neutral-100 px-3 py-1.5 rounded-lg border border-neutral-200 max-w-sm",children:[a&&u.jsx("span",{className:"text-[9px] font-black uppercase bg-white px-1.5 py-0.5 rounded border border-neutral-200 text-neutral-500",children:a}),s&&u.jsx("span",{className:"text-xs font-bold text-neutral-700 italic",children:s})]})]}),u.jsxs("div",{className:"w-full max-w-md flex flex-col items-center gap-3",children:[u.jsxs("div",{className:"relative w-full",children:[u.jsx("input",{type:"text",autoFocus:!0,value:l||"",onChange:q=>{I(F),z(q,d,n.word)},onKeyDown:q=>{U(q,F,o)},disabled:p,className:`w-full text-center py-4 pl-12 pr-12 rounded-2xl border-2 text-xl font-bold focus:outline-none placeholder:text-neutral-200 transition-colors duration-200 ${p?M?"bg-green-50 border-green-500 text-green-600":"bg-red-50 border-red-500 text-red-600":`bg-neutral-50 border-transparent focus:bg-white focus:border-neutral-900 text-neutral-900 shadow-sm ${C(F)}`}`,placeholder:"Type answer...",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"}),!p&&u.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:u.jsx(k0,{isListening:H,onClick:()=>v(F,d),disabled:p})})]}),(p&&B||y)&&u.jsx("div",{className:"text-green-600 font-bold text-lg animate-in slide-in-from-top-2 bg-green-50 px-3 py-1 rounded-lg border border-green-100 inline-block",children:o})]})]})},CL=({word:n,userAnswer:e,onAnswer:s,isFinishing:a,resultDetails:o,showHint:l,containerRef:d,toggleListening:p,listeningId:m})=>{const{clearValidation:y,handleSmartChange:x,handleValidationKeyDown:v,getValidationClass:S}=$f(),I=n.wordFamily,z=e||{},U=(C,M)=>{s({...z,[C]:M})};return u.jsxs("div",{ref:d,className:"space-y-6 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"text-center space-y-1",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Word Family"}),u.jsx("h2",{className:"text-3xl font-black text-neutral-900",children:n.word}),u.jsx("p",{className:"text-xs font-bold text-neutral-500",children:"Fill related forms"})]}),u.jsx("div",{className:"grid grid-cols-1 gap-4",children:["nouns","verbs","adjs","advs"].map(C=>{const M=((I==null?void 0:I[C])||[]).filter(T=>!T.isIgnored).map(T=>T.word);if(M.length===0)return null;const B={nouns:"Noun",verbs:"Verb",adjs:"Adjective",advs:"Adverb"}[C],F=z[C]||"",H=o[C],q=a,Y=`fam-${C}`,A=m===Y;return u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:"w-20 text-[10px] font-black uppercase text-neutral-400 text-right",children:B}),u.jsxs("div",{className:"flex-1 relative flex items-center gap-2",children:[u.jsx("input",{type:"text",value:F,onChange:T=>{y(Y),x(T,E=>U(C,E),n.word)},onKeyDown:T=>{v(T,Y,M)},disabled:a,className:`w-full px-4 py-2 bg-neutral-50 border-2 rounded-xl text-sm font-bold outline-none transition-all ${q?H?"border-green-500 bg-green-50 text-green-800":"border-red-500 bg-red-50 text-red-800":`border-neutral-100 focus:border-neutral-900 focus:bg-white ${S(Y)}`}`,placeholder:"..."}),!a&&u.jsx(k0,{isListening:A,onClick:()=>p(Y,T=>U(C,T)),disabled:a}),(q&&!H||l)&&u.jsx("div",{className:"text-[10px] font-bold text-green-600 mt-1 pl-1",children:((I==null?void 0:I[C])||[]).filter(T=>!T.isIgnored).map(T=>T.word).join(", ")})]})]},C)})})]})},RL=({word:n,original:e,shuffled:s,userAnswer:a,onAnswer:o,isFinishing:l,isCorrect:d,showHint:p,containerRef:m})=>{const[y,x]=qn.useState(0),v=a||[],S=new Set;v.forEach(C=>{const M=s.findIndex((B,F)=>B===C&&!S.has(F));M!==-1&&S.add(M)});const I=C=>{if(l)return;const M=[...v];M.splice(y,0,C),o(M),x(B=>B+1)},z=C=>{if(l)return;const M=[...v];M.splice(C,1),o(M),y>C&&x(B=>B-1)},U=({index:C})=>{const M=C===y;return l?u.jsx("div",{className:"w-1 mx-0.5"}):u.jsx("div",{onClick:()=>x(C),className:`h-8 w-2 rounded-full cursor-pointer transition-all duration-200 mx-0.5 flex items-center justify-center ${M?"bg-indigo-500 scale-110 shadow-sm":"bg-transparent hover:bg-neutral-200"}`,children:u.jsx("div",{className:`w-1 h-4 rounded-full ${M?"bg-white/50":"bg-transparent"}`})})};return u.jsxs("div",{ref:m,className:"flex flex-col space-y-6 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"text-center space-y-1",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Sentence Builder"}),u.jsxs("p",{className:"text-xs text-neutral-500 font-medium",children:['Reconstruct the example sentence for "',n.word,'".']})]}),u.jsxs("div",{className:`min-h-[120px] p-6 rounded-[2rem] border-2 border-dashed flex flex-wrap gap-y-3 items-center justify-center transition-all ${l?d?"bg-green-50 border-green-200":"bg-red-50 border-red-200":"bg-neutral-50 border-neutral-200"}`,children:[v.length===0&&!l&&u.jsx("span",{className:"absolute text-sm font-bold text-neutral-300 italic pointer-events-none",children:"Click words below to build sentence..."}),u.jsx(U,{index:0}),v.map((C,M)=>u.jsxs(qn.Fragment,{children:[u.jsxs("button",{onClick:()=>z(M),disabled:l,className:`px-3 py-2 rounded-xl text-sm font-bold shadow-sm transition-all active:scale-95 flex items-center gap-1 group ${l?d?"bg-green-600 text-white":"bg-red-500 text-white":"bg-white text-neutral-900 border border-neutral-100 hover:border-red-200 hover:text-red-500"}`,children:[C," ",!l&&u.jsx(jn,{size:14,className:"opacity-40 group-hover:opacity-100"})]}),u.jsx(U,{index:M+1})]},`${C}-${M}`))]}),(l||p)&&u.jsxs("div",{className:"p-4 bg-yellow-50 rounded-2xl border border-yellow-100 animate-in slide-in-from-top-2",children:[u.jsx("p",{className:"text-xs font-black text-yellow-600 uppercase tracking-widest mb-1",children:"Correct Sentence"}),u.jsx("p",{className:"text-sm font-bold text-yellow-900 leading-relaxed",children:e})]}),u.jsx("div",{className:"flex flex-wrap gap-2 justify-center pt-4",children:s.map((C,M)=>{const B=S.has(M);return u.jsx("button",{onClick:()=>I(C),disabled:B||l,className:`px-4 py-2.5 rounded-xl text-sm font-bold transition-all active:scale-95 ${B?"bg-neutral-100 text-neutral-300 border-transparent cursor-default":"bg-white border-2 border-neutral-100 text-neutral-700 hover:border-neutral-900 hover:text-neutral-900 shadow-sm"}`,children:C},M)})}),!l&&v.length>0&&u.jsxs("button",{onClick:()=>o([]),className:"mx-auto flex items-center space-x-1.5 text-[10px] font-black uppercase text-neutral-400 hover:text-neutral-600 transition-colors",children:[u.jsx(jn,{size:12}),u.jsx("span",{children:"Reset"})]})]})},OL=({word:n,forms:e,ipaOptions:s,userAnswer:a,onAnswer:o,isFinishing:l,result:d,showHint:p,containerRef:m})=>{const y=a||{},x=(v,S)=>{o({...y,[v]:S})};return u.jsxs("div",{ref:m,className:"text-center space-y-6 animate-in fade-in duration-300",children:[u.jsxs("p",{className:"text-sm font-bold text-neutral-500",children:["The word ",u.jsxs("span",{className:"font-black text-neutral-900",children:['"',n.word,'"']})," has different pronunciations. Match the IPA to the part of speech."]}),u.jsx("div",{className:"space-y-6",children:e.map(v=>{const S=y[v.pos];return u.jsxs("div",{className:"space-y-3",children:[u.jsxs("h4",{className:"text-sm font-black text-neutral-900 uppercase tracking-widest bg-neutral-100 py-1 rounded-md",children:["As a ",v.pos]}),u.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.map(I=>{let z="bg-white border-neutral-200 hover:border-neutral-400 text-neutral-600";return l?I===v.ipa?z="bg-green-50 border-green-500 text-green-700 shadow-md":I===S?z="bg-red-50 border-red-500 text-red-700 opacity-60":z="bg-neutral-50 border-neutral-100 text-neutral-400 opacity-50":S===I&&(z="bg-neutral-900 border-neutral-900 text-white shadow-lg"),u.jsx("button",{disabled:l,onClick:()=>x(v.pos,I),className:`p-3 rounded-xl border-2 font-mono text-base font-medium transition-all duration-200 ${z}`,children:I},I)})})]},v.pos)})}),l&&d===!1&&!p&&u.jsx("div",{className:"text-center text-rose-600 font-bold text-sm",children:"One or more selections were incorrect."})]})},jL=({word:n,userAnswer:e,onAnswer:s,isFinishing:a,result:o,showHint:l,containerRef:d})=>{const{clearValidation:p,handleSmartChange:m,handleValidationKeyDown:y,getValidationClass:x}=$f(),v=o===!0,S=o===!1,I="main";return u.jsxs("div",{ref:d,className:"text-center space-y-8 animate-in fade-in duration-300",children:[u.jsx("p",{className:"text-sm font-bold text-neutral-500",children:"Listen carefully and type the word."}),u.jsxs("div",{className:"space-y-6 flex flex-col items-center",children:[u.jsx("button",{onClick:()=>as(n.word),className:"p-6 bg-neutral-50 hover:bg-neutral-100 text-neutral-900 rounded-full shadow-sm transition-all active:scale-95",children:u.jsx(Sr,{size:32})}),u.jsxs("div",{className:"w-full max-w-sm flex flex-col items-center gap-4",children:[u.jsx("div",{className:"relative w-full",children:u.jsx("input",{type:"text",autoFocus:!0,value:e||"",onChange:z=>{p(I),m(z,s,n.word)},onKeyDown:z=>{y(z,I,n.word)},disabled:a,className:`w-full text-center py-4 rounded-2xl border-2 text-3xl font-bold focus:outline-none tracking-[0.1em] placeholder:text-neutral-200 transition-colors duration-200 ${a?v?"bg-green-50 border-green-500 text-green-600":"bg-red-50 border-red-500 text-red-600":`bg-neutral-50 border-transparent focus:bg-white focus:border-neutral-900 text-neutral-900 shadow-sm ${x(I)}`}`,placeholder:"TYPE HERE",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"})}),(a&&S||l)&&u.jsx("div",{className:"text-xl font-black text-yellow-500 animate-in fade-in slide-in-from-bottom-2",children:n.word})]})]})]})},kL=({word:n,currentChallenge:e,currentChallengeIndex:s,userAnswers:a,handleAnswerChange:o,results:l,isFinishing:d,currentPrepositionGroup:p,showHint:m,onEnterPress:y})=>{const x=L.useRef(null),[v,S]=L.useState(null),I=L.useRef(null);L.useEffect(()=>{try{I.current=new j0}catch{}return()=>{var U;(U=I.current)==null||U.stop()}},[]),L.useEffect(()=>{var U;(U=I.current)==null||U.stop(),S(null)},[s,p]);const z=(U,C)=>{I.current&&(v===U?(I.current.stop(),S(null)):(v&&I.current.stop(),C(""),S(U),I.current.start((M,B)=>{const F=M+(B?(M?" ":"")+B:"");C(F)},M=>{const B=M.trim().replace(/[.]/g,"");C(B),S(null)})))};if(L.useEffect(()=>{const U=()=>{var B,F;const M=(B=x.current)==null?void 0:B.querySelector('input[type="text"]:not([disabled]), textarea:not([disabled])');M&&!((F=x.current)!=null&&F.contains(document.activeElement))&&M.focus()};setTimeout(U,50);const C=M=>{var B;if(!(M.metaKey||M.ctrlKey||M.altKey)){if(M.key==="Enter"){const F=document.activeElement;if(F&&F.tagName==="TEXTAREA"&&M.shiftKey)return;M.preventDefault(),y();return}if(M.key.length===1){const F=document.activeElement;((B=x.current)==null?void 0:B.contains(F))||U()}}};return window.addEventListener("keydown",C),()=>window.removeEventListener("keydown",C)},[s,y]),p)return u.jsx(IL,{containerRef:x,group:p.group,userAnswers:a,results:l,onAnswerChange:o,isFinishing:d,showHint:m,toggleListening:z,listeningId:v});switch(e.type){case"PARAPHRASE_CONTEXT_QUIZ":{const U=e;return u.jsx(dm,{containerRef:x,challenge:{contexts:U.contexts,items:U.paraphrases},answer:a[s],onAnswer:C=>o(s,C),isFinishing:d,result:l?l[s]:null,showHint:m,itemLabel:C=>C.tone&&u.jsx("span",{className:"inline-block text-[9px] font-black uppercase bg-neutral-100 text-neutral-500 px-1.5 py-0.5 rounded border border-neutral-200 mb-1",children:C.tone}),instructionText:"Match each phrase on the right to its correct context on the left."})}case"COLLOCATION_CONTEXT_QUIZ":{const U=e;return u.jsx(dm,{containerRef:x,challenge:{contexts:U.contexts,items:U.collocations},answer:a[s],onAnswer:C=>o(s,C),isFinishing:d,result:l?l[s]:null,showHint:m,itemLabel:()=>null,instructionText:"Match each collocation on the right to its correct definition/cue."})}case"IDIOM_CONTEXT_QUIZ":{const U=e;return u.jsx(dm,{containerRef:x,challenge:{contexts:U.contexts,items:U.idioms},answer:a[s],onAnswer:C=>o(s,C),isFinishing:d,result:l?l[s]:null,showHint:m,itemLabel:()=>null,instructionText:"Match each idiom on the right to its correct definition/cue."})}case"COLLOCATION_MULTICHOICE_QUIZ":{const U=e;return u.jsx(fm,{containerRef:x,word:n,title:"Select Collocation",cue:U.cue,options:U.options,answer:U.answer,selected:a[s],onAnswer:C=>o(s,C),isFinishing:d,showHint:m})}case"COLLOCATION_QUIZ":{const U=e,C=l?l[s]:null,M=typeof C=="boolean"?C:C&&typeof C=="object"?C.correct:null;return u.jsx(hm,{containerRef:x,word:n,title:"Fill Collocation",cue:U.cue,answer:U.answer,userAnswer:a[s],onAnswer:B=>o(s,B),isFinishing:d,result:M,showHint:m,toggleListening:z,listeningId:v})}case"IDIOM_QUIZ":{const U=e,C=l?l[s]:null,M=typeof C=="boolean"?C:C&&typeof C=="object"?C.correct:null;return u.jsx(hm,{containerRef:x,word:n,title:"Fill Idiom",cue:U.cue,answer:U.answer,userAnswer:a[s],onAnswer:B=>o(s,B),isFinishing:d,result:M,showHint:m,toggleListening:z,listeningId:v})}case"PRONUNCIATION":return u.jsx(NL,{containerRef:x,challenge:e,onAnswer:U=>o(s,U),isFinishing:d,result:l?l[s]:null});case"HETERONYM_QUIZ":{const U=e,C=l?l[s]:null,M=typeof C=="boolean"?C:null;return u.jsx(OL,{containerRef:x,word:n,forms:U.forms,ipaOptions:U.ipaOptions,userAnswer:a[s],onAnswer:B=>o(s,B),isFinishing:d,result:M,showHint:m})}case"SENTENCE_SCRAMBLE":{const U=e,C=l?l[s]:null,M=typeof C=="boolean"?C:null;return u.jsx(RL,{containerRef:x,word:n,original:U.original,shuffled:U.shuffled||[],userAnswer:a[s],onAnswer:B=>o(s,B),isFinishing:d,isCorrect:M,showHint:m})}case"SPELLING":{const U=l?l[s]:null,C=typeof U=="boolean"?U:null;return u.jsx(jL,{containerRef:x,word:n,userAnswer:a[s],onAnswer:M=>o(s,M),isFinishing:d,result:C,showHint:m})}case"IPA_QUIZ":{const U=e;return u.jsx(fm,{containerRef:x,word:n,title:"Select Pronunciation",options:U.options,answer:U.answer,selected:a[s],onAnswer:C=>o(s,C),isFinishing:d,showHint:m})}case"MEANING_QUIZ":{const U=e;return u.jsx(fm,{containerRef:x,word:n,title:"Select Definition",options:U.options,answer:U.answer,selected:a[s],onAnswer:C=>o(s,C),isFinishing:d,showHint:m})}case"PARAPHRASE_QUIZ":{const U=e,C=l?l[s]:null,M=typeof C=="boolean"?C:null;return u.jsx(hm,{containerRef:x,word:n,title:"Fill Paraphrase",contextTag:U.tone,cue:U.context,answer:U.answer,userAnswer:a[s],onAnswer:B=>o(s,B),isFinishing:d,result:M,showHint:m,toggleListening:z,listeningId:v})}case"WORD_FAMILY":{const U=l?l[s]:null,C=U&&typeof U=="object"&&"details"in U?U.details:{};return u.jsx(CL,{containerRef:x,word:n,userAnswer:a[s],onAnswer:M=>o(s,M),isFinishing:d,resultDetails:C,showHint:m,toggleListening:z,listeningId:v})}default:return null}},LL=({onBack:n,onNext:e,onIgnore:s,onHint:a,showHint:o,isBackDisabled:l,isNextDisabled:d,isLastChallenge:p,nextLabel:m,disableHints:y})=>{const x=p&&!m;return u.jsxs("div",{className:"p-4 bg-white border-t border-neutral-100 flex items-center justify-between gap-3 shrink-0",children:[u.jsx("button",{onClick:n,disabled:l,className:"p-4 rounded-2xl bg-neutral-50 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 disabled:opacity-30 disabled:hover:bg-neutral-50 disabled:hover:text-neutral-400 transition-all",title:"Previous Question",children:u.jsx(jE,{size:20})}),!p&&!d&&u.jsx("button",{onClick:s,className:"px-4 py-4 rounded-2xl text-neutral-400 hover:text-neutral-600 font-bold text-xs uppercase tracking-wider hover:bg-neutral-50 transition-colors",children:"Ignore"}),!d&&!y&&u.jsx("button",{onClick:a,className:`p-4 rounded-2xl transition-colors ${o?"text-yellow-500 bg-yellow-50 hover:bg-yellow-100":"text-neutral-400 hover:text-yellow-500 hover:bg-neutral-50"}`,title:"Show Hint",children:u.jsx(Og,{size:20,className:o?"fill-yellow-500":""})}),u.jsxs("button",{onClick:e,disabled:d,className:"flex-1 py-4 rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 shadow-lg transition-all active:scale-95 bg-neutral-900 text-white hover:bg-neutral-800",children:[u.jsx("span",{children:m||(p?"Finish":"Next")}),x?u.jsx(wr,{size:16}):u.jsx($c,{size:16})]})]})},ML={sp:"SPELLING",iq:"IPA_QUIZ",pq:"PREPOSITION_QUIZ",wf:"WORD_FAMILY",mq:"MEANING_QUIZ",prq:"PARAPHRASE_QUIZ",sc:"SENTENCE_SCRAMBLE",hq:"HETERONYM_QUIZ",p:"PRONUNCIATION",cq:"COLLOCATION_QUIZ",idq:"IDIOM_QUIZ",pcq:"PARAPHRASE_CONTEXT_QUIZ",ccq:"COLLOCATION_CONTEXT_QUIZ",cmq:"COLLOCATION_MULTICHOICE_QUIZ",icq:"IDIOM_CONTEXT_QUIZ",wf_n:"WORD_FAMILY_NOUNS",wf_v:"WORD_FAMILY_VERBS",wf_j:"WORD_FAMILY_ADJS",wf_d:"WORD_FAMILY_ADVS"},DL={collocation:["COLLOCATION_QUIZ","COLLOCATION_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ"],paraphrase:["PARAPHRASE_QUIZ","PARAPHRASE_CONTEXT_QUIZ"],idiom:["IDIOM_QUIZ","IDIOM_CONTEXT_QUIZ"],pronunciation:["PRONUNCIATION","IPA_QUIZ"]},V1=Object.fromEntries(Object.entries(DL).flatMap(([n,e])=>e.map(s=>[s,n]))),z1=n=>n.split(":")[0],fo=n=>{if(!n)return{};const e={};return Object.entries(n).forEach(([s,a])=>{const o=s.split(":"),l=o[0],p=[ML[l]||l,...o.slice(1)].join(":");e[p]=a}),e},jT=(n,e)=>{const s=fo(n),a=fo(e),o=new Set;Object.keys(a).forEach(d=>{const p=V1[z1(d)];p&&o.add(p)});const l={...s};return o.size>0&&Object.keys(l).forEach(d=>{const p=V1[z1(d)];p&&o.has(p)&&delete l[d]}),{...l,...a}},B1=[{id:"core",title:"Core Skills",description:"Essential accuracy",color:"text-blue-700",bg:"bg-blue-50/60",border:"border-blue-100",areas:[{id:"spelling",label:"Spelling",icon:RI,types:["SPELLING"]},{id:"sound",label:"Sound",icon:Sr,types:["PRONUNCIATION","IPA_QUIZ","HETERONYM_QUIZ"]},{id:"meaning",label:"Meaning",icon:Tf,types:["MEANING_QUIZ"]},{id:"preposition",label:"Prep.",icon:Cg,types:["PREPOSITION_QUIZ"]}]},{id:"advanced",title:"Advanced Usage",description:"Fluency & range",color:"text-purple-700",bg:"bg-purple-50/60",border:"border-purple-100",areas:[{id:"family",label:"Word Family",icon:qE,types:["WORD_FAMILY"]},{id:"collocation",label:"Collocation",icon:Af,types:["COLLOCATION_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ","COLLOCATION_QUIZ"]},{id:"paraphrase",label:"Paraphrase",icon:Nf,types:["PARAPHRASE_CONTEXT_QUIZ","PARAPHRASE_QUIZ"]}]},{id:"bonus",title:"Good to Have",description:"Context & Flair",color:"text-amber-700",bg:"bg-amber-50/60",border:"border-amber-100",areas:[{id:"idiom",label:"Idiom",icon:If,types:["IDIOM_CONTEXT_QUIZ","IDIOM_QUIZ"]},{id:"example",label:"Example",icon:AI,types:["SENTENCE_SCRAMBLE"]}]}],pm={MEANING_QUIZ:"Select",COLLOCATION_CONTEXT_QUIZ:"Match",COLLOCATION_MULTICHOICE_QUIZ:"Multi",COLLOCATION_QUIZ:"Fill",PARAPHRASE_CONTEXT_QUIZ:"Match",PARAPHRASE_QUIZ:"Fill",PREPOSITION_QUIZ:"Fill",IDIOM_QUIZ:"Fill",IDIOM_CONTEXT_QUIZ:"Match",PRONUNCIATION:"Speak",IPA_QUIZ:"IPA",HETERONYM_QUIZ:"Match",SPELLING:"Dictation",SENTENCE_SCRAMBLE:"Build",WORD_FAMILY:"Fill"},UL=[{label:"Dictation",desc:"Listen to the word and type the exact spelling."},{label:"Speak",desc:"Pronounce the word clearly into your microphone."},{label:"IPA",desc:"Identify the correct phonetic transcription."},{label:"Select",desc:"Choose the correct meaning from options."},{label:"Fill",desc:"Type missing parts (Prepositions, Idioms, Families)."},{label:"Match",desc:"Connect related items (Collocations, Idioms, Contexts)."},{label:"Build",desc:"Reorder scrambled words to form a valid sentence."},{label:"Multi",desc:"Multiple choice for collocations."}],F1=n=>{switch(n){case"NEW":return"bg-blue-100 text-blue-700 border-blue-200";case"LEARNED":return"bg-cyan-100 text-cyan-700 border-cyan-200";case"EASY":return"bg-green-100 text-green-700 border-green-200";case"HARD":return"bg-orange-100 text-orange-700 border-orange-200";case"FORGOT":return"bg-red-100 text-red-700 border-red-200";default:return"bg-neutral-100 text-neutral-600 border-neutral-200"}},PL=({isModal:n=!0,word:e,onClose:s,isSetupMode:a,isPreparing:o,availableChallenges:l,selectedChallengeTypes:d,onSetSelection:p,onStartTest:m,challengeStats:y,challenges:x,currentChallenge:v,currentChallengeIndex:S,userAnswers:I,handleAnswerChange:z,results:U,isFinishing:C,currentPrepositionGroup:M,isLastChallenge:B,handleNextClick:F,handleBackClick:H,handleIgnore:q,handleFinishEarly:Y,showHint:A,onToggleHint:T,disableHints:E,sessionPosition:R,elapsedTime:N,onSelectQuick:D,onSelectPreferred:O,onSelectZeroScore:ve,onSelectPartialScore:ye,onRetryFailed:G,recapData:ae,onRecalculateFinish:ne,isMastered:Q})=>{const X=L.useRef(null),[j,V]=L.useState(!1),[$,Z]=L.useState(!1),[ee,pe]=L.useState(null);L.useEffect(()=>{X.current&&(X.current.scrollTop=0)},[S,e]);const ie=L.useMemo(()=>new Set(l.map(Oe=>Oe.type)),[l]),ce=(Oe,me)=>{const ue=new Set(d);Oe.forEach(ge=>ue.delete(ge)),me!=="none"&&ue.add(me),p(ue)},De=()=>B1.flatMap(Oe=>Oe.areas),fe=()=>{const Oe=new Set;De().forEach(me=>{const ue=me.types.find(ge=>ie.has(ge));ue&&Oe.add(ue)}),p(Oe)};let Se;if(ae){const Oe=Math.max(0,ae.newMastery-ae.oldMastery),me=Object.values(ae.results.reduce((ue,ge)=>{if(!ue[ge.type]){let Ee=pm[ge.type]||ge.type;const Ae=De().find(Ge=>Ge.types.includes(ge.type));Ae&&(Ee=`${Ae.label} ${pm[ge.type]||""}`),ue[ge.type]={type:ge.type,label:Ee.trim(),passed:0,total:0}}return ue[ge.type].total++,ge.passed&&ue[ge.type].passed++,ue},{}));Se=u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-500",children:[u.jsxs("div",{className:"flex-1 overflow-y-auto p-8 text-center space-y-6 custom-scrollbar",children:[u.jsx("div",{className:"inline-flex p-4 bg-green-50 rounded-full text-green-600 mb-2 shadow-inner",children:u.jsx(wr,{size:48})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:"Session Complete!"}),u.jsx("p",{className:"text-sm text-neutral-500 font-medium",children:"Here's how you improved."})]}),u.jsxs("div",{className:"bg-neutral-50 rounded-3xl p-6 border border-neutral-100 space-y-6",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between items-end px-1",children:[u.jsx("span",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Mastery Score"}),u.jsxs("span",{className:"text-sm font-black text-neutral-900 flex items-center gap-1",children:[ae.oldMastery,"%",u.jsx($c,{size:14,className:"text-neutral-300"}),u.jsxs("span",{className:"text-green-600",children:[ae.newMastery,"%"]}),Oe>0&&u.jsxs("span",{className:"text-[10px] bg-green-100 text-green-700 px-1.5 rounded-full ml-1",children:["+",Oe]})]})]}),u.jsxs("div",{className:"h-3 w-full bg-neutral-200 rounded-full overflow-hidden relative",children:[u.jsx("div",{className:"absolute top-0 left-0 h-full bg-neutral-400",style:{width:`${ae.oldMastery}%`}}),u.jsx("div",{className:"absolute top-0 h-full bg-green-500 animate-pulse",style:{left:`${ae.oldMastery}%`,width:`${Oe}%`}})]})]}),u.jsxs("div",{className:"flex items-center justify-center gap-3",children:[u.jsx("span",{className:`px-3 py-1 rounded-xl text-xs font-black uppercase border ${F1(ae.oldStatus)}`,children:ae.oldStatus}),u.jsx($c,{size:16,className:"text-neutral-300"}),u.jsx("span",{className:`px-3 py-1 rounded-xl text-xs font-black uppercase border ${F1(ae.newStatus)}`,children:ae.newStatus})]})]}),u.jsxs("div",{className:"space-y-2 text-left",children:[u.jsx("h4",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest px-2",children:"Challenge Summary"}),u.jsx("div",{className:"flex flex-col gap-2",children:me.map((ue,ge)=>{const Ee=ue.passed===ue.total,Ae=ue.passed===0;let Ge="bg-white border-neutral-100",Ue="text-neutral-700",Ke=null;return Ee?(Ge="bg-green-50 border-green-100",Ue="text-green-800",Ke=u.jsx(Cl,{size:14,className:"text-green-600"})):Ae?(Ge="bg-red-50 border-red-100",Ue="text-red-800",Ke=u.jsx(jn,{size:14,className:"text-red-600"})):(Ge="bg-orange-50 border-orange-100",Ue="text-orange-800",Ke=u.jsxs("div",{className:"text-[10px] font-black text-orange-600",children:[Math.round(ue.passed/ue.total*100),"%"]})),u.jsxs("div",{className:`flex items-center justify-between p-3 border rounded-xl shadow-sm ${Ge}`,children:[u.jsx("span",{className:`text-xs font-bold ${Ue}`,children:ue.label}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("span",{className:`text-[10px] font-black uppercase tracking-wider ${Ue}`,children:[ue.passed," / ",ue.total]}),u.jsx("div",{className:"p-1 rounded-full bg-white/50",children:Ke})]})]},ge)})})]})]}),u.jsx("div",{className:"p-6 bg-white border-t border-neutral-100 shrink-0",children:u.jsx("div",{className:"flex flex-col gap-3",children:u.jsxs("button",{onClick:ne,className:"w-full py-4 bg-neutral-900 text-white rounded-2xl font-black text-sm uppercase tracking-widest shadow-xl hover:bg-neutral-800 transition-all active:scale-95 flex items-center justify-center gap-2",children:[u.jsx("span",{children:"Continue"}),u.jsx($c,{size:18})]})})})]})}else if(a){const Oe=d.size===0,me=Array.from(y.values()).some(oe=>oe.total>0&&oe.attempted>0&&oe.score<oe.total),ue=fo(e.lastTestResults||{}),ge=Array.from(ie).some(oe=>Object.entries(ue).some(([Ve,lt])=>(Ve===oe||Ve.startsWith(`${oe}:`))&&lt===!1)),Ee=me||ge;let Ae=0,Ge=0;y.forEach(oe=>{Ae+=oe.score,Ge+=oe.total});const Ue=Ge>0?Ae/Ge*100:0,Ke=60,Nt=2*Math.PI*Ke,Pe=Nt-Ue/100*Nt;Se=u.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[2rem] shadow-2xl overflow-hidden flex flex-col max-h-[95vh] animate-in fade-in zoom-in-95 duration-300",children:[u.jsxs("div",{className:"px-6 py-4 border-b border-neutral-100 bg-white/80 backdrop-blur-sm flex justify-between items-center shrink-0 z-20 relative",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-neutral-900 text-white rounded-xl flex items-center justify-center shadow-lg shadow-neutral-900/20",children:u.jsx(pI,{size:20})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-black text-neutral-900 leading-none tracking-tight",children:"Test Setup"}),u.jsxs("p",{className:"text-xs font-bold text-neutral-500 mt-1",children:["Target: ",u.jsx("span",{className:"text-neutral-900",children:e.word})]})]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:"flex flex-col items-end mr-2",children:[u.jsx("span",{className:"text-[9px] font-black uppercase text-neutral-400 tracking-widest",children:"Mastery"}),u.jsxs("div",{className:"flex items-baseline gap-1",children:[u.jsx("span",{className:`text-xl font-black leading-none ${Ae===Ge&&Ge>0?"text-green-600":"text-neutral-900"}`,children:Ae}),u.jsxs("span",{className:"text-sm font-bold text-neutral-400",children:["/",Ge]})]})]}),u.jsx("button",{onClick:()=>Z(!$),className:`p-2.5 rounded-xl transition-all ${$?"bg-neutral-900 text-white shadow-md":"bg-neutral-100 text-neutral-500 hover:bg-neutral-200"}`,title:"Configure Test",children:u.jsx(TI,{size:20})}),u.jsx("button",{onClick:s,className:"p-2.5 text-neutral-400 hover:text-neutral-900 hover:bg-neutral-100 rounded-xl transition-colors",children:u.jsx(jn,{size:20})})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar relative",children:$?u.jsxs("div",{className:"flex flex-col h-full animate-in slide-in-from-top-4 duration-300",children:[u.jsxs("div",{className:"px-5 py-3 bg-neutral-50 border-b border-neutral-100 flex flex-wrap gap-2 shrink-0 z-10 justify-center",children:[u.jsxs("button",{onClick:fe,className:"px-3 py-2 rounded-lg bg-white border border-neutral-200 text-neutral-600 font-bold text-[10px] uppercase tracking-wider hover:bg-neutral-50 transition-colors flex items-center gap-1.5 shadow-sm",children:[u.jsx(GE,{size:12})," All"]}),u.jsxs("button",{onClick:()=>p(new Set),className:"px-3 py-2 rounded-lg bg-white border border-neutral-200 text-neutral-400 font-bold text-[10px] uppercase tracking-wider hover:bg-neutral-50 hover:text-neutral-600 transition-colors flex items-center gap-1.5 shadow-sm",children:[u.jsx(lI,{size:12})," Clear"]}),u.jsxs("button",{onClick:()=>V(!j),className:"px-3 py-2 rounded-lg bg-white border border-neutral-200 text-neutral-500 font-bold text-[10px] uppercase tracking-wider hover:bg-neutral-50 hover:text-indigo-500 transition-colors flex items-center gap-1.5 shadow-sm ml-auto",children:[u.jsx(nI,{size:12})," Guide"]})]}),j&&u.jsx("div",{className:"bg-neutral-50 border-b border-neutral-100 p-4 grid grid-cols-2 gap-2 animate-in fade-in slide-in-from-top-2",children:UL.map(oe=>u.jsxs("div",{className:"text-[10px] text-neutral-500 leading-tight",children:[u.jsxs("span",{className:"font-black text-indigo-600 uppercase mr-1",children:[oe.label,":"]}),oe.desc]},oe.label))}),u.jsx("div",{className:"p-4 space-y-3",children:B1.map(oe=>{const Ve=oe.areas.filter(nt=>nt.types.some(pt=>ie.has(pt)));if(Ve.length===0)return null;let lt=0,ct=0;return Ve.forEach(nt=>{nt.types.forEach(pt=>{const qt=y.get(pt);qt&&(lt+=qt.score,ct+=qt.total)})}),u.jsxs("div",{className:`rounded-2xl border ${oe.border} ${oe.bg} p-4`,children:[u.jsxs("div",{className:"flex items-baseline justify-between mb-3 border-b border-black/5 pb-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h4",{className:`text-xs font-black uppercase tracking-widest ${oe.color}`,children:oe.title}),u.jsxs("span",{className:"text-[10px] font-bold text-neutral-500 opacity-60 bg-white/50 px-1.5 py-0.5 rounded-md",children:["(",lt,"/",ct,")"]})]}),u.jsx("span",{className:"text-[10px] font-bold text-neutral-500 opacity-60",children:oe.description})]}),u.jsx("div",{className:"space-y-2",children:Ve.map(nt=>{const pt=nt.types.filter(Me=>ie.has(Me));if(pt.length===0)return null;const qt=nt.types.find(Me=>d.has(Me));let Pt=0,Os=0,kn=0,Zt=0;nt.types.forEach(Me=>{const st=y.get(Me);st&&(Pt+=st.score,Os+=st.total,kn+=st.attempted,st.attempted>0&&(Zt+=st.total))});const be=kn>0&&Pt===0,Le=kn>0?Zt:Os,Ne=Le>0&&Pt===Le,yt=Pt>0&&Pt<Le,rt=kn===0;return u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 p-2 rounded-xl bg-white/40 hover:bg-white/70 transition-colors border border-transparent hover:border-black/5",children:[u.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[u.jsx("div",{className:"p-1.5 bg-white rounded-lg shadow-sm text-neutral-600",children:u.jsx(nt.icon,{size:14})}),u.jsx("span",{className:`text-xs font-bold ${be?"text-red-600":Ne?"text-green-700":yt?"text-yellow-700":rt||qt?"text-neutral-900":"text-neutral-600"}`,children:nt.label})]}),u.jsx("div",{className:"flex flex-wrap gap-1.5 justify-end",children:pt.map(Me=>{const st=qt===Me;return u.jsx("button",{onClick:()=>ce(nt.types,st?"none":Me),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold border transition-all ${st?"bg-neutral-900 border-neutral-900 text-white shadow-md transform scale-105":"bg-white border-neutral-200 text-neutral-500 hover:border-neutral-300 hover:text-neutral-700"}`,children:pm[Me]||"Quiz"},Me)})})]},nt.id)})})]},oe.id)})})]}):u.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 space-y-8 animate-in zoom-in-95 duration-500",children:[u.jsxs("div",{className:"relative w-48 h-48 flex items-center justify-center",children:[u.jsxs("svg",{className:"absolute w-full h-full transform -rotate-90",children:[u.jsx("circle",{cx:"50%",cy:"50%",r:Ke,stroke:"currentColor",strokeWidth:"12",fill:"transparent",className:"text-neutral-100"}),u.jsx("circle",{cx:"50%",cy:"50%",r:Ke,stroke:"currentColor",strokeWidth:"12",fill:"transparent",strokeDasharray:Nt,strokeDashoffset:Pe,strokeLinecap:"round",className:`transition-all duration-1000 ease-out ${Ue===100?"text-green-500":Ue>=50?"text-yellow-500":"text-red-500"}`})]}),u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsxs("span",{className:"text-4xl font-black text-neutral-900 tracking-tighter",children:[Ue.toFixed(0),"%"]}),u.jsx("span",{className:"text-xs font-bold text-neutral-400 uppercase tracking-widest mt-1",children:"Mastery"})]})]}),u.jsx("p",{className:"text-center text-sm font-medium text-neutral-500 max-w-xs leading-relaxed transition-all duration-200 min-h-[48px] flex items-center justify-center",children:ee||(Ae===Ge?"Incredible! You have mastered all challenges for this word. Keep practicing to maintain it.":"Ready to improve? Choose a quick mix or focus on what you haven't mastered yet.")})]})}),u.jsx("div",{className:"px-6 py-5 bg-white border-t border-neutral-100 flex items-center justify-center shrink-0 z-20 gap-4",children:$?u.jsxs("button",{onClick:m,disabled:Oe||o,className:"w-full py-4 bg-neutral-900 text-white rounded-2xl font-black text-sm uppercase tracking-widest flex items-center justify-center gap-3 shadow-xl hover:bg-neutral-800 transition-all active:scale-95 disabled:opacity-50 disabled:active:scale-100 hover:shadow-2xl shadow-neutral-900/20",children:[o?u.jsx(mn,{size:18,className:"animate-spin"}):u.jsx(hu,{size:18,fill:"currentColor"}),u.jsx("span",{children:o?"Preparing...":"Start Custom Test"})]}):u.jsxs(u.Fragment,{children:[Ee&&u.jsxs("button",{onMouseEnter:()=>pe("Retry only the tests you failed."),onMouseLeave:()=>pe(null),onClick:G,className:"flex-1 py-4 bg-red-600 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-red-700 transition-all active:scale-95 shadow-lg shadow-red-200",children:[u.jsx($E,{size:18}),u.jsx("span",{children:"Retry Failed"})]}),Q?u.jsxs("button",{onMouseEnter:()=>pe("Hard mode: focus on advanced usage and tougher variations."),onMouseLeave:()=>pe(null),onClick:ye,className:"flex-1 py-4 bg-rose-600 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-rose-700 transition-all active:scale-95 shadow-lg shadow-rose-200",children:[u.jsx(NI,{size:18}),u.jsx("span",{children:"Challenge"})]}):u.jsxs("button",{onMouseEnter:()=>pe("Complete all unpassed tests including failed and untouched ones."),onMouseLeave:()=>pe(null),onClick:ve,className:"flex-1 py-4 bg-indigo-600 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-indigo-700 transition-all active:scale-95 shadow-lg shadow-indigo-200",children:[u.jsx(BE,{size:18}),u.jsx("span",{children:"Master It"})]}),u.jsxs("button",{onMouseEnter:()=>pe("Core usage only. Fast mixed review."),onMouseLeave:()=>pe(null),onClick:D,className:"flex-1 py-4 bg-cyan-500 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-cyan-600 transition-all active:scale-95 shadow-lg shadow-cyan-200",children:[u.jsx(K2,{size:18}),u.jsx("span",{children:"Quick Test"})]})]})})]})}else{let Oe;R&&(R.current<R.total?Oe="Next Item":Oe="Finalize"),Se=u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[90vh] h-full",children:[u.jsx(AL,{title:v.title,type:v.type,currentStep:R?R.current:S+1,totalSteps:R?R.total:x.length,onClose:s,onFinish:Y,label:R?"Item":"Challenge",isQuickFire:!!R,elapsedTime:N}),u.jsx("div",{ref:X,className:"flex-1 p-8 overflow-y-auto no-scrollbar",children:u.jsx(kL,{word:e,currentChallenge:v,currentChallengeIndex:S,userAnswers:I,handleAnswerChange:z,results:U,isFinishing:C,currentPrepositionGroup:M,showHint:A,onEnterPress:F})}),u.jsx(LL,{onBack:H,onNext:F,onIgnore:q,onHint:T,showHint:A,isBackDisabled:R?R.current===1&&S===0:S===0,isNextDisabled:C,isLastChallenge:B,nextLabel:Oe,disableHints:E})]})}return n?u.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:Se}):Se},oo=n=>[...n].sort(()=>Math.random()-.5),VL=n=>n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),rs=n=>n.replace(/[^a-zA-Z0-9]/g,"").toLowerCase();function zL(n){const e=[];if(e.push({type:"SPELLING",title:"Spelling Fill",word:n}),e.push({type:"PRONUNCIATION",title:"Speak Out",word:n}),n.meaningVi&&n.meaningVi.length>0&&e.push({type:"MEANING_QUIZ",title:"Meaning Multi Choice",options:[],answer:n.meaningVi,word:n}),n.ipaMistakes&&n.ipaMistakes.length>0&&n.ipaUs&&e.push({type:"IPA_QUIZ",title:"IPA Multi Choice",options:oo([n.ipaUs,...n.ipaMistakes]),answer:n.ipaUs,word:n}),n.collocationsArray&&n.collocationsArray.length>0){const s=n.collocationsArray.filter(a=>!a.isIgnored&&a.d);s.forEach(a=>{e.push({type:"COLLOCATION_QUIZ",title:"Collocation Fill",word:n,fullText:a.text,cue:a.d,answer:a.text}),s.length>=4&&e.push({type:"COLLOCATION_MULTICHOICE_QUIZ",title:"Collocation Multi Choice",word:n,fullText:a.text,cue:a.d,answer:a.text,options:[]})}),s.length>=2&&e.push({type:"COLLOCATION_CONTEXT_QUIZ",title:"Collocation Match",word:n,contexts:[],collocations:[]})}if(n.idiomsList&&n.idiomsList.length>0){const s=n.idiomsList.filter(a=>!a.isIgnored&&a.d);s.forEach(a=>{e.push({type:"IDIOM_QUIZ",title:"Idiom Fill",word:n,fullText:a.text,cue:a.d,answer:a.text})}),s.length>=2&&e.push({type:"IDIOM_CONTEXT_QUIZ",title:"Idiom Match",word:n,contexts:[],idioms:[]})}if(n.prepositions&&n.prepositions.length>0&&n.prepositions.filter(a=>!a.isIgnored).forEach(a=>{let o="";const l=n.word,d=a.prep,p=a.usage;if(p&&p.toLowerCase().includes(l.toLowerCase())){const m=new RegExp(`\\b${VL(d)}\\b`,"i");m.test(p)?o=p.replace(m,"___"):o=`${p} [___]`}else p?o=`${l} ___ ${p}`:o=`${l} ___`;e.push({type:"PREPOSITION_QUIZ",title:"Preposition Fill",example:o,answer:d,word:n})}),n.example&&n.example.trim().length>5){const s=n.example.trim().split(`
`).flatMap(a=>a.split(new RegExp("(?<=[.?!])\\s+"))).map(a=>a.trim()).filter(a=>a.length>5);for(const a of s){const o=a.split(/\s+/).filter(Boolean);if(o.length>=3){let d;if(o.length>10){d=[];let p=0;for(;p<o.length;){const m=Math.min(3,o.length-p);let y=1;m>1&&Math.random()<.5&&(m===2?y=2:y=Math.random()<.5?2:3);const x=o.slice(p,p+y).join(" ");d.push(x),p+=y}}else d=o;e.push({type:"SENTENCE_SCRAMBLE",title:"Sentence Builder",original:a.trim(),shuffled:oo(d),word:n})}}}return n.wordFamily&&[...n.wordFamily.nouns||[],...n.wordFamily.verbs||[],...n.wordFamily.adjs||[],...n.wordFamily.advs||[]].filter(l=>!l.isIgnored&&l.word.trim()).some(l=>l.word.toLowerCase().trim()!==n.word.toLowerCase().trim())&&e.push({type:"WORD_FAMILY",title:"Word Family Fill",word:n}),n.paraphrases&&n.paraphrases.length>0&&n.paraphrases.filter(s=>!s.isIgnored).forEach(s=>{e.push({type:"PARAPHRASE_QUIZ",title:"Paraphrase Fill",tone:s.tone,context:s.context,answer:s.word,word:n})}),n.paraphrases&&n.paraphrases.filter(s=>!s.isIgnored&&s.context&&s.context.trim()).length>=2&&e.push({type:"PARAPHRASE_CONTEXT_QUIZ",title:"Paraphrase Match",word:n,contexts:[],paraphrases:[]}),e}async function H1(n,e){const s=[];for(const a of n)if(a.type==="MEANING_QUIZ"){const l=(await tw(3,e.id)).filter(p=>p.trim().toLowerCase()!==e.meaningVi.trim().toLowerCase()),d=oo([e.meaningVi,...l]).slice(0,4);s.push({...a,options:d})}else if(a.type==="COLLOCATION_MULTICHOICE_QUIZ"){const l=(e.collocationsArray||[]).filter(p=>!p.isIgnored&&p.text!==a.answer).map(p=>p.text),d=oo([a.answer,...l]).slice(0,4);s.push({...a,options:d})}else if(a.type==="PARAPHRASE_CONTEXT_QUIZ"){const o=a.word,l=(o.paraphrases||[]).filter(d=>!d.isIgnored&&d.context&&d.context.trim()).sort(()=>Math.random()-.5).slice(0,5);if(l.length>=2){const d=[],p=[];l.forEach((m,y)=>{const x=`${o.id}-${y}`;d.push({id:`context-${x}`,text:m.context,pairId:x,tone:m.tone}),p.push({id:`word-${x}`,text:m.word,pairId:x})}),s.push({...a,contexts:d,paraphrases:oo(p)})}}else if(a.type==="COLLOCATION_CONTEXT_QUIZ"){const o=a.word,l=(o.collocationsArray||[]).filter(d=>!d.isIgnored&&d.d&&d.d.trim()).sort(()=>Math.random()-.5).slice(0,5);if(l.length>=2){const d=[],p=[];l.forEach((m,y)=>{const x=`${o.id}-col-${y}`;d.push({id:`context-${x}`,text:m.d,pairId:x}),p.push({id:`col-${x}`,text:m.text,pairId:x})}),s.push({...a,contexts:d,collocations:oo(p)})}}else if(a.type==="IDIOM_CONTEXT_QUIZ"){const o=a.word,l=(o.idiomsList||[]).filter(d=>!d.isIgnored&&d.d&&d.d.trim()).sort(()=>Math.random()-.5).slice(0,5);if(l.length>=2){const d=[],p=[];l.forEach((m,y)=>{const x=`${o.id}-idm-${y}`;d.push({id:`context-${x}`,text:m.d,pairId:x}),p.push({id:`idm-${x}`,text:m.text,pairId:x})}),s.push({...a,contexts:d,idioms:oo(p)})}}else s.push(a);return s}function BL(n,e){switch(n.type){case"SPELLING":return rs(e||"")===rs(n.word.word);case"IPA_QUIZ":return e===n.answer;case"PREPOSITION_QUIZ":return rs(e||"")===rs(n.answer);case"MEANING_QUIZ":return e===n.answer;case"PARAPHRASE_QUIZ":return rs(e||"")===rs(n.answer);case"COLLOCATION_QUIZ":return rs(e||"")===rs(n.answer);case"COLLOCATION_MULTICHOICE_QUIZ":return e===n.answer;case"IDIOM_QUIZ":return rs(e||"")===rs(n.answer);case"SENTENCE_SCRAMBLE":const s=(e||[]).join(" ");return rs(s)===rs(n.original);case"PRONUNCIATION":return rs(e||"")===rs(n.word.word);case"HETERONYM_QUIZ":{if(!e)return!1;let a=!0;for(const o of n.forms)if(e[o.pos]!==o.ipa){a=!1;break}return a}case"WORD_FAMILY":{const a={};let o=!0,l=!1;const d={nouns:"n",verbs:"v",adjs:"j",advs:"d"};return["nouns","verbs","adjs","advs"].forEach(p=>{var y;const m=(((y=n.word.wordFamily)==null?void 0:y[p])||[]).filter(x=>!x.isIgnored).map(x=>x.word);if(m.length>0){l=!0;const v=((e==null?void 0:e[p])||"").split(",").filter(Boolean).map(I=>rs(I)),S=d[p];m.forEach(I=>{const z=rs(I),U=v.findIndex(M=>M===z),C=U!==-1;a[`${S}:${I}`]=C,C?v.splice(U,1):o=!1}),v.length>0&&(o=!1)}}),l?{correct:o,details:a}:!0}case"PARAPHRASE_CONTEXT_QUIZ":{const a=n;if(!(e instanceof Map)||e.size===0)return{correct:!1,details:{}};const o={};let l=0;return a.contexts.forEach(d=>{const p=e.get(d.id);if(p){const m=a.paraphrases.find(y=>y.id===p);m&&m.pairId===d.pairId?(o[d.id]=!0,l++):o[d.id]=!1}else o[d.id]=!1}),{correct:l===a.contexts.length,details:o}}case"COLLOCATION_CONTEXT_QUIZ":{const a=n;if(!(e instanceof Map)||e.size===0)return{correct:!1,details:{}};const o={};let l=0;return a.contexts.forEach(d=>{const p=e.get(d.id);if(p){const m=a.collocations.find(y=>y.id===p);m&&m.pairId===d.pairId?(o[d.id]=!0,l++):o[d.id]=!1}else o[d.id]=!1}),{correct:l===a.contexts.length,details:o}}case"IDIOM_CONTEXT_QUIZ":{const a=n;if(!(e instanceof Map)||e.size===0)return{correct:!1,details:{}};const o={};let l=0;return a.contexts.forEach(d=>{const p=e.get(d.id);if(p){const m=a.idioms.find(y=>y.id===p);m&&m.pairId===d.pairId?(o[d.id]=!0,l++):o[d.id]=!1}else o[d.id]=!1}),{correct:l===a.contexts.length,details:o}}default:return!1}}const FL=()=>{const[n,e]=L.useState([]),[s,a]=L.useState(0),[o,l]=L.useState([]),[d,p]=L.useState(null),[m,y]=L.useState(!1),[x,v]=L.useState(new Set),[S,I]=L.useState(0),[z,U]=L.useState(!1);L.useEffect(()=>{let R;return z&&!m&&(R=window.setInterval(()=>{I(N=>N+1)},1e3)),()=>clearInterval(R)},[z,m]);const C=R=>{e(R),l(new Array(R.length).fill(void 0)),a(0),p(null),y(!1),v(new Set),I(0),U(!0)},M=(R,N)=>{l(D=>{const O=[...D];return O[R]=N,O})},B=n[s],F=L.useMemo(()=>{if((B==null?void 0:B.type)!=="PREPOSITION_QUIZ")return null;const R=[];let N=s;for(;N>0&&n[N-1].type==="PREPOSITION_QUIZ";)N--;for(let D=N;D<n.length&&n[D].type==="PREPOSITION_QUIZ";D++)R.push({challenge:n[D],index:D});return R.length===0?null:{startIndex:N,group:R}},[B,s,n]),H=L.useMemo(()=>F?F.startIndex+F.group.length>=n.length:s>=n.length-1,[s,n,F]),q=()=>{H||a(F?F.startIndex+F.group.length:R=>R+1)},Y=()=>{const R=F?F.startIndex-1:s-1;R>=0&&a(R)},A=()=>{v(R=>{const N=new Set(R);return F?F.group.forEach(D=>N.add(D.index)):N.add(s),N}),q()},T=()=>{const R=[];let N=0,D=0;const O={},ve=[];n.forEach((G,ae)=>{if(x.has(ae)){R[ae]=null;return}D++;const ne=BL(G,o[ae]);R[ae]=ne;const Q=typeof ne=="boolean"?ne:ne.correct;if(Q&&N++,ve.push({type:G.type,passed:Q}),G.type==="WORD_FAMILY"&&typeof ne=="object"&&"details"in ne)Object.entries(ne.details).forEach(([X,j])=>{O[`WORD_FAMILY:${X}`]=j});else if(G.type==="COLLOCATION_QUIZ")O[`COLLOCATION_QUIZ:${G.fullText}`]=Q;else if(G.type==="COLLOCATION_MULTICHOICE_QUIZ")O[`COLLOCATION_MULTICHOICE_QUIZ:${G.fullText}`]=Q;else if(G.type==="IDIOM_QUIZ")O[`IDIOM_QUIZ:${G.fullText}`]=Q;else if(G.type==="PARAPHRASE_QUIZ")O[`PARAPHRASE_QUIZ:${G.answer}`]=Q;else if(G.type==="PREPOSITION_QUIZ")O[`PREPOSITION_QUIZ:${G.answer}`]=Q;else if(G.type==="PARAPHRASE_CONTEXT_QUIZ"){const X=G;typeof ne=="object"&&ne.details&&X.paraphrases.forEach(j=>{const V=X.contexts.find($=>$.pairId===j.pairId);V&&(O[`PARAPHRASE_CONTEXT_QUIZ:${j.text}`]=!!ne.details[V.id])}),O[G.type]=Q}else if(G.type==="COLLOCATION_CONTEXT_QUIZ"){const X=G;typeof ne=="object"&&ne.details&&X.collocations.forEach(j=>{const V=X.contexts.find($=>$.pairId===j.pairId);V&&(O[`COLLOCATION_CONTEXT_QUIZ:${j.text}`]=!!ne.details[V.id])}),O[G.type]=Q}else if(G.type==="IDIOM_CONTEXT_QUIZ"){const X=G;typeof ne=="object"&&ne.details&&X.idioms.forEach(j=>{const V=X.contexts.find($=>$.pairId===j.pairId);V&&(O[`IDIOM_CONTEXT_QUIZ:${j.text}`]=!!ne.details[V.id])}),O[G.type]=Q}else O[G.type]=Q});let ye=Ut.HARD;return D>0&&(N===D?ye=D>1?Ut.EASY:Ut.HARD:N<D/2&&(ye=Ut.FORGOT)),{finalGrade:ye,resultHistory:O,detailedResults:ve,counts:{correct:N,tested:D},newResults:R}};return{challenges:n,currentChallengeIndex:s,currentChallenge:B,userAnswers:o,results:d,isFinishing:m,elapsedSeconds:S,currentPrepositionGroup:F,isLastChallenge:H,startTest:C,setAnswer:M,handleNext:q,handleBack:Y,handleIgnore:A,checkAnswers:T,finishTest:()=>{U(!1),y(!0);const{newResults:R}=T();p(R)}}},HL={SPELLING:"sp",IPA_QUIZ:"iq",PREPOSITION_QUIZ:"pq",WORD_FAMILY:"wf",MEANING_QUIZ:"mq",PARAPHRASE_QUIZ:"prq",SENTENCE_SCRAMBLE:"sc",HETERONYM_QUIZ:"hq",PRONUNCIATION:"p",COLLOCATION_QUIZ:"cq",IDIOM_QUIZ:"idq",PARAPHRASE_CONTEXT_QUIZ:"pcq",COLLOCATION_CONTEXT_QUIZ:"ccq",COLLOCATION_MULTICHOICE_QUIZ:"cmq",IDIOM_CONTEXT_QUIZ:"icq"},GL=["PARAPHRASE_CONTEXT_QUIZ","COLLOCATION_CONTEXT_QUIZ","IDIOM_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ","HETERONYM_QUIZ"],xi={collocation:{easy:["COLLOCATION_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ","COLLOCATION_QUIZ"],hard:["COLLOCATION_QUIZ","COLLOCATION_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ"]},paraphrase:{easy:["PARAPHRASE_CONTEXT_QUIZ","PARAPHRASE_QUIZ"],hard:["PARAPHRASE_QUIZ","PARAPHRASE_CONTEXT_QUIZ"]},idiom:{easy:["IDIOM_CONTEXT_QUIZ","IDIOM_QUIZ"],hard:["IDIOM_QUIZ","IDIOM_CONTEXT_QUIZ"]}},qL=new Set([...xi.collocation.easy,...xi.paraphrase.easy,...xi.idiom.easy]),$d=(n,e)=>{const s=new Set;return Object.keys(xi).forEach(a=>{const o=xi[a][e];for(const l of o){const d=l;if(n.has(d)){s.add(d);break}}}),n.forEach(a=>{qL.has(a)||s.add(a)}),s},$L=({word:n,onClose:e,onComplete:s,isQuickFire:a=!1,isModal:o=!0,sessionPosition:l,onPrevWord:d,disableHints:p=!1,forceShowHint:m=!1,skipSetup:y=!1,challengeFilter:x,skipRecap:v=!1})=>{const[S,I]=L.useState(!a&&!y),[z,U]=L.useState(new Set),[C,M]=L.useState(!1),[B,F]=L.useState(!1),[H,q]=L.useState(m),[Y,A]=L.useState(null),T=FL();L.useEffect(()=>{q(m)},[T.currentChallengeIndex,m]);const E=L.useMemo(()=>{try{return zL(n)}catch(V){return console.error("[TestModal] Error generating challenges:",V),[]}},[n]),R=L.useMemo(()=>{const V=n.lastTestResults||{},$=new Map,Z=Array.from(new Set(E.map(pe=>pe.type))),ee=(pe,ie)=>{if(V[pe]!==void 0)return V[pe];const ce=HL[ie];if(ce){const De=pe.startsWith(ie)?pe.substring(ie.length):"",fe=ce+De;return V[fe]}};return Z.forEach(pe=>{const ie=E.filter(fe=>fe.type===pe);if(pe==="WORD_FAMILY"){const fe=["nouns","verbs","adjs","advs"],Se={nouns:"n",verbs:"v",adjs:"j",advs:"d"};let Oe=0;const me=fe.flatMap(ge=>{var Ee;return(((Ee=n.wordFamily)==null?void 0:Ee[ge])||[]).map(Ae=>({...Ae,typeKey:ge}))}).filter(ge=>!ge.isIgnored&&ge.word);me.length>0&&me.forEach(ge=>{const Ee=Se[ge.typeKey];(V[`WORD_FAMILY:${Ee}:${ge.word}`]??V[`wf:${Ee}:${ge.word}`]??V[`WORD_FAMILY_${ge.typeKey.toUpperCase()}`])===!0&&Oe++});const ue=me.reduce((ge,Ee)=>{const Ae=Se[Ee.typeKey],Ge=`WORD_FAMILY:${Ae}:${Ee.word}`,Ue=`wf:${Ae}:${Ee.word}`,Ke=`WORD_FAMILY_${Ee.typeKey.toUpperCase()}`;return V[Ge]!==void 0||V[Ue]!==void 0||V[Ke]!==void 0||V.WORD_FAMILY!==void 0?ge+1:ge},0);$.set(pe,{score:Oe,total:me.length,attempted:ue});return}if(pe==="SENTENCE_SCRAMBLE"){const fe=Object.keys(V).some(Se=>(Se.startsWith("SENTENCE_SCRAMBLE")||Se.startsWith("sc"))&&V[Se]===!0);$.set(pe,{score:fe?1:0,total:1,attempted:Object.keys(V).some(Se=>Se.startsWith("SENTENCE_SCRAMBLE")||Se.startsWith("sc"))?1:0});return}let ce=0,De=0;ie.forEach(fe=>{let Se=!1,Oe="";fe.type==="COLLOCATION_QUIZ"?Oe=`COLLOCATION_QUIZ:${fe.fullText}`:fe.type==="COLLOCATION_MULTICHOICE_QUIZ"?Oe=`COLLOCATION_MULTICHOICE_QUIZ:${fe.fullText}`:fe.type==="IDIOM_QUIZ"?Oe=`IDIOM_QUIZ:${fe.fullText}`:fe.type==="PREPOSITION_QUIZ"?Oe=`PREPOSITION_QUIZ:${fe.answer}`:fe.type==="PARAPHRASE_QUIZ"?Oe=`PARAPHRASE_QUIZ:${fe.answer}`:fe.type==="PARAPHRASE_CONTEXT_QUIZ"?Oe="PARAPHRASE_CONTEXT_QUIZ":fe.type==="COLLOCATION_CONTEXT_QUIZ"?Oe="COLLOCATION_CONTEXT_QUIZ":fe.type==="IDIOM_CONTEXT_QUIZ"?Oe="IDIOM_CONTEXT_QUIZ":Oe=fe.type;const me=ee(Oe,pe);if(me===!0&&(Se=!0),!Se){if(fe.type==="PARAPHRASE_QUIZ"){const ge=fe.answer;V[`PARAPHRASE_CONTEXT_QUIZ:${ge}`]===!0&&(Se=!0)}else if(fe.type==="COLLOCATION_QUIZ"){const ge=fe.fullText;V[`COLLOCATION_CONTEXT_QUIZ:${ge}`]===!0&&(Se=!0),ee(`COLLOCATION_MULTICHOICE_QUIZ:${ge}`,"COLLOCATION_MULTICHOICE_QUIZ")===!0&&(Se=!0)}else if(fe.type==="IDIOM_QUIZ"){const ge=fe.fullText;V[`IDIOM_CONTEXT_QUIZ:${ge}`]===!0&&(Se=!0)}}(me!==void 0||fe.type==="PARAPHRASE_QUIZ"&&V[`PARAPHRASE_CONTEXT_QUIZ:${fe.answer}`]!==void 0||fe.type==="COLLOCATION_QUIZ"&&(V[`COLLOCATION_CONTEXT_QUIZ:${fe.fullText}`]!==void 0||ee(`COLLOCATION_MULTICHOICE_QUIZ:${fe.fullText}`,"COLLOCATION_MULTICHOICE_QUIZ")!==void 0)||fe.type==="IDIOM_QUIZ"&&V[`IDIOM_CONTEXT_QUIZ:${fe.fullText}`]!==void 0)&&De++,Se&&ce++}),$.set(pe,{score:ce,total:ie.length,attempted:De})}),$},[n,E]);L.useEffect(()=>{if(a&&!C&&T.challenges.length===0){if(E.length===0){setTimeout(e,100);return}(async()=>{M(!0);let $=E;x&&($=E.filter(x)),$.length===0&&($=E.filter(ee=>ee.type!=="SPELLING")),$.length===0&&($=E);const Z=$[Math.floor(Math.random()*$.length)];if(!Z){M(!1),setTimeout(e,500);return}try{const ee=await H1([Z],n);ee.length>0?(T.startTest(ee),I(!1)):setTimeout(e,500)}catch{setTimeout(e,500)}finally{M(!1)}})()}},[a,E,n,x]),L.useEffect(()=>{y&&!a&&E.length>0&&T.challenges.length===0&&!C&&O()},[y,a,E.length,T.challenges.length,C]),L.useEffect(()=>{if(a||E.length===0)return;const V=Object.keys(n.lastTestResults||{}).length>0,$=new Set;!V&&!y?(F(!1),E.forEach(Z=>$.add(Z.type))):(F(!0),["MEANING_QUIZ","PREPOSITION_QUIZ","COLLOCATION_CONTEXT_QUIZ"].forEach(Z=>{E.some(ee=>ee.type===Z)&&$.add(Z)})),U($)},[E,n,a,y]);const N=V=>{F(!1),U($=>{const Z=new Set($);return Z.has(V)?Z.delete(V):Z.add(V),Z})},D=async V=>{const $=V||z;let Z=E.filter(ie=>$.has(ie.type));if($.has("SENTENCE_SCRAMBLE")){const ie=Z.filter(ce=>ce.type==="SENTENCE_SCRAMBLE");if(ie.length>1){const ce=ie[Math.floor(Math.random()*ie.length)];Z=Z.filter(De=>De.type!=="SENTENCE_SCRAMBLE"),Z.push(ce)}}if(Z.length===0)return;M(!0);const pe=(await H1(Z,n)).sort(()=>Math.random()-.5);T.startTest(pe),M(!1),I(!1)},O=async()=>{const V=new Set(E.map(ee=>ee.type)),$=new Set;V.has("MEANING_QUIZ")&&$.add("MEANING_QUIZ");for(const ee of xi.collocation.easy)if(V.has(ee)){$.add(ee);break}for(const ee of xi.paraphrase.easy)if(V.has(ee)){$.add(ee);break}V.has("PREPOSITION_QUIZ")&&$.add("PREPOSITION_QUIZ");const Z=[];V.has("IPA_QUIZ")&&Z.push("IPA_QUIZ"),V.has("WORD_FAMILY")&&Z.push("WORD_FAMILY");for(const ee of xi.idiom.easy)if(V.has(ee)){Z.push(ee);break}if(Z.length>0){const ee=Z[Math.floor(Math.random()*Z.length)];$.add(ee)}if($.size===0){const ee=$d(V,"easy");if(ee.size>0){F(!0),D(ee);return}return}F(!0),D($)},ve=()=>{const V=new Set,$=Of(n),Z=n.lastTestResults||{},ee=$.filter(ie=>!ie.testKeys.some(ce=>Z[ce]===!0));if(ee.length===0){if(R.forEach((ce,De)=>{ce.score<ce.total&&V.add(De)}),V.size===0)return;const ie=$d(V,"easy");D(ie);return}E.forEach(ie=>{let ce=[];ie.type==="COLLOCATION_QUIZ"?ce.push(`COLLOCATION_QUIZ:${ie.fullText}`):ie.type==="COLLOCATION_MULTICHOICE_QUIZ"?ce.push(`COLLOCATION_MULTICHOICE_QUIZ:${ie.fullText}`):ie.type==="COLLOCATION_CONTEXT_QUIZ"||(ie.type==="PARAPHRASE_QUIZ"?ce.push(`PARAPHRASE_QUIZ:${ie.answer}`):ie.type==="PREPOSITION_QUIZ"?ce.push(`PREPOSITION_QUIZ:${ie.answer}`):ie.type==="SPELLING"?ce.push("SPELLING"):ie.type==="PRONUNCIATION"?ce.push("PRONUNCIATION"):ie.type==="MEANING_QUIZ"?ce.push("MEANING_QUIZ"):ie.type==="IPA_QUIZ"?ce.push("IPA_QUIZ"):ie.type==="WORD_FAMILY"?ce.push("WORD_FAMILY"):ie.type==="SENTENCE_SCRAMBLE"&&ce.push("SENTENCE_SCRAMBLE")),ce.some(fe=>ee.some(Se=>Se.testKeys.includes(fe)||Se.testKeys.some(Oe=>Oe.startsWith("WORD_FAMILY")&&fe==="WORD_FAMILY")))&&V.add(ie.type),ie.type==="COLLOCATION_CONTEXT_QUIZ"&&ee.filter(Se=>Se.key.startsWith("colloc:")).length>0&&V.add(ie.type),ie.type==="PARAPHRASE_CONTEXT_QUIZ"&&ee.filter(Se=>Se.key.startsWith("para:")).length>0&&V.add(ie.type),ie.type==="IDIOM_CONTEXT_QUIZ"&&ee.filter(Se=>Se.key.startsWith("idiom:")).length>0&&V.add(ie.type)}),V.size===0&&R.forEach((ie,ce)=>{ie.score<ie.total&&V.add(ce)});const pe=$d(V,"easy");F(!1),D(pe)},ye=()=>{const V=n.lastTestResults||{};if(!V)return;const $=new Set;Object.entries(V).forEach(([Z,ee])=>{if(ee===!1){const pe=Z.split(":")[0];$.add(pe)}}),$.size!==0&&(console.log("Retry Failed - failedTypes:",$),F(!1),D($))},G=async()=>{const V=new Set(E.map(Z=>Z.type)),$=$d(V,"hard");$.size!==0&&(F(!1),D($))},ae=(V=!1)=>{const{finalGrade:$,resultHistory:Z,detailedResults:ee,counts:pe}=T.checkAnswers();if(T.finishTest(),console.log("Before"+n.lastTestResults),v||a)setTimeout(()=>s($,Z,V,pe),1e3);else{const ie=n.masteryScore||0,ce=n.lastReview&&n.lastGrade||"NEW",De={...n,lastTestResults:jT(n.lastTestResults,Z)},fe=Rs(De);A({oldMastery:ie,newMastery:fe,oldStatus:ce,newStatus:$,results:ee,finalGrade:$,resultHistory:Z,counts:pe})}},ne=()=>{T.isLastChallenge?ae(!1):T.handleNext()},Q=V=>{const $=Math.floor(V/60),Z=V%60;return`${$}:${Z.toString().padStart(2,"0")}`},X=L.useMemo(()=>{const V=new Map;return R.forEach(($,Z)=>{GL.includes(Z)||V.set(Z,$)}),V},[R]),j=L.useMemo(()=>Rs(n)===100,[n]);if(!S&&!C&&!T.currentChallenge)return o?u.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:u.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-xl text-center space-y-4",children:[u.jsx("p",{className:"text-red-500 font-bold",children:"Failed to load challenge."}),u.jsx("button",{onClick:e,className:"px-4 py-2 bg-neutral-100 rounded-lg text-sm font-bold",children:"Close"})]})}):u.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center space-y-4",children:[u.jsx(mn,{className:"animate-spin text-neutral-400",size:32}),u.jsx("p",{className:"text-red-500 font-bold",children:"Error loading."}),u.jsx("button",{onClick:e,className:"text-xs underline text-neutral-500",children:"Return"})]});if((a||y)&&(C||!T.currentChallenge)){const V=u.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center p-8 text-center space-y-4",children:[u.jsx(mn,{className:"animate-spin text-neutral-400",size:32}),u.jsx("p",{className:"text-xs font-black text-neutral-500 uppercase tracking-widest",children:"Preparing..."})]});return o?u.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:u.jsx("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col h-[500px]",children:V})}):V}return u.jsx(PL,{isModal:o,word:n,onClose:e,isSetupMode:S,isPreparing:C,availableChallenges:E,selectedChallengeTypes:z,onToggleChallenge:N,onSetSelection:V=>{U(V),F(!1)},onStartTest:()=>D(),challenges:T.challenges,currentChallenge:T.currentChallenge,currentChallengeIndex:T.currentChallengeIndex,userAnswers:T.userAnswers,handleAnswerChange:T.setAnswer,results:T.results,isFinishing:T.isFinishing,currentPrepositionGroup:T.currentPrepositionGroup,isLastChallenge:T.isLastChallenge,handleNextClick:ne,handleBackClick:T.handleBack,handleIgnore:T.handleIgnore,handleFinishEarly:ae,showHint:H,onToggleHint:()=>q(!H),sessionPosition:l,challengeStats:X,disableHints:p,onSelectQuick:O,onSelectPreferred:ve,onSelectZeroScore:ve,onSelectPartialScore:G,onRetryFailed:ye,isQuickMode:B,elapsedTime:Q(T.elapsedSeconds),recapData:Y,onRecalculateFinish:()=>Y&&s(Y.finalGrade,Y.resultHistory,!1,Y.counts),isMastered:j})},G1=n=>(n||"").toLowerCase().replace(/[^\p{L}\p{N}]+/gu," ").trim().split(/\s+/).filter(Boolean);function YL(n,e){const s=n.toLowerCase(),a=e.toLowerCase(),o=[];let l=0,d=0,p=0;const m=(s.length+a.length)*2+100;for(;(l<s.length||d<a.length)&&p<m;)if(p++,l<s.length&&d<a.length&&s[l]===a[d])o.push({char:s[l],status:"correct"}),l++,d++;else if(l<s.length&&(d>=a.length||s[l]!==a[d])){const y=a.indexOf(s[l],d);y!==-1&&y-d<3?(d=y,o.push({char:s[l],status:"correct"}),l++,d++):(o.push({char:s[l],status:"wrong"}),l++)}else d++;return o}function q1(n,e){const s=G1(n),a=G1(e);let o=0,l=0;const d=s.map(m=>{o+=m.length;let y=-1;if(a.forEach((x,v)=>{y===-1&&x===m&&(y=v)}),y===-1&&a.forEach((x,v)=>{y===-1&&x.length>=2&&(x.startsWith(m.substring(0,2))||m.startsWith(x.substring(0,2)))&&(y=v)}),y!==-1){const x=a[y];a.splice(y,1);const v=YL(m,x),S=v.filter(z=>z.status==="correct").length;l+=S;const I=S===m.length?"correct":"near";return{word:m,status:I,chars:v}}return{word:m,status:"missing",chars:m.split("").map(x=>({char:x,status:"missing"}))}});return{score:o>0?Math.round(l/o*100):0,words:d}}const Yd=3e3,WL=1e3,kT=({target:n,onClose:e,onSaveScore:s})=>{const[a,o]=L.useState(!1),l=L.useRef(!1),[d,p]=L.useState(n||""),[m,y]=L.useState(!n),[x,v]=L.useState(""),[S,I]=L.useState(null),[z,U]=L.useState(null),[C,M]=L.useState(Yd),[B,F]=L.useState(null),[H,q]=L.useState(!1),[Y,A]=L.useState(!1),[T,E]=L.useState(null),[R,N]=L.useState(null),[D,O]=L.useState(!1),[ve,ye]=L.useState(()=>{const ue=localStorage.getItem("mimic_play_speed");return ue?Number(ue):1}),G=L.useRef(null),ae=L.useRef(new j0),ne=L.useRef(null),Q=L.useRef(null),X=L.useRef(Date.now()),j=L.useRef(!1),{showToast:V}=kr(),$=L.useMemo(()=>(d||"").toLowerCase().replace(/[^\p{L}\p{N}]+/gu," ").trim().split(/\s+/).filter(Boolean).length===1,[d]);L.useEffect(()=>{if(a&&d&&x){const ue=q1(d,x);U(ue),ue.score>=100&&!j.current&&(j.current=!0,ee(x))}},[x,a,d]);const Z=L.useCallback(async()=>{if(d){if(B){A(!Y);return}q(!0);try{const ue=d.trim().toLowerCase(),ge=fi().find(Ue=>Ue.word.toLowerCase()===ue);if(ge&&ge.ipaUs){F(ge.ipaUs),A(!0),q(!1);return}const Ee=Tt(),Ae=Vn(Ee),Ge=await fetch(`${Ae}/api/convert/ipa?text=${encodeURIComponent(d)}`);if(Ge.ok){const Ue=await Ge.json();F(Ue.ipa),E(Ue.ipaWords||null),A(!0)}else V("IPA server unavailable","error")}catch{V("Failed to fetch IPA","error")}finally{q(!1)}}},[d,B,Y,V]),ee=L.useCallback(async ue=>{if(!d)return;ne.current&&(clearInterval(ne.current),ne.current=null),Q.current&&(clearTimeout(Q.current),Q.current=null),ae.current.stop();const ge=await O0();ge&&I(ge),o(!1),l.current=!1,j.current=!1;const Ee=q1(d,ue);U(Ee),s&&s(Ee.score)},[d,s]),pe=L.useCallback(()=>{X.current=Date.now(),M(Yd)},[]),ie=L.useCallback(ue=>{ne.current&&clearInterval(ne.current),X.current=Date.now(),M(Yd),ne.current=setInterval(()=>{const Ee=Date.now()-X.current,Ae=Math.max(0,Yd-Ee);M(Ae),Ae<=0&&l.current&&ee(ue)},50)},[ee]);L.useEffect(()=>()=>{ne.current&&clearInterval(ne.current),Q.current&&clearTimeout(Q.current),ae.current.stop()},[]),L.useEffect(()=>{localStorage.setItem("mimic_play_speed",String(ve))},[ve]);const ce=async()=>{if(d)if(m&&y(!1),a)await ee(x);else{j.current=!1,Q.current&&(clearTimeout(Q.current),Q.current=null),v(""),U(null),I(null);try{await R0(),o(!0),l.current=!0,pe(),ie(""),ae.current.start((ue,ge)=>{const Ee=ue+ge;v(Ee),pe(),$&&!Q.current&&Ee.toLowerCase().replace(/[^\p{L}\p{N}]+/gu," ").trim().length>0&&(Q.current=setTimeout(()=>{Q.current=null,l.current&&ee(Ee)},WL))},ue=>{l.current&&(v(ue),ee(ue))})}catch(ue){console.error(ue),o(!1),l.current=!1}}},De=()=>{S&&new Audio(`data:${S.mimeType};base64,${S.base64}`).play()},fe=()=>{if(!d)return;const ue=yu("vocab_pro_mimic_practice_queue",[]);if(ue.some(Ee=>Ee.text===d)){V("Already in Pronunciation Queue","info");return}const ge={id:`quick-save-${Date.now()}`,text:d,sourceWord:d.length>30?d.substring(0,30)+"...":d,type:"Quick Practice"};e0("vocab_pro_mimic_practice_queue",[...ue,ge]),V("Saved to Pronunciation Page","success")},Se=ue=>{const ge=ue.length;return ge<40?"text-2xl md:text-3xl":ge<80?"text-xl md:text-2xl":ge<150?"text-lg md:text-xl":"text-base md:text-lg"},Oe=ue=>{const ge=ue.toLowerCase().replace(/[^a-z]/g,"");if(!ge)return 1;const Ee=ge.match(/[aeiouy]+/g);return Ee?Ee.length:1},me=()=>{if(!d)return;const ue=d.split(/\s+/);if(D){clearTimeout(G.current),O(!1),N(null);return}let ge=0;O(!0),N(0);const Ee=()=>{if(ge>=ue.length){O(!1),N(null);return}N(ge);const Ae=ue[ge];let Ue=400*Oe(Ae)/ve;/[,.]/.test(Ae)&&(Ue+=300/ve),/[!?;]/.test(Ae)&&(Ue+=500/ve),/[:]/.test(Ae)&&(Ue+=400/ve),ge++,G.current=setTimeout(Ee,Ue)};Ee()};return u.jsx("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-[95vw] sm:max-w-2xl md:max-w-4xl lg:max-w-5xl rounded-[2.5rem] shadow-2xl border border-neutral-200 p-8 flex flex-col items-center gap-6 relative",children:[u.jsx("button",{onClick:e,className:"absolute top-6 right-6 p-2 text-neutral-300 hover:text-neutral-900 hover:bg-neutral-100 rounded-full transition-all",children:u.jsx(jn,{size:20})}),u.jsxs("div",{className:"text-center space-y-1 mt-2",children:[u.jsx("span",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Mimic Practice"}),u.jsx("h3",{className:"text-xl font-bold text-neutral-900 leading-tight",children:"Practice Selected Phrase"})]}),u.jsxs("div",{className:"w-full p-6 bg-neutral-50 rounded-[2rem] border border-neutral-200 flex flex-col items-center gap-3 min-h-[120px] overflow-hidden relative group",children:[m?u.jsxs("div",{className:"w-full relative",children:[u.jsx("textarea",{value:d,onChange:ue=>p(ue.target.value),placeholder:"Enter text to practice...",className:"w-full h-32 p-4 bg-white border border-neutral-200 rounded-xl font-medium resize-none focus:ring-2 focus:ring-neutral-900 outline-none text-base leading-relaxed"}),u.jsx("button",{onClick:()=>y(!1),className:"absolute bottom-4 right-4 px-3 py-1.5 bg-neutral-900 text-white rounded-lg text-xs font-bold shadow-sm",children:"Done"})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>y(!0),className:"absolute top-4 right-4 p-2 text-neutral-400 hover:text-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity bg-white rounded-full shadow-sm",children:u.jsx(_I,{size:16})}),u.jsx("div",{className:"flex flex-wrap justify-center gap-x-1.5 gap-y-1 w-full",children:d.split(/\s+/).map((ue,ge)=>{const Ee=z==null?void 0:z.words[ge];let Ae="text-neutral-800";if(Ee)switch(Ee.status){case"correct":Ae="text-emerald-600";break;case"near":Ae="text-amber-500";break;case"wrong":Ae="text-rose-500";break;case"missing":Ae="text-neutral-300";break;default:Ae="text-neutral-800"}return u.jsx("span",{onClick:()=>as(ue),onMouseEnter:()=>N(ge),onMouseLeave:()=>N(null),className:`${Se(d)} font-bold cursor-pointer transition-colors leading-normal px-1 rounded ${Ae} ${R===ge?"bg-indigo-100/70":"bg-transparent"}`,children:ue},ge)})})]}),Y&&B&&!m&&u.jsx("div",{className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm font-mono font-normal text-neutral-600 leading-relaxed animate-in slide-in-from-top-2 duration-300 flex flex-wrap gap-x-2 gap-y-1 text-left",children:(T&&T.length>0?T:B.replace(/\//g,"").replace(/\/\/+/g," ").split(/\s+/).filter(Boolean)).map((ue,ge)=>u.jsx("span",{className:`px-1 rounded transition-all ${R===ge?"bg-indigo-200 text-indigo-900":""}`,children:ue},ge))})]}),u.jsxs("div",{className:"flex flex-col items-center gap-4 w-full",children:[a?u.jsxs("div",{className:"flex items-center gap-2 text-rose-500 animate-pulse",children:[u.jsx(Zp,{size:20}),u.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Listening..."})]}):x&&u.jsxs("p",{className:"text-sm font-medium italic text-neutral-500 line-clamp-2",children:['"',x,'"']}),z&&u.jsxs("div",{className:"text-center animate-in zoom-in-95",children:[u.jsxs("div",{className:`text-4xl font-black ${z.score>80?"text-emerald-500":z.score>50?"text-amber-500":"text-rose-500"}`,children:[z.score,"%"]}),u.jsx("p",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest",children:"Accuracy"})]})]}),u.jsxs("div",{className:"flex items-center gap-4 pt-2",children:[u.jsx("button",{onClick:()=>as(d),disabled:!d.trim(),className:"p-4 rounded-2xl bg-neutral-100 text-neutral-600 hover:text-neutral-900 transition-all",title:"Listen",children:u.jsx(Sr,{size:24})}),u.jsx("button",{onClick:Z,disabled:H,className:`p-4 rounded-2xl transition-all ${Y?"bg-indigo-600 text-white shadow-md":"bg-neutral-100 text-neutral-600 hover:text-indigo-600"}`,title:"Show Phonetic (IPA)",children:H?u.jsx(mn,{size:24,className:"animate-spin"}):u.jsx(Q2,{size:24})}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:me,disabled:!d.trim(),className:`p-4 rounded-2xl transition-all ${D?"bg-indigo-600 text-white":"bg-neutral-100 text-neutral-600 hover:text-indigo-600"}`,title:"Play Highlight",children:u.jsx(Zp,{size:24})}),u.jsxs("select",{value:ve,onChange:ue=>ye(Number(ue.target.value)),className:"text-xs border border-neutral-200 rounded-lg px-2 py-1 bg-white",children:[u.jsx("option",{value:.5,children:"75 WPM"}),u.jsx("option",{value:.75,children:"110 WPM"}),u.jsx("option",{value:1,children:"150 WPM"}),u.jsx("option",{value:1.25,children:"190 WPM"}),u.jsx("option",{value:1.5,children:"225 WPM"}),u.jsx("option",{value:1.75,children:"260 WPM"}),u.jsx("option",{value:2,children:"300 WPM"}),u.jsx("option",{value:2.25,children:"325 WPM"}),u.jsx("option",{value:2.5,children:"350 WPM"}),u.jsx("option",{value:2.75,children:"375 WPM"}),u.jsx("option",{value:3,children:"400 WPM"})]})]}),u.jsx("button",{onClick:ce,className:`w-20 h-20 rounded-full flex items-center justify-center shadow-lg transition-all transform active:scale-105 ${a?"bg-rose-600 text-white scale-110 shadow-rose-500/50 ring-8 ring-rose-500/10":"bg-white border-4 border-neutral-100 text-neutral-900 hover:scale-105"}`,title:"Record",children:a?C<=1e3?u.jsx("span",{className:"text-2xl font-black tabular-nums animate-in fade-in duration-300",children:(C/1e3).toFixed(1)}):u.jsx(Zp,{size:28,className:"animate-pulse"}):u.jsx(Ao,{size:28})}),u.jsx("button",{onClick:De,disabled:!S||a,className:`p-4 rounded-2xl transition-all ${S&&!a?"bg-indigo-100 text-indigo-600 hover:text-indigo-900":"bg-neutral-50 text-neutral-300 cursor-not-allowed"}`,title:"Play recording",children:u.jsx(hu,{size:24,fill:S&&!a?"currentColor":"none"})}),u.jsx("button",{onClick:fe,disabled:!d.trim(),className:"p-4 rounded-2xl bg-neutral-100 text-neutral-600 hover:text-indigo-600 transition-all",title:"Save to Pronunciation Page",children:u.jsx(xI,{size:24})})]})]})})},QL=({word:n,onClose:e,onNavigateToWord:s,onEditRequest:a,onUpdate:o,onGainXp:l,isViewOnly:d=!1,initialTab:p="OVERVIEW"})=>{const[m,y]=L.useState({...n,lastTestResults:fo(n.lastTestResults)}),[x,v]=L.useState([]),[S,I]=L.useState({}),[z,U]=L.useState({}),[C,M]=L.useState(null),[B,F]=L.useState(new Set),[H,q]=L.useState(!1),[Y,A]=L.useState(!1);L.useEffect(()=>{const ne=fo(n.lastTestResults);y({...n,lastTestResults:ne})},[n]),L.useEffect(()=>{(async()=>{if(!m)return;const Q=[],X=m.wordFamily;X&&Q.push(...(X.nouns||[]).map(Se=>Se.word.toLowerCase().trim()),...(X.verbs||[]).map(Se=>Se.word.toLowerCase().trim()),...(X.adjs||[]).map(Se=>Se.word.toLowerCase().trim()),...(X.advs||[]).map(Se=>Se.word.toLowerCase().trim()));const j=m.paraphrases;j&&Q.push(...j.map(Se=>Se.word.toLowerCase().trim()));const V=m.idiomsList;V&&Q.push(...V.map(Se=>Se.text.toLowerCase().trim()));const $=m.collocationsArray;$&&Q.push(...$.map(Se=>Se.text.toLowerCase().trim()));const Z=[...new Set(Q.filter(Boolean))],ee=new Set;for(const Se of Z){if(!Se)continue;await au(m.userId,Se)&&ee.add(Se)}F(ee);const pe=await wN(m.userId,m.id);v(pe);const ie=fi(),ce={};(m.groups||[]).filter(Se=>Se.toLowerCase()!=="ielts").forEach(Se=>{const Oe=ie.filter(me=>{var ue;return me.userId===m.userId&&me.id!==m.id&&((ue=me.groups)==null?void 0:ue.includes(Se))});Oe.length>0&&(ce[Se]=Oe)}),I(ce);const fe={};(m.groups||[]).forEach(Se=>{const Oe=ie.filter(me=>{var ue;return me.userId===m.userId&&me.id!==m.id&&((ue=me.groups)==null?void 0:ue.includes(Se))});Oe.length>0&&(fe[Se]=Oe)}),U(fe)})()},[m]);const T=async(ne,Q="family")=>{if(!(!ne.word||C||B.has(ne.word.toLowerCase()))){M(ne.word);try{const X=`From ${Q} of "${m.word}"`,j=[...m.groups||[],`word-${Q}`],V={...Jg(ne.word,ne.ipa||"",`Added from ${Q}`,"",X,j),userId:m.userId};await jf(V),F($=>new Set($).add(ne.word.toLowerCase()))}finally{M(null)}}},E=async(ne,Q,X,j)=>{const V={...m};if(Q){const $=fo(Q),Z=jT(V.lastTestResults,$);$.COLLOCATION_CONTEXT_QUIZ===!1&&m.collocationsArray&&m.collocationsArray.forEach(ee=>{const pe=`COLLOCATION_CONTEXT_QUIZ:${ee.text}`;pe in Z||(Z[pe]=!1)}),$.PARAPHRASE_CONTEXT_QUIZ===!1&&m.paraphrases&&m.paraphrases.forEach(ee=>{const pe=`PARAPHRASE_CONTEXT_QUIZ:${ee.word}`;pe in Z||(Z[pe]=!1)}),V.lastTestResults=Z}V.masteryScore=Rs(V),await o(V),q(!1),y(V)},R=ne=>{o(ne),y({...ne,lastTestResults:fo(ne.lastTestResults)})},[N,D]=L.useState(null),O=ne=>{D(ne)},ve=ne=>{const Q=Tt(),X=Q.audioCoach.activeCoach,j=Q.audioCoach.coaches[X].name;return N==="ESSAY"?Bk(m,ne,j):Fk(m,ne,j)},ye=ne=>{const{result:Q}=ne,X=Q||ne,j={...m,lesson:{...m.lesson||{}}};N==="ESSAY"?j.lesson.essay=X.content:j.lesson.test=X.content,R(j),D(null)},ae=Tt().audio.appliedAccent;return u.jsxs(u.Fragment,{children:[H&&u.jsx($L,{word:m,onComplete:E,onClose:()=>q(!1)}),Y&&u.jsx(kT,{target:m.word,onClose:()=>A(!1)}),u.jsx(TL,{word:m,onClose:e,onChallengeRequest:()=>q(!0),onMimicRequest:()=>A(!0),onEditRequest:()=>a(m),onUpdate:R,linkedUnits:x,relatedWords:S,relatedByGroup:z,onNavigateToWord:s,onAddVariantToLibrary:T,addingVariant:C,existingVariants:B,appliedAccent:ae,isViewOnly:d,initialTab:p,onGenerateLesson:O}),N&&u.jsx("div",{className:"z-[2000]",children:u.jsx("div",{className:"relative z-[500]",children:u.jsx(vg,{isOpen:!!N,onClose:()=>D(null),type:"GENERATE_WORD_LESSON",title:N==="ESSAY"?`Generate Usage Guide: ${m.word}`:`Generate Practice Test: ${m.word}`,description:N==="ESSAY"?"AI will create a structured usage guide with tables and examples.":"AI will design an interactive test for this word.",initialData:{},onGeneratePrompt:ve,onJsonReceived:ye,closeOnSuccess:!0})})})]})},Eg=({isOpen:n,title:e,message:s,confirmText:a,isProcessing:o,onConfirm:l,onClose:d,confirmButtonClass:p="bg-red-600 text-white hover:bg-red-700 shadow-red-200",icon:m=u.jsx(Dg,{size:40})})=>n?u.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsx("div",{className:"bg-white w-full max-w-sm rounded-[2.5rem] shadow-2xl border border-neutral-200 overflow-hidden animate-in zoom-in-95 duration-200",children:u.jsxs("div",{className:"p-8 text-center space-y-6",children:[u.jsx("div",{className:"mx-auto w-20 h-20 bg-neutral-50 text-neutral-500 rounded-full flex items-center justify-center border-4 border-white shadow-sm",children:m}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h3",{className:"text-2xl font-black text-neutral-900 leading-tight",children:e}),u.jsx("p",{className:"text-neutral-500 text-sm leading-relaxed",children:s})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsxs("button",{disabled:o,onClick:l,className:`w-full py-4 rounded-2xl font-black text-sm transition-all shadow-lg active:scale-95 flex items-center justify-center space-x-2 disabled:opacity-50 ${p}`,children:[o?u.jsx(mn,{size:18,className:"animate-spin"}):null,u.jsx("span",{children:o?"PROCESSING...":a})]}),u.jsx("button",{disabled:o,onClick:d,className:"w-full py-4 bg-neutral-100 text-neutral-500 rounded-2xl font-bold text-sm hover:bg-neutral-200 transition-all active:scale-95 disabled:opacity-50",children:"Cancel"})]})]})})}):null;var KL={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $1;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})($1||($1={}));var Y1;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Y1||(Y1={}));var W1;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(W1||(W1={}));var lo;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(lo||(lo={}));var Q1;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Q1||(Q1={}));var K1;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(K1||(K1={}));var Z1;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Z1||(Z1={}));var X1;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(X1||(X1={}));var J1;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(J1||(J1={}));var e_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(e_||(e_={}));var t_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(t_||(t_={}));var n_;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(n_||(n_={}));var s_;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(s_||(s_={}));var r_;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(r_||(r_={}));var a_;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(a_||(a_={}));var i_;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(i_||(i_={}));var o_;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(o_||(o_={}));var l_;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(l_||(l_={}));var c_;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(c_||(c_={}));var u_;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(u_||(u_={}));var d_;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(d_||(d_={}));var f_;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(f_||(f_={}));var h_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(h_||(h_={}));var p_;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(p_||(p_={}));var m_;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(m_||(m_={}));var g_;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(g_||(g_={}));var y_;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(y_||(y_={}));var x_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(x_||(x_={}));var b_;(function(n){n.COLLECTION="COLLECTION"})(b_||(b_={}));var v_;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(v_||(v_={}));var __;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(__||(__={}));var E_;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(E_||(E_={}));var w_;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(w_||(w_={}));var S_;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(S_||(S_={}));var T_;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(T_||(T_={}));var A_;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(A_||(A_={}));var I_;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(I_||(I_={}));var N_;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(N_||(N_={}));var C_;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(C_||(C_={}));var R_;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(R_||(R_={}));var O_;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(O_||(O_={}));var j_;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(j_||(j_={}));var k_;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING",n.DISTILLATION="DISTILLATION"})(k_||(k_={}));var L_;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(L_||(L_={}));var M_;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(M_||(M_={}));var D_;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED",n.REGISTERED="REGISTERED"})(D_||(D_={}));var U_;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(U_||(U_={}));var P_;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(P_||(P_={}));var V_;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(V_||(V_={}));var z_;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.ACTIVITY_START="ACTIVITY_START",n.ACTIVITY_END="ACTIVITY_END"})(z_||(z_={}));var B_;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(B_||(B_={}));var F_;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(F_||(F_={}));var H_;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(H_||(H_={}));var G_;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(G_||(G_={}));var q_;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(q_||(q_={}));var $_;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})($_||($_={}));var Y_;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Y_||(Y_={}));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var W_;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(W_||(W_={}));function wf(n,e){var s={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&e.indexOf(a)<0&&(s[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,a=Object.getOwnPropertySymbols(n);o<a.length;o++)e.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(n,a[o])&&(s[a[o]]=n[a[o]]);return s}function Q_(n){var e=typeof Symbol=="function"&&Symbol.iterator,s=e&&n[e],a=0;if(s)return s.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&a>=n.length&&(n=void 0),{value:n&&n[a++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function nn(n){return this instanceof nn?(this.v=n,this):new nn(n)}function su(n,e,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=s.apply(n,e||[]),o,l=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),p("next"),p("throw"),p("return",d),o[Symbol.asyncIterator]=function(){return this},o;function d(I){return function(z){return Promise.resolve(z).then(I,v)}}function p(I,z){a[I]&&(o[I]=function(U){return new Promise(function(C,M){l.push([I,U,C,M])>1||m(I,U)})},z&&(o[I]=z(o[I])))}function m(I,z){try{y(a[I](z))}catch(U){S(l[0][3],U)}}function y(I){I.value instanceof nn?Promise.resolve(I.value.v).then(x,v):S(l[0][2],I)}function x(I){m("next",I)}function v(I){m("throw",I)}function S(I,z){I(z),l.shift(),l.length&&m(l[0][0],l[0][1])}}function Nl(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],s;return e?e.call(n):(n=typeof Q_=="function"?Q_(n):n[Symbol.iterator](),s={},a("next"),a("throw"),a("return"),s[Symbol.asyncIterator]=function(){return this},s);function a(l){s[l]=n[l]&&function(d){return new Promise(function(p,m){d=n[l](d),o(p,m,d.done,d.value)})}}function o(l,d,p,m){Promise.resolve(m).then(function(y){l({value:y,done:p})},d)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let LT=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return LT=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),s=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(+a^s()&15>>+a/4).toString(16))};const ZL=()=>LT();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wg(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const Sg=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hr extends Error{}class xs extends hr{constructor(e,s,a,o){super(`${xs.makeMessage(e,s,a)}`),this.status=e,this.headers=o,this.error=s}static makeMessage(e,s,a){const o=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):a;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,s,a,o){if(!e||!o)return new Yf({message:a,cause:Sg(s)});const l=s;return e===400?new DT(e,l,a,o):e===401?new UT(e,l,a,o):e===403?new PT(e,l,a,o):e===404?new VT(e,l,a,o):e===409?new zT(e,l,a,o):e===422?new BT(e,l,a,o):e===429?new FT(e,l,a,o):e>=500?new HT(e,l,a,o):new xs(e,l,a,o)}}class Tg extends xs{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Yf extends xs{constructor({message:e,cause:s}){super(void 0,void 0,e||"Connection error.",void 0),s&&(this.cause=s)}}class MT extends Yf{constructor({message:e}={}){super({message:e??"Request timed out."})}}class DT extends xs{}class UT extends xs{}class PT extends xs{}class VT extends xs{}class zT extends xs{}class BT extends xs{}class FT extends xs{}class HT extends xs{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const XL=/^[a-z][a-z0-9+.-]*:/i,JL=n=>XL.test(n);let Ag=n=>(Ag=Array.isArray,Ag(n));const e4=Ag;let t4=e4;const K_=t4;function n4(n){if(!n)return!0;for(const e in n)return!1;return!0}function s4(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const r4=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new hr(`${n} must be an integer`);if(e<0)throw new hr(`${n} must be a positive integer`);return e},a4=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const i4=n=>new Promise(e=>setTimeout(e,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bl="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function o4(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const l4=()=>{var n,e,s,a,o;const l=o4();if(l==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bl,"X-Stainless-OS":X_(Deno.build.os),"X-Stainless-Arch":Z_(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(l==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bl,"X-Stainless-OS":X_((s=globalThis.process.platform)!==null&&s!==void 0?s:"unknown"),"X-Stainless-Arch":Z_((a=globalThis.process.arch)!==null&&a!==void 0?a:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(o=globalThis.process.version)!==null&&o!==void 0?o:"unknown"};const d=c4();return d?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${d.browser}`,"X-Stainless-Runtime-Version":d.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":bl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function c4(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:s}of n){const a=s.exec(navigator.userAgent);if(a){const o=a[1]||0,l=a[2]||0,d=a[3]||0;return{browser:e,version:`${o}.${l}.${d}`}}}return null}const Z_=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",X_=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Wd;const u4=()=>Wd??(Wd=l4());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function d4(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function GT(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function f4(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return GT({start(){},async pull(s){const{done:a,value:o}=await e.next();a?s.close():s.enqueue(o)},async cancel(){var s;await((s=e.return)===null||s===void 0?void 0:s.call(e))}})}function qT(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const s=await e.read();return s!=null&&s.done&&e.releaseLock(),s}catch(s){throw e.releaseLock(),s}},async return(){const s=e.cancel();return e.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function h4(n){var e,s;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((s=(e=n[Symbol.asyncIterator]()).return)===null||s===void 0?void 0:s.call(e));return}const a=n.getReader(),o=a.cancel();a.releaseLock(),await o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const p4=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $T=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,s=typeof((n=e==null?void 0:e.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(s?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function mm(n,e,s){return $T(),new File(n,e??"unknown_file",s)}function m4(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const g4=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const YT=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",y4=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&YT(n),x4=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function b4(n,e,s){if($T(),n=await n,y4(n))return n instanceof File?n:mm([await n.arrayBuffer()],n.name);if(x4(n)){const o=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),mm(await Ig(o),e,s)}const a=await Ig(n);if(e||(e=m4(n)),!(s!=null&&s.type)){const o=a.find(l=>typeof l=="object"&&"type"in l&&l.type);typeof o=="string"&&(s=Object.assign(Object.assign({},s),{type:o}))}return mm(a,e,s)}async function Ig(n){var e,s,a,o,l;let d=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)d.push(n);else if(YT(n))d.push(n instanceof Blob?n:await n.arrayBuffer());else if(g4(n))try{for(var p=!0,m=Nl(n),y;y=await m.next(),e=y.done,!e;p=!0){o=y.value,p=!1;const x=o;d.push(...await Ig(x))}}catch(x){s={error:x}}finally{try{!p&&!e&&(a=m.return)&&await a.call(m)}finally{if(s)throw s.error}}else{const x=(l=n==null?void 0:n.constructor)===null||l===void 0?void 0:l.name;throw new Error(`Unexpected data type: ${typeof n}${x?`; constructor: ${x}`:""}${v4(n)}`)}return d}function v4(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(s=>`"${s}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class WT{constructor(e){this._client=e}}WT._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function QT(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const J_=Object.freeze(Object.create(null)),_4=(n=QT)=>(function(s,...a){if(s.length===1)return s[0];let o=!1;const l=[],d=s.reduce((x,v,S)=>{var I,z,U;/[?#]/.test(v)&&(o=!0);const C=a[S];let M=(o?encodeURIComponent:n)(""+C);return S!==a.length&&(C==null||typeof C=="object"&&C.toString===((U=Object.getPrototypeOf((z=Object.getPrototypeOf((I=C.hasOwnProperty)!==null&&I!==void 0?I:J_))!==null&&z!==void 0?z:J_))===null||U===void 0?void 0:U.toString))&&(M=C+"",l.push({start:x.length+v.length,length:M.length,error:`Value of type ${Object.prototype.toString.call(C).slice(8,-1)} is not a valid path parameter`})),x+v+(S===a.length?"":M)},""),p=d.split(/[?#]/,1)[0],m=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let y;for(;(y=m.exec(p))!==null;)l.push({start:y.index,length:y[0].length,error:`Value "${y[0]}" can't be safely passed as a path parameter`});if(l.sort((x,v)=>x.start-v.start),l.length>0){let x=0;const v=l.reduce((S,I)=>{const z=" ".repeat(I.start-x),U="^".repeat(I.length);return x=I.start+I.length,S+z+U},"");throw new hr(`Path parameters result in path with invalid segments:
${l.map(S=>S.error).join(`
`)}
${d}
${v}`)}return d}),Qd=_4(QT);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KT extends WT{create(e,s){var a;const{api_version:o=this._client.apiVersion}=e,l=wf(e,["api_version"]);if("model"in l&&"agent_config"in l)throw new hr("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in l&&"generation_config"in l)throw new hr("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Qd`/${o}/interactions`,Object.assign(Object.assign({body:l},s),{stream:(a=e.stream)!==null&&a!==void 0?a:!1}))}delete(e,s={},a){const{api_version:o=this._client.apiVersion}=s??{};return this._client.delete(Qd`/${o}/interactions/${e}`,a)}cancel(e,s={},a){const{api_version:o=this._client.apiVersion}=s??{};return this._client.post(Qd`/${o}/interactions/${e}/cancel`,a)}get(e,s={},a){var o;const l=s??{},{api_version:d=this._client.apiVersion}=l,p=wf(l,["api_version"]);return this._client.get(Qd`/${d}/interactions/${e}`,Object.assign(Object.assign({query:p},a),{stream:(o=s==null?void 0:s.stream)!==null&&o!==void 0?o:!1}))}}KT._key=Object.freeze(["interactions"]);class ZT extends KT{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function E4(n){let e=0;for(const o of n)e+=o.length;const s=new Uint8Array(e);let a=0;for(const o of n)s.set(o,a),a+=o.length;return s}let Kd;function L0(n){let e;return(Kd??(e=new globalThis.TextEncoder,Kd=e.encode.bind(e)))(n)}let Zd;function eE(n){let e;return(Zd??(e=new globalThis.TextDecoder,Zd=e.decode.bind(e)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wf{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const s=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?L0(e):e;this.buffer=E4([this.buffer,s]);const a=[];let o;for(;(o=w4(this.buffer,this.carriageReturnIndex))!=null;){if(o.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=o.index;continue}if(this.carriageReturnIndex!=null&&(o.index!==this.carriageReturnIndex+1||o.carriage)){a.push(eE(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const l=this.carriageReturnIndex!==null?o.preceding-1:o.preceding,d=eE(this.buffer.subarray(0,l));a.push(d),this.buffer=this.buffer.subarray(o.index),this.carriageReturnIndex=null}return a}flush(){return this.buffer.length?this.decode(`
`):[]}}Wf.NEWLINE_CHARS=new Set([`
`,"\r"]);Wf.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function w4(n,e){for(let o=e??0;o<n.length;o++){if(n[o]===10)return{preceding:o,index:o+1,carriage:!1};if(n[o]===13)return{preceding:o,index:o+1,carriage:!0}}return null}function S4(n){for(let a=0;a<n.length-1;a++){if(n[a]===10&&n[a+1]===10||n[a]===13&&n[a+1]===13)return a+2;if(n[a]===13&&n[a+1]===10&&a+3<n.length&&n[a+2]===13&&n[a+3]===10)return a+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Sf={off:0,error:200,warn:300,info:400,debug:500},tE=(n,e,s)=>{if(n){if(s4(Sf,n))return n;ms(s).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Sf))}`)}};function qc(){}function Xd(n,e,s){return!e||Sf[n]>Sf[s]?qc:e[n].bind(e)}const T4={error:qc,warn:qc,info:qc,debug:qc};let nE=new WeakMap;function ms(n){var e;const s=n.logger,a=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!s)return T4;const o=nE.get(s);if(o&&o[0]===a)return o[1];const l={error:Xd("error",s,a),warn:Xd("warn",s,a),info:Xd("info",s,a),debug:Xd("debug",s,a)};return nE.set(s,[a,l]),l}const io=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,s])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":s]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vl{constructor(e,s,a){this.iterator=e,this.controller=s,this.client=a}static fromSSEResponse(e,s,a){let o=!1;const l=a?ms(a):console;function d(){return su(this,arguments,function*(){var m,y,x,v;if(o)throw new hr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let S=!1;try{try{for(var I=!0,z=Nl(A4(e,s)),U;U=yield nn(z.next()),m=U.done,!m;I=!0){v=U.value,I=!1;const C=v;if(!S)if(C.data.startsWith("[DONE]")){S=!0;continue}else try{yield yield nn(JSON.parse(C.data))}catch(M){throw l.error("Could not parse message into JSON:",C.data),l.error("From chunk:",C.raw),M}}}catch(C){y={error:C}}finally{try{!I&&!m&&(x=z.return)&&(yield nn(x.call(z)))}finally{if(y)throw y.error}}S=!0}catch(C){if(wg(C))return yield nn(void 0);throw C}finally{S||s.abort()}})}return new vl(d,s,a)}static fromReadableStream(e,s,a){let o=!1;function l(){return su(this,arguments,function*(){var m,y,x,v;const S=new Wf,I=qT(e);try{for(var z=!0,U=Nl(I),C;C=yield nn(U.next()),m=C.done,!m;z=!0){v=C.value,z=!1;const M=v;for(const B of S.decode(M))yield yield nn(B)}}catch(M){y={error:M}}finally{try{!z&&!m&&(x=U.return)&&(yield nn(x.call(U)))}finally{if(y)throw y.error}}for(const M of S.flush())yield yield nn(M)})}function d(){return su(this,arguments,function*(){var m,y,x,v;if(o)throw new hr("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let S=!1;try{try{for(var I=!0,z=Nl(l()),U;U=yield nn(z.next()),m=U.done,!m;I=!0){v=U.value,I=!1;const C=v;S||C&&(yield yield nn(JSON.parse(C)))}}catch(C){y={error:C}}finally{try{!I&&!m&&(x=z.return)&&(yield nn(x.call(z)))}finally{if(y)throw y.error}}S=!0}catch(C){if(wg(C))return yield nn(void 0);throw C}finally{S||s.abort()}})}return new vl(d,s,a)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],s=[],a=this.iterator(),o=l=>({next:()=>{if(l.length===0){const d=a.next();e.push(d),s.push(d)}return l.shift()}});return[new vl(()=>o(e),this.controller,this.client),new vl(()=>o(s),this.controller,this.client)]}toReadableStream(){const e=this;let s;return GT({async start(){s=e[Symbol.asyncIterator]()},async pull(a){try{const{value:o,done:l}=await s.next();if(l)return a.close();const d=L0(JSON.stringify(o)+`
`);a.enqueue(d)}catch(o){a.error(o)}},async cancel(){var a;await((a=s.return)===null||a===void 0?void 0:a.call(s))}})}}function A4(n,e){return su(this,arguments,function*(){var a,o,l,d;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new hr("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new hr("Attempted to iterate over a response with no body");const p=new N4,m=new Wf,y=qT(n.body);try{for(var x=!0,v=Nl(I4(y)),S;S=yield nn(v.next()),a=S.done,!a;x=!0){d=S.value,x=!1;const I=d;for(const z of m.decode(I)){const U=p.decode(z);U&&(yield yield nn(U))}}}catch(I){o={error:I}}finally{try{!x&&!a&&(l=v.return)&&(yield nn(l.call(v)))}finally{if(o)throw o.error}}for(const I of m.flush()){const z=p.decode(I);z&&(yield yield nn(z))}})}function I4(n){return su(this,arguments,function*(){var s,a,o,l;let d=new Uint8Array;try{for(var p=!0,m=Nl(n),y;y=yield nn(m.next()),s=y.done,!s;p=!0){l=y.value,p=!1;const x=l;if(x==null)continue;const v=x instanceof ArrayBuffer?new Uint8Array(x):typeof x=="string"?L0(x):x;let S=new Uint8Array(d.length+v.length);S.set(d),S.set(v,d.length),d=S;let I;for(;(I=S4(d))!==-1;)yield yield nn(d.slice(0,I)),d=d.slice(I)}}catch(x){a={error:x}}finally{try{!p&&!s&&(o=m.return)&&(yield nn(o.call(m)))}finally{if(a)throw a.error}}d.length>0&&(yield yield nn(d))})}class N4{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const l={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],l}if(this.chunks.push(e),e.startsWith(":"))return null;let[s,a,o]=C4(e,":");return o.startsWith(" ")&&(o=o.substring(1)),s==="event"?this.event=o:s==="data"&&this.data.push(o),null}}function C4(n,e){const s=n.indexOf(e);return s!==-1?[n.substring(0,s),e,n.substring(s+e.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function R4(n,e){const{response:s,requestLogID:a,retryOfRequestLogID:o,startTime:l}=e,d=await(async()=>{var p;if(e.options.stream)return ms(n).debug("response",s.status,s.url,s.headers,s.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(s,e.controller,n):vl.fromSSEResponse(s,e.controller,n);if(s.status===204)return null;if(e.options.__binaryResponse)return s;const m=s.headers.get("content-type"),y=(p=m==null?void 0:m.split(";")[0])===null||p===void 0?void 0:p.trim();return(y==null?void 0:y.includes("application/json"))||(y==null?void 0:y.endsWith("+json"))?s.headers.get("content-length")==="0"?void 0:await s.json():await s.text()})();return ms(n).debug(`[${a}] response parsed`,io({retryOfRequestLogID:o,url:s.url,status:s.status,body:d,durationMs:Date.now()-l})),d}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class M0 extends Promise{constructor(e,s,a=R4){super(o=>{o(null)}),this.responsePromise=s,this.parseResponse=a,this.client=e}_thenUnwrap(e){return new M0(this.client,this.responsePromise,async(s,a)=>e(await this.parseResponse(s,a),a))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:s}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,s){return this.parse().then(e,s)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const XT=Symbol("brand.privateNullableHeaders");function*O4(n){if(!n)return;if(XT in n){const{values:a,nulls:o}=n;yield*a.entries();for(const l of o)yield[l,null];return}let e=!1,s;n instanceof Headers?s=n.entries():K_(n)?s=n:(e=!0,s=Object.entries(n??{}));for(let a of s){const o=a[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const l=K_(a[1])?a[1]:[a[1]];let d=!1;for(const p of l)p!==void 0&&(e&&!d&&(d=!0,yield[o,null]),yield[o,p])}}const Mc=n=>{const e=new Headers,s=new Set;for(const a of n){const o=new Set;for(const[l,d]of O4(a)){const p=l.toLowerCase();o.has(p)||(e.delete(l),o.add(p)),d===null?(e.delete(l),s.add(p)):(e.append(l,d),s.delete(p))}}return{[XT]:!0,values:e,nulls:s}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gm=n=>{var e,s,a,o,l,d;if(typeof globalThis.process<"u")return(a=(s=(e=KL)===null||e===void 0?void 0:e[n])===null||s===void 0?void 0:s.trim())!==null&&a!==void 0?a:void 0;if(typeof globalThis.Deno<"u")return(d=(l=(o=globalThis.Deno.env)===null||o===void 0?void 0:o.get)===null||l===void 0?void 0:l.call(o,n))===null||d===void 0?void 0:d.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var JT;class Qf{constructor(e){var s,a,o,l,d,p,m,{baseURL:y=gm("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:x=(s=gm("GEMINI_API_KEY"))!==null&&s!==void 0?s:null,apiVersion:v="v1beta"}=e,S=wf(e,["baseURL","apiKey","apiVersion"]);const I=Object.assign(Object.assign({apiKey:x,apiVersion:v},S),{baseURL:y||"https://generativelanguage.googleapis.com"});this.baseURL=I.baseURL,this.timeout=(a=I.timeout)!==null&&a!==void 0?a:Qf.DEFAULT_TIMEOUT,this.logger=(o=I.logger)!==null&&o!==void 0?o:console;const z="warn";this.logLevel=z,this.logLevel=(d=(l=tE(I.logLevel,"ClientOptions.logLevel",this))!==null&&l!==void 0?l:tE(gm("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&d!==void 0?d:z,this.fetchOptions=I.fetchOptions,this.maxRetries=(p=I.maxRetries)!==null&&p!==void 0?p:2,this.fetch=(m=I.fetch)!==null&&m!==void 0?m:d4(),this.encoder=p4,this._options=I,this.apiKey=x,this.apiVersion=v,this.clientAdapter=I.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:s}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!s.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const s=Mc([e.headers]);if(!(s.values.has("authorization")||s.values.has("x-goog-api-key"))){if(this.apiKey)return Mc([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Mc([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([s,a])=>typeof a<"u").map(([s,a])=>{if(typeof a=="string"||typeof a=="number"||typeof a=="boolean")return`${encodeURIComponent(s)}=${encodeURIComponent(a)}`;if(a===null)return`${encodeURIComponent(s)}=`;throw new hr(`Cannot stringify type ${typeof a}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${bl}`}defaultIdempotencyKey(){return`stainless-node-retry-${ZL()}`}makeStatusError(e,s,a,o){return xs.generate(e,s,a,o)}buildURL(e,s,a){const o=!this.baseURLOverridden()&&a||this.baseURL,l=JL(e)?new URL(e):new URL(o+(o.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),d=this.defaultQuery();return n4(d)||(s=Object.assign(Object.assign({},d),s)),typeof s=="object"&&s&&!Array.isArray(s)&&(l.search=this.stringifyQuery(s)),l.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const s=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${s}`}}async prepareRequest(e,{url:s,options:a}){}get(e,s){return this.methodRequest("get",e,s)}post(e,s){return this.methodRequest("post",e,s)}patch(e,s){return this.methodRequest("patch",e,s)}put(e,s){return this.methodRequest("put",e,s)}delete(e,s){return this.methodRequest("delete",e,s)}methodRequest(e,s,a){return this.request(Promise.resolve(a).then(o=>Object.assign({method:e,path:s},o)))}request(e,s=null){return new M0(this,this.makeRequest(e,s,void 0))}async makeRequest(e,s,a){var o,l,d;const p=await e,m=(o=p.maxRetries)!==null&&o!==void 0?o:this.maxRetries;s==null&&(s=m),await this.prepareOptions(p);const{req:y,url:x,timeout:v}=await this.buildRequest(p,{retryCount:m-s});await this.prepareRequest(y,{url:x,options:p});const S="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),I=a===void 0?"":`, retryOf: ${a}`,z=Date.now();if(ms(this).debug(`[${S}] sending request`,io({retryOfRequestLogID:a,method:p.method,url:x,options:p,headers:y.headers})),!((l=p.signal)===null||l===void 0)&&l.aborted)throw new Tg;const U=new AbortController,C=await this.fetchWithTimeout(x,y,v,U).catch(Sg),M=Date.now();if(C instanceof globalThis.Error){const F=`retrying, ${s} attempts remaining`;if(!((d=p.signal)===null||d===void 0)&&d.aborted)throw new Tg;const H=wg(C)||/timed? ?out/i.test(String(C)+("cause"in C?String(C.cause):""));if(s)return ms(this).info(`[${S}] connection ${H?"timed out":"failed"} - ${F}`),ms(this).debug(`[${S}] connection ${H?"timed out":"failed"} (${F})`,io({retryOfRequestLogID:a,url:x,durationMs:M-z,message:C.message})),this.retryRequest(p,s,a??S);throw ms(this).info(`[${S}] connection ${H?"timed out":"failed"} - error; no more retries left`),ms(this).debug(`[${S}] connection ${H?"timed out":"failed"} (error; no more retries left)`,io({retryOfRequestLogID:a,url:x,durationMs:M-z,message:C.message})),H?new MT:new Yf({cause:C})}const B=`[${S}${I}] ${y.method} ${x} ${C.ok?"succeeded":"failed"} with status ${C.status} in ${M-z}ms`;if(!C.ok){const F=await this.shouldRetry(C);if(s&&F){const E=`retrying, ${s} attempts remaining`;return await h4(C.body),ms(this).info(`${B} - ${E}`),ms(this).debug(`[${S}] response error (${E})`,io({retryOfRequestLogID:a,url:C.url,status:C.status,headers:C.headers,durationMs:M-z})),this.retryRequest(p,s,a??S,C.headers)}const H=F?"error; no more retries left":"error; not retryable";ms(this).info(`${B} - ${H}`);const q=await C.text().catch(E=>Sg(E).message),Y=a4(q),A=Y?void 0:q;throw ms(this).debug(`[${S}] response error (${H})`,io({retryOfRequestLogID:a,url:C.url,status:C.status,headers:C.headers,message:A,durationMs:Date.now()-z})),this.makeStatusError(C.status,Y,A,C.headers)}return ms(this).info(B),ms(this).debug(`[${S}] response start`,io({retryOfRequestLogID:a,url:C.url,status:C.status,headers:C.headers,durationMs:M-z})),{response:C,options:p,controller:U,requestLogID:S,retryOfRequestLogID:a,startTime:z}}async fetchWithTimeout(e,s,a,o){const l=s||{},{signal:d,method:p}=l,m=wf(l,["signal","method"]),y=this._makeAbort(o);d&&d.addEventListener("abort",y,{once:!0});const x=setTimeout(y,a),v=globalThis.ReadableStream&&m.body instanceof globalThis.ReadableStream||typeof m.body=="object"&&m.body!==null&&Symbol.asyncIterator in m.body,S=Object.assign(Object.assign(Object.assign({signal:o.signal},v?{duplex:"half"}:{}),{method:"GET"}),m);p&&(S.method=p.toUpperCase());try{return await this.fetch.call(void 0,e,S)}finally{clearTimeout(x)}}async shouldRetry(e){const s=e.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,s,a,o){var l;let d;const p=o==null?void 0:o.get("retry-after-ms");if(p){const y=parseFloat(p);Number.isNaN(y)||(d=y)}const m=o==null?void 0:o.get("retry-after");if(m&&!d){const y=parseFloat(m);Number.isNaN(y)?d=Date.parse(m)-Date.now():d=y*1e3}if(!(d&&0<=d&&d<60*1e3)){const y=(l=e.maxRetries)!==null&&l!==void 0?l:this.maxRetries;d=this.calculateDefaultRetryTimeoutMillis(s,y)}return await i4(d),this.makeRequest(e,s-1,a)}calculateDefaultRetryTimeoutMillis(e,s){const l=s-e,d=Math.min(.5*Math.pow(2,l),8),p=1-Math.random()*.25;return d*p*1e3}async buildRequest(e,{retryCount:s=0}={}){var a,o,l;const d=Object.assign({},e),{method:p,path:m,query:y,defaultBaseURL:x}=d,v=this.buildURL(m,y,x);"timeout"in d&&r4("timeout",d.timeout),d.timeout=(a=d.timeout)!==null&&a!==void 0?a:this.timeout;const{bodyHeaders:S,body:I}=this.buildBody({options:d}),z=await this.buildHeaders({options:e,method:p,bodyHeaders:S,retryCount:s});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:p,headers:z},d.signal&&{signal:d.signal}),globalThis.ReadableStream&&I instanceof globalThis.ReadableStream&&{duplex:"half"}),I&&{body:I}),(o=this.fetchOptions)!==null&&o!==void 0?o:{}),(l=d.fetchOptions)!==null&&l!==void 0?l:{}),url:v,timeout:d.timeout}}async buildHeaders({options:e,method:s,bodyHeaders:a,retryCount:o}){let l={};this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const d=await this.authHeaders(e);let p=Mc([l,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),u4()),this._options.defaultHeaders,a,e.headers,d]);return this.validateHeaders(p),p.values}_makeAbort(e){return()=>e.abort()}buildBody({options:{body:e,headers:s}}){if(!e)return{bodyHeaders:void 0,body:void 0};const a=Mc([s]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&a.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:f4(e)}:this.encoder({body:e,headers:a})}}Qf.DEFAULT_TIMEOUT=6e4;class es extends Qf{constructor(){super(...arguments),this.interactions=new ZT(this)}}JT=es;es.GeminiNextGenAPIClient=JT;es.GeminiNextGenAPIClientError=hr;es.APIError=xs;es.APIConnectionError=Yf;es.APIConnectionTimeoutError=MT;es.APIUserAbortError=Tg;es.NotFoundError=VT;es.ConflictError=zT;es.RateLimitError=FT;es.BadRequestError=DT;es.AuthenticationError=UT;es.InternalServerError=HT;es.PermissionDeniedError=PT;es.UnprocessableEntityError=BT;es.toFile=b4;es.Interactions=ZT;class j4 extends Error{constructor(e,s){super(e),this.name="ManualApiResponseError",this.prompt=s}}const k4=()=>{throw new Error("API_KEY_MISSING")},L4=n=>new Promise(e=>setTimeout(e,n));function M4(n){let e=n.trim();const s=e.indexOf("```json");if(s!==-1){const x=s+7,v=e.lastIndexOf("```");if(v>x)return e.substring(x,v).trim()}const a=e.indexOf("```");if(a!==-1){const x=a+3,v=e.lastIndexOf("```");if(v>x)return e.substring(x,v).trim()}const o=e.indexOf("{"),l=e.indexOf("[");let d=-1;if(o===-1?d=l:l===-1?d=o:d=Math.min(o,l),d===-1)return e;const p=e.lastIndexOf("}"),m=e.lastIndexOf("]"),y=Math.max(p,m);return y>d?e.substring(d,y+1):e}function D4(n,e){if(!n)return e;const s=M4(n);if(!s)return e;try{return JSON.parse(s)}catch(a){if(/[\u201C\u201D]/.test(s)){const d=s.replace(/"/g,'\\"').replace(/[\u201C\u201D]/g,'"');try{return JSON.parse(d)}catch{}}const o=s.replace(/[\u201C\u201D]/g,'"');try{return JSON.parse(o)}catch{}const l=o.replace(/,\s*([}\]])/g,"$1");try{return JSON.parse(l)}catch{if(/[\u201C\u201D]/.test(s)){const p=s.replace(/"/g,'\\"').replace(/[\u201C\u201D]/g,'"').replace(/,\s*([}\]])/g,"$1");try{return JSON.parse(p)}catch{}}return console.error("JSON Parse Failed:",a),e}}}const U4=()=>{const n=new Date().toISOString().split("T")[0];let e=yu("vocab_pro_api_usage",{count:0,date:"1970-01-01"});e.date!==n&&(e={count:0,date:n}),e.count+=1,e0("vocab_pro_api_usage",e),window.dispatchEvent(new CustomEvent("apiUsageUpdated"))};async function eA(n,e=3){var a;U4();let s;for(let o=0;o<=e;o++)try{return await k4().models.generateContent(n)}catch(l){s=l;const d=((a=l.message)==null?void 0:a.toLowerCase())||"";if(d.includes("api_key_missing"))throw l;if(d.includes("429")||d.includes("quota")||d.includes("exhausted")||d.includes("503")){if(o<e){await L4(Math.pow(2,o)*1e3);continue}throw new j4("API quota exceeded.",n.contents)}throw l}throw s}async function hM(n){const e=Tt(),s=Vk(n),a=await eA({model:e.ai.modelForBasicTasks,contents:s,config:{responseMimeType:"application/json",responseSchema:{type:lo.ARRAY,items:{type:lo.OBJECT,properties:{v1:{type:lo.STRING},v2:{type:lo.STRING},v3:{type:lo.STRING}},required:["v1","v2","v3"]}}}});return D4(a.text,[])}async function P4(n,e){Tt();const s=Hk();return(await eA({model:"gemini-2.5-flash-image",contents:{parts:[{inlineData:{mimeType:e,data:n}},{text:s}]}})).text||"No text detected."}var ym={exports:{}},sE;function V4(){return sE||(sE=1,(function(n){var e=(function(s){var a=Object.prototype,o=a.hasOwnProperty,l=Object.defineProperty||function(Q,X,j){Q[X]=j.value},d,p=typeof Symbol=="function"?Symbol:{},m=p.iterator||"@@iterator",y=p.asyncIterator||"@@asyncIterator",x=p.toStringTag||"@@toStringTag";function v(Q,X,j){return Object.defineProperty(Q,X,{value:j,enumerable:!0,configurable:!0,writable:!0}),Q[X]}try{v({},"")}catch{v=function(X,j,V){return X[j]=V}}function S(Q,X,j,V){var $=X&&X.prototype instanceof F?X:F,Z=Object.create($.prototype),ee=new G(V||[]);return l(Z,"_invoke",{value:D(Q,j,ee)}),Z}s.wrap=S;function I(Q,X,j){try{return{type:"normal",arg:Q.call(X,j)}}catch(V){return{type:"throw",arg:V}}}var z="suspendedStart",U="suspendedYield",C="executing",M="completed",B={};function F(){}function H(){}function q(){}var Y={};v(Y,m,function(){return this});var A=Object.getPrototypeOf,T=A&&A(A(ae([])));T&&T!==a&&o.call(T,m)&&(Y=T);var E=q.prototype=F.prototype=Object.create(Y);H.prototype=q,l(E,"constructor",{value:q,configurable:!0}),l(q,"constructor",{value:H,configurable:!0}),H.displayName=v(q,x,"GeneratorFunction");function R(Q){["next","throw","return"].forEach(function(X){v(Q,X,function(j){return this._invoke(X,j)})})}s.isGeneratorFunction=function(Q){var X=typeof Q=="function"&&Q.constructor;return X?X===H||(X.displayName||X.name)==="GeneratorFunction":!1},s.mark=function(Q){return Object.setPrototypeOf?Object.setPrototypeOf(Q,q):(Q.__proto__=q,v(Q,x,"GeneratorFunction")),Q.prototype=Object.create(E),Q},s.awrap=function(Q){return{__await:Q}};function N(Q,X){function j(Z,ee,pe,ie){var ce=I(Q[Z],Q,ee);if(ce.type==="throw")ie(ce.arg);else{var De=ce.arg,fe=De.value;return fe&&typeof fe=="object"&&o.call(fe,"__await")?X.resolve(fe.__await).then(function(Se){j("next",Se,pe,ie)},function(Se){j("throw",Se,pe,ie)}):X.resolve(fe).then(function(Se){De.value=Se,pe(De)},function(Se){return j("throw",Se,pe,ie)})}}var V;function $(Z,ee){function pe(){return new X(function(ie,ce){j(Z,ee,ie,ce)})}return V=V?V.then(pe,pe):pe()}l(this,"_invoke",{value:$})}R(N.prototype),v(N.prototype,y,function(){return this}),s.AsyncIterator=N,s.async=function(Q,X,j,V,$){$===void 0&&($=Promise);var Z=new N(S(Q,X,j,V),$);return s.isGeneratorFunction(X)?Z:Z.next().then(function(ee){return ee.done?ee.value:Z.next()})};function D(Q,X,j){var V=z;return function(Z,ee){if(V===C)throw new Error("Generator is already running");if(V===M){if(Z==="throw")throw ee;return ne()}for(j.method=Z,j.arg=ee;;){var pe=j.delegate;if(pe){var ie=O(pe,j);if(ie){if(ie===B)continue;return ie}}if(j.method==="next")j.sent=j._sent=j.arg;else if(j.method==="throw"){if(V===z)throw V=M,j.arg;j.dispatchException(j.arg)}else j.method==="return"&&j.abrupt("return",j.arg);V=C;var ce=I(Q,X,j);if(ce.type==="normal"){if(V=j.done?M:U,ce.arg===B)continue;return{value:ce.arg,done:j.done}}else ce.type==="throw"&&(V=M,j.method="throw",j.arg=ce.arg)}}}function O(Q,X){var j=X.method,V=Q.iterator[j];if(V===d)return X.delegate=null,j==="throw"&&Q.iterator.return&&(X.method="return",X.arg=d,O(Q,X),X.method==="throw")||j!=="return"&&(X.method="throw",X.arg=new TypeError("The iterator does not provide a '"+j+"' method")),B;var $=I(V,Q.iterator,X.arg);if($.type==="throw")return X.method="throw",X.arg=$.arg,X.delegate=null,B;var Z=$.arg;if(!Z)return X.method="throw",X.arg=new TypeError("iterator result is not an object"),X.delegate=null,B;if(Z.done)X[Q.resultName]=Z.value,X.next=Q.nextLoc,X.method!=="return"&&(X.method="next",X.arg=d);else return Z;return X.delegate=null,B}R(E),v(E,x,"Generator"),v(E,m,function(){return this}),v(E,"toString",function(){return"[object Generator]"});function ve(Q){var X={tryLoc:Q[0]};1 in Q&&(X.catchLoc=Q[1]),2 in Q&&(X.finallyLoc=Q[2],X.afterLoc=Q[3]),this.tryEntries.push(X)}function ye(Q){var X=Q.completion||{};X.type="normal",delete X.arg,Q.completion=X}function G(Q){this.tryEntries=[{tryLoc:"root"}],Q.forEach(ve,this),this.reset(!0)}s.keys=function(Q){var X=Object(Q),j=[];for(var V in X)j.push(V);return j.reverse(),function $(){for(;j.length;){var Z=j.pop();if(Z in X)return $.value=Z,$.done=!1,$}return $.done=!0,$}};function ae(Q){if(Q){var X=Q[m];if(X)return X.call(Q);if(typeof Q.next=="function")return Q;if(!isNaN(Q.length)){var j=-1,V=function $(){for(;++j<Q.length;)if(o.call(Q,j))return $.value=Q[j],$.done=!1,$;return $.value=d,$.done=!0,$};return V.next=V}}return{next:ne}}s.values=ae;function ne(){return{value:d,done:!0}}return G.prototype={constructor:G,reset:function(Q){if(this.prev=0,this.next=0,this.sent=this._sent=d,this.done=!1,this.delegate=null,this.method="next",this.arg=d,this.tryEntries.forEach(ye),!Q)for(var X in this)X.charAt(0)==="t"&&o.call(this,X)&&!isNaN(+X.slice(1))&&(this[X]=d)},stop:function(){this.done=!0;var Q=this.tryEntries[0],X=Q.completion;if(X.type==="throw")throw X.arg;return this.rval},dispatchException:function(Q){if(this.done)throw Q;var X=this;function j(ie,ce){return Z.type="throw",Z.arg=Q,X.next=ie,ce&&(X.method="next",X.arg=d),!!ce}for(var V=this.tryEntries.length-1;V>=0;--V){var $=this.tryEntries[V],Z=$.completion;if($.tryLoc==="root")return j("end");if($.tryLoc<=this.prev){var ee=o.call($,"catchLoc"),pe=o.call($,"finallyLoc");if(ee&&pe){if(this.prev<$.catchLoc)return j($.catchLoc,!0);if(this.prev<$.finallyLoc)return j($.finallyLoc)}else if(ee){if(this.prev<$.catchLoc)return j($.catchLoc,!0)}else if(pe){if(this.prev<$.finallyLoc)return j($.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(Q,X){for(var j=this.tryEntries.length-1;j>=0;--j){var V=this.tryEntries[j];if(V.tryLoc<=this.prev&&o.call(V,"finallyLoc")&&this.prev<V.finallyLoc){var $=V;break}}$&&(Q==="break"||Q==="continue")&&$.tryLoc<=X&&X<=$.finallyLoc&&($=null);var Z=$?$.completion:{};return Z.type=Q,Z.arg=X,$?(this.method="next",this.next=$.finallyLoc,B):this.complete(Z)},complete:function(Q,X){if(Q.type==="throw")throw Q.arg;return Q.type==="break"||Q.type==="continue"?this.next=Q.arg:Q.type==="return"?(this.rval=this.arg=Q.arg,this.method="return",this.next="end"):Q.type==="normal"&&X&&(this.next=X),B},finish:function(Q){for(var X=this.tryEntries.length-1;X>=0;--X){var j=this.tryEntries[X];if(j.finallyLoc===Q)return this.complete(j.completion,j.afterLoc),ye(j),B}},catch:function(Q){for(var X=this.tryEntries.length-1;X>=0;--X){var j=this.tryEntries[X];if(j.tryLoc===Q){var V=j.completion;if(V.type==="throw"){var $=V.arg;ye(j)}return $}}throw new Error("illegal catch attempt")},delegateYield:function(Q,X,j){return this.delegate={iterator:ae(Q),resultName:X,nextLoc:j},this.method==="next"&&(this.arg=d),B}},s})(n.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(ym)),ym.exports}var xm,rE;function D0(){return rE||(rE=1,xm=(n,e)=>`${n}-${e}-${Math.random().toString(16).slice(3,8)}`),xm}var bm,aE;function tA(){if(aE)return bm;aE=1;const n=D0();let e=0;return bm=({id:s,action:a,payload:o={}})=>{let l=s;return typeof l>"u"&&(l=n("Job",e),e+=1),{id:l,action:a,payload:o}},bm}var Dc={},iE;function U0(){if(iE)return Dc;iE=1;let n=!1;return Dc.logging=n,Dc.setLogging=e=>{n=e},Dc.log=(...e)=>n?console.log.apply(this,e):null,Dc}var vm,oE;function z4(){if(oE)return vm;oE=1;const n=tA(),{log:e}=U0(),s=D0();let a=0;return vm=()=>{const o=s("Scheduler",a),l={},d={};let p=[];a+=1;const m=()=>p.length,y=()=>Object.keys(l).length,x=()=>{if(p.length!==0){const U=Object.keys(l);for(let C=0;C<U.length;C+=1)if(typeof d[U[C]]>"u"){p[0](l[U[C]]);break}}},v=(U,C)=>new Promise((M,B)=>{const F=n({action:U,payload:C});p.push(async H=>{p.shift(),d[H.id]=F;try{M(await H[U].apply(this,[...C,F.id]))}catch(q){B(q)}finally{delete d[H.id],x()}}),e(`[${o}]: Add ${F.id} to JobQueue`),e(`[${o}]: JobQueue length=${p.length}`),x()});return{addWorker:U=>(l[U.id]=U,e(`[${o}]: Add ${U.id}`),e(`[${o}]: Number of workers=${y()}`),x(),U.id),addJob:async(U,...C)=>{if(y()===0)throw Error(`[${o}]: You need to have at least one worker before adding jobs`);return v(U,C)},terminate:async()=>{Object.keys(l).forEach(async U=>{await l[U].terminate()}),p=[]},getQueueLen:m,getNumWorkers:y}},vm}function B4(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var _m,lE;function F4(){if(lE)return _m;lE=1;function n(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}return _m=n,_m}var Em,cE;function H4(){if(cE)return Em;cE=1;const n=F4();return Em=e=>{const s={};return typeof WorkerGlobalScope<"u"?s.type="webworker":n()?s.type="electron":typeof document=="object"?s.type="browser":typeof process=="object"&&typeof B4=="function"&&(s.type="node"),typeof e>"u"?s:s[e]},Em}var wm,uE;function G4(){if(uE)return wm;uE=1;const e=H4()("type")==="browser"?s=>new URL(s,window.location.href).href:s=>s;return wm=s=>{const a={...s};return["corePath","workerPath","langPath"].forEach(o=>{s[o]&&(a[o]=e(a[o]))}),a},wm}var Sm,dE;function q4(){return dE||(dE=1,Sm=n=>{const e=[],s=[],a=[],o=[],l=[];return n.blocks&&n.blocks.forEach(d=>{d.paragraphs.forEach(p=>{p.lines.forEach(m=>{m.words.forEach(y=>{y.symbols.forEach(x=>{l.push({...x,page:n,block:d,paragraph:p,line:m,word:y})}),o.push({...y,page:n,block:d,paragraph:p,line:m})}),a.push({...m,page:n,block:d,paragraph:p})}),s.push({...p,page:n,block:d})}),e.push({...d,page:n})}),{...n,blocks:e,paragraphs:s,lines:a,words:o,symbols:l}}),Sm}var Tm,fE;function nA(){return fE||(fE=1,Tm={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),Tm}const $4="5.1.1",Y4={version:$4};var Am,hE;function W4(){return hE||(hE=1,Am={workerBlobURL:!0,logger:()=>{}}),Am}var Im,pE;function Q4(){if(pE)return Im;pE=1;const n=Y4.version;return Im={...W4(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${n}/dist/worker.min.js`},Im}var Nm,mE;function K4(){return mE||(mE=1,Nm=({workerPath:n,workerBlobURL:e})=>{let s;if(Blob&&URL&&e){const a=new Blob([`importScripts("${n}");`],{type:"application/javascript"});s=new Worker(URL.createObjectURL(a))}else s=new Worker(n);return s}),Nm}var Cm,gE;function Z4(){return gE||(gE=1,Cm=n=>{n.terminate()}),Cm}var Rm,yE;function X4(){return yE||(yE=1,Rm=(n,e)=>{n.onmessage=({data:s})=>{e(s)}}),Rm}var Om,xE;function J4(){return xE||(xE=1,Om=async(n,e)=>{n.postMessage(e)}),Om}var jm,bE;function e5(){if(bE)return jm;bE=1;const n=s=>new Promise((a,o)=>{const l=new FileReader;l.onload=()=>{a(l.result)},l.onerror=({target:{error:{code:d}}})=>{o(Error(`File could not be read! Code=${d}`))},l.readAsArrayBuffer(s)}),e=async s=>{let a=s;if(typeof s>"u")return"undefined";if(typeof s=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(s)?a=atob(s.split(",")[1]).split("").map(o=>o.charCodeAt(0)):a=await(await fetch(s)).arrayBuffer();else if(typeof HTMLElement<"u"&&s instanceof HTMLElement)s.tagName==="IMG"&&(a=await e(s.src)),s.tagName==="VIDEO"&&(a=await e(s.poster)),s.tagName==="CANVAS"&&await new Promise(o=>{s.toBlob(async l=>{a=await n(l),o()})});else if(typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas){const o=await s.convertToBlob();a=await n(o)}else(s instanceof File||s instanceof Blob)&&(a=await n(s));return new Uint8Array(a)};return jm=e,jm}var km,vE;function t5(){if(vE)return km;vE=1;const n=Q4(),e=K4(),s=Z4(),a=X4(),o=J4(),l=e5();return km={defaultOptions:n,spawnWorker:e,terminateWorker:s,onMessage:a,send:o,loadImage:l},km}var Lm,_E;function sA(){if(_E)return Lm;_E=1;const n=G4(),e=q4(),s=tA(),{log:a}=U0(),o=D0(),l=nA(),{defaultOptions:d,spawnWorker:p,terminateWorker:m,onMessage:y,loadImage:x,send:v}=t5();let S=0;return Lm=async(I="eng",z=l.LSTM_ONLY,U={},C={})=>{const M=o("Worker",S),{logger:B,errorHandler:F,...H}=n({...d,...U}),q={},Y={},A=typeof I=="string"?I.split("+"):I;let T=z,E=C;const R=[l.DEFAULT,l.LSTM_ONLY].includes(z)&&!H.legacyCore;let N,D;const O=new Promise((Ee,Ae)=>{D=Ee,N=Ae}),ve=Ee=>{N(Ee.message)};let ye=p(H);ye.onerror=ve,S+=1;const G=(Ee,Ae)=>{q[Ee]=Ae},ae=(Ee,Ae)=>{Y[Ee]=Ae},ne=({id:Ee,action:Ae,payload:Ge})=>new Promise((Ue,Ke)=>{a(`[${M}]: Start ${Ee}, action=${Ae}`);const Nt=`${Ae}-${Ee}`;G(Nt,Ue),ae(Nt,Ke),v(ye,{workerId:M,jobId:Ee,action:Ae,payload:Ge})}),Q=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),X=Ee=>ne(s({id:Ee,action:"load",payload:{options:{lstmOnly:R,corePath:H.corePath,logging:H.logging}}})),j=(Ee,Ae,Ge)=>ne(s({id:Ge,action:"FS",payload:{method:"writeFile",args:[Ee,Ae]}})),V=(Ee,Ae)=>ne(s({id:Ae,action:"FS",payload:{method:"readFile",args:[Ee,{encoding:"utf8"}]}})),$=(Ee,Ae)=>ne(s({id:Ae,action:"FS",payload:{method:"unlink",args:[Ee]}})),Z=(Ee,Ae,Ge)=>ne(s({id:Ge,action:"FS",payload:{method:Ee,args:Ae}})),ee=()=>console.warn("`loadLanguage` is depreciated and should be removed from code (workers now come with language pre-loaded)"),pe=(Ee,Ae)=>ne(s({id:Ae,action:"loadLanguage",payload:{langs:Ee,options:{langPath:H.langPath,dataPath:H.dataPath,cachePath:H.cachePath,cacheMethod:H.cacheMethod,gzip:H.gzip,lstmOnly:[l.DEFAULT,l.LSTM_ONLY].includes(T)&&!H.legacyLang}}})),ie=()=>console.warn("`initialize` is depreciated and should be removed from code (workers now come pre-initialized)"),ce=(Ee,Ae,Ge,Ue)=>ne(s({id:Ue,action:"initialize",payload:{langs:Ee,oem:Ae,config:Ge}})),De=(Ee="eng",Ae,Ge,Ue)=>{if(R&&[l.TESSERACT_ONLY,l.TESSERACT_LSTM_COMBINED].includes(Ae))throw Error("Legacy model requested but code missing.");const Ke=Ae||T;T=Ke;const Nt=Ge||E;E=Nt;const oe=(typeof Ee=="string"?Ee.split("+"):Ee).filter(Ve=>!A.includes(Ve));return A.push(...oe),oe.length>0?pe(oe,Ue).then(()=>ce(Ee,Ke,Nt,Ue)):ce(Ee,Ke,Nt,Ue)},fe=(Ee={},Ae)=>ne(s({id:Ae,action:"setParameters",payload:{params:Ee}})),Se=async(Ee,Ae={},Ge={blocks:!0,text:!0,hocr:!0,tsv:!0},Ue)=>ne(s({id:Ue,action:"recognize",payload:{image:await x(Ee),options:Ae,output:Ge}})),Oe=(Ee="Tesseract OCR Result",Ae=!1,Ge)=>(console.log("`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead."),ne(s({id:Ge,action:"getPDF",payload:{title:Ee,textonly:Ae}}))),me=async(Ee,Ae)=>{if(R)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return ne(s({id:Ae,action:"detect",payload:{image:await x(Ee)}}))},ue=async()=>(ye!==null&&(m(ye),ye=null),Promise.resolve());y(ye,({workerId:Ee,jobId:Ae,status:Ge,action:Ue,data:Ke})=>{const Nt=`${Ue}-${Ae}`;if(Ge==="resolve"){a(`[${Ee}]: Complete ${Ae}`);let Pe=Ke;Ue==="recognize"?Pe=e(Ke):Ue==="getPDF"&&(Pe=Array.from({...Ke,length:Object.keys(Ke).length})),q[Nt]({jobId:Ae,data:Pe})}else if(Ge==="reject")if(Y[Nt](Ke),Ue==="load"&&N(Ke),F)F(Ke);else throw Error(Ke);else Ge==="progress"&&B({...Ke,userJobId:Ae})});const ge={id:M,worker:ye,setResolve:G,setReject:ae,load:Q,writeText:j,readText:V,removeFile:$,FS:Z,loadLanguage:ee,initialize:ie,reinitialize:De,setParameters:fe,recognize:Se,getPDF:Oe,detect:me,terminate:ue};return X().then(()=>pe(I)).then(()=>ce(I,z,C)).then(()=>D(ge)).catch(()=>{}),O},Lm}var Mm,EE;function n5(){if(EE)return Mm;EE=1;const n=sA();return Mm={recognize:async(a,o,l)=>{const d=await n(o,1,l);return d.recognize(a).finally(async()=>{await d.terminate()})},detect:async(a,o)=>{const l=await n("osd",0,o);return l.detect(a).finally(async()=>{await l.terminate()})}},Mm}var Dm,wE;function s5(){return wE||(wE=1,Dm={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),Dm}var Um,SE;function r5(){return SE||(SE=1,Um={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),Um}var Pm,TE;function a5(){if(TE)return Pm;TE=1,V4();const n=z4(),e=sA(),s=n5(),a=s5(),o=nA(),l=r5(),{setLogging:d}=U0();return Pm={languages:a,OEM:o,PSM:l,createScheduler:n,createWorker:e,setLogging:d,...s},Pm}var i5=a5();async function AE(n){const e=await i5.createWorker("eng");try{const s=await e.recognize(n);return await e.terminate(),s.data.text}catch(s){throw await e.terminate(),s}}const o5=()=>{const[n,e]=L.useState(null),[s,a]=L.useState(""),[o,l]=L.useState(!1),[d,p]=L.useState(!1),[m,y]=L.useState(!1),[x,v]=L.useState("cloud"),S=L.useRef(null),{showToast:I}=kr();qn.useEffect(()=>{const B=F=>{var q;const H=(q=F.clipboardData)==null?void 0:q.items;if(H){for(let Y=0;Y<H.length;Y++)if(H[Y].type.indexOf("image")!==-1){const A=H[Y].getAsFile();A&&z(A);break}}};return document.addEventListener("paste",B),()=>document.removeEventListener("paste",B)},[]);const z=B=>{const F=new FileReader;F.onload=H=>{var q;typeof((q=H.target)==null?void 0:q.result)=="string"&&(e(H.target.result),a(""),p(!1))},F.readAsDataURL(B)},U=B=>{var H;const F=(H=B.target.files)==null?void 0:H[0];F&&z(F)},C=async()=>{if(n){l(!0),p(!1);try{if(x==="offline"){p(!0);const B=await AE(n);a(B)}else try{const B=n.split(",")[1],F=n.split(";")[0].split(":")[1],H=await P4(B,F);a(H)}catch(B){console.warn("Online extraction failed, attempting offline fallback...",B),p(!0);const F=await AE(n);a(F),I("Used offline mode (Cloud unavailable).","info")}}catch(B){console.error(B),I("Extraction failed.","error")}finally{l(!1)}}},M=async()=>{s&&(await Gf(s),y(!0),I("Text copied!","success"),setTimeout(()=>y(!1),2e3))};return u.jsxs("div",{className:"flex flex-col h-full space-y-6",children:[u.jsx("div",{className:"space-y-2 shrink-0",children:n?u.jsxs("div",{className:"relative rounded-3xl overflow-hidden border border-neutral-200 bg-neutral-100 flex justify-center max-h-[300px]",children:[u.jsx("img",{src:n,alt:"Preview",className:"max-w-full object-contain"}),u.jsx("button",{onClick:()=>{e(null),a(""),p(!1)},className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-black/70 backdrop-blur-sm transition-all",children:u.jsx(jn,{size:16})})]}):u.jsxs("div",{onClick:()=>{var B;return(B=S.current)==null?void 0:B.click()},className:"border-2 border-dashed border-neutral-200 rounded-3xl p-10 flex flex-col items-center justify-center text-neutral-400 hover:border-indigo-400 hover:text-indigo-500 hover:bg-indigo-50/30 transition-all cursor-pointer min-h-[200px]",children:[u.jsx(Ug,{size:40,className:"mb-4"}),u.jsx("p",{className:"font-bold text-sm",children:"Click to upload or paste image (Ctrl+V)"}),u.jsx("input",{type:"file",ref:S,className:"hidden",accept:"image/*",onChange:U})]})}),u.jsxs("div",{className:"flex justify-center gap-3 shrink-0",children:[u.jsxs("button",{onClick:()=>v("cloud"),className:`flex items-center gap-2 px-4 py-2 rounded-xl text-xs font-bold transition-all border ${x==="cloud"?"bg-indigo-50 border-indigo-200 text-indigo-700 shadow-sm":"bg-white border-neutral-200 text-neutral-500 hover:bg-neutral-50"}`,children:[u.jsx(DE,{size:14}),u.jsx("span",{children:"Cloud (Best)"})]}),u.jsxs("button",{onClick:()=>v("offline"),className:`flex items-center gap-2 px-4 py-2 rounded-xl text-xs font-bold transition-all border ${x==="offline"?"bg-emerald-50 border-emerald-200 text-emerald-700 shadow-sm":"bg-white border-neutral-200 text-neutral-500 hover:bg-neutral-50"}`,children:[u.jsx(yv,{size:14}),u.jsx("span",{children:"Offline"})]})]}),u.jsx("div",{className:"flex justify-center shrink-0",children:u.jsx("button",{onClick:C,disabled:!n||o,className:`px-8 py-3 rounded-xl font-black text-xs uppercase tracking-widest transition-all shadow-lg flex items-center gap-2 ${o?"bg-neutral-800 text-neutral-300":"bg-neutral-900 text-white hover:bg-neutral-800"} disabled:opacity-50`,children:o?u.jsxs(u.Fragment,{children:[u.jsx(mn,{size:16,className:"animate-spin"}),u.jsx("span",{children:"Processing..."})]}):u.jsxs(u.Fragment,{children:[u.jsx(fI,{size:16}),u.jsx("span",{children:"Extract Text"})]})})}),s&&u.jsxs("div",{className:"space-y-2 animate-in slide-in-from-bottom-4 fade-in duration-500 flex-1 flex flex-col min-h-0",children:[u.jsxs("div",{className:"flex justify-between items-center px-1 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Result"}),d&&u.jsxs("span",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-neutral-100 text-neutral-500 rounded text-[9px] font-bold border border-neutral-200",children:[u.jsx(yv,{size:10})," Offline Result"]})]}),u.jsxs("button",{onClick:M,className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-wider transition-all ${m?"bg-green-100 text-green-700":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}`,children:[m?u.jsx(wr,{size:12}):u.jsx(Rg,{size:12}),u.jsx("span",{children:m?"Copied":"Copy"})]})]}),u.jsx("textarea",{value:s,readOnly:!0,className:"w-full flex-1 p-4 bg-neutral-50 border border-neutral-200 rounded-2xl text-sm font-medium text-neutral-800 resize-none focus:outline-none focus:ring-2 focus:ring-neutral-900"})]})]})},l5=({audioBlob:n,onTrim:e,onCancel:s})=>{const a=L.useRef(null),[o,l]=L.useState(null),[d,p]=L.useState(null),[m,y]=L.useState(0),[x,v]=L.useState(1),[S,I]=L.useState(!1),z=L.useRef(null);L.useEffect(()=>((async()=>{const H=new(window.AudioContext||window.webkitAudioContext),q=await n.arrayBuffer(),Y=await H.decodeAudioData(q);l(H),p(Y),U(Y,0,1)})(),()=>{o&&o.close()}),[n]);const U=(F,H,q)=>{const Y=a.current;if(!Y)return;const A=Y.getContext("2d");if(!A)return;const T=Y.width,E=Y.height;A.clearRect(0,0,T,E);const R=F.getChannelData(0),N=Math.ceil(R.length/T),D=E/2;A.fillStyle="#e5e7eb",A.fillRect(0,0,T,E),A.fillStyle="#6366f1",A.beginPath();for(let ye=0;ye<T;ye++){let G=1,ae=-1;for(let ne=0;ne<N;ne++){const Q=R[ye*N+ne];Q<G&&(G=Q),Q>ae&&(ae=Q)}A.fillRect(ye,(1+G)*D,1,Math.max(1,(ae-G)*D))}A.fillStyle="rgba(0, 0, 0, 0.4)";const O=H*T,ve=q*T;A.fillRect(0,0,O,E),A.fillRect(ve,0,T-ve,E),A.fillStyle="#ef4444",A.fillRect(O-2,0,4,E),A.fillRect(ve-2,0,4,E)};L.useEffect(()=>{d&&U(d,m,x)},[m,x,d]);const C=()=>{var T;if(!o||!d)return;if(S){(T=z.current)==null||T.stop(),I(!1);return}const F=d.duration,H=F*m,Y=F*x-H,A=o.createBufferSource();A.buffer=d,A.connect(o.destination),A.start(0,H,Y),A.onended=()=>I(!1),z.current=A,I(!0)},M=async()=>{if(!o||!d)return;const{bufferToWav:F}=await bs(async()=>{const{bufferToWav:E}=await Promise.resolve().then(()=>cL);return{bufferToWav:E}},void 0),H=Math.floor(m*d.length),q=Math.floor(x*d.length),Y=q-H,A=o.createBuffer(d.numberOfChannels,Y,d.sampleRate);for(let E=0;E<d.numberOfChannels;E++){const R=d.getChannelData(E);A.getChannelData(E).set(R.subarray(H,q))}const T=F(A);e(T)},B=F=>{const H=a.current;if(!H)return;const q=H.getBoundingClientRect(),Y=F.clientX-q.left,A=Math.max(0,Math.min(1,Y/q.width)),T=Math.abs(A-m),E=Math.abs(A-x),R=T<E,N=O=>{const ve=O.clientX-q.left,ye=Math.max(0,Math.min(1,ve/q.width));R?y(Math.min(ye,x-.05)):v(Math.max(ye,m+.05))},D=()=>{window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",D)};window.addEventListener("mousemove",N),window.addEventListener("mouseup",D)};return u.jsxs("div",{className:"flex flex-col gap-4 p-4 bg-white rounded-2xl border border-neutral-200",children:[u.jsx("div",{className:"relative h-24 bg-neutral-100 rounded-xl overflow-hidden cursor-pointer",onMouseDown:B,children:u.jsx("canvas",{ref:a,width:600,height:100,className:"w-full h-full"})}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 bg-neutral-900 text-white rounded-xl text-xs font-bold uppercase tracking-wider hover:bg-neutral-800 transition-all",children:[S?u.jsx(kg,{size:14}):u.jsx(hu,{size:14}),S?"Stop":"Preview"]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:s,className:"px-4 py-2 text-neutral-500 hover:text-neutral-900 font-bold text-xs",children:"Cancel"}),u.jsxs("button",{onClick:M,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-xl text-xs font-bold uppercase tracking-wider hover:bg-indigo-500 transition-all",children:[u.jsx(SI,{size:14})," Trim & Use"]})]})]}),u.jsx("p",{className:"text-[10px] text-neutral-400 text-center",children:"Drag the red bars to trim audio."})]})},c5=()=>{const n=Tt(),e=Vn(n),{showToast:s}=kr(),[a,o]=L.useState({}),[l,d]=L.useState(!1),[p,m]=L.useState(null),[y,x]=L.useState(null),[v,S]=L.useState(""),[I,z]=L.useState(""),[U,C]=L.useState(!1),[M,B]=L.useState(null),[F,H]=L.useState(""),[q,Y]=L.useState([]),[A,T]=L.useState(!1),[E,R]=L.useState(null),N=L.useRef(null),[D,O]=L.useState(!1),[ve,ye]=L.useState(null),[G,ae]=L.useState(!1),ne=L.useRef(null),Q=async()=>{try{const me=await fetch(`${e}/api/audio/mappings`);if(me.ok){const ue=await me.json();o(ue);const ge=Object.keys(ue);ge.length>0&&!v&&S(ge[0]),ge.length>0&&!M&&(B(ge[0]),X(ge[0],""))}}catch(me){console.error("Failed to fetch mappings",me)}};L.useEffect(()=>{Q()},[e]),L.useEffect(()=>()=>{N.current&&(N.current.pause(),N.current=null)},[]);const X=async(me,ue="")=>{T(!0),Y([]);try{const ge=encodeURIComponent(ue),Ee=await fetch(`${e}/api/audio/files/${me}?path=${ge}`);if(Ee.ok){const Ae=await Ee.json();Y(Ae.items),H(Ae.currentPath)}else s("Failed to load files","error")}catch{s("Connection error","error")}finally{T(!1)}},j=me=>{B(me),S(me),H(""),X(me,"")},V=me=>{if(!M)return;const ue=F?`${F}/${me}`:me;X(M,ue)},$=()=>{if(!M||!F)return;const me=F.split("/");me.pop();const ue=me.join("/");X(M,ue)},Z=(me,ue)=>{me.stopPropagation(),M&&ye(ue)},ee=async()=>{if(!M||!ve)return;ae(!0);const me=F?`${F}/${ve}`:ve;try{const ge=await(await fetch(`${e}/api/audio/file?mapName=${encodeURIComponent(M)}&filename=${encodeURIComponent(me)}`,{method:"DELETE"})).json();ge.success?(s("File deleted","success"),X(M,F)):s(ge.error||"Delete failed","error")}catch{s("Server error","error")}finally{ae(!1),ye(null)}},pe=async()=>{await R0(),d(!0),m(null),x(null)},ie=async()=>{const me=await O0();if(d(!1),me){const ue=atob(me.base64),ge=new Array(ue.length);for(let Ge=0;Ge<ue.length;Ge++)ge[Ge]=ue.charCodeAt(Ge);const Ee=new Uint8Array(ge),Ae=new Blob([Ee],{type:me.mimeType});m(Ae),x(Ae)}},ce=me=>{var ge;const ue=(ge=me.target.files)==null?void 0:ge[0];ue&&(m(ue),x(ue),z(ue.name))},De=async()=>{if(!y||!v||!I){s("Please select audio, target folder, and filename.","error");return}C(!0);const me=new FormData;me.append("mapName",v),me.append("filename",I),me.append("audio",y,I);try{const ge=await(await fetch(`${e}/api/audio/upload`,{method:"POST",body:me})).json();ge.success?(s("Audio uploaded successfully!","success"),m(null),x(null),z(""),M===v&&X(v,F)):s(ge.error||"Upload failed","error")}catch{s("Upload error","error")}finally{C(!1)}},fe=me=>{if(!M)return"";const ue=F?`${F}/${me}`:me;return`${e}/api/audio/stream/${M}/${ue}`},Se=(me,ue)=>{me.stopPropagation();const ge=fe(ue);ge&&(Gf(ge),s("Audio URL copied!","success"))},Oe=me=>{var Ee;const ue=fe(me);if(!ue)return;if(E===ue&&D){(Ee=N.current)==null||Ee.pause(),O(!1);return}N.current&&N.current.pause();const ge=new Audio(ue);N.current=ge,R(ue),ge.play().then(()=>O(!0)).catch(()=>{s("Failed to play audio","error"),O(!1)}),ge.onended=()=>O(!1),ge.onerror=()=>{O(!1),R(null)}};return u.jsxs("div",{className:"flex flex-col h-full gap-4",children:[u.jsx("div",{className:"shrink-0 bg-white p-4 rounded-2xl border border-neutral-200 shadow-sm",children:p?u.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-top-2",children:[u.jsx(l5,{audioBlob:p,onTrim:me=>{x(me),s("Trimmed!","success")},onCancel:()=>{m(null),x(null)}}),u.jsxs("div",{className:"p-4 bg-neutral-50 rounded-xl border border-neutral-200 space-y-3",children:[u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsxs("select",{value:v,onChange:me=>S(me.target.value),className:"w-full px-3 py-2 rounded-xl border border-neutral-200 text-xs font-bold bg-white focus:ring-2 focus:ring-neutral-900 outline-none",children:[u.jsx("option",{value:"",children:"Target Folder..."}),Object.keys(a).map(me=>u.jsx("option",{value:me,children:me},me))]}),u.jsx("input",{value:I,onChange:me=>z(me.target.value),placeholder:"filename.wav",className:"w-full px-3 py-2 rounded-xl border border-neutral-200 text-xs font-bold bg-white focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>{m(null),x(null)},className:"flex-1 py-2.5 bg-white border border-neutral-200 text-neutral-500 rounded-xl font-bold text-xs hover:bg-neutral-50 transition-all",children:"Cancel"}),u.jsxs("button",{onClick:De,disabled:U||!v||!I,className:"flex-[2] py-2.5 bg-neutral-900 text-white rounded-xl font-black text-xs uppercase tracking-widest hover:bg-neutral-800 disabled:opacity-50 transition-all flex items-center justify-center gap-2",children:[U?u.jsx(mn,{size:14,className:"animate-spin"}):u.jsx(YE,{size:14}),u.jsx("span",{children:"Save"})]})]})]})]}):u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("button",{onClick:l?ie:pe,className:`flex items-center justify-center gap-2 p-3 rounded-xl border transition-all ${l?"bg-red-50 border-red-200 text-red-600 animate-pulse":"bg-neutral-50 border-neutral-200 text-neutral-600 hover:bg-white hover:border-indigo-300 hover:text-indigo-600"}`,children:[u.jsx(Ao,{size:20}),u.jsx("span",{className:"font-bold text-xs",children:l?"Stop Recording":"Record Voice"})]}),u.jsxs("button",{onClick:()=>{var me;return(me=ne.current)==null?void 0:me.click()},className:"flex items-center justify-center gap-2 p-3 rounded-xl border bg-neutral-50 border-neutral-200 text-neutral-600 transition-all hover:bg-white hover:border-indigo-300 hover:text-indigo-600",children:[u.jsx(Ug,{size:20}),u.jsx("span",{className:"font-bold text-xs",children:"Upload File"}),u.jsx("input",{type:"file",ref:ne,className:"hidden",accept:"audio/*",onChange:ce})]})]})}),u.jsxs("div",{className:"flex-1 flex flex-col min-h-0 bg-neutral-50 rounded-2xl border border-neutral-200 overflow-hidden",children:[u.jsxs("div",{className:"p-3 border-b border-neutral-200 bg-white space-y-2 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("select",{value:M||"",onChange:me=>j(me.target.value),className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-xl text-xs font-bold text-neutral-700 outline-none focus:ring-2 focus:ring-neutral-900",children:[u.jsx("option",{value:"",disabled:!0,children:"Select Folder..."}),Object.keys(a).map(me=>u.jsx("option",{value:me,children:me},me))]}),u.jsx("div",{className:"flex-1 flex items-center gap-1 overflow-hidden",children:F&&u.jsxs(u.Fragment,{children:[u.jsx(cf,{size:14,className:"text-neutral-300 shrink-0"}),u.jsx("span",{className:"text-xs font-mono text-neutral-500 truncate",title:F,children:F})]})}),M&&u.jsx("button",{onClick:()=>X(M,F),className:"p-2 hover:bg-neutral-100 rounded-full transition-colors",children:u.jsx(Rl,{size:14,className:A?"animate-spin":""})})]}),F&&u.jsxs("button",{onClick:$,className:"flex items-center gap-1.5 px-3 py-1.5 bg-neutral-100 text-neutral-600 rounded-lg text-[10px] font-bold hover:bg-neutral-200 transition-colors w-fit",children:[u.jsx(UE,{size:12})," Up One Level"]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-2 custom-scrollbar",children:A?u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-neutral-400 space-y-2",children:[u.jsx(mn,{size:24,className:"animate-spin"}),u.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Loading..."})]}):q.length===0?u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-neutral-400 space-y-2",children:[u.jsx(uI,{size:32,className:"opacity-20"}),u.jsx("p",{className:"text-xs font-medium",children:"Empty folder."})]}):u.jsx("div",{className:"grid grid-cols-1 gap-1",children:q.map((me,ue)=>{if(me.type==="directory")return u.jsxs("div",{onClick:()=>V(me.name),className:"flex items-center justify-between p-2 rounded-lg hover:bg-white hover:shadow-sm border border-transparent hover:border-neutral-100 transition-all cursor-pointer group",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"p-2 rounded-full bg-blue-50 text-blue-500",children:u.jsx(PE,{size:14,fill:"currentColor"})}),u.jsx("span",{className:"text-xs font-bold text-neutral-700 truncate",children:me.name})]}),u.jsx(cf,{size:14,className:"text-neutral-300 group-hover:text-neutral-500"})]},`${me.name}-${ue}`);{const ge=E==null?void 0:E.endsWith(`/${encodeURIComponent(me.name)}`);return u.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-white hover:shadow-sm border border-transparent hover:border-neutral-100 transition-all group",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0 cursor-pointer flex-1",onClick:()=>Oe(me.name),children:[u.jsx("button",{className:`p-2 rounded-full transition-colors ${ge&&D?"bg-indigo-100 text-indigo-600":"bg-neutral-100 text-neutral-500 hover:bg-neutral-200 hover:text-neutral-900"}`,children:ge&&D?u.jsx(kg,{size:12,fill:"currentColor"}):u.jsx(hu,{size:12,fill:"currentColor"})}),u.jsx("span",{className:`text-xs font-medium truncate ${ge?"text-indigo-700 font-bold":"text-neutral-700"}`,children:me.name})]}),u.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[u.jsx("button",{onClick:Ee=>Se(Ee,me.name),className:"p-1.5 text-neutral-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-colors",title:"Copy URL",children:u.jsx(Rg,{size:12})}),M==="Upload_Audio"&&u.jsx("button",{onClick:Ee=>Z(Ee,me.name),className:"p-1.5 text-neutral-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:u.jsx(Mg,{size:12})})]})]},`${me.name}-${ue}`)}})})})]}),u.jsx(Eg,{isOpen:!!ve,title:"Delete Audio File",message:`Are you sure you want to delete "${ve}"? This action cannot be undone.`,confirmText:"Delete",cancelText:"Cancel",onConfirm:ee,onClose:()=>ye(null),isLoading:G})]})},u5=()=>{const n=Tt(),e=Vn(n),{showToast:s}=kr(),[a,o]=L.useState({}),[l,d]=L.useState(null),[p,m]=L.useState(""),[y,x]=L.useState([]),[v,S]=L.useState(!1),[I,z]=L.useState(!1),U=L.useRef(null),C=async()=>{try{const E=await fetch(`${e}/api/audio/mappings`);if(E.ok){const R=await E.json();o(R);const N=Object.keys(R),D=N.find(O=>O.toLowerCase()==="image"||O.toLowerCase()==="images"||O.toLowerCase()==="icon")||N[0];D&&!l&&(d(D),M(D,""))}}catch(E){console.error("Failed to fetch mappings",E)}};L.useEffect(()=>{C()},[e]);const M=async(E,R="")=>{S(!0),x([]);try{const N=encodeURIComponent(R),D=await fetch(`${e}/api/images/files/${E}?path=${N}`);if(D.ok){const O=await D.json();x(O.items),m(O.currentPath)}else s("Failed to load images","error")}catch{s("Connection error","error")}finally{S(!1)}},B=E=>{d(E),m(""),M(E,"")},F=E=>{if(!l)return;const R=p?`${p}/${E}`:E;M(l,R)},H=()=>{if(!l||!p)return;const E=p.split("/");E.pop();const R=E.join("/");M(l,R)},q=async(E,R)=>{if(E.stopPropagation(),!l)return;const N=p?`${p}/${R}`:R;try{const O=await(await fetch(`${e}/api/images/file?mapName=${encodeURIComponent(l)}&filename=${encodeURIComponent(N)}`,{method:"DELETE"})).json();O.success?(s("File deleted","success"),M(l,p)):s(O.error||"Delete failed","error")}catch{s("Server error","error")}},Y=E=>{if(!l)return"";const R=p?`${p}/${E}`:E;return`${e}/api/images/stream/${l}/${R}`},A=(E,R)=>{E.stopPropagation();const N=Y(R);N&&(Gf(N),s("Image URL copied!","success"))},T=async E=>{var D;const R=(D=E.target.files)==null?void 0:D[0];if(!R||!l)return;z(!0);const N=new FormData;N.append("mapName",l),p?`${p}${R.name}`:R.name,N.append("filename",R.name),N.append("image",R);try{const ve=await(await fetch(`${e}/api/images/upload`,{method:"POST",body:N})).json();ve.success?(s("Image uploaded!","success"),M(l,"")):s(ve.error||"Upload failed","error")}catch{s("Upload error","error")}finally{z(!1),U.current&&(U.current.value="")}};return u.jsx("div",{className:"flex flex-col h-full gap-4",children:u.jsxs("div",{className:"flex-1 flex flex-col min-h-0 bg-neutral-50 rounded-2xl border border-neutral-200 overflow-hidden",children:[u.jsxs("div",{className:"p-3 border-b border-neutral-200 bg-white space-y-2 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("select",{value:l||"",onChange:E=>B(E.target.value),className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-xl text-xs font-bold text-neutral-700 outline-none focus:ring-2 focus:ring-neutral-900",children:[u.jsx("option",{value:"",disabled:!0,children:"Select Folder..."}),Object.keys(a).map(E=>u.jsx("option",{value:E,children:E},E))]}),u.jsx("div",{className:"flex-1 flex items-center gap-1 overflow-hidden",children:p&&u.jsxs(u.Fragment,{children:[u.jsx(cf,{size:14,className:"text-neutral-300 shrink-0"}),u.jsx("span",{className:"text-xs font-mono text-neutral-500 truncate",title:p,children:p})]})}),l&&u.jsx("button",{onClick:()=>M(l,p),className:"p-2 hover:bg-neutral-100 rounded-full transition-colors",children:u.jsx(Rl,{size:14,className:v?"animate-spin":""})})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[p?u.jsxs("button",{onClick:H,className:"flex items-center gap-1.5 px-3 py-1.5 bg-neutral-100 text-neutral-600 rounded-lg text-[10px] font-bold hover:bg-neutral-200 transition-colors w-fit",children:[u.jsx(UE,{size:12})," Up One Level"]}):u.jsx("div",{}),l&&u.jsxs("button",{onClick:()=>{var E;return(E=U.current)==null?void 0:E.click()},disabled:I,className:"flex items-center gap-1.5 px-3 py-1.5 bg-indigo-600 text-white rounded-lg text-[10px] font-bold hover:bg-indigo-700 transition-colors shadow-sm disabled:opacity-50",children:[I?u.jsx(mn,{size:12,className:"animate-spin"}):u.jsx(Ug,{size:12}),u.jsx("span",{children:"Upload Image"}),u.jsx("input",{type:"file",ref:U,className:"hidden",accept:"image/*",onChange:T})]})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:v?u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-neutral-400 space-y-2",children:[u.jsx(mn,{size:24,className:"animate-spin"}),u.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Loading..."})]}):y.length===0?u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-neutral-400 space-y-2",children:[u.jsx(FE,{size:32,className:"opacity-20"}),u.jsx("p",{className:"text-xs font-medium",children:"Empty folder."})]}):u.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:[y.filter(E=>E.type==="directory").map((E,R)=>u.jsxs("div",{onClick:()=>F(E.name),className:"aspect-square rounded-xl bg-blue-50 border border-blue-100 flex flex-col items-center justify-center cursor-pointer hover:bg-blue-100 transition-colors gap-2",children:[u.jsx(PE,{size:32,className:"text-blue-400"}),u.jsx("span",{className:"text-xs font-bold text-blue-800 truncate px-2 max-w-full",children:E.name})]},`dir-${R}`)),y.filter(E=>E.type==="file").map((E,R)=>{const N=Y(E.name);return u.jsxs("div",{className:"group relative aspect-square rounded-xl bg-white border border-neutral-200 overflow-hidden shadow-sm hover:shadow-md transition-all",children:[u.jsx("div",{className:"absolute inset-0 bg-neutral-100 flex items-center justify-center",children:u.jsx("img",{src:N,alt:E.name,className:"w-full h-full object-cover",loading:"lazy"})}),u.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2 p-2",children:[u.jsx("p",{className:"text-[10px] text-white font-medium truncate w-full text-center mb-1",children:E.name}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:D=>A(D,E.name),className:"p-2 bg-white text-indigo-600 rounded-full hover:bg-indigo-50 transition-colors",title:"Copy URL",children:u.jsx(Rg,{size:14})}),u.jsx("button",{onClick:D=>q(D,E.name),className:"p-2 bg-white text-red-600 rounded-full hover:bg-red-50 transition-colors",title:"Delete",children:u.jsx(Mg,{size:14})})]})]})]},`file-${R}`)})]})})]})})},d5=({user:n})=>{const{showToast:e}=kr(),[s,a]=L.useState(""),[o,l]=L.useState([]),[d,p]=L.useState(!1),[m,y]=L.useState("note"),[x,v]=L.useState({}),S=()=>{const M=s.split(`
`).map(B=>B.trim()).filter(Boolean).map(B=>{const[F,...H]=B.split(":");return!F||H.length===0?null:{word:F.trim(),meaning:H.join(":").trim()}}).filter(B=>B!==null);l(M),I(M)},I=async C=>{const M={};for(const B of C){const F=B.word.trim();F&&(M[F]="checking")}v(M);for(const B of C){const F=B.word.trim();if(!F)continue;const H=await au(n.id,F);M[F]=H?"update":"create",v({...M})}},z=(C,M,B)=>{const F=[...o];F[C][M]=B,l(F)},U=async()=>{if(o.length!==0)try{p(!0);const C=[],M=Date.now();for(const B of o){const F=B.word.trim();if(!F)continue;const H=await au(n.id,F);if(H){const q={...H,updatedAt:M};q[m]=B.meaning.trim(),C.push(q)}else{const q=await Jg(F,"","","","",[],!1,!1,!1,!1,!1,"manual");q.userId=n.id,q.updatedAt=M,q[m]=B.meaning.trim(),C.push(q)}}await sS(C),e("Words updated successfully.","success")}catch(C){console.error(C),e("Failed to update words.","error")}finally{p(!1)}};return u.jsxs("div",{className:"w-full h-full flex flex-col gap-4 p-4 text-sm overflow-auto",children:[u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsx("label",{className:"font-semibold text-neutral-700",children:"Paste raw text (format: word: field_content)"}),u.jsx("textarea",{value:s,onChange:C=>a(C.target.value),placeholder:`campsite: a place where people stay in tents
dog: an animal`,className:"w-full h-32 border border-neutral-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"}),u.jsx("button",{onClick:S,className:"self-start px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition",children:"Parse"})]}),o.length>0&&u.jsxs("div",{className:"flex flex-col gap-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-neutral-700",children:"Update field:"}),u.jsxs("select",{value:m,onChange:C=>y(C.target.value),className:"border border-neutral-300 rounded px-2 py-1",children:[u.jsx("option",{value:"note",children:"Note"}),u.jsx("option",{value:"meaningVi",children:"Meaning (Vietnamese)"}),u.jsx("option",{value:"example",children:"Example"})]})]}),u.jsxs("table",{className:"w-full border border-neutral-300 text-sm",children:[u.jsx("thead",{className:"bg-neutral-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"border px-2 py-1 text-left",children:"Word"}),u.jsx("th",{className:"border px-2 py-1 text-center w-28",children:"Status"}),u.jsx("th",{className:"border px-2 py-1 text-left",children:m==="meaningVi"?"Meaning (Vietnamese)":m==="example"?"Example":"Note"})]})}),u.jsx("tbody",{children:o.map((C,M)=>{var B,F,H,q;return u.jsxs("tr",{children:[u.jsx("td",{className:"border px-2 py-1",children:u.jsx("input",{value:C.word,onChange:Y=>z(M,"word",Y.target.value),className:"w-full outline-none"})}),u.jsxs("td",{className:"border px-2 py-1 text-center text-xs",children:[x[(B=C.word)==null?void 0:B.trim()]==="update"&&u.jsx("span",{className:"text-blue-600 font-medium",children:"To be updated"}),x[(F=C.word)==null?void 0:F.trim()]==="create"&&u.jsx("span",{className:"text-green-600 font-medium",children:"To be created"}),(!x[(H=C.word)==null?void 0:H.trim()]||x[(q=C.word)==null?void 0:q.trim()]==="checking")&&u.jsx("span",{className:"text-neutral-500",children:"Checking..."})]}),u.jsx("td",{className:"border px-2 py-1",children:u.jsx("input",{value:C.meaning,onChange:Y=>z(M,"meaning",Y.target.value),className:"w-full outline-none"})})]},M)})})]}),u.jsx("button",{onClick:U,disabled:d,className:"self-end mt-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition disabled:opacity-50",children:d?"Updating...":"Update"})]})]})},f5=({isOpen:n,onClose:e,user:s})=>{const[a,o]=L.useState("WORD_LIBRARY");if(!n)return null;const l=[{id:"WORD_LIBRARY",label:"Word Library",icon:gI},{id:"OCR",label:"Image to Text",icon:wI},{id:"IMAGES",label:"Image Manager",icon:FE},{id:"AUDIO",label:"Audio Tool",icon:Ao}];return u.jsx("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-4xl rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col h-[85vh]",children:[u.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-center shrink-0",children:[u.jsx("div",{className:"flex gap-2 p-1 bg-neutral-100 rounded-xl",children:l.map(d=>{const p=d.icon;return u.jsxs("button",{onClick:()=>o(d.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-lg text-xs font-black uppercase tracking-wider transition-all ${a===d.id?"bg-white text-neutral-900 shadow-sm":"text-neutral-500 hover:text-neutral-700"}`,children:[u.jsx(p,{size:16}),u.jsx("span",{children:d.label})]},d.id)})}),u.jsx("button",{onClick:e,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full transition-colors",children:u.jsx(jn,{size:24})})]}),u.jsxs("main",{className:"flex-1 overflow-y-auto p-6 md:p-8",children:[a==="WORD_LIBRARY"&&u.jsx(d5,{user:s}),a==="OCR"&&u.jsx(o5,{}),a==="IMAGES"&&u.jsx(u5,{}),a==="AUDIO"&&u.jsx(c5,{})]})]})})},h5=1e3,p5=300,IE=n=>{if(!Array.isArray(n)||n.length===0)return[];const e=new Map,s=[],a=o=>{const l=String(o||"").toLowerCase();return/\bnoun\b/.test(l)?"NOUN":/\bverb\b/.test(l)?"VERB":/\badjective\b/.test(l)?"ADJECTIVE":/\badverb\b/.test(l)?"ADVERB":/\bpronoun\b/.test(l)?"PRONOUN":/\bpreposition\b/.test(l)?"PREPOSITION":/\bconjunction\b/.test(l)?"CONJUNCTION":/\binterjection\b/.test(l)?"INTERJECTION":String(o||"").replace(/\s+/g," ").trim().toUpperCase()||"N/A"};for(const o of n){const l=a(o.partOfSpeech);e.has(l)||(e.set(l,{headword:o.headword||null,partOfSpeech:l,ipaUs:null,ipaUk:null,audioUs:null,audioUk:null}),s.push(l));const d=e.get(l);!d.headword&&o.headword&&(d.headword=o.headword),!d.ipaUs&&o.ipaUs&&(d.ipaUs=o.ipaUs),!d.ipaUk&&o.ipaUk&&(d.ipaUk=o.ipaUk),!d.audioUs&&o.audioUs&&(d.audioUs=o.audioUs),!d.audioUk&&o.audioUk&&(d.audioUk=o.audioUk)}return s.map(o=>e.get(o)).filter(o=>o.ipaUs||o.ipaUk||o.audioUs||o.audioUk)},NE={woman_teacher:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/People/Woman%20Teacher.png",bg:"bg-indigo-50"},man_teacher:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/People/Man%20Teacher.png",bg:"bg-blue-50"},fox:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Fox.png",bg:"bg-orange-100"},koala:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Koala.png",bg:"bg-teal-100"},pet:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Cat%20Face.png",bg:"bg-pink-100"},owl:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Owl.png",bg:"bg-yellow-100"},panda:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Panda.png",bg:"bg-emerald-100"},unicorn:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Unicorn.png",bg:"bg-purple-100"}},m5=({user:n,onViewWord:e,isAnyModalOpen:s})=>{const{showToast:a}=kr(),[o,l]=L.useState(Tt()),[d,p]=L.useState(Fc()),[m,y]=L.useState(Hc()),[x,v]=L.useState(Gc()),[S,I]=L.useState(!1),[z,U]=L.useState(of()),[C,M]=L.useState({currentTime:0,duration:0}),[B,F]=L.useState([]),[H,q]=L.useState(0),[Y,A]=L.useState(!1),[T,E]=L.useState(null),[R,N]=L.useState(!1),[D,O]=L.useState(null),[ve,ye]=L.useState(null),[G,ae]=L.useState(!1),[ne,Q]=L.useState(!1),[X,j]=L.useState(!1),V=L.useRef(null),$=L.useRef(null),Z=L.useRef(null),ee=L.useRef(null),pe=L.useRef(null),ie=L.useRef(!1),ce=L.useRef(""),De=L.useRef(null),fe=L.useRef(null),Se=L.useRef(!1),Oe=L.useRef(null),me=L.useRef({word:"",at:0}),ue=o.audioCoach.activeCoach,ge=o.audioCoach.coaches[ue],Ee=Ae(ge.avatar);function Ae(be){return be.startsWith("http")||be.startsWith("data:")?{url:be,bg:"bg-white border-2 border-neutral-100"}:NE[be]||NE.woman_teacher}const Ge=async be=>{if(!be||!n.id)return;const Le=await au(n.id,be);ae(!!Le)};L.useEffect(()=>{Se.current=Y},[Y]),L.useEffect(()=>{if(d&&!x){pe.current&&(window.clearTimeout(pe.current),pe.current=null),I(!0);return}pe.current&&window.clearTimeout(pe.current),pe.current=window.setTimeout(()=>{I(!1),pe.current=null},260)},[d,x]),L.useEffect(()=>{Oe.current=T},[T]),L.useEffect(()=>{const be=()=>l(Tt()),Le=rt=>{const Me=rt.detail,st=typeof(Me==null?void 0:Me.isSpeaking)=="boolean"?Me.isSpeaking:Fc(),ht=typeof(Me==null?void 0:Me.isAudioPaused)=="boolean"?Me.isAudioPaused:Hc(),Xe=typeof(Me==null?void 0:Me.isSingleWordPlayback)=="boolean"?Me.isSingleWordPlayback:Gc(),Dt=typeof(Me==null?void 0:Me.playbackRate)=="number"?Me.playbackRate:of();if(U(Dt),st){ee.current&&(window.clearTimeout(ee.current),ee.current=null),p(!0),y(ht),v(Xe);return}ee.current&&window.clearTimeout(ee.current),ee.current=window.setTimeout(()=>{p(Fc()),y(Hc()),v(Gc()),ee.current=null},180)},Ne=rt=>{var vs,_s,Xt,$n,na,qs;const Me=rt,st=(_s=(vs=Me.detail)==null?void 0:vs.word)==null?void 0:_s.trim(),ht=(Xt=Me.detail)==null?void 0:Xt.data;if(!st||!(ht!=null&&ht.exists))return;const Xe=st.toLowerCase(),Dt=(qs=(na=($n=Oe.current)==null?void 0:$n.cambridge)==null?void 0:na.word)==null?void 0:qs.trim().toLowerCase();if(Se.current&&Dt===Xe){Z.current&&(window.clearTimeout(Z.current),Z.current=null);const sa=Date.now();me.current={word:Xe,at:sa};return}const vt=Date.now(),ln=me.current;ln.word===Xe&&vt-ln.at<500||(ce.current=Xe,N(!1),ye(null),E({actionLabel:"Go to Cambridge",actionUrl:ht.url,cambridge:{word:ht.word||Xe,pronunciations:IE(ht.pronunciations)},icon:u.jsx(Kp,{size:18,className:"text-blue-500"})}),me.current={word:Xe,at:vt},A(!0))},yt=rt=>{var vt,ln,vs,_s,Xt,$n;const Me=rt,st=(ln=(vt=Me.detail)==null?void 0:vt.word)==null?void 0:ln.trim(),ht=(vs=Me.detail)==null?void 0:vs.ipa;if(!st||!ht)return;const Xe=st.toLowerCase(),Dt=($n=(Xt=(_s=Oe.current)==null?void 0:_s.cambridge)==null?void 0:Xt.word)==null?void 0:$n.trim().toLowerCase();Se.current&&Dt===Xe||(ce.current=Xe,N(!1),ye(null),E({text:`**IPA:** ${ht}`,icon:u.jsx(Qp,{size:18,className:"text-purple-500"})}),me.current={word:Xe,at:Date.now()},A(!0))};return window.addEventListener("config-updated",be),window.addEventListener("audio-status-changed",Le),window.addEventListener("coach-cambridge-lookup-request",Ne),window.addEventListener("coach-ipa-fallback-request",yt),p(Fc()),y(Hc()),v(Gc()),U(of()),()=>{ee.current&&(window.clearTimeout(ee.current),ee.current=null),pe.current&&(window.clearTimeout(pe.current),pe.current=null),window.removeEventListener("config-updated",be),window.removeEventListener("audio-status-changed",Le),window.removeEventListener("coach-cambridge-lookup-request",Ne),window.removeEventListener("coach-ipa-fallback-request",yt),fe.current&&(fe.current.pause(),fe.current=null)}},[]),L.useEffect(()=>{if(!o.interface.rightClickCommandEnabled)return;const be=rt=>{if(!rt||rt.rangeCount===0)return;const Me=rt.toString().trim();if(!Me)return;const st=rt.getRangeAt(0).cloneRange(),ht=st.getBoundingClientRect(),Xe=ht.top>250?"top":"bottom";ce.current=Me,De.current=st,ye({x:ht.left+ht.width/2,y:Xe==="top"?ht.top:ht.bottom,placement:Xe}),E(null),A(!0),Ge(Me)},Le=rt=>{const Me=window.getSelection();!Me||!Me.toString().trim()||(rt.preventDefault(),be(Me))},Ne=rt=>{if(Y)return;const Me=window.getSelection();if(!Me||Me.rangeCount===0||!Me.toString().trim())return;const Xe=Me.getRangeAt(0).getBoundingClientRect(),Dt=rt.clientX,vt=rt.clientY;Dt>=Xe.left&&Dt<=Xe.right&&vt>=Xe.top&&vt<=Xe.bottom&&be(Me)},yt=rt=>{const Me=rt.target,st=!V.current||!V.current.contains(Me),ht=!$.current||!$.current.contains(Me);st&&ht&&(A(!1),ye(null))};return document.addEventListener("contextmenu",Le),document.addEventListener("click",Ne),document.addEventListener("mousedown",yt),()=>{document.removeEventListener("contextmenu",Le),document.removeEventListener("click",Ne),document.removeEventListener("mousedown",yt)}},[o.interface.rightClickCommandEnabled,o.server,n.id,Y]);const Ue=async()=>{var Ne,yt;const be=ce.current||((Ne=window.getSelection())==null?void 0:Ne.toString().trim());if(!be)return;if(Su(be)==="vi"){E({text:be,icon:u.jsx(gv,{size:18,className:"text-blue-500"})}),A(!0),as(be,!1,"vi",ge.viVoice,ge.viAccent);return}N(!0),A(!1),ye(null);try{const Me=await(await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(be)}&langpair=en|vi`)).json();if((yt=Me==null?void 0:Me.responseData)!=null&&yt.translatedText){const st=Me.responseData.translatedText;E({text:st,icon:u.jsx(gv,{size:18,className:"text-blue-500"})}),A(!0),as(st,!1,"vi",ge.viVoice,ge.viAccent)}}catch{a("Translation error!","error")}finally{N(!1)}},Ke=async()=>{var Le;const be=ce.current||((Le=window.getSelection())==null?void 0:Le.toString().trim());if(be){be.length>h5?a("Text is too long to read!","error"):as(be,!1,"en",ge.enVoice,ge.enAccent),N(!0),A(!1),ye(null);try{const Ne=be.toLowerCase();if(Ne.split(/\s+/).filter(Boolean).length===1){const ht=Vn(o),Xe=await fetch(`${ht}/api/lookup/cambridge/simple?word=${encodeURIComponent(Ne)}`,{cache:"no-store"});if(Xe.ok){const Dt=await Xe.text(),vt=Dt?JSON.parse(Dt):null;if(vt!=null&&vt.exists){E({actionLabel:"Go to Cambridge",actionUrl:vt.url,cambridge:{word:vt.word||Ne,pronunciations:IE(vt.pronunciations)},icon:u.jsx(Kp,{size:18,className:"text-blue-500"})}),A(!0),N(!1);return}}}const rt=fi().find(ht=>ht.word.toLowerCase()===Ne);if(rt&&rt.ipaUs){E({text:`**IPA:** ${rt.ipaUs}`,icon:u.jsx(Qp,{size:18,className:"text-emerald-500"})}),A(!0),N(!1);return}const Me=Vn(o),st=await fetch(`${Me}/api/convert/ipa?text=${encodeURIComponent(be)}&mode=2`);if(st.ok){const ht=await st.json();E({text:`**IPA:** ${ht.ipa}`,icon:u.jsx(Qp,{size:18,className:"text-purple-500"})}),A(!0)}}catch{}finally{N(!1)}}},Nt=async()=>{var Le;const be=ce.current||((Le=window.getSelection())==null?void 0:Le.toString().trim());if(be&&!(!be||G)){Q(!0);try{let Ne,yt=null;try{const rt=await AN([be]);rt.length>0&&(yt=rt[0])}catch{}yt?(Ne={...yt,id:crypto.randomUUID?crypto.randomUUID():"id-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),userId:n.id,createdAt:Date.now(),updatedAt:Date.now(),quality:Yt.REFINED,source:"refine",nextReview:Date.now(),interval:0,easeFactor:2.5,consecutiveCorrect:0,forgotCount:0,lastReview:void 0,lastGrade:void 0,lastTestResults:{},groups:[...yt.groups||[],"coach-added"]},Ne.isPassive=!1,Ne.complexity=Mr(Ne),Ne.masteryScore=Rs(Ne),Ne.gameEligibility=Lr(Ne)):(Ne={...Jg(be,"","","","",["coach-added"],!1,!1,!1,!1,be.includes(" ")),userId:n.id,quality:Yt.RAW},Ne.isPassive=!1),await jf(Ne),a(`"${be}" added!`,"success"),ae(!0),A(!1),ye(null)}catch{a("Add error!","error")}finally{Q(!1)}}},Pe=async()=>{var Ne;const be=ce.current||((Ne=window.getSelection())==null?void 0:Ne.toString().trim());if(!be||!n.id||!e||s)return;const Le=await au(n.id,be);Le&&(A(!1),ye(null),e(Le))},oe=()=>{var Le;const be=ce.current||((Le=window.getSelection())==null?void 0:Le.toString().trim());A(!1),ye(null),be&&be.length>p5?(a("Selection too long for mimic!","error"),O(null)):O(be||"")},Ve=()=>{A(!1),ye(null),j(!0)},lt=()=>{var yt;const be=ce.current||((yt=window.getSelection())==null?void 0:yt.toString().trim());if(!be)return;const Le=`Example in English sentence for "${be}"`,Ne=encodeURIComponent(Le);window.open(`https://www.google.com/search?q=${Ne}`,"_blank"),A(!1),ye(null)},ct=be=>{if(!be){a("Audio not available.","info");return}try{const Le=be.startsWith("http")?be:`${Vn(o)}${be.startsWith("/")?"":"/"}${be}`;fe.current&&(fe.current.pause(),fe.current=null);const Ne=new Audio(Le);fe.current=Ne,Ne.onerror=()=>a("Failed to play Cambridge audio.","error"),Ne.onended=()=>{fe.current===Ne&&(fe.current=null)},Ne.play().catch(()=>a("Failed to play Cambridge audio.","error"))}catch{a("Failed to play Cambridge audio.","error")}},nt=()=>{ie.current=!0,Z.current&&(window.clearTimeout(Z.current),Z.current=null),A(!0)},pt=()=>{var be;ie.current=!1,Z.current&&window.clearTimeout(Z.current),Z.current=window.setTimeout(()=>{A(!1),Z.current=null},(be=Oe.current)!=null&&be.cambridge?3e3:300)};L.useEffect(()=>{if(!(!Y||!(T!=null&&T.cambridge))&&!ie.current)return Z.current&&window.clearTimeout(Z.current),Z.current=window.setTimeout(()=>{ie.current||(A(!1),Z.current=null)},3e3),()=>{Z.current&&(window.clearTimeout(Z.current),Z.current=null)}},[Y,T]);const qt=()=>u.jsx("div",{ref:V,className:"bg-white/95 backdrop-blur-xl p-1.5 rounded-[1.8rem] shadow-2xl border border-neutral-200 flex flex-col gap-1 w-[160px] animate-in fade-in zoom-in-95 duration-200",children:u.jsxs("div",{className:"grid grid-cols-6 gap-1",children:[u.jsx("button",{type:"button",onClick:Ue,className:"col-span-2 aspect-square bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center hover:bg-indigo-100 transition-all active:scale-90 shadow-sm font-black text-xs",title:"Ting Vit",children:"VI"}),G?u.jsx("button",{type:"button",onClick:Pe,disabled:s,className:"col-span-2 aspect-square bg-sky-50 text-sky-600 rounded-2xl flex items-center justify-center hover:bg-sky-100 transition-all active:scale-90 shadow-sm",title:"View Word Details",children:u.jsx(ru,{size:15})}):u.jsx("button",{type:"button",onClick:Nt,disabled:ne,className:"col-span-2 aspect-square bg-green-50 text-green-600 rounded-2xl flex items-center justify-center hover:bg-green-100 transition-all active:scale-90 shadow-sm",title:"Add to Library",children:ne?u.jsx(mn,{size:14,className:"animate-spin"}):u.jsx(Xr,{size:15})}),u.jsx("button",{type:"button",onClick:Ke,className:"col-span-2 aspect-square bg-purple-50 text-purple-600 rounded-2xl flex items-center justify-center hover:bg-purple-100 transition-all active:scale-90 shadow-sm",title:"Read & Phonetics (EN)",children:u.jsx(Sr,{size:15})}),u.jsx("button",{type:"button",onClick:oe,className:"col-span-2 aspect-square bg-amber-50 text-amber-500 rounded-2xl flex items-center justify-center hover:bg-amber-100 transition-all active:scale-95 shadow-sm",title:"Mimic Practice",children:u.jsx(Ao,{size:15})}),u.jsx("button",{type:"button",onClick:Ve,className:"col-span-2 aspect-square bg-rose-50 text-rose-500 rounded-2xl flex items-center justify-center hover:bg-rose-100 transition-all active:scale-95 shadow-sm",title:"Coach Tools",children:u.jsx(LI,{size:15})}),u.jsx("button",{type:"button",onClick:lt,className:"col-span-2 aspect-square bg-blue-50 text-blue-600 rounded-2xl flex items-center justify-center hover:bg-blue-100 transition-all active:scale-95 shadow-sm",title:"Search Google Examples",children:u.jsx(Kp,{size:15})})]})}),Pt=be=>{const Le=new RegExp("\\*\\*(.*?)\\*\\*","g");return be.replace(Le,"<strong>$1</strong>").replace(/\n/g,"<br/>")};L.useEffect(()=>{let be;return d?(F(TT()),be=setInterval(()=>{const Le=OT();Le&&M(Le)},100)):(M({currentTime:0,duration:0}),F([]),y(!1),v(!1)),()=>clearInterval(be)},[d]);const Os=be=>{const Le=parseFloat(be.target.value);xl(Le),M(Ne=>({...Ne,currentTime:Le}))},kn=be=>{const Le=Math.floor(be/60),Ne=Math.floor(be%60);return`${Le}:${Ne.toString().padStart(2,"0")}`},Zt=()=>{const be=[.6,.7,.8,.9,1,1.25,1.5],Le=be.findIndex(yt=>Math.abs(yt-z)<.001),Ne=be[(Le+1)%be.length];AT(Ne),U(Ne)};return u.jsxs(u.Fragment,{children:[Y&&ve&&u.jsx("div",{className:"fixed z-[2147483647]",style:{left:`${ve.x}px`,top:`${ve.y}px`,transform:ve.placement==="top"?"translate(-50%, -100%) translateY(-10px)":"translate(-50%, 0) translateY(10px)"},children:u.jsx(qt,{})}),u.jsx("div",{className:"fixed bottom-0 left-6 z-[2147483646] flex flex-col items-start pointer-events-none",children:u.jsx("div",{className:"flex flex-col items-center pointer-events-auto group pb-0 pt-10",onMouseEnter:nt,onMouseLeave:pt,children:u.jsxs("div",{className:"relative",children:[Y&&!ve&&u.jsx("div",{className:"absolute bottom-16 left-0 z-50 animate-in fade-in slide-in-from-bottom-2 duration-200",children:T?u.jsxs("div",{ref:$,className:"bg-white p-5 rounded-[2.5rem] shadow-2xl border border-neutral-200 w-[26rem] relative",children:[u.jsx("button",{onClick:()=>{E(null),A(!1),ye(null)},className:"absolute top-4 right-4 text-neutral-300 hover:text-neutral-900",children:u.jsx(jn,{size:14})}),u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"shrink-0 mt-1",children:T.icon||u.jsx(jg,{size:18})}),u.jsxs("div",{className:"text-xs font-medium text-neutral-700 leading-relaxed space-y-2",children:[T.cambridge?u.jsx("div",{className:"space-y-4",children:Array.isArray(T.cambridge.wordFamily)&&T.cambridge.wordFamily.length>0?T.cambridge.wordFamily.map((be,Le)=>u.jsx("div",{className:"space-y-2",children:u.jsx("div",{className:"grid grid-cols-2 gap-2",children:(be.pronunciations||[]).map((Ne,yt)=>u.jsxs("div",{className:"rounded-lg border border-neutral-200 bg-neutral-50 p-2 space-y-1.5",children:[Ne.headword&&u.jsx("p",{className:"text-[11px] font-extrabold text-indigo-700 break-words",children:Ne.headword}),u.jsx("p",{className:"text-[10px] font-black uppercase tracking-wide text-neutral-500",children:Ne.partOfSpeech||"N/A"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>ct(Ne.audioUs||void 0),disabled:!Ne.audioUs,className:`px-2 py-0.5 text-[9px] font-black uppercase rounded-md border transition-colors ${Ne.audioUs?"bg-indigo-50 text-indigo-700 border-indigo-100 hover:bg-indigo-100":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed"}`,children:"US"}),u.jsx("p",{className:"text-[11px] text-neutral-700 leading-relaxed flex-1 break-words",children:Ne.ipaUs?`/${Ne.ipaUs}/`:"N/A"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>ct(Ne.audioUk||void 0),disabled:!Ne.audioUk,className:`px-2 py-0.5 text-[9px] font-black uppercase rounded-md border transition-colors ${Ne.audioUk?"bg-emerald-50 text-emerald-700 border-emerald-100 hover:bg-emerald-100":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed"}`,children:"UK"}),u.jsx("p",{className:"text-[11px] text-neutral-700 leading-relaxed flex-1 break-words",children:Ne.ipaUk?`/${Ne.ipaUk}/`:"N/A"})]})]},yt))})},Le)):u.jsx("div",{className:"space-y-2",children:u.jsx("div",{className:"grid grid-cols-2 gap-2",children:(T.cambridge.pronunciations||[]).map((be,Le)=>u.jsxs("div",{className:"rounded-lg border border-neutral-200 bg-neutral-50 p-2 space-y-1.5",children:[be.headword&&u.jsx("p",{className:"text-[11px] font-extrabold text-indigo-700 break-words",children:be.headword}),u.jsx("p",{className:"text-[10px] font-black uppercase tracking-wide text-neutral-500",children:be.partOfSpeech||"N/A"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>ct(be.audioUs||void 0),disabled:!be.audioUs,className:`px-2 py-0.5 text-[9px] font-black uppercase rounded-md border transition-colors ${be.audioUs?"bg-indigo-50 text-indigo-700 border-indigo-100 hover:bg-indigo-100":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed"}`,children:"US"}),u.jsx("p",{className:"text-[11px] text-neutral-700 leading-relaxed flex-1 break-words",children:be.ipaUs?`/${be.ipaUs}/`:"N/A"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>ct(be.audioUk||void 0),disabled:!be.audioUk,className:`px-2 py-0.5 text-[9px] font-black uppercase rounded-md border transition-colors ${be.audioUk?"bg-emerald-50 text-emerald-700 border-emerald-100 hover:bg-emerald-100":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed"}`,children:"UK"}),u.jsx("p",{className:"text-[11px] text-neutral-700 leading-relaxed flex-1 break-words",children:be.ipaUk?`/${be.ipaUk}/`:"N/A"})]})]},Le))})})}):(()=>{const be=T.text||"",Le=be.startsWith("IPA:"),Ne=Le?be.replace(/^IPA:\s*/,""):be;return u.jsxs(u.Fragment,{children:[Le&&u.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"IPA:"}),u.jsx("div",{style:{lineHeight:"1.6"},dangerouslySetInnerHTML:{__html:Pt(Ne.replace(/\s+\//g,"<br/>/"))}})]})})(),T.actionUrl&&u.jsx("button",{type:"button",onClick:()=>window.open(T.actionUrl,"_blank"),className:"px-3 py-1.5 text-[10px] font-black uppercase tracking-wide rounded-lg bg-blue-50 text-blue-700 border border-blue-100 hover:bg-blue-100 transition-colors",children:T.actionLabel||"Open"})]})]})]}):u.jsx(qt,{})}),u.jsx("button",{onClick:be=>{S&&(be.stopPropagation(),ST())},className:`w-14 h-14 rounded-2xl flex items-center justify-center transition-all duration-300 transform shadow-2xl relative z-10 ${Ee.bg} ${Y?"ring-4 ring-white":"hover:scale-110 mb-1"}`,children:R?u.jsx(mn,{size:20,className:"animate-spin text-neutral-400"}):u.jsxs(u.Fragment,{children:[u.jsx("img",{src:Ee.url,className:`w-10 h-10 object-contain ${S?"opacity-30 scale-90 blur-[1px]":""}`,alt:"Coach"}),S&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-indigo-600 animate-in fade-in zoom-in duration-200",children:u.jsx(Lg,{size:24,fill:"currentColor"})})]})}),S&&u.jsxs("div",{className:"absolute left-16 bottom-2 flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 bg-white/90 backdrop-blur-md px-3 sm:px-4 py-2 rounded-2xl shadow-xl border border-neutral-200 animate-in fade-in slide-in-from-left-4 duration-300 pointer-events-auto w-[calc(100vw-6rem)] sm:w-auto max-w-[95vw] sm:max-w-none",onMouseEnter:nt,onMouseLeave:pt,children:[u.jsx("span",{className:"text-[10px] font-mono text-neutral-500 tabular-nums w-8",children:C.duration>0?kn(C.currentTime):"--:--"}),u.jsx("input",{type:"range",min:"0",max:C.duration>0?C.duration:1,step:"0.1",value:C.duration>0?C.currentTime:0,onChange:Os,disabled:C.duration<=0,className:"flex-1 h-1.5 bg-neutral-100 rounded-full appearance-none cursor-pointer accent-indigo-600 hover:accent-indigo-700 transition-all"}),u.jsx("span",{className:"text-[10px] font-mono text-neutral-400 tabular-nums w-8",children:C.duration>0?kn(C.duration):"--:--"}),u.jsxs("div",{className:"flex flex-wrap sm:flex-nowrap items-center gap-2 w-full",children:[u.jsx("button",{onClick:()=>{const be=Math.max(0,C.currentTime-5);xl(be),M(Le=>({...Le,currentTime:be}))},className:"w-6 h-6 rounded-lg bg-neutral-50 text-neutral-700 hover:bg-neutral-100 transition-colors flex items-center justify-center border border-neutral-200",title:"Rewind 5 seconds",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M7 8L13 12V4L7 8ZM3 8L9 12V4L3 8Z",fill:"currentColor"})})}),u.jsx("button",{onClick:()=>{const be=Math.min(C.duration,C.currentTime+5);xl(be),M(Le=>({...Le,currentTime:be}))},className:"w-6 h-6 rounded-lg bg-neutral-50 text-neutral-700 hover:bg-neutral-100 transition-colors flex items-center justify-center border border-neutral-200",title:"Forward 5 seconds",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M9 8L3 4V12L9 8ZM13 8L7 4V12L13 8Z",fill:"currentColor"})})}),u.jsx("button",{onClick:()=>{m?NT().catch(()=>a("Cannot resume audio.","error")):IT()},className:"w-6 h-6 rounded-lg bg-indigo-50 text-indigo-600 hover:bg-indigo-100 transition-colors flex items-center justify-center border border-indigo-100",title:m?"Resume audio":"Pause audio",children:m?u.jsx(hu,{size:12,fill:"currentColor"}):u.jsx(kg,{size:12,fill:"currentColor"})}),u.jsxs("button",{onClick:Zt,className:"h-6 px-2 rounded-lg bg-neutral-50 text-neutral-700 hover:bg-neutral-100 transition-colors flex items-center justify-center border border-neutral-200 text-[10px] font-black tabular-nums",title:"Playback speed",children:[z.toFixed(z%1===0?1:2),"x"]}),B.length>0&&C.duration>0&&u.jsx("div",{className:"flex items-center gap-1 ml-1 border-l border-neutral-200 pl-2",children:B.map((be,Le)=>u.jsx("button",{onClick:()=>{xl(be),M(Ne=>({...Ne,currentTime:be}))},className:"w-5 h-5 flex items-center justify-center rounded-full bg-indigo-50 text-indigo-600 text-[10px] font-bold hover:bg-indigo-600 hover:text-white transition-colors border border-indigo-100",title:`Jump to ${kn(be)}`,children:Le+1},Le))}),u.jsxs("div",{className:"flex items-center gap-1 border-l border-neutral-200 pl-1 pr-0 ml-0",children:[u.jsx("button",{onClick:()=>q(C.currentTime),className:"w-6 h-6 rounded-lg bg-yellow-50 text-yellow-700 hover:bg-yellow-100 transition-colors flex items-center justify-center border border-yellow-200",title:"Mark current time",children:u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"8",cy:"8",r:"6",stroke:"currentColor",strokeWidth:"2"}),u.jsx("circle",{cx:"8",cy:"8",r:"2",fill:"currentColor"})]})}),u.jsx("button",{onClick:()=>{xl(H),M(be=>({...be,currentTime:H}))},className:"w-10 h-6 rounded-lg bg-indigo-50 text-indigo-700 hover:bg-indigo-100 transition-colors flex items-center justify-center border border-indigo-200 text-[11px] font-bold",title:`Play at marked time (${H.toFixed(1)}s)`,children:H.toFixed(1)})]})]})]})]})})}),D!==null&&u.jsx(kT,{target:D,onClose:()=>O(null)}),u.jsx(f5,{user:n,isOpen:X,onClose:()=>j(!1)})]})},g5=({isOpen:n,onClose:e,backups:s,onRestore:a,onNewUser:o,onLocalRestore:l,isRestoring:d,title:p="Server Backups",description:m="Select a user profile to restore."})=>{if(!n)return null;const y=x=>x<1024*1024?`${(x/1024).toFixed(1)} KB`:`${(x/(1024*1024)).toFixed(1)} MB`;return u.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col max-h-[85vh]",children:[u.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-center shrink-0",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-xl font-black text-neutral-900 flex items-center gap-2",children:[u.jsx(DE,{size:20})," ",p]}),u.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:m})]}),u.jsx("button",{onClick:e,disabled:d,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:u.jsx(jn,{size:20})})]}),u.jsx("main",{className:"flex-1 overflow-y-auto p-6 space-y-3 custom-scrollbar",children:s.length===0?u.jsx("div",{className:"text-center py-10 text-neutral-400 font-medium italic",children:"No backups found on server."}):s.map(x=>u.jsxs("div",{className:"flex items-center justify-between p-4 rounded-2xl bg-neutral-50 border border-neutral-100 hover:border-neutral-300 transition-all group",children:[u.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[u.jsx("div",{className:"p-2.5 bg-white rounded-xl text-neutral-500 shadow-sm",children:u.jsx(jI,{size:18})}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("h4",{className:"font-bold text-sm text-neutral-900 truncate",children:x.name}),u.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-neutral-500 font-medium",children:[u.jsx("span",{className:"font-black text-indigo-600",children:new Date(x.date).toLocaleString()}),u.jsx("span",{className:"w-1 h-1 rounded-full bg-neutral-300"}),u.jsx("span",{children:y(x.size)})]})]})]}),u.jsx("button",{onClick:()=>a(x.id),disabled:d,className:"px-4 py-2 bg-white border border-neutral-200 text-indigo-600 rounded-xl font-black text-[10px] uppercase tracking-wider hover:bg-indigo-50 hover:border-indigo-200 transition-all shadow-sm active:scale-95 disabled:opacity-50",children:d?u.jsx(mn,{size:14,className:"animate-spin"}):"Restore"})]},x.id))}),u.jsxs("footer",{className:"px-6 py-4 border-t border-neutral-100 bg-neutral-50/30 shrink-0 flex flex-col gap-3 rounded-b-[2.5rem]",children:[u.jsxs("button",{onClick:o,disabled:d,className:"w-full py-3 bg-neutral-900 text-white rounded-xl font-bold text-xs flex items-center justify-center gap-2 shadow-lg hover:bg-neutral-800 transition-all active:scale-95",children:[u.jsx(Xr,{size:16}),u.jsx("span",{children:"I am a New User (Create Profile)"})]}),u.jsx("div",{className:"flex justify-center",children:u.jsxs("button",{onClick:l,disabled:d,className:"flex items-center gap-1.5 text-[10px] font-bold text-neutral-400 hover:text-neutral-600 transition-colors py-1 px-2 rounded-lg hover:bg-neutral-100",children:[u.jsx(dI,{size:12}),u.jsx("span",{children:"Or restore from local file"})]})})]})]})})},y5=({isOpen:n,onClose:e,onPush:s,onRestore:a,type:o,localDate:l,serverDate:d,isProcessing:p})=>{if(!n)return null;const m=o==="restore";return u.jsx("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4 bg-neutral-900/80 backdrop-blur-sm animate-in fade-in duration-300",children:u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl border border-neutral-200 overflow-hidden flex flex-col animate-in zoom-in-95 duration-300",children:[u.jsxs("div",{className:`p-8 text-center space-y-4 ${m?"bg-indigo-50":"bg-emerald-50"}`,children:[u.jsxs("div",{className:"mx-auto w-20 h-20 bg-white rounded-full flex items-center justify-center shadow-sm relative",children:[m?u.jsx(pv,{size:40,className:"text-indigo-500"}):u.jsx(mv,{size:40,className:"text-emerald-500"}),u.jsx("div",{className:"absolute -top-1 -right-1 bg-amber-500 rounded-full p-1 border-2 border-white",children:u.jsx(Dg,{size:12,className:"text-white"})})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("h3",{className:"text-2xl font-black text-neutral-900 tracking-tight",children:m?"Update Available":"Unsaved Progress"}),u.jsx("p",{className:"text-sm font-medium text-neutral-500",children:m?"The server has a newer version of your data.":"Your local data is newer than the cloud backup."})]})]}),u.jsxs("div",{className:"p-8 space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{className:"space-y-1 p-3 bg-neutral-50 rounded-2xl border border-neutral-100",children:[u.jsx("p",{className:"text-[9px] font-black uppercase text-neutral-400 tracking-widest",children:"Local Device"}),u.jsx("p",{className:"text-xs font-bold text-neutral-700",children:l})]}),u.jsxs("div",{className:"space-y-1 p-3 bg-neutral-50 rounded-2xl border border-neutral-100",children:[u.jsx("p",{className:"text-[9px] font-black uppercase text-neutral-400 tracking-widest",children:"Cloud Server"}),u.jsx("p",{className:"text-xs font-bold text-neutral-700",children:d})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("button",{onClick:m?a:s,disabled:p,className:`w-full py-4 rounded-2xl font-black text-sm transition-all shadow-lg active:scale-95 flex items-center justify-center space-x-2 ${m?"bg-indigo-600 text-white hover:bg-indigo-700 shadow-indigo-200":"bg-emerald-600 text-white hover:bg-emerald-700 shadow-emerald-200"}`,children:[p?u.jsx(mn,{size:18,className:"animate-spin"}):m?u.jsx(pv,{size:18}):u.jsx(mv,{size:18}),u.jsx("span",{children:m?"RESTORE FROM CLOUD":"PUSH TO CLOUD"})]}),u.jsx("button",{onClick:e,disabled:p,className:"w-full py-4 bg-neutral-100 text-neutral-500 rounded-2xl font-bold text-sm hover:bg-neutral-200 transition-all",children:"Ignore for now"})]})]}),u.jsx("div",{className:"bg-neutral-50 px-8 py-4 border-t border-neutral-100",children:u.jsx("p",{className:"text-[9px] font-medium text-neutral-400 text-center leading-relaxed",children:"Automatic synchronization helps keep your library consistent across all your devices."})})]})})},x5=qn.lazy(()=>bs(()=>import("./Dashboard-x7Qwc0o1.js"),__vite__mapDeps([0,1,2,3,4]))),b5=qn.lazy(()=>bs(()=>import("./ReviewSession-2iUmKEwF.js"),__vite__mapDeps([5,6]))),v5=qn.lazy(()=>bs(()=>import("./WordList-BEbbkW6y.js"),__vite__mapDeps([7,8,9,10,11,12,13,14,15]))),_5=qn.lazy(()=>bs(()=>import("./ReadingUnitPage-D6Bb8i4w.js"),__vite__mapDeps([16,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,1,24])).then(n=>({default:n.ReadingUnitPage}))),E5=qn.lazy(()=>bs(()=>import("./SettingsView-DGyr3oc7.js"),__vite__mapDeps([25,26,27,23,9,10,11,12,13,14,15])).then(n=>({default:n.SettingsView}))),w5=qn.lazy(()=>bs(()=>import("./Discover-CSgBxAjd.js"),__vite__mapDeps([28,26,27,6,15,4,3,29,12,14,23]))),S5=qn.lazy(()=>bs(()=>import("./WritingStudioPage-BjBhwJFL.js"),__vite__mapDeps([30,18,15,11,14,31,10,19,20,21])).then(n=>({default:n.WritingStudioPage}))),T5=qn.lazy(()=>bs(()=>import("./IrregularVerbs-B9LU3jZq.js"),__vite__mapDeps([32,2,15,14,31]))),A5=qn.lazy(()=>bs(()=>import("./MimicPractice-BD9accSx.js"),__vite__mapDeps([33,34,15])).then(n=>({default:n.MimicPractice}))),I5=qn.lazy(()=>bs(()=>import("./LessonLibraryV2-BhYurQ3Y.js"),__vite__mapDeps([35,18,15,11,10,21,3,36,37,19,20,29])).then(n=>({default:n.LessonLibraryV2}))),N5=qn.lazy(()=>bs(()=>import("./PlanningPage-DFZAzV2_.js"),__vite__mapDeps([38,18,15,11,21,22,23,1,24,39])).then(n=>({default:n.PlanningPage}))),C5=qn.lazy(()=>bs(()=>import("./SpeakingCardPage-qFSWcOwx.js"),__vite__mapDeps([40,18,15,11,10,19,20,21,22,23,1,24,39,36,29,34,13])).then(n=>({default:n.SpeakingCardPage}))),R5=qn.lazy(()=>bs(()=>import("./WordBookPage-DFlkEPu_.js"),__vite__mapDeps([41,21,15,20,27])).then(n=>({default:n.WordBookPage}))),O5=qn.lazy(()=>bs(()=>import("./CourseList-B2vNjzmq.js"),__vite__mapDeps([42,37,15,17,24])).then(n=>({default:n.CourseList}))),j5=[{id:"DASHBOARD",view:"DASHBOARD",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Mobile%20Phone.png",label:"Dashboard"},{id:"BROWSE",view:"BROWSE",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Books.png",label:"Word Library"},{id:"LESSON",view:"LESSON",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Notebook.png",label:"Knowledge Library"},{id:"COURSE",view:"COURSE",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Graduation%20Cap.png",label:"Course"},{id:"UNIT_LIBRARY",view:"UNIT_LIBRARY",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Open%20Book.png",label:"Reading"},{id:"SPEAKING",view:"SPEAKING",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Microphone.png",label:"Speaking - Listening"},{id:"WRITING",view:"WRITING",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Memo.png",label:"Writing"}],k5=({controller:n,onNavigate:e,onSwitchUser:s})=>{const{currentUser:a,view:o,setView:l,sessionType:d,isSidebarOpen:p,setIsSidebarOpen:m,forceExpandAdd:y,serverStatus:x,handleBackup:v,hasUnsavedChanges:S,nextAutoBackupTime:I,triggerServerBackup:z}=n,[U,C]=L.useState(0);L.useEffect(()=>{if(!I){C(0);return}const B=setInterval(()=>{const H=Date.now(),q=I-H,Y=Math.ceil(q/1e3);C(Math.max(0,Y)),Y<=0&&clearInterval(B)},1e3),F=I-Date.now();return C(Math.max(0,Math.ceil(F/1e3))),()=>clearInterval(B)},[I,x,z,S]);const M=I?`Auto-sync in ${U}s...`:S?"Unsaved Changes - Sync Now":"Sync to Server";return a?u.jsx(u.Fragment,{children:u.jsxs("aside",{className:`fixed lg:relative inset-y-0 left-0 z-50 w-64 bg-white border-r border-neutral-200 transform ${p?"translate-x-0":"-translate-x-full"} lg:translate-x-0 transition-transform duration-300 ease-in-out flex flex-col p-6`,children:[u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex items-center justify-between gap-2",children:[u.jsxs("div",{className:"flex items-center space-x-3 overflow-hidden flex-1",children:[u.jsx("img",{src:a.avatar,className:"w-10 h-10 rounded-2xl bg-neutral-100 shrink-0"}),u.jsxs("div",{className:"flex-1 overflow-hidden",children:[u.jsx("div",{className:"text-sm font-bold text-neutral-900 truncate",children:a.name}),u.jsx("div",{className:"text-[10px] text-neutral-400 font-bold truncate",children:a.role})]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:s,className:"p-2 rounded-full border-2 border-indigo-100 bg-white text-indigo-500 hover:border-indigo-500 hover:text-indigo-600 hover:bg-indigo-50 transition-all shadow-sm",title:"Switch User",children:u.jsx(KE,{size:16})}),u.jsx("button",{onClick:()=>m(!1),className:"md:hidden p-2 text-neutral-400",children:u.jsx(jn,{size:24})})]})]}),u.jsxs("div",{className:"mt-4 flex items-center space-x-2",children:[u.jsx("button",{onClick:()=>e("SETTINGS"),className:"p-2 bg-neutral-50 hover:bg-neutral-100 rounded-xl transition-all active:scale-90 border border-neutral-100",title:"Settings",children:u.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Gear.png",alt:"Settings",className:"w-6 h-6 object-contain"})}),u.jsx("button",{onClick:()=>e("PLANNING"),className:"p-2 bg-neutral-50 hover:bg-neutral-100 rounded-xl transition-all active:scale-90 border border-neutral-100",title:"Study Plan",children:u.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Spiral%20Calendar.png",alt:"Planning",className:"w-6 h-6 object-contain"})}),u.jsx("button",{onClick:()=>e("DISCOVER"),className:"p-2 bg-neutral-50 hover:bg-neutral-100 rounded-xl transition-all active:scale-90 border border-neutral-100",title:"Games & Discover",children:u.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Activities/Video%20Game.png",alt:"Games",className:"w-6 h-6 object-contain"})}),x==="connected"&&u.jsxs("button",{onClick:()=>v(),className:`p-2 rounded-xl transition-all active:scale-90 border animate-in fade-in relative ${S?"bg-orange-50 border-orange-200 shadow-[0_0_10px_rgba(249,115,22,0.4)]":"bg-neutral-50 border-neutral-100 hover:bg-neutral-100"}`,title:M,children:[u.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Symbols/Up%20Arrow.png",alt:"Sync",className:"w-6 h-6 object-contain"}),S&&u.jsx("span",{className:`absolute top-0 right-0 w-2.5 h-2.5 rounded-full border-2 border-white -mt-1 -mr-1 ${I?"bg-green-400":"bg-orange-500 animate-pulse"}`})]})]})]}),u.jsxs("nav",{className:"flex-1 overflow-y-auto space-y-1",children:[d&&o!=="REVIEW"&&u.jsx("div",{className:"relative group animate-in fade-in duration-300 mb-1",children:u.jsxs("button",{onClick:()=>e("REVIEW"),className:"w-full flex items-center justify-between px-4 py-3 rounded-xl font-bold text-sm bg-green-500 text-white shadow-lg shadow-green-500/20",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(Z2,{size:20}),u.jsx("span",{children:"Study Now"})]}),u.jsxs("div",{className:"relative flex h-3 w-3",children:[u.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-white opacity-75"}),u.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-white"})]})]})}),j5.map(B=>{const F=o===B.view&&(B.id!=="BROWSE"||!y),H=B.id==="SPEAKING"&&o==="SPEAKING";return u.jsx("div",{className:"relative group",children:u.jsx("button",{onClick:()=>e(B.view),className:`w-full flex items-center justify-between px-4 py-3 rounded-xl font-bold text-sm transition-colors ${F||H?"bg-neutral-900 text-white shadow-sm":"text-neutral-500 hover:bg-neutral-100"}`,children:u.jsxs("div",{className:"flex items-center space-x-3",children:[typeof B.icon=="string"?u.jsx("img",{src:B.icon,className:`w-5 h-5 object-contain transition-all ${F||H?"opacity-100":"opacity-70 group-hover:opacity-100"}`,alt:B.label}):u.jsx(B.icon,{size:20}),u.jsx("span",{children:B.label})]})})},B.id)})]})]})}):null},L5=({controller:n})=>{const{view:e,currentUser:s,stats:a,xpToNextLevel:o,wotd:l,setGlobalViewWord:d,setView:p,lastBackupTime:m,handleBackup:y,restoreFromServerAction:x,triggerLocalRestore:v,triggerLocalBackup:S,triggerServerBackup:I,handleNavigateToList:z,sessionWords:U,sessionType:C,sessionFocus:M,updateWord:B,bulkUpdateWords:F,handleSessionComplete:H,gainExperienceAndLevelUp:q,recalculateXpAndLevelUp:Y,handleRetrySession:A,deleteWord:T,bulkDeleteWords:E,startSession:R,initialListFilter:N,setInitialListFilter:D,forceExpandAdd:O,setForceExpandAdd:ve,handleUpdateUser:ye,refreshGlobalStats:G,handleLibraryReset:ae,apiUsage:ne,xpGained:Q,lastMasteryScoreUpdateTimestamp:X,isWotdComposed:j,randomizeWotd:V,handleComposeWithWord:$,writingContextWord:Z,consumeWritingContext:ee,serverStatus:pe,serverUrl:ie,networkMode:ce,isSwitchingServerMode:De,handleToggleServerMode:fe,planningAction:Se,consumePlanningAction:Oe,targetGameMode:me,consumeTargetGameMode:ue,targetCourseId:ge,consumeTargetCourseId:Ee}=n;if(!s)return null;switch(e){case"DASHBOARD":return u.jsx(x5,{userId:s.id,user:s,totalCount:a.total,dueCount:a.due,newCount:a.new,xpToNextLevel:o,wotd:l,onViewWord:d,setView:p,lastBackupTime:m,onBackup:y,onRestore:()=>{},restoreFromServerAction:async()=>await x(),triggerLocalRestore:v,onLocalBackup:S,onServerBackup:I,onNavigateToWordList:z,isWotdComposed:j,onComposeWotd:$,onRandomizeWotd:V,serverStatus:pe,serverUrl:ie,activeServerMode:ce==="outside"?"public":ce,isSwitchingServerMode:De,onToggleServerMode:fe,onAction:Ae=>{n.handleSpecialAction(Ae)},onStartDueReview:n.startDueReviewSession,onStartNewLearn:n.startNewLearnSession});case"WORDBOOK":return u.jsx(R5,{user:s});case"PLANNING":return u.jsx(N5,{user:s,initialAction:Se,onActionConsumed:Oe});case"REVIEW":return U&&C?u.jsx(b5,{user:s,sessionWords:U,sessionType:C,sessionFocus:M,onUpdate:B,onBulkUpdate:F,onComplete:H,onRetry:A}):null;case"BROWSE":return u.jsx(v5,{user:s,onDelete:async Ae=>await T(Ae),onBulkDelete:async Ae=>await E(Ae),onUpdate:B,onStartSession:Ae=>R(Ae,"custom"),initialFilter:N,onInitialFilterApplied:()=>D(null),forceExpandAdd:O,onExpandAddConsumed:()=>ve(!1),onNavigate:p});case"LESSON":return u.jsx(I5,{user:s,onStartSession:Ae=>R(Ae,"custom"),onExit:()=>p("DASHBOARD"),onNavigate:p,onUpdateUser:ye,initialLessonId:n.targetLessonId,onConsumeLessonId:n.consumeTargetLessonId,initialTag:n.targetLessonTag,onConsumeTag:n.consumeTargetLessonTag,initialType:n.targetLessonType,onConsumeType:n.consumeTargetLessonType});case"COURSE":return u.jsx(O5,{initialCourseId:ge,onConsumeInitialCourseId:Ee});case"UNIT_LIBRARY":return u.jsx(_5,{user:s,onStartSession:Ae=>R(Ae,"new_study"),onUpdateUser:ye});case"SETTINGS":return u.jsx(E5,{user:s,onUpdateUser:ye,onRefresh:G,onNuke:ae,apiUsage:ne});case"DISCOVER":return u.jsx(w5,{user:s,xpToNextLevel:o,totalWords:a.total,onExit:()=>p("DASHBOARD"),onGainXp:q,onRecalculateXp:Y,xpGained:Q,onStartSession:R,onUpdateUser:ye,lastMasteryScoreUpdateTimestamp:X,onBulkUpdate:F,initialGameMode:me,onConsumeGameMode:ue});case"SPEAKING":return u.jsx(C5,{user:s,onNavigate:p});case"WRITING":return u.jsx(S5,{controller:n,user:s,initialContextWord:Z,onConsumeContext:ee});case"IRREGULAR_VERBS":return u.jsx(T5,{user:s,onGlobalViewWord:d});case"MIMIC":return u.jsx(A5,{});default:return u.jsxs("div",{children:["Unknown view: ",e]})}},M5=({controller:n})=>{const{view:e,isSidebarOpen:s,setIsSidebarOpen:a,globalViewWord:o,setGlobalViewWord:l,updateWord:d,gainExperienceAndLevelUp:p,sessionType:m,clearSessionState:y,setView:x,setForceExpandAdd:v,currentUser:S,stats:I,lastBackupTime:z,isAutoRestoreOpen:U,setIsAutoRestoreOpen:C,autoRestoreCandidates:M,restoreFromServerAction:B,handleNewUserSetup:F,handleLocalRestoreSetup:H,handleSwitchUser:q,syncPrompt:Y,setSyncPrompt:A,isSyncing:T,handleSyncPush:E,handleSyncRestore:R,sslIssueUrl:N,setSslIssueUrl:D,retrySslConnection:O}=n,[ve,ye]=L.useState(null),[G,ae]=L.useState({isOpen:!1,targetView:null,andThen:void 0}),[ne,Q]=L.useState({isOpen:!1,targetView:null,action:void 0}),X=(ie,ce)=>{if(n.hasWritingUnsavedChanges){Q({isOpen:!0,targetView:ie,action:ce});return}m&&ie!=="REVIEW"?ae({isOpen:!0,targetView:ie,andThen:ce}):(v(!!ce),x(ie),a(!1))},j=()=>{G.targetView?(y(),x(G.targetView),G.andThen?G.andThen():v(!1),a(!1)):G.andThen&&(y(),G.andThen()),ae({isOpen:!1,targetView:null,andThen:void 0})},V=()=>ae({isOpen:!1,targetView:null,andThen:void 0}),$=ie=>{l(null),ye(ie)},Z=ie=>{d(ie),ye(null)},[ee,pe]=L.useState(!1);return u.jsxs("div",{className:"min-h-screen bg-neutral-50 md:flex",children:[u.jsx(k5,{controller:n,onNavigate:X,onSwitchUser:q}),u.jsx("div",{className:`fixed inset-0 bg-black/30 z-40 lg:hidden ${s?"block":"hidden"}`,onClick:()=>a(!1)}),u.jsxs("main",{className:`flex-1 overflow-y-auto relative ${e==="MIMIC"?"p-0":"p-6 md:p-10"}`,children:[u.jsx("button",{onClick:()=>a(!0),className:"lg:hidden fixed top-4 left-4 p-2 bg-white/80 backdrop-blur-sm rounded-full shadow-md z-30",children:u.jsx(bI,{size:24})}),u.jsx(L.Suspense,{fallback:u.jsx("div",{className:"flex justify-center p-20",children:u.jsx(mn,{className:"animate-spin text-neutral-300",size:32})}),children:u.jsx(L5,{controller:n})})]}),S&&u.jsx(m5,{user:S,stats:I,currentView:e,lastBackupTime:z,onNavigate:n.handleSpecialAction,onViewWord:l,isAnyModalOpen:!!o||!!ve}),o&&u.jsx(QL,{word:o,onClose:()=>l(null),onNavigateToWord:l,onEditRequest:$,onUpdate:d,onGainXp:p}),ve&&u.jsx(Kk,{user:n.currentUser,word:ve,onSave:Z,onClose:()=>ye(null),onSwitchToView:ie=>{ye(null),l(ie)}}),u.jsx(Eg,{isOpen:G.isOpen,title:"End Current Session?",message:"Navigating away will end your current study session. Are you sure you want to continue?",confirmText:"End Session",isProcessing:!1,onConfirm:j,onClose:V,icon:u.jsx(Dg,{size:40,className:"text-orange-50"}),confirmButtonClass:"bg-orange-600 text-white hover:bg-orange-700 shadow-orange-200"}),u.jsx(Eg,{isOpen:ne.isOpen,title:"Unsaved Writing Changes",message:"You have unsaved writing changes. Leave without saving?",confirmText:"Leave",isProcessing:!1,confirmButtonClass:"bg-red-600 text-white hover:bg-red-700 shadow-red-200",onConfirm:()=>{ne.targetView&&(n.setHasWritingUnsavedChanges(!1),ne.action?ne.action():v(!1),x(ne.targetView),a(!1)),Q({isOpen:!1,targetView:null,action:void 0})},onClose:()=>Q({isOpen:!1,targetView:null,action:void 0})}),u.jsx(g5,{isOpen:U,onClose:()=>C(!1),backups:M,onRestore:ie=>{pe(!0),B(ie).finally(()=>pe(!1))},isRestoring:ee,title:"User Selection",description:"We found existing profiles on the server. Select yours to restore.",onNewUser:F,onLocalRestore:H}),Y&&u.jsx(y5,{isOpen:Y.isOpen,onClose:()=>A(null),onPush:E,onRestore:R,type:Y.type,localDate:Y.localDate,serverDate:Y.serverDate,isProcessing:T}),N&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[100]",children:u.jsxs("div",{className:"bg-white rounded-2xl p-6 w-[440px] shadow-2xl border border-red-100",children:[u.jsx("h2",{className:"text-lg font-bold text-red-600 mb-2",children:"SSL Certificate Required"}),u.jsx("p",{className:"text-sm text-neutral-600 mb-4",children:"Cannot securely connect to:"}),u.jsx("div",{className:"text-xs font-mono bg-neutral-100 p-2 rounded mb-4 break-all",children:N}),u.jsxs("p",{className:"text-sm text-neutral-600 mb-6",children:["Your browser blocked this connection because the SSL certificate is not trusted yet.",u.jsx("br",{}),u.jsx("br",{}),"Please open the link, trust the certificate, then come back and press Retry."]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>D(null),className:"px-3 py-2 rounded-lg bg-neutral-200 hover:bg-neutral-300 text-sm",children:"Cancel"}),u.jsx("button",{onClick:()=>window.open(N,"_blank"),className:"px-3 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm",children:"Open & Trust"}),u.jsx("button",{onClick:async()=>{D(null),await O()},className:"px-3 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 text-sm",children:"Retry"})]})]})})]})},D5=()=>u.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-neutral-950/90 backdrop-blur-md animate-in fade-in duration-500",children:u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[3rem] shadow-2xl border-2 border-neutral-100 overflow-hidden animate-in zoom-in-95 duration-500",children:[u.jsxs("div",{className:"bg-neutral-900 p-8 text-white text-center space-y-4",children:[u.jsxs("div",{className:"mx-auto w-20 h-20 bg-white/10 rounded-full flex items-center justify-center border-4 border-white/20 mb-2 relative",children:[u.jsx(oI,{size:40,className:"animate-pulse"}),u.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 rounded-full p-1 border-2 border-neutral-900",children:u.jsx(Ra,{size:14})})]}),u.jsx("h3",{className:"text-2xl font-black tracking-tighter uppercase",children:"Connection Lost"})]}),u.jsxs("div",{className:"p-10 text-center space-y-6",children:[u.jsxs("div",{className:"space-y-3",children:[u.jsx("p",{className:"text-lg font-black text-neutral-900 leading-tight",children:"Database link interrupted"}),u.jsxs("p",{className:"text-neutral-500 text-sm leading-relaxed font-medium",children:["The connection to your local storage was closed unexpectedly by the browser.",u.jsx("br",{}),u.jsx("br",{}),"Don't worry, ",u.jsx("strong",{children:"your data is safe"}),". Refreshing the application will restore the connection immediately."]})]}),u.jsxs("button",{onClick:()=>{localStorage.setItem("vocab_pro_auto_restore","true"),window.location.reload()},className:"w-full py-5 bg-neutral-900 text-white rounded-2xl font-black text-sm hover:bg-neutral-800 transition-all shadow-xl shadow-neutral-900/20 active:scale-95 flex items-center justify-center space-x-3",children:[u.jsx(Rl,{size:20}),u.jsx("span",{children:"REFRESH APPLICATION"})]})]}),u.jsx("div",{className:"bg-neutral-50 px-8 py-4 flex items-center justify-center space-x-2 border-t border-neutral-100",children:u.jsx("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Safe Persistent Storage"})})]})}),U5=()=>{const n=Mk(),{isLoaded:e,isResetting:s,resetStep:a,view:o,currentUser:l,handleLogin:d}=n,[p,m]=L.useState(!1);return L.useEffect(()=>{XE();const y=()=>m(!0);return window.addEventListener("db-connection-lost",y),()=>window.removeEventListener("db-connection-lost",y)},[]),p?u.jsx(D5,{}):e?s?u.jsxs("div",{className:"h-screen w-screen flex flex-col items-center justify-center bg-white space-y-4",children:[u.jsx(mn,{size:40,className:"text-neutral-900 animate-spin"}),u.jsx("p",{className:"text-sm font-bold text-neutral-500",children:a})]}):o==="AUTH"||!l?u.jsx(ZI,{onLogin:d}):u.jsx(M5,{controller:n}):u.jsxs("div",{className:"h-screen w-screen flex flex-col items-center justify-center bg-white space-y-4",children:[u.jsx(Ol,{size:40,className:"text-neutral-900"}),u.jsx("p",{className:"text-sm font-bold text-neutral-500",children:"Vocab Pro"})]})},P5=()=>{const[n,e]=L.useState(0),s=L.useCallback(()=>{e(a=>a+1)},[]);return L.useEffect(()=>(window.addEventListener("vocab-pro-force-ui-reload",s),()=>window.removeEventListener("vocab-pro-force-ui-reload",s)),[s]),u.jsx(JI,{children:u.jsx(U5,{},n)})},rA=document.getElementById("root");if(!rA)throw new Error("Could not find root element to mount to");const V5=G2.createRoot(rA);V5.render(u.jsx(qn.StrictMode,{children:u.jsx(P5,{})}));export{Kk as $,Q2 as A,Z2 as B,nI as C,Ut as D,Og as E,dI as F,BE as G,jE as H,mn as I,as as J,Af as K,yI as L,Ao as M,jg as N,ru as O,vI as P,kE as Q,$E as R,Ol as S,Dg as T,$c as U,Sr as V,ZE as W,wr as X,jn as Y,Nf as Z,QL as _,mv as a,Zw as a$,$L as a0,kT as a1,sI as a2,hI as a3,kr as a4,yu as a5,Kw as a6,Rs as a7,jT as a8,q5 as a9,Ra as aA,vg as aB,jl as aC,VI as aD,Mg as aE,CI as aF,Eg as aG,gu as aH,K5 as aI,xN as aJ,Gk as aK,qk as aL,Pk as aM,jI as aN,zE as aO,KE as aP,Vn as aQ,J2 as aR,HE as aS,Jk as aT,nL as aU,Yr as aV,Rl as aW,qE as aX,PE as aY,tL as aZ,lN as a_,Yk as aa,AN as ab,au as ac,Yt as ad,Mr as ae,Lr as af,Jg as ag,sS as ah,dM as ai,RI as aj,Xr as ak,fM as al,e0 as am,hu as an,cf as ao,nw as ap,H5 as aq,G5 as ar,B5 as as,Y5 as at,$5 as au,jf as av,EN as aw,_N as ax,YE as ay,fI as az,LE as b,nM as b$,Kp as b0,Qp as b1,If as b2,GE as b3,W2 as b4,Lg as b5,yN as b6,VE as b7,QE as b8,mI as b9,Aw as bA,GI as bB,zm as bC,_I as bD,Zp as bE,q1 as bF,O0 as bG,R0 as bH,Vm as bI,kg as bJ,bI as bK,aL as bL,rM as bM,cM as bN,oM as bO,lM as bP,uI as bQ,II as bR,J5 as bS,lI as bT,OT as bU,l5 as bV,RT as bW,xl as bX,tM as bY,X5 as bZ,eM as b_,NI as ba,eI as bb,ME as bc,z5 as bd,Wc as be,gv as bf,ST as bg,X2 as bh,j0 as bi,Z5 as bj,sM as bk,U1 as bl,W5 as bm,BI as bn,mu as bo,aM as bp,Q5 as bq,iM as br,gI as bs,tI as bt,rI as bu,rs as bv,Vk as bw,qI as bx,HI as by,hM as bz,Ie as c,UE as c0,FE as c1,Lw as c2,Mw as c3,$I as c4,DE as d,WE as e,Tf as f,lf as g,AI as h,Cg as i,u as j,Tt as k,Wg as l,Rf as m,Yg as n,Fg as o,Hg as p,Gg as q,L as r,FI as s,fi as t,Zg as u,nS as v,qn as w,fo as x,F5 as y,Cl as z};
