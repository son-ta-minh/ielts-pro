import{c as Y,r,j as e,aB as fe,P as ue,aC as ae,aD as lt,ah as je,D as re,aE as Ie,aF as Te,V as it,aG as Le,aH as me,aI as Re,aJ as ot,aK as ct,aL as he,a6 as Me,C as ve,t as dt,F as xt,s as ne,o as ut,a7 as mt,a3 as De,ao as Oe,aM as ht,K as pe,U as Se,O as pt,Y as gt,I as bt,_ as ft,a0 as ge,u as jt,ar as vt,aN as Ne,aO as Nt,k as se,ai as Pe,aP as yt,L as wt,aQ as kt,aR as Ct,aS as St,aT as At,aU as zt,E as Ae,m as ze,aq as ce,aV as Et,f as It,aW as Tt,aX as Lt,aY as Rt,aZ as Mt,a_ as Dt,a$ as Ot,b0 as Pt,b1 as Vt}from"./index-DGJ8pI6b.js";import{A as Ve,S as _t,T as Ut}from"./AvatarSelectionModal-DcGGJw3x.js";import{B as Ft,A as Ht,D as de}from"./WordTable_UI-DwxdWbT0.js";import{E as Bt}from"./ear-a139_nm1.js";import{L as Wt,S as _e}from"./server-BFeTvLIR.js";import{D as $t}from"./download-CHUUuwxQ.js";import{C as Jt,F as Gt}from"./folder-n66ThGOn.js";import{P as Kt}from"./pause-CiqHvaFj.js";import"./palette-Lmjn_xUZ.js";import"./TagBrowser-IeSMbUYn.js";import"./square-check-big-DTHqJH21.js";import"./chevron-left-J6RKxoGo.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=Y("LayoutTemplate",[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=Y("School",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=Y("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=Y("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=Y("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=Y("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),Zt=["Vietnamese","Spanish","Chinese (Simplified)","Chinese (Traditional)","Japanese","Korean","French","German","Italian","Portuguese","Russian","Arabic","Hindi","Thai","Indonesian","Turkish"],ea=[{level:1,title:"Vocab Novice"},{level:5,title:"Word Apprentice"},{level:10,title:"Lexical Explorer"},{level:20,title:"Master Grammarian"},{level:30,title:"IELTS Wordsmith"},{level:50,title:"IELTS Luminary"}],ta=({profileData:t,onProfileChange:l,onAvatarChange:i,onSaveProfile:c})=>{const[d,b]=r.useState(!1),a=ea.some(f=>f.title===t.role),p={id:"settings-user",name:t.name,avatar:t.avatar,lastLogin:0,experience:0,level:100,peakLevel:100,adventure:{}};return e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-neutral-100 text-neutral-600 rounded-2xl",children:e.jsx(fe,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Your Profile"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Identity and learning context."})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6 p-4 bg-neutral-50 rounded-3xl border border-neutral-100",children:[e.jsxs("div",{className:"relative group shrink-0",children:[e.jsx("img",{src:t.avatar,alt:"Current Avatar",className:"w-24 h-24 rounded-2xl bg-white shadow-sm border-2 border-white object-contain"}),e.jsx("button",{onClick:()=>b(!0),className:"absolute inset-0 bg-black/40 rounded-2xl flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white font-bold text-xs",children:"Change"}),e.jsx("button",{onClick:()=>b(!0),className:"absolute -bottom-2 -right-2 p-2 bg-neutral-900 text-white rounded-full shadow-md hover:scale-110 transition-transform",title:"Edit Avatar",children:e.jsx(ue,{size:14})})]}),e.jsxs("div",{className:"flex-1 w-full md:w-auto",children:[e.jsx("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2",children:"Display Name"}),e.jsx("input",{name:"name",value:t.name,onChange:l,className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl font-bold text-lg focus:ring-2 focus:ring-neutral-900 outline-none",placeholder:"Enter your name"}),e.jsx("button",{onClick:()=>b(!0),className:"mt-2 text-xs font-bold text-indigo-600 hover:underline md:hidden",children:"Select Identity"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2",children:"Role / Title"}),e.jsx("input",{name:"role",value:t.role,onChange:l,placeholder:"e.g., Student",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium focus:ring-1 focus:ring-neutral-300 outline-none",readOnly:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2",children:"Current Level"}),e.jsx("input",{name:"currentLevel",value:t.currentLevel,onChange:l,placeholder:"e.g., Intermediate, Advanced",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium focus:ring-1 focus:ring-neutral-300 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2",children:"Target"}),e.jsx("input",{name:"target",value:t.target,onChange:l,placeholder:"e.g., Fluent communication",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium focus:ring-1 focus:ring-neutral-300 outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2 flex items-center gap-2",children:[e.jsx(ae,{size:12})," Native Language"]}),e.jsx("select",{name:"nativeLanguage",value:t.nativeLanguage,onChange:l,className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium appearance-none focus:ring-1 focus:ring-neutral-300 outline-none",children:Zt.map(f=>e.jsx("option",{value:f,children:f},f))})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-amber-50 text-amber-600 rounded-2xl",children:e.jsx(ae,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Lesson Preferences"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Settings for AI generated units in Lesson page"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t border-neutral-100",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2 flex items-center gap-2",children:[e.jsx(ae,{size:12})," Content Language"]}),e.jsxs("select",{name:"lessonLanguage",value:t.lessonLanguage,onChange:l,className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium appearance-none",children:[e.jsx("option",{value:"English",children:"English"}),e.jsx("option",{value:"Vietnamese",children:"Vietnamese"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2 flex items-center gap-2",children:[e.jsx(lt,{size:12})," Target Audience"]}),e.jsxs("select",{name:"lessonAudience",value:t.lessonAudience,onChange:l,className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium appearance-none",children:[e.jsx("option",{value:"Kid",children:"Kid"}),e.jsx("option",{value:"Adult",children:"Adult"})]})]})]})]}),e.jsxs("button",{onClick:c,className:"w-full py-4 bg-neutral-900 text-white rounded-2xl font-black text-xs hover:bg-neutral-800 transition-all flex items-center justify-center space-x-2",children:[e.jsx(je,{size:16})," ",e.jsx("span",{children:"SAVE PROFILE"})]}),e.jsx(Ve,{isOpen:d,onClose:()=>b(!1),onSelectAvatar:i,currentUser:p})]})},Ee=({label:t,langCode:l,currentVoice:i,serverData:c,onChange:d,onPreview:b,filterHighQuality:a})=>{if(!c)return e.jsxs("div",{className:"space-y-1 opacity-50",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:t}),e.jsx("div",{className:"w-full bg-neutral-100 border border-neutral-200 rounded-xl px-4 py-2 text-xs font-bold text-neutral-400",children:"Server Offline"})]});const p=c.voices.filter(j=>j.language===l||j.language.toLowerCase().startsWith(l)?a?j.name.includes("Enhanced")||j.name.includes("Premium"):!0:!1),f=p.reduce((j,x)=>{const u=x.accent||"Standard";return j[u]||(j[u]=[]),j[u].push(x),j},{}),L=j=>{const x=j.target.value;if(!x){const z=l==="en"?"en_US":"vi_VN";d("",z),b("",z);return}const u=c.voices.find(z=>z.name===x);u&&(d(u.name,u.accent),setTimeout(()=>b(u.name,u.accent),100))};return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:t}),e.jsxs("button",{type:"button",onClick:()=>b(i,l==="en"?"en_US":"vi_VN"),className:"text-[10px] font-black text-indigo-600 uppercase tracking-widest flex items-center gap-1 hover:underline",children:[e.jsx(Me,{size:10,fill:"currentColor"})," Test"]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:i,onChange:L,className:"w-full appearance-none bg-white border border-neutral-200 rounded-xl px-4 py-3 pr-10 text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none transition-all",children:[e.jsx("option",{value:"",children:"Default System Voice"}),Object.entries(f).map(([j,x])=>e.jsx("optgroup",{label:j.replace(/[_]/g," ").toUpperCase(),children:x.map(u=>e.jsx("option",{value:u.name,children:u.name},u.name))},j)),p.length===0&&e.jsxs("option",{disabled:!0,children:["No ",a?"high quality ":"","voices found"]})]}),e.jsx(ve,{size:16,className:"absolute right-4 top-1/2 -translate-y-1/2 text-neutral-400 pointer-events-none"})]})]})},aa=({config:t,onConfigChange:l,onSaveSettings:i})=>{const[c,d]=r.useState(null),[b,a]=r.useState(!1),[p,f]=r.useState(!1),{showToast:L}=re(),j=Ie(t),x=t.audioCoach.activeCoach,u=t.audioCoach.coaches[x],z=async()=>{ot();const m=await ct(j);d(m||null)};r.useEffect(()=>{z()},[j]);const C=(m,v=!1)=>{const N={...t.audioCoach.coaches};if(N[x]={...N[x],...m},l("audioCoach","coaches",N),v){const w={...t,audioCoach:{...t.audioCoach,coaches:N}};he(w),L("Settings saved automatically.","success",1e3)}},k=m=>{l("interface","buddyVoiceEnabled",m);const v={...t,interface:{...t.interface,buddyVoiceEnabled:m}};he(v)},O=(m,v,N)=>{dt(m==="en"?"Hello! I am your study companion. Ready to learn?":"Xin chào! Mình là bạn đồng hành của bạn. Sẵn sàng chưa?",!0,m,v,N)},S={id:"coach-setup",name:u.name,avatar:u.avatar,level:999,peakLevel:999,experience:0,lastLogin:0,adventure:{}};return e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-8 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-neutral-100 text-neutral-600 rounded-2xl",children:e.jsx(Te,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Audio Coach"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Customize your AI study companion."})]})]}),e.jsxs("button",{onClick:i,className:"px-5 py-2.5 bg-neutral-900 text-white rounded-xl font-black text-[10px] flex items-center space-x-2 active:scale-95 uppercase tracking-widest hover:bg-neutral-800 transition-all shadow-md",children:[e.jsx(je,{size:14}),e.jsx("span",{children:"Save"})]})]}),e.jsx("div",{className:"space-y-4 pt-4 border-t border-neutral-100",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:[e.jsx(it,{size:12})," Interaction"]}),e.jsxs("label",{onClick:()=>k(!t.interface.buddyVoiceEnabled),className:"flex items-center justify-between px-4 py-4 bg-white border border-neutral-200 rounded-2xl cursor-pointer hover:bg-neutral-50 transition-all shadow-sm group",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-black text-neutral-900",children:"Enable Dialogue"}),e.jsx("span",{className:"text-xs text-neutral-500 font-medium mt-0.5",children:"Read advice, tips, and greetings aloud"})]}),e.jsx("div",{className:`w-11 h-6 rounded-full transition-all flex items-center p-1 ${t.interface.buddyVoiceEnabled?"bg-indigo-600":"bg-neutral-200"}`,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow-md transition-transform duration-300 ${t.interface.buddyVoiceEnabled?"translate-x-5":"translate-x-0"}`})})]})]})}),e.jsxs("div",{className:"space-y-6 pt-4 border-t border-neutral-100",children:[e.jsx("div",{className:"flex items-center justify-between px-1",children:e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(fe,{size:12})," Coach Identity"]})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"shrink-0 flex justify-center md:justify-start",children:e.jsxs("div",{className:"relative group w-24 h-24",children:[e.jsxs("div",{className:"w-full h-full rounded-[2rem] bg-neutral-100 border-2 border-neutral-200 p-2 overflow-hidden shadow-sm relative",children:[e.jsx("img",{src:u.avatar,className:"w-full h-full object-contain",alt:"Coach Avatar"}),e.jsx("div",{onClick:()=>a(!0),className:"absolute inset-0 bg-black/10 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer z-10",children:e.jsx("div",{className:"bg-white p-2 rounded-xl shadow-sm",children:e.jsx(ue,{size:16,className:"text-neutral-900"})})})]}),e.jsx("button",{onClick:()=>a(!0),className:"absolute bottom-0 right-0 translate-x-1 translate-y-1 p-1.5 bg-neutral-900 text-white rounded-lg shadow-md hover:scale-110 transition-transform group-hover:opacity-0",title:"Change Avatar",children:e.jsx(ue,{size:10})})]})}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-wider px-1",children:"Name"}),e.jsx("input",{type:"text",value:u.name,onChange:m=>C({name:m.target.value}),onBlur:()=>C({},!0),placeholder:"Coach Name",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none transition-all"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-wider px-1",children:"Persona Style"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>C({persona:"friendly_elementary"},!0),className:`flex flex-col items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 transition-all ${u.persona==="friendly_elementary"?"bg-amber-50 border-amber-200 text-amber-700":"bg-white border-neutral-100 text-neutral-400 hover:border-neutral-200"}`,children:[e.jsx(Xt,{size:18}),e.jsx("span",{className:"text-[10px] font-black uppercase",children:"Teacher"})]}),e.jsxs("button",{type:"button",onClick:()=>C({persona:"professional_professor"},!0),className:`flex flex-col items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 transition-all ${u.persona==="professional_professor"?"bg-indigo-50 border-indigo-200 text-indigo-700":"bg-white border-neutral-100 text-neutral-400 hover:border-neutral-200"}`,children:[e.jsx(Le,{size:18}),e.jsx("span",{className:"text-[10px] font-black uppercase",children:"Professor"})]})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6 pt-4 border-t border-neutral-100",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:[e.jsx(me,{size:12})," Voice Settings"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group select-none",children:[e.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${p?"bg-indigo-600 border-indigo-600":"bg-white border-neutral-300 group-hover:border-indigo-400"}`,children:p&&e.jsx(_t,{size:10,className:"text-white",fill:"currentColor"})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:p,onChange:m=>f(m.target.checked)}),e.jsx("span",{className:`text-[10px] font-bold transition-colors ${p?"text-indigo-700":"text-neutral-500"}`,children:"Only High Quality"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Ee,{label:"English Voice",langCode:"en",currentVoice:u.enVoice,serverData:c,onChange:(m,v)=>C({enVoice:m,enAccent:v},!0),onPreview:(m,v)=>O("en",m,v),filterHighQuality:p}),e.jsx(Ee,{label:"Vietnamese Voice",langCode:"vi",currentVoice:u.viVoice,serverData:c,onChange:(m,v)=>C({viVoice:m,viAccent:v},!0),onPreview:(m,v)=>O("vi",m,v),filterHighQuality:p})]})]}),e.jsxs("div",{className:"p-4 bg-neutral-50 rounded-2xl border border-neutral-200 flex items-start gap-3",children:[e.jsx(Re,{size:16,className:"text-neutral-400 mt-0.5 shrink-0"}),e.jsx("p",{className:"text-[10px] text-neutral-500 leading-relaxed font-medium",children:"Pronunciation practice uses your browser's built-in recognition engine for maximum compatibility and privacy. The selected voices above are used for reading text aloud."})]}),e.jsx(Ve,{isOpen:b,onClose:()=>a(!1),onSelectAvatar:m=>C({avatar:m},!0),currentUser:S})]})},sa=({junkTags:t,onJunkTagsChange:l})=>{const[i,c]=r.useState(""),d=()=>{const a=i.trim().toLowerCase();a&&!t.includes(a)&&l([...t,a].sort()),c("")},b=a=>{l(t.filter(p=>p!==a))};return e.jsxs("div",{className:"space-y-4 pt-4 border-t border-neutral-100",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:[e.jsx(mt,{size:12})," Junk Tag List"]}),e.jsxs("div",{className:"p-4 bg-neutral-50 rounded-2xl border border-neutral-100 space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:i,onChange:a=>c(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),d())},placeholder:"Add a tag to remove...",className:"flex-1 px-3 py-2 bg-white border border-neutral-200 rounded-lg text-xs font-bold"}),e.jsx("button",{onClick:d,className:"p-2.5 bg-neutral-900 text-white rounded-lg flex items-center justify-center",children:e.jsx(De,{size:14})})]}),t.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(a=>e.jsxs("div",{className:"flex items-center gap-1 bg-white pl-3 pr-1 py-1 rounded-full border border-neutral-200 text-xs font-bold text-neutral-700",children:[e.jsx("span",{children:a}),e.jsx("button",{onClick:()=>b(a),className:"p-1 text-neutral-400 hover:text-red-500 hover:bg-red-50 rounded-full",children:e.jsx(Oe,{size:12})})]},a))}):e.jsx("p",{className:"text-center text-xs text-neutral-400 py-2",children:"No junk tags defined."})]})]})},W=({checked:t,onChange:l,label:i,icon:c})=>e.jsxs("button",{onClick:l,className:`flex items-center gap-2 px-3 py-2 rounded-lg border transition-all ${t?"bg-indigo-50 border-indigo-200 text-indigo-800":"bg-white border-neutral-200 text-neutral-500 hover:bg-neutral-50"}`,children:[c&&e.jsx(c,{size:14}),t?e.jsx(ut,{size:14}):e.jsx(Jt,{size:14}),e.jsx("span",{className:"text-xs font-bold uppercase",children:i})]}),na=t=>{const{jsonInputRef:l,dataScope:i,onDataScopeChange:c,onJSONImport:d,onJSONExport:b,isNormalizing:a,onOpenNormalizeModal:p,junkTags:f,onJunkTagsChange:L,normalizeOptions:j,onNormalizeOptionsChange:x}=t,[u,z]=r.useState(!1),{showToast:C}=re(),k=S=>{c({...i,[S]:!i[S]})},O=async()=>{z(!0);try{await ht();const m=pe().filter(o=>o.quality===Se.RAW);if(m.length===0){C("No RAW words found to refine.","info"),z(!1);return}const v=m.map(o=>o.word),N=await pt(v);if(N.length===0){C("No refined data found on server.","info"),z(!1);return}const w=[],E=new Map(N.map(o=>[o.word.toLowerCase().trim(),o]));for(const o of m){const g=E.get(o.word.toLowerCase().trim());if(g){const y={...o,ipa:g.ipa,ipaUs:g.ipaUs,ipaUk:g.ipaUk,meaningVi:g.meaningVi,example:g.example,collocationsArray:g.collocationsArray,idiomsList:g.idiomsList,paraphrases:g.paraphrases,wordFamily:g.wordFamily,prepositions:g.prepositions,isIdiom:g.isIdiom,isCollocation:g.isCollocation,isPhrasalVerb:g.isPhrasalVerb,quality:Se.REFINED,updatedAt:Date.now()};y.complexity=gt(y),y.masteryScore=bt(y),y.gameEligibility=ft(y),w.push(y)}}w.length>0&&(await ge(w),C(`Successfully refined ${w.length} words from server!`,"success"))}catch(S){console.error(S),C("Failed to refine from server.","error")}finally{z(!1)}};return e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-8",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsx("div",{className:"p-3 bg-indigo-50 text-indigo-600 rounded-2xl",children:e.jsx(xt,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Data Management"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Backup, restore, and optimize your library."})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Manual Backup / Restore"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(W,{checked:i.user,onChange:()=>k("user"),label:"User Profile"}),e.jsx(W,{checked:i.vocabulary,onChange:()=>k("vocabulary"),label:"Word Library"}),e.jsx(W,{checked:i.wordBook,onChange:()=>k("wordBook"),label:"Word Books",icon:Ft}),e.jsx(W,{checked:i.lesson,onChange:()=>k("lesson"),label:"Lessons"}),e.jsx(W,{checked:i.reading,onChange:()=>k("reading"),label:"Reading"}),e.jsx(W,{checked:i.writing,onChange:()=>k("writing"),label:"Writing"}),e.jsx(W,{checked:i.speaking,onChange:()=>k("speaking"),label:"Speaking"}),e.jsx(W,{checked:i.listening,onChange:()=>k("listening"),label:"Listening"}),e.jsx(W,{checked:i.mimic,onChange:()=>k("mimic"),label:"Pronunciation Queue",icon:Bt}),e.jsx(W,{checked:i.planning,onChange:()=>k("planning"),label:"Planning",icon:Wt})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>{var S;return(S=l.current)==null?void 0:S.click()},className:"py-4 border-2 border-neutral-900 text-neutral-900 rounded-2xl font-black text-xs hover:bg-neutral-50 transition-all flex items-center justify-center space-x-2",children:[e.jsx(be,{size:16})," ",e.jsx("span",{children:"IMPORT"}),e.jsx("input",{type:"file",ref:l,className:"hidden",accept:".json",onChange:d})]}),e.jsxs("button",{onClick:b,className:"py-4 bg-neutral-900 text-white rounded-2xl font-black text-xs hover:bg-neutral-800 transition-all flex items-center justify-center space-x-2",children:[e.jsx($t,{size:16})," ",e.jsx("span",{children:"EXPORT"})]})]})]})}),e.jsx(sa,{junkTags:f,onJunkTagsChange:L}),e.jsxs("div",{className:"pt-4 border-t border-neutral-100 grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:p,disabled:a,className:"w-full py-4 bg-white border border-neutral-200 rounded-2xl text-neutral-600 hover:bg-neutral-50 transition-all flex items-center justify-center space-x-3 group",children:[e.jsx("div",{className:"p-2 bg-neutral-100 group-hover:bg-orange-50 rounded-lg transition-colors",children:a?e.jsx(ne,{size:16,className:"animate-spin text-orange-600"}):e.jsx(Ue,{size:16,className:"text-orange-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-xs font-black uppercase tracking-widest leading-none",children:"Normalize Data"}),e.jsx("div",{className:"text-[9px] font-bold text-neutral-400 mt-1",children:"Clean junk tags & legacy data"})]})]}),e.jsxs("button",{onClick:O,disabled:u,className:"w-full py-4 bg-white border border-neutral-200 rounded-2xl text-neutral-600 hover:bg-neutral-50 transition-all flex items-center justify-center space-x-3 group",children:[e.jsx("div",{className:"p-2 bg-neutral-100 group-hover:bg-blue-50 rounded-lg transition-colors",children:u?e.jsx(ne,{size:16,className:"animate-spin text-blue-600"}):e.jsx(ae,{size:16,className:"text-blue-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-xs font-black uppercase tracking-widest leading-none",children:"Refine from Server"}),e.jsx("div",{className:"text-[9px] font-bold text-neutral-400 mt-1",children:"Update RAW words from Cloud"})]})]})]})]})},ra=({srsConfig:t,onSrsConfigChange:l,onResetSrsConfig:i,onSaveSettings:c})=>e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-purple-50 text-purple-600 rounded-2xl",children:e.jsx(jt,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Spaced Repetition Algorithm"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Customize the learning intervals and multipliers."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-4 pt-4 border-t border-neutral-100",children:[e.jsx("div",{className:"col-span-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Initial Intervals"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"New word (Easy)"}),e.jsx("input",{type:"number",step:"1",min:"1",name:"initialEasy",value:t.initialEasy,onChange:l,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Next review in X days."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"New word (Hard)"}),e.jsx("input",{type:"number",step:"1",min:"1",name:"initialHard",value:t.initialHard,onChange:l,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Next review in X days."})]}),e.jsx("div",{className:"col-span-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 pt-2",children:"Interval Multipliers"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"'Easy' after 'Easy'"}),e.jsx("input",{type:"number",step:"0.1",min:"1",name:"easyEasy",value:t.easyEasy,onChange:l,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Grows interval fastest (e.g., 2.5x)."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"'Easy' after 'Hard'"}),e.jsx("input",{type:"number",step:"0.1",min:"1",name:"hardEasy",value:t.hardEasy,onChange:l,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Helps recover from a 'Hard' rating (e.g., 2.0x)."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"'Hard' after 'Hard'"}),e.jsx("input",{type:"number",step:"0.1",min:"1",name:"hardHard",value:t.hardHard,onChange:l,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Slowly increases interval (e.g., 1.3x)."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"'Hard' after 'Easy' (Penalty)"}),e.jsx("input",{type:"number",step:"0.1",max:"1",name:"easyHardPenalty",value:t.easyHardPenalty,onChange:l,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Reduces interval if you forget (e.g., 0.5x)."})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-neutral-100",children:[e.jsx("button",{onClick:i,type:"button",className:"flex-1 py-3 bg-neutral-100 text-neutral-500 rounded-xl font-bold text-xs uppercase tracking-widest hover:bg-neutral-200 transition-all",children:"Reset Defaults"}),e.jsx("button",{onClick:c,type:"button",className:"flex-1 py-3 bg-neutral-900 text-white rounded-xl font-bold text-xs uppercase tracking-widest hover:bg-neutral-800 transition-all",children:"Save Settings"})]})]}),la=({goalConfig:t,onGoalConfigChange:l,onSaveSettings:i})=>e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-green-50 text-green-600 rounded-2xl",children:e.jsx(vt,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Daily Goals"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Set your daily learning and review targets."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 pt-4 border-t border-neutral-100",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"Max New Words per Day"}),e.jsx("input",{type:"number",step:"1",min:"1",name:"max_learn_per_day",value:t.max_learn_per_day,onChange:l,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Target for learning new vocabulary."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"Max Reviews per Day"}),e.jsx("input",{type:"number",step:"1",min:"1",name:"max_review_per_day",value:t.max_review_per_day,onChange:l,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Target for reviewing existing vocabulary."})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-neutral-100",children:e.jsx("button",{onClick:i,className:"w-full md:w-auto py-3 px-6 bg-neutral-900 text-white rounded-2xl font-black text-xs hover:bg-neutral-800 transition-all flex items-center justify-center space-x-2",children:e.jsx("span",{children:"SAVE GOALS"})})})]}),ia=({onOpenClearProgressModal:t,onOpenNukeModal:l,isAdmin:i,onToggleAdmin:c})=>e.jsxs("section",{className:"bg-red-50 p-8 rounded-[2.5rem] border-2 border-red-100 shadow-sm flex flex-col space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-red-100 text-red-600 rounded-2xl",children:e.jsx(Ne,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-red-900",children:"Danger Zone"}),e.jsx("p",{className:"text-xs text-red-500",children:"Actions in this zone are irreversible."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:c,className:`p-4 border-2 rounded-2xl text-left transition-colors group ${i?"bg-neutral-900 border-neutral-900":"bg-white border-red-100 hover:border-red-500"}`,children:[e.jsxs("div",{className:`font-black flex items-center gap-2 ${i?"text-white":"text-red-600"}`,children:[e.jsx(Ut,{size:16}),i?"Disable Developer Mode":"Enable Developer Mode"]}),e.jsx("div",{className:`text-xs mt-1 ${i?"text-neutral-400":"text-neutral-500"}`,children:i?"Admin tools enabled in Discover.":"Unlocks cheat tools for testing."})]}),e.jsx("div",{className:"hidden md:block"})," ",e.jsxs("button",{onClick:t,className:"p-4 bg-white border-2 border-red-100 rounded-2xl text-left hover:border-red-500 transition-colors group",children:[e.jsx("div",{className:"font-black text-red-600",children:"Clear All Progress"}),e.jsx("div",{className:"text-xs text-neutral-500 mt-1",children:"Reset all SRS data, but keep your words."})]}),e.jsxs("button",{onClick:l,className:"p-4 bg-white border-2 border-red-100 rounded-2xl text-left hover:border-red-500 transition-colors group",children:[e.jsx("div",{className:"font-black text-red-600",children:"Reset Full Library"}),e.jsx("div",{className:"text-xs text-neutral-500 mt-1",children:"Delete ALL your data and restore the app to its initial state."})]})]})]}),oa=({audioBlob:t,onTrim:l,onCancel:i})=>{const c=r.useRef(null),[d,b]=r.useState(null),[a,p]=r.useState(null),[f,L]=r.useState(0),[j,x]=r.useState(1),[u,z]=r.useState(!1),C=r.useRef(null);r.useRef(0),r.useEffect(()=>((async()=>{const N=new(window.AudioContext||window.webkitAudioContext),w=await t.arrayBuffer(),E=await N.decodeAudioData(w);b(N),p(E),k(E,0,1)})(),()=>{d&&d.close()}),[t]);const k=(v,N,w)=>{const E=c.current;if(!E)return;const o=E.getContext("2d");if(!o)return;const g=E.width,y=E.height;o.clearRect(0,0,g,y);const P=v.getChannelData(0),U=Math.ceil(P.length/g),A=y/2;o.fillStyle="#e5e7eb",o.fillRect(0,0,g,y),o.fillStyle="#6366f1",o.beginPath();for(let V=0;V<g;V++){let D=1,J=-1;for(let X=0;X<U;X++){const G=P[V*U+X];G<D&&(D=G),G>J&&(J=G)}o.fillRect(V,(1+D)*A,1,Math.max(1,(J-D)*A))}o.fillStyle="rgba(0, 0, 0, 0.4)";const M=N*g,B=w*g;o.fillRect(0,0,M,y),o.fillRect(B,0,g-B,y),o.fillStyle="#ef4444",o.fillRect(M-2,0,4,y),o.fillRect(B-2,0,4,y)};r.useEffect(()=>{a&&k(a,f,j)},[f,j,a]);const O=()=>{var g;if(!d||!a)return;if(u){(g=C.current)==null||g.stop(),z(!1);return}const v=a.duration,N=v*f,E=v*j-N,o=d.createBufferSource();o.buffer=a,o.connect(d.destination),o.start(0,N,E),o.onended=()=>z(!1),C.current=o,z(!0)},S=async()=>{if(!d||!a)return;const{bufferToWav:v}=await Nt(async()=>{const{bufferToWav:y}=await import("./index-DGJ8pI6b.js").then(P=>P.cg);return{bufferToWav:y}},[]);a.duration;const N=Math.floor(f*a.length),w=Math.floor(j*a.length),E=w-N,o=d.createBuffer(a.numberOfChannels,E,a.sampleRate);for(let y=0;y<a.numberOfChannels;y++){const P=a.getChannelData(y);o.getChannelData(y).set(P.subarray(N,w))}const g=v(o);l(g)},m=v=>{const N=c.current;if(!N)return;const w=N.getBoundingClientRect(),E=v.clientX-w.left,o=Math.max(0,Math.min(1,E/w.width)),g=Math.abs(o-f),y=Math.abs(o-j),P=g<y,U=M=>{const B=M.clientX-w.left,V=Math.max(0,Math.min(1,B/w.width));P?L(Math.min(V,j-.05)):x(Math.max(V,f+.05))},A=()=>{window.removeEventListener("mousemove",U),window.removeEventListener("mouseup",A)};window.addEventListener("mousemove",U),window.addEventListener("mouseup",A)};return e.jsxs("div",{className:"flex flex-col gap-4 p-4 bg-white rounded-2xl border border-neutral-200",children:[e.jsx("div",{className:"relative h-24 bg-neutral-100 rounded-xl overflow-hidden cursor-pointer",onMouseDown:m,children:e.jsx("canvas",{ref:c,width:600,height:100,className:"w-full h-full"})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("button",{onClick:O,className:"flex items-center gap-2 px-4 py-2 bg-neutral-900 text-white rounded-xl text-xs font-bold uppercase tracking-wider hover:bg-neutral-800 transition-all",children:[u?e.jsx(Kt,{size:14}):e.jsx(Me,{size:14}),u?"Stop":"Preview"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:i,className:"px-4 py-2 text-neutral-500 hover:text-neutral-900 font-bold text-xs",children:"Cancel"}),e.jsxs("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-xl text-xs font-bold uppercase tracking-wider hover:bg-indigo-500 transition-all",children:[e.jsx(Yt,{size:14})," Trim & Use"]})]})]}),e.jsx("p",{className:"text-[10px] text-neutral-400 text-center",children:"Drag the red bars to trim audio."})]})},ca=["localhost","macm2.local","macm4.local"],da=({config:t,onConfigChange:l,onSaveSettings:i})=>{const[c,d]=r.useState("checking"),[b,a]=r.useState(!1),[p,f]=r.useState({}),[L,j]=r.useState(""),[x,u]=r.useState(""),[z,C]=r.useState(!1),[k,O]=r.useState(!1),[S,m]=r.useState(null),[v,N]=r.useState(null),[w,E]=r.useState(""),[o,g]=r.useState(""),[y,P]=r.useState(!1),U=r.useRef(null),{showToast:A}=re(),M=Ie(t),B=async()=>{C(!0);try{const n=await fetch(`${M}/api/audio/mappings`);n.ok&&f(await n.json())}catch(n){console.error("Failed to fetch mappings",n)}finally{C(!1)}},V=async()=>{d("checking");try{(await fetch(`${M}/api/health`)).ok?(d("connected"),a(!1),B()):(d("error"),a(!0))}catch{d("error"),a(!0)}};r.useEffect(()=>{V()},[M]),r.useEffect(()=>{c==="connected"&&!t.sync.autoBackupEnabled&&l("sync","autoBackupEnabled",!0)},[c]);const D=n=>{l("server",null,{...t.server,...n})},J=n=>{D({useCustomUrl:n.target.checked})},X=async()=>{if(!(!L||!x))try{const I=await(await fetch(`${M}/api/audio/mappings`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:L,path:x})})).json();I.success?(f(I.mappings),j(""),u(""),A("Mapping added!","success")):A(I.error||"Failed to add mapping","error")}catch{A("Connection error","error")}},G=async n=>{try{const _=await(await fetch(`${M}/api/audio/mappings/${encodeURIComponent(n)}`,{method:"DELETE"})).json();_.success&&f(_.mappings)}catch{A("Failed to delete","error")}},le=async()=>{await At(),O(!0),m(null),N(null)},ee=async()=>{const n=await St();if(O(!1),n){const I=atob(n.base64),_=new Array(I.length);for(let K=0;K<I.length;K++)_[K]=I.charCodeAt(K);const te=new Uint8Array(_),F=new Blob([te],{type:n.mimeType});m(F),N(F)}},ie=n=>{var _;const I=(_=n.target.files)==null?void 0:_[0];I&&(m(I),N(I),g(I.name))},ye=async()=>{if(!v||!w||!o){A("Please select audio, target folder, and filename.","error");return}P(!0);const n=new FormData;n.append("mapName",w),n.append("filename",o),n.append("audio",v,o);try{const _=await(await fetch(`${M}/api/audio/upload`,{method:"POST",body:n})).json();_.success?(A("Audio uploaded successfully!","success"),m(null),N(null),g("")):A(_.error||"Upload failed","error")}catch{A("Upload error","error")}finally{P(!1)}};return e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-neutral-100 text-neutral-600 rounded-2xl",children:e.jsx(_e,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Server & Connection"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Manage connection and audio mappings."})]})]}),e.jsxs("button",{onClick:i,className:"px-5 py-2.5 bg-neutral-900 text-white rounded-xl font-black text-[10px] flex items-center space-x-2 active:scale-95 uppercase tracking-widest hover:bg-neutral-800 transition-all",children:[e.jsx(je,{size:14}),e.jsx("span",{children:"Save"})]})]}),e.jsxs("div",{className:"p-6 bg-neutral-50 rounded-[2rem] border border-neutral-100 space-y-6",children:[e.jsxs("div",{className:`flex items-center justify-between px-4 py-3 rounded-xl border ${c==="connected"?"bg-emerald-50 border-emerald-200":"bg-white border-neutral-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[c==="checking"&&e.jsx(ne,{size:18,className:"animate-spin text-neutral-400"}),c==="connected"&&e.jsx(se,{size:18,className:"text-emerald-500"}),c==="error"&&e.jsx(Pe,{size:18,className:"text-red-500"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Status"}),e.jsx("span",{className:`text-sm font-bold ${c==="connected"?"text-emerald-700":c==="error"?"text-red-600":"text-neutral-600"}`,children:c==="checking"?"Checking...":c==="connected"?"Active":"Disconnected"})]})]}),c==="connected"?e.jsx("button",{onClick:()=>a(!b),className:"flex items-center gap-2 px-3 py-1.5 bg-white border border-neutral-200 rounded-lg text-[10px] font-black uppercase text-neutral-500 hover:text-indigo-600 hover:border-indigo-200 transition-colors",children:b?"Hide Config":"Configure"}):e.jsxs("button",{onClick:V,className:"flex items-center gap-2 px-3 py-1.5 bg-neutral-900 text-white rounded-lg text-[10px] font-black uppercase hover:bg-neutral-700 transition-colors",children:[e.jsx(yt,{size:12})," Try Connect"]})]}),(c!=="connected"||b)&&e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-top-2 pt-2 border-t border-neutral-200/50",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[e.jsx(wt,{size:10})," Host Details"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("label",{className:"text-[10px] font-bold text-neutral-500 cursor-pointer flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.server.useCustomUrl,onChange:J,className:"accent-indigo-600 w-3 h-3"}),"Custom URL"]})})]}),t.server.useCustomUrl?e.jsx("input",{type:"text",value:t.server.customUrl,onChange:n=>D({customUrl:n.target.value}),placeholder:"https://myserver.local:3000",className:"w-full px-4 py-2.5 bg-white border border-neutral-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none"}):e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"col-span-2 relative",children:[e.jsx("select",{value:t.server.host,onChange:n=>D({host:n.target.value}),className:"w-full h-full appearance-none bg-white border border-neutral-200 rounded-xl px-4 py-2.5 text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none pr-10",children:ca.map(n=>e.jsx("option",{value:n,children:n},n))}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-neutral-400",children:e.jsx(ve,{size:16})})]}),e.jsx("input",{type:"number",value:t.server.port,onChange:n=>D({port:parseInt(n.target.value)||3e3}),className:"w-full px-4 py-2.5 bg-white border border-neutral-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]}),e.jsxs("div",{className:"p-3 bg-blue-50 rounded-xl border border-blue-100 flex gap-2",children:[e.jsx(Re,{size:14,className:"text-blue-500 shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-[10px] text-blue-700 font-medium leading-tight",children:["Server must run on HTTPS. If stuck, try opening ",e.jsx("a",{href:`${M}/api/health`,target:"_blank",rel:"noreferrer",className:"underline font-bold",children:"Health Check"})," to verify certificate."]})]})]}),c==="connected"&&e.jsxs("div",{className:"space-y-5 pt-4 border-t border-neutral-200/50 animate-in fade-in",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest px-1 flex items-center gap-1",children:[e.jsx(kt,{size:10})," Directory Mappings"]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-neutral-200 overflow-hidden",children:[Object.entries(p).length===0?e.jsx("div",{className:"p-6 text-center text-xs text-neutral-400",children:"No mappings configured."}):e.jsx("div",{className:"divide-y divide-neutral-200",children:Object.entries(p).map(([n,I])=>e.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-neutral-50 transition-colors group",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gt,{size:14,className:"text-indigo-500"}),e.jsx("span",{className:"font-bold text-sm text-neutral-800",children:n})]}),e.jsx("div",{className:"text-[10px] text-neutral-500 font-mono mt-1 ml-6",children:I})]}),e.jsx("button",{onClick:()=>G(n),className:"p-2 text-neutral-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all opacity-0 group-hover:opacity-100",children:e.jsx(Oe,{size:14})})]},n))}),e.jsxs("div",{className:"p-4 bg-neutral-50 border-t border-neutral-200 flex flex-col md:flex-row gap-3",children:[e.jsx("input",{value:L,onChange:n=>j(n.target.value),placeholder:"Logical Name (e.g. 'Cam15')",className:"flex-1 px-3 py-2 bg-white border border-neutral-200 rounded-xl text-xs font-bold outline-none focus:border-indigo-500"}),e.jsx("input",{value:x,onChange:n=>u(n.target.value),placeholder:"Physical Path (e.g. ~/Music/Cam15)",className:"flex-[2] px-3 py-2 bg-white border border-neutral-200 rounded-xl text-xs font-medium outline-none focus:border-indigo-500"}),e.jsxs("button",{onClick:X,disabled:!L||!x,className:"px-4 py-2 bg-neutral-900 text-white rounded-xl font-bold text-xs flex items-center gap-2 hover:bg-neutral-800 disabled:opacity-50",children:[e.jsx(De,{size:14})," Add"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[e.jsx(Ct,{size:10})," Backup Debounce Time"]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border border-neutral-200 rounded-xl",children:[e.jsx("input",{type:"range",min:"5",max:"300",step:"5",value:t.sync.autoBackupInterval,onChange:n=>l("sync","autoBackupInterval",parseInt(n.target.value)),className:"flex-1 h-2 bg-neutral-100 rounded-lg appearance-none cursor-pointer accent-neutral-900"}),e.jsxs("div",{className:"w-16 text-center font-black text-sm text-neutral-900",children:[t.sync.autoBackupInterval,"s"]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-neutral-200/50",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest px-1 flex items-center gap-1",children:[e.jsx(me,{size:10})," Audio Tool"]}),S?e.jsxs("div",{className:"space-y-4",children:[e.jsx(oa,{audioBlob:S,onTrim:n=>{N(n),A("Trimmed!","success")},onCancel:()=>{m(null),N(null)}}),e.jsxs("div",{className:"p-4 bg-white rounded-2xl border border-neutral-200 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-black uppercase text-neutral-400 px-1",children:"Target Folder"}),e.jsxs("select",{value:w,onChange:n=>E(n.target.value),className:"w-full px-3 py-2 rounded-xl border border-neutral-200 text-xs font-bold bg-white focus:ring-2 focus:ring-neutral-900 outline-none",children:[e.jsx("option",{value:"",children:"Select Mapping..."}),Object.keys(p).map(n=>e.jsx("option",{value:n,children:n},n))]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-black uppercase text-neutral-400 px-1",children:"Filename"}),e.jsx("input",{value:o,onChange:n=>g(n.target.value),placeholder:"track_01.wav",className:"w-full px-3 py-2 rounded-xl border border-neutral-200 text-xs font-bold bg-white focus:ring-2 focus:ring-neutral-900 outline-none"})]})]}),e.jsxs("button",{onClick:ye,disabled:y||!w||!o,className:"w-full py-3 bg-neutral-900 text-white rounded-xl font-black text-xs uppercase tracking-widest hover:bg-neutral-800 disabled:opacity-50 transition-all flex items-center justify-center gap-2",children:[y?e.jsx(ne,{size:14,className:"animate-spin"}):e.jsx(be,{size:14}),e.jsx("span",{children:"Upload to Server"})]})]})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:k?ee:le,className:`p-6 rounded-2xl border-2 border-dashed flex flex-col items-center justify-center gap-2 transition-all ${k?"bg-red-50 border-red-400 text-red-600 animate-pulse":"bg-white border-neutral-200 text-neutral-500 hover:border-indigo-400 hover:text-indigo-600"}`,children:[e.jsx(me,{size:24}),e.jsx("span",{className:"font-bold text-xs",children:k?"Stop Recording":"Record Voice"})]}),e.jsxs("button",{onClick:()=>{var n;return(n=U.current)==null?void 0:n.click()},className:"p-6 rounded-2xl border-2 border-dashed bg-white border-neutral-200 text-neutral-500 flex flex-col items-center justify-center gap-2 transition-all hover:border-indigo-400 hover:text-indigo-600",children:[e.jsx(be,{size:24}),e.jsx("span",{className:"font-bold text-xs",children:"Upload File"}),e.jsx("input",{type:"file",ref:U,className:"hidden",accept:"audio/*",onChange:ie})]})]})]})]})]})]})},xe=[{id:"PROFILE",label:"Profile",icon:fe},{id:"INTERFACE",label:"Interface Defaults",icon:qt},{id:"SERVER",label:"Server & Connection",icon:_e},{id:"AUDIO_COACH",label:"Audio Coach",icon:Te},{id:"LEARNING",label:"Learning",icon:Le},{id:"DATA",label:"Data Management",icon:zt},{id:"DANGER",label:"Danger Zone",icon:Ne,color:"text-red-500"}],xa=t=>{const{currentView:l,isDropdownOpen:i,notification:c,importStatus:d,setCurrentView:b,setIsDropdownOpen:a,mobileNavRef:p,children:f}=t,L=xe.find(x=>x.id===l),j=()=>{var x,u,z,C,k;switch(l){case"PROFILE":return e.jsx(ta,{profileData:t.profileData,onProfileChange:t.onProfileChange,onAvatarChange:t.onAvatarChange,onSaveProfile:t.onSaveProfile});case"SERVER":return e.jsx(da,{config:t.config,onConfigChange:t.onConfigChange,onSaveSettings:t.onSaveSettings});case"AUDIO_COACH":return e.jsx(aa,{config:t.config,onConfigChange:t.onConfigChange,onSaveSettings:t.onSaveSettings});case"DATA":return e.jsxs("div",{className:"space-y-6",children:[e.jsx(na,{jsonInputRef:t.jsonInputRef,dataScope:t.dataScope,onDataScopeChange:t.onDataScopeChange,onJSONImport:t.onJSONImport,onJSONExport:t.onJSONExport,isNormalizing:t.isNormalizing,onOpenNormalizeModal:t.onOpenNormalizeModal,junkTags:t.junkTags,onJunkTagsChange:t.onJunkTagsChange,normalizeOptions:t.normalizeOptions,onNormalizeOptionsChange:t.onNormalizeOptionsChange}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-neutral-200 shadow-sm animate-in fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-50 text-indigo-600 rounded-xl",children:e.jsx(Ht,{size:20})}),e.jsx("h3",{className:"font-black text-lg text-neutral-900",children:"System Diagnostics"})]}),e.jsx("button",{onClick:t.onRunDiagnostics,className:"px-4 py-2 bg-neutral-900 text-white rounded-xl text-xs font-bold uppercase tracking-widest hover:bg-neutral-800 transition-all active:scale-95",children:"Run Check"})]}),t.dbStats?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest px-1",children:"Database Stores"}),e.jsx("div",{className:"bg-neutral-50 rounded-xl p-3 border border-neutral-100 text-xs font-mono space-y-1",children:Object.entries(t.dbStats).map(([O,S])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[O,":"]}),e.jsx("span",{className:S===-1?"text-red-500 font-bold":"text-neutral-900 font-bold",children:S===-1?"ERROR":S})]},O))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest px-1",children:"Safety Lock Status"}),e.jsxs("div",{className:`p-4 rounded-xl border ${(x=t.lsHealth)!=null&&x.hasBackup?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[(u=t.lsHealth)!=null&&u.hasBackup?e.jsx(se,{size:16,className:"text-green-600"}):e.jsx(Ne,{size:16,className:"text-red-600"}),e.jsx("span",{className:`font-bold text-sm ${(z=t.lsHealth)!=null&&z.hasBackup?"text-green-900":"text-red-900"}`,children:(C=t.lsHealth)!=null&&C.hasBackup?"Emergency Backup Active":"No Emergency Backup Found"})]}),((k=t.lsHealth)==null?void 0:k.hasBackup)&&e.jsxs("div",{className:"text-xs text-green-700 space-y-1",children:[e.jsxs("p",{children:["Size: ",(t.lsHealth.backupSize/1024).toFixed(1)," KB"]}),e.jsxs("p",{children:["Last Sync: ",t.lsHealth.backupTimestamp]})]})]})]})]}):e.jsx("p",{className:"text-center text-neutral-400 text-xs italic py-4",children:'Click "Run Check" to inspect internal database state.'})]})]});case"LEARNING":return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsx(la,{goalConfig:t.goalConfig,onGoalConfigChange:t.onGoalConfigChange,onSaveSettings:t.onSaveSettings}),e.jsx(ra,{srsConfig:t.config.srs,onSrsConfigChange:t.onSrsConfigChange,onResetSrsConfig:t.onResetSrsConfig,onSaveSettings:t.onSaveSettings})]});case"DANGER":return e.jsx(ia,{onOpenClearProgressModal:t.onOpenClearProgressModal,onOpenNukeModal:t.onOpenNukeModal,isAdmin:t.isAdmin,onToggleAdmin:t.onToggleAdmin});case"INTERFACE":return null;default:return null}};return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-10 pb-20",children:[e.jsxs("header",{children:[e.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:"Settings"}),e.jsx("p",{className:"text-neutral-500 mt-1 font-medium",children:"Manage your data and personalize your learning experience."})]}),c&&e.jsxs("div",{className:"fixed top-10 left-1/2 -translate-x-1/2 z-[300] bg-neutral-900 text-white px-6 py-3 rounded-2xl shadow-2xl border border-neutral-800 animate-in slide-in-from-top-4 flex items-center space-x-2",children:[e.jsx(se,{size:18,className:"text-green-400"}),e.jsx("span",{className:"text-sm font-bold",children:c})]}),d&&e.jsx("div",{className:`p-6 rounded-[2rem] border-2 animate-in slide-in-from-top-4 ${d.type==="success"?"bg-green-50 border-green-100 text-green-700":"bg-red-50 border-red-100 text-red-700"}`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[d.type==="success"?e.jsx(se,{size:24}):e.jsx(Pe,{size:24}),e.jsxs("div",{children:[e.jsx("div",{className:"font-black text-lg",children:d.message}),d.detail&&e.jsx("div",{className:"text-sm opacity-80 mt-1 font-medium",children:d.detail})]})]})}),e.jsxs("div",{className:"relative lg:hidden mb-6",ref:p,children:[e.jsxs("button",{onClick:()=>a(!i),className:"w-full flex items-center justify-between text-left px-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm font-bold text-neutral-900 hover:bg-neutral-50 transition-colors shadow-sm",children:[L&&e.jsxs("span",{className:"flex items-center space-x-3",children:[e.jsx(L.icon,{size:18,className:L.color}),e.jsx("span",{children:L.label})]}),e.jsx(ve,{size:18,className:`text-neutral-400 transition-transform ${i?"rotate-180":""}`})]}),i&&e.jsx("div",{className:"absolute top-full mt-2 w-full bg-white rounded-2xl shadow-lg border border-neutral-100 z-20 p-2 animate-in fade-in duration-150",children:xe.map(x=>e.jsxs("button",{onClick:()=>{b(x.id),a(!1)},className:`w-full text-left flex items-center space-x-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${l===x.id?"bg-neutral-900 text-white":`${x.color||"text-neutral-700"} hover:bg-neutral-50`}`,children:[e.jsx(x.icon,{size:16}),e.jsx("span",{children:x.label})]},x.id))})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-12",children:[e.jsx("aside",{className:"hidden lg:block lg:w-1/4",children:e.jsx("nav",{className:"space-y-1.5",children:xe.map(x=>e.jsxs("button",{onClick:()=>b(x.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-xl font-bold text-sm transition-colors ${l===x.id?"bg-neutral-100 text-neutral-900":`${x.color||"text-neutral-500"} hover:bg-neutral-50 hover:text-neutral-900`}`,children:[e.jsx(x.icon,{size:18}),e.jsx("span",{children:x.label})]},x.id))})}),e.jsx("main",{className:"flex-1 lg:w-3/4",children:e.jsxs("div",{className:"animate-in fade-in duration-300",children:[j(),f]},l)})]})]})},$=({checked:t,onChange:l,label:i,subLabel:c,icon:d})=>e.jsxs("label",{onClick:b=>{b.preventDefault(),l(!t)},className:"flex items-center justify-between px-4 py-3 cursor-pointer group hover:bg-neutral-50 rounded-xl transition-all border border-transparent hover:border-neutral-100",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[d&&e.jsx(d,{size:14,className:t?"text-neutral-900":"text-neutral-400"}),e.jsx("span",{className:"text-xs font-bold text-neutral-700 group-hover:text-neutral-900",children:i})]}),c&&e.jsx("span",{className:"text-[10px] text-neutral-400 font-medium",children:c})]}),e.jsx("div",{className:`w-9 h-5 rounded-full transition-all flex items-center p-1 ${t?"bg-neutral-900":"bg-neutral-200"}`,children:e.jsx("div",{className:`w-3.5 h-3.5 bg-white rounded-full shadow-sm transition-transform ${t?"translate-x-4":"translate-x-0"}`})})]}),ua=()=>{const[t,l]=r.useState(()=>{try{const a=localStorage.getItem("ielts_pro_library_view_settings");return a?{...de,...JSON.parse(a)}:de}catch{return de}}),[i,c]=r.useState(()=>{const a={showHidden:!1,highlightFailed:!0,isLearnView:!0};try{const p=localStorage.getItem("ielts_pro_word_view_settings");return p?{...a,...JSON.parse(p)}:a}catch{return a}}),d=(a,p)=>{const f={...t,[a]:p};l(f),localStorage.setItem("ielts_pro_library_view_settings",JSON.stringify(f))},b=(a,p)=>{const f={...i,[a]:p};c(f),localStorage.setItem("ielts_pro_word_view_settings",JSON.stringify(f))};return e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-8 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-teal-50 text-teal-600 rounded-2xl",children:e.jsx(Ae,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Interface Defaults"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Customize what you see across the app library and cards."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:[e.jsx(Qt,{size:12})," Word Library Columns"]}),e.jsxs("div",{className:"bg-white border border-neutral-200 rounded-2xl p-1 grid grid-cols-1 md:grid-cols-2 gap-x-4",children:[e.jsx($,{checked:t.showMeaning,onChange:a=>d("showMeaning",a),label:"Definition / Meaning"}),e.jsx($,{checked:t.blurMeaning,onChange:a=>d("blurMeaning",a),label:"Blur Definition (Spoiler)",subLabel:"Hide meaning until hovered"}),e.jsx($,{checked:t.showIPA,onChange:a=>d("showIPA",a),label:"IPA Phonetic"}),e.jsx($,{checked:t.showProgress,onChange:a=>d("showProgress",a),label:"Progress Badge"}),e.jsx($,{checked:t.showDue,onChange:a=>d("showDue",a),label:"Due Date"}),e.jsx($,{checked:t.showAiIcon,onChange:a=>d("showAiIcon",a),label:"AI Refined Indicator"}),e.jsx($,{checked:t.showComplexity,onChange:a=>d("showComplexity",a),label:"Complexity Column"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:[e.jsx(Ae,{size:12})," Word Detail View"]}),e.jsxs("div",{className:"bg-white border border-neutral-200 rounded-2xl p-1 grid grid-cols-1 md:grid-cols-2 gap-x-4",children:[e.jsx($,{checked:i.isLearnView,onChange:a=>b("isLearnView",a),label:"Learn View by Default",subLabel:"Hides extra info like examples, tags"}),e.jsx($,{checked:i.highlightFailed,onChange:a=>b("highlightFailed",a),label:"Highlight Failed Tests",subLabel:"Red highlight for failed drill items"}),e.jsx($,{checked:i.showHidden,onChange:a=>b("showHidden",a),label:"Show Ignored Items",subLabel:"Show ignored collocations/family members"})]})]})]})},Ca=({user:t,onUpdateUser:l,onRefresh:i,onNuke:c,apiUsage:d})=>{var we,ke;const b=r.useRef(null),a=r.useRef(null),{showToast:p}=re(),[f,L]=r.useState(()=>{const s=sessionStorage.getItem("vocab_pro_settings_tab");return s?(sessionStorage.removeItem("vocab_pro_settings_tab"),s):"PROFILE"});r.useEffect(()=>{const s=sessionStorage.getItem("vocab_pro_settings_tab");s&&(sessionStorage.removeItem("vocab_pro_settings_tab"),L(s))},[]);const[j,x]=r.useState(!1),[u,z]=r.useState({user:!0,vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,mimic:!0,wordBook:!0,planning:!0}),[C,k]=r.useState(null),[O,S]=r.useState(!1),[m,v]=r.useState(!1),[N,w]=r.useState(!1),[E,o]=r.useState(null),[g,y]=r.useState(!1),[P,U]=r.useState(!1),[A,M]=r.useState({removeJunkTags:!0,removeMultiWordData:!0,cleanHeadwords:!0}),[B,V]=r.useState(""),[D,J]=r.useState(ze()),[X,G]=r.useState([]),[le,ee]=r.useState(!0),[ie,ye]=r.useState(!1),[n,I]=r.useState(null),[_,te]=r.useState(null),[F,K]=r.useState({name:t.name,avatar:t.avatar,role:t.role||"",currentLevel:t.currentLevel||"",target:t.target||"",nativeLanguage:t.nativeLanguage||"English",lessonLanguage:((we=t.lessonPreferences)==null?void 0:we.language)||"English",lessonAudience:((ke=t.lessonPreferences)==null?void 0:ke.targetAudience)||"Adult"});r.useEffect(()=>{var s,h;K({name:t.name,avatar:t.avatar,role:t.role||"",currentLevel:t.currentLevel||"",target:t.target||"",nativeLanguage:t.nativeLanguage||"English",lessonLanguage:((s=t.lessonPreferences)==null?void 0:s.language)||"English",lessonAudience:((h=t.lessonPreferences)==null?void 0:h.targetAudience)||"Adult"})},[t]),r.useEffect(()=>{const s=localStorage.getItem("gemini_api_keys")||"";if(V(s),E){const h=setTimeout(()=>o(null),4e3);return()=>clearTimeout(h)}},[E]),r.useEffect(()=>{(async()=>{ee(!0);const R=await Tt();G(R),ee(!1)})();const h=()=>{J(ze())};return window.addEventListener("config-updated",h),()=>{window.removeEventListener("config-updated",h)}},[]),r.useEffect(()=>{const s=h=>{a.current&&!a.current.contains(h.target)&&x(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const Q=(s,h,R)=>{J(H=>{const q={...H};return h===null&&typeof R=="object"?q[s]=R:q[s]={...H[s],[h]:R},q})},Fe=s=>{Q("interface","junkTags",s)},He=s=>{K(h=>({...h,[s.target.name]:s.target.value}))},Be=s=>{K(h=>({...h,avatar:s}))},We=async()=>{const s={...t,name:F.name.trim()||t.name,role:F.role.trim(),currentLevel:F.currentLevel.trim(),target:F.target.trim(),nativeLanguage:F.nativeLanguage,avatar:F.avatar,lessonPreferences:{language:F.lessonLanguage,targetAudience:F.lessonAudience.trim(),tone:D.audioCoach.coaches[D.audioCoach.activeCoach].persona}};await l(s),o("Profile & Preferences updated successfully!")},$e=()=>{localStorage.setItem("gemini_api_keys",B.trim()),o("API Keys have been saved locally.")},Je=()=>{localStorage.removeItem("vocab_pro_api_usage"),window.dispatchEvent(new CustomEvent("apiUsageUpdated")),o("API usage counter has been reset.")},Ge=s=>{Q("srs",s.target.name,parseFloat(s.target.value))},Ke=s=>{const h=s.target.type==="checkbox"?s.target.checked:s.target.value;Q("ai",s.target.name,h)},qe=s=>{Q("dailyGoals",s.target.name,parseInt(s.target.value,10))},Xe=()=>{he(D),o("Settings saved!")},Ye=()=>{J(s=>({...s,srs:Mt})),o("SRS settings reset to defaults.")},Qe=async s=>{var H;const h=(H=s.target.files)==null?void 0:H[0];if(!h)return;k(null);const R=await Ot(h,t.id,u);k(R),R.type==="success"&&(p("Restore successful! The app will now reload.","success",2e3),R.updatedUser&&await Pt(R.updatedUser),setTimeout(()=>{window.location.reload()},2e3)),b.current&&(b.current.value="")},Ze=async()=>{await Dt(t.id,t,u)},et=async()=>{w(!0);try{const h=(await pe()).map(R=>Vt(R));await ge(h),o("All learning progress has been reset.")}catch(s){k({type:"error",message:"Failed to clear progress",detail:s.message})}finally{w(!1),v(!1)}},tt=async()=>{U(!0),y(!1);let s=0;const h=new Set(D.interface.junkTags.map(R=>R.toLowerCase()));try{const R=pe(),H=[];for(const nt of R){let Z=!1;const T={...nt};if(A.removeJunkTags&&h.size>0&&T.tags){const Ce=T.tags.length;T.tags=T.tags.filter(rt=>!h.has(rt.toLowerCase())),T.tags.length!==Ce&&(Z=!0)}A.removeMultiWordData&&(T.isIdiom||T.isPhrasalVerb||T.isCollocation||T.isStandardPhrase)&&(T.wordFamily&&(T.wordFamily=void 0,Z=!0),T.collocationsArray&&T.collocationsArray.length>0&&(T.collocations=void 0,T.collocationsArray=void 0,Z=!0)),A.cleanHeadwords&&T.word&&T.word.includes('"')&&(T.word=T.word.replace(/"/g,"").trim(),Z=!0),Z&&(T.updatedAt=Date.now(),H.push(T))}s=H.length,s>0&&await ge(H);let q=`Normalized ${s} item(s).`;s===0&&(q="No items needed normalization based on selected options."),p(q,"success")}catch(R){p("Failed to normalize data.","error"),console.error("Normalization Error:",R)}finally{U(!1)}},at=async()=>{I(null),te(null);const s=await Lt();I(s);const h=Rt();te(h),p("Diagnostic run complete.","info")},st=async()=>{await l({...t,isAdmin:!t.isAdmin}),o(`Developer Mode ${t.isAdmin?"Disabled":"Enabled"}`)},oe=({id:s,label:h,checked:R,onChange:H})=>e.jsxs("label",{htmlFor:s,className:"flex items-center gap-2 p-3 bg-neutral-50 rounded-lg border border-neutral-200 cursor-pointer",children:[e.jsx("input",{id:s,type:"checkbox",checked:R,onChange:q=>H(q.target.checked),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("span",{className:"text-sm font-medium",children:h})]});return e.jsxs(e.Fragment,{children:[e.jsx(xa,{currentView:f,isDropdownOpen:j,notification:E,importStatus:C,profileData:F,config:D,isVoiceLoading:le,availableVoices:X,apiKeyInput:B,apiUsage:d,jsonInputRef:b,dataScope:u,onDataScopeChange:z,mobileNavRef:a,setCurrentView:L,setIsDropdownOpen:x,onProfileChange:He,onAvatarChange:Be,onSaveProfile:We,onConfigChange:Q,onAiConfigChange:Ke,onApiKeyInputChange:s=>V(s.target.value),onSaveApiKeys:$e,onResetUsage:Je,onSaveSettings:Xe,onJSONImport:Qe,onJSONExport:Ze,onSrsConfigChange:Ge,onResetSrsConfig:Ye,onOpenClearProgressModal:()=>v(!0),onOpenNukeModal:()=>S(!0),isNormalizing:P,onOpenNormalizeModal:()=>y(!0),isApplyingAccent:ie,onApplyAccent:()=>{},isAdmin:!!t.isAdmin,onToggleAdmin:st,junkTags:D.interface.junkTags,onJunkTagsChange:Fe,normalizeOptions:A,onNormalizeOptionsChange:M,goalConfig:D.dailyGoals,onGoalConfigChange:qe,dbStats:n,lsHealth:_,onRunDiagnostics:at,children:f==="INTERFACE"&&e.jsx(ua,{})}),e.jsx(ce,{isOpen:O,title:"Delete all data?",message:e.jsxs(e.Fragment,{children:["This will permanently delete ",e.jsx("strong",{className:"text-red-600",children:"ALL"})," vocabulary, progress, and profiles. This action cannot be undone."]}),confirmText:"YES, DELETE EVERYTHING",isProcessing:!1,onConfirm:()=>{c(),S(!1)},onClose:()=>S(!1),confirmButtonClass:"bg-red-600 text-white hover:bg-red-700 shadow-red-200",icon:e.jsx(Et,{size:40,className:"text-red-500"})}),e.jsx(ce,{isOpen:m,title:"Clear All Progress?",message:"This will reset the review schedule for ALL words in your library. Your words and their content will NOT be deleted. This action cannot be undone.",confirmText:"Yes, Clear Progress",isProcessing:N,onConfirm:et,onClose:()=>v(!1),icon:e.jsx(It,{size:40,className:"text-orange-500"}),confirmButtonClass:"bg-orange-50 text-white hover:bg-orange-600 shadow-orange-200"}),e.jsx(ce,{isOpen:g,title:"Normalize Data",message:e.jsxs("div",{className:"space-y-4 text-left",children:[e.jsx("p",{children:"Select normalization actions to perform. This process will update your entire library and cannot be undone."}),e.jsx(oe,{id:"norm-junk",label:"Remove junk tags from all words",checked:A.removeJunkTags,onChange:s=>M(h=>({...h,removeJunkTags:s}))}),e.jsx(oe,{id:"norm-multi",label:"Clean multi-word items (phrases, idioms)",checked:A.removeMultiWordData,onChange:s=>M(h=>({...h,removeMultiWordData:s}))}),e.jsx(oe,{id:"norm-quotes",label:"Clean headwords (remove quotes)",checked:A.cleanHeadwords,onChange:s=>M(h=>({...h,cleanHeadwords:s}))})]}),confirmText:"Yes, Normalize",isProcessing:P,onConfirm:tt,onClose:()=>y(!1),icon:e.jsx(Ue,{size:40,className:"text-orange-500"}),confirmButtonClass:"bg-orange-50 text-white hover:bg-orange-600 shadow-orange-200"})]})};export{Ca as SettingsView};
