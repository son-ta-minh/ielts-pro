import{c as X,r as c,j as i,aj as z,bV as I}from"./index-a2ud5-rM.js";import{P as W}from"./pause-DTrpErzD.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=X("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),$=({audioBlob:C,onTrim:k,onCancel:E})=>{const y=c.useRef(null),[f,A]=c.useState(null),[n,N]=c.useState(null),[h,B]=c.useState(0),[x,_]=c.useState(1),[M,S]=c.useState(!1),P=c.useRef(null);c.useRef(0),c.useEffect(()=>((async()=>{const a=new(window.AudioContext||window.webkitAudioContext),r=await C.arrayBuffer(),o=await a.decodeAudioData(r);A(a),N(o),D(o,0,1)})(),()=>{f&&f.close()}),[C]);const D=(l,a,r)=>{const o=y.current;if(!o)return;const e=o.getContext("2d");if(!e)return;const s=o.width,t=o.height;e.clearRect(0,0,s,t);const u=l.getChannelData(0),m=Math.ceil(u.length/s),p=t/2;e.fillStyle="#e5e7eb",e.fillRect(0,0,s,t),e.fillStyle="#6366f1",e.beginPath();for(let d=0;d<s;d++){let b=1,j=-1;for(let R=0;R<m;R++){const v=u[d*m+R];v<b&&(b=v),v>j&&(j=v)}e.fillRect(d,(1+b)*p,1,Math.max(1,(j-b)*p))}e.fillStyle="rgba(0, 0, 0, 0.4)";const g=a*s,w=r*s;e.fillRect(0,0,g,t),e.fillRect(w,0,s-w,t),e.fillStyle="#ef4444",e.fillRect(g-2,0,4,t),e.fillRect(w-2,0,4,t)};c.useEffect(()=>{n&&D(n,h,x)},[h,x,n]);const L=()=>{var s;if(!f||!n)return;if(M){(s=P.current)==null||s.stop(),S(!1);return}const l=n.duration,a=l*h,o=l*x-a,e=f.createBufferSource();e.buffer=n,e.connect(f.destination),e.start(0,a,o),e.onended=()=>S(!1),P.current=e,S(!0)},O=async()=>{if(!f||!n)return;const{bufferToWav:l}=await I(async()=>{const{bufferToWav:t}=await import("./index-a2ud5-rM.js").then(u=>u.b$);return{bufferToWav:t}},[]);n.duration;const a=Math.floor(h*n.length),r=Math.floor(x*n.length),o=r-a,e=f.createBuffer(n.numberOfChannels,o,n.sampleRate);for(let t=0;t<n.numberOfChannels;t++){const u=n.getChannelData(t);e.getChannelData(t).set(u.subarray(a,r))}const s=l(e);k(s)},T=l=>{const a=y.current;if(!a)return;const r=a.getBoundingClientRect(),o=l.clientX-r.left,e=Math.max(0,Math.min(1,o/r.width)),s=Math.abs(e-h),t=Math.abs(e-x),u=s<t,m=g=>{const w=g.clientX-r.left,d=Math.max(0,Math.min(1,w/r.width));u?B(Math.min(d,x-.05)):_(Math.max(d,h+.05))},p=()=>{window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",p)};window.addEventListener("mousemove",m),window.addEventListener("mouseup",p)};return i.jsxs("div",{className:"flex flex-col gap-4 p-4 bg-white rounded-2xl border border-neutral-200",children:[i.jsx("div",{className:"relative h-24 bg-neutral-100 rounded-xl overflow-hidden cursor-pointer",onMouseDown:T,children:i.jsx("canvas",{ref:y,width:600,height:100,className:"w-full h-full"})}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("button",{onClick:L,className:"flex items-center gap-2 px-4 py-2 bg-neutral-900 text-white rounded-xl text-xs font-bold uppercase tracking-wider hover:bg-neutral-800 transition-all",children:[M?i.jsx(W,{size:14}):i.jsx(z,{size:14}),M?"Stop":"Preview"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:E,className:"px-4 py-2 text-neutral-500 hover:text-neutral-900 font-bold text-xs",children:"Cancel"}),i.jsxs("button",{onClick:O,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-xl text-xs font-bold uppercase tracking-wider hover:bg-indigo-500 transition-all",children:[i.jsx(U,{size:14})," Trim & Use"]})]})]}),i.jsx("p",{className:"text-[10px] text-neutral-400 text-center",children:"Drag the red bars to trim audio."})]})};export{$ as A};
