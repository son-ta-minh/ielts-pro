import{r as o,K as D,c4 as k,j as e,a as T,y as E,a0 as M,ab as O,a9 as C,X as z,a1 as I,c5 as A,c6 as F}from"./index-BbN9kTvs.js";import{C as $}from"./chevron-left-D3_xlJfJ.js";const P=a=>new Date(0,a).toLocaleString("en-US",{month:"long"}),L=(a,u)=>new Date(a,u+1,0).getDate(),H=(a,u)=>new Date(a,u,1).getDay(),Y=({isOpen:a,onClose:u,onSave:w,onDelete:j,initialEvent:n,initialDate:c})=>{const[p,x]=o.useState(""),[m,g]=o.useState(""),[i,h]=o.useState(""),[b,r]=o.useState(""),[l,f]=o.useState("blue");o.useEffect(()=>{if(a){if(n)x(n.title),g(new Date(n.start).toISOString().slice(0,16)),h(new Date(n.end).toISOString().slice(0,16)),r(n.description||""),f(n.color);else if(c){const s=new Date(c);s.setHours(9,0);const v=new Date(s);v.setHours(10,0),x(""),g(s.toISOString().slice(0,16)),h(v.toISOString().slice(0,16)),r(""),f("blue")}}},[a,n,c]);const y=()=>{!p.trim()||!m||!i||w({id:n==null?void 0:n.id,title:p.trim(),start:new Date(m).getTime(),end:new Date(i).getTime(),description:b.trim(),color:l})},d=["blue","green","purple","orange","red"],t={blue:"bg-blue-500",green:"bg-green-500",purple:"bg-purple-500",orange:"bg-orange-500",red:"bg-red-500"};return a?e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col",children:[e.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-start",children:[e.jsx("div",{children:e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:n?"Edit Event":"New Study Event"})}),e.jsx("button",{onClick:u,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:e.jsx(z,{size:20})})]}),e.jsxs("main",{className:"p-8 space-y-4",children:[e.jsx("input",{value:p,onChange:s=>x(s.target.value),placeholder:"Event Title (e.g., IELTS Speaking Practice)",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-bold text-lg",required:!0,autoFocus:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-neutral-500",children:"Start Time"}),e.jsx("input",{type:"datetime-local",value:m,onChange:s=>g(s.target.value),className:"w-full mt-1 px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-neutral-500",children:"End Time"}),e.jsx("input",{type:"datetime-local",value:i,onChange:s=>h(s.target.value),className:"w-full mt-1 px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium"})]})]}),e.jsx("textarea",{value:b,onChange:s=>r(s.target.value),placeholder:"Description (optional)...",rows:3,className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium text-sm resize-none"}),e.jsx("div",{className:"flex items-center gap-3",children:d.map(s=>e.jsx("button",{onClick:()=>f(s),className:`w-8 h-8 rounded-full ${t[s]} transition-all ${l===s?"ring-2 ring-offset-2 ring-neutral-900 scale-110":"opacity-50 hover:opacity-100"}`},s))})]}),e.jsxs("footer",{className:"px-8 py-6 border-t border-neutral-100 flex justify-between items-center bg-neutral-50/50 rounded-b-[2.5rem]",children:[n&&j?e.jsxs("button",{onClick:()=>j(n.id),className:"px-4 py-2 text-red-600 font-bold text-xs flex items-center gap-2 hover:bg-red-50 rounded-lg",children:[e.jsx(C,{size:14})," Delete"]}):e.jsx("div",{}),e.jsxs("button",{onClick:y,className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs flex items-center gap-2 uppercase tracking-widest",children:[e.jsx(I,{size:14})," Save"]})]})]})}):null},U=({currentDate:a,events:u,onDayClick:w,onEventClick:j})=>{const n=a.getFullYear(),c=a.getMonth(),p=L(n,c),x=H(n,c),m=new Date,g=m.getFullYear()===n&&m.getMonth()===c,i=Array.from({length:p},(r,l)=>l+1),h=Array.from({length:x},(r,l)=>l),b={blue:"bg-blue-500 hover:bg-blue-600",green:"bg-green-500 hover:bg-green-600",purple:"bg-purple-500 hover:bg-purple-600",orange:"bg-orange-500 hover:bg-orange-600",red:"bg-red-500 hover:bg-red-600"};return e.jsxs("div",{className:"grid grid-cols-7 gap-px bg-neutral-200 border border-neutral-200 rounded-2xl overflow-hidden",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(r=>e.jsx("div",{className:"py-2 text-center text-xs font-bold text-neutral-500 bg-neutral-50",children:r},r)),h.map(r=>e.jsx("div",{className:"bg-neutral-50/50 min-h-[120px]"},`pad-${r}`)),i.map(r=>{const l=new Date(n,c,r),f=g&&r===m.getDate(),y=u.filter(d=>{const t=new Date(d.start),s=new Date(d.end);return t.setHours(0,0,0,0),s.setHours(23,59,59,999),l>=t&&l<=s}).sort((d,t)=>d.start-t.start);return e.jsxs("div",{onClick:()=>w(l),className:"bg-white p-2 min-h-[120px] flex flex-col cursor-pointer hover:bg-neutral-50/50 transition-colors",children:[e.jsx("span",{className:`self-end font-bold text-sm ${f?"bg-neutral-900 text-white rounded-full w-7 h-7 flex items-center justify-center":"text-neutral-700"}`,children:r}),e.jsx("div",{className:"flex-1 space-y-1 overflow-hidden",children:y.map(d=>e.jsx("div",{onClick:t=>{t.stopPropagation(),j(d)},className:`p-1.5 rounded-md text-white text-[10px] font-bold truncate transition-colors ${b[d.color]}`,children:d.title},d.id))})]},r)})]})},W=({user:a})=>{const[u,w]=o.useState([]),[j,n]=o.useState(!0),[c,p]=o.useState(new Date),[x,m]=o.useState("month"),[g,i]=o.useState({isOpen:!1}),[h,b]=o.useState(null),{showToast:r}=D(),l=o.useCallback(async()=>{n(!0);const t=await k(a.id);w(t),n(!1)},[a.id]);o.useEffect(()=>{l()},[l]);const f=t=>{p(s=>new Date(s.getFullYear(),s.getMonth()+t,1))},y=async t=>{var N;const s=Date.now(),v={id:t.id||`cal-${s}-${Math.random()}`,userId:a.id,title:t.title,start:t.start,end:t.end,description:t.description,color:t.color,createdAt:t.id&&((N=u.find(S=>S.id===t.id))==null?void 0:N.createdAt)||s,updatedAt:s};await A(v),i({isOpen:!1}),l(),r(t.id?"Event updated!":"Event created!","success")},d=async()=>{h&&(await F(h.id),b(null),i({isOpen:!1}),l(),r("Event deleted.","success"))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Calendar.png",className:"w-10 h-10 object-contain",alt:"Calendar"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:"Study Calendar"}),e.jsx("p",{className:"text-neutral-500 mt-1 font-medium",children:"Plan your learning journey."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>p(new Date),className:"px-4 py-2 bg-white border border-neutral-200 text-neutral-600 rounded-lg font-bold text-xs",children:"Today"}),e.jsxs("div",{className:"flex items-center gap-1 bg-white border border-neutral-200 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>f(-1),className:"p-1 text-neutral-400 hover:bg-neutral-100 rounded-md",children:e.jsx($,{size:20})}),e.jsx("button",{onClick:()=>f(1),className:"p-1 text-neutral-400 hover:bg-neutral-100 rounded-md",children:e.jsx(T,{size:20})})]}),e.jsxs("h3",{className:"text-lg font-bold w-48 text-center",children:[P(c.getMonth())," ",c.getFullYear()]}),e.jsx("div",{className:"flex bg-neutral-100 p-1 rounded-xl",children:["month","week","day"].map(t=>e.jsx("button",{onClick:()=>m(t),className:`px-3 py-1.5 rounded-lg text-xs font-bold transition-all ${x===t?"bg-white shadow-sm text-neutral-900":"text-neutral-500 hover:text-neutral-700"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},t))}),e.jsxs("button",{onClick:()=>i({isOpen:!0,date:new Date}),className:"px-4 py-2 bg-neutral-900 text-white rounded-lg font-bold text-xs flex items-center gap-2",children:[e.jsx(E,{size:16})," New Event"]})]})]}),j?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(M,{size:32,className:"animate-spin text-neutral-300"})}):e.jsxs(e.Fragment,{children:[x==="month"&&e.jsx(U,{currentDate:c,events:u,onDayClick:t=>i({isOpen:!0,date:t}),onEventClick:t=>i({isOpen:!0,event:t})}),(x==="week"||x==="day")&&e.jsx("div",{className:"text-center py-20 border-2 border-dashed border-neutral-200 rounded-2xl text-neutral-400 font-bold",children:"Week and Day views are coming soon!"})]}),e.jsx(Y,{isOpen:g.isOpen,onClose:()=>i({isOpen:!1}),onSave:y,onDelete:t=>b(u.find(s=>s.id===t)||null),initialEvent:g.event,initialDate:g.date}),e.jsx(O,{isOpen:!!h,title:"Delete Event?",message:"Are you sure you want to delete this event?",confirmText:"Delete",isProcessing:!1,onConfirm:d,onClose:()=>b(null),icon:e.jsx(C,{size:40,className:"text-red-500"})})]})};export{W as CalendarPage,W as default};
