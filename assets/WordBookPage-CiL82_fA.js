import{c as qe,r as a,j as e,X as G,ah as Ct,a3 as D,b6 as Ve,a as Qe,G as $e,D as St,av as At,am as Tt,ak as Lt,A as Et,U as oe,a2 as It,i as Pe,E as De,P as Mt,s as Wt,ao as Ne,be as zt,w as Rt,x as Ot,ae as ke,aj as Ge,aq as Ft,ci as P,$ as Ut,a5 as ae,cj as Bt,ck as $t}from"./index-CMQqxrid.js";import{U as Pt}from"./UniversalCard-B6hfb4tD.js";import{B as Ce,I as Dt,b as Gt,a as _t,C as qt,T as Vt,F as Qt,U as Jt,W as Yt,A as Ht,R as Kt,M as Xt}from"./ShelfModals-C1usJcHQ.js";import{P as _e}from"./pen-DfbuXqx4.js";import{P as Zt}from"./palette-D0CO4zEM.js";import{L as es}from"./library-CUTfZHO-.js";import{M as ts}from"./move-CoVq279E.js";import"./chevron-left-Bz0xBzMD.js";import"./folder-BZ95i3E9.js";import"./circle-BFdDN-84.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=qe("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=qe("Layers3",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m6.08 9.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1e5n1m"}],["path",{d:"m6.08 14.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1iwflc"}]]);function os(u){return`You are an expert IELTS coach and vocabulary curator. Your task is to generate a thematic "Word Book".
    
    USER REQUESTED TOPIC: "${u}"

    INSTRUCTIONS:
    1.  **Analyze the Topic**: Understand the core concept of "${u}".
    2.  **Find a Central Icon**: Select a single, simple, high-quality emoji that best represents the topic.
    3.  **Generate Vocabulary**: Create a list of 15-20 essential, high-value vocabulary items (words or short phrases) directly related to the topic.
    4.  **Provide Definitions**: For each vocabulary item, write a very concise, easy-to-understand definition in English.
    5.  **Format Topic**: The "topic" field MUST be in the format 'Category: Topic Name'. For example, if the user requests 'Trees', a good response would be 'Environment: Trees'.
    6.  **Select a Color**: From the provided list of classic book cover colors, choose ONE hex code that best fits the theme. For example, 'Environment' topics might be green or brown, 'Ocean' topics might be blue. AVAILABLE COLORS: ["#5d4037", "#263238", "#2e7d32", "#821c21", "#4a2c2a", "#37474f", "#4e342e", "#004d40"].
    
    STRICT JSON OUTPUT FORMAT:
    Return a single JSON object with the following structure. Do not include any text outside the JSON block.

    {
      "topic": "string (The topic name, MUST be in 'Category: Topic Name' format. e.g., 'Environment: Trees')",
      "icon": "string (A single emoji character, e.g., 'ðŸŒ³')",
      "color": "string (The chosen hex code from the available list, e.g., '#2e7d32')",
      "words": [
        {
          "word": "string (e.g., 'Trunk')",
          "definition": "string (e.g., 'The main woody stem of a tree.')"
        },
        {
          "word": "string (e.g., 'Branch')",
          "definition": "string (e.g., 'A limb extending from the main trunk.')"
        },
        {
          "word": "string (e.g., 'Canopy')",
          "definition": "string (e.g., 'The upper layer of leaves and branches.')"
        }
      ]
    }
    `}function as(u,x,A){const b=x.join(", ");return`You are an expert IELTS coach and vocabulary curator.
    
    TASK: Generate new vocabulary items for an existing Word Book based on a user's request.

    CONTEXT:
    - Word Book Topic: "${u}"
    - Words Already in the Book (DO NOT REPEAT THESE): [${b}]

    USER REQUEST: "${A||"Suggest 5-10 more relevant words."}"

    INSTRUCTIONS:
    1.  Analyze the topic, the existing words, and the user's request.
    2.  Generate a list of NEW, high-value vocabulary items (words or short phrases) that fit the request and topic.
    3.  You MUST NOT include any of the words from the "Words Already in the Book" list.
    4.  For each new word, provide a very concise, easy-to-understand definition in English.
    
    STRICT JSON OUTPUT FORMAT:
    Return a single JSON array of objects. Do not include any text outside the JSON block.

    [
      {
        "word": "string (The new word)",
        "definition": "string (The concise definition)"
      },
      {
        "word": "string (Another new word)",
        "definition": "string (Its definition)"
      }
    ]
    `}const ns=({isOpen:u,onClose:x,onSave:A})=>{const[b,T]=a.useState(""),[C,g]=a.useState("");a.useEffect(()=>{u&&(T(""),g(""))},[u]);const N=()=>{b.trim()&&A(b.trim(),C.trim())};return u?e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col",children:[e.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-start",children:[e.jsx("div",{children:e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Add Word to Book"})}),e.jsx("button",{onClick:x,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:e.jsx(G,{size:20})})]}),e.jsxs("main",{className:"p-8 space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"font-bold text-sm",children:"Word / Phrase"}),e.jsx("input",{value:b,onChange:p=>T(p.target.value),className:"w-full px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg font-medium",autoFocus:!0})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"font-bold text-sm",children:"Definition (Optional)"}),e.jsx("textarea",{value:C,onChange:p=>g(p.target.value),rows:3,className:"w-full p-3 bg-neutral-50 border border-neutral-200 rounded-lg font-medium text-sm"})]})]}),e.jsx("footer",{className:"px-8 py-6 border-t border-neutral-100 flex justify-end shrink-0 bg-neutral-50/50 rounded-b-[2.5rem]",children:e.jsxs("button",{onClick:N,className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs flex items-center gap-2 uppercase tracking-widest",children:[e.jsx(Ct,{size:14})," Save Word"]})})]})}):null},ls=({isOpen:u,onClose:x,onSave:A,units:b,libraryWords:T,wordsInBook:C})=>{const[g,N]=a.useState(null),[p,s]=a.useState([]),m=a.useMemo(()=>new Set(C.map(l=>l.word.toLowerCase())),[C]),k=a.useMemo(()=>new Map(T.map(l=>[l.id,l])),[T]);a.useEffect(()=>{u&&(N(null),s([]))},[u]);const h=l=>{N(l);const w=b.find(L=>L.id===l);if(w){const L=w.wordIds.map(S=>k.get(S)).filter(S=>!!S&&!m.has(S.word.toLowerCase()));s(L)}},f=l=>s(w=>w.filter(L=>L.id!==l)),W=()=>A(p);return u?e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-4xl rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col max-h-[85vh]",children:[e.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-center shrink-0",children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Add from Reading Unit"}),e.jsx("button",{onClick:x,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:e.jsx(G,{size:20})})]}),e.jsxs("main",{className:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6 overflow-hidden flex-1",children:[e.jsxs("div",{className:"flex flex-col gap-4 overflow-hidden",children:[e.jsx("h4",{className:"text-sm font-bold text-neutral-500 px-1",children:"1. Select a Unit"}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-2 space-y-1 custom-scrollbar",children:b.map(l=>e.jsxs("button",{onClick:()=>h(l.id),className:`w-full text-left p-3 rounded-xl border transition-all ${g===l.id?"bg-indigo-50 border-indigo-200 shadow-sm":"bg-white border-neutral-100 hover:bg-neutral-50"}`,children:[e.jsx("p",{className:`font-bold text-sm ${g===l.id?"text-indigo-900":"text-neutral-700"}`,children:l.name}),e.jsxs("p",{className:"text-[10px] text-neutral-400 font-bold uppercase tracking-wider",children:[l.wordIds.length," words"]})]},l.id))})]}),e.jsxs("div",{className:"flex flex-col gap-4 bg-neutral-50/50 p-4 rounded-2xl border border-neutral-200 overflow-hidden",children:[e.jsxs("h4",{className:"text-sm font-bold text-neutral-500 px-1",children:["2. Candidate List (",p.length,")"]}),e.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2 custom-scrollbar",children:[p.map(l=>e.jsxs("div",{className:"flex items-center justify-between p-2 pl-3 rounded-lg bg-white border border-neutral-200 shadow-sm animate-in fade-in",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-sm truncate",children:l.word}),e.jsx("p",{className:"text-[10px] text-neutral-500 truncate",children:l.meaningVi})]}),e.jsx("button",{onClick:()=>f(l.id),className:"p-1.5 text-neutral-300 hover:text-red-600 hover:bg-red-50 rounded-full transition-colors",children:e.jsx(G,{size:14})})]},l.id)),g&&p.length===0&&e.jsx("div",{className:"text-center py-10 text-neutral-400 italic text-xs font-medium",children:"All words from this unit are already in the book."}),!g&&e.jsx("div",{className:"text-center py-10 text-neutral-300 italic text-xs font-medium",children:"Select a unit to see candidates."})]})]})]}),e.jsxs("footer",{className:"px-8 py-6 border-t border-neutral-100 flex justify-end items-center gap-3 bg-neutral-50/50 rounded-b-[2.5rem] shrink-0",children:[e.jsx("button",{onClick:x,className:"px-5 py-2.5 bg-neutral-100 text-neutral-600 rounded-xl font-bold text-xs hover:bg-neutral-200",children:"Cancel"}),e.jsxs("button",{onClick:W,disabled:p.length===0,className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs flex items-center gap-2 uppercase tracking-widest disabled:opacity-50",children:[e.jsx(D,{size:14})," Add Selected (",p.length,")"]})]})]})}):null},is=({isOpen:u,onClose:x,onConfirm:A,books:b,currentBookId:T,wordText:C})=>{const[g,N]=a.useState(""),p=a.useMemo(()=>{const m=b.filter(h=>h.id!==T),k=new Map;return m.forEach(h=>{const f=h.topic.split(":")[0].trim()||"General";k.has(f)||k.set(f,[]),k.get(f).push(h)}),Array.from(k.entries()).sort((h,f)=>h[0].localeCompare(f[0]))},[b,T]),s=a.useMemo(()=>{if(!g.trim())return p;const m=g.toLowerCase();return p.map(([k,h])=>{const f=h.filter(W=>W.topic.toLowerCase().includes(m));return[k,f]}).filter(([k,h])=>h.length>0)},[p,g]);return u?e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col max-h-[80vh]",children:[e.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-start shrink-0",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Move Word"}),e.jsxs("p",{className:"text-xs text-neutral-500 font-bold mt-1 truncate",children:['Moving "',C,'" to another book...']})]}),e.jsx("button",{onClick:x,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:e.jsx(G,{size:20})})]}),e.jsx("div",{className:"p-4 border-b border-neutral-50",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-300",size:14}),e.jsx("input",{value:g,onChange:m=>N(m.target.value),placeholder:"Search destination book...",className:"w-full pl-9 pr-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none",autoFocus:!0})]})}),e.jsxs("main",{className:"p-4 overflow-y-auto flex-1 space-y-6 custom-scrollbar",children:[s.map(([m,k])=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"px-3 text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:m}),e.jsx("div",{className:"space-y-1",children:k.map(h=>{const f=h.topic.split(":").slice(1).join(":").trim()||h.topic;return e.jsxs("button",{onClick:()=>A(h.id),className:"w-full text-left px-4 py-3 rounded-xl border border-neutral-100 hover:border-neutral-300 hover:bg-neutral-50 transition-all font-bold text-sm text-neutral-700 flex items-center gap-3 group",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center bg-neutral-100 group-hover:bg-white border border-transparent group-hover:border-neutral-200 shrink-0",children:e.jsx(Ce,{icon:h.icon,className:"text-base"})}),e.jsx("span",{className:"flex-1 truncate",children:f}),e.jsx(Qe,{size:14,className:"text-neutral-300 group-hover:text-neutral-900"})]},h.id)})})]},m)),s.length===0&&e.jsx("div",{className:"text-center py-10 text-neutral-400 italic text-xs font-medium",children:"No other books found."})]}),e.jsx("footer",{className:"px-8 py-4 border-t border-neutral-100 bg-neutral-50/50 rounded-b-[2.5rem] flex justify-end",children:e.jsx("button",{onClick:x,className:"px-5 py-2 text-xs font-bold text-neutral-500 hover:text-neutral-900",children:"Cancel"})})]})}):null},ds=({isOpen:u,onClose:x,onSave:A,libraryWords:b,wordsInBook:T})=>{const[C,g]=a.useState(""),[N,p]=a.useState([]);a.useEffect(()=>{u&&(g(""),p([]))},[u]);const s=a.useMemo(()=>new Set(T.map(l=>l.word.toLowerCase())),[T]),m=a.useMemo(()=>new Set(N.map(l=>l.id)),[N]),k=a.useMemo(()=>{if(!C)return[];const l=C.toLowerCase();return b.filter(w=>w.word.toLowerCase().includes(l)&&!s.has(w.word.toLowerCase())&&!m.has(w.id)).slice(0,10)},[C,b,s,m]),h=l=>p(w=>[...w,l]),f=l=>p(w=>w.filter(L=>L.id!==l)),W=()=>A(N);return u?e.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-3xl rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col max-h-[80vh]",children:[e.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-center shrink-0",children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Add from Library"}),e.jsx("button",{onClick:x,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:e.jsx(G,{size:20})})]}),e.jsxs("main",{className:"p-6 grid grid-cols-2 gap-6 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("input",{value:C,onChange:l=>g(l.target.value),placeholder:"Search your library...",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium",autoFocus:!0}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2",children:k.map(l=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-white hover:bg-neutral-50 border border-neutral-100",children:[e.jsxs("div",{className:"flex-1 overflow-hidden",children:[e.jsx("p",{className:"font-bold text-sm truncate",children:l.word}),e.jsx("p",{className:"text-xs text-neutral-500 truncate",children:l.meaningVi})]}),e.jsx("button",{onClick:()=>h(l),className:"p-2 text-neutral-400 hover:text-green-600 hover:bg-green-50 rounded-full",children:e.jsx(D,{size:16})})]},l.id))})]}),e.jsxs("div",{className:"flex flex-col gap-4 bg-neutral-50/50 p-4 rounded-2xl border border-neutral-200",children:[e.jsxs("h4",{className:"text-sm font-bold text-neutral-500 px-1",children:["Selected Words (",N.length,")"]}),e.jsx("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2",children:N.map(l=>e.jsxs("div",{className:"flex items-center justify-between p-2 pl-3 rounded-lg bg-white border border-neutral-200 shadow-sm",children:[e.jsx("p",{className:"font-bold text-sm truncate",children:l.word}),e.jsx("button",{onClick:()=>f(l.id),className:"p-1.5 text-neutral-400 hover:text-red-600 hover:bg-red-50 rounded-full",children:e.jsx(G,{size:14})})]},l.id))})]})]}),e.jsxs("footer",{className:"px-8 py-6 border-t border-neutral-100 flex justify-end items-center gap-3 bg-neutral-50/50 rounded-b-[2.5rem] shrink-0",children:[e.jsx("button",{onClick:x,className:"px-5 py-2.5 bg-neutral-100 text-neutral-600 rounded-xl font-bold text-xs hover:bg-neutral-200",children:"Cancel"}),e.jsxs("button",{onClick:W,disabled:N.length===0,className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs flex items-center gap-2 uppercase tracking-widest disabled:opacity-50",children:[e.jsx(D,{size:14})," Add (",N.length,")"]})]})]})}):null},js=({user:u})=>{var Be;const[x,A]=a.useState([]),[b,T]=a.useState([]),[C,g]=a.useState([]),[N,p]=a.useState(!0),[s,m]=a.useState(null),[k,h]=a.useState(new Set),[f,W]=a.useState(""),[l,w]=a.useState(!1),L=a.useRef(null),[S,z]=a.useState("all"),[_,Y]=a.useState("all"),[q,H]=a.useState("all"),[Je,ne]=a.useState(!1),[$,le]=a.useState(null),[O,ie]=a.useState(null),[Ye,de]=a.useState(!1),[He,ce]=a.useState(!1),[Ke,ue]=a.useState(!1),[Xe,xe]=a.useState(!1),[Ze,Se]=a.useState(!1),[K,Ae]=a.useState(""),[et,Te]=a.useState(!1),[he,Le]=a.useState(""),[V,pe]=a.useState(()=>$e("wordbook_custom_shelves",[])),[Q,F]=a.useState(0),[tt,me]=a.useState(!1),[st,fe]=a.useState(!1),[X,be]=a.useState(null),[Z,ge]=a.useState(!1),we=a.useRef(null),[je,Ee]=a.useState(""),[ee,Ie]=a.useState(new Map),[te,U]=a.useState(null),[Me,J]=a.useState(null),[se,We]=a.useState({}),[ve,ze]=a.useState(null),[R,ye]=a.useState(null),{showToast:y}=St();a.useEffect(()=>{const t=r=>{we.current&&!we.current.contains(r.target)&&ge(!1),L.current&&!L.current.contains(r.target)&&w(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const Re=t=>{if(!t)return null;if(!t.lastReview)return{text:"New",classes:"bg-blue-50 text-blue-700 border-blue-100"};switch(t.lastGrade){case"FORGOT":return{text:"Forgot",classes:"bg-rose-50 text-rose-700 border-rose-100"};case"HARD":return{text:"Hard",classes:"bg-orange-50 text-orange-700 border-orange-100"};case"EASY":return{text:"Easy",classes:"bg-green-50 text-green-700 border-green-100"};case"LEARNED":return{text:"Learned",classes:"bg-cyan-50 text-cyan-700 border-cyan-100"};default:return{text:"Studied",classes:"bg-neutral-50 text-neutral-500 border-neutral-100"}}},I=a.useCallback(async()=>{p(!0);const[t,r,o]=await Promise.all([At(u.id),Tt(u.id),Lt(u.id)]);A(t.sort((i,d)=>d.createdAt-i.createdAt)),T(r),g(o.sort((i,d)=>i.name.localeCompare(d.name)));const n=new Map;r.forEach(i=>n.set(i.word.toLowerCase(),i)),Ie(n),p(!1)},[u.id]);a.useEffect(()=>{I()},[I]);const j=a.useMemo(()=>{const t=new Set(x.map(n=>n.topic.split(":")[0].trim()).filter(Boolean)),r=new Set([...V,...Array.from(t)]),o=Array.from(r).sort((n,i)=>n==="General"?-1:i==="General"?1:n.localeCompare(i));return o.length>0?o:["General"]},[x,V]),Oe=a.useMemo(()=>{if(!f.trim())return[];const t=f.toLowerCase(),r=j.filter(n=>n.toLowerCase().includes(t)).map(n=>({type:"shelf",id:n,label:n})),o=x.filter(n=>{const i=n.topic.split(":");return(i.length>1?i.slice(1).join(":").trim():n.topic).toLowerCase().includes(t)}).map(n=>{const i=n.topic.split(":"),d=i.length>1?i.slice(1).join(":").trim():n.topic;return{type:"book",id:n.id,label:d,shelf:i[0].trim()||"General",data:n}});return[...r,...o].slice(0,10)},[f,j,x]),rt=t=>{if(t.type==="shelf"){const r=j.findIndex(o=>o===t.id);r!==-1&&(F(r),m(null))}else if(t.type==="book"){const r=j.findIndex(o=>o===t.shelf);r!==-1&&(F(r),m(t.data))}W(""),w(!1)};a.useEffect(()=>{var t,r;if(s){const o=s.topic.split(":").map(d=>d.trim()),n=o.length>1?o.slice(1).join(":").trim():s.topic;Ae(n),Le(s.icon),Ee((t=s.color)!=null&&t.startsWith("http")||(r=s.color)!=null&&r.startsWith("data:image")?s.color:"");const i=$e(`wordbook_focus_${s.id}`,{});We(i),h(new Set),z("all"),Y("all"),H("all")}},[s]),a.useEffect(()=>{if(X&&j.includes(X)){const t=j.findIndex(r=>r===X);t!==-1&&F(t),be(null)}},[j,X]),a.useEffect(()=>{Q>=j.length&&F(Math.max(0,j.length-1))},[j.length,Q]);const M=j[Q]||"General",re=a.useMemo(()=>x.filter(t=>(t.topic.split(":")[0].trim()||"General")===M),[x,M]),ot=()=>me(!0),at=()=>fe(!0),nt=t=>{const r=t.trim();if(j.map(n=>n.toLowerCase()).includes(r.toLowerCase())){y("Shelf name already exists.","error");return}const o=[...V,r];pe(o),ae("wordbook_custom_shelves",o),be(r),y(`Shelf "${r}" created.`,"success"),me(!1)},lt=async t=>{const r=M;if(t&&t!==r){const o=t.trim();if(j.map(c=>c.toLowerCase()).includes(o.toLowerCase())){y("Shelf name already exists.","error");return}fe(!1),p(!0);const i=x.filter(c=>(c.topic.split(":")[0].trim()||"General")===r).map(c=>{const E=c.topic.split(":").map(kt=>kt.trim()),B=E.length>1?E.slice(1).join(":").trim():E[0];return{...c,topic:`${o}: ${B}`,updatedAt:Date.now()}});await Bt(i);const d=V.map(c=>c===r?o:c);pe(d),ae("wordbook_custom_shelves",d),be(o),await I(),y(`Shelf renamed to "${o}".`,"success")}},it=()=>{if(re.length>0){y("Cannot remove a shelf that contains books.","error");return}if(M==="General"){y("Cannot remove General shelf.","error");return}const t=V.filter(r=>r!==M);pe(t),ae("wordbook_custom_shelves",t),F(r=>Math.max(0,r-1)),y(`Shelf "${M}" removed.`,"info")},Fe=async()=>{const t={id:`wb-${Date.now()}`,userId:u.id,topic:`${M}: New Book`,icon:"ðŸ“˜",words:[],createdAt:Date.now(),updatedAt:Date.now(),color:"#1a237e"};await P(t),await I(),m(t)},dt=async t=>{const r=Date.now(),o={id:`wb-ai-${r}`,userId:u.id,topic:t.topic,icon:t.icon,words:t.words,color:t.color||"#5d4037",createdAt:r,updatedAt:r};await P(o),y("New book generated with AI!","success"),ne(!1),m(o),await I()},v=async t=>{if(!s)return;const r={...s,...t,updatedAt:Date.now()};m(r),await P(r),A(o=>o.map(n=>n.id===r.id?r:n))},ct=async()=>{$&&(await $t($.id,u.id),le(null),await I(),y("Book deleted.","success"))},ut=async t=>{if(!O)return;const r=O.topic.split(":").map(d=>d.trim()),o=r.length>1?r.slice(1).join(":").trim():r[0],n=`${t}: ${o}`,i={...O,topic:n,updatedAt:Date.now()};await P(i),ie(null),await I(),y(`Book moved to "${t}".`,"success")},xt=(t,r)=>{if(!s)return;const o=[...s.words,{word:t,definition:r}].sort((n,i)=>n.word.localeCompare(i.word));v({words:o}),de(!1)},ht=t=>{if(!s)return;const r=s.words.filter(o=>o.word!==t);v({words:r})},pt=t=>{if(!s)return;const r=t.map(d=>({word:d.word,definition:d.meaningVi})),o=new Set(s.words.map(d=>d.word.toLowerCase())),n=r.filter(d=>!o.has(d.word.toLowerCase())),i=[...s.words,...n].sort((d,c)=>d.word.localeCompare(c.word));v({words:i}),ce(!1),y(`Added ${n.length} words from library.`,"success")},mt=t=>{if(!s)return;const r=t.map(d=>({word:d.word,definition:d.meaningVi})),o=new Set(s.words.map(d=>d.word.toLowerCase())),n=r.filter(d=>!o.has(d.word.toLowerCase())),i=[...s.words,...n].sort((d,c)=>d.word.localeCompare(c.word));v({words:i}),ue(!1),y(`Added ${n.length} words from unit.`,"success")},ft=t=>{if(!s)return;const r=new Set(s.words.map(i=>i.word.toLowerCase())),o=t.filter(i=>!r.has(i.word.toLowerCase())),n=[...s.words,...o].sort((i,d)=>i.word.localeCompare(d.word));v({words:n}),xe(!1),y(`AI suggested ${o.length} new words!`,"success")},bt=async(t,r)=>{if(!ve){ze(t);try{const o=t.includes(" "),n=Ut(t,"",r,"",`Added from Word Book: ${s==null?void 0:s.topic}`,[],!1,!1,!1,!1,o);n.userId=u.id,await ke(n),y(`"${t}" added to library.`,"success"),await I()}catch{y("Failed to add word.","error")}finally{ze(null)}}},gt=(t,r)=>{if(!s)return;const o={...se,[t]:r};r||delete o[t],We(o),ae(`wordbook_focus_${s.id}`,o)},wt=async t=>{var c;if(!s||!R)return;const r=x.find(E=>E.id===t);if(!r)return;const o=[...r.words,R].sort((E,B)=>E.word.toLowerCase().localeCompare(B.word.toLowerCase())),n={...r,words:o,updatedAt:Date.now()};await P(n);const i=s.words.filter(E=>E.word!==R.word),d={...s,words:i,updatedAt:Date.now()};await P(d),A(E=>E.map(B=>B.id===t?n:B.id===s.id?d:B)),m(d),ye(null),y(`Moved "${R.word}" to ${(c=r.topic.split(":").pop())==null?void 0:c.trim()}`,"success")},jt=()=>{const r=`${(s==null?void 0:s.topic.split(":")[0].trim())||"General"}: ${K.trim()}`;r!==(s==null?void 0:s.topic)&&v({topic:r}),Se(!1)},vt=()=>{he!==(s==null?void 0:s.icon)&&v({icon:he.trim()}),Te(!1)},yt=t=>{h(r=>{const o=new Set(r);return o.has(t)?o.delete(t):o.add(t),o})},Nt=async t=>{await ke(t);const r=new Map(ee);r.set(t.word.toLowerCase(),t),Ie(r),te&&te.id===t.id&&U(t)},Ue=a.useMemo(()=>s?s.words.filter(t=>{const r=ee.get(t.word.toLowerCase()),o=se[t.word]||"none";if(S!=="all"&&o!==S)return!1;if(_!=="all"){const n=Re(r||null);if((n==null?void 0:n.text.toUpperCase())!==_)return!1}return!(q!=="all"&&(!r||r.quality!==q))}):[],[s,ee,se,S,_,q]);return e.jsxs("div",{className:"h-full flex flex-col animate-in fade-in duration-500",children:[s?e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("header",{className:"flex flex-col xl:flex-row justify-between items-start xl:items-center p-4 gap-4 shrink-0 bg-white border-b border-neutral-100 z-20",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-4 flex-1",children:[e.jsxs("button",{onClick:()=>{m(null),I()},className:"flex items-center gap-2 text-sm font-bold text-neutral-500 hover:text-neutral-900 transition-colors",children:[" ",e.jsx(Et,{size:16})," Back "]}),e.jsxs("div",{className:"flex items-center gap-4",children:[et?e.jsx("input",{value:he,onChange:t=>Le(t.target.value),onBlur:vt,onKeyDown:t=>{t.key==="Enter"&&t.currentTarget.blur()},autoFocus:!0,placeholder:"Emoji",className:"text-2xl w-24 text-center bg-neutral-100 border border-neutral-300 rounded-lg py-1 outline-none ring-2 ring-indigo-300"}):e.jsx("div",{onClick:()=>Te(!0),className:"p-1 rounded-lg hover:bg-neutral-100 cursor-pointer min-w-10 flex items-center justify-center",children:s.icon?e.jsx(Ce,{icon:s.icon,className:"text-2xl w-10 h-10 flex items-center justify-center mx-auto"}):e.jsx("div",{className:"w-10 h-10 rounded-xl border-2 border-dashed border-neutral-200 flex items-center justify-center text-neutral-300",children:e.jsx(Dt,{size:18})})}),Ze?e.jsx("input",{value:K,onChange:t=>Ae(t.target.value),onBlur:jt,onKeyDown:t=>{t.key==="Enter"&&t.currentTarget.blur()},autoFocus:!0,className:"text-xl font-black text-neutral-900 bg-neutral-100 border border-neutral-300 rounded-lg px-2 py-1 outline-none ring-2 ring-indigo-300"}):e.jsxs("div",{onClick:()=>Se(!0),className:"group/title relative p-1 rounded-lg hover:bg-neutral-100 cursor-pointer flex items-center gap-2",children:[e.jsx("h2",{className:"text-xl font-black text-neutral-900 tracking-tight",style:{color:s.titleColor||"#171717",fontSize:s.titleSize?`${s.titleSize}px`:"inherit"},children:K}),e.jsx(_e,{size:14,className:"text-neutral-400 opacity-0 group-hover/title:opacity-100 transition-opacity"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("div",{className:"h-6 w-px bg-neutral-200 hidden xl:block"}),e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsx(Gt,{size:14,className:"text-neutral-400"})}),e.jsxs("div",{className:"flex bg-neutral-100 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>z("all"),className:`px-2 py-1 rounded-lg text-[9px] font-black uppercase tracking-wider transition-all ${S==="all"?"bg-white shadow-sm text-neutral-900":"text-neutral-400 hover:text-neutral-600"}`,children:"All"}),e.jsx("button",{onClick:()=>z("green"),className:`w-5 h-5 ml-1 rounded-lg bg-emerald-500 border-2 transition-all ${S==="green"?"border-neutral-900 scale-110 shadow-sm":"border-transparent opacity-60 hover:opacity-100"}`}),e.jsx("button",{onClick:()=>z("yellow"),className:`w-5 h-5 ml-1 rounded-lg bg-amber-400 border-2 transition-all ${S==="yellow"?"border-neutral-900 scale-110 shadow-sm":"border-transparent opacity-60 hover:opacity-100"}`}),e.jsx("button",{onClick:()=>z("red"),className:`w-5 h-5 ml-1 rounded-lg bg-rose-500 border-2 transition-all ${S==="red"?"border-neutral-900 scale-110 shadow-sm":"border-transparent opacity-60 hover:opacity-100"}`}),e.jsx("button",{onClick:()=>z("none"),className:`px-2 py-1 ml-1 rounded-lg text-[9px] font-black uppercase tracking-wider transition-all ${S==="none"?"bg-white shadow-sm text-neutral-900":"text-neutral-400 hover:text-neutral-600"}`,children:"None"})]}),e.jsxs("select",{value:_,onChange:t=>Y(t.target.value),className:"bg-white border border-neutral-200 rounded-xl px-2 py-1.5 text-[9px] font-black uppercase tracking-wider text-neutral-600 focus:ring-2 focus:ring-neutral-900 outline-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"Any Status"}),e.jsx("option",{value:"NEW",children:"New"}),e.jsx("option",{value:"LEARNED",children:"Learned"}),e.jsx("option",{value:"EASY",children:"Easy"}),e.jsx("option",{value:"HARD",children:"Hard"}),e.jsx("option",{value:"FORGOT",children:"Forgot"})]}),e.jsxs("select",{value:q,onChange:t=>H(t.target.value),className:"bg-white border border-neutral-200 rounded-xl px-2 py-1.5 text-[9px] font-black uppercase tracking-wider text-neutral-600 focus:ring-2 focus:ring-neutral-900 outline-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"Any Quality"}),e.jsx("option",{value:oe.VERIFIED,children:"Verified"}),e.jsx("option",{value:oe.REFINED,children:"Refined"}),e.jsx("option",{value:oe.RAW,children:"Raw"}),e.jsx("option",{value:oe.FAILED,children:"Failed"})]}),(S!=="all"||_!=="all"||q!=="all")&&e.jsx("button",{onClick:()=>{z("all"),Y("all"),H("all")},className:"text-[9px] font-black text-indigo-600 hover:underline uppercase",children:"Reset"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"relative",ref:we,children:[e.jsxs("button",{onClick:()=>ge(!Z),className:`p-2.5 rounded-xl transition-all border shadow-sm flex items-center justify-center gap-2 ${Z?"bg-neutral-900 text-white border-neutral-900 shadow-md":"bg-white text-neutral-500 border-neutral-200 hover:bg-neutral-50 hover:text-neutral-900"}`,title:"Change Cover Design",children:[e.jsx(Zt,{size:18}),Z&&e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest mr-1",children:"Design"})]}),Z&&e.jsxs("div",{className:"absolute top-full right-0 mt-3 p-5 bg-white rounded-3xl shadow-[0_20px_50px_-12px_rgba(0,0,0,0.25)] border border-neutral-100 z-[100] animate-in fade-in zoom-in-95 origin-top-right w-80 space-y-5",children:[e.jsx("div",{className:"flex justify-center border-b border-neutral-100 pb-4",children:e.jsx("div",{className:"w-32 h-44 shadow-lg rounded-lg overflow-hidden transform rotate-2",children:e.jsx(_t,{id:s.id,title:K,icon:e.jsx(Ce,{icon:s.icon||"",className:"text-3xl"}),color:s.color,titleColor:s.titleColor,titleSize:s.titleSize,titleTop:s.titleTop,titleLeft:s.titleLeft,iconTop:s.iconTop,iconLeft:s.iconLeft,onClick:()=>{}})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2 px-1 border-b border-neutral-50 pb-2",children:e.jsx("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Cover Color"})}),e.jsx("div",{className:"grid grid-cols-5 gap-3 justify-items-center",children:qt.map(t=>e.jsx("button",{onClick:()=>v({color:t}),className:`w-8 h-8 rounded-full transition-all hover:scale-125 active:scale-90 ${s.color===t?"ring-2 ring-neutral-900 ring-offset-2 scale-110 shadow-md":"opacity-90 hover:opacity-100 shadow-sm border border-black/5"}`,style:{backgroundColor:t}},t))})]}),e.jsxs("div",{className:"space-y-3 pt-2 border-t border-neutral-50",children:[e.jsx("div",{className:"flex items-center gap-2 px-1",children:e.jsx("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Title Style"})}),e.jsxs("div",{className:"space-y-3 px-1",children:[e.jsx("div",{className:"grid grid-cols-5 gap-3 justify-items-center",children:Vt.map(t=>e.jsx("button",{onClick:()=>v({titleColor:t}),className:`w-6 h-6 rounded-md border transition-all ${s.titleColor===t?"ring-2 ring-indigo-500":"border-neutral-200"}`,style:{backgroundColor:t}},t))}),e.jsxs("div",{className:"flex items-center gap-3 bg-neutral-50 p-2 rounded-xl",children:[e.jsx(It,{size:14,className:"text-neutral-400"}),e.jsx("input",{type:"range",min:"12",max:"48",value:s.titleSize||24,onChange:t=>v({titleSize:parseInt(t.target.value)}),className:"flex-1 accent-neutral-900 h-1"})]})]})]}),e.jsxs("div",{className:"space-y-3 pt-2 border-t border-neutral-50",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsx("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Layout"}),e.jsx("button",{onClick:()=>v({titleTop:void 0,titleLeft:void 0,iconTop:void 0,iconLeft:void 0}),className:"text-[8px] font-black text-indigo-600 hover:underline uppercase",children:"Center All"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 px-1",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[8px] font-bold text-neutral-400 uppercase flex items-center gap-1",children:"Title Pos"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("input",{type:"number",value:s.titleTop??50,onChange:t=>v({titleTop:parseInt(t.target.value)}),className:"w-full px-2 py-1 bg-neutral-50 border border-neutral-200 rounded-md text-[10px] font-bold"}),e.jsx("input",{type:"number",value:s.titleLeft??50,onChange:t=>v({titleLeft:parseInt(t.target.value)}),className:"w-full px-2 py-1 bg-neutral-50 border border-neutral-200 rounded-md text-[10px] font-bold"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[8px] font-bold text-neutral-400 uppercase flex items-center gap-1",children:"Icon Pos"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("input",{type:"number",value:s.iconTop??40,onChange:t=>v({iconTop:parseInt(t.target.value)}),className:"w-full px-2 py-1 bg-neutral-50 border border-neutral-200 rounded-md text-[10px] font-bold"}),e.jsx("input",{type:"number",value:s.iconLeft??50,onChange:t=>v({iconLeft:parseInt(t.target.value)}),className:"w-full px-2 py-1 bg-neutral-50 border border-neutral-200 rounded-md text-[10px] font-bold"})]})]})]})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t border-neutral-50",children:[e.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Image URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:je,onChange:t=>Ee(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(v({color:je.trim()}),ge(!1))},placeholder:"https://...",className:"flex-1 px-3 py-1.5 bg-neutral-50 border border-neutral-200 rounded-lg text-[10px] font-medium focus:ring-1 focus:ring-neutral-900 outline-none"}),e.jsx("button",{onClick:()=>v({color:je.trim()}),className:"p-1.5 bg-neutral-900 text-white rounded-lg hover:bg-neutral-800",children:e.jsx(D,{size:14})})]})]})]})]}),e.jsxs("div",{className:"flex bg-neutral-100 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>ue(!0),className:"p-2.5 text-neutral-500 hover:text-indigo-600 hover:bg-white rounded-lg transition-all",title:"Add from Unit",children:e.jsx(rs,{size:18})}),e.jsx("button",{onClick:()=>ce(!0),className:"p-2.5 text-neutral-500 hover:text-indigo-600 hover:bg-white rounded-lg transition-all",title:"Add from Library",children:e.jsx(es,{size:18})}),e.jsx("button",{onClick:()=>xe(!0),className:"p-2.5 text-neutral-500 hover:text-amber-500 hover:bg-white rounded-lg transition-all",title:"Auto-Suggest Words with AI",children:e.jsx(Pe,{size:18})})]}),e.jsxs("button",{onClick:()=>de(!0),className:"px-4 py-2 bg-neutral-900 text-white rounded-xl font-bold text-xs flex items-center gap-2 hover:bg-neutral-800 transition-all active:scale-95 shadow-lg shadow-neutral-900/10",children:[e.jsx(D,{size:16})," New Word"]})]})]}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-8 bg-neutral-50/50 relative",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 relative z-10",children:[Ue.map((t,r)=>{const o=ee.get(t.word.toLowerCase()),n=Re(o||null),i=n?[{label:n.text,colorClass:n.classes}]:[],d=k.has(t.word);return e.jsx(Pt,{title:e.jsxs("div",{className:"flex items-center gap-2 font-black text-neutral-900",children:[t.word," ",(o==null?void 0:o.isPassive)&&e.jsx(zt,{size:12,className:"text-neutral-300"})]}),badges:i,compact:!0,focusColor:se[t.word],onFocusChange:c=>gt(t.word,c),onClick:()=>{o&&U(o)},actions:e.jsxs("div",{className:"flex items-center gap-1",children:[o?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:c=>{c.stopPropagation(),U(o)},className:"p-1.5 text-neutral-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"View in Library",children:e.jsx(De,{size:14})}),e.jsx("button",{onClick:c=>{c.stopPropagation(),J(o)},className:"p-1.5 text-neutral-400 hover:text-neutral-900 hover:bg-neutral-100 rounded-lg transition-colors",title:"Edit in Library",children:e.jsx(Mt,{size:14})})]}):e.jsx("button",{onClick:c=>{c.stopPropagation(),bt(t.word,t.definition)},disabled:ve===t.word,className:"p-1.5 text-indigo-500 hover:text-indigo-700 hover:bg-indigo-50 rounded-lg transition-colors",title:"Import to Library",children:ve===t.word?e.jsx(Wt,{size:14,className:"animate-spin"}):e.jsx(ss,{size:14})}),e.jsx("button",{onClick:c=>{c.stopPropagation(),ye(t)},className:"p-1.5 text-neutral-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Move to Another Book",children:e.jsx(ts,{size:14})}),e.jsx("button",{onClick:c=>{c.stopPropagation(),ht(t.word)},className:"p-1.5 text-neutral-400 hover:text-rose-600 hover:bg-rose-50 rounded-lg transition-colors",title:"Remove from Book",children:e.jsx(Ne,{size:14})})]}),children:e.jsx("div",{className:"flex flex-col items-start justify-start min-h-[40px] cursor-pointer group/reveal pt-1",onClick:c=>{c.stopPropagation(),yt(t.word)},children:d?e.jsx("p",{className:"flex-1 text-xs font-medium text-neutral-700 leading-tight text-left animate-in fade-in duration-300",children:t.definition||(o==null?void 0:o.meaningVi)}):e.jsx("div",{className:"w-full flex justify-center py-1",children:e.jsx("div",{className:"text-neutral-200 group-hover/reveal:text-neutral-400 transition-colors animate-in zoom-in duration-300",children:e.jsx(De,{size:18})})})})},`${t.word}-${r}`)}),Ue.length===0&&e.jsxs("div",{className:"col-span-full py-20 text-center text-neutral-400 border-2 border-dashed border-neutral-200 rounded-3xl",children:[e.jsx("p",{className:"font-bold",children:"No items found matching your filters."}),e.jsx("button",{onClick:()=>{z("all"),Y("all"),H("all")},className:"text-sm text-indigo-600 hover:underline font-bold mt-2",children:"Clear all filters"})]})]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Open%20Book.png",className:"w-10 h-10 object-contain",alt:"Word Book"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:"Word Book"}),e.jsx("p",{className:"text-neutral-500 mt-1 font-medium",children:"Your thematic vocabulary collections."})]})]}),e.jsxs("div",{className:"flex-1 max-w-md relative mx-0 md:mx-4",ref:L,children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 text-neutral-400",size:16}),e.jsx("input",{type:"text",value:f,onChange:t=>{W(t.target.value),w(!0)},onFocus:()=>w(!0),placeholder:"Search shelf or book...",className:"w-full pl-10 pr-4 py-2.5 bg-white border border-neutral-200 rounded-2xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none transition-all shadow-sm"})]}),l&&Oe.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-neutral-100 rounded-2xl shadow-xl z-[100] overflow-hidden animate-in fade-in zoom-in-95",children:Oe.map((t,r)=>e.jsxs("button",{onClick:()=>rt(t),className:"w-full text-left px-4 py-3 hover:bg-neutral-50 transition-colors flex items-center justify-between border-b border-neutral-50 last:border-0",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-black text-neutral-900",children:t.label}),e.jsx("span",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest",children:t.type==="shelf"?"Shelf":`Book â€¢ ${t.shelf}`})]}),e.jsx(Qe,{size:14,className:"text-neutral-300"})]},r))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:ot,className:"px-6 py-3 bg-white border border-neutral-200 text-neutral-600 rounded-xl font-black text-xs flex items-center gap-2 uppercase tracking-widest hover:bg-neutral-50 transition-all shadow-sm",children:[e.jsx(Qt,{size:14})," Add Shelf"]}),e.jsxs("button",{onClick:()=>ne(!0),className:"px-6 py-3 bg-white border border-neutral-200 text-indigo-600 rounded-xl font-black text-xs flex items-center gap-2 hover:bg-neutral-50 active:scale-95 transition-all shadow-sm",children:[e.jsx(Pe,{size:16})," ",e.jsx("span",{children:"Generate Book"})]}),e.jsxs("button",{onClick:Fe,className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs flex items-center gap-2 hover:bg-neutral-800 active:scale-95 transition-all shadow-lg shadow-neutral-900/10",children:[e.jsx(D,{size:18})," ",e.jsx("span",{children:"New Book"})]})]})]}),e.jsx(Jt,{label:M,onNext:()=>F((Q+1)%j.length),onPrev:()=>F((Q-1+j.length)%j.length),actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:at,className:"p-2 bg-white/20 text-white/70 rounded-full hover:bg-white/40 hover:text-white",title:"Rename Shelf",children:e.jsx(_e,{size:14})}),e.jsx("button",{onClick:it,disabled:re.length>0,className:"p-2 bg-white/20 text-white/70 rounded-full hover:bg-white/40 hover:text-white disabled:opacity-30 disabled:hover:bg-white/20",title:"Remove Empty Shelf",children:e.jsx(Ne,{size:14})})]}),isEmpty:re.length===0,emptyAction:e.jsx("button",{onClick:Fe,className:"px-6 py-3 bg-white/10 hover:bg-white/20 text-white rounded-xl font-bold text-xs uppercase tracking-widest border border-white/20",children:"Create First Book"}),children:re.map(t=>e.jsx(Yt,{book:t,onClick:()=>m(t),onMove:r=>{r.stopPropagation(),ie(t)},onDelete:r=>{r.stopPropagation(),le(t)}},t.id))})]}),te&&e.jsx(Rt,{word:te,onClose:()=>U(null),onNavigateToWord:U,onUpdate:Nt,onEditRequest:t=>{U(null),J(t)},onGainXp:async()=>0,isViewOnly:!1}),Me&&e.jsx(Ot,{user:u,word:Me,onSave:async t=>{await ke(t),J(null),await I()},onClose:()=>J(null),onSwitchToView:t=>{J(null),U(t)}}),e.jsx(Ge,{isOpen:Je,onClose:()=>ne(!1),type:"GENERATE_UNIT",title:"Thematic Book Creator",description:"AI will design a thematic book with essential vocabulary.",onGeneratePrompt:t=>os(t.request),onJsonReceived:dt,actionLabel:"Generate",closeOnSuccess:!0}),e.jsx(Ge,{isOpen:Xe,onClose:()=>xe(!1),type:"REFINE_UNIT",title:"AI Vocabulary Suggestion",description:"Suggest more essential words for this topic.",initialData:{},onGeneratePrompt:t=>as((s==null?void 0:s.topic)||"",(s==null?void 0:s.words.map(r=>r.word))||[],t.request),onJsonReceived:ft,actionLabel:"Suggest"}),e.jsx(ns,{isOpen:Ye,onClose:()=>de(!1),onSave:xt}),e.jsx(ds,{isOpen:He,onClose:()=>ce(!1),onSave:pt,libraryWords:b,wordsInBook:(s==null?void 0:s.words)||[]}),e.jsx(ls,{isOpen:Ke,onClose:()=>ue(!1),onSave:mt,units:C,libraryWords:b,wordsInBook:(s==null?void 0:s.words)||[]}),e.jsx(is,{isOpen:!!R,onClose:()=>ye(null),onConfirm:wt,books:x,currentBookId:(s==null?void 0:s.id)||"",wordText:(R==null?void 0:R.word)||""}),e.jsx(Ht,{isOpen:tt,onClose:()=>me(!1),onSave:nt}),e.jsx(Kt,{isOpen:st,onClose:()=>fe(!1),onSave:lt,initialName:M}),e.jsx(Xt,{isOpen:!!O,onClose:()=>ie(null),onConfirm:ut,shelves:j,currentShelf:M,bookTitle:(O==null?void 0:O.topic)||""}),e.jsx(Ft,{isOpen:!!$,title:"Delete Book?",message:e.jsxs(e.Fragment,{children:["Are you sure you want to delete ",e.jsxs("strong",{children:['"',(Be=$==null?void 0:$.topic.split(":").pop())==null?void 0:Be.trim(),'"']}),"? Words inside will not be deleted from library."]}),confirmText:"Delete",isProcessing:!1,onConfirm:ct,onClose:()=>le(null),icon:e.jsx(Ne,{size:40,className:"text-red-500"})})]})};export{js as WordBookPage,js as default};
