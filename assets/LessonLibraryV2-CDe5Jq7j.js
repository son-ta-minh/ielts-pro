import{c as gt,r as n,D as Oe,j as e,G as Q,a8 as ge,i as we,a0 as be,a1 as De,J as Fe,P as te,E as Me,K as je,a3 as Ne,m as ze,av as ft,k as wt,p as bt,bF as fe,a9 as J,o as jt,A as Nt,bG as vt,bH as St,bI as yt,aa as Ct,y as Le,ab as xe,l as kt,ac as Tt,bJ as Z,bK as me,bL as ee,bM as At,bN as Lt,bO as It}from"./index-BeBINpHy.js";import{R as Et,a as Rt}from"./ResourceActions-B4FNr2vj.js";import{T as Ot}from"./TagBrowser-BPRRTge4.js";import{U as Dt}from"./UniversalCard-CX67S68Z.js";import{p as Pe}from"./markdownParser-NDCOwRTZ.js";import{u as Ft,G as Mt,S as Ie,V as zt}from"./ShelfSearchBar-BH8nwIhz.js";import{F as Ee,U as Pt,a as Bt,M as _t,A as Ut,R as Gt}from"./ShelfModals-Q9auai6C.js";import{M as Wt}from"./move-BL81twAO.js";import{P as $t}from"./pen-ChzXJ-2y.js";import{L as Yt}from"./library-Dpx4-dcr.js";import{F as Vt}from"./file-clock-DkhAWfbj.js";import"./search-B1tb4K_3.js";import"./chevron-left-D1EVPfk0.js";import"./circle-CuWs-sVS.js";import"./palette-Dq3GLoKS.js";import"./square-check-big-qIvMHrqh.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=gt("Puzzle",[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]]);function Kt(s,g){const c=g.map(N=>`"${N}"`).join(", ");return`You are an expert IELTS coach and lexicographer, specializing in explaining nuanced differences between similar English words for a Vietnamese learner.

    TASK:
    Analyze a group of confusing English words/phrases. Your primary goal is to clarify the subtle differences in meaning, context, and usage.
    
    GROUP CONCEPT: "${s}"
    WORDS TO ANALYZE: [${c}]

    INSTRUCTIONS:
    1.  **Analyze & Suggest**: Analyze every word in the provided list. Additionally, suggest 1-3 NEW, highly relevant words/phrases that also fit the group concept. **When suggesting new words, prioritize words that represent a DIFFERENT LEVEL OF INTENSITY, especially extreme or high-impact words commonly used in IELTS Writing (e.g., agony, severe, intense).** Include these new suggestions in your analysis.
    2.  **Generate Table Data**: For each word (original and suggested), create a JSON object with four fields: "word", "explanation", "example", and "userNote".
        - **word**: The specific word or phrase being analyzed.
        - **explanation**: This is the most critical part. Follow these rules STRICTLY:
            1.  Focus on **one core idea** only.
            2.  Do NOT give formal dictionary definitions.
            3.  Keep it **short and memory-based** (easy to remember).
            4.  Always explain by **contrast**. Use a format like: "Use X for [core idea], not Y or Z which are for [other ideas]."
            5.  Highlight the single most important keyword or phrase with markdown bold (**key idea**).
        - **example**: A clear, concise example sentence that perfectly illustrates the unique usage of the word.
        - **userNote**: An empty string (""). This is a placeholder for the user's personal notes.
    3.  **Final JSON Output**: Your final response must be a single, strict JSON object with three keys:
        - \`title\`: **CRITICAL**: Identify the **most common, simplest word** in the group (the "anchor word" that everyone knows, e.g., "Big", "Small", "Stop", "Problem"). Set the title to **ONLY that specific word**. Do NOT add phrases like "Words for...". (e.g. if the list is "mitigate, alleviate, reduce", the title MUST be just "Reduce").
        - \`updatedWords\`: An array of strings containing ALL words analyzed (the original list PLUS your new suggestions).
        - \`comparisonData\`: An array of the JSON objects you created in step 2. The order of items in this array will determine the order in the final table.

    EXAMPLE SCENARIO:
    If input words are ["job", "work", "career"], a good explanation for "career" would be: "Use for your **long-term professional journey**, not a single 'job' or the general activity of 'work'."
    The Title would be: "Work".

    STRICT JSON RESPONSE FORMAT:
    {
      "title": "string (The single anchor word)",
      "updatedWords": ["original_word_1", "original_word_2", "new_suggestion_1"],
      "comparisonData": [
        {
          "word": "original_word_1",
          "explanation": "Use for **core idea 1**, not for the ideas of the other words.",
          "example": "A clear example sentence...",
          "userNote": ""
        },
        {
          "word": "original_word_2",
          "explanation": "Use for **core idea 2**, not for the ideas of the other words.",
          "example": "Another distinct example sentence...",
          "userNote": ""
        },
        {
          "word": "new_suggestion_1",
          "explanation": "Use for **new core idea**, not for the ideas of the others.",
          "example": "An example for the new word...",
          "userNote": ""
        }
      ]
    }
    `}function Be(s){const{topic:g,currentLesson:c,userRequest:N,language:u,targetAudience:S,tone:d,coachName:x}=s,w=u==="Vietnamese"?"Audio-VN":"Audio-EN",j=!!c;let m="",p="";return j&&c?(m="Refine and reformat the user's lesson notes into a structured, high-quality study resource.",p=`
    CURRENT CONTENT:
    Title: ${c.title}
    Description: ${c.description}
    Body:
    ${c.content||"(empty)"}
    
    USER INSTRUCTIONS: "${N||"Format deeply, improve structure, correct errors, and add educational value."}"
    `):(m=`Create a brand new lesson for a ${S} on topic: "${g||"General Knowledge"}".`,p=`USER REQUEST: "${N||"Create a comprehensive lesson."}"`),`You are an expert educational content designer and IELTS coach.
  ROLE: You are '${x}', acting as a ${d==="friendly_elementary"?"friendly teacher":"professional professor"}.
    
  TASK: ${m}

  ${p}

  STRICT LANGUAGE RULES:
  1. CORE MATERIAL (Vocabulary Lists, Example Sentences, Exercises): Must be in English.
  2. META CONTENT (Greetings, CONCEPT DEFINITIONS, Explanations, Strategy Tips): In ${u}.

  FORMATTING RULES (CRITICAL):
  - **VOCAB LISTS**: List simple words on a SINGLE line separated by commas.
  - **NUMBERED LISTS**: Use sequential numbering (e.g., 1., 2., 3.) for ordered lists.
  - **DEFINITIONS**: Treat definitions as explanations. They MUST be spoken in ${u}.
  - **CONCISE TITLE**: Keep the title short and direct.
  - **TITLE OVERRIDE RULE**: If it's a pattern, use the BASE form (e.g., "be associated with", not "is associated with").
  - **COMPACT SPACING**: Keep the text dense. No extra empty lines between headings and content.

  INTERACTIVE ELEMENTS SYNTAX:
  1. **Hidden Answer**: Use \`[HIDDEN: content]\` for answers that should be hidden initially.
  2. **Tips**: Use \`[Content]\` (text inside brackets on a NEW LINE) for tips and notes.
  3. **Fill-in Quiz**: Use \`[Quiz: answer]\` for a text input field checking against 'answer'.
  4. **Multiple Choice**: Use \`[Multi: Correct Answer | Wrong Option | Wrong Option]\`. The FIRST option provided must be the correct one. The system will shuffle them automatically.
  5. **Dropdown Select**: Use \`[Select: Correct Answer | Wrong Option | Wrong Option]\`. It renders as a dropdown menu. The FIRST option provided must be the correct one. The system will shuffle them automatically. Use this for "Fill in the blank" exercises where you want to give hints.

  AUDIO BLOCK RULE (TOKEN SAVER - CRITICAL):
  - **WRAP ONLY META CONTENT**: Only wrap your explanations, greetings, and definitions inside \`[${w}]\` and \`[/]\`.
  - **EXCLUDE CORE MATERIAL**: Do NOT wrap vocabulary lists, exercises, or headers (##) inside audio tags.
  
  EXAMPLE OF CORRECT STRUCTURE:
    ## Key Concepts
    [${w}]
    ${u==="Vietnamese"?"ChÃ o con! HÃ´m nay chÃºng mÃ¬nh sáº½ há»c vá»...":"Hello! Today we will learn about..."}
    [/]
    [Make sure to practice these daily!]
    * Word1, Word2, Word3
    
    1. Select the correct word:
    [Multi: Apple | Car | Sky]
    
    2. Type the missing word:
    The sky is [Quiz: blue].
    
    3. Choose the best fit:
    The ocean is [Select: deep | high | tall].

  TAGGING (STRICT): Return exactly ONE tag from: ["Writing", "Speaking", "Listening", "Reading", "Grammar", "Writing Task 1", "Writing Task 2", "Speaking Academic", "Speaking Casual", "Pattern", "Comparison"].

  STRICT JSON OUTPUT FORMAT:
  {
    "title": "string",
    "description": "string",
    "content": "string (Markdown using the tags defined above)",
    "tags": ["string"]
  }`}const Ht=s=>{const{title:g,setTitle:c,description:N,setDescription:u,tagsInput:S,setTagsInput:d,content:x,setContent:w,isSaving:j,onSave:m,onPractice:p,onCancel:h,onOpenAiRefine:T}=s,[E,D]=n.useState(!1),k=n.useMemo(()=>Pe(x),[x]);return n.useEffect(()=>(window.handleLessonSpeak=y=>{Oe(y)},()=>{delete window.handleLessonSpeak}),[]),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-in fade-in duration-300 pb-20",children:[e.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("button",{onClick:h,className:"flex items-center space-x-2 text-sm font-bold text-neutral-400 hover:text-neutral-900 transition-colors mb-1",children:[e.jsx(Q,{size:16}),e.jsx("span",{children:"Back to Lesson Library"})]}),e.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:"Edit Lesson"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:p,disabled:j,className:"px-5 py-3 bg-white border border-neutral-200 text-neutral-600 rounded-xl font-black text-xs flex items-center space-x-2 transition-all hover:bg-neutral-50 active:scale-95 uppercase tracking-widest shadow-sm",children:[e.jsx(ge,{size:14}),e.jsx("span",{children:"Read Mode"})]}),e.jsxs("button",{onClick:T,className:"px-5 py-3 bg-white border border-neutral-200 text-neutral-600 rounded-xl font-black text-xs flex items-center space-x-2 transition-all hover:bg-neutral-50 active:scale-95 uppercase tracking-widest shadow-sm",children:[e.jsx(we,{size:14,className:"text-amber-500"}),e.jsx("span",{children:"AI Refine"})]}),e.jsxs("button",{onClick:m,disabled:j,className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs flex items-center space-x-2 transition-all active:scale-95 hover:bg-neutral-800 disabled:opacity-50 uppercase tracking-widest shadow-sm",children:[j?e.jsx(be,{size:14,className:"animate-spin"}):e.jsx(De,{size:14}),e.jsx("span",{children:j?"Saving...":"Save Lesson"})]})]})]}),e.jsxs("div",{className:"space-y-6 bg-white p-8 rounded-3xl border border-neutral-200 shadow-sm",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Lesson Title"}),e.jsx("input",{type:"text",value:g,onChange:y=>c(y.target.value),className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-lg font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[e.jsx(Fe,{size:12})," Tags (Keywords)"]}),e.jsx("input",{type:"text",value:S,onChange:y=>d(y.target.value),placeholder:"e.g. Grammar, Writing Task 2",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-1",children:"Short Description"}),e.jsx("textarea",{value:N,onChange:y=>u(y.target.value),rows:2,className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm leading-relaxed resize-y focus:ring-2 focus:ring-neutral-900 outline-none"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Content (Markdown)"}),e.jsxs("button",{onClick:()=>D(!E),className:"flex items-center space-x-1.5 px-3 py-1.5 rounded-lg bg-white border border-neutral-200 hover:bg-neutral-50 transition-all text-[10px] font-black uppercase text-neutral-500 hover:text-neutral-900 shadow-sm",children:[E?e.jsx(te,{size:12}):e.jsx(Me,{size:12}),e.jsx("span",{children:E?"Edit":"Preview"})]})]}),e.jsx("div",{className:"bg-white border border-neutral-200 rounded-2xl shadow-sm h-[600px] relative overflow-hidden",children:E?e.jsx("div",{className:"p-6 prose prose-sm max-w-none prose-headings:font-black prose-p:text-neutral-600 prose-img:rounded-xl prose-img:shadow-md prose-strong:text-neutral-900 prose-a:text-indigo-600 overflow-y-auto absolute inset-0 bg-neutral-50/30",dangerouslySetInnerHTML:{__html:k}}):e.jsx("textarea",{value:x,onChange:y=>w(y.target.value),className:"absolute inset-0 w-full h-full p-6 resize-none focus:outline-none text-sm leading-relaxed font-medium text-neutral-900 bg-white font-mono",placeholder:`# Lesson Heading

Write your lesson content here using Markdown...`,spellCheck:!1})})]})]})]})},qt=({lesson:s,user:g,onSave:c,onPractice:N,onCancel:u})=>{const[S,d]=n.useState(s.title),[x,w]=n.useState(s.description||""),[j,m]=n.useState(s.path||"/"),[p,h]=n.useState((s.tags||[]).join(", ")),[T,E]=n.useState(s.content),[D,k]=n.useState(!1),[y,F]=n.useState(!1),{showToast:H}=je(),R=s.topic1,V=s.topic2;n.useEffect(()=>{if(s.path===void 0&&s.tags){const v=s.tags||[],A=v.find(_=>_.startsWith("/")),o=v.filter(_=>!_.startsWith("/"));m(A||"/"),h(o.join(", "))}else m(s.path||"/"),h((s.tags||[]).join(", "))},[s]);const B=()=>{const v=p.split(",").map(A=>A.trim()).filter(Boolean);return{...s,title:S,description:x,topic1:R,topic2:V,path:j.trim(),tags:v,content:T,updatedAt:Date.now()}},f=()=>{k(!0);const v=B();c(v)},C=()=>{k(!0);const v=B();N(v)},O=v=>{var M,$,U;const A=ze(),o=A.audioCoach.activeCoach,_=A.audioCoach.coaches[o].name;return Be({currentLesson:{title:S,description:x,content:T},userRequest:v.request,language:((M=g.lessonPreferences)==null?void 0:M.language)||"English",targetAudience:(($=g.lessonPreferences)==null?void 0:$.targetAudience)||"Adult",tone:((U=g.lessonPreferences)==null?void 0:U.tone)||"professional_professor",coachName:_})},b=v=>{d(v.title),w(v.description),E(v.content),!p.trim()&&v.tags&&v.tags.length>0&&h(v.tags.join(", ")),F(!1),H("Lesson content refined!","success")};return e.jsxs(e.Fragment,{children:[e.jsx(Ht,{title:S,setTitle:d,description:x,setDescription:w,path:j,setPath:m,tagsInput:p,setTagsInput:h,content:T,setContent:E,isSaving:D,onSave:f,onPractice:C,onCancel:u,onOpenAiRefine:()=>F(!0)}),y&&e.jsx(Ne,{isOpen:y,onClose:()=>F(!1),type:"REFINE_UNIT",title:"Refine Lesson Content",description:"AI will format your notes into Markdown, fix errors, and add structure.",onGeneratePrompt:O,onJsonReceived:b,actionLabel:"Apply Changes"})]})},Xt=({lesson:s,onComplete:g,onEdit:c})=>{const N=n.useMemo(()=>Pe(s.content),[s.content]);return n.useEffect(()=>(window.handleLessonSpeak=u=>{Oe(u)},()=>{delete window.handleLessonSpeak}),[]),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 pb-20 animate-in fade-in duration-300",children:[e.jsxs("header",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("button",{onClick:g,className:"w-fit flex items-center space-x-2 text-xs font-bold text-neutral-400 hover:text-neutral-900 transition-colors uppercase tracking-wider",children:[e.jsx(Q,{size:14}),e.jsx("span",{children:"Back to Library"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:s.title}),s.description&&e.jsx("p",{className:"text-neutral-500 font-medium",children:s.description})]})]}),e.jsx("button",{onClick:c,className:"p-2.5 bg-white border border-neutral-200 text-neutral-600 rounded-xl hover:bg-neutral-50 hover:text-neutral-900 transition-all shadow-sm active:scale-95",title:"Edit Lesson",children:e.jsx(te,{size:18})})]}),e.jsx("div",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm min-h-[400px]",children:e.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-black prose-headings:text-neutral-900 prose-p:text-neutral-600 prose-p:leading-relaxed prose-img:rounded-xl prose-img:shadow-md prose-strong:text-neutral-900 prose-a:text-indigo-600",dangerouslySetInnerHTML:{__html:N}})})]})},Qt=({lesson:s,onComplete:g,onEdit:c})=>e.jsx(Xt,{lesson:s,onComplete:g,onEdit:c}),Zt=({text:s})=>{if(!s)return null;const g=s.split(/(\*\*.*?\*\*)/g);return e.jsx(e.Fragment,{children:g.map((c,N)=>c.startsWith("**")&&c.endsWith("**")?e.jsx("strong",{className:"font-bold text-neutral-900",children:c.slice(2,-2)},N):c)})},es=({group:s,libraryWords:g,noteSavingStatus:c,onBack:N,onEdit:u,onNoteChange:S})=>e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6 animate-in fade-in duration-300 pb-20",children:[e.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("button",{onClick:N,className:"flex items-center space-x-2 text-xs font-bold text-neutral-400 hover:text-neutral-900 transition-colors uppercase tracking-wider",children:[e.jsx(Q,{size:14}),e.jsx("span",{children:"Back to Library"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Jt,{size:28,className:"text-purple-500"}),e.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:s.name})]})]}),e.jsxs("button",{onClick:u,className:"px-5 py-2.5 bg-white border border-neutral-200 text-neutral-600 rounded-xl font-black text-[10px] flex items-center space-x-2 active:scale-95 uppercase tracking-widest hover:bg-neutral-50 transition-all shadow-sm",children:[e.jsx(te,{size:14}),e.jsx("span",{children:"Edit Group"})]})]}),e.jsx("div",{className:"bg-white rounded-[2.5rem] border border-neutral-200 shadow-sm overflow-hidden min-h-[400px]",children:s.comparisonData.length===0?e.jsxs("div",{className:"text-center p-20 text-neutral-400",children:[e.jsx(ft,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"font-bold",children:"No analysis data available."}),e.jsx("p",{className:"text-sm",children:'Use "Refine with AI" in Edit mode to generate comparisons.'})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse text-left",children:[e.jsx("thead",{className:"bg-neutral-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-6 text-[10px] font-black uppercase tracking-widest text-neutral-400 w-1/6",children:"Word"}),e.jsx("th",{className:"p-6 text-[10px] font-black uppercase tracking-widest text-neutral-400 w-1/3",children:"Nuance & Usage"}),e.jsx("th",{className:"p-6 text-[10px] font-black uppercase tracking-widest text-neutral-400 w-1/3",children:"Example"}),e.jsx("th",{className:"p-6 text-[10px] font-black uppercase tracking-widest text-neutral-400 w-1/6",children:"Notes"})]})}),e.jsx("tbody",{className:"divide-y divide-neutral-100",children:s.comparisonData.map((d,x)=>e.jsxs("tr",{className:"group hover:bg-neutral-50/30 transition-colors",children:[e.jsx("td",{className:"p-6 align-top",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-lg text-neutral-900",children:d.word}),g.has(d.word.toLowerCase())&&e.jsx("span",{title:"In Library",children:e.jsx(Me,{size:14,className:"text-neutral-300"})})]})}),e.jsx("td",{className:"p-6 align-top",children:e.jsx("div",{className:"text-sm text-neutral-600 leading-relaxed font-medium",children:e.jsx(Zt,{text:d.explanation})})}),e.jsx("td",{className:"p-6 align-top",children:e.jsxs("div",{className:"p-3 bg-neutral-50 rounded-xl border border-neutral-100 text-sm italic text-neutral-600",children:['"',d.example,'"']})}),e.jsx("td",{className:"p-6 align-top",children:e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:d.userNote||"",onChange:w=>S(x,w.target.value),placeholder:"Add note...",rows:3,className:"w-full bg-transparent border-b border-transparent focus:border-neutral-300 focus:bg-white p-2 rounded-lg text-xs font-medium text-neutral-600 resize-none outline-none transition-all"}),e.jsxs("div",{className:"absolute top-2 right-2 pointer-events-none",children:[c[x]==="saving"&&e.jsx(be,{size:12,className:"animate-spin text-neutral-400"}),c[x]==="saved"&&e.jsx(wt,{size:12,className:"text-green-500"})]})]})})]},x))})]})})})]}),ts=({group:s,onBack:g,onEdit:c})=>{const[N,u]=n.useState(new Set),[S,d]=n.useState({}),x=n.useRef({}),[w,j]=n.useState(s);n.useEffect(()=>{const p=bt();u(new Set(p.map(h=>h.word.toLowerCase()))),s.id!==w.id&&j(s)},[s.id,s.words]);const m=(p,h)=>{const T=[...w.comparisonData];T[p]={...T[p],userNote:h};const E={...w,comparisonData:T};j(E),d(D=>({...D,[p]:"saving"})),x.current[p]&&clearTimeout(x.current[p]),x.current[p]=window.setTimeout(async()=>{const D={...E,updatedAt:Date.now()};await fe(D),d(k=>({...k,[p]:"saved"})),setTimeout(()=>d(k=>({...k,[p]:null})),2e3)},1e3)};return e.jsx(es,{group:w,libraryWords:N,noteSavingStatus:S,onBack:g,onEdit:c,onNoteChange:m})},ss=({name:s,setName:g,wordsInput:c,setWordsInput:N,tagsInput:u,setTagsInput:S,comparisonData:d,onDeleteRow:x,isSaving:w,onSave:j,onCancel:m,onOpenAiRefine:p})=>e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6 animate-in fade-in duration-300 pb-20",children:[e.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("button",{onClick:m,className:"flex items-center space-x-2 text-xs font-bold text-neutral-400 hover:text-neutral-900 transition-colors uppercase tracking-wider mb-1",children:[e.jsx(Q,{size:14}),e.jsx("span",{children:"Cancel"})]}),e.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:"Edit Comparison"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:p,className:"px-5 py-2.5 bg-white border border-neutral-200 text-neutral-600 rounded-xl font-black text-[10px] flex items-center space-x-2 active:scale-95 uppercase tracking-widest hover:bg-neutral-50 transition-all",children:[e.jsx(we,{size:14,className:"text-amber-500"}),e.jsx("span",{children:"AI Refine"})]}),e.jsxs("button",{onClick:j,disabled:w,className:"px-6 py-2.5 bg-neutral-900 text-white rounded-xl font-black text-[10px] flex items-center space-x-2 transition-all active:scale-95 hover:bg-neutral-800 disabled:opacity-50 uppercase tracking-widest shadow-sm",children:[w?e.jsx(be,{size:14,className:"animate-spin"}):e.jsx(De,{size:14}),e.jsx("span",{children:"Save"})]})]})]}),e.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm space-y-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Group Name"}),e.jsx("input",{type:"text",value:s,onChange:h=>g(h.target.value),placeholder:"e.g. Words for 'Big'",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-lg font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Words to Compare"}),e.jsx("textarea",{value:c,onChange:h=>N(h.target.value),rows:4,placeholder:"Enter words (one per line or comma separated)...",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none resize-none"}),e.jsx("p",{className:"text-[10px] text-neutral-400 px-1 italic",children:"Tip: Use AI Refine to automatically generate explanations for these words."})]}),d&&d.length>0&&e.jsxs("div",{className:"space-y-2 pt-4 border-t border-neutral-100",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:["Generated Comparisons (",d.length,")"]}),e.jsx("div",{className:"space-y-2",children:d.map((h,T)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-neutral-50 rounded-xl border border-neutral-100 group",children:[e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx("span",{className:"font-bold text-sm text-neutral-900",children:h.word})}),e.jsx("p",{className:"text-xs text-neutral-600 line-clamp-2",children:h.explanation.replace(/\*\*/g,"")})]}),e.jsx("button",{onClick:()=>x(T),className:"p-2 text-neutral-400 hover:bg-red-50 hover:text-red-600 rounded-lg transition-colors",title:"Delete Row",children:e.jsx(J,{size:16})})]},T))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Tags"}),e.jsx("input",{type:"text",value:u,onChange:h=>S(h.target.value),placeholder:"e.g. Adjectives, Formal",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none"})]})]})]}),as=({group:s,onSave:g,onCancel:c,user:N})=>{const[u,S]=n.useState(s.name),[d,x]=n.useState(s.words.join(`
`)),[w,j]=n.useState(s.path||"/"),[m,p]=n.useState((s.tags||[]).join(", ")),[h,T]=n.useState(s.comparisonData||[]),[E,D]=n.useState(!1),[k,y]=n.useState(!1),{showToast:F}=je();n.useEffect(()=>{if(s.path===void 0&&s.tags){const f=s.tags||[],C=f.find(b=>b.startsWith("/")),O=f.filter(b=>!b.startsWith("/"));j(C||"/"),p(O.join(", "))}else j(s.path||"/"),p((s.tags||[]).join(", "));T(s.comparisonData||[])},[s]);const H=async()=>{D(!0);const f=d.split(/[\n,;]+/).map(b=>b.trim()).filter(Boolean),C=m.split(",").map(b=>b.trim()).filter(Boolean);C.some(b=>b.toLowerCase()==="comparison")||C.push("Comparison");const O={...s,name:u,words:f,path:w.trim(),tags:C,comparisonData:h,updatedAt:Date.now()};await fe(O),g(O),D(!1)},R=f=>{const C=h[f],O=h.filter((A,o)=>o!==f);T(O);const v=d.split(/[\n,;]+/).map(A=>A.trim()).filter(A=>A.toLowerCase()!==C.word.toLowerCase());x(v.join(`
`))},V=()=>{const f=d.split(/[\n,;]+/).map(C=>C.trim()).filter(Boolean);return Kt(u,f)},B=f=>{if(f.updatedWords&&f.comparisonData){x(f.updatedWords.join(`
`)),f.title&&S(f.title);const C=m.split(",").map(b=>b.trim()).filter(Boolean);C.some(b=>b.toLowerCase()==="comparison")||(C.push("Comparison"),p(C.join(", "))),T(f.comparisonData);const O={...s,name:f.title||u,words:f.updatedWords,comparisonData:f.comparisonData,tags:C,path:w,updatedAt:Date.now()};fe(O).then(()=>{F("Group refined! Please verify and Save.","success")}),y(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(ss,{name:u,setName:S,wordsInput:d,setWordsInput:x,path:w,setPath:j,tagsInput:m,setTagsInput:p,comparisonData:h,onDeleteRow:R,isSaving:E,onSave:H,onCancel:c,onOpenAiRefine:()=>y(!0)}),k&&e.jsx(Ne,{isOpen:k,onClose:()=>y(!1),type:"REFINE_WORDS",title:"Refine Comparison",description:"AI will generate nuanced explanations and examples.",initialData:{},hidePrimaryInput:!0,onGeneratePrompt:V,onJsonReceived:B,actionLabel:"Apply Refinement"})]})},ns={filterSchema:[],viewSchema:[]},Re="vocab_pro_lesson_view_settings",Ns=({user:s,onStartSession:g,onNavigate:c,onUpdateUser:N})=>{var Te;const[u,S]=n.useState([]),[d,x]=n.useState([]),[w,j]=n.useState(!0),[m,p]=n.useState(null),[h,T]=n.useState(!1),[E,D]=n.useState(!1),[k,y]=n.useState("ALL"),[F,H]=n.useState("all"),[R,V]=n.useState("all"),[B,f]=n.useState(()=>jt(Re,{showDesc:!0,compact:!1})),[C,O]=n.useState(0),[b,v]=n.useState(12),[A,o]=n.useState("list"),[_,M]=n.useState(null),[$,U]=n.useState(null),[I,q]=n.useState(null),[se,ae]=n.useState(null),[ne,oe]=n.useState(null),[K,re]=n.useState(null),[_e,ie]=n.useState(!1),{currentShelfName:le,booksOnCurrentShelf:ce,allShelves:X,addShelf:Ue,renameShelf:Ge,removeShelf:We,nextShelf:$e,prevShelf:Ye,selectShelf:Ve}=Ft(d,"lesson_books_shelves"),[Je,de]=n.useState(!1),[Ke,ue]=n.useState(!1),[G,pe]=n.useState(null),{showToast:W}=je();n.useEffect(()=>{Nt(Re,B)},[B]);const z=n.useCallback(async()=>{j(!0);try{const[t,a,i]=await Promise.all([vt(s.id),St(s.id),yt(s.id)]),r=[...t.map(l=>({type:"ESSAY",data:l,path:l.path,tags:l.tags,date:l.createdAt})),...a.map(l=>({type:"COMPARISON",data:l,path:l.path,tags:l.tags,date:l.createdAt}))];S(r.sort((l,P)=>P.date-l.date)),x(i.sort((l,P)=>P.createdAt-l.createdAt))}finally{j(!1)}},[s.id]);n.useEffect(()=>{z()},[z]),n.useEffect(()=>{O(0)},[m,k,F,R,b]);const Y=n.useMemo(()=>u.filter(t=>{var a,i;if(k!=="ALL"&&t.type!==k||F==="focused"&&!t.data.isFocused||R!=="all"&&t.data.focusColor!==R)return!1;if(m){if(m==="Uncategorized"){const r=t.path??(t.tags||[]).find(P=>P.startsWith("/"));if(r&&r!=="/")return!1}else if(!((a=t.path)!=null&&a.startsWith(m))&&!((i=t.tags)!=null&&i.includes(m)))return!1}return!0}),[u,m,k,F,R]),He=n.useMemo(()=>{const t=C*b;return Y.slice(t,t+b)},[Y,C,b]),qe=t=>{Ge(t,async(i,r)=>{j(!0);const l=d.filter(P=>{const L=P.title.split(":");return(L.length>1?L[0].trim():"General")===i});await Promise.all(l.map(P=>{const L=P.title.split(":"),Ae=L.length>1?L.slice(1).join(":").trim():L[0],mt=`${r}: ${Ae}`;return ee({...P,title:mt,updatedAt:Date.now()})})),await z()})&&ue(!1)},ve=async()=>{const t={id:`lb-${Date.now()}`,userId:s.id,title:`${le}: New Book`,itemIds:[],createdAt:Date.now(),updatedAt:Date.now(),color:"#1a237e",icon:"ðŸ“˜"};await ee(t),await z(),q(t),o("book_detail"),W("New book created.","success")},he=async t=>{if(!I)return;const a={...I,...t,updatedAt:Date.now()};x(i=>i.map(r=>r.id===a.id?a:r)),q(a),await ee(a)},Xe=async()=>{K&&(await At(K.id),W("Book deleted.","success"),re(null),await z())},Qe=async t=>{if(!G)return;const a=G.title.split(":"),i=a.length>1?a.slice(1).join(":").trim():a[0],r=`${t}: ${i}`,l={...G,title:r,updatedAt:Date.now()};await ee(l),pe(null),await z(),W(`Moved to "${t}".`,"success")},Ze=async()=>{se&&(await Lt(se.id),W("Lesson deleted.","success"),ae(null),z())},et=async()=>{ne&&(await It(ne.id),W("Comparison deleted.","success"),oe(null),z())},tt=async t=>{await Z(t),W("Lesson saved!","success"),o(I?"book_detail":"list"),M(null),z()},st=async t=>{await me(t),W("Comparison saved!","success"),o("read_comparison"),U(t),z()},at=()=>{const t={id:`lesson-${Date.now()}`,userId:s.id,topic1:"",topic2:"",title:"New Lesson",description:"",content:"",tags:[],createdAt:Date.now(),updatedAt:Date.now()};M(t),o("edit_lesson")},nt=()=>{const t={id:`cmp-${Date.now()}`,userId:s.id,name:"New Comparison",words:[],tags:[],comparisonData:[],createdAt:Date.now(),updatedAt:Date.now()};U(t),o("edit_comparison")},ot=async t=>{const{result:a,preferences:i}=t;JSON.stringify(s.lessonPreferences)!==JSON.stringify(i)&&await N({...s,lessonPreferences:i});const r={id:`lesson-ai-${Date.now()}`,userId:s.id,title:a.title,description:a.description,content:a.content,tags:a.tags||[],createdAt:Date.now(),updatedAt:Date.now(),topic1:"",topic2:""};await Z(r),W("Lesson created with AI!","success"),ie(!1),M(r),o("read_lesson"),z()},Se=async(t,a)=>{const i={...t.data,focusColor:a||void 0,updatedAt:Date.now()};a||delete i.focusColor,t.type==="ESSAY"?await Z(i):await me(i),S(r=>r.map(l=>l.data.id===t.data.id?l.type==="ESSAY"?{...l,data:{...l.data,focusColor:a||void 0,updatedAt:Date.now()}}:{...l,data:{...l.data,focusColor:a||void 0,updatedAt:Date.now()}}:l))},ye=async t=>{const a={...t.data,isFocused:!t.data.isFocused,updatedAt:Date.now()};t.type==="ESSAY"?await Z(a):await me(a),S(i=>i.map(r=>r.data.id===t.data.id?r.type==="ESSAY"?{...r,data:{...r.data,isFocused:!r.data.isFocused,updatedAt:Date.now()}}:{...r,data:{...r.data,isFocused:!r.data.isFocused,updatedAt:Date.now()}}:r))},rt=()=>{if(Y.length===0){W("No items to randomize.","info");return}const t=Y[Math.floor(Math.random()*Y.length)];t.type==="ESSAY"?(M(t.data),o("read_lesson")):(U(t.data),o("read_comparison"))},it=[{label:"AI Lesson",icon:we,onClick:()=>ie(!0)},{label:"New Comparison",icon:Ee,onClick:nt},{label:"New Lesson",icon:Le,onClick:at}],lt=t=>{const a=window.CONFIG||ze(),i=a.audioCoach.activeCoach,r=a.audioCoach.coaches[i].name;return Be({topic:t.topic,language:t.language,targetAudience:t.targetAudience,tone:t.tone,coachName:r})},ct=n.useMemo(()=>I?I.itemIds.map(t=>{const a=u.find(r=>r.data.id===t);if(!a)return null;const i=a.type==="ESSAY";return{id:a.data.id,title:i?a.data.title:a.data.name,subtitle:i?"Lesson":"Comparison",data:a,focusColor:a.data.focusColor,isFocused:a.data.isFocused}}).filter(t=>t!==null):[],[I,u]),dt=n.useMemo(()=>u.map(t=>{const a=t.type==="ESSAY";return{id:t.data.id,title:a?t.data.title:t.data.name,subtitle:a?"Lesson":"Comparison",data:t}}),[u]),ut=t=>{if(!I)return;const a=Array.from(new Set([...I.itemIds,...t]));he({itemIds:a})},pt=t=>{if(!I)return;const a=I.itemIds.filter(i=>i!==t);he({itemIds:a})},ht=(t,a)=>{const i=t.data;Se(i,a)},xt=t=>{const a=t.data;ye(a)},Ce=t=>{Ve(t),o("shelf")},ke=t=>{q(t),o("book_detail")};return A==="read_lesson"&&_?e.jsx(Qt,{lesson:_,onComplete:()=>o(I?"book_detail":"list"),onEdit:()=>o("edit_lesson")}):A==="edit_lesson"&&_?e.jsx(qt,{lesson:_,user:s,onSave:tt,onPractice:t=>{M(t),o("read_lesson")},onCancel:()=>o(I?"book_detail":"list")}):A==="read_comparison"&&$?e.jsx(ts,{group:$,onBack:()=>o(I?"book_detail":"list"),onEdit:()=>o("edit_comparison")}):A==="edit_comparison"&&$?e.jsx(as,{group:$,onSave:st,onCancel:()=>o($.words.length>0?"read_comparison":I?"book_detail":"list"),user:s}):A==="book_detail"&&I?e.jsx(Mt,{book:I,items:ct,availableItems:dt,onBack:()=>{q(null),o("shelf"),z()},onUpdateBook:he,onAddItem:ut,onRemoveItem:pt,onOpenItem:t=>{const a=t.data;a.type==="ESSAY"?(M(a.data),o("read_lesson")):(U(a.data),o("read_comparison"))},onEditItem:t=>{const a=t.data;a.type==="ESSAY"?(M(a.data),o("edit_lesson")):(U(a.data),o("edit_comparison"))},onFocusChange:ht,onToggleFocus:xt,itemIcon:e.jsx(ge,{size:16})}):A==="shelf"?e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("button",{onClick:()=>o("list"),className:"w-fit flex items-center gap-2 text-sm font-bold text-neutral-500 hover:text-neutral-900 transition-colors group",children:[e.jsx(Q,{size:18,className:"group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{children:"Back to Main Library"})]}),e.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:"Lesson Shelf"}),e.jsx("p",{className:"text-neutral-500 mt-1 font-medium",children:"Organize your knowledge."})]}),e.jsx(Ie,{shelves:X,books:d,onNavigateShelf:Ce,onNavigateBook:ke}),e.jsxs("button",{onClick:()=>de(!0),className:"px-6 py-3 bg-white border border-neutral-200 text-neutral-600 rounded-xl font-black text-xs flex items-center gap-2 uppercase tracking-widest hover:bg-neutral-50 transition-all shadow-sm",children:[e.jsx(Ee,{size:14})," Add Shelf"]})]})]}),e.jsxs(Pt,{label:le,onNext:X.length>1?$e:void 0,onPrev:X.length>1?Ye:void 0,actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ue(!0),className:"p-2 bg-white/20 text-white/70 rounded-full hover:bg-white/40 hover:text-white",title:"Rename Shelf",children:e.jsx($t,{size:14})}),e.jsx("button",{onClick:We,disabled:ce.length>0,className:"p-2 bg-white/20 text-white/70 rounded-full hover:bg-white/40 hover:text-white disabled:opacity-30 disabled:hover:bg-white/20",title:"Remove Empty Shelf",children:e.jsx(J,{size:14})})]}),isEmpty:ce.length===0,emptyAction:e.jsx("button",{onClick:ve,className:"px-6 py-3 bg-white/10 hover:bg-white/20 text-white rounded-xl font-bold text-xs uppercase tracking-widest border border-white/20",children:"Create First Book"}),children:[ce.map(t=>{const a=t.title,i=a.split(":"),r=i.length>1?i.slice(1).join(":").trim():a;return e.jsx(Bt,{id:t.id,title:r,subTitle:`${t.itemIds.length} Items`,icon:e.jsx(Ct,{size:24}),color:t.color,titleColor:t.titleColor,titleSize:t.titleSize,titleTop:t.titleTop,titleLeft:t.titleLeft,iconTop:t.iconTop,iconLeft:t.iconLeft,onClick:()=>{q(t),o("book_detail")},actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),pe(t)},className:"p-1.5 bg-black/30 text-white/60 rounded-full hover:bg-neutral-700 hover:text-white transition-all shadow-sm",title:"Move to Shelf",children:e.jsx(Wt,{size:16})}),e.jsx("button",{onClick:l=>{l.stopPropagation(),re(t)},className:"p-1.5 bg-black/30 text-white/60 rounded-full hover:bg-red-600 hover:text-white transition-all shadow-sm",title:"Delete",children:e.jsx(J,{size:16})})]})},t.id)}),e.jsx("div",{className:"group [perspective:1000px] translate-y-0",children:e.jsx("div",{className:"relative w-full aspect-[5/7] rounded-lg bg-neutral-800/50 border-2 border-dashed border-neutral-500/50 transition-all duration-300 group-hover:border-neutral-400 group-hover:bg-neutral-800/80 group-hover:shadow-xl flex flex-col items-stretch justify-center overflow-hidden",children:e.jsxs("button",{onClick:ve,className:"flex-1 flex flex-col items-center justify-center p-2 text-center text-neutral-400 hover:bg-white/5 transition-colors",children:[e.jsx(Le,{size:32,className:"mb-2 text-neutral-500"}),e.jsx("h3",{className:"font-sans text-xs font-black uppercase tracking-wider",children:"New Book"})]})})})]}),e.jsx(xe,{isOpen:!!K,title:"Delete Book?",message:e.jsxs(e.Fragment,{children:["Are you sure you want to delete ",e.jsxs("strong",{children:['"',(Te=K==null?void 0:K.title.split(":").pop())==null?void 0:Te.trim(),'"']}),"? Items inside will not be deleted."]}),confirmText:"Delete",isProcessing:!1,onConfirm:Xe,onClose:()=>re(null),icon:e.jsx(J,{size:40,className:"text-red-500"})}),e.jsx(_t,{isOpen:!!G,onClose:()=>pe(null),onConfirm:Qe,shelves:X,currentShelf:G?G.title.split(":")[0].trim():"General",bookTitle:(G==null?void 0:G.title)||""}),e.jsx(Ut,{isOpen:Je,onClose:()=>de(!1),onSave:t=>{Ue(t)&&de(!1)}}),e.jsx(Gt,{isOpen:Ke,onClose:()=>ue(!1),onSave:qe,initialName:le})]}):e.jsxs(e.Fragment,{children:[e.jsx(Et,{title:"Knowledge Library",subtitle:"Your collection of lessons and comparisons.",icon:e.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Notebook.png",className:"w-8 h-8 object-contain",alt:"Lessons"}),centerContent:e.jsx(Ie,{shelves:X,books:d,onNavigateShelf:Ce,onNavigateBook:ke}),minorSkills:e.jsxs("button",{onClick:()=>c("IRREGULAR_VERBS"),className:"flex items-center gap-2 px-3 py-2 bg-orange-50 text-orange-700 rounded-lg text-xs font-bold hover:bg-orange-100 transition-colors",children:[e.jsx(Vt,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Irregular Verbs"})]}),pagination:{page:C,totalPages:Math.ceil(Y.length/b),onPageChange:O,pageSize:b,onPageSizeChange:v,totalItems:Y.length},actions:e.jsx(Rt,{viewMenu:e.jsx(zt,{isOpen:E,setIsOpen:D,filterOptions:[{label:"All",value:"ALL",isActive:k==="ALL",onClick:()=>y("ALL")},{label:"Lesson",value:"ESSAY",isActive:k==="ESSAY",onClick:()=>y("ESSAY")},{label:"Comp.",value:"COMPARISON",isActive:k==="COMPARISON",onClick:()=>y("COMPARISON")}],customSection:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-2 text-[9px] font-black text-neutral-400 uppercase tracking-widest border-b border-neutral-50 flex items-center gap-2",children:[e.jsx(Tt,{size:10})," Focus & Status"]}),e.jsxs("div",{className:"p-1 flex flex-col gap-1 bg-neutral-100 rounded-xl mb-2",children:[e.jsx("button",{onClick:()=>H(F==="all"?"focused":"all"),className:`w-full py-1.5 text-[9px] font-black rounded-lg transition-all ${F==="focused"?"bg-white shadow-sm text-red-600":"text-neutral-500 hover:text-neutral-700"}`,children:F==="focused"?"Focused Only":"All Items"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>V(R==="green"?"all":"green"),className:`flex-1 h-6 rounded-lg border-2 transition-all ${R==="green"?"bg-emerald-500 border-emerald-600":"bg-white border-neutral-200 hover:bg-emerald-50"}`}),e.jsx("button",{onClick:()=>V(R==="yellow"?"all":"yellow"),className:`flex-1 h-6 rounded-lg border-2 transition-all ${R==="yellow"?"bg-amber-400 border-amber-500":"bg-white border-neutral-200 hover:bg-amber-50"}`}),e.jsx("button",{onClick:()=>V(R==="red"?"all":"red"),className:`flex-1 h-6 rounded-lg border-2 transition-all ${R==="red"?"bg-rose-50 border-rose-600":"bg-white border-neutral-200 hover:bg-rose-50"}`})]})]})]}),viewOptions:[{label:"Show Description",checked:B.showDesc,onChange:()=>f(t=>({...t,showDesc:!t.showDesc}))},{label:"Compact",checked:B.compact,onChange:()=>f(t=>({...t,compact:!t.compact}))}]}),browseTags:{isOpen:h,onToggle:()=>{T(!h)}},addActions:it,extraActions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:rt,disabled:u.length<2,className:"p-3 bg-white border border-neutral-200 text-neutral-600 rounded-xl hover:bg-neutral-50 active:scale-95 transition-all shadow-sm disabled:opacity-50",title:"Randomize",children:e.jsx(kt,{size:16})}),e.jsxs("button",{onClick:()=>o("shelf"),className:"px-5 py-3 bg-indigo-600 text-white rounded-xl font-black text-xs flex items-center gap-2 hover:bg-indigo-700 active:scale-95 transition-all shadow-lg shadow-indigo-200",title:"Bookshelf Mode",children:[e.jsx(Yt,{size:16}),e.jsx("span",{children:"Bookshelf"})]})]})}),aboveGrid:e.jsx(e.Fragment,{children:h&&e.jsx(Ot,{items:u,selectedTag:m,onSelectTag:p,forcedView:"tags",title:"Browse Tags",icon:e.jsx(Fe,{size:16})})}),config:ns,activeFilters:{},onFilterChange:()=>{},isLoading:w,isEmpty:Y.length===0,emptyMessage:"No items found matching your criteria.",children:()=>e.jsx(e.Fragment,{children:He.map(t=>{const a=t.type==="ESSAY",i=a?t.data.title:t.data.name,r=a?()=>{M(t.data),o("read_lesson")}:()=>{U(t.data),o("read_comparison")},l=a?()=>{M(t.data),o("edit_lesson")}:()=>{U(t.data),o("edit_comparison")},P=a?()=>ae(t.data):()=>oe(t.data);return e.jsx(Dt,{title:i,tags:t.data.tags,compact:B.compact,onClick:r,focusColor:t.data.focusColor,onFocusChange:L=>Se(t,L),isFocused:t.data.isFocused,onToggleFocus:()=>ye(t),isCompleted:t.data.focusColor==="green",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:L=>{L.stopPropagation(),r()},className:"p-1.5 text-neutral-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Read",children:e.jsx(ge,{size:14})}),e.jsx("button",{onClick:L=>{L.stopPropagation(),l()},className:"p-1.5 text-neutral-400 hover:text-neutral-900 hover:bg-neutral-100 rounded-lg transition-colors",title:"Edit",children:e.jsx(te,{size:14})}),e.jsx("button",{onClick:L=>{L.stopPropagation(),P()},className:"p-1.5 text-neutral-400 hover:text-rose-600 hover:bg-rose-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(J,{size:14})})]}),children:B.showDesc&&(a?t.data.description&&e.jsx("p",{className:"line-clamp-2",children:t.data.description}):e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[t.data.words.slice(0,4).map(L=>e.jsx("span",{className:"px-2 py-0.5 bg-neutral-100 text-neutral-600 rounded text-[10px] font-bold",children:L},L)),t.data.words.length>4&&e.jsxs("span",{className:"text-[10px] text-neutral-400 font-bold",children:["+",t.data.words.length-4]})]}))},`${t.type}-${t.data.id}`)})})}),e.jsx(xe,{isOpen:!!se,title:"Delete Lesson?",message:"Confirm delete?",confirmText:"Yes, Delete",isProcessing:!1,onConfirm:Ze,onClose:()=>ae(null),icon:e.jsx(J,{size:40,className:"text-red-500"})}),e.jsx(xe,{isOpen:!!ne,title:"Delete Comparison?",message:"Confirm delete?",confirmText:"Yes, Delete",isProcessing:!1,onConfirm:et,onClose:()=>oe(null),icon:e.jsx(J,{size:40,className:"text-red-500"})}),e.jsx(Ne,{isOpen:_e,onClose:()=>ie(!1),type:"GENERATE_LESSON",title:"AI Lesson Creator",description:"Design a custom lesson instantly.",initialData:s.lessonPreferences,onGeneratePrompt:lt,onJsonReceived:ot,actionLabel:"Create Lesson",closeOnSuccess:!0})]})};export{Ns as LessonLibraryV2,Ns as default};
