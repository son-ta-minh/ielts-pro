const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-RkEvf4BI.js","assets/list-todo-DcMdKt0h.js","assets/file-clock-CeWgdUfY.js","assets/split-DUNM_Y9A.js","assets/keyboard-V0A8DQnD.js","assets/ReviewSession-CjXkwPxH.js","assets/trophy-D89UyaWT.js","assets/WordList-BM2C18Sv.js","assets/WordTable-D12rZTrY.js","assets/WordTable_UI-BLDaMi7l.js","assets/TagBrowser-CIgp-KMu.js","assets/tag-BvK2p_r7.js","assets/columns-2-aftmZpzT.js","assets/calendar-DKvr-6wu.js","assets/square-check-big-DjH7J7oL.js","assets/chevron-left-DyZSGs57.js","assets/ReadingUnitPage-X2wg1htv.js","assets/minus-DPwcJAf0.js","assets/ResourceActions-DtM915GN.js","assets/ViewMenu-C84DxVzg.js","assets/filter-DJVyTmTU.js","assets/UniversalCard-DYozYuDH.js","assets/FileSelector-DiV1Qw9d.js","assets/server-BB_8MrQJ.js","assets/music-CgB-4BWc.js","assets/SettingsView-t5IY5Xwj.js","assets/AvatarSelectionModal-DmHqE8V9.js","assets/palette-DgSIv6hE.js","assets/Discover-lUZ6ypFf.js","assets/layout-grid-BGg3pFWu.js","assets/WritingStudioPage-DdGn-_j3.js","assets/chart-no-axes-column-increasing-DMxWpEWT.js","assets/IrregularVerbs-CmQdv4xe.js","assets/library-DKHCfhkW.js","assets/MimicPractice-BE-NtyO-.js","assets/ear-CRVBInem.js","assets/LessonLibraryV2-DEMtPddE.js","assets/headphones-BfI0RHN0.js","assets/PlanningPage-Y4iD8sC0.js","assets/grip-vertical-DjieAwdn.js","assets/SpeakingCardPage-CxgGfuuq.js","assets/WordBookPage-DDVavrzH.js","assets/CourseList-BhstyBl0.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function s(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=s(o);fetch(o.href,l)}})();function SE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Fp={exports:{}},Nc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ev;function C2(){if(ev)return Nc;ev=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function s(r,o,l){var d=null;if(l!==void 0&&(d=""+l),o.key!==void 0&&(d=""+o.key),"key"in o){l={};for(var m in o)m!=="key"&&(l[m]=o[m])}else l=o;return o=l.ref,{$$typeof:n,type:r,key:d,ref:o!==void 0?o:null,props:l}}return Nc.Fragment=e,Nc.jsx=s,Nc.jsxs=s,Nc}var tv;function R2(){return tv||(tv=1,Fp.exports=C2()),Fp.exports}var u=R2(),Hp={exports:{}},Xe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nv;function O2(){if(nv)return Xe;nv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),d=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),S=Symbol.iterator;function N(T){return T===null||typeof T!="object"?null:(T=S&&T[S]||T["@@iterator"],typeof T=="function"?T:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},M=Object.assign,j={};function V(T,z,$){this.props=T,this.context=z,this.refs=j,this.updater=$||P}V.prototype.isReactComponent={},V.prototype.setState=function(T,z){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,z,"setState")},V.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function B(){}B.prototype=V.prototype;function H(T,z,$){this.props=T,this.context=z,this.refs=j,this.updater=$||P}var G=H.prototype=new B;G.constructor=H,M(G,V.prototype),G.isPureReactComponent=!0;var Y=Array.isArray;function K(){}var I={H:null,A:null,T:null,S:null},A=Object.prototype.hasOwnProperty;function _(T,z,$){var J=$.ref;return{$$typeof:n,type:T,key:z,ref:J!==void 0?J:null,props:$}}function C(T,z){return _(T.type,z,T.props)}function R(T){return typeof T=="object"&&T!==null&&T.$$typeof===n}function L(T){var z={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function($){return z[$]})}var O=/\/+/g;function xe(T,z){return typeof T=="object"&&T!==null&&T.key!=null?L(""+T.key):z.toString(36)}function ge(T){switch(T.status){case"fulfilled":return T.value;case"rejected":throw T.reason;default:switch(typeof T.status=="string"?T.then(K,K):(T.status="pending",T.then(function(z){T.status==="pending"&&(T.status="fulfilled",T.value=z)},function(z){T.status==="pending"&&(T.status="rejected",T.reason=z)})),T.status){case"fulfilled":return T.value;case"rejected":throw T.reason}}throw T}function F(T,z,$,J,pe){var de=typeof T;(de==="undefined"||de==="boolean")&&(T=null);var _e=!1;if(T===null)_e=!0;else switch(de){case"bigint":case"string":case"number":_e=!0;break;case"object":switch(T.$$typeof){case n:case e:_e=!0;break;case x:return _e=T._init,F(_e(T._payload),z,$,J,pe)}}if(_e)return pe=pe(T),_e=J===""?"."+xe(T,0):J,Y(pe)?($="",_e!=null&&($=_e.replace(O,"$&/")+"/"),F(pe,z,$,"",function(ie){return ie})):pe!=null&&(R(pe)&&(pe=C(pe,$+(pe.key==null||T&&T.key===pe.key?"":(""+pe.key).replace(O,"$&/")+"/")+_e)),z.push(pe)),1;_e=0;var W=J===""?".":J+":";if(Y(T))for(var le=0;le<T.length;le++)J=T[le],de=W+xe(J,le),_e+=F(J,z,$,de,pe);else if(le=N(T),typeof le=="function")for(T=le.call(T),le=0;!(J=T.next()).done;)J=J.value,de=W+xe(J,le++),_e+=F(J,z,$,de,pe);else if(de==="object"){if(typeof T.then=="function")return F(ge(T),z,$,J,pe);throw z=String(T),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.")}return _e}function ue(T,z,$){if(T==null)return T;var J=[],pe=0;return F(T,J,"","",function(de){return z.call($,de,pe++)}),J}function ae(T){if(T._status===-1){var z=T._result;z=z(),z.then(function($){(T._status===0||T._status===-1)&&(T._status=1,T._result=$)},function($){(T._status===0||T._status===-1)&&(T._status=2,T._result=$)}),T._status===-1&&(T._status=0,T._result=z)}if(T._status===1)return T._result.default;throw T._result}var X=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var z=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(z))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",T);return}console.error(T)},Q={map:ue,forEach:function(T,z,$){ue(T,function(){z.apply(this,arguments)},$)},count:function(T){var z=0;return ue(T,function(){z++}),z},toArray:function(T){return ue(T,function(z){return z})||[]},only:function(T){if(!R(T))throw Error("React.Children.only expected to receive a single React element child.");return T}};return Xe.Activity=v,Xe.Children=Q,Xe.Component=V,Xe.Fragment=s,Xe.Profiler=o,Xe.PureComponent=H,Xe.StrictMode=r,Xe.Suspense=p,Xe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Xe.__COMPILER_RUNTIME={__proto__:null,c:function(T){return I.H.useMemoCache(T)}},Xe.cache=function(T){return function(){return T.apply(null,arguments)}},Xe.cacheSignal=function(){return null},Xe.cloneElement=function(T,z,$){if(T==null)throw Error("The argument must be a React element, but you passed "+T+".");var J=M({},T.props),pe=T.key;if(z!=null)for(de in z.key!==void 0&&(pe=""+z.key),z)!A.call(z,de)||de==="key"||de==="__self"||de==="__source"||de==="ref"&&z.ref===void 0||(J[de]=z[de]);var de=arguments.length-2;if(de===1)J.children=$;else if(1<de){for(var _e=Array(de),W=0;W<de;W++)_e[W]=arguments[W+2];J.children=_e}return _(T.type,pe,J)},Xe.createContext=function(T){return T={$$typeof:d,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null},T.Provider=T,T.Consumer={$$typeof:l,_context:T},T},Xe.createElement=function(T,z,$){var J,pe={},de=null;if(z!=null)for(J in z.key!==void 0&&(de=""+z.key),z)A.call(z,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(pe[J]=z[J]);var _e=arguments.length-2;if(_e===1)pe.children=$;else if(1<_e){for(var W=Array(_e),le=0;le<_e;le++)W[le]=arguments[le+2];pe.children=W}if(T&&T.defaultProps)for(J in _e=T.defaultProps,_e)pe[J]===void 0&&(pe[J]=_e[J]);return _(T,de,pe)},Xe.createRef=function(){return{current:null}},Xe.forwardRef=function(T){return{$$typeof:m,render:T}},Xe.isValidElement=R,Xe.lazy=function(T){return{$$typeof:x,_payload:{_status:-1,_result:T},_init:ae}},Xe.memo=function(T,z){return{$$typeof:y,type:T,compare:z===void 0?null:z}},Xe.startTransition=function(T){var z=I.T,$={};I.T=$;try{var J=T(),pe=I.S;pe!==null&&pe($,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(K,X)}catch(de){X(de)}finally{z!==null&&$.types!==null&&(z.types=$.types),I.T=z}},Xe.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Xe.use=function(T){return I.H.use(T)},Xe.useActionState=function(T,z,$){return I.H.useActionState(T,z,$)},Xe.useCallback=function(T,z){return I.H.useCallback(T,z)},Xe.useContext=function(T){return I.H.useContext(T)},Xe.useDebugValue=function(){},Xe.useDeferredValue=function(T,z){return I.H.useDeferredValue(T,z)},Xe.useEffect=function(T,z){return I.H.useEffect(T,z)},Xe.useEffectEvent=function(T){return I.H.useEffectEvent(T)},Xe.useId=function(){return I.H.useId()},Xe.useImperativeHandle=function(T,z,$){return I.H.useImperativeHandle(T,z,$)},Xe.useInsertionEffect=function(T,z){return I.H.useInsertionEffect(T,z)},Xe.useLayoutEffect=function(T,z){return I.H.useLayoutEffect(T,z)},Xe.useMemo=function(T,z){return I.H.useMemo(T,z)},Xe.useOptimistic=function(T,z){return I.H.useOptimistic(T,z)},Xe.useReducer=function(T,z,$){return I.H.useReducer(T,z,$)},Xe.useRef=function(T){return I.H.useRef(T)},Xe.useState=function(T){return I.H.useState(T)},Xe.useSyncExternalStore=function(T,z,$){return I.H.useSyncExternalStore(T,z,$)},Xe.useTransition=function(){return I.H.useTransition()},Xe.version="19.2.4",Xe}var sv;function Ag(){return sv||(sv=1,Hp.exports=O2()),Hp.exports}var D=Ag();const Pn=SE(D);var Gp={exports:{}},Cc={},qp={exports:{}},$p={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var av;function j2(){return av||(av=1,(function(n){function e(F,ue){var ae=F.length;F.push(ue);e:for(;0<ae;){var X=ae-1>>>1,Q=F[X];if(0<o(Q,ue))F[X]=ue,F[ae]=Q,ae=X;else break e}}function s(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var ue=F[0],ae=F.pop();if(ae!==ue){F[0]=ae;e:for(var X=0,Q=F.length,T=Q>>>1;X<T;){var z=2*(X+1)-1,$=F[z],J=z+1,pe=F[J];if(0>o($,ae))J<Q&&0>o(pe,$)?(F[X]=pe,F[J]=ae,X=J):(F[X]=$,F[z]=ae,X=z);else if(J<Q&&0>o(pe,ae))F[X]=pe,F[J]=ae,X=J;else break e}}return ue}function o(F,ue){var ae=F.sortIndex-ue.sortIndex;return ae!==0?ae:F.id-ue.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,m=d.now();n.unstable_now=function(){return d.now()-m}}var p=[],y=[],x=1,v=null,S=3,N=!1,P=!1,M=!1,j=!1,V=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,H=typeof setImmediate<"u"?setImmediate:null;function G(F){for(var ue=s(y);ue!==null;){if(ue.callback===null)r(y);else if(ue.startTime<=F)r(y),ue.sortIndex=ue.expirationTime,e(p,ue);else break;ue=s(y)}}function Y(F){if(M=!1,G(F),!P)if(s(p)!==null)P=!0,K||(K=!0,L());else{var ue=s(y);ue!==null&&ge(Y,ue.startTime-F)}}var K=!1,I=-1,A=5,_=-1;function C(){return j?!0:!(n.unstable_now()-_<A)}function R(){if(j=!1,K){var F=n.unstable_now();_=F;var ue=!0;try{e:{P=!1,M&&(M=!1,B(I),I=-1),N=!0;var ae=S;try{t:{for(G(F),v=s(p);v!==null&&!(v.expirationTime>F&&C());){var X=v.callback;if(typeof X=="function"){v.callback=null,S=v.priorityLevel;var Q=X(v.expirationTime<=F);if(F=n.unstable_now(),typeof Q=="function"){v.callback=Q,G(F),ue=!0;break t}v===s(p)&&r(p),G(F)}else r(p);v=s(p)}if(v!==null)ue=!0;else{var T=s(y);T!==null&&ge(Y,T.startTime-F),ue=!1}}break e}finally{v=null,S=ae,N=!1}ue=void 0}}finally{ue?L():K=!1}}}var L;if(typeof H=="function")L=function(){H(R)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,xe=O.port2;O.port1.onmessage=R,L=function(){xe.postMessage(null)}}else L=function(){V(R,0)};function ge(F,ue){I=V(function(){F(n.unstable_now())},ue)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(F){F.callback=null},n.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<F?Math.floor(1e3/F):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_next=function(F){switch(S){case 1:case 2:case 3:var ue=3;break;default:ue=S}var ae=S;S=ue;try{return F()}finally{S=ae}},n.unstable_requestPaint=function(){j=!0},n.unstable_runWithPriority=function(F,ue){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var ae=S;S=F;try{return ue()}finally{S=ae}},n.unstable_scheduleCallback=function(F,ue,ae){var X=n.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?X+ae:X):ae=X,F){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=ae+Q,F={id:x++,callback:ue,priorityLevel:F,startTime:ae,expirationTime:Q,sortIndex:-1},ae>X?(F.sortIndex=ae,e(y,F),s(p)===null&&F===s(y)&&(M?(B(I),I=-1):M=!0,ge(Y,ae-X))):(F.sortIndex=Q,e(p,F),P||N||(P=!0,K||(K=!0,L()))),F},n.unstable_shouldYield=C,n.unstable_wrapCallback=function(F){var ue=S;return function(){var ae=S;S=ue;try{return F.apply(this,arguments)}finally{S=ae}}}})($p)),$p}var rv;function k2(){return rv||(rv=1,qp.exports=j2()),qp.exports}var Yp={exports:{}},Qn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iv;function L2(){if(iv)return Qn;iv=1;var n=Ag();function e(p){var y="https://react.dev/errors/"+p;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)y+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+p+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(){}var r={d:{f:s,r:function(){throw Error(e(522))},D:s,C:s,L:s,m:s,X:s,S:s,M:s},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(p,y,x){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:v==null?null:""+v,children:p,containerInfo:y,implementation:x}}var d=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function m(p,y){if(p==="font")return"";if(typeof y=="string")return y==="use-credentials"?y:""}return Qn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Qn.createPortal=function(p,y){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y||y.nodeType!==1&&y.nodeType!==9&&y.nodeType!==11)throw Error(e(299));return l(p,y,null,x)},Qn.flushSync=function(p){var y=d.T,x=r.p;try{if(d.T=null,r.p=2,p)return p()}finally{d.T=y,r.p=x,r.d.f()}},Qn.preconnect=function(p,y){typeof p=="string"&&(y?(y=y.crossOrigin,y=typeof y=="string"?y==="use-credentials"?y:"":void 0):y=null,r.d.C(p,y))},Qn.prefetchDNS=function(p){typeof p=="string"&&r.d.D(p)},Qn.preinit=function(p,y){if(typeof p=="string"&&y&&typeof y.as=="string"){var x=y.as,v=m(x,y.crossOrigin),S=typeof y.integrity=="string"?y.integrity:void 0,N=typeof y.fetchPriority=="string"?y.fetchPriority:void 0;x==="style"?r.d.S(p,typeof y.precedence=="string"?y.precedence:void 0,{crossOrigin:v,integrity:S,fetchPriority:N}):x==="script"&&r.d.X(p,{crossOrigin:v,integrity:S,fetchPriority:N,nonce:typeof y.nonce=="string"?y.nonce:void 0})}},Qn.preinitModule=function(p,y){if(typeof p=="string")if(typeof y=="object"&&y!==null){if(y.as==null||y.as==="script"){var x=m(y.as,y.crossOrigin);r.d.M(p,{crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0})}}else y==null&&r.d.M(p)},Qn.preload=function(p,y){if(typeof p=="string"&&typeof y=="object"&&y!==null&&typeof y.as=="string"){var x=y.as,v=m(x,y.crossOrigin);r.d.L(p,x,{crossOrigin:v,integrity:typeof y.integrity=="string"?y.integrity:void 0,nonce:typeof y.nonce=="string"?y.nonce:void 0,type:typeof y.type=="string"?y.type:void 0,fetchPriority:typeof y.fetchPriority=="string"?y.fetchPriority:void 0,referrerPolicy:typeof y.referrerPolicy=="string"?y.referrerPolicy:void 0,imageSrcSet:typeof y.imageSrcSet=="string"?y.imageSrcSet:void 0,imageSizes:typeof y.imageSizes=="string"?y.imageSizes:void 0,media:typeof y.media=="string"?y.media:void 0})}},Qn.preloadModule=function(p,y){if(typeof p=="string")if(y){var x=m(y.as,y.crossOrigin);r.d.m(p,{as:typeof y.as=="string"&&y.as!=="script"?y.as:void 0,crossOrigin:x,integrity:typeof y.integrity=="string"?y.integrity:void 0})}else r.d.m(p)},Qn.requestFormReset=function(p){r.d.r(p)},Qn.unstable_batchedUpdates=function(p,y){return p(y)},Qn.useFormState=function(p,y,x){return d.H.useFormState(p,y,x)},Qn.useFormStatus=function(){return d.H.useHostTransitionStatus()},Qn.version="19.2.4",Qn}var ov;function M2(){if(ov)return Yp.exports;ov=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Yp.exports=L2(),Yp.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lv;function D2(){if(lv)return Cc;lv=1;var n=k2(),e=Ag(),s=M2();function r(t){var a="https://react.dev/errors/"+t;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)a+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+t+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function l(t){var a=t,i=t;if(t.alternate)for(;a.return;)a=a.return;else{t=a;do a=t,(a.flags&4098)!==0&&(i=a.return),t=a.return;while(t)}return a.tag===3?i:null}function d(t){if(t.tag===13){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function m(t){if(t.tag===31){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function p(t){if(l(t)!==t)throw Error(r(188))}function y(t){var a=t.alternate;if(!a){if(a=l(t),a===null)throw Error(r(188));return a!==t?null:t}for(var i=t,c=a;;){var h=i.return;if(h===null)break;var g=h.alternate;if(g===null){if(c=h.return,c!==null){i=c;continue}break}if(h.child===g.child){for(g=h.child;g;){if(g===i)return p(h),t;if(g===c)return p(h),a;g=g.sibling}throw Error(r(188))}if(i.return!==c.return)i=h,c=g;else{for(var E=!1,k=h.child;k;){if(k===i){E=!0,i=h,c=g;break}if(k===c){E=!0,c=h,i=g;break}k=k.sibling}if(!E){for(k=g.child;k;){if(k===i){E=!0,i=g,c=h;break}if(k===c){E=!0,c=g,i=h;break}k=k.sibling}if(!E)throw Error(r(189))}}if(i.alternate!==c)throw Error(r(190))}if(i.tag!==3)throw Error(r(188));return i.stateNode.current===i?t:a}function x(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t;for(t=t.child;t!==null;){if(a=x(t),a!==null)return a;t=t.sibling}return null}var v=Object.assign,S=Symbol.for("react.element"),N=Symbol.for("react.transitional.element"),P=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),B=Symbol.for("react.consumer"),H=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),Y=Symbol.for("react.suspense"),K=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),C=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function L(t){return t===null||typeof t!="object"?null:(t=R&&t[R]||t["@@iterator"],typeof t=="function"?t:null)}var O=Symbol.for("react.client.reference");function xe(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===O?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case M:return"Fragment";case V:return"Profiler";case j:return"StrictMode";case Y:return"Suspense";case K:return"SuspenseList";case _:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case P:return"Portal";case H:return t.displayName||"Context";case B:return(t._context.displayName||"Context")+".Consumer";case G:var a=t.render;return t=t.displayName,t||(t=a.displayName||a.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case I:return a=t.displayName||null,a!==null?a:xe(t.type)||"Memo";case A:a=t._payload,t=t._init;try{return xe(t(a))}catch{}}return null}var ge=Array.isArray,F=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},X=[],Q=-1;function T(t){return{current:t}}function z(t){0>Q||(t.current=X[Q],X[Q]=null,Q--)}function $(t,a){Q++,X[Q]=t.current,t.current=a}var J=T(null),pe=T(null),de=T(null),_e=T(null);function W(t,a){switch($(de,a),$(pe,t),$(J,null),a.nodeType){case 9:case 11:t=(t=a.documentElement)&&(t=t.namespaceURI)?wb(t):0;break;default:if(t=a.tagName,a=a.namespaceURI)a=wb(a),t=Sb(a,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}z(J),$(J,t)}function le(){z(J),z(pe),z(de)}function ie(t){t.memoizedState!==null&&$(_e,t);var a=J.current,i=Sb(a,t.type);a!==i&&($(pe,t),$(J,i))}function he(t){pe.current===t&&(z(J),z(pe)),_e.current===t&&(z(_e),Sc._currentValue=ae)}var Ie,Ue;function je(t){if(Ie===void 0)try{throw Error()}catch(i){var a=i.stack.trim().match(/\n( *(at )?)/);Ie=a&&a[1]||"",Ue=-1<i.stack.indexOf(`
    at`)?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ie+t+Ue}var wt=!1;function Re(t,a){if(!t||wt)return"";wt=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(a){var be=function(){throw Error()};if(Object.defineProperty(be.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(be,[])}catch(fe){var re=fe}Reflect.construct(t,[],be)}else{try{be.call()}catch(fe){re=fe}t.call(be.prototype)}}else{try{throw Error()}catch(fe){re=fe}(be=t())&&typeof be.catch=="function"&&be.catch(function(){})}}catch(fe){if(fe&&re&&typeof fe.stack=="string")return[fe.stack,re.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var h=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");h&&h.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=c.DetermineComponentFrameRoot(),E=g[0],k=g[1];if(E&&k){var q=E.split(`
`),se=k.split(`
`);for(h=c=0;c<q.length&&!q[c].includes("DetermineComponentFrameRoot");)c++;for(;h<se.length&&!se[h].includes("DetermineComponentFrameRoot");)h++;if(c===q.length||h===se.length)for(c=q.length-1,h=se.length-1;1<=c&&0<=h&&q[c]!==se[h];)h--;for(;1<=c&&0<=h;c--,h--)if(q[c]!==se[h]){if(c!==1||h!==1)do if(c--,h--,0>h||q[c]!==se[h]){var me=`
`+q[c].replace(" at new "," at ");return t.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",t.displayName)),me}while(1<=c&&0<=h);break}}}finally{wt=!1,Error.prepareStackTrace=i}return(i=t?t.displayName||t.name:"")?je(i):""}function we(t,a){switch(t.tag){case 26:case 27:case 5:return je(t.type);case 16:return je("Lazy");case 13:return t.child!==a&&a!==null?je("Suspense Fallback"):je("Suspense");case 19:return je("SuspenseList");case 0:case 15:return Re(t.type,!1);case 11:return Re(t.type.render,!1);case 1:return Re(t.type,!0);case 31:return je("Activity");default:return""}}function rt(t){try{var a="",i=null;do a+=we(t,i),i=t,t=t.return;while(t);return a}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Qe=Object.prototype.hasOwnProperty,oe=n.unstable_scheduleCallback,ze=n.unstable_cancelCallback,et=n.unstable_shouldYield,vt=n.unstable_requestPaint,Ye=n.unstable_now,We=n.unstable_getCurrentPriorityLevel,it=n.unstable_ImmediatePriority,St=n.unstable_UserBlockingPriority,Ut=n.unstable_NormalPriority,es=n.unstable_LowPriority,Us=n.unstable_IdlePriority,ts=n.log,Es=n.unstable_setDisableYieldValue,ve=null,Oe=null;function Ae(t){if(typeof ts=="function"&&Es(t),Oe&&typeof Oe.setStrictMode=="function")try{Oe.setStrictMode(ve,t)}catch{}}var Be=Math.clz32?Math.clz32:dt,xt=Math.log,Ke=Math.LN2;function dt(t){return t>>>=0,t===0?32:31-(xt(t)/Ke|0)|0}var ft=256,zt=262144,Tt=4194304;function Bt(t){var a=t&42;if(a!==0)return a;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function on(t,a,i){var c=t.pendingLanes;if(c===0)return 0;var h=0,g=t.suspendedLanes,E=t.pingedLanes;t=t.warmLanes;var k=c&134217727;return k!==0?(c=k&~g,c!==0?h=Bt(c):(E&=k,E!==0?h=Bt(E):i||(i=k&~t,i!==0&&(h=Bt(i))))):(k=c&~g,k!==0?h=Bt(k):E!==0?h=Bt(E):i||(i=c&~t,i!==0&&(h=Bt(i)))),h===0?0:a!==0&&a!==h&&(a&g)===0&&(g=h&-h,i=a&-a,g>=i||g===32&&(i&4194048)!==0)?a:h}function Sn(t,a){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&a)===0}function oa(t,a){switch(t){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jn(){var t=Tt;return Tt<<=1,(Tt&62914560)===0&&(Tt=4194304),t}function kn(t){for(var a=[],i=0;31>i;i++)a.push(t);return a}function Ps(t,a){t.pendingLanes|=a,a!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function la(t,a,i,c,h,g){var E=t.pendingLanes;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=i,t.entangledLanes&=i,t.errorRecoveryDisabledLanes&=i,t.shellSuspendCounter=0;var k=t.entanglements,q=t.expirationTimes,se=t.hiddenUpdates;for(i=E&~i;0<i;){var me=31-Be(i),be=1<<me;k[me]=0,q[me]=-1;var re=se[me];if(re!==null)for(se[me]=null,me=0;me<re.length;me++){var fe=re[me];fe!==null&&(fe.lane&=-536870913)}i&=~be}c!==0&&ca(t,c,0),g!==0&&h===0&&t.tag!==0&&(t.suspendedLanes|=g&~(E&~a))}function ca(t,a,i){t.pendingLanes|=a,t.suspendedLanes&=~a;var c=31-Be(a);t.entangledLanes|=a,t.entanglements[c]=t.entanglements[c]|1073741824|i&261930}function Tr(t,a){var i=t.entangledLanes|=a;for(t=t.entanglements;i;){var c=31-Be(i),h=1<<c;h&a|t[c]&a&&(t[c]|=a),i&=~h}}function Ar(t,a){var i=a&-a;return i=(i&42)!==0?1:Oa(i),(i&(t.suspendedLanes|a))!==0?0:i}function Oa(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function Vs(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function xo(){var t=ue.p;return t!==0?t:(t=window.event,t===void 0?32:Yb(t.type))}function ws(t,a){var i=ue.p;try{return ue.p=t,a()}finally{ue.p=i}}var Ss=Math.random().toString(36).slice(2),en="__reactFiber$"+Ss,mn="__reactProps$"+Ss,zs="__reactContainer$"+Ss,Ir="__reactEvents$"+Ss,Ul="__reactListeners$"+Ss,bo="__reactHandles$"+Ss,vo="__reactResources$"+Ss,Bs="__reactMarker$"+Ss;function Nr(t){delete t[en],delete t[mn],delete t[Ir],delete t[Ul],delete t[bo]}function Ts(t){var a=t[en];if(a)return a;for(var i=t.parentNode;i;){if(a=i[zs]||i[en]){if(i=a.alternate,a.child!==null||i!==null&&i.child!==null)for(t=Ob(t);t!==null;){if(i=t[en])return i;t=Ob(t)}return a}t=i,i=t.parentNode}return null}function fs(t){if(t=t[en]||t[zs]){var a=t.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return t}return null}function ns(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t.stateNode;throw Error(r(33))}function Fs(t){var a=t[vo];return a||(a=t[vo]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function tn(t){t[Bs]=!0}var vi=new Set,_i={};function Hs(t,a){Gs(t,a),Gs(t+"Capture",a)}function Gs(t,a){for(_i[t]=a,t=0;t<a.length;t++)vi.add(a[t])}var Ei=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ja={},wi={};function Si(t){return Qe.call(wi,t)?!0:Qe.call(ja,t)?!1:Ei.test(t)?wi[t]=!0:(ja[t]=!0,!1)}function Xa(t,a,i){if(Si(a))if(i===null)t.removeAttribute(a);else{switch(typeof i){case"undefined":case"function":case"symbol":t.removeAttribute(a);return;case"boolean":var c=a.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){t.removeAttribute(a);return}}t.setAttribute(a,""+i)}}function hs(t,a,i){if(i===null)t.removeAttribute(a);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(a);return}t.setAttribute(a,""+i)}}function ln(t,a,i,c){if(c===null)t.removeAttribute(i);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(i);return}t.setAttributeNS(a,i,""+c)}}function Tn(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ja(t){var a=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function _o(t,a,i){var c=Object.getOwnPropertyDescriptor(t.constructor.prototype,a);if(!t.hasOwnProperty(a)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var h=c.get,g=c.set;return Object.defineProperty(t,a,{configurable:!0,get:function(){return h.call(this)},set:function(E){i=""+E,g.call(this,E)}}),Object.defineProperty(t,a,{enumerable:c.enumerable}),{getValue:function(){return i},setValue:function(E){i=""+E},stopTracking:function(){t._valueTracker=null,delete t[a]}}}}function Te(t){if(!t._valueTracker){var a=Ja(t)?"checked":"value";t._valueTracker=_o(t,a,""+t[a])}}function $e(t){if(!t)return!1;var a=t._valueTracker;if(!a)return!0;var i=a.getValue(),c="";return t&&(c=Ja(t)?t.checked?"true":"false":t.value),t=c,t!==i?(a.setValue(t),!0):!1}function He(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var Pe=/[\n"\\]/g;function Ze(t){return t.replace(Pe,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function At(t,a,i,c,h,g,E,k){t.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?t.type=E:t.removeAttribute("type"),a!=null?E==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+Tn(a)):t.value!==""+Tn(a)&&(t.value=""+Tn(a)):E!=="submit"&&E!=="reset"||t.removeAttribute("value"),a!=null?nn(t,E,Tn(a)):i!=null?nn(t,E,Tn(i)):c!=null&&t.removeAttribute("value"),h==null&&g!=null&&(t.defaultChecked=!!g),h!=null&&(t.checked=h&&typeof h!="function"&&typeof h!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?t.name=""+Tn(k):t.removeAttribute("name")}function Yn(t,a,i,c,h,g,E,k){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(t.type=g),a!=null||i!=null){if(!(g!=="submit"&&g!=="reset"||a!=null)){Te(t);return}i=i!=null?""+Tn(i):"",a=a!=null?""+Tn(a):i,k||a===t.value||(t.value=a),t.defaultValue=a}c=c??h,c=typeof c!="function"&&typeof c!="symbol"&&!!c,t.checked=k?t.checked:!!c,t.defaultChecked=!!c,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(t.name=E),Te(t)}function nn(t,a,i){a==="number"&&He(t.ownerDocument)===t||t.defaultValue===""+i||(t.defaultValue=""+i)}function gn(t,a,i,c){if(t=t.options,a){a={};for(var h=0;h<i.length;h++)a["$"+i[h]]=!0;for(i=0;i<t.length;i++)h=a.hasOwnProperty("$"+t[i].value),t[i].selected!==h&&(t[i].selected=h),h&&c&&(t[i].defaultSelected=!0)}else{for(i=""+Tn(i),a=null,h=0;h<t.length;h++){if(t[h].value===i){t[h].selected=!0,c&&(t[h].defaultSelected=!0);return}a!==null||t[h].disabled||(a=t[h])}a!==null&&(a.selected=!0)}}function ua(t,a,i){if(a!=null&&(a=""+Tn(a),a!==t.value&&(t.value=a),i==null)){t.defaultValue!==a&&(t.defaultValue=a);return}t.defaultValue=i!=null?""+Tn(i):""}function ss(t,a,i,c){if(a==null){if(c!=null){if(i!=null)throw Error(r(92));if(ge(c)){if(1<c.length)throw Error(r(93));c=c[0]}i=c}i==null&&(i=""),a=i}i=Tn(a),t.defaultValue=i,c=t.textContent,c===i&&c!==""&&c!==null&&(t.value=c),Te(t)}function Ln(t,a){if(a){var i=t.firstChild;if(i&&i===t.lastChild&&i.nodeType===3){i.nodeValue=a;return}}t.textContent=a}var _u=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Pl(t,a,i){var c=a.indexOf("--")===0;i==null||typeof i=="boolean"||i===""?c?t.setProperty(a,""):a==="float"?t.cssFloat="":t[a]="":c?t.setProperty(a,i):typeof i!="number"||i===0||_u.has(a)?a==="float"?t.cssFloat=i:t[a]=(""+i).trim():t[a]=i+"px"}function Vl(t,a,i){if(a!=null&&typeof a!="object")throw Error(r(62));if(t=t.style,i!=null){for(var c in i)!i.hasOwnProperty(c)||a!=null&&a.hasOwnProperty(c)||(c.indexOf("--")===0?t.setProperty(c,""):c==="float"?t.cssFloat="":t[c]="");for(var h in a)c=a[h],a.hasOwnProperty(h)&&i[h]!==c&&Pl(t,h,c)}else for(var g in a)a.hasOwnProperty(g)&&Pl(t,g,a[g])}function Eo(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Eu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Cr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function wo(t){return Cr.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function da(){}var zl=null;function qs(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Rr=null,ka=null;function Ti(t){var a=fs(t);if(a&&(t=a.stateNode)){var i=t[mn]||null;e:switch(t=a.stateNode,a.type){case"input":if(At(t,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),a=i.name,i.type==="radio"&&a!=null){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+Ze(""+a)+'"][type="radio"]'),a=0;a<i.length;a++){var c=i[a];if(c!==t&&c.form===t.form){var h=c[mn]||null;if(!h)throw Error(r(90));At(c,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name)}}for(a=0;a<i.length;a++)c=i[a],c.form===t.form&&$e(c)}break e;case"textarea":ua(t,i.value,i.defaultValue);break e;case"select":a=i.value,a!=null&&gn(t,!!i.multiple,a,!1)}}}var So=!1;function Or(t,a,i){if(So)return t(a,i);So=!0;try{var c=t(a);return c}finally{if(So=!1,(Rr!==null||ka!==null)&&(md(),Rr&&(a=Rr,t=ka,ka=Rr=null,Ti(a),t)))for(a=0;a<t.length;a++)Ti(t[a])}}function fa(t,a){var i=t.stateNode;if(i===null)return null;var c=i[mn]||null;if(c===null)return null;i=c[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(t=t.type,c=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!c;break e;default:t=!1}if(t)return null;if(i&&typeof i!="function")throw Error(r(231,a,typeof i));return i}var $s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ai=!1;if($s)try{var jt={};Object.defineProperty(jt,"passive",{get:function(){Ai=!0}}),window.addEventListener("test",jt,jt),window.removeEventListener("test",jt,jt)}catch{Ai=!1}var La=null,Bl=null,Ii=null;function Fl(){if(Ii)return Ii;var t,a=Bl,i=a.length,c,h="value"in La?La.value:La.textContent,g=h.length;for(t=0;t<i&&a[t]===h[t];t++);var E=i-t;for(c=1;c<=E&&a[i-c]===h[g-c];c++);return Ii=h.slice(t,1<c?1-c:void 0)}function Ni(t){var a=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&a===13&&(t=13)):t=a,t===10&&(t=13),32<=t||t===13?t:0}function er(){return!0}function ha(){return!1}function Vn(t){function a(i,c,h,g,E){this._reactName=i,this._targetInst=h,this.type=c,this.nativeEvent=g,this.target=E,this.currentTarget=null;for(var k in t)t.hasOwnProperty(k)&&(i=t[k],this[k]=i?i(g):g[k]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?er:ha,this.isPropagationStopped=ha,this}return v(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=er)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=er)},persist:function(){},isPersistent:er}),a}var tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ma=Vn(tr),jr=v({},tr,{view:0,detail:0}),Hl=Vn(jr),kr,To,Da,Ao=v({},jr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Lr,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Da&&(Da&&t.type==="mousemove"?(kr=t.screenX-Da.screenX,To=t.screenY-Da.screenY):To=kr=0,Da=t),kr)},movementY:function(t){return"movementY"in t?t.movementY:To}}),Gl=Vn(Ao),Ci=v({},Ao,{dataTransfer:0}),wu=Vn(Ci),Su=v({},jr,{relatedTarget:0}),Ri=Vn(Su),ql=v({},tr,{animationName:0,elapsedTime:0,pseudoElement:0}),Tu=Vn(ql),Io=v({},tr,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Au=Vn(Io),Iu=v({},tr,{data:0}),Ua=Vn(Iu),Nu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ru={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ou(t){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(t):(t=Ru[t])?!!a[t]:!1}function Lr(){return Ou}var as=v({},jr,{key:function(t){if(t.key){var a=Nu[t.key]||t.key;if(a!=="Unidentified")return a}return t.type==="keypress"?(t=Ni(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Cu[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Lr,charCode:function(t){return t.type==="keypress"?Ni(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ni(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ju=Vn(as),ku=v({},Ao,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nr=Vn(ku),f=v({},jr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Lr}),b=Vn(f),w=v({},tr,{propertyName:0,elapsedTime:0,pseudoElement:0}),U=Vn(w),te=v({},Ao,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),ce=Vn(te),Ne=v({},tr,{newState:0,oldState:0}),nt=Vn(Ne),cn=[9,13,27,32],It=$s&&"CompositionEvent"in window,qt=null;$s&&"documentMode"in document&&(qt=document.documentMode);var Ys=$s&&"TextEvent"in window&&!qt,Pa=$s&&(!It||qt&&8<qt&&11>=qt),pa=" ",ma=!1;function Oi(t,a){switch(t){case"keyup":return cn.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function No(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Co=!1;function JT(t,a){switch(t){case"compositionend":return No(a);case"keypress":return a.which!==32?null:(ma=!0,pa);case"textInput":return t=a.data,t===pa&&ma?null:t;default:return null}}function eA(t,a){if(Co)return t==="compositionend"||!It&&Oi(t,a)?(t=Fl(),Ii=Bl=La=null,Co=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Pa&&a.locale!=="ko"?null:a.data;default:return null}}var tA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function L0(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a==="input"?!!tA[t.type]:a==="textarea"}function M0(t,a,i,c){Rr?ka?ka.push(c):ka=[c]:Rr=c,a=Ed(a,"onChange"),0<a.length&&(i=new Ma("onChange","change",null,i,c),t.push({event:i,listeners:a}))}var $l=null,Yl=null;function nA(t){yb(t,0)}function Lu(t){var a=ns(t);if($e(a))return t}function D0(t,a){if(t==="change")return a}var U0=!1;if($s){var Wf;if($s){var Kf="oninput"in document;if(!Kf){var P0=document.createElement("div");P0.setAttribute("oninput","return;"),Kf=typeof P0.oninput=="function"}Wf=Kf}else Wf=!1;U0=Wf&&(!document.documentMode||9<document.documentMode)}function V0(){$l&&($l.detachEvent("onpropertychange",z0),Yl=$l=null)}function z0(t){if(t.propertyName==="value"&&Lu(Yl)){var a=[];M0(a,Yl,t,qs(t)),Or(nA,a)}}function sA(t,a,i){t==="focusin"?(V0(),$l=a,Yl=i,$l.attachEvent("onpropertychange",z0)):t==="focusout"&&V0()}function aA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Lu(Yl)}function rA(t,a){if(t==="click")return Lu(a)}function iA(t,a){if(t==="input"||t==="change")return Lu(a)}function oA(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var As=typeof Object.is=="function"?Object.is:oA;function Ql(t,a){if(As(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var i=Object.keys(t),c=Object.keys(a);if(i.length!==c.length)return!1;for(c=0;c<i.length;c++){var h=i[c];if(!Qe.call(a,h)||!As(t[h],a[h]))return!1}return!0}function B0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function F0(t,a){var i=B0(t);t=0;for(var c;i;){if(i.nodeType===3){if(c=t+i.textContent.length,t<=a&&c>=a)return{node:i,offset:a-t};t=c}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=B0(i)}}function H0(t,a){return t&&a?t===a?!0:t&&t.nodeType===3?!1:a&&a.nodeType===3?H0(t,a.parentNode):"contains"in t?t.contains(a):t.compareDocumentPosition?!!(t.compareDocumentPosition(a)&16):!1:!1}function G0(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var a=He(t.document);a instanceof t.HTMLIFrameElement;){try{var i=typeof a.contentWindow.location.href=="string"}catch{i=!1}if(i)t=a.contentWindow;else break;a=He(t.document)}return a}function Zf(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a&&(a==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||a==="textarea"||t.contentEditable==="true")}var lA=$s&&"documentMode"in document&&11>=document.documentMode,Ro=null,Xf=null,Wl=null,Jf=!1;function q0(t,a,i){var c=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;Jf||Ro==null||Ro!==He(c)||(c=Ro,"selectionStart"in c&&Zf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Wl&&Ql(Wl,c)||(Wl=c,c=Ed(Xf,"onSelect"),0<c.length&&(a=new Ma("onSelect","select",null,a,i),t.push({event:a,listeners:c}),a.target=Ro)))}function ji(t,a){var i={};return i[t.toLowerCase()]=a.toLowerCase(),i["Webkit"+t]="webkit"+a,i["Moz"+t]="moz"+a,i}var Oo={animationend:ji("Animation","AnimationEnd"),animationiteration:ji("Animation","AnimationIteration"),animationstart:ji("Animation","AnimationStart"),transitionrun:ji("Transition","TransitionRun"),transitionstart:ji("Transition","TransitionStart"),transitioncancel:ji("Transition","TransitionCancel"),transitionend:ji("Transition","TransitionEnd")},eh={},$0={};$s&&($0=document.createElement("div").style,"AnimationEvent"in window||(delete Oo.animationend.animation,delete Oo.animationiteration.animation,delete Oo.animationstart.animation),"TransitionEvent"in window||delete Oo.transitionend.transition);function ki(t){if(eh[t])return eh[t];if(!Oo[t])return t;var a=Oo[t],i;for(i in a)if(a.hasOwnProperty(i)&&i in $0)return eh[t]=a[i];return t}var Y0=ki("animationend"),Q0=ki("animationiteration"),W0=ki("animationstart"),cA=ki("transitionrun"),uA=ki("transitionstart"),dA=ki("transitioncancel"),K0=ki("transitionend"),Z0=new Map,th="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");th.push("scrollEnd");function ga(t,a){Z0.set(t,a),Hs(a,[t])}var Mu=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},Qs=[],jo=0,nh=0;function Du(){for(var t=jo,a=nh=jo=0;a<t;){var i=Qs[a];Qs[a++]=null;var c=Qs[a];Qs[a++]=null;var h=Qs[a];Qs[a++]=null;var g=Qs[a];if(Qs[a++]=null,c!==null&&h!==null){var E=c.pending;E===null?h.next=h:(h.next=E.next,E.next=h),c.pending=h}g!==0&&X0(i,h,g)}}function Uu(t,a,i,c){Qs[jo++]=t,Qs[jo++]=a,Qs[jo++]=i,Qs[jo++]=c,nh|=c,t.lanes|=c,t=t.alternate,t!==null&&(t.lanes|=c)}function sh(t,a,i,c){return Uu(t,a,i,c),Pu(t)}function Li(t,a){return Uu(t,null,null,a),Pu(t)}function X0(t,a,i){t.lanes|=i;var c=t.alternate;c!==null&&(c.lanes|=i);for(var h=!1,g=t.return;g!==null;)g.childLanes|=i,c=g.alternate,c!==null&&(c.childLanes|=i),g.tag===22&&(t=g.stateNode,t===null||t._visibility&1||(h=!0)),t=g,g=g.return;return t.tag===3?(g=t.stateNode,h&&a!==null&&(h=31-Be(i),t=g.hiddenUpdates,c=t[h],c===null?t[h]=[a]:c.push(a),a.lane=i|536870912),g):null}function Pu(t){if(50<yc)throw yc=0,fp=null,Error(r(185));for(var a=t.return;a!==null;)t=a,a=t.return;return t.tag===3?t.stateNode:null}var ko={};function fA(t,a,i,c){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Is(t,a,i,c){return new fA(t,a,i,c)}function ah(t){return t=t.prototype,!(!t||!t.isReactComponent)}function sr(t,a){var i=t.alternate;return i===null?(i=Is(t.tag,a,t.key,t.mode),i.elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=a,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=t.flags&65011712,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,a=t.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i.refCleanup=t.refCleanup,i}function J0(t,a){t.flags&=65011714;var i=t.alternate;return i===null?(t.childLanes=0,t.lanes=a,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,t.type=i.type,a=i.dependencies,t.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),t}function Vu(t,a,i,c,h,g){var E=0;if(c=t,typeof t=="function")ah(t)&&(E=1);else if(typeof t=="string")E=y2(t,i,J.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case _:return t=Is(31,i,a,h),t.elementType=_,t.lanes=g,t;case M:return Mi(i.children,h,g,a);case j:E=8,h|=24;break;case V:return t=Is(12,i,a,h|2),t.elementType=V,t.lanes=g,t;case Y:return t=Is(13,i,a,h),t.elementType=Y,t.lanes=g,t;case K:return t=Is(19,i,a,h),t.elementType=K,t.lanes=g,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case H:E=10;break e;case B:E=9;break e;case G:E=11;break e;case I:E=14;break e;case A:E=16,c=null;break e}E=29,i=Error(r(130,t===null?"null":typeof t,"")),c=null}return a=Is(E,i,a,h),a.elementType=t,a.type=c,a.lanes=g,a}function Mi(t,a,i,c){return t=Is(7,t,c,a),t.lanes=i,t}function rh(t,a,i){return t=Is(6,t,null,a),t.lanes=i,t}function ey(t){var a=Is(18,null,null,0);return a.stateNode=t,a}function ih(t,a,i){return a=Is(4,t.children!==null?t.children:[],t.key,a),a.lanes=i,a.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},a}var ty=new WeakMap;function Ws(t,a){if(typeof t=="object"&&t!==null){var i=ty.get(t);return i!==void 0?i:(a={value:t,source:a,stack:rt(a)},ty.set(t,a),a)}return{value:t,source:a,stack:rt(a)}}var Lo=[],Mo=0,zu=null,Kl=0,Ks=[],Zs=0,Mr=null,Va=1,za="";function ar(t,a){Lo[Mo++]=Kl,Lo[Mo++]=zu,zu=t,Kl=a}function ny(t,a,i){Ks[Zs++]=Va,Ks[Zs++]=za,Ks[Zs++]=Mr,Mr=t;var c=Va;t=za;var h=32-Be(c)-1;c&=~(1<<h),i+=1;var g=32-Be(a)+h;if(30<g){var E=h-h%5;g=(c&(1<<E)-1).toString(32),c>>=E,h-=E,Va=1<<32-Be(a)+h|i<<h|c,za=g+t}else Va=1<<g|i<<h|c,za=t}function oh(t){t.return!==null&&(ar(t,1),ny(t,1,0))}function lh(t){for(;t===zu;)zu=Lo[--Mo],Lo[Mo]=null,Kl=Lo[--Mo],Lo[Mo]=null;for(;t===Mr;)Mr=Ks[--Zs],Ks[Zs]=null,za=Ks[--Zs],Ks[Zs]=null,Va=Ks[--Zs],Ks[Zs]=null}function sy(t,a){Ks[Zs++]=Va,Ks[Zs++]=za,Ks[Zs++]=Mr,Va=a.id,za=a.overflow,Mr=t}var zn=null,Ft=null,ht=!1,Dr=null,Xs=!1,ch=Error(r(519));function Ur(t){var a=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Zl(Ws(a,t)),ch}function ay(t){var a=t.stateNode,i=t.type,c=t.memoizedProps;switch(a[en]=t,a[mn]=c,i){case"dialog":lt("cancel",a),lt("close",a);break;case"iframe":case"object":case"embed":lt("load",a);break;case"video":case"audio":for(i=0;i<bc.length;i++)lt(bc[i],a);break;case"source":lt("error",a);break;case"img":case"image":case"link":lt("error",a),lt("load",a);break;case"details":lt("toggle",a);break;case"input":lt("invalid",a),Yn(a,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":lt("invalid",a);break;case"textarea":lt("invalid",a),ss(a,c.value,c.defaultValue,c.children)}i=c.children,typeof i!="string"&&typeof i!="number"&&typeof i!="bigint"||a.textContent===""+i||c.suppressHydrationWarning===!0||_b(a.textContent,i)?(c.popover!=null&&(lt("beforetoggle",a),lt("toggle",a)),c.onScroll!=null&&lt("scroll",a),c.onScrollEnd!=null&&lt("scrollend",a),c.onClick!=null&&(a.onclick=da),a=!0):a=!1,a||Ur(t,!0)}function ry(t){for(zn=t.return;zn;)switch(zn.tag){case 5:case 31:case 13:Xs=!1;return;case 27:case 3:Xs=!0;return;default:zn=zn.return}}function Do(t){if(t!==zn)return!1;if(!ht)return ry(t),ht=!0,!1;var a=t.tag,i;if((i=a!==3&&a!==27)&&((i=a===5)&&(i=t.type,i=!(i!=="form"&&i!=="button")||Ip(t.type,t.memoizedProps)),i=!i),i&&Ft&&Ur(t),ry(t),a===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(317));Ft=Rb(t)}else if(a===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(317));Ft=Rb(t)}else a===27?(a=Ft,Zr(t.type)?(t=jp,jp=null,Ft=t):Ft=a):Ft=zn?ea(t.stateNode.nextSibling):null;return!0}function Di(){Ft=zn=null,ht=!1}function uh(){var t=Dr;return t!==null&&(ys===null?ys=t:ys.push.apply(ys,t),Dr=null),t}function Zl(t){Dr===null?Dr=[t]:Dr.push(t)}var dh=T(null),Ui=null,rr=null;function Pr(t,a,i){$(dh,a._currentValue),a._currentValue=i}function ir(t){t._currentValue=dh.current,z(dh)}function fh(t,a,i){for(;t!==null;){var c=t.alternate;if((t.childLanes&a)!==a?(t.childLanes|=a,c!==null&&(c.childLanes|=a)):c!==null&&(c.childLanes&a)!==a&&(c.childLanes|=a),t===i)break;t=t.return}}function hh(t,a,i,c){var h=t.child;for(h!==null&&(h.return=t);h!==null;){var g=h.dependencies;if(g!==null){var E=h.child;g=g.firstContext;e:for(;g!==null;){var k=g;g=h;for(var q=0;q<a.length;q++)if(k.context===a[q]){g.lanes|=i,k=g.alternate,k!==null&&(k.lanes|=i),fh(g.return,i,t),c||(E=null);break e}g=k.next}}else if(h.tag===18){if(E=h.return,E===null)throw Error(r(341));E.lanes|=i,g=E.alternate,g!==null&&(g.lanes|=i),fh(E,i,t),E=null}else E=h.child;if(E!==null)E.return=h;else for(E=h;E!==null;){if(E===t){E=null;break}if(h=E.sibling,h!==null){h.return=E.return,E=h;break}E=E.return}h=E}}function Uo(t,a,i,c){t=null;for(var h=a,g=!1;h!==null;){if(!g){if((h.flags&524288)!==0)g=!0;else if((h.flags&262144)!==0)break}if(h.tag===10){var E=h.alternate;if(E===null)throw Error(r(387));if(E=E.memoizedProps,E!==null){var k=h.type;As(h.pendingProps.value,E.value)||(t!==null?t.push(k):t=[k])}}else if(h===_e.current){if(E=h.alternate,E===null)throw Error(r(387));E.memoizedState.memoizedState!==h.memoizedState.memoizedState&&(t!==null?t.push(Sc):t=[Sc])}h=h.return}t!==null&&hh(a,t,i,c),a.flags|=262144}function Bu(t){for(t=t.firstContext;t!==null;){if(!As(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Pi(t){Ui=t,rr=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function Bn(t){return iy(Ui,t)}function Fu(t,a){return Ui===null&&Pi(t),iy(t,a)}function iy(t,a){var i=a._currentValue;if(a={context:a,memoizedValue:i,next:null},rr===null){if(t===null)throw Error(r(308));rr=a,t.dependencies={lanes:0,firstContext:a},t.flags|=524288}else rr=rr.next=a;return i}var hA=typeof AbortController<"u"?AbortController:function(){var t=[],a=this.signal={aborted:!1,addEventListener:function(i,c){t.push(c)}};this.abort=function(){a.aborted=!0,t.forEach(function(i){return i()})}},pA=n.unstable_scheduleCallback,mA=n.unstable_NormalPriority,yn={$$typeof:H,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ph(){return{controller:new hA,data:new Map,refCount:0}}function Xl(t){t.refCount--,t.refCount===0&&pA(mA,function(){t.controller.abort()})}var Jl=null,mh=0,Po=0,Vo=null;function gA(t,a){if(Jl===null){var i=Jl=[];mh=0,Po=xp(),Vo={status:"pending",value:void 0,then:function(c){i.push(c)}}}return mh++,a.then(oy,oy),a}function oy(){if(--mh===0&&Jl!==null){Vo!==null&&(Vo.status="fulfilled");var t=Jl;Jl=null,Po=0,Vo=null;for(var a=0;a<t.length;a++)(0,t[a])()}}function yA(t,a){var i=[],c={status:"pending",value:null,reason:null,then:function(h){i.push(h)}};return t.then(function(){c.status="fulfilled",c.value=a;for(var h=0;h<i.length;h++)(0,i[h])(a)},function(h){for(c.status="rejected",c.reason=h,h=0;h<i.length;h++)(0,i[h])(void 0)}),c}var ly=F.S;F.S=function(t,a){qx=Ye(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&gA(t,a),ly!==null&&ly(t,a)};var Vi=T(null);function gh(){var t=Vi.current;return t!==null?t:Pt.pooledCache}function Hu(t,a){a===null?$(Vi,Vi.current):$(Vi,a.pool)}function cy(){var t=gh();return t===null?null:{parent:yn._currentValue,pool:t}}var zo=Error(r(460)),yh=Error(r(474)),Gu=Error(r(542)),qu={then:function(){}};function uy(t){return t=t.status,t==="fulfilled"||t==="rejected"}function dy(t,a,i){switch(i=t[i],i===void 0?t.push(a):i!==a&&(a.then(da,da),a=i),a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,hy(t),t;default:if(typeof a.status=="string")a.then(da,da);else{if(t=Pt,t!==null&&100<t.shellSuspendCounter)throw Error(r(482));t=a,t.status="pending",t.then(function(c){if(a.status==="pending"){var h=a;h.status="fulfilled",h.value=c}},function(c){if(a.status==="pending"){var h=a;h.status="rejected",h.reason=c}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,hy(t),t}throw Bi=a,zo}}function zi(t){try{var a=t._init;return a(t._payload)}catch(i){throw i!==null&&typeof i=="object"&&typeof i.then=="function"?(Bi=i,zo):i}}var Bi=null;function fy(){if(Bi===null)throw Error(r(459));var t=Bi;return Bi=null,t}function hy(t){if(t===zo||t===Gu)throw Error(r(483))}var Bo=null,ec=0;function $u(t){var a=ec;return ec+=1,Bo===null&&(Bo=[]),dy(Bo,t,a)}function tc(t,a){a=a.props.ref,t.ref=a!==void 0?a:null}function Yu(t,a){throw a.$$typeof===S?Error(r(525)):(t=Object.prototype.toString.call(a),Error(r(31,t==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":t)))}function py(t){function a(ee,Z){if(t){var ne=ee.deletions;ne===null?(ee.deletions=[Z],ee.flags|=16):ne.push(Z)}}function i(ee,Z){if(!t)return null;for(;Z!==null;)a(ee,Z),Z=Z.sibling;return null}function c(ee){for(var Z=new Map;ee!==null;)ee.key!==null?Z.set(ee.key,ee):Z.set(ee.index,ee),ee=ee.sibling;return Z}function h(ee,Z){return ee=sr(ee,Z),ee.index=0,ee.sibling=null,ee}function g(ee,Z,ne){return ee.index=ne,t?(ne=ee.alternate,ne!==null?(ne=ne.index,ne<Z?(ee.flags|=67108866,Z):ne):(ee.flags|=67108866,Z)):(ee.flags|=1048576,Z)}function E(ee){return t&&ee.alternate===null&&(ee.flags|=67108866),ee}function k(ee,Z,ne,ye){return Z===null||Z.tag!==6?(Z=rh(ne,ee.mode,ye),Z.return=ee,Z):(Z=h(Z,ne),Z.return=ee,Z)}function q(ee,Z,ne,ye){var Fe=ne.type;return Fe===M?me(ee,Z,ne.props.children,ye,ne.key):Z!==null&&(Z.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===A&&zi(Fe)===Z.type)?(Z=h(Z,ne.props),tc(Z,ne),Z.return=ee,Z):(Z=Vu(ne.type,ne.key,ne.props,null,ee.mode,ye),tc(Z,ne),Z.return=ee,Z)}function se(ee,Z,ne,ye){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==ne.containerInfo||Z.stateNode.implementation!==ne.implementation?(Z=ih(ne,ee.mode,ye),Z.return=ee,Z):(Z=h(Z,ne.children||[]),Z.return=ee,Z)}function me(ee,Z,ne,ye,Fe){return Z===null||Z.tag!==7?(Z=Mi(ne,ee.mode,ye,Fe),Z.return=ee,Z):(Z=h(Z,ne),Z.return=ee,Z)}function be(ee,Z,ne){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return Z=rh(""+Z,ee.mode,ne),Z.return=ee,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case N:return ne=Vu(Z.type,Z.key,Z.props,null,ee.mode,ne),tc(ne,Z),ne.return=ee,ne;case P:return Z=ih(Z,ee.mode,ne),Z.return=ee,Z;case A:return Z=zi(Z),be(ee,Z,ne)}if(ge(Z)||L(Z))return Z=Mi(Z,ee.mode,ne,null),Z.return=ee,Z;if(typeof Z.then=="function")return be(ee,$u(Z),ne);if(Z.$$typeof===H)return be(ee,Fu(ee,Z),ne);Yu(ee,Z)}return null}function re(ee,Z,ne,ye){var Fe=Z!==null?Z.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return Fe!==null?null:k(ee,Z,""+ne,ye);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case N:return ne.key===Fe?q(ee,Z,ne,ye):null;case P:return ne.key===Fe?se(ee,Z,ne,ye):null;case A:return ne=zi(ne),re(ee,Z,ne,ye)}if(ge(ne)||L(ne))return Fe!==null?null:me(ee,Z,ne,ye,null);if(typeof ne.then=="function")return re(ee,Z,$u(ne),ye);if(ne.$$typeof===H)return re(ee,Z,Fu(ee,ne),ye);Yu(ee,ne)}return null}function fe(ee,Z,ne,ye,Fe){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ee=ee.get(ne)||null,k(Z,ee,""+ye,Fe);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case N:return ee=ee.get(ye.key===null?ne:ye.key)||null,q(Z,ee,ye,Fe);case P:return ee=ee.get(ye.key===null?ne:ye.key)||null,se(Z,ee,ye,Fe);case A:return ye=zi(ye),fe(ee,Z,ne,ye,Fe)}if(ge(ye)||L(ye))return ee=ee.get(ne)||null,me(Z,ee,ye,Fe,null);if(typeof ye.then=="function")return fe(ee,Z,ne,$u(ye),Fe);if(ye.$$typeof===H)return fe(ee,Z,ne,Fu(Z,ye),Fe);Yu(Z,ye)}return null}function Le(ee,Z,ne,ye){for(var Fe=null,_t=null,De=Z,at=Z=0,ut=null;De!==null&&at<ne.length;at++){De.index>at?(ut=De,De=null):ut=De.sibling;var Et=re(ee,De,ne[at],ye);if(Et===null){De===null&&(De=ut);break}t&&De&&Et.alternate===null&&a(ee,De),Z=g(Et,Z,at),_t===null?Fe=Et:_t.sibling=Et,_t=Et,De=ut}if(at===ne.length)return i(ee,De),ht&&ar(ee,at),Fe;if(De===null){for(;at<ne.length;at++)De=be(ee,ne[at],ye),De!==null&&(Z=g(De,Z,at),_t===null?Fe=De:_t.sibling=De,_t=De);return ht&&ar(ee,at),Fe}for(De=c(De);at<ne.length;at++)ut=fe(De,ee,at,ne[at],ye),ut!==null&&(t&&ut.alternate!==null&&De.delete(ut.key===null?at:ut.key),Z=g(ut,Z,at),_t===null?Fe=ut:_t.sibling=ut,_t=ut);return t&&De.forEach(function(ni){return a(ee,ni)}),ht&&ar(ee,at),Fe}function Ge(ee,Z,ne,ye){if(ne==null)throw Error(r(151));for(var Fe=null,_t=null,De=Z,at=Z=0,ut=null,Et=ne.next();De!==null&&!Et.done;at++,Et=ne.next()){De.index>at?(ut=De,De=null):ut=De.sibling;var ni=re(ee,De,Et.value,ye);if(ni===null){De===null&&(De=ut);break}t&&De&&ni.alternate===null&&a(ee,De),Z=g(ni,Z,at),_t===null?Fe=ni:_t.sibling=ni,_t=ni,De=ut}if(Et.done)return i(ee,De),ht&&ar(ee,at),Fe;if(De===null){for(;!Et.done;at++,Et=ne.next())Et=be(ee,Et.value,ye),Et!==null&&(Z=g(Et,Z,at),_t===null?Fe=Et:_t.sibling=Et,_t=Et);return ht&&ar(ee,at),Fe}for(De=c(De);!Et.done;at++,Et=ne.next())Et=fe(De,ee,at,Et.value,ye),Et!==null&&(t&&Et.alternate!==null&&De.delete(Et.key===null?at:Et.key),Z=g(Et,Z,at),_t===null?Fe=Et:_t.sibling=Et,_t=Et);return t&&De.forEach(function(N2){return a(ee,N2)}),ht&&ar(ee,at),Fe}function Mt(ee,Z,ne,ye){if(typeof ne=="object"&&ne!==null&&ne.type===M&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case N:e:{for(var Fe=ne.key;Z!==null;){if(Z.key===Fe){if(Fe=ne.type,Fe===M){if(Z.tag===7){i(ee,Z.sibling),ye=h(Z,ne.props.children),ye.return=ee,ee=ye;break e}}else if(Z.elementType===Fe||typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===A&&zi(Fe)===Z.type){i(ee,Z.sibling),ye=h(Z,ne.props),tc(ye,ne),ye.return=ee,ee=ye;break e}i(ee,Z);break}else a(ee,Z);Z=Z.sibling}ne.type===M?(ye=Mi(ne.props.children,ee.mode,ye,ne.key),ye.return=ee,ee=ye):(ye=Vu(ne.type,ne.key,ne.props,null,ee.mode,ye),tc(ye,ne),ye.return=ee,ee=ye)}return E(ee);case P:e:{for(Fe=ne.key;Z!==null;){if(Z.key===Fe)if(Z.tag===4&&Z.stateNode.containerInfo===ne.containerInfo&&Z.stateNode.implementation===ne.implementation){i(ee,Z.sibling),ye=h(Z,ne.children||[]),ye.return=ee,ee=ye;break e}else{i(ee,Z);break}else a(ee,Z);Z=Z.sibling}ye=ih(ne,ee.mode,ye),ye.return=ee,ee=ye}return E(ee);case A:return ne=zi(ne),Mt(ee,Z,ne,ye)}if(ge(ne))return Le(ee,Z,ne,ye);if(L(ne)){if(Fe=L(ne),typeof Fe!="function")throw Error(r(150));return ne=Fe.call(ne),Ge(ee,Z,ne,ye)}if(typeof ne.then=="function")return Mt(ee,Z,$u(ne),ye);if(ne.$$typeof===H)return Mt(ee,Z,Fu(ee,ne),ye);Yu(ee,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint"?(ne=""+ne,Z!==null&&Z.tag===6?(i(ee,Z.sibling),ye=h(Z,ne),ye.return=ee,ee=ye):(i(ee,Z),ye=rh(ne,ee.mode,ye),ye.return=ee,ee=ye),E(ee)):i(ee,Z)}return function(ee,Z,ne,ye){try{ec=0;var Fe=Mt(ee,Z,ne,ye);return Bo=null,Fe}catch(De){if(De===zo||De===Gu)throw De;var _t=Is(29,De,null,ee.mode);return _t.lanes=ye,_t.return=ee,_t}finally{}}}var Fi=py(!0),my=py(!1),Vr=!1;function xh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function bh(t,a){t=t.updateQueue,a.updateQueue===t&&(a.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function zr(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Br(t,a,i){var c=t.updateQueue;if(c===null)return null;if(c=c.shared,(Nt&2)!==0){var h=c.pending;return h===null?a.next=a:(a.next=h.next,h.next=a),c.pending=a,a=Pu(t),X0(t,null,i),a}return Uu(t,c,a,i),Pu(t)}function nc(t,a,i){if(a=a.updateQueue,a!==null&&(a=a.shared,(i&4194048)!==0)){var c=a.lanes;c&=t.pendingLanes,i|=c,a.lanes=i,Tr(t,i)}}function vh(t,a){var i=t.updateQueue,c=t.alternate;if(c!==null&&(c=c.updateQueue,i===c)){var h=null,g=null;if(i=i.firstBaseUpdate,i!==null){do{var E={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};g===null?h=g=E:g=g.next=E,i=i.next}while(i!==null);g===null?h=g=a:g=g.next=a}else h=g=a;i={baseState:c.baseState,firstBaseUpdate:h,lastBaseUpdate:g,shared:c.shared,callbacks:c.callbacks},t.updateQueue=i;return}t=i.lastBaseUpdate,t===null?i.firstBaseUpdate=a:t.next=a,i.lastBaseUpdate=a}var _h=!1;function sc(){if(_h){var t=Vo;if(t!==null)throw t}}function ac(t,a,i,c){_h=!1;var h=t.updateQueue;Vr=!1;var g=h.firstBaseUpdate,E=h.lastBaseUpdate,k=h.shared.pending;if(k!==null){h.shared.pending=null;var q=k,se=q.next;q.next=null,E===null?g=se:E.next=se,E=q;var me=t.alternate;me!==null&&(me=me.updateQueue,k=me.lastBaseUpdate,k!==E&&(k===null?me.firstBaseUpdate=se:k.next=se,me.lastBaseUpdate=q))}if(g!==null){var be=h.baseState;E=0,me=se=q=null,k=g;do{var re=k.lane&-536870913,fe=re!==k.lane;if(fe?(ct&re)===re:(c&re)===re){re!==0&&re===Po&&(_h=!0),me!==null&&(me=me.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var Le=t,Ge=k;re=a;var Mt=i;switch(Ge.tag){case 1:if(Le=Ge.payload,typeof Le=="function"){be=Le.call(Mt,be,re);break e}be=Le;break e;case 3:Le.flags=Le.flags&-65537|128;case 0:if(Le=Ge.payload,re=typeof Le=="function"?Le.call(Mt,be,re):Le,re==null)break e;be=v({},be,re);break e;case 2:Vr=!0}}re=k.callback,re!==null&&(t.flags|=64,fe&&(t.flags|=8192),fe=h.callbacks,fe===null?h.callbacks=[re]:fe.push(re))}else fe={lane:re,tag:k.tag,payload:k.payload,callback:k.callback,next:null},me===null?(se=me=fe,q=be):me=me.next=fe,E|=re;if(k=k.next,k===null){if(k=h.shared.pending,k===null)break;fe=k,k=fe.next,fe.next=null,h.lastBaseUpdate=fe,h.shared.pending=null}}while(!0);me===null&&(q=be),h.baseState=q,h.firstBaseUpdate=se,h.lastBaseUpdate=me,g===null&&(h.shared.lanes=0),$r|=E,t.lanes=E,t.memoizedState=be}}function gy(t,a){if(typeof t!="function")throw Error(r(191,t));t.call(a)}function yy(t,a){var i=t.callbacks;if(i!==null)for(t.callbacks=null,t=0;t<i.length;t++)gy(i[t],a)}var Fo=T(null),Qu=T(0);function xy(t,a){t=mr,$(Qu,t),$(Fo,a),mr=t|a.baseLanes}function Eh(){$(Qu,mr),$(Fo,Fo.current)}function wh(){mr=Qu.current,z(Fo),z(Qu)}var Ns=T(null),Js=null;function Fr(t){var a=t.alternate;$(un,un.current&1),$(Ns,t),Js===null&&(a===null||Fo.current!==null||a.memoizedState!==null)&&(Js=t)}function Sh(t){$(un,un.current),$(Ns,t),Js===null&&(Js=t)}function by(t){t.tag===22?($(un,un.current),$(Ns,t),Js===null&&(Js=t)):Hr()}function Hr(){$(un,un.current),$(Ns,Ns.current)}function Cs(t){z(Ns),Js===t&&(Js=null),z(un)}var un=T(0);function Wu(t){for(var a=t;a!==null;){if(a.tag===13){var i=a.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||Rp(i)||Op(i)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var or=0,st=null,kt=null,xn=null,Ku=!1,Ho=!1,Hi=!1,Zu=0,rc=0,Go=null,xA=0;function sn(){throw Error(r(321))}function Th(t,a){if(a===null)return!1;for(var i=0;i<a.length&&i<t.length;i++)if(!As(t[i],a[i]))return!1;return!0}function Ah(t,a,i,c,h,g){return or=g,st=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,F.H=t===null||t.memoizedState===null?nx:Bh,Hi=!1,g=i(c,h),Hi=!1,Ho&&(g=_y(a,i,c,h)),vy(t),g}function vy(t){F.H=lc;var a=kt!==null&&kt.next!==null;if(or=0,xn=kt=st=null,Ku=!1,rc=0,Go=null,a)throw Error(r(300));t===null||bn||(t=t.dependencies,t!==null&&Bu(t)&&(bn=!0))}function _y(t,a,i,c){st=t;var h=0;do{if(Ho&&(Go=null),rc=0,Ho=!1,25<=h)throw Error(r(301));if(h+=1,xn=kt=null,t.updateQueue!=null){var g=t.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}F.H=sx,g=a(i,c)}while(Ho);return g}function bA(){var t=F.H,a=t.useState()[0];return a=typeof a.then=="function"?ic(a):a,t=t.useState()[0],(kt!==null?kt.memoizedState:null)!==t&&(st.flags|=1024),a}function Ih(){var t=Zu!==0;return Zu=0,t}function Nh(t,a,i){a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~i}function Ch(t){if(Ku){for(t=t.memoizedState;t!==null;){var a=t.queue;a!==null&&(a.pending=null),t=t.next}Ku=!1}or=0,xn=kt=st=null,Ho=!1,rc=Zu=0,Go=null}function rs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xn===null?st.memoizedState=xn=t:xn=xn.next=t,xn}function dn(){if(kt===null){var t=st.alternate;t=t!==null?t.memoizedState:null}else t=kt.next;var a=xn===null?st.memoizedState:xn.next;if(a!==null)xn=a,kt=t;else{if(t===null)throw st.alternate===null?Error(r(467)):Error(r(310));kt=t,t={memoizedState:kt.memoizedState,baseState:kt.baseState,baseQueue:kt.baseQueue,queue:kt.queue,next:null},xn===null?st.memoizedState=xn=t:xn=xn.next=t}return xn}function Xu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ic(t){var a=rc;return rc+=1,Go===null&&(Go=[]),t=dy(Go,t,a),a=st,(xn===null?a.memoizedState:xn.next)===null&&(a=a.alternate,F.H=a===null||a.memoizedState===null?nx:Bh),t}function Ju(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return ic(t);if(t.$$typeof===H)return Bn(t)}throw Error(r(438,String(t)))}function Rh(t){var a=null,i=st.updateQueue;if(i!==null&&(a=i.memoCache),a==null){var c=st.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(a={data:c.data.map(function(h){return h.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),i===null&&(i=Xu(),st.updateQueue=i),i.memoCache=a,i=a.data[a.index],i===void 0)for(i=a.data[a.index]=Array(t),c=0;c<t;c++)i[c]=C;return a.index++,i}function lr(t,a){return typeof a=="function"?a(t):a}function ed(t){var a=dn();return Oh(a,kt,t)}function Oh(t,a,i){var c=t.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=i;var h=t.baseQueue,g=c.pending;if(g!==null){if(h!==null){var E=h.next;h.next=g.next,g.next=E}a.baseQueue=h=g,c.pending=null}if(g=t.baseState,h===null)t.memoizedState=g;else{a=h.next;var k=E=null,q=null,se=a,me=!1;do{var be=se.lane&-536870913;if(be!==se.lane?(ct&be)===be:(or&be)===be){var re=se.revertLane;if(re===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),be===Po&&(me=!0);else if((or&re)===re){se=se.next,re===Po&&(me=!0);continue}else be={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},q===null?(k=q=be,E=g):q=q.next=be,st.lanes|=re,$r|=re;be=se.action,Hi&&i(g,be),g=se.hasEagerState?se.eagerState:i(g,be)}else re={lane:be,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},q===null?(k=q=re,E=g):q=q.next=re,st.lanes|=be,$r|=be;se=se.next}while(se!==null&&se!==a);if(q===null?E=g:q.next=k,!As(g,t.memoizedState)&&(bn=!0,me&&(i=Vo,i!==null)))throw i;t.memoizedState=g,t.baseState=E,t.baseQueue=q,c.lastRenderedState=g}return h===null&&(c.lanes=0),[t.memoizedState,c.dispatch]}function jh(t){var a=dn(),i=a.queue;if(i===null)throw Error(r(311));i.lastRenderedReducer=t;var c=i.dispatch,h=i.pending,g=a.memoizedState;if(h!==null){i.pending=null;var E=h=h.next;do g=t(g,E.action),E=E.next;while(E!==h);As(g,a.memoizedState)||(bn=!0),a.memoizedState=g,a.baseQueue===null&&(a.baseState=g),i.lastRenderedState=g}return[g,c]}function Ey(t,a,i){var c=st,h=dn(),g=ht;if(g){if(i===void 0)throw Error(r(407));i=i()}else i=a();var E=!As((kt||h).memoizedState,i);if(E&&(h.memoizedState=i,bn=!0),h=h.queue,Mh(Ty.bind(null,c,h,t),[t]),h.getSnapshot!==a||E||xn!==null&&xn.memoizedState.tag&1){if(c.flags|=2048,qo(9,{destroy:void 0},Sy.bind(null,c,h,i,a),null),Pt===null)throw Error(r(349));g||(or&127)!==0||wy(c,a,i)}return i}function wy(t,a,i){t.flags|=16384,t={getSnapshot:a,value:i},a=st.updateQueue,a===null?(a=Xu(),st.updateQueue=a,a.stores=[t]):(i=a.stores,i===null?a.stores=[t]:i.push(t))}function Sy(t,a,i,c){a.value=i,a.getSnapshot=c,Ay(a)&&Iy(t)}function Ty(t,a,i){return i(function(){Ay(a)&&Iy(t)})}function Ay(t){var a=t.getSnapshot;t=t.value;try{var i=a();return!As(t,i)}catch{return!0}}function Iy(t){var a=Li(t,2);a!==null&&xs(a,t,2)}function kh(t){var a=rs();if(typeof t=="function"){var i=t;if(t=i(),Hi){Ae(!0);try{i()}finally{Ae(!1)}}}return a.memoizedState=a.baseState=t,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:lr,lastRenderedState:t},a}function Ny(t,a,i,c){return t.baseState=i,Oh(t,kt,typeof c=="function"?c:lr)}function vA(t,a,i,c,h){if(sd(t))throw Error(r(485));if(t=a.action,t!==null){var g={payload:h,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){g.listeners.push(E)}};F.T!==null?i(!0):g.isTransition=!1,c(g),i=a.pending,i===null?(g.next=a.pending=g,Cy(a,g)):(g.next=i.next,a.pending=i.next=g)}}function Cy(t,a){var i=a.action,c=a.payload,h=t.state;if(a.isTransition){var g=F.T,E={};F.T=E;try{var k=i(h,c),q=F.S;q!==null&&q(E,k),Ry(t,a,k)}catch(se){Lh(t,a,se)}finally{g!==null&&E.types!==null&&(g.types=E.types),F.T=g}}else try{g=i(h,c),Ry(t,a,g)}catch(se){Lh(t,a,se)}}function Ry(t,a,i){i!==null&&typeof i=="object"&&typeof i.then=="function"?i.then(function(c){Oy(t,a,c)},function(c){return Lh(t,a,c)}):Oy(t,a,i)}function Oy(t,a,i){a.status="fulfilled",a.value=i,jy(a),t.state=i,a=t.pending,a!==null&&(i=a.next,i===a?t.pending=null:(i=i.next,a.next=i,Cy(t,i)))}function Lh(t,a,i){var c=t.pending;if(t.pending=null,c!==null){c=c.next;do a.status="rejected",a.reason=i,jy(a),a=a.next;while(a!==c)}t.action=null}function jy(t){t=t.listeners;for(var a=0;a<t.length;a++)(0,t[a])()}function ky(t,a){return a}function Ly(t,a){if(ht){var i=Pt.formState;if(i!==null){e:{var c=st;if(ht){if(Ft){t:{for(var h=Ft,g=Xs;h.nodeType!==8;){if(!g){h=null;break t}if(h=ea(h.nextSibling),h===null){h=null;break t}}g=h.data,h=g==="F!"||g==="F"?h:null}if(h){Ft=ea(h.nextSibling),c=h.data==="F!";break e}}Ur(c)}c=!1}c&&(a=i[0])}}return i=rs(),i.memoizedState=i.baseState=a,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ky,lastRenderedState:a},i.queue=c,i=Jy.bind(null,st,c),c.dispatch=i,c=kh(!1),g=zh.bind(null,st,!1,c.queue),c=rs(),h={state:a,dispatch:null,action:t,pending:null},c.queue=h,i=vA.bind(null,st,h,g,i),h.dispatch=i,c.memoizedState=t,[a,i,!1]}function My(t){var a=dn();return Dy(a,kt,t)}function Dy(t,a,i){if(a=Oh(t,a,ky)[0],t=ed(lr)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var c=ic(a)}catch(E){throw E===zo?Gu:E}else c=a;a=dn();var h=a.queue,g=h.dispatch;return i!==a.memoizedState&&(st.flags|=2048,qo(9,{destroy:void 0},_A.bind(null,h,i),null)),[c,g,t]}function _A(t,a){t.action=a}function Uy(t){var a=dn(),i=kt;if(i!==null)return Dy(a,i,t);dn(),a=a.memoizedState,i=dn();var c=i.queue.dispatch;return i.memoizedState=t,[a,c,!1]}function qo(t,a,i,c){return t={tag:t,create:i,deps:c,inst:a,next:null},a=st.updateQueue,a===null&&(a=Xu(),st.updateQueue=a),i=a.lastEffect,i===null?a.lastEffect=t.next=t:(c=i.next,i.next=t,t.next=c,a.lastEffect=t),t}function Py(){return dn().memoizedState}function td(t,a,i,c){var h=rs();st.flags|=t,h.memoizedState=qo(1|a,{destroy:void 0},i,c===void 0?null:c)}function nd(t,a,i,c){var h=dn();c=c===void 0?null:c;var g=h.memoizedState.inst;kt!==null&&c!==null&&Th(c,kt.memoizedState.deps)?h.memoizedState=qo(a,g,i,c):(st.flags|=t,h.memoizedState=qo(1|a,g,i,c))}function Vy(t,a){td(8390656,8,t,a)}function Mh(t,a){nd(2048,8,t,a)}function EA(t){st.flags|=4;var a=st.updateQueue;if(a===null)a=Xu(),st.updateQueue=a,a.events=[t];else{var i=a.events;i===null?a.events=[t]:i.push(t)}}function zy(t){var a=dn().memoizedState;return EA({ref:a,nextImpl:t}),function(){if((Nt&2)!==0)throw Error(r(440));return a.impl.apply(void 0,arguments)}}function By(t,a){return nd(4,2,t,a)}function Fy(t,a){return nd(4,4,t,a)}function Hy(t,a){if(typeof a=="function"){t=t();var i=a(t);return function(){typeof i=="function"?i():a(null)}}if(a!=null)return t=t(),a.current=t,function(){a.current=null}}function Gy(t,a,i){i=i!=null?i.concat([t]):null,nd(4,4,Hy.bind(null,a,t),i)}function Dh(){}function qy(t,a){var i=dn();a=a===void 0?null:a;var c=i.memoizedState;return a!==null&&Th(a,c[1])?c[0]:(i.memoizedState=[t,a],t)}function $y(t,a){var i=dn();a=a===void 0?null:a;var c=i.memoizedState;if(a!==null&&Th(a,c[1]))return c[0];if(c=t(),Hi){Ae(!0);try{t()}finally{Ae(!1)}}return i.memoizedState=[c,a],c}function Uh(t,a,i){return i===void 0||(or&1073741824)!==0&&(ct&261930)===0?t.memoizedState=a:(t.memoizedState=i,t=Yx(),st.lanes|=t,$r|=t,i)}function Yy(t,a,i,c){return As(i,a)?i:Fo.current!==null?(t=Uh(t,i,c),As(t,a)||(bn=!0),t):(or&42)===0||(or&1073741824)!==0&&(ct&261930)===0?(bn=!0,t.memoizedState=i):(t=Yx(),st.lanes|=t,$r|=t,a)}function Qy(t,a,i,c,h){var g=ue.p;ue.p=g!==0&&8>g?g:8;var E=F.T,k={};F.T=k,zh(t,!1,a,i);try{var q=h(),se=F.S;if(se!==null&&se(k,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var me=yA(q,c);oc(t,a,me,js(t))}else oc(t,a,c,js(t))}catch(be){oc(t,a,{then:function(){},status:"rejected",reason:be},js())}finally{ue.p=g,E!==null&&k.types!==null&&(E.types=k.types),F.T=E}}function wA(){}function Ph(t,a,i,c){if(t.tag!==5)throw Error(r(476));var h=Wy(t).queue;Qy(t,h,a,ae,i===null?wA:function(){return Ky(t),i(c)})}function Wy(t){var a=t.memoizedState;if(a!==null)return a;a={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:lr,lastRenderedState:ae},next:null};var i={};return a.next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:lr,lastRenderedState:i},next:null},t.memoizedState=a,t=t.alternate,t!==null&&(t.memoizedState=a),a}function Ky(t){var a=Wy(t);a.next===null&&(a=t.alternate.memoizedState),oc(t,a.next.queue,{},js())}function Vh(){return Bn(Sc)}function Zy(){return dn().memoizedState}function Xy(){return dn().memoizedState}function SA(t){for(var a=t.return;a!==null;){switch(a.tag){case 24:case 3:var i=js();t=zr(i);var c=Br(a,t,i);c!==null&&(xs(c,a,i),nc(c,a,i)),a={cache:ph()},t.payload=a;return}a=a.return}}function TA(t,a,i){var c=js();i={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},sd(t)?ex(a,i):(i=sh(t,a,i,c),i!==null&&(xs(i,t,c),tx(i,a,c)))}function Jy(t,a,i){var c=js();oc(t,a,i,c)}function oc(t,a,i,c){var h={lane:c,revertLane:0,gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null};if(sd(t))ex(a,h);else{var g=t.alternate;if(t.lanes===0&&(g===null||g.lanes===0)&&(g=a.lastRenderedReducer,g!==null))try{var E=a.lastRenderedState,k=g(E,i);if(h.hasEagerState=!0,h.eagerState=k,As(k,E))return Uu(t,a,h,0),Pt===null&&Du(),!1}catch{}finally{}if(i=sh(t,a,h,c),i!==null)return xs(i,t,c),tx(i,a,c),!0}return!1}function zh(t,a,i,c){if(c={lane:2,revertLane:xp(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},sd(t)){if(a)throw Error(r(479))}else a=sh(t,i,c,2),a!==null&&xs(a,t,2)}function sd(t){var a=t.alternate;return t===st||a!==null&&a===st}function ex(t,a){Ho=Ku=!0;var i=t.pending;i===null?a.next=a:(a.next=i.next,i.next=a),t.pending=a}function tx(t,a,i){if((i&4194048)!==0){var c=a.lanes;c&=t.pendingLanes,i|=c,a.lanes=i,Tr(t,i)}}var lc={readContext:Bn,use:Ju,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useLayoutEffect:sn,useInsertionEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useSyncExternalStore:sn,useId:sn,useHostTransitionStatus:sn,useFormState:sn,useActionState:sn,useOptimistic:sn,useMemoCache:sn,useCacheRefresh:sn};lc.useEffectEvent=sn;var nx={readContext:Bn,use:Ju,useCallback:function(t,a){return rs().memoizedState=[t,a===void 0?null:a],t},useContext:Bn,useEffect:Vy,useImperativeHandle:function(t,a,i){i=i!=null?i.concat([t]):null,td(4194308,4,Hy.bind(null,a,t),i)},useLayoutEffect:function(t,a){return td(4194308,4,t,a)},useInsertionEffect:function(t,a){td(4,2,t,a)},useMemo:function(t,a){var i=rs();a=a===void 0?null:a;var c=t();if(Hi){Ae(!0);try{t()}finally{Ae(!1)}}return i.memoizedState=[c,a],c},useReducer:function(t,a,i){var c=rs();if(i!==void 0){var h=i(a);if(Hi){Ae(!0);try{i(a)}finally{Ae(!1)}}}else h=a;return c.memoizedState=c.baseState=h,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:h},c.queue=t,t=t.dispatch=TA.bind(null,st,t),[c.memoizedState,t]},useRef:function(t){var a=rs();return t={current:t},a.memoizedState=t},useState:function(t){t=kh(t);var a=t.queue,i=Jy.bind(null,st,a);return a.dispatch=i,[t.memoizedState,i]},useDebugValue:Dh,useDeferredValue:function(t,a){var i=rs();return Uh(i,t,a)},useTransition:function(){var t=kh(!1);return t=Qy.bind(null,st,t.queue,!0,!1),rs().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,a,i){var c=st,h=rs();if(ht){if(i===void 0)throw Error(r(407));i=i()}else{if(i=a(),Pt===null)throw Error(r(349));(ct&127)!==0||wy(c,a,i)}h.memoizedState=i;var g={value:i,getSnapshot:a};return h.queue=g,Vy(Ty.bind(null,c,g,t),[t]),c.flags|=2048,qo(9,{destroy:void 0},Sy.bind(null,c,g,i,a),null),i},useId:function(){var t=rs(),a=Pt.identifierPrefix;if(ht){var i=za,c=Va;i=(c&~(1<<32-Be(c)-1)).toString(32)+i,a="_"+a+"R_"+i,i=Zu++,0<i&&(a+="H"+i.toString(32)),a+="_"}else i=xA++,a="_"+a+"r_"+i.toString(32)+"_";return t.memoizedState=a},useHostTransitionStatus:Vh,useFormState:Ly,useActionState:Ly,useOptimistic:function(t){var a=rs();a.memoizedState=a.baseState=t;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=i,a=zh.bind(null,st,!0,i),i.dispatch=a,[t,a]},useMemoCache:Rh,useCacheRefresh:function(){return rs().memoizedState=SA.bind(null,st)},useEffectEvent:function(t){var a=rs(),i={impl:t};return a.memoizedState=i,function(){if((Nt&2)!==0)throw Error(r(440));return i.impl.apply(void 0,arguments)}}},Bh={readContext:Bn,use:Ju,useCallback:qy,useContext:Bn,useEffect:Mh,useImperativeHandle:Gy,useInsertionEffect:By,useLayoutEffect:Fy,useMemo:$y,useReducer:ed,useRef:Py,useState:function(){return ed(lr)},useDebugValue:Dh,useDeferredValue:function(t,a){var i=dn();return Yy(i,kt.memoizedState,t,a)},useTransition:function(){var t=ed(lr)[0],a=dn().memoizedState;return[typeof t=="boolean"?t:ic(t),a]},useSyncExternalStore:Ey,useId:Zy,useHostTransitionStatus:Vh,useFormState:My,useActionState:My,useOptimistic:function(t,a){var i=dn();return Ny(i,kt,t,a)},useMemoCache:Rh,useCacheRefresh:Xy};Bh.useEffectEvent=zy;var sx={readContext:Bn,use:Ju,useCallback:qy,useContext:Bn,useEffect:Mh,useImperativeHandle:Gy,useInsertionEffect:By,useLayoutEffect:Fy,useMemo:$y,useReducer:jh,useRef:Py,useState:function(){return jh(lr)},useDebugValue:Dh,useDeferredValue:function(t,a){var i=dn();return kt===null?Uh(i,t,a):Yy(i,kt.memoizedState,t,a)},useTransition:function(){var t=jh(lr)[0],a=dn().memoizedState;return[typeof t=="boolean"?t:ic(t),a]},useSyncExternalStore:Ey,useId:Zy,useHostTransitionStatus:Vh,useFormState:Uy,useActionState:Uy,useOptimistic:function(t,a){var i=dn();return kt!==null?Ny(i,kt,t,a):(i.baseState=t,[t,i.queue.dispatch])},useMemoCache:Rh,useCacheRefresh:Xy};sx.useEffectEvent=zy;function Fh(t,a,i,c){a=t.memoizedState,i=i(c,a),i=i==null?a:v({},a,i),t.memoizedState=i,t.lanes===0&&(t.updateQueue.baseState=i)}var Hh={enqueueSetState:function(t,a,i){t=t._reactInternals;var c=js(),h=zr(c);h.payload=a,i!=null&&(h.callback=i),a=Br(t,h,c),a!==null&&(xs(a,t,c),nc(a,t,c))},enqueueReplaceState:function(t,a,i){t=t._reactInternals;var c=js(),h=zr(c);h.tag=1,h.payload=a,i!=null&&(h.callback=i),a=Br(t,h,c),a!==null&&(xs(a,t,c),nc(a,t,c))},enqueueForceUpdate:function(t,a){t=t._reactInternals;var i=js(),c=zr(i);c.tag=2,a!=null&&(c.callback=a),a=Br(t,c,i),a!==null&&(xs(a,t,i),nc(a,t,i))}};function ax(t,a,i,c,h,g,E){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(c,g,E):a.prototype&&a.prototype.isPureReactComponent?!Ql(i,c)||!Ql(h,g):!0}function rx(t,a,i,c){t=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(i,c),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(i,c),a.state!==t&&Hh.enqueueReplaceState(a,a.state,null)}function Gi(t,a){var i=a;if("ref"in a){i={};for(var c in a)c!=="ref"&&(i[c]=a[c])}if(t=t.defaultProps){i===a&&(i=v({},i));for(var h in t)i[h]===void 0&&(i[h]=t[h])}return i}function ix(t){Mu(t)}function ox(t){console.error(t)}function lx(t){Mu(t)}function ad(t,a){try{var i=t.onUncaughtError;i(a.value,{componentStack:a.stack})}catch(c){setTimeout(function(){throw c})}}function cx(t,a,i){try{var c=t.onCaughtError;c(i.value,{componentStack:i.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(h){setTimeout(function(){throw h})}}function Gh(t,a,i){return i=zr(i),i.tag=3,i.payload={element:null},i.callback=function(){ad(t,a)},i}function ux(t){return t=zr(t),t.tag=3,t}function dx(t,a,i,c){var h=i.type.getDerivedStateFromError;if(typeof h=="function"){var g=c.value;t.payload=function(){return h(g)},t.callback=function(){cx(a,i,c)}}var E=i.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(t.callback=function(){cx(a,i,c),typeof h!="function"&&(Yr===null?Yr=new Set([this]):Yr.add(this));var k=c.stack;this.componentDidCatch(c.value,{componentStack:k!==null?k:""})})}function AA(t,a,i,c,h){if(i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(a=i.alternate,a!==null&&Uo(a,i,h,!0),i=Ns.current,i!==null){switch(i.tag){case 31:case 13:return Js===null?gd():i.alternate===null&&an===0&&(an=3),i.flags&=-257,i.flags|=65536,i.lanes=h,c===qu?i.flags|=16384:(a=i.updateQueue,a===null?i.updateQueue=new Set([c]):a.add(c),mp(t,c,h)),!1;case 22:return i.flags|=65536,c===qu?i.flags|=16384:(a=i.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([c])},i.updateQueue=a):(i=a.retryQueue,i===null?a.retryQueue=new Set([c]):i.add(c)),mp(t,c,h)),!1}throw Error(r(435,i.tag))}return mp(t,c,h),gd(),!1}if(ht)return a=Ns.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=h,c!==ch&&(t=Error(r(422),{cause:c}),Zl(Ws(t,i)))):(c!==ch&&(a=Error(r(423),{cause:c}),Zl(Ws(a,i))),t=t.current.alternate,t.flags|=65536,h&=-h,t.lanes|=h,c=Ws(c,i),h=Gh(t.stateNode,c,h),vh(t,h),an!==4&&(an=2)),!1;var g=Error(r(520),{cause:c});if(g=Ws(g,i),gc===null?gc=[g]:gc.push(g),an!==4&&(an=2),a===null)return!0;c=Ws(c,i),i=a;do{switch(i.tag){case 3:return i.flags|=65536,t=h&-h,i.lanes|=t,t=Gh(i.stateNode,c,t),vh(i,t),!1;case 1:if(a=i.type,g=i.stateNode,(i.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Yr===null||!Yr.has(g))))return i.flags|=65536,h&=-h,i.lanes|=h,h=ux(h),dx(h,t,i,c),vh(i,h),!1}i=i.return}while(i!==null);return!1}var qh=Error(r(461)),bn=!1;function Fn(t,a,i,c){a.child=t===null?my(a,null,i,c):Fi(a,t.child,i,c)}function fx(t,a,i,c,h){i=i.render;var g=a.ref;if("ref"in c){var E={};for(var k in c)k!=="ref"&&(E[k]=c[k])}else E=c;return Pi(a),c=Ah(t,a,i,E,g,h),k=Ih(),t!==null&&!bn?(Nh(t,a,h),cr(t,a,h)):(ht&&k&&oh(a),a.flags|=1,Fn(t,a,c,h),a.child)}function hx(t,a,i,c,h){if(t===null){var g=i.type;return typeof g=="function"&&!ah(g)&&g.defaultProps===void 0&&i.compare===null?(a.tag=15,a.type=g,px(t,a,g,c,h)):(t=Vu(i.type,null,c,a,a.mode,h),t.ref=a.ref,t.return=a,a.child=t)}if(g=t.child,!Jh(t,h)){var E=g.memoizedProps;if(i=i.compare,i=i!==null?i:Ql,i(E,c)&&t.ref===a.ref)return cr(t,a,h)}return a.flags|=1,t=sr(g,c),t.ref=a.ref,t.return=a,a.child=t}function px(t,a,i,c,h){if(t!==null){var g=t.memoizedProps;if(Ql(g,c)&&t.ref===a.ref)if(bn=!1,a.pendingProps=c=g,Jh(t,h))(t.flags&131072)!==0&&(bn=!0);else return a.lanes=t.lanes,cr(t,a,h)}return $h(t,a,i,c,h)}function mx(t,a,i,c){var h=c.children,g=t!==null?t.memoizedState:null;if(t===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((a.flags&128)!==0){if(g=g!==null?g.baseLanes|i:i,t!==null){for(c=a.child=t.child,h=0;c!==null;)h=h|c.lanes|c.childLanes,c=c.sibling;c=h&~g}else c=0,a.child=null;return gx(t,a,g,i,c)}if((i&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},t!==null&&Hu(a,g!==null?g.cachePool:null),g!==null?xy(a,g):Eh(),by(a);else return c=a.lanes=536870912,gx(t,a,g!==null?g.baseLanes|i:i,i,c)}else g!==null?(Hu(a,g.cachePool),xy(a,g),Hr(),a.memoizedState=null):(t!==null&&Hu(a,null),Eh(),Hr());return Fn(t,a,h,i),a.child}function cc(t,a){return t!==null&&t.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function gx(t,a,i,c,h){var g=gh();return g=g===null?null:{parent:yn._currentValue,pool:g},a.memoizedState={baseLanes:i,cachePool:g},t!==null&&Hu(a,null),Eh(),by(a),t!==null&&Uo(t,a,c,!0),a.childLanes=h,null}function rd(t,a){return a=od({mode:a.mode,children:a.children},t.mode),a.ref=t.ref,t.child=a,a.return=t,a}function yx(t,a,i){return Fi(a,t.child,null,i),t=rd(a,a.pendingProps),t.flags|=2,Cs(a),a.memoizedState=null,t}function IA(t,a,i){var c=a.pendingProps,h=(a.flags&128)!==0;if(a.flags&=-129,t===null){if(ht){if(c.mode==="hidden")return t=rd(a,c),a.lanes=536870912,cc(null,t);if(Sh(a),(t=Ft)?(t=Cb(t,Xs),t=t!==null&&t.data==="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:Mr!==null?{id:Va,overflow:za}:null,retryLane:536870912,hydrationErrors:null},i=ey(t),i.return=a,a.child=i,zn=a,Ft=null)):t=null,t===null)throw Ur(a);return a.lanes=536870912,null}return rd(a,c)}var g=t.memoizedState;if(g!==null){var E=g.dehydrated;if(Sh(a),h)if(a.flags&256)a.flags&=-257,a=yx(t,a,i);else if(a.memoizedState!==null)a.child=t.child,a.flags|=128,a=null;else throw Error(r(558));else if(bn||Uo(t,a,i,!1),h=(i&t.childLanes)!==0,bn||h){if(c=Pt,c!==null&&(E=Ar(c,i),E!==0&&E!==g.retryLane))throw g.retryLane=E,Li(t,E),xs(c,t,E),qh;gd(),a=yx(t,a,i)}else t=g.treeContext,Ft=ea(E.nextSibling),zn=a,ht=!0,Dr=null,Xs=!1,t!==null&&sy(a,t),a=rd(a,c),a.flags|=4096;return a}return t=sr(t.child,{mode:c.mode,children:c.children}),t.ref=a.ref,a.child=t,t.return=a,t}function id(t,a){var i=a.ref;if(i===null)t!==null&&t.ref!==null&&(a.flags|=4194816);else{if(typeof i!="function"&&typeof i!="object")throw Error(r(284));(t===null||t.ref!==i)&&(a.flags|=4194816)}}function $h(t,a,i,c,h){return Pi(a),i=Ah(t,a,i,c,void 0,h),c=Ih(),t!==null&&!bn?(Nh(t,a,h),cr(t,a,h)):(ht&&c&&oh(a),a.flags|=1,Fn(t,a,i,h),a.child)}function xx(t,a,i,c,h,g){return Pi(a),a.updateQueue=null,i=_y(a,c,i,h),vy(t),c=Ih(),t!==null&&!bn?(Nh(t,a,g),cr(t,a,g)):(ht&&c&&oh(a),a.flags|=1,Fn(t,a,i,g),a.child)}function bx(t,a,i,c,h){if(Pi(a),a.stateNode===null){var g=ko,E=i.contextType;typeof E=="object"&&E!==null&&(g=Bn(E)),g=new i(c,g),a.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Hh,a.stateNode=g,g._reactInternals=a,g=a.stateNode,g.props=c,g.state=a.memoizedState,g.refs={},xh(a),E=i.contextType,g.context=typeof E=="object"&&E!==null?Bn(E):ko,g.state=a.memoizedState,E=i.getDerivedStateFromProps,typeof E=="function"&&(Fh(a,i,E,c),g.state=a.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(E=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),E!==g.state&&Hh.enqueueReplaceState(g,g.state,null),ac(a,c,g,h),sc(),g.state=a.memoizedState),typeof g.componentDidMount=="function"&&(a.flags|=4194308),c=!0}else if(t===null){g=a.stateNode;var k=a.memoizedProps,q=Gi(i,k);g.props=q;var se=g.context,me=i.contextType;E=ko,typeof me=="object"&&me!==null&&(E=Bn(me));var be=i.getDerivedStateFromProps;me=typeof be=="function"||typeof g.getSnapshotBeforeUpdate=="function",k=a.pendingProps!==k,me||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(k||se!==E)&&rx(a,g,c,E),Vr=!1;var re=a.memoizedState;g.state=re,ac(a,c,g,h),sc(),se=a.memoizedState,k||re!==se||Vr?(typeof be=="function"&&(Fh(a,i,be,c),se=a.memoizedState),(q=Vr||ax(a,i,q,c,re,se,E))?(me||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(a.flags|=4194308)):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=c,a.memoizedState=se),g.props=c,g.state=se,g.context=E,c=q):(typeof g.componentDidMount=="function"&&(a.flags|=4194308),c=!1)}else{g=a.stateNode,bh(t,a),E=a.memoizedProps,me=Gi(i,E),g.props=me,be=a.pendingProps,re=g.context,se=i.contextType,q=ko,typeof se=="object"&&se!==null&&(q=Bn(se)),k=i.getDerivedStateFromProps,(se=typeof k=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(E!==be||re!==q)&&rx(a,g,c,q),Vr=!1,re=a.memoizedState,g.state=re,ac(a,c,g,h),sc();var fe=a.memoizedState;E!==be||re!==fe||Vr||t!==null&&t.dependencies!==null&&Bu(t.dependencies)?(typeof k=="function"&&(Fh(a,i,k,c),fe=a.memoizedState),(me=Vr||ax(a,i,me,c,re,fe,q)||t!==null&&t.dependencies!==null&&Bu(t.dependencies))?(se||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(c,fe,q),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(c,fe,q)),typeof g.componentDidUpdate=="function"&&(a.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof g.componentDidUpdate!="function"||E===t.memoizedProps&&re===t.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===t.memoizedProps&&re===t.memoizedState||(a.flags|=1024),a.memoizedProps=c,a.memoizedState=fe),g.props=c,g.state=fe,g.context=q,c=me):(typeof g.componentDidUpdate!="function"||E===t.memoizedProps&&re===t.memoizedState||(a.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||E===t.memoizedProps&&re===t.memoizedState||(a.flags|=1024),c=!1)}return g=c,id(t,a),c=(a.flags&128)!==0,g||c?(g=a.stateNode,i=c&&typeof i.getDerivedStateFromError!="function"?null:g.render(),a.flags|=1,t!==null&&c?(a.child=Fi(a,t.child,null,h),a.child=Fi(a,null,i,h)):Fn(t,a,i,h),a.memoizedState=g.state,t=a.child):t=cr(t,a,h),t}function vx(t,a,i,c){return Di(),a.flags|=256,Fn(t,a,i,c),a.child}var Yh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qh(t){return{baseLanes:t,cachePool:cy()}}function Wh(t,a,i){return t=t!==null?t.childLanes&~i:0,a&&(t|=Os),t}function _x(t,a,i){var c=a.pendingProps,h=!1,g=(a.flags&128)!==0,E;if((E=g)||(E=t!==null&&t.memoizedState===null?!1:(un.current&2)!==0),E&&(h=!0,a.flags&=-129),E=(a.flags&32)!==0,a.flags&=-33,t===null){if(ht){if(h?Fr(a):Hr(),(t=Ft)?(t=Cb(t,Xs),t=t!==null&&t.data!=="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:Mr!==null?{id:Va,overflow:za}:null,retryLane:536870912,hydrationErrors:null},i=ey(t),i.return=a,a.child=i,zn=a,Ft=null)):t=null,t===null)throw Ur(a);return Op(t)?a.lanes=32:a.lanes=536870912,null}var k=c.children;return c=c.fallback,h?(Hr(),h=a.mode,k=od({mode:"hidden",children:k},h),c=Mi(c,h,i,null),k.return=a,c.return=a,k.sibling=c,a.child=k,c=a.child,c.memoizedState=Qh(i),c.childLanes=Wh(t,E,i),a.memoizedState=Yh,cc(null,c)):(Fr(a),Kh(a,k))}var q=t.memoizedState;if(q!==null&&(k=q.dehydrated,k!==null)){if(g)a.flags&256?(Fr(a),a.flags&=-257,a=Zh(t,a,i)):a.memoizedState!==null?(Hr(),a.child=t.child,a.flags|=128,a=null):(Hr(),k=c.fallback,h=a.mode,c=od({mode:"visible",children:c.children},h),k=Mi(k,h,i,null),k.flags|=2,c.return=a,k.return=a,c.sibling=k,a.child=c,Fi(a,t.child,null,i),c=a.child,c.memoizedState=Qh(i),c.childLanes=Wh(t,E,i),a.memoizedState=Yh,a=cc(null,c));else if(Fr(a),Op(k)){if(E=k.nextSibling&&k.nextSibling.dataset,E)var se=E.dgst;E=se,c=Error(r(419)),c.stack="",c.digest=E,Zl({value:c,source:null,stack:null}),a=Zh(t,a,i)}else if(bn||Uo(t,a,i,!1),E=(i&t.childLanes)!==0,bn||E){if(E=Pt,E!==null&&(c=Ar(E,i),c!==0&&c!==q.retryLane))throw q.retryLane=c,Li(t,c),xs(E,t,c),qh;Rp(k)||gd(),a=Zh(t,a,i)}else Rp(k)?(a.flags|=192,a.child=t.child,a=null):(t=q.treeContext,Ft=ea(k.nextSibling),zn=a,ht=!0,Dr=null,Xs=!1,t!==null&&sy(a,t),a=Kh(a,c.children),a.flags|=4096);return a}return h?(Hr(),k=c.fallback,h=a.mode,q=t.child,se=q.sibling,c=sr(q,{mode:"hidden",children:c.children}),c.subtreeFlags=q.subtreeFlags&65011712,se!==null?k=sr(se,k):(k=Mi(k,h,i,null),k.flags|=2),k.return=a,c.return=a,c.sibling=k,a.child=c,cc(null,c),c=a.child,k=t.child.memoizedState,k===null?k=Qh(i):(h=k.cachePool,h!==null?(q=yn._currentValue,h=h.parent!==q?{parent:q,pool:q}:h):h=cy(),k={baseLanes:k.baseLanes|i,cachePool:h}),c.memoizedState=k,c.childLanes=Wh(t,E,i),a.memoizedState=Yh,cc(t.child,c)):(Fr(a),i=t.child,t=i.sibling,i=sr(i,{mode:"visible",children:c.children}),i.return=a,i.sibling=null,t!==null&&(E=a.deletions,E===null?(a.deletions=[t],a.flags|=16):E.push(t)),a.child=i,a.memoizedState=null,i)}function Kh(t,a){return a=od({mode:"visible",children:a},t.mode),a.return=t,t.child=a}function od(t,a){return t=Is(22,t,null,a),t.lanes=0,t}function Zh(t,a,i){return Fi(a,t.child,null,i),t=Kh(a,a.pendingProps.children),t.flags|=2,a.memoizedState=null,t}function Ex(t,a,i){t.lanes|=a;var c=t.alternate;c!==null&&(c.lanes|=a),fh(t.return,a,i)}function Xh(t,a,i,c,h,g){var E=t.memoizedState;E===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:c,tail:i,tailMode:h,treeForkCount:g}:(E.isBackwards=a,E.rendering=null,E.renderingStartTime=0,E.last=c,E.tail=i,E.tailMode=h,E.treeForkCount=g)}function wx(t,a,i){var c=a.pendingProps,h=c.revealOrder,g=c.tail;c=c.children;var E=un.current,k=(E&2)!==0;if(k?(E=E&1|2,a.flags|=128):E&=1,$(un,E),Fn(t,a,c,i),c=ht?Kl:0,!k&&t!==null&&(t.flags&128)!==0)e:for(t=a.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ex(t,i,a);else if(t.tag===19)Ex(t,i,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===a)break e;for(;t.sibling===null;){if(t.return===null||t.return===a)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(h){case"forwards":for(i=a.child,h=null;i!==null;)t=i.alternate,t!==null&&Wu(t)===null&&(h=i),i=i.sibling;i=h,i===null?(h=a.child,a.child=null):(h=i.sibling,i.sibling=null),Xh(a,!1,h,i,g,c);break;case"backwards":case"unstable_legacy-backwards":for(i=null,h=a.child,a.child=null;h!==null;){if(t=h.alternate,t!==null&&Wu(t)===null){a.child=h;break}t=h.sibling,h.sibling=i,i=h,h=t}Xh(a,!0,i,null,g,c);break;case"together":Xh(a,!1,null,null,void 0,c);break;default:a.memoizedState=null}return a.child}function cr(t,a,i){if(t!==null&&(a.dependencies=t.dependencies),$r|=a.lanes,(i&a.childLanes)===0)if(t!==null){if(Uo(t,a,i,!1),(i&a.childLanes)===0)return null}else return null;if(t!==null&&a.child!==t.child)throw Error(r(153));if(a.child!==null){for(t=a.child,i=sr(t,t.pendingProps),a.child=i,i.return=a;t.sibling!==null;)t=t.sibling,i=i.sibling=sr(t,t.pendingProps),i.return=a;i.sibling=null}return a.child}function Jh(t,a){return(t.lanes&a)!==0?!0:(t=t.dependencies,!!(t!==null&&Bu(t)))}function NA(t,a,i){switch(a.tag){case 3:W(a,a.stateNode.containerInfo),Pr(a,yn,t.memoizedState.cache),Di();break;case 27:case 5:ie(a);break;case 4:W(a,a.stateNode.containerInfo);break;case 10:Pr(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Sh(a),null;break;case 13:var c=a.memoizedState;if(c!==null)return c.dehydrated!==null?(Fr(a),a.flags|=128,null):(i&a.child.childLanes)!==0?_x(t,a,i):(Fr(a),t=cr(t,a,i),t!==null?t.sibling:null);Fr(a);break;case 19:var h=(t.flags&128)!==0;if(c=(i&a.childLanes)!==0,c||(Uo(t,a,i,!1),c=(i&a.childLanes)!==0),h){if(c)return wx(t,a,i);a.flags|=128}if(h=a.memoizedState,h!==null&&(h.rendering=null,h.tail=null,h.lastEffect=null),$(un,un.current),c)break;return null;case 22:return a.lanes=0,mx(t,a,i,a.pendingProps);case 24:Pr(a,yn,t.memoizedState.cache)}return cr(t,a,i)}function Sx(t,a,i){if(t!==null)if(t.memoizedProps!==a.pendingProps)bn=!0;else{if(!Jh(t,i)&&(a.flags&128)===0)return bn=!1,NA(t,a,i);bn=(t.flags&131072)!==0}else bn=!1,ht&&(a.flags&1048576)!==0&&ny(a,Kl,a.index);switch(a.lanes=0,a.tag){case 16:e:{var c=a.pendingProps;if(t=zi(a.elementType),a.type=t,typeof t=="function")ah(t)?(c=Gi(t,c),a.tag=1,a=bx(null,a,t,c,i)):(a.tag=0,a=$h(null,a,t,c,i));else{if(t!=null){var h=t.$$typeof;if(h===G){a.tag=11,a=fx(null,a,t,c,i);break e}else if(h===I){a.tag=14,a=hx(null,a,t,c,i);break e}}throw a=xe(t)||t,Error(r(306,a,""))}}return a;case 0:return $h(t,a,a.type,a.pendingProps,i);case 1:return c=a.type,h=Gi(c,a.pendingProps),bx(t,a,c,h,i);case 3:e:{if(W(a,a.stateNode.containerInfo),t===null)throw Error(r(387));c=a.pendingProps;var g=a.memoizedState;h=g.element,bh(t,a),ac(a,c,null,i);var E=a.memoizedState;if(c=E.cache,Pr(a,yn,c),c!==g.cache&&hh(a,[yn],i,!0),sc(),c=E.element,g.isDehydrated)if(g={element:c,isDehydrated:!1,cache:E.cache},a.updateQueue.baseState=g,a.memoizedState=g,a.flags&256){a=vx(t,a,c,i);break e}else if(c!==h){h=Ws(Error(r(424)),a),Zl(h),a=vx(t,a,c,i);break e}else{switch(t=a.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(Ft=ea(t.firstChild),zn=a,ht=!0,Dr=null,Xs=!0,i=my(a,null,c,i),a.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling}else{if(Di(),c===h){a=cr(t,a,i);break e}Fn(t,a,c,i)}a=a.child}return a;case 26:return id(t,a),t===null?(i=Mb(a.type,null,a.pendingProps,null))?a.memoizedState=i:ht||(i=a.type,t=a.pendingProps,c=wd(de.current).createElement(i),c[en]=a,c[mn]=t,Hn(c,i,t),tn(c),a.stateNode=c):a.memoizedState=Mb(a.type,t.memoizedProps,a.pendingProps,t.memoizedState),null;case 27:return ie(a),t===null&&ht&&(c=a.stateNode=jb(a.type,a.pendingProps,de.current),zn=a,Xs=!0,h=Ft,Zr(a.type)?(jp=h,Ft=ea(c.firstChild)):Ft=h),Fn(t,a,a.pendingProps.children,i),id(t,a),t===null&&(a.flags|=4194304),a.child;case 5:return t===null&&ht&&((h=c=Ft)&&(c=a2(c,a.type,a.pendingProps,Xs),c!==null?(a.stateNode=c,zn=a,Ft=ea(c.firstChild),Xs=!1,h=!0):h=!1),h||Ur(a)),ie(a),h=a.type,g=a.pendingProps,E=t!==null?t.memoizedProps:null,c=g.children,Ip(h,g)?c=null:E!==null&&Ip(h,E)&&(a.flags|=32),a.memoizedState!==null&&(h=Ah(t,a,bA,null,null,i),Sc._currentValue=h),id(t,a),Fn(t,a,c,i),a.child;case 6:return t===null&&ht&&((t=i=Ft)&&(i=r2(i,a.pendingProps,Xs),i!==null?(a.stateNode=i,zn=a,Ft=null,t=!0):t=!1),t||Ur(a)),null;case 13:return _x(t,a,i);case 4:return W(a,a.stateNode.containerInfo),c=a.pendingProps,t===null?a.child=Fi(a,null,c,i):Fn(t,a,c,i),a.child;case 11:return fx(t,a,a.type,a.pendingProps,i);case 7:return Fn(t,a,a.pendingProps,i),a.child;case 8:return Fn(t,a,a.pendingProps.children,i),a.child;case 12:return Fn(t,a,a.pendingProps.children,i),a.child;case 10:return c=a.pendingProps,Pr(a,a.type,c.value),Fn(t,a,c.children,i),a.child;case 9:return h=a.type._context,c=a.pendingProps.children,Pi(a),h=Bn(h),c=c(h),a.flags|=1,Fn(t,a,c,i),a.child;case 14:return hx(t,a,a.type,a.pendingProps,i);case 15:return px(t,a,a.type,a.pendingProps,i);case 19:return wx(t,a,i);case 31:return IA(t,a,i);case 22:return mx(t,a,i,a.pendingProps);case 24:return Pi(a),c=Bn(yn),t===null?(h=gh(),h===null&&(h=Pt,g=ph(),h.pooledCache=g,g.refCount++,g!==null&&(h.pooledCacheLanes|=i),h=g),a.memoizedState={parent:c,cache:h},xh(a),Pr(a,yn,h)):((t.lanes&i)!==0&&(bh(t,a),ac(a,null,null,i),sc()),h=t.memoizedState,g=a.memoizedState,h.parent!==c?(h={parent:c,cache:c},a.memoizedState=h,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=h),Pr(a,yn,c)):(c=g.cache,Pr(a,yn,c),c!==h.cache&&hh(a,[yn],i,!0))),Fn(t,a,a.pendingProps.children,i),a.child;case 29:throw a.pendingProps}throw Error(r(156,a.tag))}function ur(t){t.flags|=4}function ep(t,a,i,c,h){if((a=(t.mode&32)!==0)&&(a=!1),a){if(t.flags|=16777216,(h&335544128)===h)if(t.stateNode.complete)t.flags|=8192;else if(Zx())t.flags|=8192;else throw Bi=qu,yh}else t.flags&=-16777217}function Tx(t,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!zb(a))if(Zx())t.flags|=8192;else throw Bi=qu,yh}function ld(t,a){a!==null&&(t.flags|=4),t.flags&16384&&(a=t.tag!==22?jn():536870912,t.lanes|=a,Wo|=a)}function uc(t,a){if(!ht)switch(t.tailMode){case"hidden":a=t.tail;for(var i=null;a!==null;)a.alternate!==null&&(i=a),a=a.sibling;i===null?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?a||t.tail===null?t.tail=null:t.tail.sibling=null:c.sibling=null}}function Ht(t){var a=t.alternate!==null&&t.alternate.child===t.child,i=0,c=0;if(a)for(var h=t.child;h!==null;)i|=h.lanes|h.childLanes,c|=h.subtreeFlags&65011712,c|=h.flags&65011712,h.return=t,h=h.sibling;else for(h=t.child;h!==null;)i|=h.lanes|h.childLanes,c|=h.subtreeFlags,c|=h.flags,h.return=t,h=h.sibling;return t.subtreeFlags|=c,t.childLanes=i,a}function CA(t,a,i){var c=a.pendingProps;switch(lh(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ht(a),null;case 1:return Ht(a),null;case 3:return i=a.stateNode,c=null,t!==null&&(c=t.memoizedState.cache),a.memoizedState.cache!==c&&(a.flags|=2048),ir(yn),le(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Do(a)?ur(a):t===null||t.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,uh())),Ht(a),null;case 26:var h=a.type,g=a.memoizedState;return t===null?(ur(a),g!==null?(Ht(a),Tx(a,g)):(Ht(a),ep(a,h,null,c,i))):g?g!==t.memoizedState?(ur(a),Ht(a),Tx(a,g)):(Ht(a),a.flags&=-16777217):(t=t.memoizedProps,t!==c&&ur(a),Ht(a),ep(a,h,t,c,i)),null;case 27:if(he(a),i=de.current,h=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==c&&ur(a);else{if(!c){if(a.stateNode===null)throw Error(r(166));return Ht(a),null}t=J.current,Do(a)?ay(a):(t=jb(h,c,i),a.stateNode=t,ur(a))}return Ht(a),null;case 5:if(he(a),h=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==c&&ur(a);else{if(!c){if(a.stateNode===null)throw Error(r(166));return Ht(a),null}if(g=J.current,Do(a))ay(a);else{var E=wd(de.current);switch(g){case 1:g=E.createElementNS("http://www.w3.org/2000/svg",h);break;case 2:g=E.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;default:switch(h){case"svg":g=E.createElementNS("http://www.w3.org/2000/svg",h);break;case"math":g=E.createElementNS("http://www.w3.org/1998/Math/MathML",h);break;case"script":g=E.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof c.is=="string"?E.createElement("select",{is:c.is}):E.createElement("select"),c.multiple?g.multiple=!0:c.size&&(g.size=c.size);break;default:g=typeof c.is=="string"?E.createElement(h,{is:c.is}):E.createElement(h)}}g[en]=a,g[mn]=c;e:for(E=a.child;E!==null;){if(E.tag===5||E.tag===6)g.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===a)break e;for(;E.sibling===null;){if(E.return===null||E.return===a)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}a.stateNode=g;e:switch(Hn(g,h,c),h){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&ur(a)}}return Ht(a),ep(a,a.type,t===null?null:t.memoizedProps,a.pendingProps,i),null;case 6:if(t&&a.stateNode!=null)t.memoizedProps!==c&&ur(a);else{if(typeof c!="string"&&a.stateNode===null)throw Error(r(166));if(t=de.current,Do(a)){if(t=a.stateNode,i=a.memoizedProps,c=null,h=zn,h!==null)switch(h.tag){case 27:case 5:c=h.memoizedProps}t[en]=a,t=!!(t.nodeValue===i||c!==null&&c.suppressHydrationWarning===!0||_b(t.nodeValue,i)),t||Ur(a,!0)}else t=wd(t).createTextNode(c),t[en]=a,a.stateNode=t}return Ht(a),null;case 31:if(i=a.memoizedState,t===null||t.memoizedState!==null){if(c=Do(a),i!==null){if(t===null){if(!c)throw Error(r(318));if(t=a.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(r(557));t[en]=a}else Di(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ht(a),t=!1}else i=uh(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=i),t=!0;if(!t)return a.flags&256?(Cs(a),a):(Cs(a),null);if((a.flags&128)!==0)throw Error(r(558))}return Ht(a),null;case 13:if(c=a.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(h=Do(a),c!==null&&c.dehydrated!==null){if(t===null){if(!h)throw Error(r(318));if(h=a.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));h[en]=a}else Di(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ht(a),h=!1}else h=uh(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=h),h=!0;if(!h)return a.flags&256?(Cs(a),a):(Cs(a),null)}return Cs(a),(a.flags&128)!==0?(a.lanes=i,a):(i=c!==null,t=t!==null&&t.memoizedState!==null,i&&(c=a.child,h=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(h=c.alternate.memoizedState.cachePool.pool),g=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(g=c.memoizedState.cachePool.pool),g!==h&&(c.flags|=2048)),i!==t&&i&&(a.child.flags|=8192),ld(a,a.updateQueue),Ht(a),null);case 4:return le(),t===null&&Ep(a.stateNode.containerInfo),Ht(a),null;case 10:return ir(a.type),Ht(a),null;case 19:if(z(un),c=a.memoizedState,c===null)return Ht(a),null;if(h=(a.flags&128)!==0,g=c.rendering,g===null)if(h)uc(c,!1);else{if(an!==0||t!==null&&(t.flags&128)!==0)for(t=a.child;t!==null;){if(g=Wu(t),g!==null){for(a.flags|=128,uc(c,!1),t=g.updateQueue,a.updateQueue=t,ld(a,t),a.subtreeFlags=0,t=i,i=a.child;i!==null;)J0(i,t),i=i.sibling;return $(un,un.current&1|2),ht&&ar(a,c.treeForkCount),a.child}t=t.sibling}c.tail!==null&&Ye()>hd&&(a.flags|=128,h=!0,uc(c,!1),a.lanes=4194304)}else{if(!h)if(t=Wu(g),t!==null){if(a.flags|=128,h=!0,t=t.updateQueue,a.updateQueue=t,ld(a,t),uc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!g.alternate&&!ht)return Ht(a),null}else 2*Ye()-c.renderingStartTime>hd&&i!==536870912&&(a.flags|=128,h=!0,uc(c,!1),a.lanes=4194304);c.isBackwards?(g.sibling=a.child,a.child=g):(t=c.last,t!==null?t.sibling=g:a.child=g,c.last=g)}return c.tail!==null?(t=c.tail,c.rendering=t,c.tail=t.sibling,c.renderingStartTime=Ye(),t.sibling=null,i=un.current,$(un,h?i&1|2:i&1),ht&&ar(a,c.treeForkCount),t):(Ht(a),null);case 22:case 23:return Cs(a),wh(),c=a.memoizedState!==null,t!==null?t.memoizedState!==null!==c&&(a.flags|=8192):c&&(a.flags|=8192),c?(i&536870912)!==0&&(a.flags&128)===0&&(Ht(a),a.subtreeFlags&6&&(a.flags|=8192)):Ht(a),i=a.updateQueue,i!==null&&ld(a,i.retryQueue),i=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),c=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(c=a.memoizedState.cachePool.pool),c!==i&&(a.flags|=2048),t!==null&&z(Vi),null;case 24:return i=null,t!==null&&(i=t.memoizedState.cache),a.memoizedState.cache!==i&&(a.flags|=2048),ir(yn),Ht(a),null;case 25:return null;case 30:return null}throw Error(r(156,a.tag))}function RA(t,a){switch(lh(a),a.tag){case 1:return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 3:return ir(yn),le(),t=a.flags,(t&65536)!==0&&(t&128)===0?(a.flags=t&-65537|128,a):null;case 26:case 27:case 5:return he(a),null;case 31:if(a.memoizedState!==null){if(Cs(a),a.alternate===null)throw Error(r(340));Di()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 13:if(Cs(a),t=a.memoizedState,t!==null&&t.dehydrated!==null){if(a.alternate===null)throw Error(r(340));Di()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 19:return z(un),null;case 4:return le(),null;case 10:return ir(a.type),null;case 22:case 23:return Cs(a),wh(),t!==null&&z(Vi),t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 24:return ir(yn),null;case 25:return null;default:return null}}function Ax(t,a){switch(lh(a),a.tag){case 3:ir(yn),le();break;case 26:case 27:case 5:he(a);break;case 4:le();break;case 31:a.memoizedState!==null&&Cs(a);break;case 13:Cs(a);break;case 19:z(un);break;case 10:ir(a.type);break;case 22:case 23:Cs(a),wh(),t!==null&&z(Vi);break;case 24:ir(yn)}}function dc(t,a){try{var i=a.updateQueue,c=i!==null?i.lastEffect:null;if(c!==null){var h=c.next;i=h;do{if((i.tag&t)===t){c=void 0;var g=i.create,E=i.inst;c=g(),E.destroy=c}i=i.next}while(i!==h)}}catch(k){Ot(a,a.return,k)}}function Gr(t,a,i){try{var c=a.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var g=h.next;c=g;do{if((c.tag&t)===t){var E=c.inst,k=E.destroy;if(k!==void 0){E.destroy=void 0,h=a;var q=i,se=k;try{se()}catch(me){Ot(h,q,me)}}}c=c.next}while(c!==g)}}catch(me){Ot(a,a.return,me)}}function Ix(t){var a=t.updateQueue;if(a!==null){var i=t.stateNode;try{yy(a,i)}catch(c){Ot(t,t.return,c)}}}function Nx(t,a,i){i.props=Gi(t.type,t.memoizedProps),i.state=t.memoizedState;try{i.componentWillUnmount()}catch(c){Ot(t,a,c)}}function fc(t,a){try{var i=t.ref;if(i!==null){switch(t.tag){case 26:case 27:case 5:var c=t.stateNode;break;case 30:c=t.stateNode;break;default:c=t.stateNode}typeof i=="function"?t.refCleanup=i(c):i.current=c}}catch(h){Ot(t,a,h)}}function Ba(t,a){var i=t.ref,c=t.refCleanup;if(i!==null)if(typeof c=="function")try{c()}catch(h){Ot(t,a,h)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof i=="function")try{i(null)}catch(h){Ot(t,a,h)}else i.current=null}function Cx(t){var a=t.type,i=t.memoizedProps,c=t.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":i.autoFocus&&c.focus();break e;case"img":i.src?c.src=i.src:i.srcSet&&(c.srcset=i.srcSet)}}catch(h){Ot(t,t.return,h)}}function tp(t,a,i){try{var c=t.stateNode;XA(c,t.type,i,a),c[mn]=a}catch(h){Ot(t,t.return,h)}}function Rx(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Zr(t.type)||t.tag===4}function np(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Rx(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Zr(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function sp(t,a,i){var c=t.tag;if(c===5||c===6)t=t.stateNode,a?(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i).insertBefore(t,a):(a=i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,a.appendChild(t),i=i._reactRootContainer,i!=null||a.onclick!==null||(a.onclick=da));else if(c!==4&&(c===27&&Zr(t.type)&&(i=t.stateNode,a=null),t=t.child,t!==null))for(sp(t,a,i),t=t.sibling;t!==null;)sp(t,a,i),t=t.sibling}function cd(t,a,i){var c=t.tag;if(c===5||c===6)t=t.stateNode,a?i.insertBefore(t,a):i.appendChild(t);else if(c!==4&&(c===27&&Zr(t.type)&&(i=t.stateNode),t=t.child,t!==null))for(cd(t,a,i),t=t.sibling;t!==null;)cd(t,a,i),t=t.sibling}function Ox(t){var a=t.stateNode,i=t.memoizedProps;try{for(var c=t.type,h=a.attributes;h.length;)a.removeAttributeNode(h[0]);Hn(a,c,i),a[en]=t,a[mn]=i}catch(g){Ot(t,t.return,g)}}var dr=!1,vn=!1,ap=!1,jx=typeof WeakSet=="function"?WeakSet:Set,Mn=null;function OA(t,a){if(t=t.containerInfo,Tp=Rd,t=G0(t),Zf(t)){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else e:{i=(i=t.ownerDocument)&&i.defaultView||window;var c=i.getSelection&&i.getSelection();if(c&&c.rangeCount!==0){i=c.anchorNode;var h=c.anchorOffset,g=c.focusNode;c=c.focusOffset;try{i.nodeType,g.nodeType}catch{i=null;break e}var E=0,k=-1,q=-1,se=0,me=0,be=t,re=null;t:for(;;){for(var fe;be!==i||h!==0&&be.nodeType!==3||(k=E+h),be!==g||c!==0&&be.nodeType!==3||(q=E+c),be.nodeType===3&&(E+=be.nodeValue.length),(fe=be.firstChild)!==null;)re=be,be=fe;for(;;){if(be===t)break t;if(re===i&&++se===h&&(k=E),re===g&&++me===c&&(q=E),(fe=be.nextSibling)!==null)break;be=re,re=be.parentNode}be=fe}i=k===-1||q===-1?null:{start:k,end:q}}else i=null}i=i||{start:0,end:0}}else i=null;for(Ap={focusedElem:t,selectionRange:i},Rd=!1,Mn=a;Mn!==null;)if(a=Mn,t=a.child,(a.subtreeFlags&1028)!==0&&t!==null)t.return=a,Mn=t;else for(;Mn!==null;){switch(a=Mn,g=a.alternate,t=a.flags,a.tag){case 0:if((t&4)!==0&&(t=a.updateQueue,t=t!==null?t.events:null,t!==null))for(i=0;i<t.length;i++)h=t[i],h.ref.impl=h.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&g!==null){t=void 0,i=a,h=g.memoizedProps,g=g.memoizedState,c=i.stateNode;try{var Le=Gi(i.type,h);t=c.getSnapshotBeforeUpdate(Le,g),c.__reactInternalSnapshotBeforeUpdate=t}catch(Ge){Ot(i,i.return,Ge)}}break;case 3:if((t&1024)!==0){if(t=a.stateNode.containerInfo,i=t.nodeType,i===9)Cp(t);else if(i===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Cp(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(r(163))}if(t=a.sibling,t!==null){t.return=a.return,Mn=t;break}Mn=a.return}}function kx(t,a,i){var c=i.flags;switch(i.tag){case 0:case 11:case 15:hr(t,i),c&4&&dc(5,i);break;case 1:if(hr(t,i),c&4)if(t=i.stateNode,a===null)try{t.componentDidMount()}catch(E){Ot(i,i.return,E)}else{var h=Gi(i.type,a.memoizedProps);a=a.memoizedState;try{t.componentDidUpdate(h,a,t.__reactInternalSnapshotBeforeUpdate)}catch(E){Ot(i,i.return,E)}}c&64&&Ix(i),c&512&&fc(i,i.return);break;case 3:if(hr(t,i),c&64&&(t=i.updateQueue,t!==null)){if(a=null,i.child!==null)switch(i.child.tag){case 27:case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}try{yy(t,a)}catch(E){Ot(i,i.return,E)}}break;case 27:a===null&&c&4&&Ox(i);case 26:case 5:hr(t,i),a===null&&c&4&&Cx(i),c&512&&fc(i,i.return);break;case 12:hr(t,i);break;case 31:hr(t,i),c&4&&Dx(t,i);break;case 13:hr(t,i),c&4&&Ux(t,i),c&64&&(t=i.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(i=zA.bind(null,i),i2(t,i))));break;case 22:if(c=i.memoizedState!==null||dr,!c){a=a!==null&&a.memoizedState!==null||vn,h=dr;var g=vn;dr=c,(vn=a)&&!g?pr(t,i,(i.subtreeFlags&8772)!==0):hr(t,i),dr=h,vn=g}break;case 30:break;default:hr(t,i)}}function Lx(t){var a=t.alternate;a!==null&&(t.alternate=null,Lx(a)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(a=t.stateNode,a!==null&&Nr(a)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var $t=null,ps=!1;function fr(t,a,i){for(i=i.child;i!==null;)Mx(t,a,i),i=i.sibling}function Mx(t,a,i){if(Oe&&typeof Oe.onCommitFiberUnmount=="function")try{Oe.onCommitFiberUnmount(ve,i)}catch{}switch(i.tag){case 26:vn||Ba(i,a),fr(t,a,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode,i.parentNode.removeChild(i));break;case 27:vn||Ba(i,a);var c=$t,h=ps;Zr(i.type)&&($t=i.stateNode,ps=!1),fr(t,a,i),_c(i.stateNode),$t=c,ps=h;break;case 5:vn||Ba(i,a);case 6:if(c=$t,h=ps,$t=null,fr(t,a,i),$t=c,ps=h,$t!==null)if(ps)try{($t.nodeType===9?$t.body:$t.nodeName==="HTML"?$t.ownerDocument.body:$t).removeChild(i.stateNode)}catch(g){Ot(i,a,g)}else try{$t.removeChild(i.stateNode)}catch(g){Ot(i,a,g)}break;case 18:$t!==null&&(ps?(t=$t,Ib(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,i.stateNode),sl(t)):Ib($t,i.stateNode));break;case 4:c=$t,h=ps,$t=i.stateNode.containerInfo,ps=!0,fr(t,a,i),$t=c,ps=h;break;case 0:case 11:case 14:case 15:Gr(2,i,a),vn||Gr(4,i,a),fr(t,a,i);break;case 1:vn||(Ba(i,a),c=i.stateNode,typeof c.componentWillUnmount=="function"&&Nx(i,a,c)),fr(t,a,i);break;case 21:fr(t,a,i);break;case 22:vn=(c=vn)||i.memoizedState!==null,fr(t,a,i),vn=c;break;default:fr(t,a,i)}}function Dx(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{sl(t)}catch(i){Ot(a,a.return,i)}}}function Ux(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{sl(t)}catch(i){Ot(a,a.return,i)}}function jA(t){switch(t.tag){case 31:case 13:case 19:var a=t.stateNode;return a===null&&(a=t.stateNode=new jx),a;case 22:return t=t.stateNode,a=t._retryCache,a===null&&(a=t._retryCache=new jx),a;default:throw Error(r(435,t.tag))}}function ud(t,a){var i=jA(t);a.forEach(function(c){if(!i.has(c)){i.add(c);var h=BA.bind(null,t,c);c.then(h,h)}})}function ms(t,a){var i=a.deletions;if(i!==null)for(var c=0;c<i.length;c++){var h=i[c],g=t,E=a,k=E;e:for(;k!==null;){switch(k.tag){case 27:if(Zr(k.type)){$t=k.stateNode,ps=!1;break e}break;case 5:$t=k.stateNode,ps=!1;break e;case 3:case 4:$t=k.stateNode.containerInfo,ps=!0;break e}k=k.return}if($t===null)throw Error(r(160));Mx(g,E,h),$t=null,ps=!1,g=h.alternate,g!==null&&(g.return=null),h.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Px(a,t),a=a.sibling}var ya=null;function Px(t,a){var i=t.alternate,c=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:ms(a,t),gs(t),c&4&&(Gr(3,t,t.return),dc(3,t),Gr(5,t,t.return));break;case 1:ms(a,t),gs(t),c&512&&(vn||i===null||Ba(i,i.return)),c&64&&dr&&(t=t.updateQueue,t!==null&&(c=t.callbacks,c!==null&&(i=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=i===null?c:i.concat(c))));break;case 26:var h=ya;if(ms(a,t),gs(t),c&512&&(vn||i===null||Ba(i,i.return)),c&4){var g=i!==null?i.memoizedState:null;if(c=t.memoizedState,i===null)if(c===null)if(t.stateNode===null){e:{c=t.type,i=t.memoizedProps,h=h.ownerDocument||h;t:switch(c){case"title":g=h.getElementsByTagName("title")[0],(!g||g[Bs]||g[en]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=h.createElement(c),h.head.insertBefore(g,h.querySelector("head > title"))),Hn(g,c,i),g[en]=t,tn(g),c=g;break e;case"link":var E=Pb("link","href",h).get(c+(i.href||""));if(E){for(var k=0;k<E.length;k++)if(g=E[k],g.getAttribute("href")===(i.href==null||i.href===""?null:i.href)&&g.getAttribute("rel")===(i.rel==null?null:i.rel)&&g.getAttribute("title")===(i.title==null?null:i.title)&&g.getAttribute("crossorigin")===(i.crossOrigin==null?null:i.crossOrigin)){E.splice(k,1);break t}}g=h.createElement(c),Hn(g,c,i),h.head.appendChild(g);break;case"meta":if(E=Pb("meta","content",h).get(c+(i.content||""))){for(k=0;k<E.length;k++)if(g=E[k],g.getAttribute("content")===(i.content==null?null:""+i.content)&&g.getAttribute("name")===(i.name==null?null:i.name)&&g.getAttribute("property")===(i.property==null?null:i.property)&&g.getAttribute("http-equiv")===(i.httpEquiv==null?null:i.httpEquiv)&&g.getAttribute("charset")===(i.charSet==null?null:i.charSet)){E.splice(k,1);break t}}g=h.createElement(c),Hn(g,c,i),h.head.appendChild(g);break;default:throw Error(r(468,c))}g[en]=t,tn(g),c=g}t.stateNode=c}else Vb(h,t.type,t.stateNode);else t.stateNode=Ub(h,c,t.memoizedProps);else g!==c?(g===null?i.stateNode!==null&&(i=i.stateNode,i.parentNode.removeChild(i)):g.count--,c===null?Vb(h,t.type,t.stateNode):Ub(h,c,t.memoizedProps)):c===null&&t.stateNode!==null&&tp(t,t.memoizedProps,i.memoizedProps)}break;case 27:ms(a,t),gs(t),c&512&&(vn||i===null||Ba(i,i.return)),i!==null&&c&4&&tp(t,t.memoizedProps,i.memoizedProps);break;case 5:if(ms(a,t),gs(t),c&512&&(vn||i===null||Ba(i,i.return)),t.flags&32){h=t.stateNode;try{Ln(h,"")}catch(Le){Ot(t,t.return,Le)}}c&4&&t.stateNode!=null&&(h=t.memoizedProps,tp(t,h,i!==null?i.memoizedProps:h)),c&1024&&(ap=!0);break;case 6:if(ms(a,t),gs(t),c&4){if(t.stateNode===null)throw Error(r(162));c=t.memoizedProps,i=t.stateNode;try{i.nodeValue=c}catch(Le){Ot(t,t.return,Le)}}break;case 3:if(Ad=null,h=ya,ya=Sd(a.containerInfo),ms(a,t),ya=h,gs(t),c&4&&i!==null&&i.memoizedState.isDehydrated)try{sl(a.containerInfo)}catch(Le){Ot(t,t.return,Le)}ap&&(ap=!1,Vx(t));break;case 4:c=ya,ya=Sd(t.stateNode.containerInfo),ms(a,t),gs(t),ya=c;break;case 12:ms(a,t),gs(t);break;case 31:ms(a,t),gs(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,ud(t,c)));break;case 13:ms(a,t),gs(t),t.child.flags&8192&&t.memoizedState!==null!=(i!==null&&i.memoizedState!==null)&&(fd=Ye()),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,ud(t,c)));break;case 22:h=t.memoizedState!==null;var q=i!==null&&i.memoizedState!==null,se=dr,me=vn;if(dr=se||h,vn=me||q,ms(a,t),vn=me,dr=se,gs(t),c&8192)e:for(a=t.stateNode,a._visibility=h?a._visibility&-2:a._visibility|1,h&&(i===null||q||dr||vn||qi(t)),i=null,a=t;;){if(a.tag===5||a.tag===26){if(i===null){q=i=a;try{if(g=q.stateNode,h)E=g.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{k=q.stateNode;var be=q.memoizedProps.style,re=be!=null&&be.hasOwnProperty("display")?be.display:null;k.style.display=re==null||typeof re=="boolean"?"":(""+re).trim()}}catch(Le){Ot(q,q.return,Le)}}}else if(a.tag===6){if(i===null){q=a;try{q.stateNode.nodeValue=h?"":q.memoizedProps}catch(Le){Ot(q,q.return,Le)}}}else if(a.tag===18){if(i===null){q=a;try{var fe=q.stateNode;h?Nb(fe,!0):Nb(q.stateNode,!1)}catch(Le){Ot(q,q.return,Le)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===t)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;a.sibling===null;){if(a.return===null||a.return===t)break e;i===a&&(i=null),a=a.return}i===a&&(i=null),a.sibling.return=a.return,a=a.sibling}c&4&&(c=t.updateQueue,c!==null&&(i=c.retryQueue,i!==null&&(c.retryQueue=null,ud(t,i))));break;case 19:ms(a,t),gs(t),c&4&&(c=t.updateQueue,c!==null&&(t.updateQueue=null,ud(t,c)));break;case 30:break;case 21:break;default:ms(a,t),gs(t)}}function gs(t){var a=t.flags;if(a&2){try{for(var i,c=t.return;c!==null;){if(Rx(c)){i=c;break}c=c.return}if(i==null)throw Error(r(160));switch(i.tag){case 27:var h=i.stateNode,g=np(t);cd(t,g,h);break;case 5:var E=i.stateNode;i.flags&32&&(Ln(E,""),i.flags&=-33);var k=np(t);cd(t,k,E);break;case 3:case 4:var q=i.stateNode.containerInfo,se=np(t);sp(t,se,q);break;default:throw Error(r(161))}}catch(me){Ot(t,t.return,me)}t.flags&=-3}a&4096&&(t.flags&=-4097)}function Vx(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var a=t;Vx(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),t=t.sibling}}function hr(t,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)kx(t,a.alternate,a),a=a.sibling}function qi(t){for(t=t.child;t!==null;){var a=t;switch(a.tag){case 0:case 11:case 14:case 15:Gr(4,a,a.return),qi(a);break;case 1:Ba(a,a.return);var i=a.stateNode;typeof i.componentWillUnmount=="function"&&Nx(a,a.return,i),qi(a);break;case 27:_c(a.stateNode);case 26:case 5:Ba(a,a.return),qi(a);break;case 22:a.memoizedState===null&&qi(a);break;case 30:qi(a);break;default:qi(a)}t=t.sibling}}function pr(t,a,i){for(i=i&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var c=a.alternate,h=t,g=a,E=g.flags;switch(g.tag){case 0:case 11:case 15:pr(h,g,i),dc(4,g);break;case 1:if(pr(h,g,i),c=g,h=c.stateNode,typeof h.componentDidMount=="function")try{h.componentDidMount()}catch(se){Ot(c,c.return,se)}if(c=g,h=c.updateQueue,h!==null){var k=c.stateNode;try{var q=h.shared.hiddenCallbacks;if(q!==null)for(h.shared.hiddenCallbacks=null,h=0;h<q.length;h++)gy(q[h],k)}catch(se){Ot(c,c.return,se)}}i&&E&64&&Ix(g),fc(g,g.return);break;case 27:Ox(g);case 26:case 5:pr(h,g,i),i&&c===null&&E&4&&Cx(g),fc(g,g.return);break;case 12:pr(h,g,i);break;case 31:pr(h,g,i),i&&E&4&&Dx(h,g);break;case 13:pr(h,g,i),i&&E&4&&Ux(h,g);break;case 22:g.memoizedState===null&&pr(h,g,i),fc(g,g.return);break;case 30:break;default:pr(h,g,i)}a=a.sibling}}function rp(t,a){var i=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),t=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(t=a.memoizedState.cachePool.pool),t!==i&&(t!=null&&t.refCount++,i!=null&&Xl(i))}function ip(t,a){t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&Xl(t))}function xa(t,a,i,c){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)zx(t,a,i,c),a=a.sibling}function zx(t,a,i,c){var h=a.flags;switch(a.tag){case 0:case 11:case 15:xa(t,a,i,c),h&2048&&dc(9,a);break;case 1:xa(t,a,i,c);break;case 3:xa(t,a,i,c),h&2048&&(t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&Xl(t)));break;case 12:if(h&2048){xa(t,a,i,c),t=a.stateNode;try{var g=a.memoizedProps,E=g.id,k=g.onPostCommit;typeof k=="function"&&k(E,a.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(q){Ot(a,a.return,q)}}else xa(t,a,i,c);break;case 31:xa(t,a,i,c);break;case 13:xa(t,a,i,c);break;case 23:break;case 22:g=a.stateNode,E=a.alternate,a.memoizedState!==null?g._visibility&2?xa(t,a,i,c):hc(t,a):g._visibility&2?xa(t,a,i,c):(g._visibility|=2,$o(t,a,i,c,(a.subtreeFlags&10256)!==0||!1)),h&2048&&rp(E,a);break;case 24:xa(t,a,i,c),h&2048&&ip(a.alternate,a);break;default:xa(t,a,i,c)}}function $o(t,a,i,c,h){for(h=h&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var g=t,E=a,k=i,q=c,se=E.flags;switch(E.tag){case 0:case 11:case 15:$o(g,E,k,q,h),dc(8,E);break;case 23:break;case 22:var me=E.stateNode;E.memoizedState!==null?me._visibility&2?$o(g,E,k,q,h):hc(g,E):(me._visibility|=2,$o(g,E,k,q,h)),h&&se&2048&&rp(E.alternate,E);break;case 24:$o(g,E,k,q,h),h&&se&2048&&ip(E.alternate,E);break;default:$o(g,E,k,q,h)}a=a.sibling}}function hc(t,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var i=t,c=a,h=c.flags;switch(c.tag){case 22:hc(i,c),h&2048&&rp(c.alternate,c);break;case 24:hc(i,c),h&2048&&ip(c.alternate,c);break;default:hc(i,c)}a=a.sibling}}var pc=8192;function Yo(t,a,i){if(t.subtreeFlags&pc)for(t=t.child;t!==null;)Bx(t,a,i),t=t.sibling}function Bx(t,a,i){switch(t.tag){case 26:Yo(t,a,i),t.flags&pc&&t.memoizedState!==null&&x2(i,ya,t.memoizedState,t.memoizedProps);break;case 5:Yo(t,a,i);break;case 3:case 4:var c=ya;ya=Sd(t.stateNode.containerInfo),Yo(t,a,i),ya=c;break;case 22:t.memoizedState===null&&(c=t.alternate,c!==null&&c.memoizedState!==null?(c=pc,pc=16777216,Yo(t,a,i),pc=c):Yo(t,a,i));break;default:Yo(t,a,i)}}function Fx(t){var a=t.alternate;if(a!==null&&(t=a.child,t!==null)){a.child=null;do a=t.sibling,t.sibling=null,t=a;while(t!==null)}}function mc(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var i=0;i<a.length;i++){var c=a[i];Mn=c,Gx(c,t)}Fx(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Hx(t),t=t.sibling}function Hx(t){switch(t.tag){case 0:case 11:case 15:mc(t),t.flags&2048&&Gr(9,t,t.return);break;case 3:mc(t);break;case 12:mc(t);break;case 22:var a=t.stateNode;t.memoizedState!==null&&a._visibility&2&&(t.return===null||t.return.tag!==13)?(a._visibility&=-3,dd(t)):mc(t);break;default:mc(t)}}function dd(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var i=0;i<a.length;i++){var c=a[i];Mn=c,Gx(c,t)}Fx(t)}for(t=t.child;t!==null;){switch(a=t,a.tag){case 0:case 11:case 15:Gr(8,a,a.return),dd(a);break;case 22:i=a.stateNode,i._visibility&2&&(i._visibility&=-3,dd(a));break;default:dd(a)}t=t.sibling}}function Gx(t,a){for(;Mn!==null;){var i=Mn;switch(i.tag){case 0:case 11:case 15:Gr(8,i,a);break;case 23:case 22:if(i.memoizedState!==null&&i.memoizedState.cachePool!==null){var c=i.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Xl(i.memoizedState.cache)}if(c=i.child,c!==null)c.return=i,Mn=c;else e:for(i=t;Mn!==null;){c=Mn;var h=c.sibling,g=c.return;if(Lx(c),c===i){Mn=null;break e}if(h!==null){h.return=g,Mn=h;break e}Mn=g}}}var kA={getCacheForType:function(t){var a=Bn(yn),i=a.data.get(t);return i===void 0&&(i=t(),a.data.set(t,i)),i},cacheSignal:function(){return Bn(yn).controller.signal}},LA=typeof WeakMap=="function"?WeakMap:Map,Nt=0,Pt=null,ot=null,ct=0,Rt=0,Rs=null,qr=!1,Qo=!1,op=!1,mr=0,an=0,$r=0,$i=0,lp=0,Os=0,Wo=0,gc=null,ys=null,cp=!1,fd=0,qx=0,hd=1/0,pd=null,Yr=null,An=0,Qr=null,Ko=null,gr=0,up=0,dp=null,$x=null,yc=0,fp=null;function js(){return(Nt&2)!==0&&ct!==0?ct&-ct:F.T!==null?xp():xo()}function Yx(){if(Os===0)if((ct&536870912)===0||ht){var t=zt;zt<<=1,(zt&3932160)===0&&(zt=262144),Os=t}else Os=536870912;return t=Ns.current,t!==null&&(t.flags|=32),Os}function xs(t,a,i){(t===Pt&&(Rt===2||Rt===9)||t.cancelPendingCommit!==null)&&(Zo(t,0),Wr(t,ct,Os,!1)),Ps(t,i),((Nt&2)===0||t!==Pt)&&(t===Pt&&((Nt&2)===0&&($i|=i),an===4&&Wr(t,ct,Os,!1)),Fa(t))}function Qx(t,a,i){if((Nt&6)!==0)throw Error(r(327));var c=!i&&(a&127)===0&&(a&t.expiredLanes)===0||Sn(t,a),h=c?UA(t,a):pp(t,a,!0),g=c;do{if(h===0){Qo&&!c&&Wr(t,a,0,!1);break}else{if(i=t.current.alternate,g&&!MA(i)){h=pp(t,a,!1),g=!1;continue}if(h===2){if(g=a,t.errorRecoveryDisabledLanes&g)var E=0;else E=t.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){a=E;e:{var k=t;h=gc;var q=k.current.memoizedState.isDehydrated;if(q&&(Zo(k,E).flags|=256),E=pp(k,E,!1),E!==2){if(op&&!q){k.errorRecoveryDisabledLanes|=g,$i|=g,h=4;break e}g=ys,ys=h,g!==null&&(ys===null?ys=g:ys.push.apply(ys,g))}h=E}if(g=!1,h!==2)continue}}if(h===1){Zo(t,0),Wr(t,a,0,!0);break}e:{switch(c=t,g=h,g){case 0:case 1:throw Error(r(345));case 4:if((a&4194048)!==a)break;case 6:Wr(c,a,Os,!qr);break e;case 2:ys=null;break;case 3:case 5:break;default:throw Error(r(329))}if((a&62914560)===a&&(h=fd+300-Ye(),10<h)){if(Wr(c,a,Os,!qr),on(c,0,!0)!==0)break e;gr=a,c.timeoutHandle=Tb(Wx.bind(null,c,i,ys,pd,cp,a,Os,$i,Wo,qr,g,"Throttled",-0,0),h);break e}Wx(c,i,ys,pd,cp,a,Os,$i,Wo,qr,g,null,-0,0)}}break}while(!0);Fa(t)}function Wx(t,a,i,c,h,g,E,k,q,se,me,be,re,fe){if(t.timeoutHandle=-1,be=a.subtreeFlags,be&8192||(be&16785408)===16785408){be={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:da},Bx(a,g,be);var Le=(g&62914560)===g?fd-Ye():(g&4194048)===g?qx-Ye():0;if(Le=b2(be,Le),Le!==null){gr=g,t.cancelPendingCommit=Le(sb.bind(null,t,a,g,i,c,h,E,k,q,me,be,null,re,fe)),Wr(t,g,E,!se);return}}sb(t,a,g,i,c,h,E,k,q)}function MA(t){for(var a=t;;){var i=a.tag;if((i===0||i===11||i===15)&&a.flags&16384&&(i=a.updateQueue,i!==null&&(i=i.stores,i!==null)))for(var c=0;c<i.length;c++){var h=i[c],g=h.getSnapshot;h=h.value;try{if(!As(g(),h))return!1}catch{return!1}}if(i=a.child,a.subtreeFlags&16384&&i!==null)i.return=a,a=i;else{if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Wr(t,a,i,c){a&=~lp,a&=~$i,t.suspendedLanes|=a,t.pingedLanes&=~a,c&&(t.warmLanes|=a),c=t.expirationTimes;for(var h=a;0<h;){var g=31-Be(h),E=1<<g;c[g]=-1,h&=~E}i!==0&&ca(t,i,a)}function md(){return(Nt&6)===0?(xc(0),!1):!0}function hp(){if(ot!==null){if(Rt===0)var t=ot.return;else t=ot,rr=Ui=null,Ch(t),Bo=null,ec=0,t=ot;for(;t!==null;)Ax(t.alternate,t),t=t.return;ot=null}}function Zo(t,a){var i=t.timeoutHandle;i!==-1&&(t.timeoutHandle=-1,t2(i)),i=t.cancelPendingCommit,i!==null&&(t.cancelPendingCommit=null,i()),gr=0,hp(),Pt=t,ot=i=sr(t.current,null),ct=a,Rt=0,Rs=null,qr=!1,Qo=Sn(t,a),op=!1,Wo=Os=lp=$i=$r=an=0,ys=gc=null,cp=!1,(a&8)!==0&&(a|=a&32);var c=t.entangledLanes;if(c!==0)for(t=t.entanglements,c&=a;0<c;){var h=31-Be(c),g=1<<h;a|=t[h],c&=~g}return mr=a,Du(),i}function Kx(t,a){st=null,F.H=lc,a===zo||a===Gu?(a=fy(),Rt=3):a===yh?(a=fy(),Rt=4):Rt=a===qh?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Rs=a,ot===null&&(an=1,ad(t,Ws(a,t.current)))}function Zx(){var t=Ns.current;return t===null?!0:(ct&4194048)===ct?Js===null:(ct&62914560)===ct||(ct&536870912)!==0?t===Js:!1}function Xx(){var t=F.H;return F.H=lc,t===null?lc:t}function Jx(){var t=F.A;return F.A=kA,t}function gd(){an=4,qr||(ct&4194048)!==ct&&Ns.current!==null||(Qo=!0),($r&134217727)===0&&($i&134217727)===0||Pt===null||Wr(Pt,ct,Os,!1)}function pp(t,a,i){var c=Nt;Nt|=2;var h=Xx(),g=Jx();(Pt!==t||ct!==a)&&(pd=null,Zo(t,a)),a=!1;var E=an;e:do try{if(Rt!==0&&ot!==null){var k=ot,q=Rs;switch(Rt){case 8:hp(),E=6;break e;case 3:case 2:case 9:case 6:Ns.current===null&&(a=!0);var se=Rt;if(Rt=0,Rs=null,Xo(t,k,q,se),i&&Qo){E=0;break e}break;default:se=Rt,Rt=0,Rs=null,Xo(t,k,q,se)}}DA(),E=an;break}catch(me){Kx(t,me)}while(!0);return a&&t.shellSuspendCounter++,rr=Ui=null,Nt=c,F.H=h,F.A=g,ot===null&&(Pt=null,ct=0,Du()),E}function DA(){for(;ot!==null;)eb(ot)}function UA(t,a){var i=Nt;Nt|=2;var c=Xx(),h=Jx();Pt!==t||ct!==a?(pd=null,hd=Ye()+500,Zo(t,a)):Qo=Sn(t,a);e:do try{if(Rt!==0&&ot!==null){a=ot;var g=Rs;t:switch(Rt){case 1:Rt=0,Rs=null,Xo(t,a,g,1);break;case 2:case 9:if(uy(g)){Rt=0,Rs=null,tb(a);break}a=function(){Rt!==2&&Rt!==9||Pt!==t||(Rt=7),Fa(t)},g.then(a,a);break e;case 3:Rt=7;break e;case 4:Rt=5;break e;case 7:uy(g)?(Rt=0,Rs=null,tb(a)):(Rt=0,Rs=null,Xo(t,a,g,7));break;case 5:var E=null;switch(ot.tag){case 26:E=ot.memoizedState;case 5:case 27:var k=ot;if(E?zb(E):k.stateNode.complete){Rt=0,Rs=null;var q=k.sibling;if(q!==null)ot=q;else{var se=k.return;se!==null?(ot=se,yd(se)):ot=null}break t}}Rt=0,Rs=null,Xo(t,a,g,5);break;case 6:Rt=0,Rs=null,Xo(t,a,g,6);break;case 8:hp(),an=6;break e;default:throw Error(r(462))}}PA();break}catch(me){Kx(t,me)}while(!0);return rr=Ui=null,F.H=c,F.A=h,Nt=i,ot!==null?0:(Pt=null,ct=0,Du(),an)}function PA(){for(;ot!==null&&!et();)eb(ot)}function eb(t){var a=Sx(t.alternate,t,mr);t.memoizedProps=t.pendingProps,a===null?yd(t):ot=a}function tb(t){var a=t,i=a.alternate;switch(a.tag){case 15:case 0:a=xx(i,a,a.pendingProps,a.type,void 0,ct);break;case 11:a=xx(i,a,a.pendingProps,a.type.render,a.ref,ct);break;case 5:Ch(a);default:Ax(i,a),a=ot=J0(a,mr),a=Sx(i,a,mr)}t.memoizedProps=t.pendingProps,a===null?yd(t):ot=a}function Xo(t,a,i,c){rr=Ui=null,Ch(a),Bo=null,ec=0;var h=a.return;try{if(AA(t,h,a,i,ct)){an=1,ad(t,Ws(i,t.current)),ot=null;return}}catch(g){if(h!==null)throw ot=h,g;an=1,ad(t,Ws(i,t.current)),ot=null;return}a.flags&32768?(ht||c===1?t=!0:Qo||(ct&536870912)!==0?t=!1:(qr=t=!0,(c===2||c===9||c===3||c===6)&&(c=Ns.current,c!==null&&c.tag===13&&(c.flags|=16384))),nb(a,t)):yd(a)}function yd(t){var a=t;do{if((a.flags&32768)!==0){nb(a,qr);return}t=a.return;var i=CA(a.alternate,a,mr);if(i!==null){ot=i;return}if(a=a.sibling,a!==null){ot=a;return}ot=a=t}while(a!==null);an===0&&(an=5)}function nb(t,a){do{var i=RA(t.alternate,t);if(i!==null){i.flags&=32767,ot=i;return}if(i=t.return,i!==null&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!a&&(t=t.sibling,t!==null)){ot=t;return}ot=t=i}while(t!==null);an=6,ot=null}function sb(t,a,i,c,h,g,E,k,q){t.cancelPendingCommit=null;do xd();while(An!==0);if((Nt&6)!==0)throw Error(r(327));if(a!==null){if(a===t.current)throw Error(r(177));if(g=a.lanes|a.childLanes,g|=nh,la(t,i,g,E,k,q),t===Pt&&(ot=Pt=null,ct=0),Ko=a,Qr=t,gr=i,up=g,dp=h,$x=c,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,FA(Ut,function(){return lb(),null})):(t.callbackNode=null,t.callbackPriority=0),c=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||c){c=F.T,F.T=null,h=ue.p,ue.p=2,E=Nt,Nt|=4;try{OA(t,a,i)}finally{Nt=E,ue.p=h,F.T=c}}An=1,ab(),rb(),ib()}}function ab(){if(An===1){An=0;var t=Qr,a=Ko,i=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||i){i=F.T,F.T=null;var c=ue.p;ue.p=2;var h=Nt;Nt|=4;try{Px(a,t);var g=Ap,E=G0(t.containerInfo),k=g.focusedElem,q=g.selectionRange;if(E!==k&&k&&k.ownerDocument&&H0(k.ownerDocument.documentElement,k)){if(q!==null&&Zf(k)){var se=q.start,me=q.end;if(me===void 0&&(me=se),"selectionStart"in k)k.selectionStart=se,k.selectionEnd=Math.min(me,k.value.length);else{var be=k.ownerDocument||document,re=be&&be.defaultView||window;if(re.getSelection){var fe=re.getSelection(),Le=k.textContent.length,Ge=Math.min(q.start,Le),Mt=q.end===void 0?Ge:Math.min(q.end,Le);!fe.extend&&Ge>Mt&&(E=Mt,Mt=Ge,Ge=E);var ee=F0(k,Ge),Z=F0(k,Mt);if(ee&&Z&&(fe.rangeCount!==1||fe.anchorNode!==ee.node||fe.anchorOffset!==ee.offset||fe.focusNode!==Z.node||fe.focusOffset!==Z.offset)){var ne=be.createRange();ne.setStart(ee.node,ee.offset),fe.removeAllRanges(),Ge>Mt?(fe.addRange(ne),fe.extend(Z.node,Z.offset)):(ne.setEnd(Z.node,Z.offset),fe.addRange(ne))}}}}for(be=[],fe=k;fe=fe.parentNode;)fe.nodeType===1&&be.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<be.length;k++){var ye=be[k];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}Rd=!!Tp,Ap=Tp=null}finally{Nt=h,ue.p=c,F.T=i}}t.current=a,An=2}}function rb(){if(An===2){An=0;var t=Qr,a=Ko,i=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||i){i=F.T,F.T=null;var c=ue.p;ue.p=2;var h=Nt;Nt|=4;try{kx(t,a.alternate,a)}finally{Nt=h,ue.p=c,F.T=i}}An=3}}function ib(){if(An===4||An===3){An=0,vt();var t=Qr,a=Ko,i=gr,c=$x;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?An=5:(An=0,Ko=Qr=null,ob(t,t.pendingLanes));var h=t.pendingLanes;if(h===0&&(Yr=null),Vs(i),a=a.stateNode,Oe&&typeof Oe.onCommitFiberRoot=="function")try{Oe.onCommitFiberRoot(ve,a,void 0,(a.current.flags&128)===128)}catch{}if(c!==null){a=F.T,h=ue.p,ue.p=2,F.T=null;try{for(var g=t.onRecoverableError,E=0;E<c.length;E++){var k=c[E];g(k.value,{componentStack:k.stack})}}finally{F.T=a,ue.p=h}}(gr&3)!==0&&xd(),Fa(t),h=t.pendingLanes,(i&261930)!==0&&(h&42)!==0?t===fp?yc++:(yc=0,fp=t):yc=0,xc(0)}}function ob(t,a){(t.pooledCacheLanes&=a)===0&&(a=t.pooledCache,a!=null&&(t.pooledCache=null,Xl(a)))}function xd(){return ab(),rb(),ib(),lb()}function lb(){if(An!==5)return!1;var t=Qr,a=up;up=0;var i=Vs(gr),c=F.T,h=ue.p;try{ue.p=32>i?32:i,F.T=null,i=dp,dp=null;var g=Qr,E=gr;if(An=0,Ko=Qr=null,gr=0,(Nt&6)!==0)throw Error(r(331));var k=Nt;if(Nt|=4,Hx(g.current),zx(g,g.current,E,i),Nt=k,xc(0,!1),Oe&&typeof Oe.onPostCommitFiberRoot=="function")try{Oe.onPostCommitFiberRoot(ve,g)}catch{}return!0}finally{ue.p=h,F.T=c,ob(t,a)}}function cb(t,a,i){a=Ws(i,a),a=Gh(t.stateNode,a,2),t=Br(t,a,2),t!==null&&(Ps(t,2),Fa(t))}function Ot(t,a,i){if(t.tag===3)cb(t,t,i);else for(;a!==null;){if(a.tag===3){cb(a,t,i);break}else if(a.tag===1){var c=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Yr===null||!Yr.has(c))){t=Ws(i,t),i=ux(2),c=Br(a,i,2),c!==null&&(dx(i,c,a,t),Ps(c,2),Fa(c));break}}a=a.return}}function mp(t,a,i){var c=t.pingCache;if(c===null){c=t.pingCache=new LA;var h=new Set;c.set(a,h)}else h=c.get(a),h===void 0&&(h=new Set,c.set(a,h));h.has(i)||(op=!0,h.add(i),t=VA.bind(null,t,a,i),a.then(t,t))}function VA(t,a,i){var c=t.pingCache;c!==null&&c.delete(a),t.pingedLanes|=t.suspendedLanes&i,t.warmLanes&=~i,Pt===t&&(ct&i)===i&&(an===4||an===3&&(ct&62914560)===ct&&300>Ye()-fd?(Nt&2)===0&&Zo(t,0):lp|=i,Wo===ct&&(Wo=0)),Fa(t)}function ub(t,a){a===0&&(a=jn()),t=Li(t,a),t!==null&&(Ps(t,a),Fa(t))}function zA(t){var a=t.memoizedState,i=0;a!==null&&(i=a.retryLane),ub(t,i)}function BA(t,a){var i=0;switch(t.tag){case 31:case 13:var c=t.stateNode,h=t.memoizedState;h!==null&&(i=h.retryLane);break;case 19:c=t.stateNode;break;case 22:c=t.stateNode._retryCache;break;default:throw Error(r(314))}c!==null&&c.delete(a),ub(t,i)}function FA(t,a){return oe(t,a)}var bd=null,Jo=null,gp=!1,vd=!1,yp=!1,Kr=0;function Fa(t){t!==Jo&&t.next===null&&(Jo===null?bd=Jo=t:Jo=Jo.next=t),vd=!0,gp||(gp=!0,GA())}function xc(t,a){if(!yp&&vd){yp=!0;do for(var i=!1,c=bd;c!==null;){if(t!==0){var h=c.pendingLanes;if(h===0)var g=0;else{var E=c.suspendedLanes,k=c.pingedLanes;g=(1<<31-Be(42|t)+1)-1,g&=h&~(E&~k),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(i=!0,pb(c,g))}else g=ct,g=on(c,c===Pt?g:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(g&3)===0||Sn(c,g)||(i=!0,pb(c,g));c=c.next}while(i);yp=!1}}function HA(){db()}function db(){vd=gp=!1;var t=0;Kr!==0&&e2()&&(t=Kr);for(var a=Ye(),i=null,c=bd;c!==null;){var h=c.next,g=fb(c,a);g===0?(c.next=null,i===null?bd=h:i.next=h,h===null&&(Jo=i)):(i=c,(t!==0||(g&3)!==0)&&(vd=!0)),c=h}An!==0&&An!==5||xc(t),Kr!==0&&(Kr=0)}function fb(t,a){for(var i=t.suspendedLanes,c=t.pingedLanes,h=t.expirationTimes,g=t.pendingLanes&-62914561;0<g;){var E=31-Be(g),k=1<<E,q=h[E];q===-1?((k&i)===0||(k&c)!==0)&&(h[E]=oa(k,a)):q<=a&&(t.expiredLanes|=k),g&=~k}if(a=Pt,i=ct,i=on(t,t===a?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c=t.callbackNode,i===0||t===a&&(Rt===2||Rt===9)||t.cancelPendingCommit!==null)return c!==null&&c!==null&&ze(c),t.callbackNode=null,t.callbackPriority=0;if((i&3)===0||Sn(t,i)){if(a=i&-i,a===t.callbackPriority)return a;switch(c!==null&&ze(c),Vs(i)){case 2:case 8:i=St;break;case 32:i=Ut;break;case 268435456:i=Us;break;default:i=Ut}return c=hb.bind(null,t),i=oe(i,c),t.callbackPriority=a,t.callbackNode=i,a}return c!==null&&c!==null&&ze(c),t.callbackPriority=2,t.callbackNode=null,2}function hb(t,a){if(An!==0&&An!==5)return t.callbackNode=null,t.callbackPriority=0,null;var i=t.callbackNode;if(xd()&&t.callbackNode!==i)return null;var c=ct;return c=on(t,t===Pt?c:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),c===0?null:(Qx(t,c,a),fb(t,Ye()),t.callbackNode!=null&&t.callbackNode===i?hb.bind(null,t):null)}function pb(t,a){if(xd())return null;Qx(t,a,!0)}function GA(){n2(function(){(Nt&6)!==0?oe(it,HA):db()})}function xp(){if(Kr===0){var t=Po;t===0&&(t=ft,ft<<=1,(ft&261888)===0&&(ft=256)),Kr=t}return Kr}function mb(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:wo(""+t)}function gb(t,a){var i=a.ownerDocument.createElement("input");return i.name=a.name,i.value=a.value,t.id&&i.setAttribute("form",t.id),a.parentNode.insertBefore(i,a),t=new FormData(t),i.parentNode.removeChild(i),t}function qA(t,a,i,c,h){if(a==="submit"&&i&&i.stateNode===h){var g=mb((h[mn]||null).action),E=c.submitter;E&&(a=(a=E[mn]||null)?mb(a.formAction):E.getAttribute("formAction"),a!==null&&(g=a,E=null));var k=new Ma("action","action",null,c,h);t.push({event:k,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Kr!==0){var q=E?gb(h,E):new FormData(h);Ph(i,{pending:!0,data:q,method:h.method,action:g},null,q)}}else typeof g=="function"&&(k.preventDefault(),q=E?gb(h,E):new FormData(h),Ph(i,{pending:!0,data:q,method:h.method,action:g},g,q))},currentTarget:h}]})}}for(var bp=0;bp<th.length;bp++){var vp=th[bp],$A=vp.toLowerCase(),YA=vp[0].toUpperCase()+vp.slice(1);ga($A,"on"+YA)}ga(Y0,"onAnimationEnd"),ga(Q0,"onAnimationIteration"),ga(W0,"onAnimationStart"),ga("dblclick","onDoubleClick"),ga("focusin","onFocus"),ga("focusout","onBlur"),ga(cA,"onTransitionRun"),ga(uA,"onTransitionStart"),ga(dA,"onTransitionCancel"),ga(K0,"onTransitionEnd"),Gs("onMouseEnter",["mouseout","mouseover"]),Gs("onMouseLeave",["mouseout","mouseover"]),Gs("onPointerEnter",["pointerout","pointerover"]),Gs("onPointerLeave",["pointerout","pointerover"]),Hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Hs("onBeforeInput",["compositionend","keypress","textInput","paste"]),Hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(bc));function yb(t,a){a=(a&4)!==0;for(var i=0;i<t.length;i++){var c=t[i],h=c.event;c=c.listeners;e:{var g=void 0;if(a)for(var E=c.length-1;0<=E;E--){var k=c[E],q=k.instance,se=k.currentTarget;if(k=k.listener,q!==g&&h.isPropagationStopped())break e;g=k,h.currentTarget=se;try{g(h)}catch(me){Mu(me)}h.currentTarget=null,g=q}else for(E=0;E<c.length;E++){if(k=c[E],q=k.instance,se=k.currentTarget,k=k.listener,q!==g&&h.isPropagationStopped())break e;g=k,h.currentTarget=se;try{g(h)}catch(me){Mu(me)}h.currentTarget=null,g=q}}}}function lt(t,a){var i=a[Ir];i===void 0&&(i=a[Ir]=new Set);var c=t+"__bubble";i.has(c)||(xb(a,t,2,!1),i.add(c))}function _p(t,a,i){var c=0;a&&(c|=4),xb(i,t,c,a)}var _d="_reactListening"+Math.random().toString(36).slice(2);function Ep(t){if(!t[_d]){t[_d]=!0,vi.forEach(function(i){i!=="selectionchange"&&(QA.has(i)||_p(i,!1,t),_p(i,!0,t))});var a=t.nodeType===9?t:t.ownerDocument;a===null||a[_d]||(a[_d]=!0,_p("selectionchange",!1,a))}}function xb(t,a,i,c){switch(Yb(a)){case 2:var h=E2;break;case 8:h=w2;break;default:h=Up}i=h.bind(null,a,i,t),h=void 0,!Ai||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(h=!0),c?h!==void 0?t.addEventListener(a,i,{capture:!0,passive:h}):t.addEventListener(a,i,!0):h!==void 0?t.addEventListener(a,i,{passive:h}):t.addEventListener(a,i,!1)}function wp(t,a,i,c,h){var g=c;if((a&1)===0&&(a&2)===0&&c!==null)e:for(;;){if(c===null)return;var E=c.tag;if(E===3||E===4){var k=c.stateNode.containerInfo;if(k===h)break;if(E===4)for(E=c.return;E!==null;){var q=E.tag;if((q===3||q===4)&&E.stateNode.containerInfo===h)return;E=E.return}for(;k!==null;){if(E=Ts(k),E===null)return;if(q=E.tag,q===5||q===6||q===26||q===27){c=g=E;continue e}k=k.parentNode}}c=c.return}Or(function(){var se=g,me=qs(i),be=[];e:{var re=Z0.get(t);if(re!==void 0){var fe=Ma,Le=t;switch(t){case"keypress":if(Ni(i)===0)break e;case"keydown":case"keyup":fe=ju;break;case"focusin":Le="focus",fe=Ri;break;case"focusout":Le="blur",fe=Ri;break;case"beforeblur":case"afterblur":fe=Ri;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=Gl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=wu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=b;break;case Y0:case Q0:case W0:fe=Tu;break;case K0:fe=U;break;case"scroll":case"scrollend":fe=Hl;break;case"wheel":fe=ce;break;case"copy":case"cut":case"paste":fe=Au;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=nr;break;case"toggle":case"beforetoggle":fe=nt}var Ge=(a&4)!==0,Mt=!Ge&&(t==="scroll"||t==="scrollend"),ee=Ge?re!==null?re+"Capture":null:re;Ge=[];for(var Z=se,ne;Z!==null;){var ye=Z;if(ne=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||ne===null||ee===null||(ye=fa(Z,ee),ye!=null&&Ge.push(vc(Z,ye,ne))),Mt)break;Z=Z.return}0<Ge.length&&(re=new fe(re,Le,null,i,me),be.push({event:re,listeners:Ge}))}}if((a&7)===0){e:{if(re=t==="mouseover"||t==="pointerover",fe=t==="mouseout"||t==="pointerout",re&&i!==zl&&(Le=i.relatedTarget||i.fromElement)&&(Ts(Le)||Le[zs]))break e;if((fe||re)&&(re=me.window===me?me:(re=me.ownerDocument)?re.defaultView||re.parentWindow:window,fe?(Le=i.relatedTarget||i.toElement,fe=se,Le=Le?Ts(Le):null,Le!==null&&(Mt=l(Le),Ge=Le.tag,Le!==Mt||Ge!==5&&Ge!==27&&Ge!==6)&&(Le=null)):(fe=null,Le=se),fe!==Le)){if(Ge=Gl,ye="onMouseLeave",ee="onMouseEnter",Z="mouse",(t==="pointerout"||t==="pointerover")&&(Ge=nr,ye="onPointerLeave",ee="onPointerEnter",Z="pointer"),Mt=fe==null?re:ns(fe),ne=Le==null?re:ns(Le),re=new Ge(ye,Z+"leave",fe,i,me),re.target=Mt,re.relatedTarget=ne,ye=null,Ts(me)===se&&(Ge=new Ge(ee,Z+"enter",Le,i,me),Ge.target=ne,Ge.relatedTarget=Mt,ye=Ge),Mt=ye,fe&&Le)t:{for(Ge=WA,ee=fe,Z=Le,ne=0,ye=ee;ye;ye=Ge(ye))ne++;ye=0;for(var Fe=Z;Fe;Fe=Ge(Fe))ye++;for(;0<ne-ye;)ee=Ge(ee),ne--;for(;0<ye-ne;)Z=Ge(Z),ye--;for(;ne--;){if(ee===Z||Z!==null&&ee===Z.alternate){Ge=ee;break t}ee=Ge(ee),Z=Ge(Z)}Ge=null}else Ge=null;fe!==null&&bb(be,re,fe,Ge,!1),Le!==null&&Mt!==null&&bb(be,Mt,Le,Ge,!0)}}e:{if(re=se?ns(se):window,fe=re.nodeName&&re.nodeName.toLowerCase(),fe==="select"||fe==="input"&&re.type==="file")var _t=D0;else if(L0(re))if(U0)_t=iA;else{_t=aA;var De=sA}else fe=re.nodeName,!fe||fe.toLowerCase()!=="input"||re.type!=="checkbox"&&re.type!=="radio"?se&&Eo(se.elementType)&&(_t=D0):_t=rA;if(_t&&(_t=_t(t,se))){M0(be,_t,i,me);break e}De&&De(t,re,se),t==="focusout"&&se&&re.type==="number"&&se.memoizedProps.value!=null&&nn(re,"number",re.value)}switch(De=se?ns(se):window,t){case"focusin":(L0(De)||De.contentEditable==="true")&&(Ro=De,Xf=se,Wl=null);break;case"focusout":Wl=Xf=Ro=null;break;case"mousedown":Jf=!0;break;case"contextmenu":case"mouseup":case"dragend":Jf=!1,q0(be,i,me);break;case"selectionchange":if(lA)break;case"keydown":case"keyup":q0(be,i,me)}var at;if(It)e:{switch(t){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else Co?Oi(t,i)&&(ut="onCompositionEnd"):t==="keydown"&&i.keyCode===229&&(ut="onCompositionStart");ut&&(Pa&&i.locale!=="ko"&&(Co||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&Co&&(at=Fl()):(La=me,Bl="value"in La?La.value:La.textContent,Co=!0)),De=Ed(se,ut),0<De.length&&(ut=new Ua(ut,t,null,i,me),be.push({event:ut,listeners:De}),at?ut.data=at:(at=No(i),at!==null&&(ut.data=at)))),(at=Ys?JT(t,i):eA(t,i))&&(ut=Ed(se,"onBeforeInput"),0<ut.length&&(De=new Ua("onBeforeInput","beforeinput",null,i,me),be.push({event:De,listeners:ut}),De.data=at)),qA(be,t,se,i,me)}yb(be,a)})}function vc(t,a,i){return{instance:t,listener:a,currentTarget:i}}function Ed(t,a){for(var i=a+"Capture",c=[];t!==null;){var h=t,g=h.stateNode;if(h=h.tag,h!==5&&h!==26&&h!==27||g===null||(h=fa(t,i),h!=null&&c.unshift(vc(t,h,g)),h=fa(t,a),h!=null&&c.push(vc(t,h,g))),t.tag===3)return c;t=t.return}return[]}function WA(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function bb(t,a,i,c,h){for(var g=a._reactName,E=[];i!==null&&i!==c;){var k=i,q=k.alternate,se=k.stateNode;if(k=k.tag,q!==null&&q===c)break;k!==5&&k!==26&&k!==27||se===null||(q=se,h?(se=fa(i,g),se!=null&&E.unshift(vc(i,se,q))):h||(se=fa(i,g),se!=null&&E.push(vc(i,se,q)))),i=i.return}E.length!==0&&t.push({event:a,listeners:E})}var KA=/\r\n?/g,ZA=/\u0000|\uFFFD/g;function vb(t){return(typeof t=="string"?t:""+t).replace(KA,`
`).replace(ZA,"")}function _b(t,a){return a=vb(a),vb(t)===a}function Lt(t,a,i,c,h,g){switch(i){case"children":typeof c=="string"?a==="body"||a==="textarea"&&c===""||Ln(t,c):(typeof c=="number"||typeof c=="bigint")&&a!=="body"&&Ln(t,""+c);break;case"className":hs(t,"class",c);break;case"tabIndex":hs(t,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":hs(t,i,c);break;case"style":Vl(t,c,g);break;case"data":if(a!=="object"){hs(t,"data",c);break}case"src":case"href":if(c===""&&(a!=="a"||i!=="href")){t.removeAttribute(i);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(i);break}c=wo(""+c),t.setAttribute(i,c);break;case"action":case"formAction":if(typeof c=="function"){t.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(i==="formAction"?(a!=="input"&&Lt(t,a,"name",h.name,h,null),Lt(t,a,"formEncType",h.formEncType,h,null),Lt(t,a,"formMethod",h.formMethod,h,null),Lt(t,a,"formTarget",h.formTarget,h,null)):(Lt(t,a,"encType",h.encType,h,null),Lt(t,a,"method",h.method,h,null),Lt(t,a,"target",h.target,h,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){t.removeAttribute(i);break}c=wo(""+c),t.setAttribute(i,c);break;case"onClick":c!=null&&(t.onclick=da);break;case"onScroll":c!=null&&lt("scroll",t);break;case"onScrollEnd":c!=null&&lt("scrollend",t);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(i=c.__html,i!=null){if(h.children!=null)throw Error(r(60));t.innerHTML=i}}break;case"multiple":t.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":t.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){t.removeAttribute("xlink:href");break}i=wo(""+c),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(i,""+c):t.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(i,""):t.removeAttribute(i);break;case"capture":case"download":c===!0?t.setAttribute(i,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?t.setAttribute(i,c):t.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?t.setAttribute(i,c):t.removeAttribute(i);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?t.removeAttribute(i):t.setAttribute(i,c);break;case"popover":lt("beforetoggle",t),lt("toggle",t),Xa(t,"popover",c);break;case"xlinkActuate":ln(t,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":ln(t,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":ln(t,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":ln(t,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":ln(t,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":ln(t,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":ln(t,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":ln(t,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":ln(t,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Xa(t,"is",c);break;case"innerText":case"textContent":break;default:(!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(i=Eu.get(i)||i,Xa(t,i,c))}}function Sp(t,a,i,c,h,g){switch(i){case"style":Vl(t,c,g);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(i=c.__html,i!=null){if(h.children!=null)throw Error(r(60));t.innerHTML=i}}break;case"children":typeof c=="string"?Ln(t,c):(typeof c=="number"||typeof c=="bigint")&&Ln(t,""+c);break;case"onScroll":c!=null&&lt("scroll",t);break;case"onScrollEnd":c!=null&&lt("scrollend",t);break;case"onClick":c!=null&&(t.onclick=da);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!_i.hasOwnProperty(i))e:{if(i[0]==="o"&&i[1]==="n"&&(h=i.endsWith("Capture"),a=i.slice(2,h?i.length-7:void 0),g=t[mn]||null,g=g!=null?g[i]:null,typeof g=="function"&&t.removeEventListener(a,g,h),typeof c=="function")){typeof g!="function"&&g!==null&&(i in t?t[i]=null:t.hasAttribute(i)&&t.removeAttribute(i)),t.addEventListener(a,c,h);break e}i in t?t[i]=c:c===!0?t.setAttribute(i,""):Xa(t,i,c)}}}function Hn(t,a,i){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":lt("error",t),lt("load",t);var c=!1,h=!1,g;for(g in i)if(i.hasOwnProperty(g)){var E=i[g];if(E!=null)switch(g){case"src":c=!0;break;case"srcSet":h=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:Lt(t,a,g,E,i,null)}}h&&Lt(t,a,"srcSet",i.srcSet,i,null),c&&Lt(t,a,"src",i.src,i,null);return;case"input":lt("invalid",t);var k=g=E=h=null,q=null,se=null;for(c in i)if(i.hasOwnProperty(c)){var me=i[c];if(me!=null)switch(c){case"name":h=me;break;case"type":E=me;break;case"checked":q=me;break;case"defaultChecked":se=me;break;case"value":g=me;break;case"defaultValue":k=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(r(137,a));break;default:Lt(t,a,c,me,i,null)}}Yn(t,g,k,q,se,E,h,!1);return;case"select":lt("invalid",t),c=E=g=null;for(h in i)if(i.hasOwnProperty(h)&&(k=i[h],k!=null))switch(h){case"value":g=k;break;case"defaultValue":E=k;break;case"multiple":c=k;default:Lt(t,a,h,k,i,null)}a=g,i=E,t.multiple=!!c,a!=null?gn(t,!!c,a,!1):i!=null&&gn(t,!!c,i,!0);return;case"textarea":lt("invalid",t),g=h=c=null;for(E in i)if(i.hasOwnProperty(E)&&(k=i[E],k!=null))switch(E){case"value":c=k;break;case"defaultValue":h=k;break;case"children":g=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(r(91));break;default:Lt(t,a,E,k,i,null)}ss(t,c,h,g);return;case"option":for(q in i)if(i.hasOwnProperty(q)&&(c=i[q],c!=null))switch(q){case"selected":t.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:Lt(t,a,q,c,i,null)}return;case"dialog":lt("beforetoggle",t),lt("toggle",t),lt("cancel",t),lt("close",t);break;case"iframe":case"object":lt("load",t);break;case"video":case"audio":for(c=0;c<bc.length;c++)lt(bc[c],t);break;case"image":lt("error",t),lt("load",t);break;case"details":lt("toggle",t);break;case"embed":case"source":case"link":lt("error",t),lt("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in i)if(i.hasOwnProperty(se)&&(c=i[se],c!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,a));default:Lt(t,a,se,c,i,null)}return;default:if(Eo(a)){for(me in i)i.hasOwnProperty(me)&&(c=i[me],c!==void 0&&Sp(t,a,me,c,i,void 0));return}}for(k in i)i.hasOwnProperty(k)&&(c=i[k],c!=null&&Lt(t,a,k,c,i,null))}function XA(t,a,i,c){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var h=null,g=null,E=null,k=null,q=null,se=null,me=null;for(fe in i){var be=i[fe];if(i.hasOwnProperty(fe)&&be!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":q=be;default:c.hasOwnProperty(fe)||Lt(t,a,fe,null,c,be)}}for(var re in c){var fe=c[re];if(be=i[re],c.hasOwnProperty(re)&&(fe!=null||be!=null))switch(re){case"type":g=fe;break;case"name":h=fe;break;case"checked":se=fe;break;case"defaultChecked":me=fe;break;case"value":E=fe;break;case"defaultValue":k=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,a));break;default:fe!==be&&Lt(t,a,re,fe,c,be)}}At(t,E,k,q,se,me,g,h);return;case"select":fe=E=k=re=null;for(g in i)if(q=i[g],i.hasOwnProperty(g)&&q!=null)switch(g){case"value":break;case"multiple":fe=q;default:c.hasOwnProperty(g)||Lt(t,a,g,null,c,q)}for(h in c)if(g=c[h],q=i[h],c.hasOwnProperty(h)&&(g!=null||q!=null))switch(h){case"value":re=g;break;case"defaultValue":k=g;break;case"multiple":E=g;default:g!==q&&Lt(t,a,h,g,c,q)}a=k,i=E,c=fe,re!=null?gn(t,!!i,re,!1):!!c!=!!i&&(a!=null?gn(t,!!i,a,!0):gn(t,!!i,i?[]:"",!1));return;case"textarea":fe=re=null;for(k in i)if(h=i[k],i.hasOwnProperty(k)&&h!=null&&!c.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:Lt(t,a,k,null,c,h)}for(E in c)if(h=c[E],g=i[E],c.hasOwnProperty(E)&&(h!=null||g!=null))switch(E){case"value":re=h;break;case"defaultValue":fe=h;break;case"children":break;case"dangerouslySetInnerHTML":if(h!=null)throw Error(r(91));break;default:h!==g&&Lt(t,a,E,h,c,g)}ua(t,re,fe);return;case"option":for(var Le in i)if(re=i[Le],i.hasOwnProperty(Le)&&re!=null&&!c.hasOwnProperty(Le))switch(Le){case"selected":t.selected=!1;break;default:Lt(t,a,Le,null,c,re)}for(q in c)if(re=c[q],fe=i[q],c.hasOwnProperty(q)&&re!==fe&&(re!=null||fe!=null))switch(q){case"selected":t.selected=re&&typeof re!="function"&&typeof re!="symbol";break;default:Lt(t,a,q,re,c,fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ge in i)re=i[Ge],i.hasOwnProperty(Ge)&&re!=null&&!c.hasOwnProperty(Ge)&&Lt(t,a,Ge,null,c,re);for(se in c)if(re=c[se],fe=i[se],c.hasOwnProperty(se)&&re!==fe&&(re!=null||fe!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(r(137,a));break;default:Lt(t,a,se,re,c,fe)}return;default:if(Eo(a)){for(var Mt in i)re=i[Mt],i.hasOwnProperty(Mt)&&re!==void 0&&!c.hasOwnProperty(Mt)&&Sp(t,a,Mt,void 0,c,re);for(me in c)re=c[me],fe=i[me],!c.hasOwnProperty(me)||re===fe||re===void 0&&fe===void 0||Sp(t,a,me,re,c,fe);return}}for(var ee in i)re=i[ee],i.hasOwnProperty(ee)&&re!=null&&!c.hasOwnProperty(ee)&&Lt(t,a,ee,null,c,re);for(be in c)re=c[be],fe=i[be],!c.hasOwnProperty(be)||re===fe||re==null&&fe==null||Lt(t,a,be,re,c,fe)}function Eb(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function JA(){if(typeof performance.getEntriesByType=="function"){for(var t=0,a=0,i=performance.getEntriesByType("resource"),c=0;c<i.length;c++){var h=i[c],g=h.transferSize,E=h.initiatorType,k=h.duration;if(g&&k&&Eb(E)){for(E=0,k=h.responseEnd,c+=1;c<i.length;c++){var q=i[c],se=q.startTime;if(se>k)break;var me=q.transferSize,be=q.initiatorType;me&&Eb(be)&&(q=q.responseEnd,E+=me*(q<k?1:(k-se)/(q-se)))}if(--c,a+=8*(g+E)/(h.duration/1e3),t++,10<t)break}}if(0<t)return a/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var Tp=null,Ap=null;function wd(t){return t.nodeType===9?t:t.ownerDocument}function wb(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Sb(t,a){if(t===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&a==="foreignObject"?0:t}function Ip(t,a){return t==="textarea"||t==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Np=null;function e2(){var t=window.event;return t&&t.type==="popstate"?t===Np?!1:(Np=t,!0):(Np=null,!1)}var Tb=typeof setTimeout=="function"?setTimeout:void 0,t2=typeof clearTimeout=="function"?clearTimeout:void 0,Ab=typeof Promise=="function"?Promise:void 0,n2=typeof queueMicrotask=="function"?queueMicrotask:typeof Ab<"u"?function(t){return Ab.resolve(null).then(t).catch(s2)}:Tb;function s2(t){setTimeout(function(){throw t})}function Zr(t){return t==="head"}function Ib(t,a){var i=a,c=0;do{var h=i.nextSibling;if(t.removeChild(i),h&&h.nodeType===8)if(i=h.data,i==="/$"||i==="/&"){if(c===0){t.removeChild(h),sl(a);return}c--}else if(i==="$"||i==="$?"||i==="$~"||i==="$!"||i==="&")c++;else if(i==="html")_c(t.ownerDocument.documentElement);else if(i==="head"){i=t.ownerDocument.head,_c(i);for(var g=i.firstChild;g;){var E=g.nextSibling,k=g.nodeName;g[Bs]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&g.rel.toLowerCase()==="stylesheet"||i.removeChild(g),g=E}}else i==="body"&&_c(t.ownerDocument.body);i=h}while(i);sl(a)}function Nb(t,a){var i=t;t=0;do{var c=i.nextSibling;if(i.nodeType===1?a?(i._stashedDisplay=i.style.display,i.style.display="none"):(i.style.display=i._stashedDisplay||"",i.getAttribute("style")===""&&i.removeAttribute("style")):i.nodeType===3&&(a?(i._stashedText=i.nodeValue,i.nodeValue=""):i.nodeValue=i._stashedText||""),c&&c.nodeType===8)if(i=c.data,i==="/$"){if(t===0)break;t--}else i!=="$"&&i!=="$?"&&i!=="$~"&&i!=="$!"||t++;i=c}while(i)}function Cp(t){var a=t.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var i=a;switch(a=a.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":Cp(i),Nr(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(i.rel.toLowerCase()==="stylesheet")continue}t.removeChild(i)}}function a2(t,a,i,c){for(;t.nodeType===1;){var h=i;if(t.nodeName.toLowerCase()!==a.toLowerCase()){if(!c&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(c){if(!t[Bs])switch(a){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(g=t.getAttribute("rel"),g==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(g!==h.rel||t.getAttribute("href")!==(h.href==null||h.href===""?null:h.href)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin)||t.getAttribute("title")!==(h.title==null?null:h.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(g=t.getAttribute("src"),(g!==(h.src==null?null:h.src)||t.getAttribute("type")!==(h.type==null?null:h.type)||t.getAttribute("crossorigin")!==(h.crossOrigin==null?null:h.crossOrigin))&&g&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(a==="input"&&t.type==="hidden"){var g=h.name==null?null:""+h.name;if(h.type==="hidden"&&t.getAttribute("name")===g)return t}else return t;if(t=ea(t.nextSibling),t===null)break}return null}function r2(t,a,i){if(a==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!i||(t=ea(t.nextSibling),t===null))return null;return t}function Cb(t,a){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!a||(t=ea(t.nextSibling),t===null))return null;return t}function Rp(t){return t.data==="$?"||t.data==="$~"}function Op(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function i2(t,a){var i=t.ownerDocument;if(t.data==="$~")t._reactRetry=a;else if(t.data!=="$?"||i.readyState!=="loading")a();else{var c=function(){a(),i.removeEventListener("DOMContentLoaded",c)};i.addEventListener("DOMContentLoaded",c),t._reactRetry=c}}function ea(t){for(;t!=null;t=t.nextSibling){var a=t.nodeType;if(a===1||a===3)break;if(a===8){if(a=t.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return t}var jp=null;function Rb(t){t=t.nextSibling;for(var a=0;t;){if(t.nodeType===8){var i=t.data;if(i==="/$"||i==="/&"){if(a===0)return ea(t.nextSibling);a--}else i!=="$"&&i!=="$!"&&i!=="$?"&&i!=="$~"&&i!=="&"||a++}t=t.nextSibling}return null}function Ob(t){t=t.previousSibling;for(var a=0;t;){if(t.nodeType===8){var i=t.data;if(i==="$"||i==="$!"||i==="$?"||i==="$~"||i==="&"){if(a===0)return t;a--}else i!=="/$"&&i!=="/&"||a++}t=t.previousSibling}return null}function jb(t,a,i){switch(a=wd(i),t){case"html":if(t=a.documentElement,!t)throw Error(r(452));return t;case"head":if(t=a.head,!t)throw Error(r(453));return t;case"body":if(t=a.body,!t)throw Error(r(454));return t;default:throw Error(r(451))}}function _c(t){for(var a=t.attributes;a.length;)t.removeAttributeNode(a[0]);Nr(t)}var ta=new Map,kb=new Set;function Sd(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var yr=ue.d;ue.d={f:o2,r:l2,D:c2,C:u2,L:d2,m:f2,X:p2,S:h2,M:m2};function o2(){var t=yr.f(),a=md();return t||a}function l2(t){var a=fs(t);a!==null&&a.tag===5&&a.type==="form"?Ky(a):yr.r(t)}var el=typeof document>"u"?null:document;function Lb(t,a,i){var c=el;if(c&&typeof a=="string"&&a){var h=Ze(a);h='link[rel="'+t+'"][href="'+h+'"]',typeof i=="string"&&(h+='[crossorigin="'+i+'"]'),kb.has(h)||(kb.add(h),t={rel:t,crossOrigin:i,href:a},c.querySelector(h)===null&&(a=c.createElement("link"),Hn(a,"link",t),tn(a),c.head.appendChild(a)))}}function c2(t){yr.D(t),Lb("dns-prefetch",t,null)}function u2(t,a){yr.C(t,a),Lb("preconnect",t,a)}function d2(t,a,i){yr.L(t,a,i);var c=el;if(c&&t&&a){var h='link[rel="preload"][as="'+Ze(a)+'"]';a==="image"&&i&&i.imageSrcSet?(h+='[imagesrcset="'+Ze(i.imageSrcSet)+'"]',typeof i.imageSizes=="string"&&(h+='[imagesizes="'+Ze(i.imageSizes)+'"]')):h+='[href="'+Ze(t)+'"]';var g=h;switch(a){case"style":g=tl(t);break;case"script":g=nl(t)}ta.has(g)||(t=v({rel:"preload",href:a==="image"&&i&&i.imageSrcSet?void 0:t,as:a},i),ta.set(g,t),c.querySelector(h)!==null||a==="style"&&c.querySelector(Ec(g))||a==="script"&&c.querySelector(wc(g))||(a=c.createElement("link"),Hn(a,"link",t),tn(a),c.head.appendChild(a)))}}function f2(t,a){yr.m(t,a);var i=el;if(i&&t){var c=a&&typeof a.as=="string"?a.as:"script",h='link[rel="modulepreload"][as="'+Ze(c)+'"][href="'+Ze(t)+'"]',g=h;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=nl(t)}if(!ta.has(g)&&(t=v({rel:"modulepreload",href:t},a),ta.set(g,t),i.querySelector(h)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(wc(g)))return}c=i.createElement("link"),Hn(c,"link",t),tn(c),i.head.appendChild(c)}}}function h2(t,a,i){yr.S(t,a,i);var c=el;if(c&&t){var h=Fs(c).hoistableStyles,g=tl(t);a=a||"default";var E=h.get(g);if(!E){var k={loading:0,preload:null};if(E=c.querySelector(Ec(g)))k.loading=5;else{t=v({rel:"stylesheet",href:t,"data-precedence":a},i),(i=ta.get(g))&&kp(t,i);var q=E=c.createElement("link");tn(q),Hn(q,"link",t),q._p=new Promise(function(se,me){q.onload=se,q.onerror=me}),q.addEventListener("load",function(){k.loading|=1}),q.addEventListener("error",function(){k.loading|=2}),k.loading|=4,Td(E,a,c)}E={type:"stylesheet",instance:E,count:1,state:k},h.set(g,E)}}}function p2(t,a){yr.X(t,a);var i=el;if(i&&t){var c=Fs(i).hoistableScripts,h=nl(t),g=c.get(h);g||(g=i.querySelector(wc(h)),g||(t=v({src:t,async:!0},a),(a=ta.get(h))&&Lp(t,a),g=i.createElement("script"),tn(g),Hn(g,"link",t),i.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(h,g))}}function m2(t,a){yr.M(t,a);var i=el;if(i&&t){var c=Fs(i).hoistableScripts,h=nl(t),g=c.get(h);g||(g=i.querySelector(wc(h)),g||(t=v({src:t,async:!0,type:"module"},a),(a=ta.get(h))&&Lp(t,a),g=i.createElement("script"),tn(g),Hn(g,"link",t),i.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},c.set(h,g))}}function Mb(t,a,i,c){var h=(h=de.current)?Sd(h):null;if(!h)throw Error(r(446));switch(t){case"meta":case"title":return null;case"style":return typeof i.precedence=="string"&&typeof i.href=="string"?(a=tl(i.href),i=Fs(h).hoistableStyles,c=i.get(a),c||(c={type:"style",instance:null,count:0,state:null},i.set(a,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(i.rel==="stylesheet"&&typeof i.href=="string"&&typeof i.precedence=="string"){t=tl(i.href);var g=Fs(h).hoistableStyles,E=g.get(t);if(E||(h=h.ownerDocument||h,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(t,E),(g=h.querySelector(Ec(t)))&&!g._p&&(E.instance=g,E.state.loading=5),ta.has(t)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},ta.set(t,i),g||g2(h,t,i,E.state))),a&&c===null)throw Error(r(528,""));return E}if(a&&c!==null)throw Error(r(529,""));return null;case"script":return a=i.async,i=i.src,typeof i=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=nl(i),i=Fs(h).hoistableScripts,c=i.get(a),c||(c={type:"script",instance:null,count:0,state:null},i.set(a,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,t))}}function tl(t){return'href="'+Ze(t)+'"'}function Ec(t){return'link[rel="stylesheet"]['+t+"]"}function Db(t){return v({},t,{"data-precedence":t.precedence,precedence:null})}function g2(t,a,i,c){t.querySelector('link[rel="preload"][as="style"]['+a+"]")?c.loading=1:(a=t.createElement("link"),c.preload=a,a.addEventListener("load",function(){return c.loading|=1}),a.addEventListener("error",function(){return c.loading|=2}),Hn(a,"link",i),tn(a),t.head.appendChild(a))}function nl(t){return'[src="'+Ze(t)+'"]'}function wc(t){return"script[async]"+t}function Ub(t,a,i){if(a.count++,a.instance===null)switch(a.type){case"style":var c=t.querySelector('style[data-href~="'+Ze(i.href)+'"]');if(c)return a.instance=c,tn(c),c;var h=v({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return c=(t.ownerDocument||t).createElement("style"),tn(c),Hn(c,"style",h),Td(c,i.precedence,t),a.instance=c;case"stylesheet":h=tl(i.href);var g=t.querySelector(Ec(h));if(g)return a.state.loading|=4,a.instance=g,tn(g),g;c=Db(i),(h=ta.get(h))&&kp(c,h),g=(t.ownerDocument||t).createElement("link"),tn(g);var E=g;return E._p=new Promise(function(k,q){E.onload=k,E.onerror=q}),Hn(g,"link",c),a.state.loading|=4,Td(g,i.precedence,t),a.instance=g;case"script":return g=nl(i.src),(h=t.querySelector(wc(g)))?(a.instance=h,tn(h),h):(c=i,(h=ta.get(g))&&(c=v({},i),Lp(c,h)),t=t.ownerDocument||t,h=t.createElement("script"),tn(h),Hn(h,"link",c),t.head.appendChild(h),a.instance=h);case"void":return null;default:throw Error(r(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(c=a.instance,a.state.loading|=4,Td(c,i.precedence,t));return a.instance}function Td(t,a,i){for(var c=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),h=c.length?c[c.length-1]:null,g=h,E=0;E<c.length;E++){var k=c[E];if(k.dataset.precedence===a)g=k;else if(g!==h)break}g?g.parentNode.insertBefore(t,g.nextSibling):(a=i.nodeType===9?i.head:i,a.insertBefore(t,a.firstChild))}function kp(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.title==null&&(t.title=a.title)}function Lp(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.integrity==null&&(t.integrity=a.integrity)}var Ad=null;function Pb(t,a,i){if(Ad===null){var c=new Map,h=Ad=new Map;h.set(i,c)}else h=Ad,c=h.get(i),c||(c=new Map,h.set(i,c));if(c.has(t))return c;for(c.set(t,null),i=i.getElementsByTagName(t),h=0;h<i.length;h++){var g=i[h];if(!(g[Bs]||g[en]||t==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var E=g.getAttribute(a)||"";E=t+E;var k=c.get(E);k?k.push(g):c.set(E,[g])}}return c}function Vb(t,a,i){t=t.ownerDocument||t,t.head.insertBefore(i,a==="title"?t.querySelector("head > title"):null)}function y2(t,a,i){if(i===1||a.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return t=a.disabled,typeof a.precedence=="string"&&t==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function zb(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function x2(t,a,i,c){if(i.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var h=tl(c.href),g=a.querySelector(Ec(h));if(g){a=g._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(t.count++,t=Id.bind(t),a.then(t,t)),i.state.loading|=4,i.instance=g,tn(g);return}g=a.ownerDocument||a,c=Db(c),(h=ta.get(h))&&kp(c,h),g=g.createElement("link"),tn(g);var E=g;E._p=new Promise(function(k,q){E.onload=k,E.onerror=q}),Hn(g,"link",c),i.instance=g}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(i,a),(a=i.state.preload)&&(i.state.loading&3)===0&&(t.count++,i=Id.bind(t),a.addEventListener("load",i),a.addEventListener("error",i))}}var Mp=0;function b2(t,a){return t.stylesheets&&t.count===0&&Cd(t,t.stylesheets),0<t.count||0<t.imgCount?function(i){var c=setTimeout(function(){if(t.stylesheets&&Cd(t,t.stylesheets),t.unsuspend){var g=t.unsuspend;t.unsuspend=null,g()}},6e4+a);0<t.imgBytes&&Mp===0&&(Mp=62500*JA());var h=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Cd(t,t.stylesheets),t.unsuspend)){var g=t.unsuspend;t.unsuspend=null,g()}},(t.imgBytes>Mp?50:800)+a);return t.unsuspend=i,function(){t.unsuspend=null,clearTimeout(c),clearTimeout(h)}}:null}function Id(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Cd(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var Nd=null;function Cd(t,a){t.stylesheets=null,t.unsuspend!==null&&(t.count++,Nd=new Map,a.forEach(v2,t),Nd=null,Id.call(t))}function v2(t,a){if(!(a.state.loading&4)){var i=Nd.get(t);if(i)var c=i.get(null);else{i=new Map,Nd.set(t,i);for(var h=t.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<h.length;g++){var E=h[g];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(i.set(E.dataset.precedence,E),c=E)}c&&i.set(null,c)}h=a.instance,E=h.getAttribute("data-precedence"),g=i.get(E)||c,g===c&&i.set(null,h),i.set(E,h),this.count++,c=Id.bind(this),h.addEventListener("load",c),h.addEventListener("error",c),g?g.parentNode.insertBefore(h,g.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(h,t.firstChild)),a.state.loading|=4}}var Sc={$$typeof:H,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function _2(t,a,i,c,h,g,E,k,q){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=kn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=kn(0),this.hiddenUpdates=kn(null),this.identifierPrefix=c,this.onUncaughtError=h,this.onCaughtError=g,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function Bb(t,a,i,c,h,g,E,k,q,se,me,be){return t=new _2(t,a,i,E,q,se,me,be,k),a=1,g===!0&&(a|=24),g=Is(3,null,null,a),t.current=g,g.stateNode=t,a=ph(),a.refCount++,t.pooledCache=a,a.refCount++,g.memoizedState={element:c,isDehydrated:i,cache:a},xh(g),t}function Fb(t){return t?(t=ko,t):ko}function Hb(t,a,i,c,h,g){h=Fb(h),c.context===null?c.context=h:c.pendingContext=h,c=zr(a),c.payload={element:i},g=g===void 0?null:g,g!==null&&(c.callback=g),i=Br(t,c,a),i!==null&&(xs(i,t,a),nc(i,t,a))}function Gb(t,a){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var i=t.retryLane;t.retryLane=i!==0&&i<a?i:a}}function Dp(t,a){Gb(t,a),(t=t.alternate)&&Gb(t,a)}function qb(t){if(t.tag===13||t.tag===31){var a=Li(t,67108864);a!==null&&xs(a,t,67108864),Dp(t,67108864)}}function $b(t){if(t.tag===13||t.tag===31){var a=js();a=Oa(a);var i=Li(t,a);i!==null&&xs(i,t,a),Dp(t,a)}}var Rd=!0;function E2(t,a,i,c){var h=F.T;F.T=null;var g=ue.p;try{ue.p=2,Up(t,a,i,c)}finally{ue.p=g,F.T=h}}function w2(t,a,i,c){var h=F.T;F.T=null;var g=ue.p;try{ue.p=8,Up(t,a,i,c)}finally{ue.p=g,F.T=h}}function Up(t,a,i,c){if(Rd){var h=Pp(c);if(h===null)wp(t,a,c,Od,i),Qb(t,c);else if(T2(h,t,a,i,c))c.stopPropagation();else if(Qb(t,c),a&4&&-1<S2.indexOf(t)){for(;h!==null;){var g=fs(h);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var E=Bt(g.pendingLanes);if(E!==0){var k=g;for(k.pendingLanes|=2,k.entangledLanes|=2;E;){var q=1<<31-Be(E);k.entanglements[1]|=q,E&=~q}Fa(g),(Nt&6)===0&&(hd=Ye()+500,xc(0))}}break;case 31:case 13:k=Li(g,2),k!==null&&xs(k,g,2),md(),Dp(g,2)}if(g=Pp(c),g===null&&wp(t,a,c,Od,i),g===h)break;h=g}h!==null&&c.stopPropagation()}else wp(t,a,c,null,i)}}function Pp(t){return t=qs(t),Vp(t)}var Od=null;function Vp(t){if(Od=null,t=Ts(t),t!==null){var a=l(t);if(a===null)t=null;else{var i=a.tag;if(i===13){if(t=d(a),t!==null)return t;t=null}else if(i===31){if(t=m(a),t!==null)return t;t=null}else if(i===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;t=null}else a!==t&&(t=null)}}return Od=t,null}function Yb(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(We()){case it:return 2;case St:return 8;case Ut:case es:return 32;case Us:return 268435456;default:return 32}default:return 32}}var zp=!1,Xr=null,Jr=null,ei=null,Tc=new Map,Ac=new Map,ti=[],S2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Qb(t,a){switch(t){case"focusin":case"focusout":Xr=null;break;case"dragenter":case"dragleave":Jr=null;break;case"mouseover":case"mouseout":ei=null;break;case"pointerover":case"pointerout":Tc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ac.delete(a.pointerId)}}function Ic(t,a,i,c,h,g){return t===null||t.nativeEvent!==g?(t={blockedOn:a,domEventName:i,eventSystemFlags:c,nativeEvent:g,targetContainers:[h]},a!==null&&(a=fs(a),a!==null&&qb(a)),t):(t.eventSystemFlags|=c,a=t.targetContainers,h!==null&&a.indexOf(h)===-1&&a.push(h),t)}function T2(t,a,i,c,h){switch(a){case"focusin":return Xr=Ic(Xr,t,a,i,c,h),!0;case"dragenter":return Jr=Ic(Jr,t,a,i,c,h),!0;case"mouseover":return ei=Ic(ei,t,a,i,c,h),!0;case"pointerover":var g=h.pointerId;return Tc.set(g,Ic(Tc.get(g)||null,t,a,i,c,h)),!0;case"gotpointercapture":return g=h.pointerId,Ac.set(g,Ic(Ac.get(g)||null,t,a,i,c,h)),!0}return!1}function Wb(t){var a=Ts(t.target);if(a!==null){var i=l(a);if(i!==null){if(a=i.tag,a===13){if(a=d(i),a!==null){t.blockedOn=a,ws(t.priority,function(){$b(i)});return}}else if(a===31){if(a=m(i),a!==null){t.blockedOn=a,ws(t.priority,function(){$b(i)});return}}else if(a===3&&i.stateNode.current.memoizedState.isDehydrated){t.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}t.blockedOn=null}function jd(t){if(t.blockedOn!==null)return!1;for(var a=t.targetContainers;0<a.length;){var i=Pp(t.nativeEvent);if(i===null){i=t.nativeEvent;var c=new i.constructor(i.type,i);zl=c,i.target.dispatchEvent(c),zl=null}else return a=fs(i),a!==null&&qb(a),t.blockedOn=i,!1;a.shift()}return!0}function Kb(t,a,i){jd(t)&&i.delete(a)}function A2(){zp=!1,Xr!==null&&jd(Xr)&&(Xr=null),Jr!==null&&jd(Jr)&&(Jr=null),ei!==null&&jd(ei)&&(ei=null),Tc.forEach(Kb),Ac.forEach(Kb)}function kd(t,a){t.blockedOn===a&&(t.blockedOn=null,zp||(zp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,A2)))}var Ld=null;function Zb(t){Ld!==t&&(Ld=t,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Ld===t&&(Ld=null);for(var a=0;a<t.length;a+=3){var i=t[a],c=t[a+1],h=t[a+2];if(typeof c!="function"){if(Vp(c||i)===null)continue;break}var g=fs(i);g!==null&&(t.splice(a,3),a-=3,Ph(g,{pending:!0,data:h,method:i.method,action:c},c,h))}}))}function sl(t){function a(q){return kd(q,t)}Xr!==null&&kd(Xr,t),Jr!==null&&kd(Jr,t),ei!==null&&kd(ei,t),Tc.forEach(a),Ac.forEach(a);for(var i=0;i<ti.length;i++){var c=ti[i];c.blockedOn===t&&(c.blockedOn=null)}for(;0<ti.length&&(i=ti[0],i.blockedOn===null);)Wb(i),i.blockedOn===null&&ti.shift();if(i=(t.ownerDocument||t).$$reactFormReplay,i!=null)for(c=0;c<i.length;c+=3){var h=i[c],g=i[c+1],E=h[mn]||null;if(typeof g=="function")E||Zb(i);else if(E){var k=null;if(g&&g.hasAttribute("formAction")){if(h=g,E=g[mn]||null)k=E.formAction;else if(Vp(h)!==null)continue}else k=E.action;typeof k=="function"?i[c+1]=k:(i.splice(c,3),c-=3),Zb(i)}}}function Xb(){function t(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(E){return h=E})},focusReset:"manual",scroll:"manual"})}function a(){h!==null&&(h(),h=null),c||setTimeout(i,20)}function i(){if(!c&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,h=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(i,100),function(){c=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),h!==null&&(h(),h=null)}}}function Bp(t){this._internalRoot=t}Md.prototype.render=Bp.prototype.render=function(t){var a=this._internalRoot;if(a===null)throw Error(r(409));var i=a.current,c=js();Hb(i,c,t,a,null,null)},Md.prototype.unmount=Bp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var a=t.containerInfo;Hb(t.current,2,null,t,null,null),md(),a[zs]=null}};function Md(t){this._internalRoot=t}Md.prototype.unstable_scheduleHydration=function(t){if(t){var a=xo();t={blockedOn:null,target:t,priority:a};for(var i=0;i<ti.length&&a!==0&&a<ti[i].priority;i++);ti.splice(i,0,t),i===0&&Wb(t)}};var Jb=e.version;if(Jb!=="19.2.4")throw Error(r(527,Jb,"19.2.4"));ue.findDOMNode=function(t){var a=t._reactInternals;if(a===void 0)throw typeof t.render=="function"?Error(r(188)):(t=Object.keys(t).join(","),Error(r(268,t)));return t=y(a),t=t!==null?x(t):null,t=t===null?null:t.stateNode,t};var I2={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:F,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dd.isDisabled&&Dd.supportsFiber)try{ve=Dd.inject(I2),Oe=Dd}catch{}}return Cc.createRoot=function(t,a){if(!o(t))throw Error(r(299));var i=!1,c="",h=ix,g=ox,E=lx;return a!=null&&(a.unstable_strictMode===!0&&(i=!0),a.identifierPrefix!==void 0&&(c=a.identifierPrefix),a.onUncaughtError!==void 0&&(h=a.onUncaughtError),a.onCaughtError!==void 0&&(g=a.onCaughtError),a.onRecoverableError!==void 0&&(E=a.onRecoverableError)),a=Bb(t,1,!1,null,null,i,c,null,h,g,E,Xb),t[zs]=a.current,Ep(t),new Bp(a)},Cc.hydrateRoot=function(t,a,i){if(!o(t))throw Error(r(299));var c=!1,h="",g=ix,E=ox,k=lx,q=null;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(h=i.identifierPrefix),i.onUncaughtError!==void 0&&(g=i.onUncaughtError),i.onCaughtError!==void 0&&(E=i.onCaughtError),i.onRecoverableError!==void 0&&(k=i.onRecoverableError),i.formState!==void 0&&(q=i.formState)),a=Bb(t,1,!0,a,i??null,c,h,q,g,E,k,Xb),a.context=Fb(null),i=a.current,c=js(),c=Oa(c),h=zr(c),h.callback=null,Br(i,h,c),i=c,a.current.lanes=i,Ps(a,i),Fa(a),t[zs]=a.current,Ep(t),new Md(a)},Cc.version="19.2.4",Cc}var cv;function U2(){if(cv)return Gp.exports;cv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Gp.exports=D2(),Gp.exports}var P2=U2();const V2=SE(P2);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),TE=(...n)=>n.filter((e,s,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===s).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var B2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=D.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:o="",children:l,iconNode:d,...m},p)=>D.createElement("svg",{ref:p,...B2,width:e,height:e,stroke:n,strokeWidth:r?Number(s)*24/Number(e):s,className:TE("lucide",o),...m},[...d.map(([y,x])=>D.createElement(y,x)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=(n,e)=>{const s=D.forwardRef(({className:r,...o},l)=>D.createElement(F2,{ref:l,iconNode:e,className:TE(`lucide-${z2(n)}`,r),...o}));return s.displayName=`${n}`,s};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H2=Se("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AE=Se("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fc=Se("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ig=Se("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=Se("AudioLines",[["path",{d:"M2 10v3",key:"1fnikh"}],["path",{d:"M6 6v11",key:"11sgs0"}],["path",{d:"M10 3v18",key:"yhl04a"}],["path",{d:"M14 8v7",key:"3a1oy3"}],["path",{d:"M18 5v13",key:"123xd1"}],["path",{d:"M22 10v3",key:"154ddg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qp=Se("Binary",[["rect",{x:"14",y:"14",width:"4",height:"6",rx:"2",key:"p02svl"}],["rect",{x:"6",y:"4",width:"4",height:"6",rx:"2",key:"xm4xkj"}],["path",{d:"M6 20h4",key:"1i6q5t"}],["path",{d:"M14 10h4",key:"ru81e7"}],["path",{d:"M6 14h2v6",key:"16z9wg"}],["path",{d:"M14 4h2v6",key:"1idq9u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=Se("Bolt",[["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=Se("BookCopy",[["path",{d:"M2 16V4a2 2 0 0 1 2-2h11",key:"spzkk5"}],["path",{d:"M22 18H11a2 2 0 1 0 0 4h10.5a.5.5 0 0 0 .5-.5v-15a.5.5 0 0 0-.5-.5H11a2 2 0 0 0-2 2v12",key:"1wz07i"}],["path",{d:"M5 14H4a2 2 0 1 0 0 4h1",key:"16gqf9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=Se("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rf=Se("BookText",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=Se("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=Se("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IE=Se("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W2=Se("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=Se("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NE=Se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const of=Se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=Se("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K2=Se("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=Se("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=Se("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=Se("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=Se("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Um=Se("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CE=Se("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uv=Se("CloudDownload",[["path",{d:"M12 13v8l-4-4",key:"1f5nwf"}],["path",{d:"m12 21 4-4",key:"1lfcce"}],["path",{d:"M4.393 15.269A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.436 8.284",key:"ui1hmy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dv=Se("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RE=Se("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=Se("Combine",[["path",{d:"M10 18H5a3 3 0 0 1-3-3v-1",key:"ru65g8"}],["path",{d:"M14 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"e30een"}],["path",{d:"M20 2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2",key:"2ahx8o"}],["path",{d:"m7 21 3-3-3-3",key:"127cv2"}],["rect",{x:"14",y:"14",width:"8",height:"8",rx:"2",key:"1b0bso"}],["rect",{x:"2",y:"2",width:"8",height:"8",rx:"2",key:"1x09vl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=Se("Command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ng=Se("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=Se("CornerDownLeft",[["polyline",{points:"9 10 4 15 9 20",key:"r3jprv"}],["path",{d:"M20 4v7a4 4 0 0 1-4 4H4",key:"6o5b7l"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OE=Se("CornerLeftUp",[["polyline",{points:"14 9 9 4 4 9",key:"m9oyvo"}],["path",{d:"M20 20h-7a4 4 0 0 1-4-4V4",key:"1blwi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=Se("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=Se("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jE=Se("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pm=Se("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tu=Se("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=Se("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=Se("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=Se("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=Se("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=Se("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LE=Se("Ghost",[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ME=Se("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DE=Se("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=Se("Grid2x2",[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 12h18",key:"1i2n21"}],["rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",key:"h1oib"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UE=Se("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PE=Se("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=Se("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fv=Se("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=Se("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cg=Se("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zE=Se("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=Se("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=Se("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=Se("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rg=Se("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=Se("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BE=Se("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=Se("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=Se("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=Se("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cu=Se("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=Se("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=Se("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=Se("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=Se("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=Se("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FE=Se("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=Se("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yI=Se("ScanSearch",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"m16 16-1.9-1.9",key:"1dq9hf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=Se("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=Se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=Se("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vI=Se("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=Se("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=Se("ShieldX",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m14.5 9.5-5 5",key:"17q4r4"}],["path",{d:"m9.5 9.5 5 5",key:"18nt4w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=Se("Shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=Se("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=Se("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=Se("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=Se("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=Se("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=Se("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const If=Se("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=Se("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kg=Se("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AI=Se("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=Se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=Se("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=Se("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=Se("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=Se("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hv=Se("Waves",[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pv=Se("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CI=Se("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=Se("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=Se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nf=Se("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);var Ct=(n=>(n.FORGOT="FORGOT",n.HARD="HARD",n.EASY="EASY",n.LEARNED="LEARNED",n))(Ct||{}),Vt=(n=>(n.RAW="RAW",n.REFINED="REFINED",n.VERIFIED="VERIFIED",n.FAILED="FAILED",n))(Vt||{}),Vm=(n=>(n.VARIETY="VARIETY",n.MORE_ACADEMIC="MORE_ACADEMIC",n.LESS_ACADEMIC="LESS_ACADEMIC",n))(Vm||{});const Hc="u-vocab-master",OI="/data/data.json",jI=[],ml=[{id:"topic_family",title:"Family & Roots",description:"Relationships, upbringing, and the foundations of society.",backgroundTheme:"from-orange-100 to-rose-50",icon:"",segments:[{id:"seg_fam_1",title:"Family Ties",description:"The core units of human connection.",tagCriteria:"family",basicWords:["mother","father","brother","sister","child"],intermediateWords:["upbringing","nuclear family","sibling","guardian","relative"],advancedWords:["genealogy","consanguinity","authoritarian","matriarch","progeny"],visualIcon:"",boss:{name:"Family Elder",hp:20,dialogueIntro:"Do you truly know those you share your blood with?",dialogueWin:"The bonds of kinship are well understood.",dialogueLose:"You ignore your foundations.",image:"",dropBadgeId:"family_crest"}},{id:"seg_fam_2",title:"Modern Society",description:"How we live together in the 21st century.",tagCriteria:"society",basicWords:["people","city","house","friend","neighbor"],intermediateWords:["community","urbanization","demographics","infrastructure","diversity"],advancedWords:["egalitarian","stratification","cosmopolitan","secular","socioeconomic"],visualIcon:"",boss:{name:"The Architect",hp:20,dialogueIntro:"A city is more than stone and mortar. It is a collective mind.",dialogueWin:"You see the patterns in the crowd.",dialogueLose:"Lost in the concrete jungle.",image:"",dropBadgeId:"family_crest"}}]},{id:"topic_education",title:"The Academy",description:"Learning systems, pedagogy, and academic pursuits.",backgroundTheme:"from-yellow-100 to-amber-50",icon:"",segments:[{id:"seg_edu_1",title:"Primary School",description:"The beginning of the educational journey.",tagCriteria:"school",basicWords:["study","learn","teacher","book","class"],intermediateWords:["curriculum","assignment","literacy","discipline","tuition"],advancedWords:["pedagogy","didactic","erudition","rote learning","epistemology"],visualIcon:"",boss:{name:"The Headmaster",hp:20,dialogueIntro:"Class is in session. Don't be late.",dialogueWin:"A star student indeed.",dialogueLose:"Detention for you.",image:"",dropBadgeId:"education_scroll"}},{id:"seg_edu_2",title:"Higher Education",description:"University life and specialized research.",tagCriteria:"university",basicWords:["college","exam","paper","degree","lesson"],intermediateWords:["undergraduate","scholarship","dissertation","vocational","faculty"],advancedWords:["theoretical","specialization","prestigious","alumnus","doctoral"],visualIcon:"",boss:{name:"The Dean",hp:20,dialogueIntro:"Submit your thesis or fail the semester.",dialogueWin:"Your research is groundbreaking.",dialogueLose:"Insufficient evidence for your claims.",image:"",dropBadgeId:"education_scroll"}}]}],kI="IELTSVocabProDB_V2",Yt="vocabulary",_a="users",Ls="units",ro="paraphrase_logs",io="speaking_logs",oo="speaking_topics",Ms="writing_topics",_r="writing_logs",Ds="irregular_verbs",Ea="lessons",lo="listening_items",wa="native_speak_items",Sa="conversation_items",Ta="free_talk_items",Aa="compositions",Ia="word_books",co="reading_books",zm="lesson_books",Bm="listening_books",Fm="speaking_books",Hm="writing_books",Na="planning_goals",LI=27;let na=null,xr=null;const YE=async()=>{if(navigator.storage&&navigator.storage.persist)try{await navigator.storage.persisted()||await navigator.storage.persist()}catch{}},uu=()=>na?Promise.resolve(na):xr||(xr=new Promise((n,e)=>{try{const s=indexedDB.open(kI,LI);s.onblocked=()=>{console.warn("[DB] Database upgrade blocked. Please close other tabs/windows of this app.")},s.onupgradeneeded=r=>{const o=r.target.result;if(!o){console.error("Database not available during onupgradeneeded");return}if(o.objectStoreNames.contains(Yt)){const l=s.transaction.objectStore(Yt);l.indexNames.contains("word")||l.createIndex("word","word",{unique:!1})}else{const l=o.createObjectStore(Yt,{keyPath:"id"});l.createIndex("userId","userId",{unique:!1}),l.createIndex("nextReview","nextReview",{unique:!1}),l.createIndex("userId_word",["userId","word"],{unique:!1}),l.createIndex("word","word",{unique:!1})}if(o.objectStoreNames.contains(_a)||o.createObjectStore(_a,{keyPath:"id"}),o.objectStoreNames.contains(Ls)||o.createObjectStore(Ls,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),!o.objectStoreNames.contains(ro)){const l=o.createObjectStore(ro,{keyPath:"id"});l.createIndex("userId","userId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1})}if(!o.objectStoreNames.contains(io)){const l=o.createObjectStore(io,{keyPath:"id"});l.createIndex("userId","userId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1})}if(r.oldVersion<9&&(o.objectStoreNames.contains(oo)||o.createObjectStore(oo,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),r.oldVersion<10&&(o.objectStoreNames.contains(Ms)||o.createObjectStore(Ms,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),!o.objectStoreNames.contains(_r))){const l=o.createObjectStore(_r,{keyPath:"id"});l.createIndex("userId","userId",{unique:!1}),l.createIndex("timestamp","timestamp",{unique:!1})}r.oldVersion<12&&o.objectStoreNames.contains("word_comparison_groups")&&o.deleteObjectStore("word_comparison_groups"),r.oldVersion<13&&(o.objectStoreNames.contains(Ds)||o.createObjectStore(Ds,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),r.oldVersion<14&&(o.objectStoreNames.contains(Ea)||o.createObjectStore(Ea,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),r.oldVersion<15&&(o.objectStoreNames.contains(lo)||o.createObjectStore(lo,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),r.oldVersion<16&&(o.objectStoreNames.contains(wa)||o.createObjectStore(wa,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),r.oldVersion<17&&(o.objectStoreNames.contains(Aa)||o.createObjectStore(Aa,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),o.objectStoreNames.contains("calendar_events")&&o.deleteObjectStore("calendar_events"),r.oldVersion<19&&(o.objectStoreNames.contains(Ia)||o.createObjectStore(Ia,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),r.oldVersion<20&&(o.objectStoreNames.contains(co)||o.createObjectStore(co,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),r.oldVersion<21&&(o.objectStoreNames.contains(zm)||o.createObjectStore(zm,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),r.oldVersion<22&&(o.objectStoreNames.contains(Bm)||o.createObjectStore(Bm,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),o.objectStoreNames.contains(Fm)||o.createObjectStore(Fm,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),o.objectStoreNames.contains(Hm)||o.createObjectStore(Hm,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),r.oldVersion<23&&(o.objectStoreNames.contains(Na)||o.createObjectStore(Na,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),r.oldVersion<24&&(o.objectStoreNames.contains(Sa)||o.createObjectStore(Sa,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),r.oldVersion<26&&(o.objectStoreNames.contains(Ta)||o.createObjectStore(Ta,{keyPath:"id"}).createIndex("userId","userId",{unique:!1})),o.objectStoreNames.contains("comparison_groups")&&o.deleteObjectStore("comparison_groups")},s.onsuccess=()=>{na=s.result,na.onclose=()=>{console.warn("[DB] Database connection closed unexpectedly."),na=null,xr=null,window.dispatchEvent(new CustomEvent("db-connection-lost"))},na.onversionchange=()=>{console.warn("[DB] Database version change detected. Closing connection."),na==null||na.close(),na=null,xr=null,window.location.reload()},n(na)},s.onerror=r=>{console.error("[DB] Open DB Error:",r.target.error),xr=null,e(r.target.error)}}catch(s){console.error("[DB] Open DB Exception:",s),xr=null,e(s)}}),xr),QE=async()=>Cf(async()=>{const n=await uu();return new Promise((e,s)=>{const r=[_a,Yt,Ls,ro,io,oo,_r,Ms,Ds,Ea,lo,wa,Sa,Ta,Aa,Ia,co,zm,Bm,Fm,Hm,Na],o=n.transaction(r,"readwrite");r.forEach(l=>{n.objectStoreNames.contains(l)&&o.objectStore(l).clear()}),o.oncomplete=()=>{localStorage.removeItem("vocab_pro_mimic_practice_queue"),localStorage.removeItem("vocab_pro_db_marker"),localStorage.removeItem("vocab_pro_emergency_backup"),e()},o.onerror=()=>s(o.error)})}),Cf=async(n,e=3,s=200)=>{var r,o,l;for(let d=0;d<e;d++)try{return await n()}catch(m){if(console.warn(`[DB] Operation failed, retrying (${d+1}/${e}). Error:`,m),((m==null?void 0:m.name)==="InvalidStateError"||(r=m==null?void 0:m.message)!=null&&r.toLowerCase().includes("closed")||((l=(o=m==null?void 0:m.target)==null?void 0:o.error)==null?void 0:l.name)==="InvalidStateError")&&(na=null,xr=null),d===e-1)throw m;await new Promise(p=>setTimeout(p,s*Math.pow(2,d)))}throw new Error("Operation failed after retries")},Me=async(n,e,s="readwrite")=>Cf(async()=>{const r=await uu();return new Promise((o,l)=>{try{const d=r.transaction(n,s),m=e(d);d.oncomplete=()=>o(m?m.result:void 0),d.onerror=()=>l(d.error),d.onabort=()=>l(new Error("Transaction aborted"))}catch(d){l(d)}})}),Lg=async(n=!1)=>{try{const e=await uu(),s=e.transaction(_a,"readonly"),r=await new Promise((x,v)=>{const S=s.objectStore(_a).getAll();S.onsuccess=()=>x(S.result||[]),S.onerror=()=>v(S.error)}),o=localStorage.getItem("vocab_pro_emergency_backup"),l=localStorage.getItem("vocab_pro_db_marker");if(r.length===0&&o)try{const x=JSON.parse(o);if(Array.isArray(x)&&x.length>0&&(await uo(x),r.length===0)){const v={id:x[0].userId||Hc,name:"Recovered User",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Recovered",lastLogin:Date.now(),role:"Language Learner",experience:0,level:1,adventure:{currentNodeIndex:0,energy:5,energyShards:0,unlockedChapterIds:ml.map(S=>S.id),completedSegmentIds:[],segmentStars:{},badges:[],keys:1,keyFragments:0,map:[]}};return await ra(v),v}}catch(x){console.error("[DB]  Failed to restore from Emergency Backup:",x)}if(r.length===0&&l==="exists"&&!n)return console.error("[DB]  CRITICAL: LocalStorage marker found but IDB returned 0 users. Aborting auto-seed to prevent data loss."),null;const m=e.transaction(Yt,"readonly").objectStore(Yt).count(),p=await new Promise(x=>{m.onsuccess=()=>x(m.result>0),m.onerror=()=>{console.error("[DB] Failed to check for existing data. Assuming data exists to prevent overwrite."),x(!0)}});if(!n&&r.length>0&&(l!=="exists"&&localStorage.setItem("vocab_pro_db_marker","exists"),p||sessionStorage.getItem("ielts_pro_skip_seed")==="true"))return null;let y;if(r.length===0?(y={id:Hc,name:"Vocab Master",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Master",lastLogin:Date.now(),role:"Language Learner",currentLevel:"Intermediate",target:"Advanced Fluency",experience:0,level:1,peakLevel:1,adventure:{currentNodeIndex:0,energy:5,energyShards:0,unlockedChapterIds:ml.map(x=>x.id),completedSegmentIds:[],segmentStars:{},badges:[],keys:1,keyFragments:0,map:[]}},await ra(y),localStorage.setItem("vocab_pro_db_marker","exists")):(y=r[0],y.experience===void 0&&(y.experience=0),y.level===void 0&&(y.level=1),y.peakLevel===void 0&&(y.peakLevel=y.level),y.adventure||(y.adventure={currentNodeIndex:0,energy:5,energyShards:0,unlockedChapterIds:ml.map(x=>x.id),completedSegmentIds:[],segmentStars:{},badges:[],keys:1,keyFragments:0,map:[]}),await ra(y)),!p){let x=[];try{const S=await fetch(OI);if(S.ok){const N=await S.json();x=Array.isArray(N)?N:N.vocabulary||[]}}catch(S){console.error("Failed to fetch local seed data:",S)}x.length===0&&(x=jI);const v=x.map(S=>({...S,nextReview:S.nextReview||Date.now(),lastXpEarnedTime:S.lastXpEarnedTime||void 0,quality:S.quality||Vt.VERIFIED,source:"app"}));await uo(v)}return y}catch(e){return console.error("[DB] Seed check failed completely:",e),null}},gl=async()=>Me(_a,n=>n.objectStore(_a).getAll(),"readonly"),ra=async n=>(n&&n.id&&localStorage.setItem("vocab_pro_db_marker","exists"),Me(_a,e=>e.objectStore(_a).put(n))),WE=async(n,e)=>Cf(async()=>{const s=await uu();return new Promise(r=>{const d=s.transaction(Yt,"readonly").objectStore(Yt).openCursor(),m=e.trim().toLowerCase();d.onsuccess=p=>{const y=p.target.result;y?y.value.userId===n&&y.value.word.trim().toLowerCase()===m?r(y.value):y.continue():r(null)},d.onerror=()=>{r(null)}})}),KE=async(n,e)=>Cf(async()=>{const s=await uu();return new Promise(r=>{const l=s.transaction(Yt,"readonly").objectStore(Yt).getAll();l.onsuccess=()=>{const d=l.result,m=["To express an idea or feeling","A state of great comfort and luxury","Happening or developing gradually","To influence or change someone or something","A formal meeting for discussion","Necessary for a particular purpose","The ability to do something well","A careful and detailed study of something","To make something new or original"],x=[...Array.from(new Set(d.filter(v=>v.id!==e&&v.quality===Vt.VERIFIED&&v.meaningVi&&v.meaningVi.trim().length>0&&v.meaningVi.length<150).map(v=>v.meaningVi.trim())))].sort(()=>Math.random()-.5).slice(0,n);if(x.length<n){const v=n-x.length,S=[...m].sort(()=>Math.random()-.5);for(let N=0;N<v;N++){const P=S[N%S.length];x.includes(P)||x.push(P)}}r([...x].sort(()=>Math.random()-.5))},l.onerror=()=>{r([])}})}),ZE=(n,e,s,r,o,l,d="all",m=null,p="all",y=null,x="all",v=null)=>{var P;const S=e.toLowerCase().trim();if(S&&!(n.word.toLowerCase().includes(S)||n.meaningVi.toLowerCase().includes(S))||n.isPassive&&!s.includes("archive")||r!=="all"&&(r==="refined"&&n.quality!==Vt.REFINED||r==="verified"&&n.quality!==Vt.VERIFIED||r==="failed"&&n.quality!==Vt.FAILED||r==="raw"&&n.quality!==Vt.RAW||r==="not_refined"&&n.quality!==Vt.RAW))return!1;if(o!=="all"){const M=!n.lastReview,j=!!n.lastReview&&n.consecutiveCorrect===1&&n.lastGrade!==Ct.FORGOT,V=!!n.lastReview&&n.consecutiveCorrect>1&&n.lastGrade===Ct.EASY,B=!!n.lastReview&&n.consecutiveCorrect>1&&n.lastGrade===Ct.HARD,H=!!n.lastReview&&n.lastGrade===Ct.FORGOT;if(o==="new"&&!M||o==="learned"&&!j||o==="easy"&&!V||o==="hard"&&!B||o==="forgot"&&!H)return!1}if(l!=="all"&&(n.register||"raw")!==l||d!=="all"&&(n.source||"raw")!==d)return!1;if(m){if(m==="Uncategorized"){if(n.groups&&n.groups.length>0)return!1}else if(!((P=n.groups)!=null&&P.some(M=>M.startsWith(m))))return!1}if(p!=="all"&&y){const M=y.has(n.id);if(p==="composed"&&!M||p==="not_composed"&&M)return!1}if(x!=="all"&&v){const M=v.has(n.word.toLowerCase());if(x==="in_book"&&!M||x==="not_in_book"&&M)return!1}if(s.includes("all")||s.length===0)return!n.isPassive;for(const M of s)if(M==="archive"&&n.isPassive||M==="idiom"&&n.isIdiom||M==="phrasal"&&n.isPhrasalVerb||M==="colloc"&&n.isCollocation||M==="phrase"&&n.isStandardPhrase||M==="vocab"&&!n.isIdiom&&!n.isPhrasalVerb&&!n.isCollocation&&!n.isStandardPhrase)return!0;return!1},XE=async(n,e)=>{e&&e.id&&localStorage.setItem("vocab_pro_db_marker","exists"),await Me([Yt,_a],s=>{s.objectStore(Yt).put(n),s.objectStore(_a).put(e)})},JE=async(n,e)=>{await Me([Yt,Ls],s=>{n&&s.objectStore(Yt).put(n),s.objectStore(Ls).put(e)})},ew=async n=>{n.updatedAt=Date.now(),await Me(Yt,e=>e.objectStore(Yt).put(n))},tw=async n=>{await Me(Yt,e=>e.objectStore(Yt).delete(n))},nw=async n=>{await Me(Yt,e=>{const s=e.objectStore(Yt);n.forEach(r=>s.delete(r))})},uo=async n=>{n.length!==0&&await Me(Yt,e=>{const s=e.objectStore(Yt);n.forEach(r=>s.put(r))})},Al=async()=>await Me(Yt,n=>n.objectStore(Yt).getAll(),"readonly"),sw=async n=>{n.updatedAt=Date.now(),await Me(Ls,e=>e.objectStore(Ls).put(n))},MI=async n=>{await Me(Ls,e=>e.objectStore(Ls).delete(n))},Rf=async()=>await Me(Ls,n=>n.objectStore(Ls).getAll(),"readonly"),DI=async n=>(await Rf()).filter(s=>s.wordIds.includes(n)),aw=async n=>{await Me(Ls,e=>{const s=e.objectStore(Ls);n.forEach(r=>s.put(r))})},Mg=async()=>(await Me(ro,e=>e.objectStore(ro).getAll(),"readonly")).sort((e,s)=>s.timestamp-e.timestamp),rw=async n=>{await Me(ro,e=>{const s=e.objectStore(ro);n.forEach(r=>s.put(r))})},Dg=async()=>await Me(io,n=>n.objectStore(io).getAll(),"readonly"),iw=async n=>{await Me(io,e=>{const s=e.objectStore(io);n.forEach(r=>s.put(r))})},Ug=async()=>await Me(oo,n=>n.objectStore(oo).getAll(),"readonly"),ow=async n=>{await Me(oo,e=>{const s=e.objectStore(oo);n.forEach(r=>s.put(r))})},lw=async n=>{n.updatedAt=Date.now(),await Me(wa,e=>e.objectStore(wa).put(n))},Pg=async()=>await Me(wa,n=>n.objectStore(wa).getAll(),"readonly"),cw=async n=>{await Me(wa,e=>e.objectStore(wa).delete(n))},uw=async n=>{await Me(wa,e=>{const s=e.objectStore(wa);n.forEach(r=>s.put(r))})},dw=async n=>{n.updatedAt=Date.now(),await Me(Sa,e=>e.objectStore(Sa).put(n))},Vg=async()=>await Me(Sa,n=>n.objectStore(Sa).getAll(),"readonly"),fw=async n=>{await Me(Sa,e=>e.objectStore(Sa).delete(n))},hw=async n=>{await Me(Sa,e=>{const s=e.objectStore(Sa);n.forEach(r=>s.put(r))})},pw=async n=>{n.updatedAt=Date.now(),await Me(Ta,e=>e.objectStore(Ta).put(n))},zg=async()=>await Me(Ta,n=>n.objectStore(Ta).getAll(),"readonly"),mw=async n=>{await Me(Ta,e=>e.objectStore(Ta).delete(n))},gw=async n=>{await Me(Ta,e=>{const s=e.objectStore(Ta);n.forEach(r=>s.put(r))})},UI=async n=>{await Me(_r,e=>e.objectStore(_r).put(n))},Bg=async()=>await Me(_r,n=>n.objectStore(_r).getAll(),"readonly"),yw=async n=>{await Me(_r,e=>{const s=e.objectStore(_r);n.forEach(r=>s.put(r))})},xw=async n=>{n.updatedAt=Date.now(),await Me(Ms,e=>e.objectStore(Ms).put(n))},bw=async n=>{await Me(Ms,e=>e.objectStore(Ms).delete(n))},PI=async()=>await Me(Ms,n=>n.objectStore(Ms).getAll(),"readonly"),Fg=async()=>await Me(Ms,n=>n.objectStore(Ms).getAll(),"readonly"),vw=async n=>{await Me(Ms,e=>{const s=e.objectStore(Ms);n.forEach(r=>s.put(r))})},VI=async n=>{n.updatedAt=Date.now(),await Me(Ds,e=>e.objectStore(Ds).put(n))},Hg=async()=>await Me(Ds,n=>n.objectStore(Ds).getAll(),"readonly"),zI=async n=>{await Me(Ds,e=>e.objectStore(Ds).delete(n))},_w=async n=>{await Me(Ds,e=>{const s=e.objectStore(Ds);n.forEach(r=>s.put(r))})},BI=async n=>{await Me(Ds,e=>{const s=e.objectStore(Ds);n.forEach(r=>s.delete(r))})},Ew=async n=>{n.updatedAt=Date.now(),await Me(Ea,e=>e.objectStore(Ea).put(n))},Gg=async()=>await Me(Ea,n=>n.objectStore(Ea).getAll(),"readonly"),ww=async n=>{await Me(Ea,e=>e.objectStore(Ea).delete(n))},Sw=async n=>{await Me(Ea,e=>{const s=e.objectStore(Ea);n.forEach(r=>s.put(r))})},qg=async()=>await Me(lo,n=>n.objectStore(lo).getAll(),"readonly"),Tw=async n=>{await Me(lo,e=>{const s=e.objectStore(lo);n.forEach(r=>s.put(r))})},Aw=async n=>{n.updatedAt=Date.now(),await Me(Aa,e=>e.objectStore(Aa).put(n))},du=async()=>await Me(Aa,n=>n.objectStore(Aa).getAll(),"readonly"),Iw=async n=>{await Me(Aa,e=>e.objectStore(Aa).delete(n))},Nw=async n=>{await Me(Aa,e=>{const s=e.objectStore(Aa);n.forEach(r=>s.put(r))})},Cw=async n=>{await Me(Ia,e=>e.objectStore(Ia).put(n))},fu=async()=>await Me(Ia,n=>n.objectStore(Ia).getAll(),"readonly"),FI=async n=>{await Me(Ia,e=>e.objectStore(Ia).delete(n))},Rw=async n=>{await Me(Ia,e=>{const s=e.objectStore(Ia);n.forEach(r=>s.put(r))})},$g=async()=>await Me(co,n=>n.objectStore(co).getAll(),"readonly"),Ow=async n=>{await Me(co,e=>{const s=e.objectStore(co);n.forEach(r=>s.put(r))})},jw=async n=>{await Me(Na,e=>e.objectStore(Na).put(n))},Yg=async()=>await Me(Na,n=>n.objectStore(Na).getAll(),"readonly"),kw=async n=>{await Me(Na,e=>e.objectStore(Na).delete(n))},Lw=async n=>{await Me(Na,e=>{const s=e.objectStore(Na);n.forEach(r=>s.put(r))})},HI=Object.freeze(Object.defineProperty({__proto__:null,bulkDeleteIrregularVerbs:BI,bulkDeleteWords:nw,bulkSaveCompositions:Nw,bulkSaveConversationItems:hw,bulkSaveFreeTalkItems:gw,bulkSaveIrregularVerbs:_w,bulkSaveLessons:Sw,bulkSaveListeningItems:Tw,bulkSaveNativeSpeakItems:uw,bulkSaveParaphraseLogs:rw,bulkSavePlanningGoals:Lw,bulkSaveReadingBooks:Ow,bulkSaveSpeakingLogs:iw,bulkSaveSpeakingTopics:ow,bulkSaveUnits:aw,bulkSaveWordBooks:Rw,bulkSaveWords:uo,bulkSaveWritingLogs:yw,bulkSaveWritingTopics:vw,clearVocabularyOnly:QE,deleteComposition:Iw,deleteConversationItem:fw,deleteFreeTalkItem:mw,deleteIrregularVerb:zI,deleteLesson:ww,deleteNativeSpeakItem:cw,deletePlanningGoal:kw,deleteUnit:MI,deleteWordBook:FI,deleteWordFromDB:tw,deleteWritingTopic:bw,filterItem:ZE,findWordByText:WE,getAllSpeakingLogsForExport:Dg,getAllSpeakingTopicsForExport:Ug,getAllUsers:gl,getAllWordsForExport:Al,getAllWritingLogsForExport:Bg,getAllWritingTopicsForExport:Fg,getCompositionsByUserId:du,getConversationItemsByUserId:Vg,getFreeTalkItemsByUserId:zg,getIrregularVerbsByUserId:Hg,getLessonsByUserId:Gg,getListeningItemsByUserId:qg,getNativeSpeakItemsByUserId:Pg,getParaphraseLogs:Mg,getPlanningGoalsByUserId:Yg,getRandomMeanings:KE,getReadingBooksByUserId:$g,getUnitsByUserId:Rf,getUnitsContainingWord:DI,getWordBooksByUserId:fu,getWritingTopicsByUserId:PI,saveComposition:Aw,saveConversationItem:dw,saveFreeTalkItem:pw,saveIrregularVerb:VI,saveLesson:Ew,saveNativeSpeakItem:lw,savePlanningGoal:jw,saveUnit:sw,saveUser:ra,saveWord:ew,saveWordAndUnit:JE,saveWordAndUser:XE,saveWordBook:Cw,saveWritingLog:UI,saveWritingTopic:xw,seedDatabaseIfEmpty:Lg,tryPersistStorage:YE},Symbol.toStringTag,{value:"Module"})),GI=["Vietnamese","Spanish","Chinese (Simplified)","Chinese (Traditional)","Japanese","Korean","French","German","Italian","Portuguese","Russian","Arabic","Hindi","Thai","Indonesian","Turkish"],qI=[{id:"learner",label:"General Learner",icon:IE},{id:"professional",label:"Professional",icon:W2},{id:"student",label:"Student",icon:DE}],$I=({users:n,isCreating:e,setIsCreating:s,loading:r,hasApiKey:o,newName:l,setNewName:d,newRole:m,setNewRole:p,newLevel:y,setNewLevel:x,newTarget:v,setNewTarget:S,newLanguage:N,setNewLanguage:P,newAudience:M,setNewAudience:j,selectedPersona:V,handleSelectKey:B,handlePersonaSelect:H,handleCreateProfile:G,onLogin:Y})=>r?u.jsx("div",{className:"h-screen flex items-center justify-center bg-neutral-50",children:u.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[u.jsx(Kt,{className:"animate-spin text-neutral-300",size:40}),u.jsx("p",{className:"text-xs font-black text-neutral-400 uppercase tracking-widest",children:"Initializing Lab..."})]})}):u.jsx("div",{className:"min-h-screen flex items-center justify-center bg-neutral-50 p-6",children:u.jsxs("div",{className:"max-w-md w-full space-y-10",children:[u.jsxs("div",{className:"text-center space-y-2",children:[u.jsx("div",{className:"inline-flex p-4 bg-white rounded-3xl shadow-sm border border-neutral-100 mb-4",children:u.jsx(Tl,{className:"text-neutral-900",size:32})}),u.jsx("h1",{className:"text-4xl font-black text-neutral-900 tracking-tight",children:"Vocab Pro"}),u.jsx("p",{className:"text-neutral-500 font-medium italic",children:"Your words. Your context. Your mastery."})]}),!o&&n.length===0&&u.jsxs("div",{className:"bg-amber-50 border-2 border-amber-100 p-6 rounded-[2rem] space-y-4 animate-in fade-in slide-in-from-top-4",children:[u.jsxs("div",{className:"flex items-start space-x-3 text-amber-800",children:[u.jsx(br,{size:24,className:"shrink-0 mt-1"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-black text-lg",children:"AI Configuration Required"}),u.jsx("p",{className:"text-sm font-medium mt-1 opacity-80",children:"To enable AI word analysis and suggestions, you must select a Gemini API key."})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("button",{onClick:B,className:"w-full py-4 bg-amber-600 text-white font-black rounded-2xl shadow-lg hover:bg-amber-700 transition-all flex items-center justify-center space-x-2 active:scale-95",children:[u.jsx(cI,{size:18}),u.jsx("span",{children:"CONNECT GEMINI API"})]}),u.jsxs("a",{href:"https://ai.google.dev/gemini-api/docs/billing",target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center space-x-1.5 text-[10px] font-black text-amber-600 uppercase tracking-widest hover:underline",children:[u.jsx("span",{children:"Billing Documentation"}),u.jsx(jE,{size:10})]})]})]}),e?u.jsxs("form",{onSubmit:G,className:"bg-white p-8 rounded-[2.5rem] shadow-xl border border-neutral-200 animate-in zoom-in-95 duration-300 space-y-6",children:[u.jsxs("h2",{className:"text-xl font-bold flex items-center",children:[u.jsx(AI,{className:"mr-2",size:20})," Create Profile"]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2",children:"Display Name"}),u.jsx("input",{autoFocus:!0,type:"text",value:l,onChange:K=>d(K.target.value),placeholder:"Enter your name",className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-md font-bold focus:ring-2 focus:ring-neutral-900 focus:outline-none"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2 flex items-center gap-2",children:[u.jsx(ME,{size:14})," Language"]}),u.jsx("select",{value:N,onChange:K=>P(K.target.value),className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none appearance-none",children:GI.map(K=>u.jsx("option",{value:K,children:K},K))})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2 flex items-center gap-2",children:[u.jsx(qE,{size:14})," Audience"]}),u.jsxs("select",{value:M,onChange:K=>j(K.target.value),className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none appearance-none",children:[u.jsx("option",{value:"Kid",children:"Kid"}),u.jsx("option",{value:"Adult",children:"Adult"})]})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest",children:"About Me (Quick Start)"}),u.jsx("div",{className:"grid grid-cols-3 gap-2",children:qI.map(K=>{const I=K.icon;return u.jsxs("button",{type:"button",onClick:()=>H(K.id),className:`p-3 border-2 rounded-2xl flex flex-col items-center justify-center space-y-1.5 transition-all text-center ${V===K.id?"bg-neutral-900 border-neutral-900 text-white shadow-lg":"bg-white border-neutral-100 text-neutral-400 hover:border-neutral-200 hover:text-neutral-900"}`,children:[u.jsx(I,{size:20}),u.jsx("span",{className:"text-[10px] font-black uppercase tracking-tight",children:K.label})]},K.id)})})]}),u.jsxs("div",{className:"space-y-4 pt-4 border-t border-neutral-100",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2",children:"Starting Role"}),u.jsx("input",{type:"text",value:m,onChange:K=>p(K.target.value),placeholder:"e.g., Working Professional, Student",className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-md font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2",children:"Current Level"}),u.jsx("input",{type:"text",value:y,onChange:K=>x(K.target.value),placeholder:"e.g., Intermediate",className:"w-full px-5 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-md font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none"})]})]}),u.jsxs("div",{className:"flex space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 py-4 text-neutral-500 font-bold hover:bg-neutral-50 rounded-2xl transition-colors",children:"Back"}),u.jsx("button",{type:"submit",disabled:!l.trim(),className:"flex-[2] py-4 bg-neutral-900 text-white font-bold rounded-2xl shadow-lg hover:scale-[1.02] active:scale-95 transition-all disabled:opacity-50",children:"Start Learning"})]})]}):u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"grid grid-cols-1 gap-3",children:n.map(K=>u.jsxs("button",{onClick:()=>Y(K),className:"bg-white p-5 rounded-3xl border border-neutral-200 shadow-sm flex items-center justify-between hover:border-neutral-900 hover:shadow-md transition-all group",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("img",{src:K.avatar,className:"w-12 h-12 rounded-2xl bg-neutral-100 p-1",alt:K.name}),u.jsxs("div",{className:"text-left",children:[u.jsx("div",{className:"font-bold text-neutral-900",children:K.name}),u.jsxs("div",{className:"text-xs text-neutral-400",children:[K.role?K.role:"Learner","  Last seen: ",new Date(K.lastLogin).toLocaleDateString()]})]})]}),u.jsx(of,{size:20,className:"text-neutral-300 group-hover:text-neutral-900 transition-colors"})]},K.id))}),u.jsxs("button",{onClick:()=>s(!0),className:"w-full p-5 bg-neutral-100 border border-dashed border-neutral-300 text-neutral-500 rounded-3xl font-bold flex items-center justify-center space-x-2 hover:bg-neutral-200 transition-all",children:[u.jsx(Ya,{size:20}),u.jsx("span",{children:"Add New User"})]})]})]})}),YI=({onLogin:n})=>{const[e,s]=D.useState([]),[r,o]=D.useState(!1),[l,d]=D.useState(""),[m,p]=D.useState(""),[y,x]=D.useState(""),[v,S]=D.useState(""),[N,P]=D.useState("English"),[M,j]=D.useState("Adult"),[V,B]=D.useState("learner"),[H,G]=D.useState(!0),[Y,K]=D.useState(!0),I=[{id:"learner",role:"Vocab Learner",level:"Intermediate English",target:"Expand active vocabulary"},{id:"professional",role:"Working Professional",level:"Intermediate English",target:"Fluent business communication"},{id:"student",role:"Primary Student",level:"Beginner English",target:"Build school vocabulary"}];D.useEffect(()=>{A()},[]),D.useEffect(()=>{r&&C("learner")},[r]);const A=async()=>{G(!0);try{if(window.aistudio){const O=await window.aistudio.hasSelectedApiKey();K(O)}const L=(await gl()).filter(O=>!O.name.toLowerCase().includes("book"));s(L)}catch(L){console.error("Auth initialization error:",L)}finally{G(!1)}},_=async()=>{window.aistudio&&(await window.aistudio.openSelectKey(),K(!0))},C=L=>{const O=I.find(xe=>xe.id===L);O&&(B(L),p(O.role),x(O.level),S(O.target),j(L==="student"?"Kid":"Adult"))},R=async L=>{if(L.preventDefault(),!l.trim())return;const O={id:"u-"+Date.now(),name:l.trim(),avatar:`https://api.dicebear.com/7.x/avataaars/svg?seed=${l}`,lastLogin:Date.now(),role:m.trim(),currentLevel:y.trim(),target:v.trim(),nativeLanguage:N,experience:0,level:1,peakLevel:1,adventure:{currentNodeIndex:0,energyShards:0,energy:5,keys:1,keyFragments:0,badges:[],unlockedChapterIds:ml.map(xe=>xe.id),completedSegmentIds:[],segmentStars:{}},lessonPreferences:{language:N,targetAudience:M,tone:M==="Kid"?"friendly_elementary":"professional_professor"}};await ra(O),n(O)};return u.jsx($I,{users:e,isCreating:r,setIsCreating:o,loading:H,hasApiKey:Y,newName:l,setNewName:d,newRole:m,setNewRole:p,newLevel:y,setNewLevel:x,newTarget:v,setNewTarget:S,newLanguage:N,setNewLanguage:P,newAudience:M,setNewAudience:j,selectedPersona:V,handleSelectKey:_,handlePersonaSelect:C,handleCreateProfile:R,onLogin:n})},Mw=D.createContext(void 0),QI=({children:n})=>{const[e,s]=D.useState([]),r=D.useCallback(l=>{s(d=>d.filter(m=>m.id!==l))},[]),o=D.useCallback((l,d="info",m=3e3)=>{const p=Date.now().toString()+Math.random(),y={id:p,type:d,message:l};s(x=>[...x,y]),m>0&&setTimeout(()=>{r(p)},m)},[r]);return u.jsxs(Mw.Provider,{value:{showToast:o},children:[n,u.jsx("div",{className:"fixed top-6 left-1/2 -translate-x-1/2 z-[9999] flex flex-col gap-2 w-full max-w-sm px-4 pointer-events-none",children:e.map(l=>u.jsxs("div",{className:`
              pointer-events-auto flex items-center justify-between p-4 rounded-2xl shadow-xl border backdrop-blur-md animate-in slide-in-from-top-2 fade-in duration-300
              ${l.type==="success"?"bg-neutral-900/90 text-white border-neutral-800":""}
              ${l.type==="error"?"bg-red-500/90 text-white border-red-600":""}
              ${l.type==="info"?"bg-white/90 text-neutral-900 border-neutral-200":""}
            `,children:[u.jsxs("div",{className:"flex items-center gap-3",children:[l.type==="success"&&u.jsx(ba,{size:20,className:"text-green-400"}),l.type==="error"&&u.jsx(br,{size:20,className:"text-white"}),l.type==="info"&&u.jsx(PE,{size:20,className:"text-blue-500"}),u.jsx("span",{className:"text-sm font-bold leading-tight",children:l.message})]}),u.jsx("button",{onClick:()=>r(l.id),className:"p-1 hover:opacity-70 transition-opacity ml-4",children:u.jsx(hn,{size:16})})]},l.id))})]})},Za=()=>{const n=D.useContext(Mw);if(!n)throw new Error("useToast must be used within a ToastProvider");return n},M5={locked_chest:{name:"Locked Chest",icon:""},lucky_dice:{name:"Lucky Dice",icon:""},badge_of_courage:{name:"Badge of Courage",icon:""},badge_of_wisdom:{name:"Badge of Wisdom",icon:""},badge_of_strength:{name:"Badge of Strength",icon:""},badge_of_speed:{name:"Badge of Speed",icon:""},badge_of_endurance:{name:"Badge of Endurance",icon:""},badge_of_precision:{name:"Badge of Precision",icon:""},badge_of_focus:{name:"Badge of Focus",icon:""},badge_of_logic:{name:"Badge of Logic",icon:""},badge_of_creativity:{name:"Badge of Creativity",icon:""},badge_of_eloquence:{name:"Badge of Eloquence",icon:""},badge_of_resilience:{name:"Badge of Resilience",icon:""},badge_of_harmony:{name:"Badge of Harmony",icon:""},badge_of_vitality:{name:"Badge of Vitality",icon:""},badge_of_willpower:{name:"Badge of Willpower",icon:""},badge_of_serenity:{name:"Badge of Serenity",icon:""},badge_of_insight:{name:"Badge of Insight",icon:""},badge_of_mystery:{name:"Badge of Mystery",icon:""},badge_of_adventure:{name:"Badge of Adventure",icon:""},badge_of_fortune:{name:"Badge of Fortune",icon:""},badge_of_innovation:{name:"Badge of Innovation",icon:""}},mv=[{name:"Cyber Sentinel",image:"",hp:20,dialogueIntro:"Logic is absolute. Prove yours.",dialogueWin:"Error... System... Crash...",dialogueLose:"Your logic is flawed."},{name:"Inferno Dragon",image:"",hp:25,dialogueIntro:"I breathe fire. What do you breathe?",dialogueWin:"Your spirit burns brighter...",dialogueLose:"Burn to ash!"},{name:"Abyssal Kraken",image:"",hp:20,dialogueIntro:"The depths hold many secrets.",dialogueWin:"You have navigated the abyss.",dialogueLose:"Join the sunken ones."},{name:"Spectral Wraith",image:"",hp:15,dialogueIntro:"Can you touch what isn't there?",dialogueWin:"I fade into the light...",dialogueLose:"Your soul is mine."},{name:"Ancient Mummy",image:"",hp:20,dialogueIntro:"My curse is eternal.",dialogueWin:"Rest... finally...",dialogueLose:"Join my tomb."},{name:"Alien Warlord",image:"",hp:20,dialogueIntro:"Your language is primitive.",dialogueWin:"Acknowledged. You are superior.",dialogueLose:"Earth is ours."},{name:"Primal T-Rex",image:"",hp:25,dialogueIntro:"ROOOARRR! The earth shakes beneath me!",dialogueWin:"Extinction... comes for me...",dialogueLose:"You are merely prey."},{name:"Shadow Ninja",image:"",hp:18,dialogueIntro:"Silence is the loudest scream.",dialogueWin:"Honorable defeat...",dialogueLose:"Too slow."},{name:"Vampire Lord",image:"",hp:20,dialogueIntro:"The night is young.",dialogueWin:"The sun... it burns...",dialogueLose:"Delicious."},{name:"Oni Warlord",image:"",hp:22,dialogueIntro:"Face the demon within!",dialogueWin:"Your spirit is unbreakable.",dialogueLose:"Another soul for the mask."},{name:"Syntax Serpent",image:"",hp:20,dialogueIntro:"Untangle my sentences if you can.",dialogueWin:"Your logic is impeccable.",dialogueLose:"Your structure is flawed."},{name:"Dread Scorpion",image:"",hp:25,dialogueIntro:"One sting is all it takes.",dialogueWin:"My venom... ineffective?",dialogueLose:"Paralyzed by fear."}];function Gc(n){const e=[];let s=0;for(let r=0;r<n;r++){const o={id:r,type:"standard"};if((r+1)%10===0)o.type="boss",o.boss_details=mv[s%mv.length],s++;else{const l=Math.random();l<.1?o.type="treasure":l<.3&&(o.type="key_fragment")}e.push(o)}return e}Gc(100);const vs={userId:"uid",word:"w",ipaUs:"i_us",ipaUk:"i_uk",pronSim:"ps",ipaMistakes:"im",meaningVi:"m",example:"ex",collocationsArray:"col",idiomsList:"idm",note:"nt",tags:"tg",groups:"gr",createdAt:"ca",updatedAt:"ua",wordFamily:"fam",prepositions:"prp",paraphrases:"prph",register:"reg",isIdiom:"is_id",isPhrasalVerb:"is_pv",isCollocation:"is_col",isStandardPhrase:"is_phr",isIrregular:"is_irr",isExampleLocked:"is_exl",isPassive:"is_pas",quality:"q",source:"s",nextReview:"nr",interval:"iv",easeFactor:"ef",consecutiveCorrect:"cc",lastReview:"lr",lastGrade:"lg",forgotCount:"fc",lastTestResults:"ltr",lastXpEarnedTime:"lxp",gameEligibility:"ge",masteryScore:"ms",complexity:"cx",topic:"tp",icon:"ic",words:"wds",color:"clr",titleColor:"tc",titleSize:"ts",d:"ds",text:"x",isIgnored:"g",prep:"p",usage:"u",tone:"t",context:"c",anchor:"anch",sentence:"sent",nouns:"ns",verbs:"v",adjs:"j",advs:"d",standard:"std",answers:"ans",speakers:"spks",sentences:"snts",speakerName:"sn",voiceName:"vn",accentCode:"ac",sex:"sx",title:"tl",content:"ct",sentenceScores:"ss"},Qg=Object.fromEntries(Object.entries(vs).map(([n,e])=>[e,n])),Gm={name:"n",avatar:"av",lastLogin:"ll",role:"r",currentLevel:"cl",target:"t",nativeLanguage:"nl",experience:"xp",level:"lv",peakLevel:"pl",adventure:"adv",adventureLastDailyStar:"alds",unlockedChapterIds:"uc",completedSegmentIds:"cs",segmentStars:"ss",badges:"b",keys:"k",keyFragments:"kf",currentNodeIndex:"cni",energy:"e",energyShards:"es",map:"m"},gv=Object.fromEntries(Object.entries(Gm).map(([n,e])=>[e,n])),Dw={COLLO_CONNECT:"cc",MEANING_MATCH:"mm",IPA_SORTER:"is",SENTENCE_SCRAMBLE:"ss",PREPOSITION_POWER:"pp",WORD_TRANSFORMER:"wt",IDIOM_CONNECT:"ic",PARAPHRASE_CONTEXT:"pc"},WI=Object.fromEntries(Object.entries(Dw).map(([n,e])=>[e,n])),Uw={SPELLING:"sp",IPA_QUIZ:"iq",PREPOSITION_QUIZ:"pq",WORD_FAMILY:"wf",MEANING_QUIZ:"mq",PARAPHRASE_QUIZ:"prq",SENTENCE_SCRAMBLE:"sc",HETERONYM_QUIZ:"hq",PRONUNCIATION:"p",COLLOCATION_QUIZ:"cq",IDIOM_QUIZ:"idq",PARAPHRASE_CONTEXT_QUIZ:"pcq",WORD_FAMILY_NOUNS:"wf_n",WORD_FAMILY_VERBS:"wf_v",WORD_FAMILY_ADJS:"wf_j",WORD_FAMILY_ADVS:"wf_d"},KI=Object.fromEntries(Object.entries(Uw).map(([n,e])=>[e,n])),Pw={intensified:"int",softened:"sft",synonym:"syn",academic:"acd",casual:"cas",idiomatic:"idm"},ZI=Object.fromEntries(Object.entries(Pw).map(([n,e])=>[e,n])),lf={user:!0,vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,mimic:!0,wordBook:!0,planning:!0};function Vw(n,e){return n&&(e==="paraphrases"?n.map(s=>{const r={[vs.word]:s.word,[vs.tone]:Pw[s.tone]||s.tone,[vs.context]:s.context};return s.isIgnored===!0&&(r[vs.isIgnored]=!0),r}):n.map(s=>{if(typeof s!="object"||s===null)return s;const r={};for(const o in s)if(Object.prototype.hasOwnProperty.call(s,o)){const l=s[o];if(l===!1)continue;r[vs[o]||o]=l}return r}))}function XI(n){if(!n)return n;const e={},s=["nouns","verbs","adjs","advs"];for(const r of s)if(n[r]){const o=vs[r]||r;e[o]=Vw(n[r],r)}return e}function Ga(n){const e={};for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s)||s==="tags"||s==="v2"||s==="v3"||s==="ipa"||s==="needsPronunciationFocus")continue;const r=n[s];if(r===!1)continue;const o=vs[s]||s;if(["collocationsArray","idiomsList","prepositions","paraphrases","words","speakers","sentences","answers"].includes(s))e[o]=Vw(r,s);else if(s==="wordFamily")e[o]=XI(r);else if(s==="lastTestResults"&&r){const l={},d=new Set(["WORD_FAMILY","WORD_FAMILY_NOUNS","WORD_FAMILY_VERBS","WORD_FAMILY_ADJS","WORD_FAMILY_ADVS","wf","wf_n","wf_v","wf_j","wf_d"]);for(const m in r)if(Object.prototype.hasOwnProperty.call(r,m)){if(d.has(m))continue;const p=m.split(":");if(p[0]==="WORD_FAMILY"&&p.length===2)continue;const y=p[0],v=[Uw[y]||y,...p.slice(1)].join(":");l[v]=r[m]}e[o]=l}else s==="gameEligibility"&&Array.isArray(r)?e[o]=r.map(l=>Dw[l]||l):e[o]=r}return e}function zw(n){const e={};for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s))continue;const r=n[s],o=Gm[s]||s;if(s==="adventure"&&r){const l={};for(const d in r){if(!Object.prototype.hasOwnProperty.call(r,d))continue;const m=Gm[d]||d;l[m]=r[d]}e[o]=l}else e[o]=r}return e}function Bw(n,e){return n&&(e==="paraphrases"?n.map(s=>{const r={word:s[vs.word],tone:ZI[s[vs.tone]]||s[vs.tone],context:s[vs.context]};return s[vs.isIgnored]!==void 0?r.isIgnored=s[vs.isIgnored]:r.isIgnored=!1,r}):n.map(s=>{if(typeof s!="object"||s===null)return s;const r={};for(const o in s)if(Object.prototype.hasOwnProperty.call(s,o)){const l=Qg[o]||o;if(["nouns","verbs","adjs","advs"].includes(e)&&(l==="ipa"||l==="ipaUs"||l==="ipaUk"))continue;r[l]=s[o]}return r}))}function JI(n){const e={};for(const s in n){const r=Qg[s]||s;e[r]=Bw(n[s],r)}return e}function rl(n){const e={};for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s))continue;const r=n[s],o=Qg[s]||s;if(!(o==="tags"||o==="v2"||o==="v3"||o==="needsPronunciationFocus")){if(s==="i"&&!e.ipaUs){e.ipaUs=r;continue}if(o==="ipa"){e.ipaUs||(e.ipaUs=r);continue}if(["collocationsArray","idiomsList","prepositions","paraphrases","words","speakers","sentences","answers"].includes(o))e[o]=Bw(r,o);else if(o==="wordFamily"&&r)e[o]=JI(r);else if(o==="lastTestResults"&&r){const l={};for(const d in r)if(Object.prototype.hasOwnProperty.call(r,d)){const m=d.split(":"),p=m[0],x=[KI[p]||p,...m.slice(1)].join(":");l[x]=r[d]}e[o]=l}else o==="gameEligibility"&&Array.isArray(r)?e[o]=r.map(l=>WI[l]||l):e[o]=r}}return e}function eN(n){const e={};for(const s in n){if(!Object.prototype.hasOwnProperty.call(n,s))continue;const r=n[s],o=gv[s]||s;if(o==="adventure"&&r){const l={};for(const d in r){if(!Object.prototype.hasOwnProperty.call(r,d))continue;const m=gv[d]||d;l[m]=r[d]}e[o]=l}else e[o]=r}return e}function tN(n){if(!n)return n;const e={...n};if(e.ipa&&!e.ipaUs&&(e.ipaUs=e.ipa),delete e.v2,delete e.v3,delete e.tags,delete e.ipa,delete e.needsPronunciationFocus,e.isIdiom===void 0&&(e.isIdiom=!1),e.isPhrasalVerb===void 0&&(e.isPhrasalVerb=!1),e.isCollocation===void 0&&(e.isCollocation=!1),e.isStandardPhrase===void 0&&(e.isStandardPhrase=!1),e.isIrregular===void 0&&(e.isIrregular=!1),e.isPassive===void 0&&(e.isPassive=!1),e.wordFamily){const s=r=>Array.isArray(r)?r.map(o=>{const l={...o};return delete l.ipa,delete l.ipaUs,delete l.ipaUk,l}):r;e.wordFamily.nouns&&(e.wordFamily.nouns=s(e.wordFamily.nouns)),e.wordFamily.verbs&&(e.wordFamily.verbs=s(e.wordFamily.verbs)),e.wordFamily.adjs&&(e.wordFamily.adjs=s(e.wordFamily.adjs)),e.wordFamily.advs&&(e.wordFamily.advs=s(e.wordFamily.advs))}return e}const Fw=async(n,e,s=lf)=>new Promise(r=>{const o=s&&typeof s=="object"&&typeof s.vocabulary=="boolean"?s:lf,l=new FileReader;l.onload=async d=>{var m;try{const p=JSON.parse((m=d.target)==null?void 0:m.result),y=p.ca?new Date(p.ca).getTime():void 0,x=Array.isArray(p)?p:p.vocabulary||p.vocab||[];let S=x.length>0&&(x[0].uid||!x[0].userId)?x.map(rl):x;S=S.map(tN);const N=Array.isArray(p)?void 0:p.units||p.u,P=Array.isArray(p)?void 0:p.paraphraseLogs||p.pl,M=Array.isArray(p)?void 0:p.speakingTopics||p.st,j=Array.isArray(p)?void 0:p.speakingLogs||p.sl,V=Array.isArray(p)?void 0:p.writingTopics||p.wt,B=Array.isArray(p)?void 0:p.writingLogs||p.wl,H=Array.isArray(p)?void 0:p.irregularVerbs||p.iv,G=Array.isArray(p)?void 0:p.lessons,Y=Array.isArray(p)?void 0:p.listeningItems,K=Array.isArray(p)?void 0:p.nativeSpeakItems||p.nsi,I=K?K.map(rl):void 0,A=Array.isArray(p)?void 0:p.conversationItems||p.ci,_=A?A.map(rl):void 0,C=Array.isArray(p)?void 0:p.freeTalkItems||p.fti,R=C?C.map(rl):void 0,L=Array.isArray(p)?void 0:p.compositions,O=Array.isArray(p)?void 0:p.mimicQueue,xe=Array.isArray(p)?void 0:p.wordBooks||p.wb,ge=xe?xe.map(rl):void 0,F=Array.isArray(p)?void 0:p.readingShelves||p.rs,ue=Array.isArray(p)?void 0:p.readingBooks||p.rb,ae=Array.isArray(p)?void 0:p.planningGoals||p.pg,X=Array.isArray(p)?void 0:p.user;let Q;X&&(Q="n"in X||"av"in X?eN(X):X);const T=Q?Q.id:e,z=Array.isArray(p)?void 0:p.customAdventure||p.adv,$=Array.isArray(p)?void 0:p.settings||p.sys;if(!Array.isArray(S))throw new Error("Invalid JSON: 'vocabulary' array missing.");let J=0,pe=0,de=0;if(o.vocabulary){const W=await Al(e),le=new Map(W.map(he=>[he.word.toLowerCase().trim(),he])),ie=[];for(const he of S){if(!he.word)continue;const Ie=le.get(he.word.toLowerCase().trim());if(Ie)(he.updatedAt||0)>(Ie.updatedAt||0)?(ie.push({...Ie,...he,id:Ie.id,userId:T,updatedAt:Date.now()}),pe++):de++;else{const Ue=Date.now();ie.push({...he,id:he.id||`w-${Ue}-${Math.random()}`,userId:T,createdAt:he.createdAt||Ue,updatedAt:Ue}),J++}}ie.length>0&&await uo(ie)}o.reading&&(N&&await aw(N.map(W=>({...W,userId:T}))),ue&&await Ow(ue.map(W=>({...W,userId:T}))),F&&localStorage.setItem("reading_books_shelves",JSON.stringify(F))),(o.lesson||o.writing)&&P&&await rw(P.map(W=>({...W,userId:T}))),o.speaking&&(M&&await ow(M.map(W=>({...W,userId:T}))),j&&await iw(j.map(W=>({...W,userId:T}))),I&&await uw(I.map(W=>({...W,userId:T}))),_&&await hw(_.map(W=>({...W,userId:T}))),R&&await gw(R.map(W=>({...W,userId:T})))),o.writing&&(V&&await vw(V.map(W=>({...W,userId:T}))),B&&await yw(B.map(W=>({...W,userId:T}))),L&&await Nw(L.map(W=>({...W,userId:T})))),o.lesson&&(H&&await _w(H.map(W=>({...W,userId:T}))),G&&await Sw(G.map(W=>({...W,userId:T})))),o.listening&&Y&&await Tw(Y.map(W=>({...W,userId:T}))),o.mimic&&O&&localStorage.setItem("vocab_pro_mimic_practice_queue",JSON.stringify(O)),o.wordBook&&ge&&await Rw(ge.map(W=>({...W,userId:T}))),o.planning&&ae&&await Lw(ae.map(W=>({...W,userId:T})));let _e;if(o.user&&Q){const W={...Q,id:T};await ra(W),_e=W}z&&o.user&&(z.ch&&localStorage.setItem("vocab_pro_adventure_chapters",JSON.stringify(z.ch)),z.b&&localStorage.setItem("vocab_pro_custom_badges",JSON.stringify(z.b))),o.user&&$&&(localStorage.setItem("vocab_pro_system_config",JSON.stringify($)),window.dispatchEvent(new Event("config-updated"))),r({type:"success",message:"Restore data successfully",detail:`Words: ${J} new, ${pe} updated.`,updatedUser:_e,backupTimestamp:y})}catch(p){r({type:"error",message:"JSON Import Error",detail:p.message})}},l.readAsText(n)}),nN=async(n,e,s=lf)=>{const r=s&&typeof s=="object"&&typeof s.vocabulary=="boolean"?s:lf,[o,l,d,m,p,y,x,v,S,N,P,M,j,V,B,H,G]=await Promise.all([r.vocabulary?Al():[],r.reading?Rf():[],r.reading?$g():[],r.lesson||r.writing?Mg():[],r.speaking?Ug():[],r.speaking?Dg():[],r.speaking?Pg():[],r.speaking?Vg():[],r.speaking?zg():[],r.writing?Fg():[],r.writing?Bg():[],r.writing?du():[],r.lesson?Hg():[],r.lesson?Gg():[],r.listening?qg():[],r.wordBook?fu():[],r.planning?Yg():[]]),Y=localStorage.getItem("vocab_pro_mimic_practice_queue"),K=localStorage.getItem("vocab_pro_adventure_chapters"),I=localStorage.getItem("vocab_pro_custom_badges"),A=localStorage.getItem("reading_books_shelves"),_=localStorage.getItem("vocab_pro_system_config");return{v:8,ca:new Date().toISOString(),user:zw(e),vocab:o.map(C=>Ga(C)),u:l,pl:m,st:p,sl:y,wt:N,wl:P,iv:j,lessons:V,listeningItems:B,nativeSpeakItems:x.map(C=>Ga(C)),conversationItems:v.map(C=>Ga(C)),freeTalkItems:S.map(C=>Ga(C)),compositions:M,mimicQueue:Y?JSON.parse(Y):[],wordBooks:H.map(C=>Ga(C)),readingBooks:d,pg:G,adv:{ch:K?JSON.parse(K):null,b:I?JSON.parse(I):null},readingShelves:A?JSON.parse(A):null,settings:_?JSON.parse(_):null}},D5=async(n,e)=>{const s={v:8,ca:new Date().toISOString(),u:n,user:{id:e}},r=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),o=URL.createObjectURL(r),l=document.createElement("a");l.href=o,l.download=`vocab-pro-units-${new Date().toISOString().split("T")[0]}.json`,l.click(),URL.revokeObjectURL(o)},sN={initialEasy:4,initialHard:1,easyEasy:2.5,hardEasy:2,hardHard:1.3,easyHardPenalty:.5,forgotInterval:1},aN={host:"localhost",port:3e3,useCustomUrl:!1,customUrl:"",backupPath:"backups"},rN={mode:"system",preferredSystemVoice:"",appliedAccent:"US"},iN={max_learn_per_day:10,max_review_per_day:10},oN={preferredTypes:[]},lN={topic1Options:["Grammar","Vocabulary","Pronunciation"],topic2Options:{Grammar:["Tenses","Conditionals","Passive Voice","Reported Speech"],Vocabulary:["Topic: Work","Topic: Environment","Collocations","Idioms"],Pronunciation:["Vowel Sounds","Consonant Sounds","Intonation"]}},cN={autoBackupEnabled:!1,autoBackupInterval:60,lastSyncTime:null},yv={server:aN,ai:{enableGeminiApi:!0,modelForComplexTasks:"gemini-3-pro-preview",modelForBasicTasks:"gemini-3-flash-preview",modelForTts:"gemini-2.5-flash-preview-tts"},srs:sN,audio:rN,audioCoach:{activeCoach:"female",coaches:{male:{name:"Victor",avatar:"man_teacher",persona:"professional_professor",enVoice:"",enAccent:"en_US",viVoice:"",viAccent:"vi_VN"},female:{name:"Sofia",avatar:"woman_teacher",persona:"friendly_elementary",enVoice:"",enAccent:"en_US",viVoice:"",viAccent:"vi_VN"}}},dailyGoals:iN,interface:{studyBuddyLanguage:"vi",buddyVoiceEnabled:!1,studyBuddyAvatar:"woman_teacher",junkTags:["ielts","general","common"],rightClickCommandEnabled:!0},test:oN,lesson:lN,sync:cN},Hw="vocab_pro_system_config";function Kp(n){return n&&typeof n=="object"&&!Array.isArray(n)}function Gw(n,e){const s={...n};if(Kp(n)&&Kp(e))for(const r of Object.keys(e))Kp(e[r])?r in n?s[r]=Gw(n[r],e[r]):Object.assign(s,{[r]:e[r]}):Object.assign(s,{[r]:e[r]});return s}const Cn=n=>n.server.useCustomUrl&&n.server.customUrl?n.server.customUrl.replace(/\/$/,""):`https://${n.server.host}:${n.server.port}`;function Dt(){const n=localStorage.getItem(Hw),e=n?JSON.parse(n):null;if(!e)return yv;const s=Gw(yv,e);return e.audio&&e.audio.serverPort&&e.audio.serverUrl,s}function qc(n,e=!1){try{localStorage.setItem(Hw,JSON.stringify(n)),window.dispatchEvent(new Event("config-updated")),e||window.dispatchEvent(new Event("vocab-pro-trigger-backup"))}catch(s){console.error("Failed to save system config.",s)}}const uN=["i:","","u:","","","e","",":","",":","e","","s","","t","d","","","t","d","n","l","","v","w"],dN=n=>!n||n.length<2?!1:uN.some(e=>{if(e==="t"||e==="d")return n.includes(e);const s=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");let r;return e==="d"?r=new RegExp(`${s}(?!)`):e==="t"?r=new RegExp(`${s}(?!)`):e===""?r=new RegExp(`(?<!t)${s}`):e===""?r=new RegExp(`(?<!d)${s}`):e===""?r=new RegExp(`(?<![ae])${s}`):e===""?r=new RegExp(`(?<![a])${s}`):e==="e"?r=new RegExp(`${s}(?!)`):r=new RegExp(s),r.test(n)}),Ca=n=>{if(n.quality!==Vt.VERIFIED||!n.lastReview)return[];const e=[];return n.collocationsArray&&n.collocationsArray.some(s=>!s.isIgnored)&&e.push("COLLO_CONNECT"),n.word&&n.meaningVi&&n.meaningVi.trim().length>0&&e.push("MEANING_MATCH"),n.ipaUs&&dN(n.ipaUs)&&e.push("IPA_SORTER"),n.example&&n.example.trim().split(/\s+/).filter(Boolean).length>=5&&e.push("SENTENCE_SCRAMBLE"),n.example&&n.example.trim().split(/\s+/).filter(Boolean).length>=4&&e.push("DICTATION"),n.example&&n.prepositions&&n.prepositions.some(s=>!s.isIgnored)&&e.push("PREPOSITION_POWER"),n.paraphrases&&n.paraphrases.filter(s=>!s.isIgnored&&s.context&&s.context.trim()).length>=2&&e.push("PARAPHRASE_CONTEXT"),e};function xv(n,e){const s=.95+Math.random()*.1,r=Math.max(1,e*s),o=new Date(n);return o.setHours(0,0,0,0),o.setDate(o.getDate()+Math.round(r)),o.getTime()}function qw(n,e){const s=Dt().srs,r={...n},o=Date.now();if(e===Ct.LEARNED)r.consecutiveCorrect=1,r.interval=s.initialHard,r.nextReview=xv(o,s.initialHard);else{let l=n.interval||0,d=1;const m=1440*60*1e3,p=n.lastReview||o,y=Math.max(0,(o-p)/m),x=y>l;if(e===Ct.FORGOT)d=s.forgotInterval,r.consecutiveCorrect=0,r.forgotCount+=1;else if(e===Ct.HARD)n.lastGrade===Ct.EASY?d=Math.max(1,Math.floor(l*s.easyHardPenalty)):d=l===0?s.initialHard:Math.max(1,Math.floor(l*s.hardHard)),r.consecutiveCorrect+=1;else if(e===Ct.EASY){let v=l;x&&(v=Math.max(l,y)),n.lastGrade===Ct.HARD?d=l===0?s.initialEasy:Math.max(s.initialEasy,Math.floor(v*s.hardEasy)):d=l===0?s.initialEasy:Math.max(s.initialEasy,Math.floor(v*s.easyEasy)),r.consecutiveCorrect+=1}r.interval=Math.round(d),r.nextReview=xv(o,r.interval)}return r.lastGrade=e,r.lastReview=o,r.updatedAt=o,r.complexity=Ra(r),r.masteryScore=_s(r),r.gameEligibility=Ca(r),r}function $w(n){const e=Date.now(),s={...n,nextReview:e,interval:0,easeFactor:2.5,consecutiveCorrect:0,forgotCount:0,lastGrade:void 0,lastReview:void 0,updatedAt:e,lastXpEarnedTime:void 0,lastTestResults:n.lastTestResults??{},masteryScore:n.masteryScore};return s.complexity=Ra(s),s.gameEligibility=Ca(s),s}function fN(n){const e=Date.now(),s=n-e,r=1440*60*1e3;if(s<=0)return{label:"DUE",urgency:"due"};const o=Math.ceil(s/r);return{label:`${o}d`,urgency:o<=1?"soon":"later"}}function Yw(n,e,s,r,o,l,d=!1,m=!1,p=!1,y=!1,x=!1,v="manual"){const S=Date.now(),N={id:crypto.randomUUID?crypto.randomUUID():"id-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),userId:"",word:n.trim(),ipaUs:e.trim(),meaningVi:s.trim(),example:r.trim(),note:o,groups:l,isIdiom:d,isPhrasalVerb:m,isCollocation:p,isStandardPhrase:y,isPassive:x,register:"raw",quality:Vt.RAW,source:v,isExampleLocked:!1,createdAt:S,updatedAt:S,nextReview:S,interval:0,easeFactor:2.5,consecutiveCorrect:0,forgotCount:0,lastTestResults:{}};return N.complexity=Ra(N),N.masteryScore=_s(N),N.gameEligibility=Ca(N),N}function Wg(n){const e=[];if(e.push({key:"spelling",testKeys:["SPELLING"]}),n.ipaUs&&e.push({key:"pronunciation",testKeys:["PRONUNCIATION"]}),n.ipaUs&&n.ipaUs.trim()&&n.ipaMistakes&&n.ipaMistakes.length>0&&e.push({key:"ipa_recognition",testKeys:["IPA_QUIZ"]}),n.meaningVi&&n.meaningVi.trim()&&e.push({key:"meaning",testKeys:["MEANING_QUIZ"]}),n.example&&n.example.trim()&&e.push({key:"context",testKeys:["SENTENCE_SCRAMBLE"]}),n.collocationsArray&&n.collocationsArray.filter(s=>!s.isIgnored&&s.d&&s.d.trim()).forEach(s=>{const r=s.text;e.push({key:`colloc:${r}`,testKeys:[`COLLOCATION_QUIZ:${r}`,`COLLOCATION_MULTICHOICE_QUIZ:${r}`,`COLLOCATION_CONTEXT_QUIZ:${r}`]})}),n.idiomsList&&n.idiomsList.filter(s=>!s.isIgnored&&s.d&&s.d.trim()).forEach(s=>{const r=s.text;e.push({key:`idiom:${r}`,testKeys:[`IDIOM_QUIZ:${r}`,`IDIOM_CONTEXT_QUIZ:${r}`]})}),n.prepositions&&n.prepositions.filter(s=>!s.isIgnored).forEach(s=>{const r=s.prep;e.push({key:`prep:${r}`,testKeys:[`PREPOSITION_QUIZ:${r}`]})}),n.paraphrases&&n.paraphrases.filter(s=>!s.isIgnored&&s.context&&s.context.trim()).forEach(s=>{const r=s.word;e.push({key:`para:${r}`,testKeys:[`PARAPHRASE_QUIZ:${r}`,`PARAPHRASE_CONTEXT_QUIZ:${r}`]})}),n.wordFamily){const s=["nouns","verbs","adjs","advs"],r={nouns:"n",verbs:"v",adjs:"j",advs:"d"},o=n.word.toLowerCase(),l=s.flatMap(d=>{const m=n.wordFamily[d];return Array.isArray(m)?m.filter(p=>!p.isIgnored&&p.word):[]});l.length===1&&l[0].word.toLowerCase()===o||s.forEach(d=>{const m=n.wordFamily[d];Array.isArray(m)&&m.filter(p=>!p.isIgnored&&p.word).forEach(p=>{const y=p.word,x=r[d];e.push({key:`fam:${x}:${y}`,testKeys:[`WORD_FAMILY:${x}:${y}`]})})})}return e}function Ra(n){return Wg(n).length}function _s(n){const e=Wg(n);if(e.length===0)return 0;const s=n.lastTestResults||{};let r=0;const o=[],l=[];e.forEach(m=>{m.testKeys.length>0&&m.testKeys.some(y=>s[y]===!0)?(r++,o.push(m.key)):l.push({key:m.key,reason:`None of [${m.testKeys.join(", ")}] passed.`})});const d=Math.round(r/e.length*100);return Math.max(0,Math.min(100,d))}let yl=!1,Zd=!1,Jn=new Map;const Er=new Set,hi=new Set,fo=new Map;let $c=null,Qw={reviewCounts:{total:0,due:0,new:0,learned:0,mastered:0,statusForgot:0,statusHard:0,statusEasy:0,statusLearned:0},dashboardStats:{categories:{vocab:{total:0,learned:0},idiom:{total:0,learned:0},phrasal:{total:0,learned:0},colloc:{total:0,learned:0},phrase:{total:0,learned:0},preposition:{total:0,learned:0}},refinedCount:0,rawCount:0},dayProgress:{learned:0,reviewed:0,learnedWords:[],reviewedWords:[]}};function rn(){localStorage.setItem("vocab_pro_local_last_modified",String(Date.now()))}let vr=null,ri=null;async function bv(){vr&&(clearTimeout(vr),vr=null),ri&&(clearTimeout(ri),ri=null);try{const n=Array.from(Jn.values()),e=JSON.stringify(n);if(localStorage.setItem("vocab_pro_emergency_backup",e),$c){const s=(await gl()).find(r=>r.id===$c);s&&await Xd($c,s)}}catch(n){console.warn("[DataStore] Backup failed:",n)}}function qm(){vr&&(clearTimeout(vr),vr=null),ri&&(clearTimeout(ri),ri=null),Ji&&(clearTimeout(Ji),Ji=null)}function Xt(){if(window.isRestoring)return;const e=(Dt().sync.autoBackupInterval||60)*1e3,s=Math.max(e*3,3e5);vr&&clearTimeout(vr);const r=Date.now()+e;window.dispatchEvent(new CustomEvent("backup-scheduled",{detail:{targetTime:r}})),vr=window.setTimeout(bv,e),ri||(ri=window.setTimeout(()=>{bv()},s))}function go(n){const e=Date.now(),r=Array.from(Jn.values()).filter(Y=>!Y.isPassive&&Y.userId===n),o=r.length,l=r.filter(Y=>Y.lastReview&&Y.nextReview<=e&&Y.quality!==Vt.FAILED).length,d=r.filter(Y=>!Y.lastReview&&Y.quality===Vt.VERIFIED).length,m=r.filter(Y=>Y.interval>21).length,p=r.filter(Y=>!!Y.lastReview&&Y.interval<=21),y=p.length,x=p.filter(Y=>Y.lastGrade===Ct.FORGOT).length,v=p.filter(Y=>Y.lastGrade===Ct.HARD).length,S=p.filter(Y=>Y.lastGrade===Ct.EASY).length,N=p.filter(Y=>Y.lastGrade===Ct.LEARNED).length,P=r.filter(Y=>Y.quality===Vt.REFINED).length,M=r.filter(Y=>Y.quality===Vt.RAW).length,j={vocab:{total:0,learned:0},idiom:{total:0,learned:0},phrasal:{total:0,learned:0},colloc:{total:0,learned:0},phrase:{total:0,learned:0},preposition:{total:0,learned:0}};r.forEach(Y=>{const K=!!Y.lastReview,I=A=>{j[A].total++,K&&j[A].learned++};Y.isIdiom&&I("idiom"),Y.isPhrasalVerb&&I("phrasal"),Y.isCollocation&&I("colloc"),Y.isStandardPhrase&&I("phrase"),Y.prepositions&&Y.prepositions.length>0&&!Y.isPhrasalVerb&&I("preposition"),!Y.isIdiom&&!Y.isPhrasalVerb&&!Y.isCollocation&&!Y.isStandardPhrase&&I("vocab")});const V=new Date;V.setHours(0,0,0,0);const B=V.getTime(),H=[],G=[];r.forEach(Y=>{Y.lastReview&&Y.lastReview>=B&&Y.lastReviewSessionType!=="boss_battle"&&(Y.lastGrade===Ct.LEARNED?H.push(Y):G.push(Y))}),Qw={reviewCounts:{total:o,due:l,new:d,learned:y,mastered:m,statusForgot:x,statusHard:v,statusEasy:S,statusLearned:N},dashboardStats:{categories:j,refinedCount:P,rawCount:M},dayProgress:{learned:H.length,reviewed:G.length,learnedWords:H,reviewedWords:G}}}let Ji=null;function Jt(){Ji&&clearTimeout(Ji),Ji=window.setTimeout(()=>{window.dispatchEvent(new CustomEvent("datastore-updated")),Ji=null},100)}let vv=0;const On=()=>{const n=Date.now();return n-vv<1e3?(window.dispatchEvent(new CustomEvent("datastore-cooldown")),!1):(vv=n,!0)};typeof window<"u"&&window.addEventListener("vocab-pro-trigger-backup",()=>{yl&&(Jt(),Xt())});async function Ww(n){if(!(yl||Zd)){Zd=!0,$c=n;try{let e=await Al(n);if(e.length===0){const l=localStorage.getItem("vocab_pro_emergency_backup");if(l)try{const d=JSON.parse(l);Array.isArray(d)&&d.length>0&&(await uo(d),e=await Al(n))}catch(d){console.error("[DataStore] Failed to restore from emergency backup:",d)}}const[s,r]=await Promise.all([du(n),fu(n)]);Er.clear(),s.forEach(l=>{(l.linkedWordIds||[]).forEach(d=>Er.add(d))}),hi.clear(),fo.clear(),r.forEach(l=>{const d=new Set;(l.words||[]).forEach(m=>{const p=m.word.toLowerCase();hi.add(p),d.add(p)}),fo.set(l.id,d)});const o=[];for(const l of e){let d=!1;const m=l.ipa;m&&!l.ipaUs&&(l.ipaUs=m,delete l.ipa,d=!0),m&&l.ipaUs&&(delete l.ipa,d=!0),l.needsPronunciationFocus!==void 0&&(delete l.needsPronunciationFocus,d=!0);const p=Ra(l),y=_s(l),x=Ca(l);l.complexity!==p&&(l.complexity=p,d=!0),l.masteryScore!==y&&(l.masteryScore=y,d=!0),JSON.stringify(l.gameEligibility)!==JSON.stringify(x)&&(l.gameEligibility=x,d=!0),typeof l.register>"u"&&(l.register="raw",d=!0),d&&o.push(l)}o.length>0&&await uo(o),Jn=new Map(e.map(l=>[l.id,l])),go(n),yl=!0}catch(e){console.error("DataStore initialization failed:",e),yl=!1}finally{Zd=!1}}}async function $m(n){yl=!1,Zd=!1,Jn.clear(),Er.clear(),hi.clear(),fo.clear(),await Ww(n),Jt()}async function Kw(){Jn.clear(),Er.clear(),hi.clear(),fo.clear(),yl=!1,$c=null,await QE();const n=["vocab_pro_system_config","gemini_api_keys"],e=[];for(let s=0;s<localStorage.length;s++){const r=localStorage.key(s);r&&!n.includes(r)&&e.push(r)}e.forEach(s=>localStorage.removeItem(s)),sessionStorage.clear()}async function Zw(n){try{const e=await du(n);Er.clear(),e.forEach(s=>{(s.linkedWordIds||[]).forEach(r=>Er.add(r))}),Jt()}catch(e){console.error("Failed to refresh composition index",e)}}async function hN(n){try{const e=await fu(n);hi.clear(),fo.clear(),e.forEach(s=>{const r=new Set;(s.words||[]).forEach(o=>{const l=o.word.toLowerCase();hi.add(l),r.add(l)}),fo.set(s.id,r)}),Jt()}catch(e){console.error("Failed to refresh word book index",e)}}function pN(n){return Er.has(n)}function U5(){return Er}function P5(){return hi}function Xw(){return Qw}function ii(){return Array.from(Jn.values())}function _v(n){return Jn.get(n)}function V5(n,e,s,r="",o=["all"],l="all",d="all",m="all",p="all",y=null,x="all",v="all",S=""){const N=Array.from(Jn.values()).filter(H=>H.userId===n);let P=N;if(o.includes("duplicate")){const H=new Map;N.forEach(Y=>{const K=Y.word.toLowerCase().trim();H.set(K,(H.get(K)||0)+1)});const G=new Set;for(const[Y,K]of H.entries())K>1&&G.add(Y);P=P.filter(Y=>G.has(Y.word.toLowerCase().trim()))}const M=o.filter(H=>H!=="duplicate");let j=null;v==="specific"&&S&&(j=fo.get(S)||null);const V=P.filter(H=>ZE(H,r,M,l,d,m,p,y,x,Er,v==="specific"?"all":v,hi)?v==="specific"&&j?j.has(H.word.toLowerCase()):!0:!1);o.includes("duplicate")?V.sort((H,G)=>H.word.localeCompare(G.word)||H.createdAt-G.createdAt):V.sort((H,G)=>G.createdAt-H.createdAt);const B=e*s;return{words:V.slice(B,B+s),totalCount:V.length}}async function Ym(n,e){return WE(n,e)}async function mN(n,e){On()&&(rn(),n.complexity=Ra(n),n.masteryScore=_s(n),n.gameEligibility=Ca(n),await XE(n,e),Jn.set(n.id,n),go(n.userId),Xt(),Jt())}async function z5(n,e){On()&&(rn(),n&&(n.complexity=Ra(n),n.masteryScore=_s(n),n.gameEligibility=Ca(n)),await JE(n,e),n&&Jn.set(n.id,n),Xt(),go(e.userId),Jt())}async function Of(n){On()&&(rn(),n.complexity=Ra(n),n.masteryScore=_s(n),n.gameEligibility=Ca(n),await ew(n),Jn.set(n.id,n),go(n.userId),Xt(),Jt())}async function gN(n){n.length!==0&&(rn(),n.forEach(e=>{e.complexity=Ra(e),e.masteryScore=_s(e),e.gameEligibility=Ca(e)}),await uo(n),n.forEach(e=>Jn.set(e.id,e)),n[0]&&go(n[0].userId),Xt(),Jt())}async function yN(n){const e=Jn.get(n);!e||!On()||(rn(),await tw(n),Jn.delete(n),go(e.userId),Xt(),Jt())}async function xN(n){if(n.length===0)return;const e=Jn.get(n[0]);e&&(rn(),await nw(n),n.forEach(s=>Jn.delete(s)),go(e.userId),Xt(),Jt())}async function B5(n){On()&&(rn(),await sw(n),Xt(),Jt())}async function F5(n){On()&&(rn(),await Aw(n),await Zw(n.userId),Xt())}async function H5(n,e){rn(),await Iw(n),await Zw(e),Xt()}async function G5(n){On()&&(rn(),await Cw(n),await hN(n.userId),Xt())}async function q5(n){On()&&(rn(),await lw(n),Xt(),Jt())}async function $5(n){On()&&(rn(),await cw(n),Xt(),Jt())}async function Y5(n){On()&&(rn(),await dw(n),Xt(),Jt())}async function Q5(n){On()&&(rn(),await fw(n),Xt(),Jt())}async function W5(n){On()&&(rn(),await pw(n),Xt(),Jt())}async function K5(n){On()&&(rn(),await mw(n),Xt(),Jt())}async function Z5(n){On()&&(rn(),await Ew(n),Xt(),Jt())}async function X5(n){On()&&(rn(),await ww(n),Xt(),Jt())}async function J5(n){On()&&(rn(),await xw(n),Xt(),Jt())}async function eM(n){On()&&(rn(),await bw(n),Xt(),Jt())}async function tM(n){On()&&(rn(),await jw(n),Xt(),Jt())}async function nM(n){On()&&(rn(),await kw(n),Xt(),Jt())}const{getUnitsContainingWord:bN,seedDatabaseIfEmpty:vN,clearVocabularyOnly:Jw,bulkSavePlanningGoals:sM}=HI,_N={user:!0,vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,mimic:!0,wordBook:!0,planning:!0};let Zp=!1;const Xd=async(n,e,s=!1)=>{if(window.isRestoring||Zp)return;const r=Dt();if(!r.sync.autoBackupEnabled&&!s)return;Zp=!0;const o=Cn(r);try{const l=await wN(n,e),d=JSON.stringify(l),m=(new Blob([d]).size/(1024*1024)).toFixed(2),p=e.name?`&username=${encodeURIComponent(e.name)}`:"",y=await fetch(`${o}/api/backup?userId=${encodeURIComponent(n)}${p}&app=vocab`,{method:"POST",headers:{"Content-Type":"application/json"},body:d});if(!y.ok)throw new Error(`Server error: ${y.statusText}`);const x=Date.now(),v={...r};v.sync.lastSyncTime=x,qc(v,!0),localStorage.setItem("vocab_pro_local_last_modified",String(x)),window.dispatchEvent(new CustomEvent("backup-complete",{detail:{success:!0,size:m}}))}catch(l){console.warn("[Backup] Upload failed:",l),window.dispatchEvent(new CustomEvent("backup-complete",{detail:{success:!1}}))}finally{Zp=!1}},Ud=async()=>{try{const n=Dt(),e=Cn(n),s=await fetch(`${e}/api/backups?app=vocab`);return s.ok?(await s.json()).backups||[]:[]}catch(n){return console.warn("[Backup] Failed to fetch list:",n),[]}},eS=async n=>{try{const e=Dt(),r=`${Cn(e)}/api/backup/${encodeURIComponent(n)}?t=${Date.now()}&app=vocab`,o=await fetch(r,{method:"GET",headers:{"Cache-Control":"no-cache"},mode:"cors"});if(!o.ok)return null;const l=await o.blob(),d=new File([l],"restore.json",{type:"application/json"}),m=await Fw(d,n,_N);return m.type==="success"&&m.updatedUser?(await $m(m.updatedUser.id),m):null}catch(e){return console.error("[Backup] Restore exception:",e),null}},EN=async n=>{try{const e=Dt(),s=Cn(e),r=await fetch(`${s}/api/library/lookup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({words:n})});if(r.ok){const o=await r.json();if(Array.isArray(o.found))return o.found.map(l=>rl(l))}return[]}catch(e){return console.warn("[Backup] Library lookup failed:",e),[]}};async function wN(n,e){const[s,r,o,l,d,m,p,y,x,v,S,N,P,M,j,V,B]=await Promise.all([Al(),Rf(),$g(),Mg(),Ug(),Dg(),Pg(),Vg(),zg(),Fg(),Bg(),du(),Hg(),Gg(),qg(),fu(),Yg()]),H=localStorage.getItem("vocab_pro_mimic_practice_queue"),G=localStorage.getItem("vocab_pro_adventure_chapters"),Y=localStorage.getItem("vocab_pro_custom_badges"),K=localStorage.getItem("reading_books_shelves"),I=localStorage.getItem("vocab_pro_system_config");return{v:8,ca:new Date().toISOString(),user:zw(e),vocab:s.map(A=>Ga(A)),u:r,pl:l,st:d,sl:m,wt:v,wl:S,iv:P,lessons:M,listeningItems:j,nativeSpeakItems:p.map(A=>Ga(A)),conversationItems:y.map(A=>Ga(A)),freeTalkItems:x.map(A=>Ga(A)),compositions:N,mimicQueue:H?JSON.parse(H):[],wordBooks:V.map(A=>Ga(A)),readingBooks:o,pg:B,adv:{ch:G?JSON.parse(G):null,b:Y?JSON.parse(Y):null},readingShelves:K?JSON.parse(K):null,settings:I?JSON.parse(I):null}}const SN=()=>{const[n,e]=D.useState(null),[s,r]=D.useState(!1),[o,l]=D.useState(!1),d=D.useCallback(async()=>{r(!1),l(!1);const x=localStorage.getItem("vocab_pro_current_user_id"),v=localStorage.getItem("vocab_pro_current_user_name"),S=localStorage.getItem("vocab_pro_auto_restore");let N=(await gl()).filter(G=>!G.name.toLowerCase().includes("book"));const P=N.length===0,M=S==="true"||P,j=v||x||"Vocab Master";if(M){window.isRestoring=!0;try{const G=await eS(j);G&&G.type==="success"&&(G.backupTimestamp&&localStorage.setItem("vocab_pro_last_backup_timestamp",String(G.backupTimestamp)),N=(await gl()).filter(Y=>!Y.name.toLowerCase().includes("book")),G.updatedUser&&(localStorage.setItem("vocab_pro_current_user_id",G.updatedUser.id),localStorage.setItem("vocab_pro_current_user_name",G.updatedUser.name)))}catch{}finally{setTimeout(()=>{window.isRestoring=!1},2e3)}S&&localStorage.removeItem("vocab_pro_auto_restore")}await Lg();const V=(await gl()).filter(G=>!G.name.toLowerCase().includes("book"));let B=null;const H=localStorage.getItem("vocab_pro_current_user_id");if(V.length===1?(B=V[0],l(!0)):H&&V.length>1&&(B=V.find(G=>G.id===H)||null,B&&l(!0)),B){let G=!1;B.adventure?(B.adventure.completedSegmentIds.length===0&&(B.adventure.keys===0||B.adventure.keys===void 0)&&(B.adventure.keys=1,G=!0),B.adventure.map||(B.adventure.map=Gc(100),G=!0)):(B.adventure={currentNodeIndex:0,energy:5,energyShards:0,unlockedChapterIds:ml.map(Y=>Y.id),completedSegmentIds:[],segmentStars:{},badges:[],keys:1,keyFragments:0,map:Gc(100)},G=!0),G&&await ra(B),e(B),localStorage.setItem("vocab_pro_current_user_id",B.id),localStorage.setItem("vocab_pro_current_user_name",B.name)}r(!0)},[]);return D.useEffect(()=>{d()},[d]),{currentUser:n,isLoaded:s,handleLogin:async x=>{x.adventure.map||(x.adventure.map=Gc(100),await ra(x)),e(x),localStorage.setItem("vocab_pro_current_user_id",x.id),localStorage.setItem("vocab_pro_current_user_name",x.name);const v={...x,lastLogin:Date.now()};ra(v)},handleLogout:()=>{e(null),localStorage.removeItem("vocab_pro_current_user_id")},handleUpdateUser:async x=>{await ra(x),e(x),x.id===localStorage.getItem("vocab_pro_current_user_id")&&localStorage.setItem("vocab_pro_current_user_name",x.name)},setCurrentUser:e,shouldSkipAuth:o}},TN=({setView:n,setIsSidebarOpen:e})=>{const[s,r]=D.useState(null),[o,l]=D.useState(null),[d,m]=D.useState(null);D.useEffect(()=>{try{const x=sessionStorage.getItem("vocab_pro_active_session");if(x){const{words:v,type:S}=JSON.parse(x);Array.isArray(v)&&v.length>0&&(r(v),m(S))}}catch(x){console.error("Failed to restore session",x),sessionStorage.removeItem("vocab_pro_active_session")}},[]);const p=D.useCallback((x,v,S=null)=>{if(x.length>0){const P=[...Array.from(new Map(x.map(M=>[M.id,M])).values())].sort(()=>Math.random()-.5);r(P),m(v),l(S),sessionStorage.setItem("vocab_pro_active_session",JSON.stringify({words:P,type:v})),sessionStorage.removeItem("vocab_pro_session_progress"),sessionStorage.removeItem("vocab_pro_session_outcomes"),n("REVIEW"),e(!1)}},[n,e]),y=D.useCallback(()=>{sessionStorage.removeItem("vocab_pro_active_session"),sessionStorage.removeItem("vocab_pro_session_progress"),sessionStorage.removeItem("vocab_pro_session_outcomes"),r(null),m(null),l(null)},[]);return{sessionWords:s,setSessionWords:r,sessionType:d,sessionFocus:o,startSession:p,clearSessionState:y}},il=n=>n<1?0:n<=5?100+n*50:n<=10?350+(n-5)*100:850+(n-10)*200,AN=[{level:1,title:"Vocab Novice"},{level:5,title:"Word Apprentice"},{level:10,title:"Lexical Explorer"},{level:20,title:"Master Grammarian"},{level:30,title:"IELTS Wordsmith"},{level:50,title:"IELTS Luminary"}],Xp=n=>{let e="Vocab Novice";for(const s of AN)if(n>=s.level)e=s.title;else break;return e},Ev=(n,e)=>{let s=0;for(let r=1;r<n;r++)s+=il(r);return s+=e,s},IN=({currentUser:n,onUpdateUser:e,onSaveWordAndUser:s})=>{const[r,o]=D.useState(null),{showToast:l}=Za(),d=D.useRef(n);D.useEffect(()=>{d.current=n},[n]);const m=D.useCallback(async(x,v,S,N)=>{const P=d.current;if(!P)return 0;let M=x;if(v){const R=Date.now(),L=new Date(R).toDateString();if(v.lastXpEarnedTime&&new Date(v.lastXpEarnedTime).toDateString()===L)return 0;if(N&&N.tested>0){const O=N.correct/N.tested;M*=1+(O-.7)}S===Ct.EASY&&(M*=1.1),S===Ct.FORGOT&&(M*=.1),M=Math.round(Math.max(5,M)),v.lastXpEarnedTime=R}const V=Ev(P.level,P.experience)+Math.round(M);let B=1,H=V,G=il(B);for(;H>=G;)H-=G,B++,G=il(B);const Y=Math.floor(H),K=P.level,I=B>K,A=Xp(B),_={...P,experience:Y,level:B,peakLevel:Math.max(P.peakLevel||K,B),role:A};let C=!1;if(!v&&x>0&&Math.random()<.2){const R={..._.adventure};R.keyFragments=(R.keyFragments||0)+1,l("You found a Key Fragment! ","success",2e3),R.keyFragments>=3&&(R.keyFragments-=3,R.keys=(R.keys||0)+1,C=!0),_.adventure=R}return v?await s(v,_):await e(_),C&&l(" Key Fragments assembled into a Magic Key!","success",4e3),o({amount:Math.round(M),levelUp:I,newLevel:I?B:null}),setTimeout(()=>o(null),I?5e3:2e3),I&&l(` Level Up to ${B}! New title: "${A}"`,"success",5e3),Math.round(M)},[e,s,l]),p=D.useCallback(async x=>{const v=d.current;if(!v)return;const S=Ev(v.level,v.experience),N=x-S;if(N===0)return;let P=1,M=x,j=il(P);for(;M>=j;)M-=j,P++,j=il(P);const V=Math.floor(M),B=v.level,H=v.peakLevel||B,G=Math.max(H,P),Y=Xp(P),K=P>B,I=P>H,A=Y!==Xp(H),_={...v,experience:V,level:P,peakLevel:G,role:Y};if(I){let C=1,R=!1,L=` New Peak Level: ${P}! +1 Key Fragment`;for(A&&(C++,L=`New Title: "${Y}"! +2 Key Fragments`),_.adventure.keyFragments=(_.adventure.keyFragments||0)+C;_.adventure.keyFragments>=3;)_.adventure.keyFragments-=3,_.adventure.keys=(_.adventure.keys||0)+1,R=!0;l(L,"success",6e3),R&&l(" Key Fragments assembled into a Magic Key!","success",4e3)}else if(K)l(` Level Up to ${P}!`,"success",4e3);else if(N!==0){const C=N>0?"+":"";l(`XP Recalculated: ${C}${N} XP`,"info",2e3)}await e(_),o({amount:N,levelUp:K,newLevel:K?P:null}),setTimeout(()=>o(null),K?5e3:2e3)},[l,e]),y=D.useMemo(()=>n?il(n.level):0,[n]);return{recalculateXpAndLevelUp:p,gainExperienceAndLevelUp:m,xpGained:r,xpToNextLevel:y}};function hu(n,e){try{const s=localStorage.getItem(n);if(s)return JSON.parse(s)}catch(s){console.error(`Error parsing JSON from localStorage for key "${n}":`,s)}return e}function Kg(n,e){try{localStorage.setItem(n,JSON.stringify(e))}catch(s){console.error(`Error saving JSON to localStorage for key "${n}":`,s)}}const NN="vocab_pro_adventure_chapters";function CN(){return hu(NN,ml)}const RN=({currentUser:n,onUpdateUser:e})=>{const[s,r]=D.useState({total:0,due:0,new:0,learned:0}),[o,l]=D.useState(null),[d,m]=D.useState(null),[p,y]=D.useState(!1),[x,v]=D.useState({count:0,date:""}),{showToast:S}=Za(),N=D.useCallback(async()=>{if(!n)return;await Ww(n.id);const j=Xw();r(j.reviewCounts);const V=ii().filter(I=>I.userId===n.id),H=V.filter(I=>!I.isPassive).filter(I=>I.quality===Vt.VERIFIED);let G=null;if(d)G=d;else if(H.length>0){const I=new Date().toISOString().slice(0,10).replace(/-/g,""),A=n.id.length>4&&parseInt(n.id.substring(n.id.length-4),16)||1234,C=(parseInt(I)+A)%H.length;G=H[C]}l(G),y(G?pN(G.id):!1);const Y=CN(),K=n.adventure;if(K){const I=new Map(V.map(L=>[L.word.toLowerCase(),L])),A={...K};let _=!1,C=!1;const R=new Date().toISOString().split("T")[0];for(const L of Y)for(const O of L.segments){if(!A.completedSegmentIds.includes(O.id))continue;let xe=A.segmentStars[O.id]||0;const ge=(F,ue)=>{A.segmentStars[O.id]=F,A.keyFragments=(A.keyFragments||0)+1,_=!0,S(ue,"success",5e3),!C&&n.adventureLastDailyStar!==R&&(A.keyFragments++,C=!0,S("Bonus: First star of the day! (+1 Key Fragment)","success",6e3))};xe<3&&(xe<1&&O.basicWords.length>0&&O.basicWords.every(F=>{var ue;return(((ue=I.get(F.toLowerCase()))==null?void 0:ue.consecutiveCorrect)??0)>0})&&(ge(1,` 1-Star Mastery for "${O.title}"! (+1 Key Fragment)`),xe=1),xe===1&&O.intermediateWords.length>0&&O.intermediateWords.every(F=>{var ue;return(((ue=I.get(F.toLowerCase()))==null?void 0:ue.consecutiveCorrect)??0)>0})&&(ge(2,` 2-Star Mastery for "${O.title}"! (+1 Key Fragment)`),xe=2),xe===2&&O.advancedWords.length>0&&O.advancedWords.every(F=>{var ue;return(((ue=I.get(F.toLowerCase()))==null?void 0:ue.consecutiveCorrect)??0)>0})&&ge(3,` Boss unlocked for "${O.title}"! (+1 Key Fragment)`))}if(_){for(;A.keyFragments>=3;)A.keyFragments-=3,A.keys=(A.keys||0)+1,S(" Key Fragments assembled into a Magic Key!","success",4e3);const L={...n,adventure:A,adventureLastDailyStar:C?R:n.adventureLastDailyStar};e(L)}}},[n,S,e,d]);D.useEffect(()=>{d&&N()},[d]),D.useEffect(()=>{n&&N();const j=()=>{S("Saving too quickly. Please wait.","info",1500)};return window.addEventListener("datastore-updated",N),window.addEventListener("datastore-cooldown",j),()=>{window.removeEventListener("datastore-updated",N),window.removeEventListener("datastore-cooldown",j)}},[n,N,S]);const P=D.useCallback(()=>{const j=new Date().toISOString().split("T")[0];let V=hu("vocab_pro_api_usage",{count:0,date:"1970-01-01"});V.date!==j&&(V={count:0,date:j}),v(V)},[]);return D.useEffect(()=>(P(),window.addEventListener("apiUsageUpdated",P),()=>{window.removeEventListener("apiUsageUpdated",P)}),[P]),{stats:s,wotd:o,setWotd:l,apiUsage:x,refreshGlobalStats:N,isWotdComposed:p,randomizeWotd:()=>{if(!n)return;const V=ii().filter(B=>B.userId===n.id).filter(B=>!B.isPassive&&B.quality===Vt.VERIFIED);if(V.length>0){const B=V[Math.floor(Math.random()*V.length)];m(B)}}}},ON=n=>{const{currentUser:e,setView:s,refreshGlobalStats:r,sessionWords:o,setSessionWords:l,globalViewWord:d,setGlobalViewWord:m,onUpdateUser:p}=n,{showToast:y}=Za(),x=()=>{var R;const I=Number(localStorage.getItem("vocab_pro_last_backup_timestamp"))||0,_=((R=Dt().sync)==null?void 0:R.lastSyncTime)||0,C=Math.max(I,_);return C>0?C:null},[v,S]=D.useState(x()),N=D.useCallback(()=>{S(x())},[]),P=async I=>{if(!e)return;const A=I||{vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,wordBook:!0,planning:!0},_=await nN(e.id,e,A),C=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),R=URL.createObjectURL(C),L=document.createElement("a");L.href=R,L.download=`vocab-pro-backup-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(R);const O=Date.now();localStorage.setItem("vocab_pro_last_backup_timestamp",String(O)),localStorage.setItem("vocab_pro_local_last_modified",String(O)),N(),sessionStorage.removeItem("vocab_pro_just_restored"),y("Backup file downloaded.","success")},M=async(I,A,_)=>{var xe;qm();const C=Dt();if(A)try{const ge=JSON.parse(A),F={...C,server:ge.server};localStorage.setItem("vocab_pro_system_config",JSON.stringify(F)),window.dispatchEvent(new Event("config-updated"))}catch(ge){console.error("[Restore] Failed to merge config",ge)}sessionStorage.setItem("vocab_pro_just_restored","true");const R=_||I.backupTimestamp||Date.now();localStorage.setItem("vocab_pro_last_backup_timestamp",String(R)),localStorage.setItem("vocab_pro_local_last_modified",String(R));const L=Dt();qc({...L,sync:{...L.sync,lastSyncTime:R}},!0);const O=((xe=I.updatedUser)==null?void 0:xe.id)||(e==null?void 0:e.id);O&&await $m(O),I.updatedUser&&(localStorage.setItem("vocab_pro_current_user_id",I.updatedUser.id),localStorage.setItem("vocab_pro_current_user_name",I.updatedUser.name),await p(I.updatedUser)),y("Restore successful!","success",2e3),r(),window.dispatchEvent(new Event("vocab-pro-restore-complete")),window.dispatchEvent(new Event("vocab-pro-force-ui-reload")),setTimeout(()=>{window.isRestoring=!1},1e3)};return{lastBackupTime:v,refreshBackupTime:N,handleBackup:P,restoreFromServerAction:async(I,A)=>{const _=Dt(),C=JSON.stringify(_);window.isRestoring=!0,qm();try{const R=I||(e?e.name||e.id:null);if(!R){window.isRestoring=!1;return}await Kw(),C&&(localStorage.setItem("vocab_pro_system_config",C),window.dispatchEvent(new Event("config-updated")));const L=await eS(R);L&&L.type==="success"?await M(L,C,A):(y("Server restore failed. Manual restore may be required.","error"),window.isRestoring=!1)}catch(R){console.error("[DataActions] Restore error:",R),y("Restore encountered a fatal error.","error"),window.isRestoring=!1}},triggerLocalRestore:()=>{const I=Dt(),A=JSON.stringify(I),_=document.createElement("input");_.type="file",_.accept=".json",_.style.display="none",_.onchange=async C=>{var R;_.parentNode&&_.parentNode.removeChild(_);try{const L=(R=C.target.files)==null?void 0:R[0];if(!L)return;const O={user:!0,vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,mimic:!0,wordBook:!0,planning:!0};window.isRestoring=!0;const xe=e?e.id:"temp-restore",ge=await Fw(L,xe,O);ge.type==="success"?await M(ge,A):(y(`Restore failed: ${ge.message}`,"error",5e3),window.isRestoring=!1)}catch(L){console.error("Fatal error during local restore:",L),window.isRestoring=!1}},document.body.appendChild(_),_.click()},handleLibraryReset:async()=>{if(e)try{await Jw(),sessionStorage.removeItem("vocab_pro_skip_seed"),await vN(!0),await $m(e.id),r(),s("DASHBOARD")}catch{window.location.reload()}},updateWord:async I=>{await Of(I),o&&l(A=>(A||[]).map(_=>_.id===I.id?I:_)),d&&d.id===I.id&&(I.masteryScore=_s(I),m(I))},deleteWord:async I=>{d&&d.id===I&&m(null),await yN(I)},bulkDeleteWords:async I=>{await xN(I)},bulkUpdateWords:async I=>{await gN(I)}}},jN=()=>{};var wv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tS=function(n){const e=[];let s=0;for(let r=0;r<n.length;r++){let o=n.charCodeAt(r);o<128?e[s++]=o:o<2048?(e[s++]=o>>6|192,e[s++]=o&63|128):(o&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(n.charCodeAt(++r)&1023),e[s++]=o>>18|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128,e[s++]=o&63|128):(e[s++]=o>>12|224,e[s++]=o>>6&63|128,e[s++]=o&63|128)}return e},kN=function(n){const e=[];let s=0,r=0;for(;s<n.length;){const o=n[s++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){const l=n[s++];e[r++]=String.fromCharCode((o&31)<<6|l&63)}else if(o>239&&o<365){const l=n[s++],d=n[s++],m=n[s++],p=((o&7)<<18|(l&63)<<12|(d&63)<<6|m&63)-65536;e[r++]=String.fromCharCode(55296+(p>>10)),e[r++]=String.fromCharCode(56320+(p&1023))}else{const l=n[s++],d=n[s++];e[r++]=String.fromCharCode((o&15)<<12|(l&63)<<6|d&63)}}return e.join("")},nS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const s=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let o=0;o<n.length;o+=3){const l=n[o],d=o+1<n.length,m=d?n[o+1]:0,p=o+2<n.length,y=p?n[o+2]:0,x=l>>2,v=(l&3)<<4|m>>4;let S=(m&15)<<2|y>>6,N=y&63;p||(N=64,d||(S=64)),r.push(s[x],s[v],s[S],s[N])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(tS(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):kN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const s=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let o=0;o<n.length;){const l=s[n.charAt(o++)],m=o<n.length?s[n.charAt(o)]:0;++o;const y=o<n.length?s[n.charAt(o)]:64;++o;const v=o<n.length?s[n.charAt(o)]:64;if(++o,l==null||m==null||y==null||v==null)throw new LN;const S=l<<2|m>>4;if(r.push(S),y!==64){const N=m<<4&240|y>>2;if(r.push(N),v!==64){const P=y<<6&192|v;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class LN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const MN=function(n){const e=tS(n);return nS.encodeByteArray(e,!0)},cf=function(n){return MN(n).replace(/\./g,"")},DN=function(n){try{return nS.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PN=()=>UN().__FIREBASE_DEFAULTS__,VN=()=>{if(typeof process>"u"||typeof wv>"u")return;const n=wv.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},zN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&DN(n[1]);return e&&JSON.parse(e)},Zg=()=>{try{return jN()||PN()||VN()||zN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},BN=n=>{var e,s;return(s=(e=Zg())==null?void 0:e.emulatorHosts)==null?void 0:s[n]},FN=n=>{const e=BN(n);if(!e)return;const s=e.lastIndexOf(":");if(s<=0||s+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(s+1),10);return e[0]==="["?[e.substring(1,s-1),r]:[e.substring(0,s),r]},sS=()=>{var n;return(n=Zg())==null?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,s)=>{this.resolve=e,this.reject=s})}wrapCallback(e){return(s,r)=>{s?this.reject(s):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(s):e(s,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function GN(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qN(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const s={alg:"none",type:"JWT"},r=e||"demo-project",o=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const d={iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[cf(JSON.stringify(s)),cf(JSON.stringify(d)),""].join(".")}const Yc={};function $N(){const n={prod:[],emulator:[]};for(const e of Object.keys(Yc))Yc[e]?n.emulator.push(e):n.prod.push(e);return n}function YN(n){let e=document.getElementById(n),s=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),s=!0),{created:s,element:e}}let Sv=!1;function QN(n,e){if(typeof window>"u"||typeof document>"u"||!Xg(window.location.host)||Yc[n]===e||Yc[n]||Sv)return;Yc[n]=e;function s(S){return`__firebase__banner__${S}`}const r="__firebase__banner",l=$N().prod.length>0;function d(){const S=document.getElementById(r);S&&S.remove()}function m(S){S.style.display="flex",S.style.background="#7faaf0",S.style.position="fixed",S.style.bottom="5px",S.style.left="5px",S.style.padding=".5em",S.style.borderRadius="5px",S.style.alignItems="center"}function p(S,N){S.setAttribute("width","24"),S.setAttribute("id",N),S.setAttribute("height","24"),S.setAttribute("viewBox","0 0 24 24"),S.setAttribute("fill","none"),S.style.marginLeft="-6px"}function y(){const S=document.createElement("span");return S.style.cursor="pointer",S.style.marginLeft="16px",S.style.fontSize="24px",S.innerHTML=" &times;",S.onclick=()=>{Sv=!0,d()},S}function x(S,N){S.setAttribute("id",N),S.innerText="Learn more",S.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",S.setAttribute("target","__blank"),S.style.paddingLeft="5px",S.style.textDecoration="underline"}function v(){const S=YN(r),N=s("text"),P=document.getElementById(N)||document.createElement("span"),M=s("learnmore"),j=document.getElementById(M)||document.createElement("a"),V=s("preprendIcon"),B=document.getElementById(V)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(S.created){const H=S.element;m(H),x(j,M);const G=y();p(B,V),H.append(B,P,j,G),document.body.appendChild(H)}l?(P.innerText="Preview backend disconnected.",B.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(B.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",N)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WN(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function KN(){var e;const n=(e=Zg())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ZN(){return!KN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function XN(){try{return typeof indexedDB=="object"}catch{return!1}}function JN(){return new Promise((n,e)=>{try{let s=!0;const r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=()=>{o.result.close(),s||self.indexedDB.deleteDatabase(r),n(!0)},o.onupgradeneeded=()=>{s=!1},o.onerror=()=>{var l;e(((l=o.error)==null?void 0:l.message)||"")}}catch(s){e(s)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eC="FirebaseError";class kl extends Error{constructor(e,s,r){super(s),this.code=e,this.customData=r,this.name=eC,Object.setPrototypeOf(this,kl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,aS.prototype.create)}}class aS{constructor(e,s,r){this.service=e,this.serviceName=s,this.errors=r}create(e,...s){const r=s[0]||{},o=`${this.service}/${e}`,l=this.errors[e],d=l?tC(l,r):"Error",m=`${this.serviceName}: ${d} (${o}).`;return new kl(o,m,r)}}function tC(n,e){return n.replace(nC,(s,r)=>{const o=e[r];return o!=null?String(o):`<${r}?>`})}const nC=/\{\$([^}]+)}/g;function uf(n,e){if(n===e)return!0;const s=Object.keys(n),r=Object.keys(e);for(const o of s){if(!r.includes(o))return!1;const l=n[o],d=e[o];if(Tv(l)&&Tv(d)){if(!uf(l,d))return!1}else if(l!==d)return!1}for(const o of r)if(!s.includes(o))return!1;return!0}function Tv(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rS(n){return n&&n._delegate?n._delegate:n}class nu{constructor(e,s,r){this.name=e,this.instanceFactory=s,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(e,s){this.name=e,this.container=s,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const s=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(s)){const r=new HN;if(this.instancesDeferred.set(s,r),this.isInitialized(s)||this.shouldAutoInitialize())try{const o=this.getOrInitializeService({instanceIdentifier:s});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(s).promise}getImmediate(e){const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(o){if(r)return null;throw o}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(rC(e))try{this.getOrInitializeService({instanceIdentifier:Yi})}catch{}for(const[s,r]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);try{const l=this.getOrInitializeService({instanceIdentifier:o});r.resolve(l)}catch{}}}}clearInstance(e=Yi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(s=>"INTERNAL"in s).map(s=>s.INTERNAL.delete()),...e.filter(s=>"_delete"in s).map(s=>s._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yi){return this.instances.has(e)}getOptions(e=Yi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:s={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const o=this.getOrInitializeService({instanceIdentifier:r,options:s});for(const[l,d]of this.instancesDeferred.entries()){const m=this.normalizeInstanceIdentifier(l);r===m&&d.resolve(o)}return o}onInit(e,s){const r=this.normalizeInstanceIdentifier(s),o=this.onInitCallbacks.get(r)??new Set;o.add(e),this.onInitCallbacks.set(r,o);const l=this.instances.get(r);return l&&e(l,r),()=>{o.delete(e)}}invokeOnInitCallbacks(e,s){const r=this.onInitCallbacks.get(s);if(r)for(const o of r)try{o(e,s)}catch{}}getOrInitializeService({instanceIdentifier:e,options:s={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:aC(e),options:s}),this.instances.set(e,r),this.instancesOptions.set(e,s),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Yi){return this.component?this.component.multipleInstances?e:Yi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function aC(n){return n===Yi?void 0:n}function rC(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const s=this.getProvider(e.name);if(s.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);s.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const s=new sC(e,this);return this.providers.set(e,s),s}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(gt||(gt={}));const oC={debug:gt.DEBUG,verbose:gt.VERBOSE,info:gt.INFO,warn:gt.WARN,error:gt.ERROR,silent:gt.SILENT},lC=gt.INFO,cC={[gt.DEBUG]:"log",[gt.VERBOSE]:"log",[gt.INFO]:"info",[gt.WARN]:"warn",[gt.ERROR]:"error"},uC=(n,e,...s)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),o=cC[e];if(o)console[o](`[${r}]  ${n.name}:`,...s);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class iS{constructor(e){this.name=e,this._logLevel=lC,this._logHandler=uC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in gt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?oC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,gt.DEBUG,...e),this._logHandler(this,gt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,gt.VERBOSE,...e),this._logHandler(this,gt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,gt.INFO,...e),this._logHandler(this,gt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,gt.WARN,...e),this._logHandler(this,gt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,gt.ERROR,...e),this._logHandler(this,gt.ERROR,...e)}}const dC=(n,e)=>e.some(s=>n instanceof s);let Av,Iv;function fC(){return Av||(Av=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function hC(){return Iv||(Iv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const oS=new WeakMap,Qm=new WeakMap,lS=new WeakMap,Jp=new WeakMap,Jg=new WeakMap;function pC(n){const e=new Promise((s,r)=>{const o=()=>{n.removeEventListener("success",l),n.removeEventListener("error",d)},l=()=>{s(oi(n.result)),o()},d=()=>{r(n.error),o()};n.addEventListener("success",l),n.addEventListener("error",d)});return e.then(s=>{s instanceof IDBCursor&&oS.set(s,n)}).catch(()=>{}),Jg.set(e,n),e}function mC(n){if(Qm.has(n))return;const e=new Promise((s,r)=>{const o=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",d),n.removeEventListener("abort",d)},l=()=>{s(),o()},d=()=>{r(n.error||new DOMException("AbortError","AbortError")),o()};n.addEventListener("complete",l),n.addEventListener("error",d),n.addEventListener("abort",d)});Qm.set(n,e)}let Wm={get(n,e,s){if(n instanceof IDBTransaction){if(e==="done")return Qm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||lS.get(n);if(e==="store")return s.objectStoreNames[1]?void 0:s.objectStore(s.objectStoreNames[0])}return oi(n[e])},set(n,e,s){return n[e]=s,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function gC(n){Wm=n(Wm)}function yC(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...s){const r=n.call(em(this),e,...s);return lS.set(r,e.sort?e.sort():[e]),oi(r)}:hC().includes(n)?function(...e){return n.apply(em(this),e),oi(oS.get(this))}:function(...e){return oi(n.apply(em(this),e))}}function xC(n){return typeof n=="function"?yC(n):(n instanceof IDBTransaction&&mC(n),dC(n,fC())?new Proxy(n,Wm):n)}function oi(n){if(n instanceof IDBRequest)return pC(n);if(Jp.has(n))return Jp.get(n);const e=xC(n);return e!==n&&(Jp.set(n,e),Jg.set(e,n)),e}const em=n=>Jg.get(n);function bC(n,e,{blocked:s,upgrade:r,blocking:o,terminated:l}={}){const d=indexedDB.open(n,e),m=oi(d);return r&&d.addEventListener("upgradeneeded",p=>{r(oi(d.result),p.oldVersion,p.newVersion,oi(d.transaction),p)}),s&&d.addEventListener("blocked",p=>s(p.oldVersion,p.newVersion,p)),m.then(p=>{l&&p.addEventListener("close",()=>l()),o&&p.addEventListener("versionchange",y=>o(y.oldVersion,y.newVersion,y))}).catch(()=>{}),m}const vC=["get","getKey","getAll","getAllKeys","count"],_C=["put","add","delete","clear"],tm=new Map;function Nv(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(tm.get(e))return tm.get(e);const s=e.replace(/FromIndex$/,""),r=e!==s,o=_C.includes(s);if(!(s in(r?IDBIndex:IDBObjectStore).prototype)||!(o||vC.includes(s)))return;const l=async function(d,...m){const p=this.transaction(d,o?"readwrite":"readonly");let y=p.store;return r&&(y=y.index(m.shift())),(await Promise.all([y[s](...m),o&&p.done]))[0]};return tm.set(e,l),l}gC(n=>({...n,get:(e,s,r)=>Nv(e,s)||n.get(e,s,r),has:(e,s)=>!!Nv(e,s)||n.has(e,s)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(s=>{if(wC(s)){const r=s.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(s=>s).join(" ")}}function wC(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Km="@firebase/app",Cv="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr=new iS("@firebase/app"),SC="@firebase/app-compat",TC="@firebase/analytics-compat",AC="@firebase/analytics",IC="@firebase/app-check-compat",NC="@firebase/app-check",CC="@firebase/auth",RC="@firebase/auth-compat",OC="@firebase/database",jC="@firebase/data-connect",kC="@firebase/database-compat",LC="@firebase/functions",MC="@firebase/functions-compat",DC="@firebase/installations",UC="@firebase/installations-compat",PC="@firebase/messaging",VC="@firebase/messaging-compat",zC="@firebase/performance",BC="@firebase/performance-compat",FC="@firebase/remote-config",HC="@firebase/remote-config-compat",GC="@firebase/storage",qC="@firebase/storage-compat",$C="@firebase/firestore",YC="@firebase/ai",QC="@firebase/firestore-compat",WC="firebase",KC="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zm="[DEFAULT]",ZC={[Km]:"fire-core",[SC]:"fire-core-compat",[AC]:"fire-analytics",[TC]:"fire-analytics-compat",[NC]:"fire-app-check",[IC]:"fire-app-check-compat",[CC]:"fire-auth",[RC]:"fire-auth-compat",[OC]:"fire-rtdb",[jC]:"fire-data-connect",[kC]:"fire-rtdb-compat",[LC]:"fire-fn",[MC]:"fire-fn-compat",[DC]:"fire-iid",[UC]:"fire-iid-compat",[PC]:"fire-fcm",[VC]:"fire-fcm-compat",[zC]:"fire-perf",[BC]:"fire-perf-compat",[FC]:"fire-rc",[HC]:"fire-rc-compat",[GC]:"fire-gcs",[qC]:"fire-gcs-compat",[$C]:"fire-fst",[QC]:"fire-fst-compat",[YC]:"fire-vertex","fire-js":"fire-js",[WC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const df=new Map,XC=new Map,Xm=new Map;function Rv(n,e){try{n.container.addComponent(e)}catch(s){wr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,s)}}function ff(n){const e=n.name;if(Xm.has(e))return wr.debug(`There were multiple attempts to register component ${e}.`),!1;Xm.set(e,n);for(const s of df.values())Rv(s,n);for(const s of XC.values())Rv(s,n);return!0}function JC(n,e){const s=n.container.getProvider("heartbeat").getImmediate({optional:!0});return s&&s.triggerHeartbeat(),n.container.getProvider(e)}function eR(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},li=new aS("app","Firebase",tR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{constructor(e,s,r){this._isDeleted=!1,this._options={...e},this._config={...s},this._name=s.name,this._automaticDataCollectionEnabled=s.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new nu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw li.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR=KC;function cS(n,e={}){let s=n;typeof e!="object"&&(e={name:e});const r={name:Zm,automaticDataCollectionEnabled:!0,...e},o=r.name;if(typeof o!="string"||!o)throw li.create("bad-app-name",{appName:String(o)});if(s||(s=sS()),!s)throw li.create("no-options");const l=df.get(o);if(l){if(uf(s,l.options)&&uf(r,l.config))return l;throw li.create("duplicate-app",{appName:o})}const d=new iC(o);for(const p of Xm.values())d.addComponent(p);const m=new nR(s,r,d);return df.set(o,m),m}function aR(n=Zm){const e=df.get(n);if(!e&&n===Zm&&sS())return cS();if(!e)throw li.create("no-app",{appName:n});return e}function xl(n,e,s){let r=ZC[n]??n;s&&(r+=`-${s}`);const o=r.match(/\s|\//),l=e.match(/\s|\//);if(o||l){const d=[`Unable to register library "${r}" with version "${e}":`];o&&d.push(`library name "${r}" contains illegal characters (whitespace or "/")`),o&&l&&d.push("and"),l&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),wr.warn(d.join(" "));return}ff(new nu(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR="firebase-heartbeat-database",iR=1,su="firebase-heartbeat-store";let nm=null;function uS(){return nm||(nm=bC(rR,iR,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(su)}catch(s){console.warn(s)}}}}).catch(n=>{throw li.create("idb-open",{originalErrorMessage:n.message})})),nm}async function oR(n){try{const s=(await uS()).transaction(su),r=await s.objectStore(su).get(dS(n));return await s.done,r}catch(e){if(e instanceof kl)wr.warn(e.message);else{const s=li.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});wr.warn(s.message)}}}async function Ov(n,e){try{const r=(await uS()).transaction(su,"readwrite");await r.objectStore(su).put(e,dS(n)),await r.done}catch(s){if(s instanceof kl)wr.warn(s.message);else{const r=li.create("idb-set",{originalErrorMessage:s==null?void 0:s.message});wr.warn(r.message)}}}function dS(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lR=1024,cR=30;class uR{constructor(e){this.container=e,this._heartbeatsCache=null;const s=this.container.getProvider("app").getImmediate();this._storage=new fR(s),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,s;try{const o=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=jv();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((s=this._heartbeatsCache)==null?void 0:s.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:o}),this._heartbeatsCache.heartbeats.length>cR){const d=hR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){wr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const s=jv(),{heartbeatsToSend:r,unsentEntries:o}=dR(this._heartbeatsCache.heartbeats),l=cf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=s,o.length>0?(this._heartbeatsCache.heartbeats=o,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(s){return wr.warn(s),""}}}function jv(){return new Date().toISOString().substring(0,10)}function dR(n,e=lR){const s=[];let r=n.slice();for(const o of n){const l=s.find(d=>d.agent===o.agent);if(l){if(l.dates.push(o.date),kv(s)>e){l.dates.pop();break}}else if(s.push({agent:o.agent,dates:[o.date]}),kv(s)>e){s.pop();break}r=r.slice(1)}return{heartbeatsToSend:s,unsentEntries:r}}class fR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return XN()?JN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const s=await oR(this.app);return s!=null&&s.heartbeats?s:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Ov(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return Ov(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function kv(n){return cf(JSON.stringify({version:2,heartbeats:n})).length}function hR(n){if(n.length===0)return-1;let e=0,s=n[0].date;for(let r=1;r<n.length;r++)n[r].date<s&&(s=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pR(n){ff(new nu("platform-logger",e=>new EC(e),"PRIVATE")),ff(new nu("heartbeat",e=>new uR(e),"PRIVATE")),xl(Km,Cv,n),xl(Km,Cv,"esm2020"),xl("fire-js","")}pR("");var mR="firebase",gR="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xl(mR,gR,"app");var Lv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ci,fS;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,A){function _(){}_.prototype=A.prototype,I.F=A.prototype,I.prototype=new _,I.prototype.constructor=I,I.D=function(C,R,L){for(var O=Array(arguments.length-2),xe=2;xe<arguments.length;xe++)O[xe-2]=arguments[xe];return A.prototype[R].apply(C,O)}}function s(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,s),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function o(I,A,_){_||(_=0);const C=Array(16);if(typeof A=="string")for(var R=0;R<16;++R)C[R]=A.charCodeAt(_++)|A.charCodeAt(_++)<<8|A.charCodeAt(_++)<<16|A.charCodeAt(_++)<<24;else for(R=0;R<16;++R)C[R]=A[_++]|A[_++]<<8|A[_++]<<16|A[_++]<<24;A=I.g[0],_=I.g[1],R=I.g[2];let L=I.g[3],O;O=A+(L^_&(R^L))+C[0]+3614090360&4294967295,A=_+(O<<7&4294967295|O>>>25),O=L+(R^A&(_^R))+C[1]+3905402710&4294967295,L=A+(O<<12&4294967295|O>>>20),O=R+(_^L&(A^_))+C[2]+606105819&4294967295,R=L+(O<<17&4294967295|O>>>15),O=_+(A^R&(L^A))+C[3]+3250441966&4294967295,_=R+(O<<22&4294967295|O>>>10),O=A+(L^_&(R^L))+C[4]+4118548399&4294967295,A=_+(O<<7&4294967295|O>>>25),O=L+(R^A&(_^R))+C[5]+1200080426&4294967295,L=A+(O<<12&4294967295|O>>>20),O=R+(_^L&(A^_))+C[6]+2821735955&4294967295,R=L+(O<<17&4294967295|O>>>15),O=_+(A^R&(L^A))+C[7]+4249261313&4294967295,_=R+(O<<22&4294967295|O>>>10),O=A+(L^_&(R^L))+C[8]+1770035416&4294967295,A=_+(O<<7&4294967295|O>>>25),O=L+(R^A&(_^R))+C[9]+2336552879&4294967295,L=A+(O<<12&4294967295|O>>>20),O=R+(_^L&(A^_))+C[10]+4294925233&4294967295,R=L+(O<<17&4294967295|O>>>15),O=_+(A^R&(L^A))+C[11]+2304563134&4294967295,_=R+(O<<22&4294967295|O>>>10),O=A+(L^_&(R^L))+C[12]+1804603682&4294967295,A=_+(O<<7&4294967295|O>>>25),O=L+(R^A&(_^R))+C[13]+4254626195&4294967295,L=A+(O<<12&4294967295|O>>>20),O=R+(_^L&(A^_))+C[14]+2792965006&4294967295,R=L+(O<<17&4294967295|O>>>15),O=_+(A^R&(L^A))+C[15]+1236535329&4294967295,_=R+(O<<22&4294967295|O>>>10),O=A+(R^L&(_^R))+C[1]+4129170786&4294967295,A=_+(O<<5&4294967295|O>>>27),O=L+(_^R&(A^_))+C[6]+3225465664&4294967295,L=A+(O<<9&4294967295|O>>>23),O=R+(A^_&(L^A))+C[11]+643717713&4294967295,R=L+(O<<14&4294967295|O>>>18),O=_+(L^A&(R^L))+C[0]+3921069994&4294967295,_=R+(O<<20&4294967295|O>>>12),O=A+(R^L&(_^R))+C[5]+3593408605&4294967295,A=_+(O<<5&4294967295|O>>>27),O=L+(_^R&(A^_))+C[10]+38016083&4294967295,L=A+(O<<9&4294967295|O>>>23),O=R+(A^_&(L^A))+C[15]+3634488961&4294967295,R=L+(O<<14&4294967295|O>>>18),O=_+(L^A&(R^L))+C[4]+3889429448&4294967295,_=R+(O<<20&4294967295|O>>>12),O=A+(R^L&(_^R))+C[9]+568446438&4294967295,A=_+(O<<5&4294967295|O>>>27),O=L+(_^R&(A^_))+C[14]+3275163606&4294967295,L=A+(O<<9&4294967295|O>>>23),O=R+(A^_&(L^A))+C[3]+4107603335&4294967295,R=L+(O<<14&4294967295|O>>>18),O=_+(L^A&(R^L))+C[8]+1163531501&4294967295,_=R+(O<<20&4294967295|O>>>12),O=A+(R^L&(_^R))+C[13]+2850285829&4294967295,A=_+(O<<5&4294967295|O>>>27),O=L+(_^R&(A^_))+C[2]+4243563512&4294967295,L=A+(O<<9&4294967295|O>>>23),O=R+(A^_&(L^A))+C[7]+1735328473&4294967295,R=L+(O<<14&4294967295|O>>>18),O=_+(L^A&(R^L))+C[12]+2368359562&4294967295,_=R+(O<<20&4294967295|O>>>12),O=A+(_^R^L)+C[5]+4294588738&4294967295,A=_+(O<<4&4294967295|O>>>28),O=L+(A^_^R)+C[8]+2272392833&4294967295,L=A+(O<<11&4294967295|O>>>21),O=R+(L^A^_)+C[11]+1839030562&4294967295,R=L+(O<<16&4294967295|O>>>16),O=_+(R^L^A)+C[14]+4259657740&4294967295,_=R+(O<<23&4294967295|O>>>9),O=A+(_^R^L)+C[1]+2763975236&4294967295,A=_+(O<<4&4294967295|O>>>28),O=L+(A^_^R)+C[4]+1272893353&4294967295,L=A+(O<<11&4294967295|O>>>21),O=R+(L^A^_)+C[7]+4139469664&4294967295,R=L+(O<<16&4294967295|O>>>16),O=_+(R^L^A)+C[10]+3200236656&4294967295,_=R+(O<<23&4294967295|O>>>9),O=A+(_^R^L)+C[13]+681279174&4294967295,A=_+(O<<4&4294967295|O>>>28),O=L+(A^_^R)+C[0]+3936430074&4294967295,L=A+(O<<11&4294967295|O>>>21),O=R+(L^A^_)+C[3]+3572445317&4294967295,R=L+(O<<16&4294967295|O>>>16),O=_+(R^L^A)+C[6]+76029189&4294967295,_=R+(O<<23&4294967295|O>>>9),O=A+(_^R^L)+C[9]+3654602809&4294967295,A=_+(O<<4&4294967295|O>>>28),O=L+(A^_^R)+C[12]+3873151461&4294967295,L=A+(O<<11&4294967295|O>>>21),O=R+(L^A^_)+C[15]+530742520&4294967295,R=L+(O<<16&4294967295|O>>>16),O=_+(R^L^A)+C[2]+3299628645&4294967295,_=R+(O<<23&4294967295|O>>>9),O=A+(R^(_|~L))+C[0]+4096336452&4294967295,A=_+(O<<6&4294967295|O>>>26),O=L+(_^(A|~R))+C[7]+1126891415&4294967295,L=A+(O<<10&4294967295|O>>>22),O=R+(A^(L|~_))+C[14]+2878612391&4294967295,R=L+(O<<15&4294967295|O>>>17),O=_+(L^(R|~A))+C[5]+4237533241&4294967295,_=R+(O<<21&4294967295|O>>>11),O=A+(R^(_|~L))+C[12]+1700485571&4294967295,A=_+(O<<6&4294967295|O>>>26),O=L+(_^(A|~R))+C[3]+2399980690&4294967295,L=A+(O<<10&4294967295|O>>>22),O=R+(A^(L|~_))+C[10]+4293915773&4294967295,R=L+(O<<15&4294967295|O>>>17),O=_+(L^(R|~A))+C[1]+2240044497&4294967295,_=R+(O<<21&4294967295|O>>>11),O=A+(R^(_|~L))+C[8]+1873313359&4294967295,A=_+(O<<6&4294967295|O>>>26),O=L+(_^(A|~R))+C[15]+4264355552&4294967295,L=A+(O<<10&4294967295|O>>>22),O=R+(A^(L|~_))+C[6]+2734768916&4294967295,R=L+(O<<15&4294967295|O>>>17),O=_+(L^(R|~A))+C[13]+1309151649&4294967295,_=R+(O<<21&4294967295|O>>>11),O=A+(R^(_|~L))+C[4]+4149444226&4294967295,A=_+(O<<6&4294967295|O>>>26),O=L+(_^(A|~R))+C[11]+3174756917&4294967295,L=A+(O<<10&4294967295|O>>>22),O=R+(A^(L|~_))+C[2]+718787259&4294967295,R=L+(O<<15&4294967295|O>>>17),O=_+(L^(R|~A))+C[9]+3951481745&4294967295,I.g[0]=I.g[0]+A&4294967295,I.g[1]=I.g[1]+(R+(O<<21&4294967295|O>>>11))&4294967295,I.g[2]=I.g[2]+R&4294967295,I.g[3]=I.g[3]+L&4294967295}r.prototype.v=function(I,A){A===void 0&&(A=I.length);const _=A-this.blockSize,C=this.C;let R=this.h,L=0;for(;L<A;){if(R==0)for(;L<=_;)o(this,I,L),L+=this.blockSize;if(typeof I=="string"){for(;L<A;)if(C[R++]=I.charCodeAt(L++),R==this.blockSize){o(this,C),R=0;break}}else for(;L<A;)if(C[R++]=I[L++],R==this.blockSize){o(this,C),R=0;break}}this.h=R,this.o+=A},r.prototype.A=function(){var I=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);I[0]=128;for(var A=1;A<I.length-8;++A)I[A]=0;A=this.o*8;for(var _=I.length-8;_<I.length;++_)I[_]=A&255,A/=256;for(this.v(I),I=Array(16),A=0,_=0;_<4;++_)for(let C=0;C<32;C+=8)I[A++]=this.g[_]>>>C&255;return I};function l(I,A){var _=m;return Object.prototype.hasOwnProperty.call(_,I)?_[I]:_[I]=A(I)}function d(I,A){this.h=A;const _=[];let C=!0;for(let R=I.length-1;R>=0;R--){const L=I[R]|0;C&&L==A||(_[R]=L,C=!1)}this.g=_}var m={};function p(I){return-128<=I&&I<128?l(I,function(A){return new d([A|0],A<0?-1:0)}):new d([I|0],I<0?-1:0)}function y(I){if(isNaN(I)||!isFinite(I))return v;if(I<0)return j(y(-I));const A=[];let _=1;for(let C=0;I>=_;C++)A[C]=I/_|0,_*=4294967296;return new d(A,0)}function x(I,A){if(I.length==0)throw Error("number format error: empty string");if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(I.charAt(0)=="-")return j(x(I.substring(1),A));if(I.indexOf("-")>=0)throw Error('number format error: interior "-" character');const _=y(Math.pow(A,8));let C=v;for(let L=0;L<I.length;L+=8){var R=Math.min(8,I.length-L);const O=parseInt(I.substring(L,L+R),A);R<8?(R=y(Math.pow(A,R)),C=C.j(R).add(y(O))):(C=C.j(_),C=C.add(y(O)))}return C}var v=p(0),S=p(1),N=p(16777216);n=d.prototype,n.m=function(){if(M(this))return-j(this).m();let I=0,A=1;for(let _=0;_<this.g.length;_++){const C=this.i(_);I+=(C>=0?C:4294967296+C)*A,A*=4294967296}return I},n.toString=function(I){if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(P(this))return"0";if(M(this))return"-"+j(this).toString(I);const A=y(Math.pow(I,6));var _=this;let C="";for(;;){const R=G(_,A).g;_=V(_,R.j(A));let L=((_.g.length>0?_.g[0]:_.h)>>>0).toString(I);if(_=R,P(_))return L+C;for(;L.length<6;)L="0"+L;C=L+C}},n.i=function(I){return I<0?0:I<this.g.length?this.g[I]:this.h};function P(I){if(I.h!=0)return!1;for(let A=0;A<I.g.length;A++)if(I.g[A]!=0)return!1;return!0}function M(I){return I.h==-1}n.l=function(I){return I=V(this,I),M(I)?-1:P(I)?0:1};function j(I){const A=I.g.length,_=[];for(let C=0;C<A;C++)_[C]=~I.g[C];return new d(_,~I.h).add(S)}n.abs=function(){return M(this)?j(this):this},n.add=function(I){const A=Math.max(this.g.length,I.g.length),_=[];let C=0;for(let R=0;R<=A;R++){let L=C+(this.i(R)&65535)+(I.i(R)&65535),O=(L>>>16)+(this.i(R)>>>16)+(I.i(R)>>>16);C=O>>>16,L&=65535,O&=65535,_[R]=O<<16|L}return new d(_,_[_.length-1]&-2147483648?-1:0)};function V(I,A){return I.add(j(A))}n.j=function(I){if(P(this)||P(I))return v;if(M(this))return M(I)?j(this).j(j(I)):j(j(this).j(I));if(M(I))return j(this.j(j(I)));if(this.l(N)<0&&I.l(N)<0)return y(this.m()*I.m());const A=this.g.length+I.g.length,_=[];for(var C=0;C<2*A;C++)_[C]=0;for(C=0;C<this.g.length;C++)for(let R=0;R<I.g.length;R++){const L=this.i(C)>>>16,O=this.i(C)&65535,xe=I.i(R)>>>16,ge=I.i(R)&65535;_[2*C+2*R]+=O*ge,B(_,2*C+2*R),_[2*C+2*R+1]+=L*ge,B(_,2*C+2*R+1),_[2*C+2*R+1]+=O*xe,B(_,2*C+2*R+1),_[2*C+2*R+2]+=L*xe,B(_,2*C+2*R+2)}for(I=0;I<A;I++)_[I]=_[2*I+1]<<16|_[2*I];for(I=A;I<2*A;I++)_[I]=0;return new d(_,0)};function B(I,A){for(;(I[A]&65535)!=I[A];)I[A+1]+=I[A]>>>16,I[A]&=65535,A++}function H(I,A){this.g=I,this.h=A}function G(I,A){if(P(A))throw Error("division by zero");if(P(I))return new H(v,v);if(M(I))return A=G(j(I),A),new H(j(A.g),j(A.h));if(M(A))return A=G(I,j(A)),new H(j(A.g),A.h);if(I.g.length>30){if(M(I)||M(A))throw Error("slowDivide_ only works with positive integers.");for(var _=S,C=A;C.l(I)<=0;)_=Y(_),C=Y(C);var R=K(_,1),L=K(C,1);for(C=K(C,2),_=K(_,2);!P(C);){var O=L.add(C);O.l(I)<=0&&(R=R.add(_),L=O),C=K(C,1),_=K(_,1)}return A=V(I,R.j(A)),new H(R,A)}for(R=v;I.l(A)>=0;){for(_=Math.max(1,Math.floor(I.m()/A.m())),C=Math.ceil(Math.log(_)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),L=y(_),O=L.j(A);M(O)||O.l(I)>0;)_-=C,L=y(_),O=L.j(A);P(L)&&(L=S),R=R.add(L),I=V(I,O)}return new H(R,I)}n.B=function(I){return G(this,I).h},n.and=function(I){const A=Math.max(this.g.length,I.g.length),_=[];for(let C=0;C<A;C++)_[C]=this.i(C)&I.i(C);return new d(_,this.h&I.h)},n.or=function(I){const A=Math.max(this.g.length,I.g.length),_=[];for(let C=0;C<A;C++)_[C]=this.i(C)|I.i(C);return new d(_,this.h|I.h)},n.xor=function(I){const A=Math.max(this.g.length,I.g.length),_=[];for(let C=0;C<A;C++)_[C]=this.i(C)^I.i(C);return new d(_,this.h^I.h)};function Y(I){const A=I.g.length+1,_=[];for(let C=0;C<A;C++)_[C]=I.i(C)<<1|I.i(C-1)>>>31;return new d(_,I.h)}function K(I,A){const _=A>>5;A%=32;const C=I.g.length-_,R=[];for(let L=0;L<C;L++)R[L]=A>0?I.i(L+_)>>>A|I.i(L+_+1)<<32-A:I.i(L+_);return new d(R,I.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,fS=r,d.prototype.add=d.prototype.add,d.prototype.multiply=d.prototype.j,d.prototype.modulo=d.prototype.B,d.prototype.compare=d.prototype.l,d.prototype.toNumber=d.prototype.m,d.prototype.toString=d.prototype.toString,d.prototype.getBits=d.prototype.i,d.fromNumber=y,d.fromString=x,ci=d}).apply(typeof Lv<"u"?Lv:typeof self<"u"?self:typeof window<"u"?window:{});var Pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hS,kc,pS,Jd,Jm,mS,gS,yS;(function(){var n,e=Object.defineProperty;function s(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pd=="object"&&Pd];for(var b=0;b<f.length;++b){var w=f[b];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=s(this);function o(f,b){if(b)e:{var w=r;f=f.split(".");for(var U=0;U<f.length-1;U++){var te=f[U];if(!(te in w))break e;w=w[te]}f=f[f.length-1],U=w[f],b=b(U),b!=U&&b!=null&&e(w,f,{configurable:!0,writable:!0,value:b})}}o("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),o("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),o("Object.entries",function(f){return f||function(b){var w=[],U;for(U in b)Object.prototype.hasOwnProperty.call(b,U)&&w.push([U,b[U]]);return w}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},d=this||self;function m(f){var b=typeof f;return b=="object"&&f!=null||b=="function"}function p(f,b,w){return f.call.apply(f.bind,arguments)}function y(f,b,w){return y=p,y.apply(null,arguments)}function x(f,b){var w=Array.prototype.slice.call(arguments,1);return function(){var U=w.slice();return U.push.apply(U,arguments),f.apply(this,U)}}function v(f,b){function w(){}w.prototype=b.prototype,f.Z=b.prototype,f.prototype=new w,f.prototype.constructor=f,f.Ob=function(U,te,ce){for(var Ne=Array(arguments.length-2),nt=2;nt<arguments.length;nt++)Ne[nt-2]=arguments[nt];return b.prototype[te].apply(U,Ne)}}var S=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function N(f){const b=f.length;if(b>0){const w=Array(b);for(let U=0;U<b;U++)w[U]=f[U];return w}return[]}function P(f,b){for(let U=1;U<arguments.length;U++){const te=arguments[U];var w=typeof te;if(w=w!="object"?w:te?Array.isArray(te)?"array":w:"null",w=="array"||w=="object"&&typeof te.length=="number"){w=f.length||0;const ce=te.length||0;f.length=w+ce;for(let Ne=0;Ne<ce;Ne++)f[w+Ne]=te[Ne]}else f.push(te)}}class M{constructor(b,w){this.i=b,this.j=w,this.h=0,this.g=null}get(){let b;return this.h>0?(this.h--,b=this.g,this.g=b.next,b.next=null):b=this.i(),b}}function j(f){d.setTimeout(()=>{throw f},0)}function V(){var f=I;let b=null;return f.g&&(b=f.g,f.g=f.g.next,f.g||(f.h=null),b.next=null),b}class B{constructor(){this.h=this.g=null}add(b,w){const U=H.get();U.set(b,w),this.h?this.h.next=U:this.g=U,this.h=U}}var H=new M(()=>new G,f=>f.reset());class G{constructor(){this.next=this.g=this.h=null}set(b,w){this.h=b,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,K=!1,I=new B,A=()=>{const f=Promise.resolve(void 0);Y=()=>{f.then(_)}};function _(){for(var f;f=V();){try{f.h.call(f.g)}catch(w){j(w)}var b=H;b.j(f),b.h<100&&(b.h++,f.next=b.g,b.g=f)}K=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function R(f,b){this.type=f,this.g=this.target=b,this.defaultPrevented=!1}R.prototype.h=function(){this.defaultPrevented=!0};var L=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var f=!1,b=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const w=()=>{};d.addEventListener("test",w,b),d.removeEventListener("test",w,b)}catch{}return f})();function O(f){return/^[\s\xa0]*$/.test(f)}function xe(f,b){R.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,b)}v(xe,R),xe.prototype.init=function(f,b){const w=this.type=f.type,U=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=b,b=f.relatedTarget,b||(w=="mouseover"?b=f.fromElement:w=="mouseout"&&(b=f.toElement)),this.relatedTarget=b,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&xe.Z.h.call(this)},xe.prototype.h=function(){xe.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var ge="closure_listenable_"+(Math.random()*1e6|0),F=0;function ue(f,b,w,U,te){this.listener=f,this.proxy=null,this.src=b,this.type=w,this.capture=!!U,this.ha=te,this.key=++F,this.da=this.fa=!1}function ae(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function X(f,b,w){for(const U in f)b.call(w,f[U],U,f)}function Q(f,b){for(const w in f)b.call(void 0,f[w],w,f)}function T(f){const b={};for(const w in f)b[w]=f[w];return b}const z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(f,b){let w,U;for(let te=1;te<arguments.length;te++){U=arguments[te];for(w in U)f[w]=U[w];for(let ce=0;ce<z.length;ce++)w=z[ce],Object.prototype.hasOwnProperty.call(U,w)&&(f[w]=U[w])}}function J(f){this.src=f,this.g={},this.h=0}J.prototype.add=function(f,b,w,U,te){const ce=f.toString();f=this.g[ce],f||(f=this.g[ce]=[],this.h++);const Ne=de(f,b,U,te);return Ne>-1?(b=f[Ne],w||(b.fa=!1)):(b=new ue(b,this.src,ce,!!U,te),b.fa=w,f.push(b)),b};function pe(f,b){const w=b.type;if(w in f.g){var U=f.g[w],te=Array.prototype.indexOf.call(U,b,void 0),ce;(ce=te>=0)&&Array.prototype.splice.call(U,te,1),ce&&(ae(b),f.g[w].length==0&&(delete f.g[w],f.h--))}}function de(f,b,w,U){for(let te=0;te<f.length;++te){const ce=f[te];if(!ce.da&&ce.listener==b&&ce.capture==!!w&&ce.ha==U)return te}return-1}var _e="closure_lm_"+(Math.random()*1e6|0),W={};function le(f,b,w,U,te){if(Array.isArray(b)){for(let ce=0;ce<b.length;ce++)le(f,b[ce],w,U,te);return null}return w=rt(w),f&&f[ge]?f.J(b,w,m(U)?!!U.capture:!1,te):ie(f,b,w,!1,U,te)}function ie(f,b,w,U,te,ce){if(!b)throw Error("Invalid event type");const Ne=m(te)?!!te.capture:!!te;let nt=Re(f);if(nt||(f[_e]=nt=new J(f)),w=nt.add(b,w,U,Ne,ce),w.proxy)return w;if(U=he(),w.proxy=U,U.src=f,U.listener=w,f.addEventListener)L||(te=Ne),te===void 0&&(te=!1),f.addEventListener(b.toString(),U,te);else if(f.attachEvent)f.attachEvent(je(b.toString()),U);else if(f.addListener&&f.removeListener)f.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return w}function he(){function f(w){return b.call(f.src,f.listener,w)}const b=wt;return f}function Ie(f,b,w,U,te){if(Array.isArray(b))for(var ce=0;ce<b.length;ce++)Ie(f,b[ce],w,U,te);else U=m(U)?!!U.capture:!!U,w=rt(w),f&&f[ge]?(f=f.i,ce=String(b).toString(),ce in f.g&&(b=f.g[ce],w=de(b,w,U,te),w>-1&&(ae(b[w]),Array.prototype.splice.call(b,w,1),b.length==0&&(delete f.g[ce],f.h--)))):f&&(f=Re(f))&&(b=f.g[b.toString()],f=-1,b&&(f=de(b,w,U,te)),(w=f>-1?b[f]:null)&&Ue(w))}function Ue(f){if(typeof f!="number"&&f&&!f.da){var b=f.src;if(b&&b[ge])pe(b.i,f);else{var w=f.type,U=f.proxy;b.removeEventListener?b.removeEventListener(w,U,f.capture):b.detachEvent?b.detachEvent(je(w),U):b.addListener&&b.removeListener&&b.removeListener(U),(w=Re(b))?(pe(w,f),w.h==0&&(w.src=null,b[_e]=null)):ae(f)}}}function je(f){return f in W?W[f]:W[f]="on"+f}function wt(f,b){if(f.da)f=!0;else{b=new xe(b,this);const w=f.listener,U=f.ha||f.src;f.fa&&Ue(f),f=w.call(U,b)}return f}function Re(f){return f=f[_e],f instanceof J?f:null}var we="__closure_events_fn_"+(Math.random()*1e9>>>0);function rt(f){return typeof f=="function"?f:(f[we]||(f[we]=function(b){return f.handleEvent(b)}),f[we])}function Qe(){C.call(this),this.i=new J(this),this.M=this,this.G=null}v(Qe,C),Qe.prototype[ge]=!0,Qe.prototype.removeEventListener=function(f,b,w,U){Ie(this,f,b,w,U)};function oe(f,b){var w,U=f.G;if(U)for(w=[];U;U=U.G)w.push(U);if(f=f.M,U=b.type||b,typeof b=="string")b=new R(b,f);else if(b instanceof R)b.target=b.target||f;else{var te=b;b=new R(U,f),$(b,te)}te=!0;let ce,Ne;if(w)for(Ne=w.length-1;Ne>=0;Ne--)ce=b.g=w[Ne],te=ze(ce,U,!0,b)&&te;if(ce=b.g=f,te=ze(ce,U,!0,b)&&te,te=ze(ce,U,!1,b)&&te,w)for(Ne=0;Ne<w.length;Ne++)ce=b.g=w[Ne],te=ze(ce,U,!1,b)&&te}Qe.prototype.N=function(){if(Qe.Z.N.call(this),this.i){var f=this.i;for(const b in f.g){const w=f.g[b];for(let U=0;U<w.length;U++)ae(w[U]);delete f.g[b],f.h--}}this.G=null},Qe.prototype.J=function(f,b,w,U){return this.i.add(String(f),b,!1,w,U)},Qe.prototype.K=function(f,b,w,U){return this.i.add(String(f),b,!0,w,U)};function ze(f,b,w,U){if(b=f.i.g[String(b)],!b)return!0;b=b.concat();let te=!0;for(let ce=0;ce<b.length;++ce){const Ne=b[ce];if(Ne&&!Ne.da&&Ne.capture==w){const nt=Ne.listener,cn=Ne.ha||Ne.src;Ne.fa&&pe(f.i,Ne),te=nt.call(cn,U)!==!1&&te}}return te&&!U.defaultPrevented}function et(f,b){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=y(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(b)>2147483647?-1:d.setTimeout(f,b||0)}function vt(f){f.g=et(()=>{f.g=null,f.i&&(f.i=!1,vt(f))},f.l);const b=f.h;f.h=null,f.m.apply(null,b)}class Ye extends C{constructor(b,w){super(),this.m=b,this.l=w,this.h=null,this.i=!1,this.g=null}j(b){this.h=arguments,this.g?this.i=!0:vt(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function We(f){C.call(this),this.h=f,this.g={}}v(We,C);var it=[];function St(f){X(f.g,function(b,w){this.g.hasOwnProperty(w)&&Ue(b)},f),f.g={}}We.prototype.N=function(){We.Z.N.call(this),St(this)},We.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ut=d.JSON.stringify,es=d.JSON.parse,Us=class{stringify(f){return d.JSON.stringify(f,void 0)}parse(f){return d.JSON.parse(f,void 0)}};function ts(){}function Es(){}var ve={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Oe(){R.call(this,"d")}v(Oe,R);function Ae(){R.call(this,"c")}v(Ae,R);var Be={},xt=null;function Ke(){return xt=xt||new Qe}Be.Ia="serverreachability";function dt(f){R.call(this,Be.Ia,f)}v(dt,R);function ft(f){const b=Ke();oe(b,new dt(b))}Be.STAT_EVENT="statevent";function zt(f,b){R.call(this,Be.STAT_EVENT,f),this.stat=b}v(zt,R);function Tt(f){const b=Ke();oe(b,new zt(b,f))}Be.Ja="timingevent";function Bt(f,b){R.call(this,Be.Ja,f),this.size=b}v(Bt,R);function on(f,b){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){f()},b)}function Sn(){this.g=!0}Sn.prototype.ua=function(){this.g=!1};function oa(f,b,w,U,te,ce){f.info(function(){if(f.g)if(ce){var Ne="",nt=ce.split("&");for(let It=0;It<nt.length;It++){var cn=nt[It].split("=");if(cn.length>1){const qt=cn[0];cn=cn[1];const Ys=qt.split("_");Ne=Ys.length>=2&&Ys[1]=="type"?Ne+(qt+"="+cn+"&"):Ne+(qt+"=redacted&")}}}else Ne=null;else Ne=ce;return"XMLHTTP REQ ("+U+") [attempt "+te+"]: "+b+`
`+w+`
`+Ne})}function jn(f,b,w,U,te,ce,Ne){f.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+te+"]: "+b+`
`+w+`
`+ce+" "+Ne})}function kn(f,b,w,U){f.info(function(){return"XMLHTTP TEXT ("+b+"): "+la(f,w)+(U?" "+U:"")})}function Ps(f,b){f.info(function(){return"TIMEOUT: "+b})}Sn.prototype.info=function(){};function la(f,b){if(!f.g)return b;if(!b)return null;try{const ce=JSON.parse(b);if(ce){for(f=0;f<ce.length;f++)if(Array.isArray(ce[f])){var w=ce[f];if(!(w.length<2)){var U=w[1];if(Array.isArray(U)&&!(U.length<1)){var te=U[0];if(te!="noop"&&te!="stop"&&te!="close")for(let Ne=1;Ne<U.length;Ne++)U[Ne]=""}}}}return Ut(ce)}catch{return b}}var ca={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Tr={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ar;function Oa(){}v(Oa,ts),Oa.prototype.g=function(){return new XMLHttpRequest},Ar=new Oa;function Vs(f){return encodeURIComponent(String(f))}function xo(f){var b=1;f=f.split(":");const w=[];for(;b>0&&f.length;)w.push(f.shift()),b--;return f.length&&w.push(f.join(":")),w}function ws(f,b,w,U){this.j=f,this.i=b,this.l=w,this.S=U||1,this.V=new We(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ss}function Ss(){this.i=null,this.g="",this.h=!1}var en={},mn={};function zs(f,b,w){f.M=1,f.A=$e(ln(b)),f.u=w,f.R=!0,Ir(f,null)}function Ir(f,b){f.F=Date.now(),Bs(f),f.B=ln(f.A);var w=f.B,U=f.S;Array.isArray(U)||(U=[String(U)]),Eo(w.i,"t",U),f.C=0,w=f.j.L,f.h=new Ss,f.g=Ru(f.j,w?b:null,!f.u),f.P>0&&(f.O=new Ye(y(f.Y,f,f.g),f.P)),b=f.V,w=f.g,U=f.ba;var te="readystatechange";Array.isArray(te)||(te&&(it[0]=te.toString()),te=it);for(let ce=0;ce<te.length;ce++){const Ne=le(w,te[ce],U||b.handleEvent,!1,b.h||b);if(!Ne)break;b.g[Ne.key]=Ne}b=f.J?T(f.J):{},f.u?(f.v||(f.v="POST"),b["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,b)):(f.v="GET",f.g.ea(f.B,f.v,null,b)),ft(),oa(f.i,f.v,f.B,f.l,f.S,f.u)}ws.prototype.ba=function(f){f=f.target;const b=this.O;b&&ha(f)==3?b.j():this.Y(f)},ws.prototype.Y=function(f){try{if(f==this.g)e:{const nt=ha(this.g),cn=this.g.ya(),It=this.g.ca();if(!(nt<3)&&(nt!=3||this.g&&(this.h.h||this.g.la()||Vn(this.g)))){this.K||nt!=4||cn==7||(cn==8||It<=0?ft(3):ft(2)),Ts(this);var b=this.g.ca();this.X=b;var w=Ul(this);if(this.o=b==200,jn(this.i,this.v,this.B,this.l,this.S,nt,b),this.o){if(this.U&&!this.L){t:{if(this.g){var U,te=this.g;if((U=te.g?te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(U)){var ce=U;break t}}ce=null}if(f=ce)kn(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Fs(this,f);else{this.o=!1,this.m=3,Tt(12),ns(this),fs(this);break e}}if(this.R){f=!0;let qt;for(;!this.K&&this.C<w.length;)if(qt=vo(this,w),qt==mn){nt==4&&(this.m=4,Tt(14),f=!1),kn(this.i,this.l,null,"[Incomplete Response]");break}else if(qt==en){this.m=4,Tt(15),kn(this.i,this.l,w,"[Invalid Chunk]"),f=!1;break}else kn(this.i,this.l,qt,null),Fs(this,qt);if(bo(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),nt!=4||w.length!=0||this.h.h||(this.m=1,Tt(16),f=!1),this.o=this.o&&f,!f)kn(this.i,this.l,w,"[Invalid Chunked Response]"),ns(this),fs(this);else if(w.length>0&&!this.W){this.W=!0;var Ne=this.j;Ne.g==this&&Ne.aa&&!Ne.P&&(Ne.j.info("Great, no buffering proxy detected. Bytes received: "+w.length),ql(Ne),Ne.P=!0,Tt(11))}}else kn(this.i,this.l,w,null),Fs(this,w);nt==4&&ns(this),this.o&&!this.K&&(nt==4?Au(this.j,this):(this.o=!1,Bs(this)))}else tr(this.g),b==400&&w.indexOf("Unknown SID")>0?(this.m=3,Tt(12)):(this.m=0,Tt(13)),ns(this),fs(this)}}}catch{}finally{}};function Ul(f){if(!bo(f))return f.g.la();const b=Vn(f.g);if(b==="")return"";let w="";const U=b.length,te=ha(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return ns(f),fs(f),"";f.h.i=new d.TextDecoder}for(let ce=0;ce<U;ce++)f.h.h=!0,w+=f.h.i.decode(b[ce],{stream:!(te&&ce==U-1)});return b.length=0,f.h.g+=w,f.C=0,f.h.g}function bo(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function vo(f,b){var w=f.C,U=b.indexOf(`
`,w);return U==-1?mn:(w=Number(b.substring(w,U)),isNaN(w)?en:(U+=1,U+w>b.length?mn:(b=b.slice(U,U+w),f.C=U+w,b)))}ws.prototype.cancel=function(){this.K=!0,ns(this)};function Bs(f){f.T=Date.now()+f.H,Nr(f,f.H)}function Nr(f,b){if(f.D!=null)throw Error("WatchDog timer not null");f.D=on(y(f.aa,f),b)}function Ts(f){f.D&&(d.clearTimeout(f.D),f.D=null)}ws.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(Ps(this.i,this.B),this.M!=2&&(ft(),Tt(17)),ns(this),this.m=2,fs(this)):Nr(this,this.T-f)};function fs(f){f.j.I==0||f.K||Au(f.j,f)}function ns(f){Ts(f);var b=f.O;b&&typeof b.dispose=="function"&&b.dispose(),f.O=null,St(f.V),f.g&&(b=f.g,f.g=null,b.abort(),b.dispose())}function Fs(f,b){try{var w=f.j;if(w.I!=0&&(w.g==f||Gs(w.h,f))){if(!f.L&&Gs(w.h,f)&&w.I==3){try{var U=w.Ba.g.parse(b)}catch{U=null}if(Array.isArray(U)&&U.length==3){var te=U;if(te[0]==0){e:if(!w.v){if(w.g)if(w.g.F+3e3<f.F)Io(w),kr(w);else break e;Ri(w),Tt(18)}}else w.xa=te[1],0<w.xa-w.K&&te[2]<37500&&w.F&&w.A==0&&!w.C&&(w.C=on(y(w.Va,w),6e3));Hs(w.h)<=1&&w.ta&&(w.ta=void 0)}else Ua(w,11)}else if((f.L||w.g==f)&&Io(w),!O(b))for(te=w.Ba.g.parse(b),b=0;b<te.length;b++){let It=te[b];const qt=It[0];if(!(qt<=w.K))if(w.K=qt,It=It[1],w.I==2)if(It[0]=="c"){w.M=It[1],w.ba=It[2];const Ys=It[3];Ys!=null&&(w.ka=Ys,w.j.info("VER="+w.ka));const Pa=It[4];Pa!=null&&(w.za=Pa,w.j.info("SVER="+w.za));const pa=It[5];pa!=null&&typeof pa=="number"&&pa>0&&(U=1.5*pa,w.O=U,w.j.info("backChannelRequestTimeoutMs_="+U)),U=w;const ma=f.g;if(ma){const Oi=ma.g?ma.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Oi){var ce=U.h;ce.g||Oi.indexOf("spdy")==-1&&Oi.indexOf("quic")==-1&&Oi.indexOf("h2")==-1||(ce.j=ce.l,ce.g=new Set,ce.h&&(Ei(ce,ce.h),ce.h=null))}if(U.G){const No=ma.g?ma.g.getResponseHeader("X-HTTP-Session-Id"):null;No&&(U.wa=No,Te(U.J,U.G,No))}}w.I=3,w.l&&w.l.ra(),w.aa&&(w.T=Date.now()-f.F,w.j.info("Handshake RTT: "+w.T+"ms")),U=w;var Ne=f;if(U.na=Cu(U,U.L?U.ba:null,U.W),Ne.L){ja(U.h,Ne);var nt=Ne,cn=U.O;cn&&(nt.H=cn),nt.D&&(Ts(nt),Bs(nt)),U.g=Ne}else Su(U);w.i.length>0&&Da(w)}else It[0]!="stop"&&It[0]!="close"||Ua(w,7);else w.I==3&&(It[0]=="stop"||It[0]=="close"?It[0]=="stop"?Ua(w,7):Hl(w):It[0]!="noop"&&w.l&&w.l.qa(It),w.A=0)}}ft(4)}catch{}}var tn=class{constructor(f,b){this.g=f,this.map=b}};function vi(f){this.l=f||10,d.PerformanceNavigationTiming?(f=d.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function _i(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Hs(f){return f.h?1:f.g?f.g.size:0}function Gs(f,b){return f.h?f.h==b:f.g?f.g.has(b):!1}function Ei(f,b){f.g?f.g.add(b):f.h=b}function ja(f,b){f.h&&f.h==b?f.h=null:f.g&&f.g.has(b)&&f.g.delete(b)}vi.prototype.cancel=function(){if(this.i=wi(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function wi(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let b=f.i;for(const w of f.g.values())b=b.concat(w.G);return b}return N(f.i)}var Si=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Xa(f,b){if(f){f=f.split("&");for(let w=0;w<f.length;w++){const U=f[w].indexOf("=");let te,ce=null;U>=0?(te=f[w].substring(0,U),ce=f[w].substring(U+1)):te=f[w],b(te,ce?decodeURIComponent(ce.replace(/\+/g," ")):"")}}}function hs(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let b;f instanceof hs?(this.l=f.l,Tn(this,f.j),this.o=f.o,this.g=f.g,Ja(this,f.u),this.h=f.h,_o(this,Eu(f.i)),this.m=f.m):f&&(b=String(f).match(Si))?(this.l=!1,Tn(this,b[1]||"",!0),this.o=He(b[2]||""),this.g=He(b[3]||"",!0),Ja(this,b[4]),this.h=He(b[5]||"",!0),_o(this,b[6]||"",!0),this.m=He(b[7]||"")):(this.l=!1,this.i=new ss(null,this.l))}hs.prototype.toString=function(){const f=[];var b=this.j;b&&f.push(Pe(b,At,!0),":");var w=this.g;return(w||b=="file")&&(f.push("//"),(b=this.o)&&f.push(Pe(b,At,!0),"@"),f.push(Vs(w).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.u,w!=null&&f.push(":",String(w))),(w=this.h)&&(this.g&&w.charAt(0)!="/"&&f.push("/"),f.push(Pe(w,w.charAt(0)=="/"?nn:Yn,!0))),(w=this.i.toString())&&f.push("?",w),(w=this.m)&&f.push("#",Pe(w,ua)),f.join("")},hs.prototype.resolve=function(f){const b=ln(this);let w=!!f.j;w?Tn(b,f.j):w=!!f.o,w?b.o=f.o:w=!!f.g,w?b.g=f.g:w=f.u!=null;var U=f.h;if(w)Ja(b,f.u);else if(w=!!f.h){if(U.charAt(0)!="/")if(this.g&&!this.h)U="/"+U;else{var te=b.h.lastIndexOf("/");te!=-1&&(U=b.h.slice(0,te+1)+U)}if(te=U,te==".."||te==".")U="";else if(te.indexOf("./")!=-1||te.indexOf("/.")!=-1){U=te.lastIndexOf("/",0)==0,te=te.split("/");const ce=[];for(let Ne=0;Ne<te.length;){const nt=te[Ne++];nt=="."?U&&Ne==te.length&&ce.push(""):nt==".."?((ce.length>1||ce.length==1&&ce[0]!="")&&ce.pop(),U&&Ne==te.length&&ce.push("")):(ce.push(nt),U=!0)}U=ce.join("/")}else U=te}return w?b.h=U:w=f.i.toString()!=="",w?_o(b,Eu(f.i)):w=!!f.m,w&&(b.m=f.m),b};function ln(f){return new hs(f)}function Tn(f,b,w){f.j=w?He(b,!0):b,f.j&&(f.j=f.j.replace(/:$/,""))}function Ja(f,b){if(b){if(b=Number(b),isNaN(b)||b<0)throw Error("Bad port number "+b);f.u=b}else f.u=null}function _o(f,b,w){b instanceof ss?(f.i=b,wo(f.i,f.l)):(w||(b=Pe(b,gn)),f.i=new ss(b,f.l))}function Te(f,b,w){f.i.set(b,w)}function $e(f){return Te(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function He(f,b){return f?b?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Pe(f,b,w){return typeof f=="string"?(f=encodeURI(f).replace(b,Ze),w&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Ze(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var At=/[#\/\?@]/g,Yn=/[#\?:]/g,nn=/[#\?]/g,gn=/[#\?@]/g,ua=/#/g;function ss(f,b){this.h=this.g=null,this.i=f||null,this.j=!!b}function Ln(f){f.g||(f.g=new Map,f.h=0,f.i&&Xa(f.i,function(b,w){f.add(decodeURIComponent(b.replace(/\+/g," ")),w)}))}n=ss.prototype,n.add=function(f,b){Ln(this),this.i=null,f=Cr(this,f);let w=this.g.get(f);return w||this.g.set(f,w=[]),w.push(b),this.h+=1,this};function _u(f,b){Ln(f),b=Cr(f,b),f.g.has(b)&&(f.i=null,f.h-=f.g.get(b).length,f.g.delete(b))}function Pl(f,b){return Ln(f),b=Cr(f,b),f.g.has(b)}n.forEach=function(f,b){Ln(this),this.g.forEach(function(w,U){w.forEach(function(te){f.call(b,te,U,this)},this)},this)};function Vl(f,b){Ln(f);let w=[];if(typeof b=="string")Pl(f,b)&&(w=w.concat(f.g.get(Cr(f,b))));else for(f=Array.from(f.g.values()),b=0;b<f.length;b++)w=w.concat(f[b]);return w}n.set=function(f,b){return Ln(this),this.i=null,f=Cr(this,f),Pl(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[b]),this.h+=1,this},n.get=function(f,b){return f?(f=Vl(this,f),f.length>0?String(f[0]):b):b};function Eo(f,b,w){_u(f,b),w.length>0&&(f.i=null,f.g.set(Cr(f,b),N(w)),f.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],b=Array.from(this.g.keys());for(let U=0;U<b.length;U++){var w=b[U];const te=Vs(w);w=Vl(this,w);for(let ce=0;ce<w.length;ce++){let Ne=te;w[ce]!==""&&(Ne+="="+Vs(w[ce])),f.push(Ne)}}return this.i=f.join("&")};function Eu(f){const b=new ss;return b.i=f.i,f.g&&(b.g=new Map(f.g),b.h=f.h),b}function Cr(f,b){return b=String(b),f.j&&(b=b.toLowerCase()),b}function wo(f,b){b&&!f.j&&(Ln(f),f.i=null,f.g.forEach(function(w,U){const te=U.toLowerCase();U!=te&&(_u(this,U),Eo(this,te,w))},f)),f.j=b}function da(f,b){const w=new Sn;if(d.Image){const U=new Image;U.onload=x(qs,w,"TestLoadImage: loaded",!0,b,U),U.onerror=x(qs,w,"TestLoadImage: error",!1,b,U),U.onabort=x(qs,w,"TestLoadImage: abort",!1,b,U),U.ontimeout=x(qs,w,"TestLoadImage: timeout",!1,b,U),d.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=f}else b(!1)}function zl(f,b){const w=new Sn,U=new AbortController,te=setTimeout(()=>{U.abort(),qs(w,"TestPingServer: timeout",!1,b)},1e4);fetch(f,{signal:U.signal}).then(ce=>{clearTimeout(te),ce.ok?qs(w,"TestPingServer: ok",!0,b):qs(w,"TestPingServer: server error",!1,b)}).catch(()=>{clearTimeout(te),qs(w,"TestPingServer: error",!1,b)})}function qs(f,b,w,U,te){try{te&&(te.onload=null,te.onerror=null,te.onabort=null,te.ontimeout=null),U(w)}catch{}}function Rr(){this.g=new Us}function ka(f){this.i=f.Sb||null,this.h=f.ab||!1}v(ka,ts),ka.prototype.g=function(){return new Ti(this.i,this.h)};function Ti(f,b){Qe.call(this),this.H=f,this.o=b,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(Ti,Qe),n=Ti.prototype,n.open=function(f,b){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=b,this.readyState=1,fa(this)},n.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const b={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(b.body=f),(this.H||d).fetch(new Request(this.D,b)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Or(this)),this.readyState=0},n.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,fa(this)),this.g&&(this.readyState=3,fa(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;So(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function So(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}n.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var b=f.value?f.value:new Uint8Array(0);(b=this.B.decode(b,{stream:!f.done}))&&(this.response=this.responseText+=b)}f.done?Or(this):fa(this),this.readyState==3&&So(this)}},n.Oa=function(f){this.g&&(this.response=this.responseText=f,Or(this))},n.Na=function(f){this.g&&(this.response=f,Or(this))},n.ga=function(){this.g&&Or(this)};function Or(f){f.readyState=4,f.l=null,f.j=null,f.B=null,fa(f)}n.setRequestHeader=function(f,b){this.A.append(f,b)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],b=this.h.entries();for(var w=b.next();!w.done;)w=w.value,f.push(w[0]+": "+w[1]),w=b.next();return f.join(`\r
`)};function fa(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Ti.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function $s(f){let b="";return X(f,function(w,U){b+=U,b+=":",b+=w,b+=`\r
`}),b}function Ai(f,b,w){e:{for(U in w){var U=!1;break e}U=!0}U||(w=$s(w),typeof f=="string"?w!=null&&Vs(w):Te(f,b,w))}function jt(f){Qe.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(jt,Qe);var La=/^https?$/i,Bl=["POST","PUT"];n=jt.prototype,n.Fa=function(f){this.H=f},n.ea=function(f,b,w,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);b=b?b.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ar.g(),this.g.onreadystatechange=S(y(this.Ca,this));try{this.B=!0,this.g.open(b,String(f),!0),this.B=!1}catch(ce){Ii(this,ce);return}if(f=w||"",w=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var te in U)w.set(te,U[te]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const ce of U.keys())w.set(ce,U.get(ce));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(w.keys()).find(ce=>ce.toLowerCase()=="content-type"),te=d.FormData&&f instanceof d.FormData,!(Array.prototype.indexOf.call(Bl,b,void 0)>=0)||U||te||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ce,Ne]of w)this.g.setRequestHeader(ce,Ne);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(ce){Ii(this,ce)}};function Ii(f,b){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=b,f.o=5,Fl(f),er(f)}function Fl(f){f.A||(f.A=!0,oe(f,"complete"),oe(f,"error"))}n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,oe(this,"complete"),oe(this,"abort"),er(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),er(this,!0)),jt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Ni(this):this.Xa())},n.Xa=function(){Ni(this)};function Ni(f){if(f.h&&typeof l<"u"){if(f.v&&ha(f)==4)setTimeout(f.Ca.bind(f),0);else if(oe(f,"readystatechange"),ha(f)==4){f.h=!1;try{const ce=f.ca();e:switch(ce){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var b=!0;break e;default:b=!1}var w;if(!(w=b)){var U;if(U=ce===0){let Ne=String(f.D).match(Si)[1]||null;!Ne&&d.self&&d.self.location&&(Ne=d.self.location.protocol.slice(0,-1)),U=!La.test(Ne?Ne.toLowerCase():"")}w=U}if(w)oe(f,"complete"),oe(f,"success");else{f.o=6;try{var te=ha(f)>2?f.g.statusText:""}catch{te=""}f.l=te+" ["+f.ca()+"]",Fl(f)}}finally{er(f)}}}}function er(f,b){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const w=f.g;f.g=null,b||oe(f,"ready");try{w.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function ha(f){return f.g?f.g.readyState:0}n.ca=function(){try{return ha(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(f){if(this.g){var b=this.g.responseText;return f&&b.indexOf(f)==0&&(b=b.substring(f.length)),es(b)}};function Vn(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function tr(f){const b={};f=(f.g&&ha(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<f.length;U++){if(O(f[U]))continue;var w=xo(f[U]);const te=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const ce=b[te]||[];b[te]=ce,ce.push(w)}Q(b,function(U){return U.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ma(f,b,w){return w&&w.internalChannelParams&&w.internalChannelParams[f]||b}function jr(f){this.za=0,this.i=[],this.j=new Sn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ma("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ma("baseRetryDelayMs",5e3,f),this.Za=Ma("retryDelaySeedMs",1e4,f),this.Ta=Ma("forwardChannelMaxRetries",2,f),this.va=Ma("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new vi(f&&f.concurrentRequestLimit),this.Ba=new Rr,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=jr.prototype,n.ka=8,n.I=1,n.connect=function(f,b,w,U){Tt(0),this.W=f,this.H=b||{},w&&U!==void 0&&(this.H.OSID=w,this.H.OAID=U),this.F=this.X,this.J=Cu(this,null,this.W),Da(this)};function Hl(f){if(To(f),f.I==3){var b=f.V++,w=ln(f.J);if(Te(w,"SID",f.M),Te(w,"RID",b),Te(w,"TYPE","terminate"),Ci(f,w),b=new ws(f,f.j,b),b.M=2,b.A=$e(ln(w)),w=!1,d.navigator&&d.navigator.sendBeacon)try{w=d.navigator.sendBeacon(b.A.toString(),"")}catch{}!w&&d.Image&&(new Image().src=b.A,w=!0),w||(b.g=Ru(b.j,null),b.g.ea(b.A)),b.F=Date.now(),Bs(b)}Nu(f)}function kr(f){f.g&&(ql(f),f.g.cancel(),f.g=null)}function To(f){kr(f),f.v&&(d.clearTimeout(f.v),f.v=null),Io(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&d.clearTimeout(f.m),f.m=null)}function Da(f){if(!_i(f.h)&&!f.m){f.m=!0;var b=f.Ea;Y||A(),K||(Y(),K=!0),I.add(b,f),f.D=0}}function Ao(f,b){return Hs(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=b.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=on(y(f.Ea,f,b),Iu(f,f.D)),f.D++,!0)}n.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const te=new ws(this,this.j,f);let ce=this.o;if(this.U&&(ce?(ce=T(ce),$(ce,this.U)):ce=this.U),this.u!==null||this.R||(te.J=ce,ce=null),this.S)e:{for(var b=0,w=0;w<this.i.length;w++){t:{var U=this.i[w];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(b+=U,b>4096){b=w;break e}if(b===4096||w===this.i.length-1){b=w+1;break e}}b=1e3}else b=1e3;b=wu(this,te,b),w=ln(this.J),Te(w,"RID",f),Te(w,"CVER",22),this.G&&Te(w,"X-HTTP-Session-Id",this.G),Ci(this,w),ce&&(this.R?b="headers="+Vs($s(ce))+"&"+b:this.u&&Ai(w,this.u,ce)),Ei(this.h,te),this.Ra&&Te(w,"TYPE","init"),this.S?(Te(w,"$req",b),Te(w,"SID","null"),te.U=!0,zs(te,w,null)):zs(te,w,b),this.I=2}}else this.I==3&&(f?Gl(this,f):this.i.length==0||_i(this.h)||Gl(this))};function Gl(f,b){var w;b?w=b.l:w=f.V++;const U=ln(f.J);Te(U,"SID",f.M),Te(U,"RID",w),Te(U,"AID",f.K),Ci(f,U),f.u&&f.o&&Ai(U,f.u,f.o),w=new ws(f,f.j,w,f.D+1),f.u===null&&(w.J=f.o),b&&(f.i=b.G.concat(f.i)),b=wu(f,w,1e3),w.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),Ei(f.h,w),zs(w,U,b)}function Ci(f,b){f.H&&X(f.H,function(w,U){Te(b,U,w)}),f.l&&X({},function(w,U){Te(b,U,w)})}function wu(f,b,w){w=Math.min(f.i.length,w);const U=f.l?y(f.l.Ka,f.l,f):null;e:{var te=f.i;let nt=-1;for(;;){const cn=["count="+w];nt==-1?w>0?(nt=te[0].g,cn.push("ofs="+nt)):nt=0:cn.push("ofs="+nt);let It=!0;for(let qt=0;qt<w;qt++){var ce=te[qt].g;const Ys=te[qt].map;if(ce-=nt,ce<0)nt=Math.max(0,te[qt].g-100),It=!1;else try{ce="req"+ce+"_"||"";try{var Ne=Ys instanceof Map?Ys:Object.entries(Ys);for(const[Pa,pa]of Ne){let ma=pa;m(pa)&&(ma=Ut(pa)),cn.push(ce+Pa+"="+encodeURIComponent(ma))}}catch(Pa){throw cn.push(ce+"type="+encodeURIComponent("_badmap")),Pa}}catch{U&&U(Ys)}}if(It){Ne=cn.join("&");break e}}Ne=void 0}return f=f.i.splice(0,w),b.G=f,Ne}function Su(f){if(!f.g&&!f.v){f.Y=1;var b=f.Da;Y||A(),K||(Y(),K=!0),I.add(b,f),f.A=0}}function Ri(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=on(y(f.Da,f),Iu(f,f.A)),f.A++,!0)}n.Da=function(){if(this.v=null,Tu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=on(y(this.Wa,this),f)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Tt(10),kr(this),Tu(this))};function ql(f){f.B!=null&&(d.clearTimeout(f.B),f.B=null)}function Tu(f){f.g=new ws(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var b=ln(f.na);Te(b,"RID","rpc"),Te(b,"SID",f.M),Te(b,"AID",f.K),Te(b,"CI",f.F?"0":"1"),!f.F&&f.ia&&Te(b,"TO",f.ia),Te(b,"TYPE","xmlhttp"),Ci(f,b),f.u&&f.o&&Ai(b,f.u,f.o),f.O&&(f.g.H=f.O);var w=f.g;f=f.ba,w.M=1,w.A=$e(ln(b)),w.u=null,w.R=!0,Ir(w,f)}n.Va=function(){this.C!=null&&(this.C=null,kr(this),Ri(this),Tt(19))};function Io(f){f.C!=null&&(d.clearTimeout(f.C),f.C=null)}function Au(f,b){var w=null;if(f.g==b){Io(f),ql(f),f.g=null;var U=2}else if(Gs(f.h,b))w=b.G,ja(f.h,b),U=1;else return;if(f.I!=0){if(b.o)if(U==1){w=b.u?b.u.length:0,b=Date.now()-b.F;var te=f.D;U=Ke(),oe(U,new Bt(U,w)),Da(f)}else Su(f);else if(te=b.m,te==3||te==0&&b.X>0||!(U==1&&Ao(f,b)||U==2&&Ri(f)))switch(w&&w.length>0&&(b=f.h,b.i=b.i.concat(w)),te){case 1:Ua(f,5);break;case 4:Ua(f,10);break;case 3:Ua(f,6);break;default:Ua(f,2)}}}function Iu(f,b){let w=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(w*=2),w*b}function Ua(f,b){if(f.j.info("Error code "+b),b==2){var w=y(f.bb,f),U=f.Ua;const te=!U;U=new hs(U||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Tn(U,"https"),$e(U),te?da(U.toString(),w):zl(U.toString(),w)}else Tt(2);f.I=0,f.l&&f.l.pa(b),Nu(f),To(f)}n.bb=function(f){f?(this.j.info("Successfully pinged google.com"),Tt(2)):(this.j.info("Failed to ping google.com"),Tt(1))};function Nu(f){if(f.I=0,f.ja=[],f.l){const b=wi(f.h);(b.length!=0||f.i.length!=0)&&(P(f.ja,b),P(f.ja,f.i),f.h.i.length=0,N(f.i),f.i.length=0),f.l.oa()}}function Cu(f,b,w){var U=w instanceof hs?ln(w):new hs(w);if(U.g!="")b&&(U.g=b+"."+U.g),Ja(U,U.u);else{var te=d.location;U=te.protocol,b=b?b+"."+te.hostname:te.hostname,te=+te.port;const ce=new hs(null);U&&Tn(ce,U),b&&(ce.g=b),te&&Ja(ce,te),w&&(ce.h=w),U=ce}return w=f.G,b=f.wa,w&&b&&Te(U,w,b),Te(U,"VER",f.ka),Ci(f,U),U}function Ru(f,b,w){if(b&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return b=f.Aa&&!f.ma?new jt(new ka({ab:w})):new jt(f.ma),b.Fa(f.L),b}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ou(){}n=Ou.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Lr(){}Lr.prototype.g=function(f,b){return new as(f,b)};function as(f,b){Qe.call(this),this.g=new jr(b),this.l=f,this.h=b&&b.messageUrlParams||null,f=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(f?f["X-WebChannel-Content-Type"]=b.messageContentType:f={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.sa&&(f?f["X-WebChannel-Client-Profile"]=b.sa:f={"X-WebChannel-Client-Profile":b.sa}),this.g.U=f,(f=b&&b.Qb)&&!O(f)&&(this.g.u=f),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!O(b)&&(this.g.G=b,f=this.h,f!==null&&b in f&&(f=this.h,b in f&&delete f[b])),this.j=new nr(this)}v(as,Qe),as.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},as.prototype.close=function(){Hl(this.g)},as.prototype.o=function(f){var b=this.g;if(typeof f=="string"){var w={};w.__data__=f,f=w}else this.v&&(w={},w.__data__=Ut(f),f=w);b.i.push(new tn(b.Ya++,f)),b.I==3&&Da(b)},as.prototype.N=function(){this.g.l=null,delete this.j,Hl(this.g),delete this.g,as.Z.N.call(this)};function ju(f){Oe.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var b=f.__sm__;if(b){e:{for(const w in b){f=w;break e}f=void 0}(this.i=f)&&(f=this.i,b=b!==null&&f in b?b[f]:void 0),this.data=b}else this.data=f}v(ju,Oe);function ku(){Ae.call(this),this.status=1}v(ku,Ae);function nr(f){this.g=f}v(nr,Ou),nr.prototype.ra=function(){oe(this.g,"a")},nr.prototype.qa=function(f){oe(this.g,new ju(f))},nr.prototype.pa=function(f){oe(this.g,new ku)},nr.prototype.oa=function(){oe(this.g,"b")},Lr.prototype.createWebChannel=Lr.prototype.g,as.prototype.send=as.prototype.o,as.prototype.open=as.prototype.m,as.prototype.close=as.prototype.close,yS=function(){return new Lr},gS=function(){return Ke()},mS=Be,Jm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ca.NO_ERROR=0,ca.TIMEOUT=8,ca.HTTP_ERROR=6,Jd=ca,Tr.COMPLETE="complete",pS=Tr,Es.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",Qe.prototype.listen=Qe.prototype.J,kc=Es,jt.prototype.listenOnce=jt.prototype.K,jt.prototype.getLastError=jt.prototype.Ha,jt.prototype.getLastErrorCode=jt.prototype.ya,jt.prototype.getStatus=jt.prototype.ca,jt.prototype.getResponseJson=jt.prototype.La,jt.prototype.getResponseText=jt.prototype.la,jt.prototype.send=jt.prototype.ea,jt.prototype.setWithCredentials=jt.prototype.Fa,hS=jt}).apply(typeof Pd<"u"?Pd:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Zn.UNAUTHENTICATED=new Zn(null),Zn.GOOGLE_CREDENTIALS=new Zn("google-credentials-uid"),Zn.FIRST_PARTY=new Zn("first-party-uid"),Zn.MOCK_USER=new Zn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ll="12.9.0";function yR(n){Ll=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho=new iS("@firebase/firestore");function ol(){return ho.logLevel}function ke(n,...e){if(ho.logLevel<=gt.DEBUG){const s=e.map(e0);ho.debug(`Firestore (${Ll}): ${n}`,...s)}}function Sr(n,...e){if(ho.logLevel<=gt.ERROR){const s=e.map(e0);ho.error(`Firestore (${Ll}): ${n}`,...s)}}function po(n,...e){if(ho.logLevel<=gt.WARN){const s=e.map(e0);ho.warn(`Firestore (${Ll}): ${n}`,...s)}}function e0(n){if(typeof n=="string")return n;try{return(function(s){return JSON.stringify(s)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(n,e,s){let r="Unexpected state";typeof e=="string"?r=e:s=e,xS(n,r,s)}function xS(n,e,s){let r=`FIRESTORE (${Ll}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(s!==void 0)try{r+=" CONTEXT: "+JSON.stringify(s)}catch{r+=" CONTEXT: "+s}throw Sr(r),new Error(r)}function Zt(n,e,s,r){let o="Unexpected state";typeof s=="string"?o=s:r=s,n||xS(e,o,r)}function yt(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ce={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ve extends kl{constructor(e,s){super(e,s),this.code=e,this.message=s,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(){this.promise=new Promise(((e,s)=>{this.resolve=e,this.reject=s}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(e,s){this.user=s,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class xR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,s){e.enqueueRetryable((()=>s(Zn.UNAUTHENTICATED)))}shutdown(){}}class bR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,s){this.changeListener=s,e.enqueueRetryable((()=>s(this.token.user)))}shutdown(){this.changeListener=null}}class vR{constructor(e){this.t=e,this.currentUser=Zn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,s){Zt(this.o===void 0,42304);let r=this.i;const o=p=>this.i!==r?(r=this.i,s(p)):Promise.resolve();let l=new to;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new to,e.enqueueRetryable((()=>o(this.currentUser)))};const d=()=>{const p=l;e.enqueueRetryable((async()=>{await p.promise,await o(this.currentUser)}))},m=p=>{ke("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),d())};this.t.onInit((p=>m(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?m(p):(ke("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new to)}}),0),d()}getToken(){const e=this.i,s=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(s).then((r=>this.i!==e?(ke("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Zt(typeof r.accessToken=="string",31837,{l:r}),new bS(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Zt(e===null||typeof e=="string",2055,{h:e}),new Zn(e)}}class _R{constructor(e,s,r){this.P=e,this.T=s,this.I=r,this.type="FirstParty",this.user=Zn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class ER{constructor(e,s,r){this.P=e,this.T=s,this.I=r}getToken(){return Promise.resolve(new _R(this.P,this.T,this.I))}start(e,s){e.enqueueRetryable((()=>s(Zn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Mv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wR{constructor(e,s){this.V=s,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,eR(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,s){Zt(this.o===void 0,3512);const r=l=>{l.error!=null&&ke("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const d=l.token!==this.m;return this.m=l.token,ke("FirebaseAppCheckTokenProvider",`Received ${d?"new":"existing"} token.`),d?s(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>r(l)))};const o=l=>{ke("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>o(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?o(l):ke("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Mv(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((s=>s?(Zt(typeof s.token=="string",44558,{tokenResult:s}),this.m=s.token,new Mv(s.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SR(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),s=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(s);else for(let r=0;r<n;r++)s[r]=Math.floor(256*Math.random());return s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const o=SR(40);for(let l=0;l<o.length;++l)r.length<20&&o[l]<s&&(r+=e.charAt(o[l]%62))}return r}}function pt(n,e){return n<e?-1:n>e?1:0}function eg(n,e){const s=Math.min(n.length,e.length);for(let r=0;r<s;r++){const o=n.charAt(r),l=e.charAt(r);if(o!==l)return sm(o)===sm(l)?pt(o,l):sm(o)?1:-1}return pt(n.length,e.length)}const TR=55296,AR=57343;function sm(n){const e=n.charCodeAt(0);return e>=TR&&e<=AR}function Il(n,e,s){return n.length===e.length&&n.every(((r,o)=>s(r,e[o])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dv="__name__";class Ha{constructor(e,s,r){s===void 0?s=0:s>e.length&&tt(637,{offset:s,range:e.length}),r===void 0?r=e.length-s:r>e.length-s&&tt(1746,{length:r,range:e.length-s}),this.segments=e,this.offset=s,this.len=r}get length(){return this.len}isEqual(e){return Ha.comparator(this,e)===0}child(e){const s=this.segments.slice(this.offset,this.limit());return e instanceof Ha?e.forEach((r=>{s.push(r)})):s.push(e),this.construct(s)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let s=0;s<this.length;s++)if(this.get(s)!==e.get(s))return!1;return!0}forEach(e){for(let s=this.offset,r=this.limit();s<r;s++)e(this.segments[s])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,s){const r=Math.min(e.length,s.length);for(let o=0;o<r;o++){const l=Ha.compareSegments(e.get(o),s.get(o));if(l!==0)return l}return pt(e.length,s.length)}static compareSegments(e,s){const r=Ha.isNumericId(e),o=Ha.isNumericId(s);return r&&!o?-1:!r&&o?1:r&&o?Ha.extractNumericId(e).compare(Ha.extractNumericId(s)):eg(e,s)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ci.fromString(e.substring(4,e.length-2))}}class Wt extends Ha{construct(e,s,r){return new Wt(e,s,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const s=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ve(Ce.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);s.push(...r.split("/").filter((o=>o.length>0)))}return new Wt(s)}static emptyPath(){return new Wt([])}}const IR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ls extends Ha{construct(e,s,r){return new ls(e,s,r)}static isValidIdentifier(e){return IR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ls.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Dv}static keyField(){return new ls([Dv])}static fromServerFormat(e){const s=[];let r="",o=0;const l=()=>{if(r.length===0)throw new Ve(Ce.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);s.push(r),r=""};let d=!1;for(;o<e.length;){const m=e[o];if(m==="\\"){if(o+1===e.length)throw new Ve(Ce.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[o+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new Ve(Ce.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=p,o+=2}else m==="`"?(d=!d,o++):m!=="."||d?(r+=m,o++):(l(),o++)}if(l(),d)throw new Ve(Ce.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ls(s)}static emptyPath(){return new ls([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.path=e}static fromPath(e){return new qe(Wt.fromString(e))}static fromName(e){return new qe(Wt.fromString(e).popFirst(5))}static empty(){return new qe(Wt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Wt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,s){return Wt.comparator(e.path,s.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qe(new Wt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(n,e,s){if(!s)throw new Ve(Ce.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function CR(n,e,s,r){if(e===!0&&r===!0)throw new Ve(Ce.INVALID_ARGUMENT,`${n} and ${s} cannot be used together.`)}function Uv(n){if(!qe.isDocumentKey(n))throw new Ve(Ce.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function RR(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function OR(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":tt(12329,{type:typeof n})}function tg(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ve(Ce.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const s=OR(n);throw new Ve(Ce.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${s}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(n,e){const s={typeString:n};return e&&(s.value=e),s}function pu(n,e){if(!RR(n))throw new Ve(Ce.INVALID_ARGUMENT,"JSON must be an object");let s;for(const r in e)if(e[r]){const o=e[r].typeString,l="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){s=`JSON missing required field: '${r}'`;break}const d=n[r];if(o&&typeof d!==o){s=`JSON field '${r}' must be a ${o}.`;break}if(l!==void 0&&d!==l.value){s=`Expected '${r}' field to equal '${l.value}'`;break}}if(s)throw new Ve(Ce.INVALID_ARGUMENT,s);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv=-62135596800,Vv=1e6;class En{static now(){return En.fromMillis(Date.now())}static fromDate(e){return En.fromMillis(e.getTime())}static fromMillis(e){const s=Math.floor(e/1e3),r=Math.floor((e-1e3*s)*Vv);return new En(s,r)}constructor(e,s){if(this.seconds=e,this.nanoseconds=s,s<0)throw new Ve(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(s>=1e9)throw new Ve(Ce.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+s);if(e<Pv)throw new Ve(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ve(Ce.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Vv}_compareTo(e){return this.seconds===e.seconds?pt(this.nanoseconds,e.nanoseconds):pt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:En._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(pu(e,En._jsonSchema))return new En(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Pv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}En._jsonSchemaVersion="firestore/timestamp/1.0",En._jsonSchema={type:wn("string",En._jsonSchemaVersion),seconds:wn("number"),nanoseconds:wn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{static fromTimestamp(e){return new Je(e)}static min(){return new Je(new En(0,0))}static max(){return new Je(new En(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au=-1;function jR(n,e){const s=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,o=Je.fromTimestamp(r===1e9?new En(s+1,0):new En(s,r));return new pi(o,qe.empty(),e)}function kR(n){return new pi(n.readTime,n.key,au)}class pi{constructor(e,s,r){this.readTime=e,this.documentKey=s,this.largestBatchId=r}static min(){return new pi(Je.min(),qe.empty(),au)}static max(){return new pi(Je.max(),qe.empty(),au)}}function LR(n,e){let s=n.readTime.compareTo(e.readTime);return s!==0?s:(s=qe.comparator(n.documentKey,e.documentKey),s!==0?s:pt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class DR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jf(n){if(n.code!==Ce.FAILED_PRECONDITION||n.message!==MR)throw n;ke("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((s=>{this.isDone=!0,this.result=s,this.nextCallback&&this.nextCallback(s)}),(s=>{this.isDone=!0,this.error=s,this.catchCallback&&this.catchCallback(s)}))}catch(e){return this.next(void 0,e)}next(e,s){return this.callbackAttached&&tt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(s,this.error):this.wrapSuccess(e,this.result):new Ee(((r,o)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(r,o)},this.catchCallback=l=>{this.wrapFailure(s,l).next(r,o)}}))}toPromise(){return new Promise(((e,s)=>{this.next(e,s)}))}wrapUserFunction(e){try{const s=e();return s instanceof Ee?s:Ee.resolve(s)}catch(s){return Ee.reject(s)}}wrapSuccess(e,s){return e?this.wrapUserFunction((()=>e(s))):Ee.resolve(s)}wrapFailure(e,s){return e?this.wrapUserFunction((()=>e(s))):Ee.reject(s)}static resolve(e){return new Ee(((s,r)=>{s(e)}))}static reject(e){return new Ee(((s,r)=>{r(e)}))}static waitFor(e){return new Ee(((s,r)=>{let o=0,l=0,d=!1;e.forEach((m=>{++o,m.next((()=>{++l,d&&l===o&&s()}),(p=>r(p)))})),d=!0,l===o&&s()}))}static or(e){let s=Ee.resolve(!1);for(const r of e)s=s.next((o=>o?Ee.resolve(o):r()));return s}static forEach(e,s){const r=[];return e.forEach(((o,l)=>{r.push(s.call(this,o,l))})),this.waitFor(r)}static mapArray(e,s){return new Ee(((r,o)=>{const l=e.length,d=new Array(l);let m=0;for(let p=0;p<l;p++){const y=p;s(e[y]).next((x=>{d[y]=x,++m,m===l&&r(d)}),(x=>o(x)))}}))}static doWhile(e,s){return new Ee(((r,o)=>{const l=()=>{e()===!0?s().next((()=>{l()}),o):r()};l()}))}}function UR(n){const e=n.match(/Android ([\d.]+)/i),s=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(s)}function Ml(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e,s){this.previousValue=e,s&&(s.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>s.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}kf.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PR=-1;function Lf(n){return n==null}function ng(n){return n===0&&1/n==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS="";function VR(n){let e="";for(let s=0;s<n.length;s++)e.length>0&&(e=zv(e)),e=zR(n.get(s),e);return zv(e)}function zR(n,e){let s=e;const r=n.length;for(let o=0;o<r;o++){const l=n.charAt(o);switch(l){case"\0":s+="";break;case vS:s+="";break;default:s+=l}}return s}function zv(n){return n+vS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bv(n){let e=0;for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&e++;return e}function mu(n,e){for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&e(s,n[s])}function BR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e,s){this.comparator=e,this.root=s||Gn.EMPTY}insert(e,s){return new pn(this.comparator,this.root.insert(e,s,this.comparator).copy(null,null,Gn.BLACK,null,null))}remove(e){return new pn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Gn.BLACK,null,null))}get(e){let s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return s.value;r<0?s=s.left:r>0&&(s=s.right)}return null}indexOf(e){let s=0,r=this.root;for(;!r.isEmpty();){const o=this.comparator(e,r.key);if(o===0)return s+r.left.size;o<0?r=r.left:(s+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((s,r)=>(e(s,r),!1)))}toString(){const e=[];return this.inorderTraversal(((s,r)=>(e.push(`${s}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vd(this.root,e,this.comparator,!0)}}class Vd{constructor(e,s,r,o){this.isReverse=o,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=s?r(e.key,s):1,s&&o&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const s={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return s}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Gn{constructor(e,s,r,o,l){this.key=e,this.value=s,this.color=r??Gn.RED,this.left=o??Gn.EMPTY,this.right=l??Gn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,s,r,o,l){return new Gn(e??this.key,s??this.value,r??this.color,o??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,s,r){let o=this;const l=r(e,o.key);return o=l<0?o.copy(null,null,null,o.left.insert(e,s,r),null):l===0?o.copy(null,s,null,null,null):o.copy(null,null,null,null,o.right.insert(e,s,r)),o.fixUp()}removeMin(){if(this.left.isEmpty())return Gn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,s){let r,o=this;if(s(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,s),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),s(e,o.key)===0){if(o.right.isEmpty())return Gn.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,s))}return o.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Gn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Gn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),s=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,s)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw tt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw tt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw tt(27949);return e+(this.isRed()?0:1)}}Gn.EMPTY=null,Gn.RED=!0,Gn.BLACK=!1;Gn.EMPTY=new class{constructor(){this.size=0}get key(){throw tt(57766)}get value(){throw tt(16141)}get color(){throw tt(16727)}get left(){throw tt(29726)}get right(){throw tt(36894)}copy(e,s,r,o,l){return this}insert(e,s,r){return new Gn(e,s)}remove(e,s){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.comparator=e,this.data=new pn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((s,r)=>(e(s),!1)))}forEachInRange(e,s){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const o=r.getNext();if(this.comparator(o.key,e[1])>=0)return;s(o.key)}}forEachWhile(e,s){let r;for(r=s!==void 0?this.data.getIteratorFrom(s):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const s=this.data.getIteratorFrom(e);return s.hasNext()?s.getNext().key:null}getIterator(){return new Fv(this.data.getIterator())}getIteratorFrom(e){return new Fv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let s=this;return s.size<e.size&&(s=e,e=this),e.forEach((r=>{s=s.add(r)})),s}isEqual(e){if(!(e instanceof Rn)||this.size!==e.size)return!1;const s=this.data.getIterator(),r=e.data.getIterator();for(;s.hasNext();){const o=s.getNext().key,l=r.getNext().key;if(this.comparator(o,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((s=>{e.push(s)})),e}toString(){const e=[];return this.forEach((s=>e.push(s))),"SortedSet("+e.toString()+")"}copy(e){const s=new Rn(this.comparator);return s.data=e,s}}class Fv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e){this.fields=e,e.sort(ls.comparator)}static empty(){return new si([])}unionWith(e){let s=new Rn(ls.comparator);for(const r of this.fields)s=s.add(r);for(const r of e)s=s.add(r);return new si(s.toArray())}covers(e){for(const s of this.fields)if(s.isPrefixOf(e))return!0;return!1}isEqual(e){return Il(this.fields,e.fields,((s,r)=>s.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.binaryString=e}static fromBase64String(e){const s=(function(o){try{return atob(o)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new _S("Invalid base64 string: "+l):l}})(e);return new qn(s)}static fromUint8Array(e){const s=(function(o){let l="";for(let d=0;d<o.length;++d)l+=String.fromCharCode(o[d]);return l})(e);return new qn(s)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(s){return btoa(s)})(this.binaryString)}toUint8Array(){return(function(s){const r=new Uint8Array(s.length);for(let o=0;o<s.length;o++)r[o]=s.charCodeAt(o);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}qn.EMPTY_BYTE_STRING=new qn("");const FR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mi(n){if(Zt(!!n,39018),typeof n=="string"){let e=0;const s=FR.exec(n);if(Zt(!!s,46558,{timestamp:n}),s[1]){let o=s[1];o=(o+"000000000").substr(0,9),e=Number(o)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:fn(n.seconds),nanos:fn(n.nanos)}}function fn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function gi(n){return typeof n=="string"?qn.fromBase64String(n):qn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ES="server_timestamp",wS="__type__",SS="__previous_value__",TS="__local_write_time__";function n0(n){var s,r;return((r=(((s=n==null?void 0:n.mapValue)==null?void 0:s.fields)||{})[wS])==null?void 0:r.stringValue)===ES}function Mf(n){const e=n.mapValue.fields[SS];return n0(e)?Mf(e):e}function ru(n){const e=mi(n.mapValue.fields[TS].timestampValue);return new En(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HR{constructor(e,s,r,o,l,d,m,p,y,x,v){this.databaseId=e,this.appId=s,this.persistenceKey=r,this.host=o,this.ssl=l,this.forceLongPolling=d,this.autoDetectLongPolling=m,this.longPollingOptions=p,this.useFetchStreams=y,this.isUsingEmulator=x,this.apiKey=v}}const hf="(default)";class iu{constructor(e,s){this.projectId=e,this.database=s||hf}static empty(){return new iu("","")}get isDefaultDatabase(){return this.database===hf}isEqual(e){return e instanceof iu&&e.projectId===this.projectId&&e.database===this.database}}function GR(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Ve(Ce.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new iu(n.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qR="__type__",$R="__max__",zd={mapValue:{}},YR="__vector__",sg="value";function yi(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?n0(n)?4:WR(n)?9007199254740991:QR(n)?10:11:tt(28295,{value:n})}function Wa(n,e){if(n===e)return!0;const s=yi(n);if(s!==yi(e))return!1;switch(s){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return ru(n).isEqual(ru(e));case 3:return(function(o,l){if(typeof o.timestampValue=="string"&&typeof l.timestampValue=="string"&&o.timestampValue.length===l.timestampValue.length)return o.timestampValue===l.timestampValue;const d=mi(o.timestampValue),m=mi(l.timestampValue);return d.seconds===m.seconds&&d.nanos===m.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(o,l){return gi(o.bytesValue).isEqual(gi(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(o,l){return fn(o.geoPointValue.latitude)===fn(l.geoPointValue.latitude)&&fn(o.geoPointValue.longitude)===fn(l.geoPointValue.longitude)})(n,e);case 2:return(function(o,l){if("integerValue"in o&&"integerValue"in l)return fn(o.integerValue)===fn(l.integerValue);if("doubleValue"in o&&"doubleValue"in l){const d=fn(o.doubleValue),m=fn(l.doubleValue);return d===m?ng(d)===ng(m):isNaN(d)&&isNaN(m)}return!1})(n,e);case 9:return Il(n.arrayValue.values||[],e.arrayValue.values||[],Wa);case 10:case 11:return(function(o,l){const d=o.mapValue.fields||{},m=l.mapValue.fields||{};if(Bv(d)!==Bv(m))return!1;for(const p in d)if(d.hasOwnProperty(p)&&(m[p]===void 0||!Wa(d[p],m[p])))return!1;return!0})(n,e);default:return tt(52216,{left:n})}}function ou(n,e){return(n.values||[]).find((s=>Wa(s,e)))!==void 0}function Nl(n,e){if(n===e)return 0;const s=yi(n),r=yi(e);if(s!==r)return pt(s,r);switch(s){case 0:case 9007199254740991:return 0;case 1:return pt(n.booleanValue,e.booleanValue);case 2:return(function(l,d){const m=fn(l.integerValue||l.doubleValue),p=fn(d.integerValue||d.doubleValue);return m<p?-1:m>p?1:m===p?0:isNaN(m)?isNaN(p)?0:-1:1})(n,e);case 3:return Hv(n.timestampValue,e.timestampValue);case 4:return Hv(ru(n),ru(e));case 5:return eg(n.stringValue,e.stringValue);case 6:return(function(l,d){const m=gi(l),p=gi(d);return m.compareTo(p)})(n.bytesValue,e.bytesValue);case 7:return(function(l,d){const m=l.split("/"),p=d.split("/");for(let y=0;y<m.length&&y<p.length;y++){const x=pt(m[y],p[y]);if(x!==0)return x}return pt(m.length,p.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,d){const m=pt(fn(l.latitude),fn(d.latitude));return m!==0?m:pt(fn(l.longitude),fn(d.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Gv(n.arrayValue,e.arrayValue);case 10:return(function(l,d){var S,N,P,M;const m=l.fields||{},p=d.fields||{},y=(S=m[sg])==null?void 0:S.arrayValue,x=(N=p[sg])==null?void 0:N.arrayValue,v=pt(((P=y==null?void 0:y.values)==null?void 0:P.length)||0,((M=x==null?void 0:x.values)==null?void 0:M.length)||0);return v!==0?v:Gv(y,x)})(n.mapValue,e.mapValue);case 11:return(function(l,d){if(l===zd.mapValue&&d===zd.mapValue)return 0;if(l===zd.mapValue)return 1;if(d===zd.mapValue)return-1;const m=l.fields||{},p=Object.keys(m),y=d.fields||{},x=Object.keys(y);p.sort(),x.sort();for(let v=0;v<p.length&&v<x.length;++v){const S=eg(p[v],x[v]);if(S!==0)return S;const N=Nl(m[p[v]],y[x[v]]);if(N!==0)return N}return pt(p.length,x.length)})(n.mapValue,e.mapValue);default:throw tt(23264,{he:s})}}function Hv(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return pt(n,e);const s=mi(n),r=mi(e),o=pt(s.seconds,r.seconds);return o!==0?o:pt(s.nanos,r.nanos)}function Gv(n,e){const s=n.values||[],r=e.values||[];for(let o=0;o<s.length&&o<r.length;++o){const l=Nl(s[o],r[o]);if(l)return l}return pt(s.length,r.length)}function Cl(n){return ag(n)}function ag(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(s){const r=mi(s);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(s){return gi(s).toBase64()})(n.bytesValue):"referenceValue"in n?(function(s){return qe.fromName(s).toString()})(n.referenceValue):"geoPointValue"in n?(function(s){return`geo(${s.latitude},${s.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(s){let r="[",o=!0;for(const l of s.values||[])o?o=!1:r+=",",r+=ag(l);return r+"]"})(n.arrayValue):"mapValue"in n?(function(s){const r=Object.keys(s.fields||{}).sort();let o="{",l=!0;for(const d of r)l?l=!1:o+=",",o+=`${d}:${ag(s.fields[d])}`;return o+"}"})(n.mapValue):tt(61005,{value:n})}function ef(n){switch(yi(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Mf(n);return e?16+ef(e):16;case 5:return 2*n.stringValue.length;case 6:return gi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((o,l)=>o+ef(l)),0)})(n.arrayValue);case 10:case 11:return(function(r){let o=0;return mu(r.fields,((l,d)=>{o+=l.length+ef(d)})),o})(n.mapValue);default:throw tt(13486,{value:n})}}function rg(n){return!!n&&"integerValue"in n}function s0(n){return!!n&&"arrayValue"in n}function qv(n){return!!n&&"nullValue"in n}function $v(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function am(n){return!!n&&"mapValue"in n}function QR(n){var s,r;return((r=(((s=n==null?void 0:n.mapValue)==null?void 0:s.fields)||{})[qR])==null?void 0:r.stringValue)===YR}function Qc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return mu(n.mapValue.fields,((s,r)=>e.mapValue.fields[s]=Qc(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let s=0;s<(n.arrayValue.values||[]).length;++s)e.arrayValue.values[s]=Qc(n.arrayValue.values[s]);return e}return{...n}}function WR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===$R}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e){this.value=e}static empty(){return new qa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let s=this.value;for(let r=0;r<e.length-1;++r)if(s=(s.mapValue.fields||{})[e.get(r)],!am(s))return null;return s=(s.mapValue.fields||{})[e.lastSegment()],s||null}}set(e,s){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qc(s)}setAll(e){let s=ls.emptyPath(),r={},o=[];e.forEach(((d,m)=>{if(!s.isImmediateParentOf(m)){const p=this.getFieldsMap(s);this.applyChanges(p,r,o),r={},o=[],s=m.popLast()}d?r[m.lastSegment()]=Qc(d):o.push(m.lastSegment())}));const l=this.getFieldsMap(s);this.applyChanges(l,r,o)}delete(e){const s=this.field(e.popLast());am(s)&&s.mapValue.fields&&delete s.mapValue.fields[e.lastSegment()]}isEqual(e){return Wa(this.value,e.value)}getFieldsMap(e){let s=this.value;s.mapValue.fields||(s.mapValue={fields:{}});for(let r=0;r<e.length;++r){let o=s.mapValue.fields[e.get(r)];am(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},s.mapValue.fields[e.get(r)]=o),s=o}return s.mapValue.fields}applyChanges(e,s,r){mu(s,((o,l)=>e[o]=l));for(const o of r)delete e[o]}clone(){return new qa(Qc(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e,s,r,o,l,d,m){this.key=e,this.documentType=s,this.version=r,this.readTime=o,this.createTime=l,this.data=d,this.documentState=m}static newInvalidDocument(e){return new Xn(e,0,Je.min(),Je.min(),Je.min(),qa.empty(),0)}static newFoundDocument(e,s,r,o){return new Xn(e,1,s,Je.min(),r,o,0)}static newNoDocument(e,s){return new Xn(e,2,s,Je.min(),Je.min(),qa.empty(),0)}static newUnknownDocument(e,s){return new Xn(e,3,s,Je.min(),Je.min(),qa.empty(),2)}convertToFoundDocument(e,s){return!this.createTime.isEqual(Je.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=s,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Je.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Xn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e,s){this.position=e,this.inclusive=s}}function Yv(n,e,s){let r=0;for(let o=0;o<n.position.length;o++){const l=e[o],d=n.position[o];if(l.field.isKeyField()?r=qe.comparator(qe.fromName(d.referenceValue),s.key):r=Nl(d,s.data.field(l.field)),l.dir==="desc"&&(r*=-1),r!==0)break}return r}function Qv(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let s=0;s<n.position.length;s++)if(!Wa(n.position[s],e.position[s]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,s="asc"){this.field=e,this.dir=s}}function KR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{}class In extends AS{constructor(e,s,r){super(),this.field=e,this.op=s,this.value=r}static create(e,s,r){return e.isKeyField()?s==="in"||s==="not-in"?this.createKeyFieldInFilter(e,s,r):new XR(e,s,r):s==="array-contains"?new tO(e,r):s==="in"?new nO(e,r):s==="not-in"?new sO(e,r):s==="array-contains-any"?new aO(e,r):new In(e,s,r)}static createKeyFieldInFilter(e,s,r){return s==="in"?new JR(e,r):new eO(e,r)}matches(e){const s=e.data.field(this.field);return this.op==="!="?s!==null&&s.nullValue===void 0&&this.matchesComparison(Nl(s,this.value)):s!==null&&yi(this.value)===yi(s)&&this.matchesComparison(Nl(s,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return tt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ka extends AS{constructor(e,s){super(),this.filters=e,this.op=s,this.Pe=null}static create(e,s){return new Ka(e,s)}matches(e){return IS(this)?this.filters.find((s=>!s.matches(e)))===void 0:this.filters.find((s=>s.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,s)=>e.concat(s.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function IS(n){return n.op==="and"}function NS(n){return ZR(n)&&IS(n)}function ZR(n){for(const e of n.filters)if(e instanceof Ka)return!1;return!0}function ig(n){if(n instanceof In)return n.field.canonicalString()+n.op.toString()+Cl(n.value);if(NS(n))return n.filters.map((e=>ig(e))).join(",");{const e=n.filters.map((s=>ig(s))).join(",");return`${n.op}(${e})`}}function CS(n,e){return n instanceof In?(function(r,o){return o instanceof In&&r.op===o.op&&r.field.isEqual(o.field)&&Wa(r.value,o.value)})(n,e):n instanceof Ka?(function(r,o){return o instanceof Ka&&r.op===o.op&&r.filters.length===o.filters.length?r.filters.reduce(((l,d,m)=>l&&CS(d,o.filters[m])),!0):!1})(n,e):void tt(19439)}function RS(n){return n instanceof In?(function(s){return`${s.field.canonicalString()} ${s.op} ${Cl(s.value)}`})(n):n instanceof Ka?(function(s){return s.op.toString()+" {"+s.getFilters().map(RS).join(" ,")+"}"})(n):"Filter"}class XR extends In{constructor(e,s,r){super(e,s,r),this.key=qe.fromName(r.referenceValue)}matches(e){const s=qe.comparator(e.key,this.key);return this.matchesComparison(s)}}class JR extends In{constructor(e,s){super(e,"in",s),this.keys=OS("in",s)}matches(e){return this.keys.some((s=>s.isEqual(e.key)))}}class eO extends In{constructor(e,s){super(e,"not-in",s),this.keys=OS("not-in",s)}matches(e){return!this.keys.some((s=>s.isEqual(e.key)))}}function OS(n,e){var s;return(((s=e.arrayValue)==null?void 0:s.values)||[]).map((r=>qe.fromName(r.referenceValue)))}class tO extends In{constructor(e,s){super(e,"array-contains",s)}matches(e){const s=e.data.field(this.field);return s0(s)&&ou(s.arrayValue,this.value)}}class nO extends In{constructor(e,s){super(e,"in",s)}matches(e){const s=e.data.field(this.field);return s!==null&&ou(this.value.arrayValue,s)}}class sO extends In{constructor(e,s){super(e,"not-in",s)}matches(e){if(ou(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const s=e.data.field(this.field);return s!==null&&s.nullValue===void 0&&!ou(this.value.arrayValue,s)}}class aO extends In{constructor(e,s){super(e,"array-contains-any",s)}matches(e){const s=e.data.field(this.field);return!(!s0(s)||!s.arrayValue.values)&&s.arrayValue.values.some((r=>ou(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e,s=null,r=[],o=[],l=null,d=null,m=null){this.path=e,this.collectionGroup=s,this.orderBy=r,this.filters=o,this.limit=l,this.startAt=d,this.endAt=m,this.Te=null}}function Wv(n,e=null,s=[],r=[],o=null,l=null,d=null){return new rO(n,e,s,r,o,l,d)}function a0(n){const e=yt(n);if(e.Te===null){let s=e.path.canonicalString();e.collectionGroup!==null&&(s+="|cg:"+e.collectionGroup),s+="|f:",s+=e.filters.map((r=>ig(r))).join(","),s+="|ob:",s+=e.orderBy.map((r=>(function(l){return l.field.canonicalString()+l.dir})(r))).join(","),Lf(e.limit)||(s+="|l:",s+=e.limit),e.startAt&&(s+="|lb:",s+=e.startAt.inclusive?"b:":"a:",s+=e.startAt.position.map((r=>Cl(r))).join(",")),e.endAt&&(s+="|ub:",s+=e.endAt.inclusive?"a:":"b:",s+=e.endAt.position.map((r=>Cl(r))).join(",")),e.Te=s}return e.Te}function r0(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!KR(n.orderBy[s],e.orderBy[s]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if(!CS(n.filters[s],e.filters[s]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Qv(n.startAt,e.startAt)&&Qv(n.endAt,e.endAt)}function og(n){return qe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e,s=null,r=[],o=[],l=null,d="F",m=null,p=null){this.path=e,this.collectionGroup=s,this.explicitOrderBy=r,this.filters=o,this.limit=l,this.limitType=d,this.startAt=m,this.endAt=p,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function iO(n,e,s,r,o,l,d,m){return new Df(n,e,s,r,o,l,d,m)}function i0(n){return new Df(n)}function Kv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function oO(n){return qe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function lO(n){return n.collectionGroup!==null}function Wc(n){const e=yt(n);if(e.Ie===null){e.Ie=[];const s=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),s.add(l.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(d){let m=new Rn(ls.comparator);return d.filters.forEach((p=>{p.getFlattenedFilters().forEach((y=>{y.isInequality()&&(m=m.add(y.field))}))})),m})(e).forEach((l=>{s.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new mf(l,r))})),s.has(ls.keyField().canonicalString())||e.Ie.push(new mf(ls.keyField(),r))}return e.Ie}function Qa(n){const e=yt(n);return e.Ee||(e.Ee=cO(e,Wc(n))),e.Ee}function cO(n,e){if(n.limitType==="F")return Wv(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((o=>{const l=o.dir==="desc"?"asc":"desc";return new mf(o.field,l)}));const s=n.endAt?new pf(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new pf(n.startAt.position,n.startAt.inclusive):null;return Wv(n.path,n.collectionGroup,e,n.filters,n.limit,s,r)}}function lg(n,e,s){return new Df(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,s,n.startAt,n.endAt)}function Uf(n,e){return r0(Qa(n),Qa(e))&&n.limitType===e.limitType}function jS(n){return`${a0(Qa(n))}|lt:${n.limitType}`}function ll(n){return`Query(target=${(function(s){let r=s.path.canonicalString();return s.collectionGroup!==null&&(r+=" collectionGroup="+s.collectionGroup),s.filters.length>0&&(r+=`, filters: [${s.filters.map((o=>RS(o))).join(", ")}]`),Lf(s.limit)||(r+=", limit: "+s.limit),s.orderBy.length>0&&(r+=`, orderBy: [${s.orderBy.map((o=>(function(d){return`${d.field.canonicalString()} (${d.dir})`})(o))).join(", ")}]`),s.startAt&&(r+=", startAt: ",r+=s.startAt.inclusive?"b:":"a:",r+=s.startAt.position.map((o=>Cl(o))).join(",")),s.endAt&&(r+=", endAt: ",r+=s.endAt.inclusive?"a:":"b:",r+=s.endAt.position.map((o=>Cl(o))).join(",")),`Target(${r})`})(Qa(n))}; limitType=${n.limitType})`}function Pf(n,e){return e.isFoundDocument()&&(function(r,o){const l=o.key.path;return r.collectionGroup!==null?o.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(l):qe.isDocumentKey(r.path)?r.path.isEqual(l):r.path.isImmediateParentOf(l)})(n,e)&&(function(r,o){for(const l of Wc(r))if(!l.field.isKeyField()&&o.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(r,o){for(const l of r.filters)if(!l.matches(o))return!1;return!0})(n,e)&&(function(r,o){return!(r.startAt&&!(function(d,m,p){const y=Yv(d,m,p);return d.inclusive?y<=0:y<0})(r.startAt,Wc(r),o)||r.endAt&&!(function(d,m,p){const y=Yv(d,m,p);return d.inclusive?y>=0:y>0})(r.endAt,Wc(r),o))})(n,e)}function uO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function kS(n){return(e,s)=>{let r=!1;for(const o of Wc(n)){const l=dO(o,e,s);if(l!==0)return l;r=r||o.field.isKeyField()}return 0}}function dO(n,e,s){const r=n.field.isKeyField()?qe.comparator(e.key,s.key):(function(l,d,m){const p=d.data.field(l),y=m.data.field(l);return p!==null&&y!==null?Nl(p,y):tt(42886)})(n.field,e,s);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return tt(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,s){this.mapKeyFn=e,this.equalsFn=s,this.inner={},this.innerSize=0}get(e){const s=this.mapKeyFn(e),r=this.inner[s];if(r!==void 0){for(const[o,l]of r)if(this.equalsFn(o,e))return l}}has(e){return this.get(e)!==void 0}set(e,s){const r=this.mapKeyFn(e),o=this.inner[r];if(o===void 0)return this.inner[r]=[[e,s]],void this.innerSize++;for(let l=0;l<o.length;l++)if(this.equalsFn(o[l][0],e))return void(o[l]=[e,s]);o.push([e,s]),this.innerSize++}delete(e){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return!1;for(let o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return r.length===1?delete this.inner[s]:r.splice(o,1),this.innerSize--,!0;return!1}forEach(e){mu(this.inner,((s,r)=>{for(const[o,l]of r)e(o,l)}))}isEmpty(){return BR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO=new pn(qe.comparator);function xi(){return fO}const LS=new pn(qe.comparator);function Lc(...n){let e=LS;for(const s of n)e=e.insert(s.key,s);return e}function hO(n){let e=LS;return n.forEach(((s,r)=>e=e.insert(s,r.overlayedDocument))),e}function eo(){return Kc()}function MS(){return Kc()}function Kc(){return new yo((n=>n.toString()),((n,e)=>n.isEqual(e)))}const pO=new Rn(qe.comparator);function bt(...n){let e=pO;for(const s of n)e=e.add(s);return e}const mO=new Rn(pt);function gO(){return mO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yO(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ng(e)?"-0":e}}function xO(n){return{integerValue:""+n}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vf{constructor(){this._=void 0}}function bO(n,e,s){return n instanceof cg?(function(o,l){const d={fields:{[wS]:{stringValue:ES},[TS]:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return l&&n0(l)&&(l=Mf(l)),l&&(d.fields[SS]=l),{mapValue:d}})(s,e):n instanceof gf?DS(n,e):n instanceof yf?US(n,e):(function(o,l){const d=_O(o,l),m=Zv(d)+Zv(o.Ae);return rg(d)&&rg(o.Ae)?xO(m):yO(o.serializer,m)})(n,e)}function vO(n,e,s){return n instanceof gf?DS(n,e):n instanceof yf?US(n,e):s}function _O(n,e){return n instanceof ug?(function(r){return rg(r)||(function(l){return!!l&&"doubleValue"in l})(r)})(e)?e:{integerValue:0}:null}class cg extends Vf{}class gf extends Vf{constructor(e){super(),this.elements=e}}function DS(n,e){const s=PS(e);for(const r of n.elements)s.some((o=>Wa(o,r)))||s.push(r);return{arrayValue:{values:s}}}class yf extends Vf{constructor(e){super(),this.elements=e}}function US(n,e){let s=PS(e);for(const r of n.elements)s=s.filter((o=>!Wa(o,r)));return{arrayValue:{values:s}}}class ug extends Vf{constructor(e,s){super(),this.serializer=e,this.Ae=s}}function Zv(n){return fn(n.integerValue||n.doubleValue)}function PS(n){return s0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function EO(n,e){return n.field.isEqual(e.field)&&(function(r,o){return r instanceof gf&&o instanceof gf||r instanceof yf&&o instanceof yf?Il(r.elements,o.elements,Wa):r instanceof ug&&o instanceof ug?Wa(r.Ae,o.Ae):r instanceof cg&&o instanceof cg})(n.transform,e.transform)}class no{constructor(e,s){this.updateTime=e,this.exists=s}static none(){return new no}static exists(e){return new no(void 0,e)}static updateTime(e){return new no(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function tf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class o0{}function VS(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new SO(n.key,no.none()):new l0(n.key,n.data,no.none());{const s=n.data,r=qa.empty();let o=new Rn(ls.comparator);for(let l of e.fields)if(!o.has(l)){let d=s.field(l);d===null&&l.length>1&&(l=l.popLast(),d=s.field(l)),d===null?r.delete(l):r.set(l,d),o=o.add(l)}return new zf(n.key,r,new si(o.toArray()),no.none())}}function wO(n,e,s){n instanceof l0?(function(o,l,d){const m=o.value.clone(),p=Jv(o.fieldTransforms,l,d.transformResults);m.setAll(p),l.convertToFoundDocument(d.version,m).setHasCommittedMutations()})(n,e,s):n instanceof zf?(function(o,l,d){if(!tf(o.precondition,l))return void l.convertToUnknownDocument(d.version);const m=Jv(o.fieldTransforms,l,d.transformResults),p=l.data;p.setAll(zS(o)),p.setAll(m),l.convertToFoundDocument(d.version,p).setHasCommittedMutations()})(n,e,s):(function(o,l,d){l.convertToNoDocument(d.version).setHasCommittedMutations()})(0,e,s)}function Zc(n,e,s,r){return n instanceof l0?(function(l,d,m,p){if(!tf(l.precondition,d))return m;const y=l.value.clone(),x=e1(l.fieldTransforms,p,d);return y.setAll(x),d.convertToFoundDocument(d.version,y).setHasLocalMutations(),null})(n,e,s,r):n instanceof zf?(function(l,d,m,p){if(!tf(l.precondition,d))return m;const y=e1(l.fieldTransforms,p,d),x=d.data;return x.setAll(zS(l)),x.setAll(y),d.convertToFoundDocument(d.version,x).setHasLocalMutations(),m===null?null:m.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(n,e,s,r):(function(l,d,m){return tf(l.precondition,d)?(d.convertToNoDocument(d.version).setHasLocalMutations(),null):m})(n,e,s)}function Xv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,o){return r===void 0&&o===void 0||!(!r||!o)&&Il(r,o,((l,d)=>EO(l,d)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class l0 extends o0{constructor(e,s,r,o=[]){super(),this.key=e,this.value=s,this.precondition=r,this.fieldTransforms=o,this.type=0}getFieldMask(){return null}}class zf extends o0{constructor(e,s,r,o,l=[]){super(),this.key=e,this.data=s,this.fieldMask=r,this.precondition=o,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function zS(n){const e=new Map;return n.fieldMask.fields.forEach((s=>{if(!s.isEmpty()){const r=n.data.field(s);e.set(s,r)}})),e}function Jv(n,e,s){const r=new Map;Zt(n.length===s.length,32656,{Ve:s.length,de:n.length});for(let o=0;o<s.length;o++){const l=n[o],d=l.transform,m=e.data.field(l.field);r.set(l.field,vO(d,m,s[o]))}return r}function e1(n,e,s){const r=new Map;for(const o of n){const l=o.transform,d=s.data.field(o.field);r.set(o.field,bO(l,d,e))}return r}class SO extends o0{constructor(e,s){super(),this.key=e,this.precondition=s,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TO{constructor(e,s,r,o){this.batchId=e,this.localWriteTime=s,this.baseMutations=r,this.mutations=o}applyToRemoteDocument(e,s){const r=s.mutationResults;for(let o=0;o<this.mutations.length;o++){const l=this.mutations[o];l.key.isEqual(e.key)&&wO(l,e,r[o])}}applyToLocalView(e,s){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(s=Zc(r,e,s,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(s=Zc(r,e,s,this.localWriteTime));return s}applyToLocalDocumentSet(e,s){const r=MS();return this.mutations.forEach((o=>{const l=e.get(o.key),d=l.overlayedDocument;let m=this.applyToLocalView(d,l.mutatedFields);m=s.has(o.key)?null:m;const p=VS(d,m);p!==null&&r.set(o.key,p),d.isValidDocument()||d.convertToNoDocument(Je.min())})),r}keys(){return this.mutations.reduce(((e,s)=>e.add(s.key)),bt())}isEqual(e){return this.batchId===e.batchId&&Il(this.mutations,e.mutations,((s,r)=>Xv(s,r)))&&Il(this.baseMutations,e.baseMutations,((s,r)=>Xv(s,r)))}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(e,s){this.largestBatchId=e,this.mutation=s}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(e,s){this.count=e,this.unchangedNames=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _n,mt;function BS(n){if(n===void 0)return Sr("GRPC error has no .code"),Ce.UNKNOWN;switch(n){case _n.OK:return Ce.OK;case _n.CANCELLED:return Ce.CANCELLED;case _n.UNKNOWN:return Ce.UNKNOWN;case _n.DEADLINE_EXCEEDED:return Ce.DEADLINE_EXCEEDED;case _n.RESOURCE_EXHAUSTED:return Ce.RESOURCE_EXHAUSTED;case _n.INTERNAL:return Ce.INTERNAL;case _n.UNAVAILABLE:return Ce.UNAVAILABLE;case _n.UNAUTHENTICATED:return Ce.UNAUTHENTICATED;case _n.INVALID_ARGUMENT:return Ce.INVALID_ARGUMENT;case _n.NOT_FOUND:return Ce.NOT_FOUND;case _n.ALREADY_EXISTS:return Ce.ALREADY_EXISTS;case _n.PERMISSION_DENIED:return Ce.PERMISSION_DENIED;case _n.FAILED_PRECONDITION:return Ce.FAILED_PRECONDITION;case _n.ABORTED:return Ce.ABORTED;case _n.OUT_OF_RANGE:return Ce.OUT_OF_RANGE;case _n.UNIMPLEMENTED:return Ce.UNIMPLEMENTED;case _n.DATA_LOSS:return Ce.DATA_LOSS;default:return tt(39323,{code:n})}}(mt=_n||(_n={}))[mt.OK=0]="OK",mt[mt.CANCELLED=1]="CANCELLED",mt[mt.UNKNOWN=2]="UNKNOWN",mt[mt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",mt[mt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",mt[mt.NOT_FOUND=5]="NOT_FOUND",mt[mt.ALREADY_EXISTS=6]="ALREADY_EXISTS",mt[mt.PERMISSION_DENIED=7]="PERMISSION_DENIED",mt[mt.UNAUTHENTICATED=16]="UNAUTHENTICATED",mt[mt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",mt[mt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",mt[mt.ABORTED=10]="ABORTED",mt[mt.OUT_OF_RANGE=11]="OUT_OF_RANGE",mt[mt.UNIMPLEMENTED=12]="UNIMPLEMENTED",mt[mt.INTERNAL=13]="INTERNAL",mt[mt.UNAVAILABLE=14]="UNAVAILABLE",mt[mt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CO=new ci([4294967295,4294967295],0);function t1(n){const e=NO().encode(n),s=new fS;return s.update(e),new Uint8Array(s.digest())}function n1(n){const e=new DataView(n.buffer),s=e.getUint32(0,!0),r=e.getUint32(4,!0),o=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new ci([s,r],0),new ci([o,l],0)]}class c0{constructor(e,s,r){if(this.bitmap=e,this.padding=s,this.hashCount=r,s<0||s>=8)throw new Mc(`Invalid padding: ${s}`);if(r<0)throw new Mc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Mc(`Invalid hash count: ${r}`);if(e.length===0&&s!==0)throw new Mc(`Invalid padding when bitmap length is 0: ${s}`);this.ge=8*e.length-s,this.pe=ci.fromNumber(this.ge)}ye(e,s,r){let o=e.add(s.multiply(ci.fromNumber(r)));return o.compare(CO)===1&&(o=new ci([o.getBits(0),o.getBits(1)],0)),o.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const s=t1(e),[r,o]=n1(s);for(let l=0;l<this.hashCount;l++){const d=this.ye(r,o,l);if(!this.we(d))return!1}return!0}static create(e,s,r){const o=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),d=new c0(l,o,s);return r.forEach((m=>d.insert(m))),d}insert(e){if(this.ge===0)return;const s=t1(e),[r,o]=n1(s);for(let l=0;l<this.hashCount;l++){const d=this.ye(r,o,l);this.be(d)}}be(e){const s=Math.floor(e/8),r=e%8;this.bitmap[s]|=1<<r}}class Mc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,s,r,o,l){this.snapshotVersion=e,this.targetChanges=s,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,s,r){const o=new Map;return o.set(e,gu.createSynthesizedTargetChangeForCurrentChange(e,s,r)),new Bf(Je.min(),o,new pn(pt),xi(),bt())}}class gu{constructor(e,s,r,o,l){this.resumeToken=e,this.current=s,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,s,r){return new gu(r,s,bt(),bt(),bt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,s,r,o){this.Se=e,this.removedTargetIds=s,this.key=r,this.De=o}}class FS{constructor(e,s){this.targetId=e,this.Ce=s}}class HS{constructor(e,s,r=qn.EMPTY_BYTE_STRING,o=null){this.state=e,this.targetIds=s,this.resumeToken=r,this.cause=o}}class s1{constructor(){this.ve=0,this.Fe=a1(),this.Me=qn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=bt(),s=bt(),r=bt();return this.Fe.forEach(((o,l)=>{switch(l){case 0:e=e.add(o);break;case 2:s=s.add(o);break;case 1:r=r.add(o);break;default:tt(38017,{changeType:l})}})),new gu(this.Me,this.xe,e,s,r)}Ke(){this.Oe=!1,this.Fe=a1()}qe(e,s){this.Oe=!0,this.Fe=this.Fe.insert(e,s)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,Zt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class RO{constructor(e){this.Ge=e,this.ze=new Map,this.je=xi(),this.He=Bd(),this.Je=Bd(),this.Ze=new pn(pt)}Xe(e){for(const s of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(s,e.De):this.et(s,e.key,e.De);for(const s of e.removedTargetIds)this.et(s,e.key,e.De)}tt(e){this.forEachTarget(e,(s=>{const r=this.nt(s);switch(e.state){case 0:this.rt(s)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(s);break;case 3:this.rt(s)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(s)&&(this.it(s),r.Le(e.resumeToken));break;default:tt(56790,{state:e.state})}}))}forEachTarget(e,s){e.targetIds.length>0?e.targetIds.forEach(s):this.ze.forEach(((r,o)=>{this.rt(o)&&s(o)}))}st(e){const s=e.targetId,r=e.Ce.count,o=this.ot(s);if(o){const l=o.target;if(og(l))if(r===0){const d=new qe(l.path);this.et(s,d,Xn.newNoDocument(d,Je.min()))}else Zt(r===1,20013,{expectedCount:r});else{const d=this._t(s);if(d!==r){const m=this.ut(e),p=m?this.ct(m,e,d):1;if(p!==0){this.it(s);const y=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(s,y)}}}}}ut(e){const s=e.Ce.unchangedNames;if(!s||!s.bits)return null;const{bits:{bitmap:r="",padding:o=0},hashCount:l=0}=s;let d,m;try{d=gi(r).toUint8Array()}catch(p){if(p instanceof _S)return po("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{m=new c0(d,o,l)}catch(p){return po(p instanceof Mc?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return m.ge===0?null:m}ct(e,s,r){return s.Ce.count===r-this.Pt(e,s.targetId)?0:2}Pt(e,s){const r=this.Ge.getRemoteKeysForTarget(s);let o=0;return r.forEach((l=>{const d=this.Ge.ht(),m=`projects/${d.projectId}/databases/${d.database}/documents/${l.path.canonicalString()}`;e.mightContain(m)||(this.et(s,l,null),o++)})),o}Tt(e){const s=new Map;this.ze.forEach(((l,d)=>{const m=this.ot(d);if(m){if(l.current&&og(m.target)){const p=new qe(m.target.path);this.It(p).has(d)||this.Et(d,p)||this.et(d,p,Xn.newNoDocument(p,e))}l.Be&&(s.set(d,l.ke()),l.Ke())}}));let r=bt();this.Je.forEach(((l,d)=>{let m=!0;d.forEachWhile((p=>{const y=this.ot(p);return!y||y.purpose==="TargetPurposeLimboResolution"||(m=!1,!1)})),m&&(r=r.add(l))})),this.je.forEach(((l,d)=>d.setReadTime(e)));const o=new Bf(e,s,this.Ze,this.je,r);return this.je=xi(),this.He=Bd(),this.Je=Bd(),this.Ze=new pn(pt),o}Ye(e,s){if(!this.rt(e))return;const r=this.Et(e,s.key)?2:0;this.nt(e).qe(s.key,r),this.je=this.je.insert(s.key,s),this.He=this.He.insert(s.key,this.It(s.key).add(e)),this.Je=this.Je.insert(s.key,this.Rt(s.key).add(e))}et(e,s,r){if(!this.rt(e))return;const o=this.nt(e);this.Et(e,s)?o.qe(s,1):o.Ue(s),this.Je=this.Je.insert(s,this.Rt(s).delete(e)),this.Je=this.Je.insert(s,this.Rt(s).add(e)),r&&(this.je=this.je.insert(s,r))}removeTarget(e){this.ze.delete(e)}_t(e){const s=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+s.addedDocuments.size-s.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let s=this.ze.get(e);return s||(s=new s1,this.ze.set(e,s)),s}Rt(e){let s=this.Je.get(e);return s||(s=new Rn(pt),this.Je=this.Je.insert(e,s)),s}It(e){let s=this.He.get(e);return s||(s=new Rn(pt),this.He=this.He.insert(e,s)),s}rt(e){const s=this.ot(e)!==null;return s||ke("WatchChangeAggregator","Detected inactive target",e),s}ot(e){const s=this.ze.get(e);return s&&s.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new s1),this.Ge.getRemoteKeysForTarget(e).forEach((s=>{this.et(e,s,null)}))}Et(e,s){return this.Ge.getRemoteKeysForTarget(e).has(s)}}function Bd(){return new pn(qe.comparator)}function a1(){return new pn(qe.comparator)}const OO={asc:"ASCENDING",desc:"DESCENDING"},jO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},kO={and:"AND",or:"OR"};class LO{constructor(e,s){this.databaseId=e,this.useProto3Json=s}}function dg(n,e){return n.useProto3Json||Lf(e)?e:{value:e}}function MO(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function DO(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function bl(n){return Zt(!!n,49232),Je.fromTimestamp((function(s){const r=mi(s);return new En(r.seconds,r.nanos)})(n))}function UO(n,e){return fg(n,e).canonicalString()}function fg(n,e){const s=(function(o){return new Wt(["projects",o.projectId,"databases",o.database])})(n).child("documents");return e===void 0?s:s.child(e)}function GS(n){const e=Wt.fromString(n);return Zt(WS(e),10190,{key:e.toString()}),e}function rm(n,e){const s=GS(e);if(s.get(1)!==n.databaseId.projectId)throw new Ve(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+s.get(1)+" vs "+n.databaseId.projectId);if(s.get(3)!==n.databaseId.database)throw new Ve(Ce.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+s.get(3)+" vs "+n.databaseId.database);return new qe($S(s))}function qS(n,e){return UO(n.databaseId,e)}function PO(n){const e=GS(n);return e.length===4?Wt.emptyPath():$S(e)}function r1(n){return new Wt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function $S(n){return Zt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function VO(n,e){let s;if("targetChange"in e){e.targetChange;const r=(function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:tt(39313,{state:y})})(e.targetChange.targetChangeType||"NO_CHANGE"),o=e.targetChange.targetIds||[],l=(function(y,x){return y.useProto3Json?(Zt(x===void 0||typeof x=="string",58123),qn.fromBase64String(x||"")):(Zt(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),qn.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),d=e.targetChange.cause,m=d&&(function(y){const x=y.code===void 0?Ce.UNKNOWN:BS(y.code);return new Ve(x,y.message||"")})(d);s=new HS(r,o,l,m||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const o=rm(n,r.document.name),l=bl(r.document.updateTime),d=r.document.createTime?bl(r.document.createTime):Je.min(),m=new qa({mapValue:{fields:r.document.fields}}),p=Xn.newFoundDocument(o,l,d,m),y=r.targetIds||[],x=r.removedTargetIds||[];s=new nf(y,x,p.key,p)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const o=rm(n,r.document),l=r.readTime?bl(r.readTime):Je.min(),d=Xn.newNoDocument(o,l),m=r.removedTargetIds||[];s=new nf([],m,d.key,d)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const o=rm(n,r.document),l=r.removedTargetIds||[];s=new nf([],l,o,null)}else{if(!("filter"in e))return tt(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:o=0,unchangedNames:l}=r,d=new IO(o,l),m=r.targetId;s=new FS(m,d)}}return s}function zO(n,e){return{documents:[qS(n,e.path)]}}function BO(n,e){const s={structuredQuery:{}},r=e.path;let o;e.collectionGroup!==null?(o=r,s.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(o=r.popLast(),s.structuredQuery.from=[{collectionId:r.lastSegment()}]),s.parent=qS(n,o);const l=(function(y){if(y.length!==0)return QS(Ka.create(y,"and"))})(e.filters);l&&(s.structuredQuery.where=l);const d=(function(y){if(y.length!==0)return y.map((x=>(function(S){return{field:cl(S.field),direction:GO(S.dir)}})(x)))})(e.orderBy);d&&(s.structuredQuery.orderBy=d);const m=dg(n,e.limit);return m!==null&&(s.structuredQuery.limit=m),e.startAt&&(s.structuredQuery.startAt=(function(y){return{before:y.inclusive,values:y.position}})(e.startAt)),e.endAt&&(s.structuredQuery.endAt=(function(y){return{before:!y.inclusive,values:y.position}})(e.endAt)),{ft:s,parent:o}}function FO(n){let e=PO(n.parent);const s=n.structuredQuery,r=s.from?s.from.length:0;let o=null;if(r>0){Zt(r===1,65062);const x=s.from[0];x.allDescendants?o=x.collectionId:e=e.child(x.collectionId)}let l=[];s.where&&(l=(function(v){const S=YS(v);return S instanceof Ka&&NS(S)?S.getFilters():[S]})(s.where));let d=[];s.orderBy&&(d=(function(v){return v.map((S=>(function(P){return new mf(ul(P.field),(function(j){switch(j){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(P.direction))})(S)))})(s.orderBy));let m=null;s.limit&&(m=(function(v){let S;return S=typeof v=="object"?v.value:v,Lf(S)?null:S})(s.limit));let p=null;s.startAt&&(p=(function(v){const S=!!v.before,N=v.values||[];return new pf(N,S)})(s.startAt));let y=null;return s.endAt&&(y=(function(v){const S=!v.before,N=v.values||[];return new pf(N,S)})(s.endAt)),iO(e,o,d,l,m,"F",p,y)}function HO(n,e){const s=(function(o){switch(o){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return tt(28987,{purpose:o})}})(e.purpose);return s==null?null:{"goog-listen-tags":s}}function YS(n){return n.unaryFilter!==void 0?(function(s){switch(s.unaryFilter.op){case"IS_NAN":const r=ul(s.unaryFilter.field);return In.create(r,"==",{doubleValue:NaN});case"IS_NULL":const o=ul(s.unaryFilter.field);return In.create(o,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=ul(s.unaryFilter.field);return In.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const d=ul(s.unaryFilter.field);return In.create(d,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return tt(61313);default:return tt(60726)}})(n):n.fieldFilter!==void 0?(function(s){return In.create(ul(s.fieldFilter.field),(function(o){switch(o){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return tt(58110);default:return tt(50506)}})(s.fieldFilter.op),s.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(s){return Ka.create(s.compositeFilter.filters.map((r=>YS(r))),(function(o){switch(o){case"AND":return"and";case"OR":return"or";default:return tt(1026)}})(s.compositeFilter.op))})(n):tt(30097,{filter:n})}function GO(n){return OO[n]}function qO(n){return jO[n]}function $O(n){return kO[n]}function cl(n){return{fieldPath:n.canonicalString()}}function ul(n){return ls.fromServerFormat(n.fieldPath)}function QS(n){return n instanceof In?(function(s){if(s.op==="=="){if($v(s.value))return{unaryFilter:{field:cl(s.field),op:"IS_NAN"}};if(qv(s.value))return{unaryFilter:{field:cl(s.field),op:"IS_NULL"}}}else if(s.op==="!="){if($v(s.value))return{unaryFilter:{field:cl(s.field),op:"IS_NOT_NAN"}};if(qv(s.value))return{unaryFilter:{field:cl(s.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cl(s.field),op:qO(s.op),value:s.value}}})(n):n instanceof Ka?(function(s){const r=s.getFilters().map((o=>QS(o)));return r.length===1?r[0]:{compositeFilter:{op:$O(s.op),filters:r}}})(n):tt(54877,{filter:n})}function WS(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e,s,r,o,l=Je.min(),d=Je.min(),m=qn.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=s,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=d,this.resumeToken=m,this.expectedCount=p}withSequenceNumber(e){return new ai(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,s){return new ai(this.target,this.targetId,this.purpose,this.sequenceNumber,s,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ai(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ai(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(e){this.yt=e}}function QO(n){const e=FO({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?lg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(){this.Sn=new KO}addToCollectionParentIndex(e,s){return this.Sn.add(s),Ee.resolve()}getCollectionParents(e,s){return Ee.resolve(this.Sn.getEntries(s))}addFieldIndex(e,s){return Ee.resolve()}deleteFieldIndex(e,s){return Ee.resolve()}deleteAllFieldIndexes(e){return Ee.resolve()}createTargetIndexes(e,s){return Ee.resolve()}getDocumentsMatchingTarget(e,s){return Ee.resolve(null)}getIndexType(e,s){return Ee.resolve(0)}getFieldIndexes(e,s){return Ee.resolve([])}getNextCollectionGroupToUpdate(e){return Ee.resolve(null)}getMinOffset(e,s){return Ee.resolve(pi.min())}getMinOffsetFromCollectionGroup(e,s){return Ee.resolve(pi.min())}updateCollectionGroup(e,s,r){return Ee.resolve()}updateIndexEntries(e,s){return Ee.resolve()}}class KO{constructor(){this.index={}}add(e){const s=e.lastSegment(),r=e.popLast(),o=this.index[s]||new Rn(Wt.comparator),l=!o.has(r);return this.index[s]=o.add(r),l}has(e){const s=e.lastSegment(),r=e.popLast(),o=this.index[s];return o&&o.has(r)}getEntries(e){return(this.index[e]||new Rn(Wt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},KS=41943040;class bs{static withCacheSize(e){return new bs(e,bs.DEFAULT_COLLECTION_PERCENTILE,bs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,s,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=s,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */bs.DEFAULT_COLLECTION_PERCENTILE=10,bs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,bs.DEFAULT=new bs(KS,bs.DEFAULT_COLLECTION_PERCENTILE,bs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),bs.DISABLED=new bs(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Rl(0)}static ar(){return new Rl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1="LruGarbageCollector",ZO=1048576;function l1([n,e],[s,r]){const o=pt(n,s);return o===0?pt(e,r):o}class XO{constructor(e){this.Pr=e,this.buffer=new Rn(l1),this.Tr=0}Ir(){return++this.Tr}Er(e){const s=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(s);else{const r=this.buffer.last();l1(s,r)<0&&(this.buffer=this.buffer.delete(r).add(s))}}get maxValue(){return this.buffer.last()[0]}}class JO{constructor(e,s,r){this.garbageCollector=e,this.asyncQueue=s,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){ke(o1,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(s){Ml(s)?ke(o1,"Ignoring IndexedDB error during garbage collection: ",s):await jf(s)}await this.Ar(3e5)}))}}class ej{constructor(e,s){this.Vr=e,this.params=s}calculateTargetCount(e,s){return this.Vr.dr(e).next((r=>Math.floor(s/100*r)))}nthSequenceNumber(e,s){if(s===0)return Ee.resolve(kf.ce);const r=new XO(s);return this.Vr.forEachTarget(e,(o=>r.Er(o.sequenceNumber))).next((()=>this.Vr.mr(e,(o=>r.Er(o))))).next((()=>r.maxValue))}removeTargets(e,s,r){return this.Vr.removeTargets(e,s,r)}removeOrphanedDocuments(e,s){return this.Vr.removeOrphanedDocuments(e,s)}collect(e,s){return this.params.cacheSizeCollectionThreshold===-1?(ke("LruGarbageCollector","Garbage collection skipped; disabled"),Ee.resolve(i1)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ke("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),i1):this.gr(e,s)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,s){let r,o,l,d,m,p,y;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(ke("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),o=this.params.maximumSequenceNumbersToCollect):o=v,d=Date.now(),this.nthSequenceNumber(e,o)))).next((v=>(r=v,m=Date.now(),this.removeTargets(e,r,s)))).next((v=>(l=v,p=Date.now(),this.removeOrphanedDocuments(e,r)))).next((v=>(y=Date.now(),ol()<=gt.DEBUG&&ke("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${d-x}ms
	Determined least recently used ${o} in `+(m-d)+`ms
	Removed ${l} targets in `+(p-m)+`ms
	Removed ${v} documents in `+(y-p)+`ms
Total Duration: ${y-x}ms`),Ee.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:l,documentsRemoved:v}))))}}function tj(n,e){return new ej(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(){this.changes=new yo((e=>e.toString()),((e,s)=>e.isEqual(s))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,s){this.assertNotApplied(),this.changes.set(e,Xn.newInvalidDocument(e).setReadTime(s))}getEntry(e,s){this.assertNotApplied();const r=this.changes.get(s);return r!==void 0?Ee.resolve(r):this.getFromCache(e,s)}getEntries(e,s){return this.getAllFromCache(e,s)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(e,s){this.overlayedDocument=e,this.mutatedFields=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e,s,r,o){this.remoteDocumentCache=e,this.mutationQueue=s,this.documentOverlayCache=r,this.indexManager=o}getDocument(e,s){let r=null;return this.documentOverlayCache.getOverlay(e,s).next((o=>(r=o,this.remoteDocumentCache.getEntry(e,s)))).next((o=>(r!==null&&Zc(r.mutation,o,si.empty(),En.now()),o)))}getDocuments(e,s){return this.remoteDocumentCache.getEntries(e,s).next((r=>this.getLocalViewOfDocuments(e,r,bt()).next((()=>r))))}getLocalViewOfDocuments(e,s,r=bt()){const o=eo();return this.populateOverlays(e,o,s).next((()=>this.computeViews(e,s,o,r).next((l=>{let d=Lc();return l.forEach(((m,p)=>{d=d.insert(m,p.overlayedDocument)})),d}))))}getOverlayedDocuments(e,s){const r=eo();return this.populateOverlays(e,r,s).next((()=>this.computeViews(e,s,r,bt())))}populateOverlays(e,s,r){const o=[];return r.forEach((l=>{s.has(l)||o.push(l)})),this.documentOverlayCache.getOverlays(e,o).next((l=>{l.forEach(((d,m)=>{s.set(d,m)}))}))}computeViews(e,s,r,o){let l=xi();const d=Kc(),m=(function(){return Kc()})();return s.forEach(((p,y)=>{const x=r.get(y.key);o.has(y.key)&&(x===void 0||x.mutation instanceof zf)?l=l.insert(y.key,y):x!==void 0?(d.set(y.key,x.mutation.getFieldMask()),Zc(x.mutation,y,x.mutation.getFieldMask(),En.now())):d.set(y.key,si.empty())})),this.recalculateAndSaveOverlays(e,l).next((p=>(p.forEach(((y,x)=>d.set(y,x))),s.forEach(((y,x)=>m.set(y,new sj(x,d.get(y)??null)))),m)))}recalculateAndSaveOverlays(e,s){const r=Kc();let o=new pn(((d,m)=>d-m)),l=bt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,s).next((d=>{for(const m of d)m.keys().forEach((p=>{const y=s.get(p);if(y===null)return;let x=r.get(p)||si.empty();x=m.applyToLocalView(y,x),r.set(p,x);const v=(o.get(m.batchId)||bt()).add(p);o=o.insert(m.batchId,v)}))})).next((()=>{const d=[],m=o.getReverseIterator();for(;m.hasNext();){const p=m.getNext(),y=p.key,x=p.value,v=MS();x.forEach((S=>{if(!l.has(S)){const N=VS(s.get(S),r.get(S));N!==null&&v.set(S,N),l=l.add(S)}})),d.push(this.documentOverlayCache.saveOverlays(e,y,v))}return Ee.waitFor(d)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,s){return this.remoteDocumentCache.getEntries(e,s).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,s,r,o){return oO(s)?this.getDocumentsMatchingDocumentQuery(e,s.path):lO(s)?this.getDocumentsMatchingCollectionGroupQuery(e,s,r,o):this.getDocumentsMatchingCollectionQuery(e,s,r,o)}getNextDocuments(e,s,r,o){return this.remoteDocumentCache.getAllFromCollectionGroup(e,s,r,o).next((l=>{const d=o-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,s,r.largestBatchId,o-l.size):Ee.resolve(eo());let m=au,p=l;return d.next((y=>Ee.forEach(y,((x,v)=>(m<v.largestBatchId&&(m=v.largestBatchId),l.get(x)?Ee.resolve():this.remoteDocumentCache.getEntry(e,x).next((S=>{p=p.insert(x,S)}))))).next((()=>this.populateOverlays(e,y,l))).next((()=>this.computeViews(e,p,y,bt()))).next((x=>({batchId:m,changes:hO(x)})))))}))}getDocumentsMatchingDocumentQuery(e,s){return this.getDocument(e,new qe(s)).next((r=>{let o=Lc();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o}))}getDocumentsMatchingCollectionGroupQuery(e,s,r,o){const l=s.collectionGroup;let d=Lc();return this.indexManager.getCollectionParents(e,l).next((m=>Ee.forEach(m,(p=>{const y=(function(v,S){return new Df(S,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(s,p.child(l));return this.getDocumentsMatchingCollectionQuery(e,y,r,o).next((x=>{x.forEach(((v,S)=>{d=d.insert(v,S)}))}))})).next((()=>d))))}getDocumentsMatchingCollectionQuery(e,s,r,o){let l;return this.documentOverlayCache.getOverlaysForCollection(e,s.path,r.largestBatchId).next((d=>(l=d,this.remoteDocumentCache.getDocumentsMatchingQuery(e,s,r,l,o)))).next((d=>{l.forEach(((p,y)=>{const x=y.getKey();d.get(x)===null&&(d=d.insert(x,Xn.newInvalidDocument(x)))}));let m=Lc();return d.forEach(((p,y)=>{const x=l.get(p);x!==void 0&&Zc(x.mutation,y,si.empty(),En.now()),Pf(s,y)&&(m=m.insert(p,y))})),m}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,s){return Ee.resolve(this.Nr.get(s))}saveBundleMetadata(e,s){return this.Nr.set(s.id,(function(o){return{id:o.id,version:o.version,createTime:bl(o.createTime)}})(s)),Ee.resolve()}getNamedQuery(e,s){return Ee.resolve(this.Br.get(s))}saveNamedQuery(e,s){return this.Br.set(s.name,(function(o){return{name:o.name,query:QO(o.bundledQuery),readTime:bl(o.readTime)}})(s)),Ee.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(){this.overlays=new pn(qe.comparator),this.Lr=new Map}getOverlay(e,s){return Ee.resolve(this.overlays.get(s))}getOverlays(e,s){const r=eo();return Ee.forEach(s,(o=>this.getOverlay(e,o).next((l=>{l!==null&&r.set(o,l)})))).next((()=>r))}saveOverlays(e,s,r){return r.forEach(((o,l)=>{this.bt(e,s,l)})),Ee.resolve()}removeOverlaysForBatchId(e,s,r){const o=this.Lr.get(r);return o!==void 0&&(o.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(r)),Ee.resolve()}getOverlaysForCollection(e,s,r){const o=eo(),l=s.length+1,d=new qe(s.child("")),m=this.overlays.getIteratorFrom(d);for(;m.hasNext();){const p=m.getNext().value,y=p.getKey();if(!s.isPrefixOf(y.path))break;y.path.length===l&&p.largestBatchId>r&&o.set(p.getKey(),p)}return Ee.resolve(o)}getOverlaysForCollectionGroup(e,s,r,o){let l=new pn(((y,x)=>y-x));const d=this.overlays.getIterator();for(;d.hasNext();){const y=d.getNext().value;if(y.getKey().getCollectionGroup()===s&&y.largestBatchId>r){let x=l.get(y.largestBatchId);x===null&&(x=eo(),l=l.insert(y.largestBatchId,x)),x.set(y.getKey(),y)}}const m=eo(),p=l.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((y,x)=>m.set(y,x))),!(m.size()>=o)););return Ee.resolve(m)}bt(e,s,r){const o=this.overlays.get(r.key);if(o!==null){const d=this.Lr.get(o.largestBatchId).delete(r.key);this.Lr.set(o.largestBatchId,d)}this.overlays=this.overlays.insert(r.key,new AO(s,r));let l=this.Lr.get(s);l===void 0&&(l=bt(),this.Lr.set(s,l)),this.Lr.set(s,l.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(){this.sessionToken=qn.EMPTY_BYTE_STRING}getSessionToken(e){return Ee.resolve(this.sessionToken)}setSessionToken(e,s){return this.sessionToken=s,Ee.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(){this.kr=new Rn(Dn.Kr),this.qr=new Rn(Dn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,s){const r=new Dn(e,s);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,s){e.forEach((r=>this.addReference(r,s)))}removeReference(e,s){this.Wr(new Dn(e,s))}Qr(e,s){e.forEach((r=>this.removeReference(r,s)))}Gr(e){const s=new qe(new Wt([])),r=new Dn(s,e),o=new Dn(s,e+1),l=[];return this.qr.forEachInRange([r,o],(d=>{this.Wr(d),l.push(d.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const s=new qe(new Wt([])),r=new Dn(s,e),o=new Dn(s,e+1);let l=bt();return this.qr.forEachInRange([r,o],(d=>{l=l.add(d.key)})),l}containsKey(e){const s=new Dn(e,0),r=this.kr.firstAfterOrEqual(s);return r!==null&&e.isEqual(r.key)}}class Dn{constructor(e,s){this.key=e,this.Hr=s}static Kr(e,s){return qe.comparator(e.key,s.key)||pt(e.Hr,s.Hr)}static Ur(e,s){return pt(e.Hr,s.Hr)||qe.comparator(e.key,s.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(e,s){this.indexManager=e,this.referenceDelegate=s,this.mutationQueue=[],this.Yn=1,this.Jr=new Rn(Dn.Kr)}checkEmpty(e){return Ee.resolve(this.mutationQueue.length===0)}addMutationBatch(e,s,r,o){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const d=new TO(l,s,r,o);this.mutationQueue.push(d);for(const m of o)this.Jr=this.Jr.add(new Dn(m.key,l)),this.indexManager.addToCollectionParentIndex(e,m.key.path.popLast());return Ee.resolve(d)}lookupMutationBatch(e,s){return Ee.resolve(this.Zr(s))}getNextMutationBatchAfterBatchId(e,s){const r=s+1,o=this.Xr(r),l=o<0?0:o;return Ee.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return Ee.resolve(this.mutationQueue.length===0?PR:this.Yn-1)}getAllMutationBatches(e){return Ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,s){const r=new Dn(s,0),o=new Dn(s,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([r,o],(d=>{const m=this.Zr(d.Hr);l.push(m)})),Ee.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,s){let r=new Rn(pt);return s.forEach((o=>{const l=new Dn(o,0),d=new Dn(o,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,d],(m=>{r=r.add(m.Hr)}))})),Ee.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,s){const r=s.path,o=r.length+1;let l=r;qe.isDocumentKey(l)||(l=l.child(""));const d=new Dn(new qe(l),0);let m=new Rn(pt);return this.Jr.forEachWhile((p=>{const y=p.key.path;return!!r.isPrefixOf(y)&&(y.length===o&&(m=m.add(p.Hr)),!0)}),d),Ee.resolve(this.Yr(m))}Yr(e){const s=[];return e.forEach((r=>{const o=this.Zr(r);o!==null&&s.push(o)})),s}removeMutationBatch(e,s){Zt(this.ei(s.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return Ee.forEach(s.mutations,(o=>{const l=new Dn(o.key,s.batchId);return r=r.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,o.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,s){const r=new Dn(s,0),o=this.Jr.firstAfterOrEqual(r);return Ee.resolve(s.isEqual(o&&o.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ee.resolve()}ei(e,s){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const s=this.Xr(e);return s<0||s>=this.mutationQueue.length?null:this.mutationQueue[s]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e){this.ti=e,this.docs=(function(){return new pn(qe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,s){const r=s.key,o=this.docs.get(r),l=o?o.size:0,d=this.ti(s);return this.docs=this.docs.insert(r,{document:s.mutableCopy(),size:d}),this.size+=d-l,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const s=this.docs.get(e);s&&(this.docs=this.docs.remove(e),this.size-=s.size)}getEntry(e,s){const r=this.docs.get(s);return Ee.resolve(r?r.document.mutableCopy():Xn.newInvalidDocument(s))}getEntries(e,s){let r=xi();return s.forEach((o=>{const l=this.docs.get(o);r=r.insert(o,l?l.document.mutableCopy():Xn.newInvalidDocument(o))})),Ee.resolve(r)}getDocumentsMatchingQuery(e,s,r,o){let l=xi();const d=s.path,m=new qe(d.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(m);for(;p.hasNext();){const{key:y,value:{document:x}}=p.getNext();if(!d.isPrefixOf(y.path))break;y.path.length>d.length+1||LR(kR(x),r)<=0||(o.has(x.key)||Pf(s,x))&&(l=l.insert(x.key,x.mutableCopy()))}return Ee.resolve(l)}getAllFromCollectionGroup(e,s,r,o){tt(9500)}ni(e,s){return Ee.forEach(this.docs,(r=>s(r)))}newChangeBuffer(e){return new uj(this)}getSize(e){return Ee.resolve(this.size)}}class uj extends nj{constructor(e){super(),this.Mr=e}applyChanges(e){const s=[];return this.changes.forEach(((r,o)=>{o.isValidDocument()?s.push(this.Mr.addEntry(e,o)):this.Mr.removeEntry(r)})),Ee.waitFor(s)}getFromCache(e,s){return this.Mr.getEntry(e,s)}getAllFromCache(e,s){return this.Mr.getEntries(e,s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(e){this.persistence=e,this.ri=new yo((s=>a0(s)),r0),this.lastRemoteSnapshotVersion=Je.min(),this.highestTargetId=0,this.ii=0,this.si=new u0,this.targetCount=0,this.oi=Rl._r()}forEachTarget(e,s){return this.ri.forEach(((r,o)=>s(o))),Ee.resolve()}getLastRemoteSnapshotVersion(e){return Ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ee.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),Ee.resolve(this.highestTargetId)}setTargetsMetadata(e,s,r){return r&&(this.lastRemoteSnapshotVersion=r),s>this.ii&&(this.ii=s),Ee.resolve()}lr(e){this.ri.set(e.target,e);const s=e.targetId;s>this.highestTargetId&&(this.oi=new Rl(s),this.highestTargetId=s),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,s){return this.lr(s),this.targetCount+=1,Ee.resolve()}updateTargetData(e,s){return this.lr(s),Ee.resolve()}removeTargetData(e,s){return this.ri.delete(s.target),this.si.Gr(s.targetId),this.targetCount-=1,Ee.resolve()}removeTargets(e,s,r){let o=0;const l=[];return this.ri.forEach(((d,m)=>{m.sequenceNumber<=s&&r.get(m.targetId)===null&&(this.ri.delete(d),l.push(this.removeMatchingKeysForTargetId(e,m.targetId)),o++)})),Ee.waitFor(l).next((()=>o))}getTargetCount(e){return Ee.resolve(this.targetCount)}getTargetData(e,s){const r=this.ri.get(s)||null;return Ee.resolve(r)}addMatchingKeys(e,s,r){return this.si.$r(s,r),Ee.resolve()}removeMatchingKeys(e,s,r){this.si.Qr(s,r);const o=this.persistence.referenceDelegate,l=[];return o&&s.forEach((d=>{l.push(o.markPotentiallyOrphaned(e,d))})),Ee.waitFor(l)}removeMatchingKeysForTargetId(e,s){return this.si.Gr(s),Ee.resolve()}getMatchingKeysForTargetId(e,s){const r=this.si.jr(s);return Ee.resolve(r)}containsKey(e,s){return Ee.resolve(this.si.containsKey(s))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e,s){this._i={},this.overlays={},this.ai=new kf(0),this.ui=!1,this.ui=!0,this.ci=new oj,this.referenceDelegate=e(this),this.li=new dj(this),this.indexManager=new WO,this.remoteDocumentCache=(function(o){return new cj(o)})((r=>this.referenceDelegate.hi(r))),this.serializer=new YO(s),this.Pi=new rj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let s=this.overlays[e.toKey()];return s||(s=new ij,this.overlays[e.toKey()]=s),s}getMutationQueue(e,s){let r=this._i[e.toKey()];return r||(r=new lj(s,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,s,r){ke("MemoryPersistence","Starting transaction:",e);const o=new fj(this.ai.next());return this.referenceDelegate.Ti(),r(o).next((l=>this.referenceDelegate.Ii(o).next((()=>l)))).toPromise().then((l=>(o.raiseOnCommittedEvent(),l)))}Ei(e,s){return Ee.or(Object.values(this._i).map((r=>()=>r.containsKey(e,s))))}}class fj extends DR{constructor(e){super(),this.currentSequenceNumber=e}}class d0{constructor(e){this.persistence=e,this.Ri=new u0,this.Ai=null}static Vi(e){return new d0(e)}get di(){if(this.Ai)return this.Ai;throw tt(60996)}addReference(e,s,r){return this.Ri.addReference(r,s),this.di.delete(r.toString()),Ee.resolve()}removeReference(e,s,r){return this.Ri.removeReference(r,s),this.di.add(r.toString()),Ee.resolve()}markPotentiallyOrphaned(e,s){return this.di.add(s.toString()),Ee.resolve()}removeTarget(e,s){this.Ri.Gr(s.targetId).forEach((o=>this.di.add(o.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,s.targetId).next((o=>{o.forEach((l=>this.di.add(l.toString())))})).next((()=>r.removeTargetData(e,s)))}Ti(){this.Ai=new Set}Ii(e){const s=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ee.forEach(this.di,(r=>{const o=qe.fromPath(r);return this.mi(e,o).next((l=>{l||s.removeEntry(o,Je.min())}))})).next((()=>(this.Ai=null,s.apply(e))))}updateLimboDocument(e,s){return this.mi(e,s).next((r=>{r?this.di.delete(s.toString()):this.di.add(s.toString())}))}hi(e){return 0}mi(e,s){return Ee.or([()=>Ee.resolve(this.Ri.containsKey(s)),()=>this.persistence.getTargetCache().containsKey(e,s),()=>this.persistence.Ei(e,s)])}}class xf{constructor(e,s){this.persistence=e,this.fi=new yo((r=>VR(r.path)),((r,o)=>r.isEqual(o))),this.garbageCollector=tj(this,s)}static Vi(e,s){return new xf(e,s)}Ti(){}Ii(e){return Ee.resolve()}forEachTarget(e,s){return this.persistence.getTargetCache().forEachTarget(e,s)}dr(e){const s=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>s.next((o=>r+o))))}pr(e){let s=0;return this.mr(e,(r=>{s++})).next((()=>s))}mr(e,s){return Ee.forEach(this.fi,((r,o)=>this.wr(e,r,o).next((l=>l?Ee.resolve():s(o)))))}removeTargets(e,s,r){return this.persistence.getTargetCache().removeTargets(e,s,r)}removeOrphanedDocuments(e,s){let r=0;const o=this.persistence.getRemoteDocumentCache(),l=o.newChangeBuffer();return o.ni(e,(d=>this.wr(e,d,s).next((m=>{m||(r++,l.removeEntry(d,Je.min()))})))).next((()=>l.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,s){return this.fi.set(s,e.currentSequenceNumber),Ee.resolve()}removeTarget(e,s){const r=s.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,s,r){return this.fi.set(r,e.currentSequenceNumber),Ee.resolve()}removeReference(e,s,r){return this.fi.set(r,e.currentSequenceNumber),Ee.resolve()}updateLimboDocument(e,s){return this.fi.set(s,e.currentSequenceNumber),Ee.resolve()}hi(e){let s=e.key.toString().length;return e.isFoundDocument()&&(s+=ef(e.data.value)),s}wr(e,s,r){return Ee.or([()=>this.persistence.Ei(e,s),()=>this.persistence.getTargetCache().containsKey(e,s),()=>{const o=this.fi.get(s);return Ee.resolve(o!==void 0&&o>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e,s,r,o){this.targetId=e,this.fromCache=s,this.Ts=r,this.Is=o}static Es(e,s){let r=bt(),o=bt();for(const l of s.docChanges)switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:o=o.add(l.doc.key)}return new f0(e,s.fromCache,r,o)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pj{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return ZN()?8:UR(WN())>0?6:4})()}initialize(e,s){this.fs=e,this.indexManager=s,this.Rs=!0}getDocumentsMatchingQuery(e,s,r,o){const l={result:null};return this.gs(e,s).next((d=>{l.result=d})).next((()=>{if(!l.result)return this.ps(e,s,o,r).next((d=>{l.result=d}))})).next((()=>{if(l.result)return;const d=new hj;return this.ys(e,s,d).next((m=>{if(l.result=m,this.As)return this.ws(e,s,d,m.size)}))})).next((()=>l.result))}ws(e,s,r,o){return r.documentReadCount<this.Vs?(ol()<=gt.DEBUG&&ke("QueryEngine","SDK will not create cache indexes for query:",ll(s),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ee.resolve()):(ol()<=gt.DEBUG&&ke("QueryEngine","Query:",ll(s),"scans",r.documentReadCount,"local documents and returns",o,"documents as results."),r.documentReadCount>this.ds*o?(ol()<=gt.DEBUG&&ke("QueryEngine","The SDK decides to create cache indexes for query:",ll(s),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qa(s))):Ee.resolve())}gs(e,s){if(Kv(s))return Ee.resolve(null);let r=Qa(s);return this.indexManager.getIndexType(e,r).next((o=>o===0?null:(s.limit!==null&&o===1&&(s=lg(s,null,"F"),r=Qa(s)),this.indexManager.getDocumentsMatchingTarget(e,r).next((l=>{const d=bt(...l);return this.fs.getDocuments(e,d).next((m=>this.indexManager.getMinOffset(e,r).next((p=>{const y=this.bs(s,m);return this.Ss(s,y,d,p.readTime)?this.gs(e,lg(s,null,"F")):this.Ds(e,y,s,p)}))))})))))}ps(e,s,r,o){return Kv(s)||o.isEqual(Je.min())?Ee.resolve(null):this.fs.getDocuments(e,r).next((l=>{const d=this.bs(s,l);return this.Ss(s,d,r,o)?Ee.resolve(null):(ol()<=gt.DEBUG&&ke("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),ll(s)),this.Ds(e,d,s,jR(o,au)).next((m=>m)))}))}bs(e,s){let r=new Rn(kS(e));return s.forEach(((o,l)=>{Pf(e,l)&&(r=r.add(l))})),r}Ss(e,s,r,o){if(e.limit===null)return!1;if(r.size!==s.size)return!0;const l=e.limitType==="F"?s.last():s.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(o)>0)}ys(e,s,r){return ol()<=gt.DEBUG&&ke("QueryEngine","Using full collection scan to execute query:",ll(s)),this.fs.getDocumentsMatchingQuery(e,s,pi.min(),r)}Ds(e,s,r,o){return this.fs.getDocumentsMatchingQuery(e,r,o).next((l=>(s.forEach((d=>{l=l.insert(d.key,d)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h0="LocalStore",mj=3e8;class gj{constructor(e,s,r,o){this.persistence=e,this.Cs=s,this.serializer=o,this.vs=new pn(pt),this.Fs=new yo((l=>a0(l)),r0),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new aj(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(s=>e.collect(s,this.vs)))}}function yj(n,e,s,r){return new gj(n,e,s,r)}async function XS(n,e){const s=yt(n);return await s.persistence.runTransaction("Handle user change","readonly",(r=>{let o;return s.mutationQueue.getAllMutationBatches(r).next((l=>(o=l,s.Os(e),s.mutationQueue.getAllMutationBatches(r)))).next((l=>{const d=[],m=[];let p=bt();for(const y of o){d.push(y.batchId);for(const x of y.mutations)p=p.add(x.key)}for(const y of l){m.push(y.batchId);for(const x of y.mutations)p=p.add(x.key)}return s.localDocuments.getDocuments(r,p).next((y=>({Ns:y,removedBatchIds:d,addedBatchIds:m})))}))}))}function JS(n){const e=yt(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(s=>e.li.getLastRemoteSnapshotVersion(s)))}function xj(n,e){const s=yt(n),r=e.snapshotVersion;let o=s.vs;return s.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const d=s.xs.newChangeBuffer({trackRemovals:!0});o=s.vs;const m=[];e.targetChanges.forEach(((x,v)=>{const S=o.get(v);if(!S)return;m.push(s.li.removeMatchingKeys(l,x.removedDocuments,v).next((()=>s.li.addMatchingKeys(l,x.addedDocuments,v))));let N=S.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?N=N.withResumeToken(qn.EMPTY_BYTE_STRING,Je.min()).withLastLimboFreeSnapshotVersion(Je.min()):x.resumeToken.approximateByteSize()>0&&(N=N.withResumeToken(x.resumeToken,r)),o=o.insert(v,N),(function(M,j,V){return M.resumeToken.approximateByteSize()===0||j.snapshotVersion.toMicroseconds()-M.snapshotVersion.toMicroseconds()>=mj?!0:V.addedDocuments.size+V.modifiedDocuments.size+V.removedDocuments.size>0})(S,N,x)&&m.push(s.li.updateTargetData(l,N))}));let p=xi(),y=bt();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&m.push(s.persistence.referenceDelegate.updateLimboDocument(l,x))})),m.push(bj(l,d,e.documentUpdates).next((x=>{p=x.Bs,y=x.Ls}))),!r.isEqual(Je.min())){const x=s.li.getLastRemoteSnapshotVersion(l).next((v=>s.li.setTargetsMetadata(l,l.currentSequenceNumber,r)));m.push(x)}return Ee.waitFor(m).next((()=>d.apply(l))).next((()=>s.localDocuments.getLocalViewOfDocuments(l,p,y))).next((()=>p))})).then((l=>(s.vs=o,l)))}function bj(n,e,s){let r=bt(),o=bt();return s.forEach((l=>r=r.add(l))),e.getEntries(n,r).next((l=>{let d=xi();return s.forEach(((m,p)=>{const y=l.get(m);p.isFoundDocument()!==y.isFoundDocument()&&(o=o.add(m)),p.isNoDocument()&&p.version.isEqual(Je.min())?(e.removeEntry(m,p.readTime),d=d.insert(m,p)):!y.isValidDocument()||p.version.compareTo(y.version)>0||p.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(p),d=d.insert(m,p)):ke(h0,"Ignoring outdated watch update for ",m,". Current version:",y.version," Watch version:",p.version)})),{Bs:d,Ls:o}}))}function vj(n,e){const s=yt(n);return s.persistence.runTransaction("Allocate target","readwrite",(r=>{let o;return s.li.getTargetData(r,e).next((l=>l?(o=l,Ee.resolve(o)):s.li.allocateTargetId(r).next((d=>(o=new ai(e,d,"TargetPurposeListen",r.currentSequenceNumber),s.li.addTargetData(r,o).next((()=>o)))))))})).then((r=>{const o=s.vs.get(r.targetId);return(o===null||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(s.vs=s.vs.insert(r.targetId,r),s.Fs.set(e,r.targetId)),r}))}async function hg(n,e,s){const r=yt(n),o=r.vs.get(e),l=s?"readwrite":"readwrite-primary";try{s||await r.persistence.runTransaction("Release target",l,(d=>r.persistence.referenceDelegate.removeTarget(d,o)))}catch(d){if(!Ml(d))throw d;ke(h0,`Failed to update sequence numbers for target ${e}: ${d}`)}r.vs=r.vs.remove(e),r.Fs.delete(o.target)}function c1(n,e,s){const r=yt(n);let o=Je.min(),l=bt();return r.persistence.runTransaction("Execute query","readwrite",(d=>(function(p,y,x){const v=yt(p),S=v.Fs.get(x);return S!==void 0?Ee.resolve(v.vs.get(S)):v.li.getTargetData(y,x)})(r,d,Qa(e)).next((m=>{if(m)return o=m.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(d,m.targetId).next((p=>{l=p}))})).next((()=>r.Cs.getDocumentsMatchingQuery(d,e,s?o:Je.min(),s?l:bt()))).next((m=>(_j(r,uO(e),m),{documents:m,ks:l})))))}function _j(n,e,s){let r=n.Ms.get(e)||Je.min();s.forEach(((o,l)=>{l.readTime.compareTo(r)>0&&(r=l.readTime)})),n.Ms.set(e,r)}class u1{constructor(){this.activeTargetIds=gO()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ej{constructor(){this.vo=new u1,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,s,r){}addLocalQueryTarget(e,s=!0){return s&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,s,r){this.Fo[e]=s}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new u1,Promise.resolve()}handleUserChange(e,s,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d1="ConnectivityMonitor";class f1{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){ke(d1,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){ke(d1,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fd=null;function pg(){return Fd===null?Fd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Fd++,"0x"+Fd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const im="RestConnection",Sj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class Tj{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const s=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.qo=s+"://"+e.host,this.Uo=`projects/${r}/databases/${o}`,this.$o=this.databaseId.database===hf?`project_id=${r}`:`project_id=${r}&database_id=${o}`}Wo(e,s,r,o,l){const d=pg(),m=this.Qo(e,s.toUriEncodedString());ke(im,`Sending RPC '${e}' ${d}:`,m,r);const p={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(p,o,l);const{host:y}=new URL(m),x=Xg(y);return this.zo(e,m,p,r,x).then((v=>(ke(im,`Received RPC '${e}' ${d}: `,v),v)),(v=>{throw po(im,`RPC '${e}' ${d} failed with error: `,v,"url: ",m,"request:",r),v}))}jo(e,s,r,o,l,d){return this.Wo(e,s,r,o,l)}Go(e,s,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ll})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach(((o,l)=>e[l]=o)),r&&r.headers.forEach(((o,l)=>e[l]=o))}Qo(e,s){const r=Sj[e];let o=`${this.qo}/v1/${s}:${r}`;return this.databaseInfo.apiKey&&(o=`${o}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),o}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn="WebChannelConnection",Rc=(n,e,s)=>{n.listen(e,(r=>{try{s(r)}catch(o){setTimeout((()=>{throw o}),0)}}))};class vl extends Tj{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!vl.c_){const e=gS();Rc(e,mS.STAT_EVENT,(s=>{s.stat===Jm.PROXY?ke(Wn,"STAT_EVENT: detected buffering proxy"):s.stat===Jm.NOPROXY&&ke(Wn,"STAT_EVENT: detected no buffering proxy")})),vl.c_=!0}}zo(e,s,r,o,l){const d=pg();return new Promise(((m,p)=>{const y=new hS;y.setWithCredentials(!0),y.listenOnce(pS.COMPLETE,(()=>{try{switch(y.getLastErrorCode()){case Jd.NO_ERROR:const v=y.getResponseJson();ke(Wn,`XHR for RPC '${e}' ${d} received:`,JSON.stringify(v)),m(v);break;case Jd.TIMEOUT:ke(Wn,`RPC '${e}' ${d} timed out`),p(new Ve(Ce.DEADLINE_EXCEEDED,"Request time out"));break;case Jd.HTTP_ERROR:const S=y.getStatus();if(ke(Wn,`RPC '${e}' ${d} failed with status:`,S,"response text:",y.getResponseText()),S>0){let N=y.getResponseJson();Array.isArray(N)&&(N=N[0]);const P=N==null?void 0:N.error;if(P&&P.status&&P.message){const M=(function(V){const B=V.toLowerCase().replace(/_/g,"-");return Object.values(Ce).indexOf(B)>=0?B:Ce.UNKNOWN})(P.status);p(new Ve(M,P.message))}else p(new Ve(Ce.UNKNOWN,"Server responded with status "+y.getStatus()))}else p(new Ve(Ce.UNAVAILABLE,"Connection failed."));break;default:tt(9055,{l_:e,streamId:d,h_:y.getLastErrorCode(),P_:y.getLastError()})}}finally{ke(Wn,`RPC '${e}' ${d} completed.`)}}));const x=JSON.stringify(o);ke(Wn,`RPC '${e}' ${d} sending request:`,o),y.send(s,"POST",x,r,15)}))}T_(e,s,r){const o=pg(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],d=this.createWebChannelTransport(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(m.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(m.useFetchStreams=!0),this.Go(m.initMessageHeaders,s,r),m.encodeInitMessageHeaders=!0;const y=l.join("");ke(Wn,`Creating RPC '${e}' stream ${o}: ${y}`,m);const x=d.createWebChannel(y,m);this.I_(x);let v=!1,S=!1;const N=new Aj({Ho:P=>{S?ke(Wn,`Not sending because RPC '${e}' stream ${o} is closed:`,P):(v||(ke(Wn,`Opening RPC '${e}' stream ${o} transport.`),x.open(),v=!0),ke(Wn,`RPC '${e}' stream ${o} sending:`,P),x.send(P))},Jo:()=>x.close()});return Rc(x,kc.EventType.OPEN,(()=>{S||(ke(Wn,`RPC '${e}' stream ${o} transport opened.`),N.i_())})),Rc(x,kc.EventType.CLOSE,(()=>{S||(S=!0,ke(Wn,`RPC '${e}' stream ${o} transport closed`),N.o_(),this.E_(x))})),Rc(x,kc.EventType.ERROR,(P=>{S||(S=!0,po(Wn,`RPC '${e}' stream ${o} transport errored. Name:`,P.name,"Message:",P.message),N.o_(new Ve(Ce.UNAVAILABLE,"The operation could not be completed")))})),Rc(x,kc.EventType.MESSAGE,(P=>{var M;if(!S){const j=P.data[0];Zt(!!j,16349);const V=j,B=(V==null?void 0:V.error)||((M=V[0])==null?void 0:M.error);if(B){ke(Wn,`RPC '${e}' stream ${o} received error:`,B);const H=B.status;let G=(function(I){const A=_n[I];if(A!==void 0)return BS(A)})(H),Y=B.message;H==="NOT_FOUND"&&Y.includes("database")&&Y.includes("does not exist")&&Y.includes(this.databaseId.database)&&po(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),G===void 0&&(G=Ce.INTERNAL,Y="Unknown error status: "+H+" with message "+B.message),S=!0,N.o_(new Ve(G,Y)),x.close()}else ke(Wn,`RPC '${e}' stream ${o} received:`,j),N.__(j)}})),vl.u_(),setTimeout((()=>{N.s_()}),0),N}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((s=>s===e))}Go(e,s,r){super.Go(e,s,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return yS()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ij(n){return new vl(n)}function om(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(n){return new LO(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vl.c_=!1;class tT{constructor(e,s,r=1e3,o=1.5,l=6e4){this.Ci=e,this.timerId=s,this.R_=r,this.A_=o,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const s=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),o=Math.max(0,s-r);o>0&&ke("ExponentialBackoff",`Backing off for ${o} ms (base delay: ${this.d_} ms, delay with jitter: ${s} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,o,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1="PersistentStream";class Nj{constructor(e,s,r,o,l,d,m,p){this.Ci=e,this.b_=r,this.S_=o,this.connection=l,this.authCredentialsProvider=d,this.appCheckCredentialsProvider=m,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new tT(e,s)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,s){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():s&&s.code===Ce.RESOURCE_EXHAUSTED?(Sr(s.toString()),Sr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):s&&s.code===Ce.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(s)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),s=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,o])=>{this.D_===s&&this.G_(r,o)}),(r=>{e((()=>{const o=new Ve(Ce.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(o)}))}))}G_(e,s){const r=this.Q_(this.D_);this.stream=this.j_(e,s),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((o=>{r((()=>this.z_(o)))})),this.stream.onMessage((o=>{r((()=>++this.F_==1?this.H_(o):this.onNext(o)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ke(h1,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return s=>{this.Ci.enqueueAndForget((()=>this.D_===e?s():(ke(h1,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Cj extends Nj{constructor(e,s,r,o,l,d){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",s,r,o,d),this.serializer=l}j_(e,s){return this.connection.T_("Listen",e,s)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const s=VO(this.serializer,e),r=(function(l){if(!("targetChange"in l))return Je.min();const d=l.targetChange;return d.targetIds&&d.targetIds.length?Je.min():d.readTime?bl(d.readTime):Je.min()})(e);return this.listener.J_(s,r)}Z_(e){const s={};s.database=r1(this.serializer),s.addTarget=(function(l,d){let m;const p=d.target;if(m=og(p)?{documents:zO(l,p)}:{query:BO(l,p).ft},m.targetId=d.targetId,d.resumeToken.approximateByteSize()>0){m.resumeToken=DO(l,d.resumeToken);const y=dg(l,d.expectedCount);y!==null&&(m.expectedCount=y)}else if(d.snapshotVersion.compareTo(Je.min())>0){m.readTime=MO(l,d.snapshotVersion.toTimestamp());const y=dg(l,d.expectedCount);y!==null&&(m.expectedCount=y)}return m})(this.serializer,e);const r=HO(this.serializer,e);r&&(s.labels=r),this.K_(s)}X_(e){const s={};s.database=r1(this.serializer),s.removeTarget=e,this.K_(s)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{}class Oj extends Rj{constructor(e,s,r,o){super(),this.authCredentials=e,this.appCheckCredentials=s,this.connection=r,this.serializer=o,this.ia=!1}sa(){if(this.ia)throw new Ve(Ce.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,s,r,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Wo(e,fg(s,r),o,l,d))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Ve(Ce.UNKNOWN,l.toString())}))}jo(e,s,r,o,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([d,m])=>this.connection.jo(e,fg(s,r),o,d,m,l))).catch((d=>{throw d.name==="FirebaseError"?(d.code===Ce.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new Ve(Ce.UNKNOWN,d.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function jj(n,e,s,r){return new Oj(n,e,s,r)}class kj{constructor(e,s){this.asyncQueue=e,this.onlineStateHandler=s,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const s=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Sr(s),this.aa=!1):ke("OnlineStateTracker",s)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ol="RemoteStore";class Lj{constructor(e,s,r,o,l){this.localStore=e,this.datastore=s,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((d=>{r.enqueueAndForget((async()=>{xu(this)&&(ke(Ol,"Restarting streams for network reachability change."),await(async function(p){const y=yt(p);y.Ea.add(4),await yu(y),y.Va.set("Unknown"),y.Ea.delete(4),await Ff(y)})(this))}))})),this.Va=new kj(r,o)}}async function Ff(n){if(xu(n))for(const e of n.Ra)await e(!0)}async function yu(n){for(const e of n.Ra)await e(!1)}function nT(n,e){const s=yt(n);s.Ia.has(e.targetId)||(s.Ia.set(e.targetId,e),y0(s)?g0(s):Dl(s).O_()&&m0(s,e))}function p0(n,e){const s=yt(n),r=Dl(s);s.Ia.delete(e),r.O_()&&sT(s,e),s.Ia.size===0&&(r.O_()?r.L_():xu(s)&&s.Va.set("Unknown"))}function m0(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Je.min())>0){const s=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(s)}Dl(n).Z_(e)}function sT(n,e){n.da.$e(e),Dl(n).X_(e)}function g0(n){n.da=new RO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Dl(n).start(),n.Va.ua()}function y0(n){return xu(n)&&!Dl(n).x_()&&n.Ia.size>0}function xu(n){return yt(n).Ea.size===0}function aT(n){n.da=void 0}async function Mj(n){n.Va.set("Online")}async function Dj(n){n.Ia.forEach(((e,s)=>{m0(n,e)}))}async function Uj(n,e){aT(n),y0(n)?(n.Va.ha(e),g0(n)):n.Va.set("Unknown")}async function Pj(n,e,s){if(n.Va.set("Online"),e instanceof HS&&e.state===2&&e.cause)try{await(async function(o,l){const d=l.cause;for(const m of l.targetIds)o.Ia.has(m)&&(await o.remoteSyncer.rejectListen(m,d),o.Ia.delete(m),o.da.removeTarget(m))})(n,e)}catch(r){ke(Ol,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await p1(n,r)}else if(e instanceof nf?n.da.Xe(e):e instanceof FS?n.da.st(e):n.da.tt(e),!s.isEqual(Je.min()))try{const r=await JS(n.localStore);s.compareTo(r)>=0&&await(function(l,d){const m=l.da.Tt(d);return m.targetChanges.forEach(((p,y)=>{if(p.resumeToken.approximateByteSize()>0){const x=l.Ia.get(y);x&&l.Ia.set(y,x.withResumeToken(p.resumeToken,d))}})),m.targetMismatches.forEach(((p,y)=>{const x=l.Ia.get(p);if(!x)return;l.Ia.set(p,x.withResumeToken(qn.EMPTY_BYTE_STRING,x.snapshotVersion)),sT(l,p);const v=new ai(x.target,p,y,x.sequenceNumber);m0(l,v)})),l.remoteSyncer.applyRemoteEvent(m)})(n,s)}catch(r){ke(Ol,"Failed to raise snapshot:",r),await p1(n,r)}}async function p1(n,e,s){if(!Ml(e))throw e;n.Ea.add(1),await yu(n),n.Va.set("Offline"),s||(s=()=>JS(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ke(Ol,"Retrying IndexedDB access"),await s(),n.Ea.delete(1),await Ff(n)}))}async function m1(n,e){const s=yt(n);s.asyncQueue.verifyOperationInProgress(),ke(Ol,"RemoteStore received new credentials");const r=xu(s);s.Ea.add(3),await yu(s),r&&s.Va.set("Unknown"),await s.remoteSyncer.handleCredentialChange(e),s.Ea.delete(3),await Ff(s)}async function Vj(n,e){const s=yt(n);e?(s.Ea.delete(2),await Ff(s)):e||(s.Ea.add(2),await yu(s),s.Va.set("Unknown"))}function Dl(n){return n.ma||(n.ma=(function(s,r,o){const l=yt(s);return l.sa(),new Cj(r,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,o)})(n.datastore,n.asyncQueue,{Zo:Mj.bind(null,n),Yo:Dj.bind(null,n),t_:Uj.bind(null,n),J_:Pj.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),y0(n)?g0(n):n.Va.set("Unknown")):(await n.ma.stop(),aT(n))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e,s,r,o,l){this.asyncQueue=e,this.timerId=s,this.targetTimeMs=r,this.op=o,this.removalCallback=l,this.deferred=new to,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((d=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,s,r,o,l){const d=Date.now()+r,m=new x0(e,s,d,o,l);return m.start(r),m}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ve(Ce.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function rT(n,e){if(Sr("AsyncQueue",`${e}: ${n}`),Ml(n))return new Ve(Ce.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{static emptySet(e){return new _l(e.comparator)}constructor(e){this.comparator=e?(s,r)=>e(s,r)||qe.comparator(s.key,r.key):(s,r)=>qe.comparator(s.key,r.key),this.keyedMap=Lc(),this.sortedSet=new pn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const s=this.keyedMap.get(e);return s?this.sortedSet.indexOf(s):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((s,r)=>(e(s),!1)))}add(e){const s=this.delete(e.key);return s.copy(s.keyedMap.insert(e.key,e),s.sortedSet.insert(e,null))}delete(e){const s=this.get(e);return s?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(s)):this}isEqual(e){if(!(e instanceof _l)||this.size!==e.size)return!1;const s=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;s.hasNext();){const o=s.getNext().key,l=r.getNext().key;if(!o.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((s=>{e.push(s.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,s){const r=new _l;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=s,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g1{constructor(){this.ga=new pn(qe.comparator)}track(e){const s=e.doc.key,r=this.ga.get(s);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(s,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(s,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(s,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(s,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(s):e.type===1&&r.type===2?this.ga=this.ga.insert(s,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(s,{type:2,doc:e.doc}):tt(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(s,e)}ya(){const e=[];return this.ga.inorderTraversal(((s,r)=>{e.push(r)})),e}}class jl{constructor(e,s,r,o,l,d,m,p,y){this.query=e,this.docs=s,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=l,this.fromCache=d,this.syncStateChanged=m,this.excludesMetadataChanges=p,this.hasCachedResults=y}static fromInitialDocuments(e,s,r,o,l){const d=[];return s.forEach((m=>{d.push({type:0,doc:m})})),new jl(e,s,_l.emptySet(s),d,r,o,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const s=this.docChanges,r=e.docChanges;if(s.length!==r.length)return!1;for(let o=0;o<s.length;o++)if(s[o].type!==r[o].type||!s[o].doc.isEqual(r[o].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zj{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class Bj{constructor(){this.queries=y1(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(s,r){const o=yt(s),l=o.queries;o.queries=y1(),l.forEach(((d,m)=>{for(const p of m.ba)p.onError(r)}))})(this,new Ve(Ce.ABORTED,"Firestore shutting down"))}}function y1(){return new yo((n=>jS(n)),Uf)}async function Fj(n,e){const s=yt(n);let r=3;const o=e.query;let l=s.queries.get(o);l?!l.Sa()&&e.Da()&&(r=2):(l=new zj,r=e.Da()?0:1);try{switch(r){case 0:l.wa=await s.onListen(o,!0);break;case 1:l.wa=await s.onListen(o,!1);break;case 2:await s.onFirstRemoteStoreListen(o)}}catch(d){const m=rT(d,`Initialization of query '${ll(e.query)}' failed`);return void e.onError(m)}s.queries.set(o,l),l.ba.push(e),e.va(s.onlineState),l.wa&&e.Fa(l.wa)&&b0(s)}async function Hj(n,e){const s=yt(n),r=e.query;let o=3;const l=s.queries.get(r);if(l){const d=l.ba.indexOf(e);d>=0&&(l.ba.splice(d,1),l.ba.length===0?o=e.Da()?0:1:!l.Sa()&&e.Da()&&(o=2))}switch(o){case 0:return s.queries.delete(r),s.onUnlisten(r,!0);case 1:return s.queries.delete(r),s.onUnlisten(r,!1);case 2:return s.onLastRemoteStoreUnlisten(r);default:return}}function Gj(n,e){const s=yt(n);let r=!1;for(const o of e){const l=o.query,d=s.queries.get(l);if(d){for(const m of d.ba)m.Fa(o)&&(r=!0);d.wa=o}}r&&b0(s)}function qj(n,e,s){const r=yt(n),o=r.queries.get(e);if(o)for(const l of o.ba)l.onError(s);r.queries.delete(e)}function b0(n){n.Ca.forEach((e=>{e.next()}))}var mg,x1;(x1=mg||(mg={})).Ma="default",x1.Cache="cache";class $j{constructor(e,s,r){this.query=e,this.xa=s,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const o of e.docChanges)o.type!==3&&r.push(o);e=new jl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let s=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),s=!0):this.La(e,this.onlineState)&&(this.ka(e),s=!0),this.Na=e,s}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let s=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),s=!0),s}La(e,s){if(!e.fromCache||!this.Da())return!0;const r=s!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||s==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const s=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!s)&&this.options.includeMetadataChanges===!0}ka(e){e=jl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==mg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(e){this.key=e}}class oT{constructor(e){this.key=e}}class Yj{constructor(e,s){this.query=e,this.Za=s,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=bt(),this.mutatedKeys=bt(),this.eu=kS(e),this.tu=new _l(this.eu)}get nu(){return this.Za}ru(e,s){const r=s?s.iu:new g1,o=s?s.tu:this.tu;let l=s?s.mutatedKeys:this.mutatedKeys,d=o,m=!1;const p=this.query.limitType==="F"&&o.size===this.query.limit?o.last():null,y=this.query.limitType==="L"&&o.size===this.query.limit?o.first():null;if(e.inorderTraversal(((x,v)=>{const S=o.get(x),N=Pf(this.query,v)?v:null,P=!!S&&this.mutatedKeys.has(S.key),M=!!N&&(N.hasLocalMutations||this.mutatedKeys.has(N.key)&&N.hasCommittedMutations);let j=!1;S&&N?S.data.isEqual(N.data)?P!==M&&(r.track({type:3,doc:N}),j=!0):this.su(S,N)||(r.track({type:2,doc:N}),j=!0,(p&&this.eu(N,p)>0||y&&this.eu(N,y)<0)&&(m=!0)):!S&&N?(r.track({type:0,doc:N}),j=!0):S&&!N&&(r.track({type:1,doc:S}),j=!0,(p||y)&&(m=!0)),j&&(N?(d=d.add(N),l=M?l.add(x):l.delete(x)):(d=d.delete(x),l=l.delete(x)))})),this.query.limit!==null)for(;d.size>this.query.limit;){const x=this.query.limitType==="F"?d.last():d.first();d=d.delete(x.key),l=l.delete(x.key),r.track({type:1,doc:x})}return{tu:d,iu:r,Ss:m,mutatedKeys:l}}su(e,s){return e.hasLocalMutations&&s.hasCommittedMutations&&!s.hasLocalMutations}applyChanges(e,s,r,o){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const d=e.iu.ya();d.sort(((x,v)=>(function(N,P){const M=j=>{switch(j){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return tt(20277,{Vt:j})}};return M(N)-M(P)})(x.type,v.type)||this.eu(x.doc,v.doc))),this.ou(r),o=o??!1;const m=s&&!o?this._u():[],p=this.Ya.size===0&&this.current&&!o?1:0,y=p!==this.Xa;return this.Xa=p,d.length!==0||y?{snapshot:new jl(this.query,e.tu,l,d,e.mutatedKeys,p===0,y,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:m}:{au:m}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new g1,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((s=>this.Za=this.Za.add(s))),e.modifiedDocuments.forEach((s=>{})),e.removedDocuments.forEach((s=>this.Za=this.Za.delete(s))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=bt(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const s=[];return e.forEach((r=>{this.Ya.has(r)||s.push(new oT(r))})),this.Ya.forEach((r=>{e.has(r)||s.push(new iT(r))})),s}cu(e){this.Za=e.ks,this.Ya=bt();const s=this.ru(e.documents);return this.applyChanges(s,!0)}lu(){return jl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const v0="SyncEngine";class Qj{constructor(e,s,r){this.query=e,this.targetId=s,this.view=r}}class Wj{constructor(e){this.key=e,this.hu=!1}}class Kj{constructor(e,s,r,o,l,d){this.localStore=e,this.remoteStore=s,this.eventManager=r,this.sharedClientState=o,this.currentUser=l,this.maxConcurrentLimboResolutions=d,this.Pu={},this.Tu=new yo((m=>jS(m)),Uf),this.Iu=new Map,this.Eu=new Set,this.Ru=new pn(qe.comparator),this.Au=new Map,this.Vu=new u0,this.du={},this.mu=new Map,this.fu=Rl.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function Zj(n,e,s=!0){const r=fT(n);let o;const l=r.Tu.get(e);return l?(r.sharedClientState.addLocalQueryTarget(l.targetId),o=l.view.lu()):o=await lT(r,e,s,!0),o}async function Xj(n,e){const s=fT(n);await lT(s,e,!0,!1)}async function lT(n,e,s,r){const o=await vj(n.localStore,Qa(e)),l=o.targetId,d=n.sharedClientState.addLocalQueryTarget(l,s);let m;return r&&(m=await Jj(n,e,l,d==="current",o.resumeToken)),n.isPrimaryClient&&s&&nT(n.remoteStore,o),m}async function Jj(n,e,s,r,o){n.pu=(v,S,N)=>(async function(M,j,V,B){let H=j.view.ru(V);H.Ss&&(H=await c1(M.localStore,j.query,!1).then((({documents:I})=>j.view.ru(I,H))));const G=B&&B.targetChanges.get(j.targetId),Y=B&&B.targetMismatches.get(j.targetId)!=null,K=j.view.applyChanges(H,M.isPrimaryClient,G,Y);return v1(M,j.targetId,K.au),K.snapshot})(n,v,S,N);const l=await c1(n.localStore,e,!0),d=new Yj(e,l.ks),m=d.ru(l.documents),p=gu.createSynthesizedTargetChangeForCurrentChange(s,r&&n.onlineState!=="Offline",o),y=d.applyChanges(m,n.isPrimaryClient,p);v1(n,s,y.au);const x=new Qj(e,s,d);return n.Tu.set(e,x),n.Iu.has(s)?n.Iu.get(s).push(e):n.Iu.set(s,[e]),y.snapshot}async function ek(n,e,s){const r=yt(n),o=r.Tu.get(e),l=r.Iu.get(o.targetId);if(l.length>1)return r.Iu.set(o.targetId,l.filter((d=>!Uf(d,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(o.targetId),r.sharedClientState.isActiveQueryTarget(o.targetId)||await hg(r.localStore,o.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(o.targetId),s&&p0(r.remoteStore,o.targetId),gg(r,o.targetId)})).catch(jf)):(gg(r,o.targetId),await hg(r.localStore,o.targetId,!0))}async function tk(n,e){const s=yt(n),r=s.Tu.get(e),o=s.Iu.get(r.targetId);s.isPrimaryClient&&o.length===1&&(s.sharedClientState.removeLocalQueryTarget(r.targetId),p0(s.remoteStore,r.targetId))}async function cT(n,e){const s=yt(n);try{const r=await xj(s.localStore,e);e.targetChanges.forEach(((o,l)=>{const d=s.Au.get(l);d&&(Zt(o.addedDocuments.size+o.modifiedDocuments.size+o.removedDocuments.size<=1,22616),o.addedDocuments.size>0?d.hu=!0:o.modifiedDocuments.size>0?Zt(d.hu,14607):o.removedDocuments.size>0&&(Zt(d.hu,42227),d.hu=!1))})),await dT(s,r,e)}catch(r){await jf(r)}}function b1(n,e,s){const r=yt(n);if(r.isPrimaryClient&&s===0||!r.isPrimaryClient&&s===1){const o=[];r.Tu.forEach(((l,d)=>{const m=d.view.va(e);m.snapshot&&o.push(m.snapshot)})),(function(d,m){const p=yt(d);p.onlineState=m;let y=!1;p.queries.forEach(((x,v)=>{for(const S of v.ba)S.va(m)&&(y=!0)})),y&&b0(p)})(r.eventManager,e),o.length&&r.Pu.J_(o),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function nk(n,e,s){const r=yt(n);r.sharedClientState.updateQueryState(e,"rejected",s);const o=r.Au.get(e),l=o&&o.key;if(l){let d=new pn(qe.comparator);d=d.insert(l,Xn.newNoDocument(l,Je.min()));const m=bt().add(l),p=new Bf(Je.min(),new Map,new pn(pt),d,m);await cT(r,p),r.Ru=r.Ru.remove(l),r.Au.delete(e),_0(r)}else await hg(r.localStore,e,!1).then((()=>gg(r,e,s))).catch(jf)}function gg(n,e,s=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Iu.get(e))n.Tu.delete(r),s&&n.Pu.yu(r,s);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((r=>{n.Vu.containsKey(r)||uT(n,r)}))}function uT(n,e){n.Eu.delete(e.path.canonicalString());const s=n.Ru.get(e);s!==null&&(p0(n.remoteStore,s),n.Ru=n.Ru.remove(e),n.Au.delete(s),_0(n))}function v1(n,e,s){for(const r of s)r instanceof iT?(n.Vu.addReference(r.key,e),sk(n,r)):r instanceof oT?(ke(v0,"Document no longer in limbo: "+r.key),n.Vu.removeReference(r.key,e),n.Vu.containsKey(r.key)||uT(n,r.key)):tt(19791,{wu:r})}function sk(n,e){const s=e.key,r=s.path.canonicalString();n.Ru.get(s)||n.Eu.has(r)||(ke(v0,"New document in limbo: "+s),n.Eu.add(r),_0(n))}function _0(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const s=new qe(Wt.fromString(e)),r=n.fu.next();n.Au.set(r,new Wj(s)),n.Ru=n.Ru.insert(s,r),nT(n.remoteStore,new ai(Qa(i0(s.path)),r,"TargetPurposeLimboResolution",kf.ce))}}async function dT(n,e,s){const r=yt(n),o=[],l=[],d=[];r.Tu.isEmpty()||(r.Tu.forEach(((m,p)=>{d.push(r.pu(p,e,s).then((y=>{var x;if((y||s)&&r.isPrimaryClient){const v=y?!y.fromCache:(x=s==null?void 0:s.targetChanges.get(p.targetId))==null?void 0:x.current;r.sharedClientState.updateQueryState(p.targetId,v?"current":"not-current")}if(y){o.push(y);const v=f0.Es(p.targetId,y);l.push(v)}})))})),await Promise.all(d),r.Pu.J_(o),await(async function(p,y){const x=yt(p);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>Ee.forEach(y,(S=>Ee.forEach(S.Ts,(N=>x.persistence.referenceDelegate.addReference(v,S.targetId,N))).next((()=>Ee.forEach(S.Is,(N=>x.persistence.referenceDelegate.removeReference(v,S.targetId,N)))))))))}catch(v){if(!Ml(v))throw v;ke(h0,"Failed to update sequence numbers: "+v)}for(const v of y){const S=v.targetId;if(!v.fromCache){const N=x.vs.get(S),P=N.snapshotVersion,M=N.withLastLimboFreeSnapshotVersion(P);x.vs=x.vs.insert(S,M)}}})(r.localStore,l))}async function ak(n,e){const s=yt(n);if(!s.currentUser.isEqual(e)){ke(v0,"User change. New user:",e.toKey());const r=await XS(s.localStore,e);s.currentUser=e,(function(l,d){l.mu.forEach((m=>{m.forEach((p=>{p.reject(new Ve(Ce.CANCELLED,d))}))})),l.mu.clear()})(s,"'waitForPendingWrites' promise is rejected due to a user change."),s.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await dT(s,r.Ns)}}function rk(n,e){const s=yt(n),r=s.Au.get(e);if(r&&r.hu)return bt().add(r.key);{let o=bt();const l=s.Iu.get(e);if(!l)return o;for(const d of l){const m=s.Tu.get(d);o=o.unionWith(m.view.nu)}return o}}function fT(n){const e=yt(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=cT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rk.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=nk.bind(null,e),e.Pu.J_=Gj.bind(null,e.eventManager),e.Pu.yu=qj.bind(null,e.eventManager),e}class bf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=eT(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,s){return null}Mu(e,s){return null}vu(e){return yj(this.persistence,new pj,e.initialUser,this.serializer)}Cu(e){return new ZS(d0.Vi,this.serializer)}Du(e){return new Ej}async terminate(){var e,s;(e=this.gcScheduler)==null||e.stop(),(s=this.indexBackfillerScheduler)==null||s.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bf.provider={build:()=>new bf};class ik extends bf{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,s){Zt(this.persistence.referenceDelegate instanceof xf,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new JO(r,e.asyncQueue,s)}Cu(e){const s=this.cacheSizeBytes!==void 0?bs.withCacheSize(this.cacheSizeBytes):bs.DEFAULT;return new ZS((r=>xf.Vi(r,s)),this.serializer)}}class yg{async initialize(e,s){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(s),this.remoteStore=this.createRemoteStore(s),this.eventManager=this.createEventManager(s),this.syncEngine=this.createSyncEngine(s,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>b1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=ak.bind(null,this.syncEngine),await Vj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new Bj})()}createDatastore(e){const s=eT(e.databaseInfo.databaseId),r=Ij(e.databaseInfo);return jj(e.authCredentials,e.appCheckCredentials,r,s)}createRemoteStore(e){return(function(r,o,l,d,m){return new Lj(r,o,l,d,m)})(this.localStore,this.datastore,e.asyncQueue,(s=>b1(this.syncEngine,s,0)),(function(){return f1.v()?new f1:new wj})())}createSyncEngine(e,s){return(function(o,l,d,m,p,y,x){const v=new Kj(o,l,d,m,p,y);return x&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,s)}async terminate(){var e,s;await(async function(o){const l=yt(o);ke(Ol,"RemoteStore shutting down."),l.Ea.add(5),await yu(l),l.Aa.shutdown(),l.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(s=this.eventManager)==null||s.terminate()}}yg.provider={build:()=>new yg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ok{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Sr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,s){setTimeout((()=>{this.muted||e(s)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi="FirestoreClient";class lk{constructor(e,s,r,o,l){this.authCredentials=e,this.appCheckCredentials=s,this.asyncQueue=r,this._databaseInfo=o,this.user=Zn.UNAUTHENTICATED,this.clientId=t0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(r,(async d=>{ke(bi,"Received user=",d.uid),await this.authCredentialListener(d),this.user=d})),this.appCheckCredentials.start(r,(d=>(ke(bi,"Received new app check token=",d),this.appCheckCredentialListener(d,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new to;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(s){const r=rT(s,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function lm(n,e){n.asyncQueue.verifyOperationInProgress(),ke(bi,"Initializing OfflineComponentProvider");const s=n.configuration;await e.initialize(s);let r=s.initialUser;n.setCredentialChangeListener((async o=>{r.isEqual(o)||(await XS(e.localStore,o),r=o)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function _1(n,e){n.asyncQueue.verifyOperationInProgress();const s=await ck(n);ke(bi,"Initializing OnlineComponentProvider"),await e.initialize(s,n.configuration),n.setCredentialChangeListener((r=>m1(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,o)=>m1(e.remoteStore,o))),n._onlineComponents=e}async function ck(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ke(bi,"Using user provided OfflineComponentProvider");try{await lm(n,n._uninitializedComponentsProvider._offline)}catch(e){const s=e;if(!(function(o){return o.name==="FirebaseError"?o.code===Ce.FAILED_PRECONDITION||o.code===Ce.UNIMPLEMENTED:!(typeof DOMException<"u"&&o instanceof DOMException)||o.code===22||o.code===20||o.code===11})(s))throw s;po("Error using user provided cache. Falling back to memory cache: "+s),await lm(n,new bf)}}else ke(bi,"Using default OfflineComponentProvider"),await lm(n,new ik(void 0));return n._offlineComponents}async function uk(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ke(bi,"Using user provided OnlineComponentProvider"),await _1(n,n._uninitializedComponentsProvider._online)):(ke(bi,"Using default OnlineComponentProvider"),await _1(n,new yg))),n._onlineComponents}async function dk(n){const e=await uk(n),s=e.eventManager;return s.onListen=Zj.bind(null,e.syncEngine),s.onUnlisten=ek.bind(null,e.syncEngine),s.onFirstRemoteStoreListen=Xj.bind(null,e.syncEngine),s.onLastRemoteStoreUnlisten=tk.bind(null,e.syncEngine),s}function fk(n,e,s={}){const r=new to;return n.asyncQueue.enqueueAndForget((async()=>(function(l,d,m,p,y){const x=new ok({next:S=>{x.Nu(),d.enqueueAndForget((()=>Hj(l,v)));const N=S.docs.has(m);!N&&S.fromCache?y.reject(new Ve(Ce.UNAVAILABLE,"Failed to get document because the client is offline.")):N&&S.fromCache&&p&&p.source==="server"?y.reject(new Ve(Ce.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(S)},error:S=>y.reject(S)}),v=new $j(i0(m.path),x,{includeMetadataChanges:!0,Ka:!0});return Fj(l,v)})(await dk(n),n.asyncQueue,e,s,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hT(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hk="ComponentProvider",E1=new Map;function pk(n,e,s,r,o){return new HR(n,e,s,o.host,o.ssl,o.experimentalForceLongPolling,o.experimentalAutoDetectLongPolling,hT(o.experimentalLongPollingOptions),o.useFetchStreams,o.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pT="firestore.googleapis.com",w1=!0;class S1{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Ve(Ce.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=pT,this.ssl=w1}else this.host=e.host,this.ssl=e.ssl??w1;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=KS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ZO)throw new Ve(Ce.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}CR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hT(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Ve(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Ve(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Ve(Ce.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,o){return r.timeoutSeconds===o.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class E0{constructor(e,s,r,o){this._authCredentials=e,this._appCheckCredentials=s,this._databaseId=r,this._app=o,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new S1({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ve(Ce.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ve(Ce.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new S1(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new xR;switch(r.type){case"firstParty":return new ER(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ve(Ce.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(s){const r=E1.get(s);r&&(ke(hk,"Removing Datastore"),E1.delete(s),r.terminate())})(this),Promise.resolve()}}function mk(n,e,s,r={}){var y;n=tg(n,E0);const o=Xg(e),l=n._getSettings(),d={...l,emulatorOptions:n._getEmulatorOptions()},m=`${e}:${s}`;o&&(GN(`https://${m}`),QN("Firestore",!0)),l.host!==pT&&l.host!==m&&po("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p={...l,host:m,ssl:o,emulatorOptions:r};if(!uf(p,d)&&(n._setSettings(p),r.mockUserToken)){let x,v;if(typeof r.mockUserToken=="string")x=r.mockUserToken,v=Zn.MOCK_USER;else{x=qN(r.mockUserToken,(y=n._app)==null?void 0:y.options.projectId);const S=r.mockUserToken.sub||r.mockUserToken.user_id;if(!S)throw new Ve(Ce.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");v=new Zn(S)}n._authCredentials=new bR(new bS(x,v))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e,s,r){this.converter=s,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new w0(this.firestore,e,this._query)}}class cs{constructor(e,s,r){this.converter=s,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new lu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new cs(this.firestore,e,this._key)}toJSON(){return{type:cs._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,s,r){if(pu(s,cs._jsonSchema))return new cs(e,r||null,new qe(Wt.fromString(s.referencePath)))}}cs._jsonSchemaVersion="firestore/documentReference/1.0",cs._jsonSchema={type:wn("string",cs._jsonSchemaVersion),referencePath:wn("string")};class lu extends w0{constructor(e,s,r){super(e,s,i0(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new cs(this.firestore,null,new qe(e))}withConverter(e){return new lu(this.firestore,e,this._path)}}function gk(n,e,...s){if(n=rS(n),arguments.length===1&&(e=t0.newId()),NR("doc","path",e),n instanceof E0){const r=Wt.fromString(e,...s);return Uv(r),new cs(n,null,new qe(r))}{if(!(n instanceof cs||n instanceof lu))throw new Ve(Ce.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Wt.fromString(e,...s));return Uv(r),new cs(n.firestore,n instanceof lu?n.converter:null,new qe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1="AsyncQueue";class A1{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new tT(this,"async_queue_retry"),this._c=()=>{const r=om();r&&ke(T1,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const s=om();s&&typeof s.addEventListener=="function"&&s.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const s=om();s&&typeof s.removeEventListener=="function"&&s.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const s=new to;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(s.resolve,s.reject),s.promise))).then((()=>s.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Ml(e))throw e;ke(T1,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const s=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Sr("INTERNAL UNHANDLED ERROR: ",I1(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=s,s}enqueueAfterDelay(e,s,r){this.uc(),this.oc.indexOf(e)>-1&&(s=0);const o=x0.createAndSchedule(this,e,s,r,(l=>this.hc(l)));return this.tc.push(o),o}uc(){this.nc&&tt(47125,{Pc:I1(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const s of this.tc)if(s.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((s,r)=>s.targetTimeMs-r.targetTimeMs));for(const s of this.tc)if(s.skipDelay(),e!=="all"&&s.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const s=this.tc.indexOf(e);this.tc.splice(s,1)}}function I1(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class mT extends E0{constructor(e,s,r,o){super(e,s,r,o),this.type="firestore",this._queue=new A1,this._persistenceKey=(o==null?void 0:o.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new A1(e),this._firestoreClient=void 0,await e}}}function yk(n,e){const s=typeof n=="object"?n:aR(),r=typeof n=="string"?n:hf,o=JC(s,"firestore").getImmediate({identifier:r});if(!o._initialized){const l=FN("firestore");l&&mk(o,...l)}return o}function xk(n){if(n._terminated)throw new Ve(Ce.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||bk(n),n._firestoreClient}function bk(n){var r,o,l,d;const e=n._freezeSettings(),s=pk(n._databaseId,((r=n._app)==null?void 0:r.options.appId)||"",n._persistenceKey,(o=n._app)==null?void 0:o.options.apiKey,e);n._componentsProvider||(l=e.localCache)!=null&&l._offlineComponentProvider&&((d=e.localCache)!=null&&d._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new lk(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(p){const y=p==null?void 0:p._online.build();return{_offline:p==null?void 0:p._offline.build(y),_online:y}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $a(qn.fromBase64String(e))}catch(s){throw new Ve(Ce.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+s)}}static fromUint8Array(e){return new $a(qn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:$a._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(pu(e,$a._jsonSchema))return $a.fromBase64String(e.bytes)}}$a._jsonSchemaVersion="firestore/bytes/1.0",$a._jsonSchema={type:wn("string",$a._jsonSchemaVersion),bytes:wn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(...e){for(let s=0;s<e.length;++s)if(e[s].length===0)throw new Ve(Ce.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ls(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(e,s){if(!isFinite(e)||e<-90||e>90)throw new Ve(Ce.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(s)||s<-180||s>180)throw new Ve(Ce.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+s);this._lat=e,this._long=s}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return pt(this._lat,e._lat)||pt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ui._jsonSchemaVersion}}static fromJSON(e){if(pu(e,ui._jsonSchema))return new ui(e.latitude,e.longitude)}}ui._jsonSchemaVersion="firestore/geoPoint/1.0",ui._jsonSchema={type:wn("string",ui._jsonSchemaVersion),latitude:wn("number"),longitude:wn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e){this._values=(e||[]).map((s=>s))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,o){if(r.length!==o.length)return!1;for(let l=0;l<r.length;++l)if(r[l]!==o[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:di._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(pu(e,di._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((s=>typeof s=="number")))return new di(e.vectorValues);throw new Ve(Ce.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}di._jsonSchemaVersion="firestore/vectorValue/1.0",di._jsonSchema={type:wn("string",di._jsonSchemaVersion),vectorValues:wn("object")};function yT(n,e,s){if((e=rS(e))instanceof gT)return e._internalPath;if(typeof e=="string")return _k(n,e);throw xg("Field path arguments must be of type string or ",n)}const vk=new RegExp("[~\\*/\\[\\]]");function _k(n,e,s){if(e.search(vk)>=0)throw xg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n);try{return new gT(...e.split("."))._internalPath}catch{throw xg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n)}}function xg(n,e,s,r,o){let l=`Function ${e}() called with invalid data`;l+=". ";let d="";return new Ve(Ce.INVALID_ARGUMENT,l+n+d)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{convertValue(e,s="none"){switch(yi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return fn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,s);case 5:return e.stringValue;case 6:return this.convertBytes(gi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,s);case 11:return this.convertObject(e.mapValue,s);case 10:return this.convertVectorValue(e.mapValue);default:throw tt(62114,{value:e})}}convertObject(e,s){return this.convertObjectMap(e.fields,s)}convertObjectMap(e,s="none"){const r={};return mu(e,((o,l)=>{r[o]=this.convertValue(l,s)})),r}convertVectorValue(e){var r,o,l;const s=(l=(o=(r=e.fields)==null?void 0:r[sg].arrayValue)==null?void 0:o.values)==null?void 0:l.map((d=>fn(d.doubleValue)));return new di(s)}convertGeoPoint(e){return new ui(fn(e.latitude),fn(e.longitude))}convertArray(e,s){return(e.values||[]).map((r=>this.convertValue(r,s)))}convertServerTimestamp(e,s){switch(s){case"previous":const r=Mf(e);return r==null?null:this.convertValue(r,s);case"estimate":return this.convertTimestamp(ru(e));default:return null}}convertTimestamp(e){const s=mi(e);return new En(s.seconds,s.nanos)}convertDocumentKey(e,s){const r=Wt.fromString(e);Zt(WS(r),9688,{name:e});const o=new iu(r.get(1),r.get(3)),l=new qe(r.popFirst(5));return o.isEqual(s)||Sr(`Document ${l} contains a document reference within a different database (${o.projectId}/${o.database}) which is not supported. It will be treated as a reference in the current database (${s.projectId}/${s.database}) instead.`),l}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk extends Ek{constructor(e){super(),this.firestore=e}convertBytes(e){return new $a(e)}convertReference(e){const s=this.convertDocumentKey(e,this.firestore._databaseId);return new cs(this.firestore,null,s)}}const N1="@firebase/firestore",C1="4.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(e,s,r,o,l){this._firestore=e,this._userDataWriter=s,this._key=r,this._document=o,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new cs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Sk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const s=this._document.data.field(yT("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s)}}}class Sk extends xT{data(){return super.data()}}class Dc{constructor(e,s){this.hasPendingWrites=e,this.fromCache=s}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class so extends xT{constructor(e,s,r,o,l,d){super(e,s,r,o,d),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const s=new sf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(s,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,s={}){if(this._document){const r=this._document.data.field(yT("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,s.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(Ce.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,s={};return s.type=so._jsonSchemaVersion,s.bundle="",s.bundleSource="DocumentSnapshot",s.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?s:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),s.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),s)}}so._jsonSchemaVersion="firestore/documentSnapshot/1.0",so._jsonSchema={type:wn("string",so._jsonSchemaVersion),bundleSource:wn("string","DocumentSnapshot"),bundleName:wn("string"),bundle:wn("string")};class sf extends so{data(e={}){return super.data(e)}}class Xc{constructor(e,s,r,o){this._firestore=e,this._userDataWriter=s,this._snapshot=o,this.metadata=new Dc(o.hasPendingWrites,o.fromCache),this.query=r}get docs(){const e=[];return this.forEach((s=>e.push(s))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,s){this._snapshot.docs.forEach((r=>{e.call(s,new sf(this._firestore,this._userDataWriter,r.key,r,new Dc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const s=!!e.includeMetadataChanges;if(s&&this._snapshot.excludesMetadataChanges)throw new Ve(Ce.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===s||(this._cachedChanges=(function(o,l){if(o._snapshot.oldDocs.isEmpty()){let d=0;return o._snapshot.docChanges.map((m=>{const p=new sf(o._firestore,o._userDataWriter,m.doc.key,m.doc,new Dc(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);return m.doc,{type:"added",doc:p,oldIndex:-1,newIndex:d++}}))}{let d=o._snapshot.oldDocs;return o._snapshot.docChanges.filter((m=>l||m.type!==3)).map((m=>{const p=new sf(o._firestore,o._userDataWriter,m.doc.key,m.doc,new Dc(o._snapshot.mutatedKeys.has(m.doc.key),o._snapshot.fromCache),o.query.converter);let y=-1,x=-1;return m.type!==0&&(y=d.indexOf(m.doc.key),d=d.delete(m.doc.key)),m.type!==1&&(d=d.add(m.doc),x=d.indexOf(m.doc.key)),{type:Tk(m.type),doc:p,oldIndex:y,newIndex:x}}))}})(this,s),this._cachedChangesIncludeMetadataChanges=s),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Ve(Ce.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Xc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=t0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const s=[],r=[],o=[];return this.docs.forEach((l=>{l._document!==null&&(s.push(l._document),r.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),o.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Tk(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return tt(61501,{type:n})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xc._jsonSchemaVersion="firestore/querySnapshot/1.0",Xc._jsonSchema={type:wn("string",Xc._jsonSchemaVersion),bundleSource:wn("string","QuerySnapshot"),bundleName:wn("string"),bundle:wn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ak(n){n=tg(n,cs);const e=tg(n.firestore,mT),s=xk(e);return fk(s,n._key).then((r=>Ik(e,n,r)))}function Ik(n,e,s){const r=s.docs.get(e._key),o=new wk(n);return new so(n,o,e._key,r,new Dc(s.hasPendingWrites,s.fromCache),e.converter)}(function(e,s=!0){yR(sR),ff(new nu("firestore",((r,{instanceIdentifier:o,options:l})=>{const d=r.getProvider("app").getImmediate(),m=new mT(new vR(r.getProvider("auth-internal")),new wR(d,r.getProvider("app-check-internal")),GR(d,o),d);return l={useFetchStreams:s,...l},m._setSettings(l),m}),"PUBLIC").setMultipleInstances(!0)),xl(N1,C1,e),xl(N1,C1,"esm2020")})();const Nk={apiKey:"...",authDomain:"...",projectId:"vocabpro-5604c"},Ck=cS(Nk),Rk=yk(Ck);async function Ok(){try{console.log("Attempting to get current host from Firebase...");const n=gk(Rk,"vocabpro","server");console.log("Fetching document from Firestore...");const e=await Ak(n);return console.log("Received response from Firestore:",e.exists()?e.data():"No document"),e.exists()?e.data().host:(console.log("Document does not exist"),null)}catch(n){return console.error("Firebase error:",n),null}}const jk=async(n,e)=>{try{const p=await Ok();if(p){const y=new URL(p),x=y.port?parseInt(y.port,10):y.protocol==="https:"?443:80;if(n&&n(p),(await fetch(`${p}/api/health`,{mode:"cors",cache:"no-cache"})).ok)return{host:y.hostname,port:x}}}catch{}const s=["localhost","127.0.0.1","macm2.local","macm4.local"],r=3e3,o=3020,l=[];for(let p=r;p<=o;p++)s.forEach(y=>{l.push({host:y,port:p,url:`http://${y}:${p}`}),l.push({host:y,port:p,url:`https://${y}:${p}`})});const d=async p=>{if(e!=null&&e.aborted)return null;n&&n(p.url);const y=new AbortController,x=setTimeout(()=>y.abort(),1500),v=()=>y.abort();e==null||e.addEventListener("abort",v);try{const S=await fetch(`${p.url}/api/health`,{signal:y.signal,mode:"cors",cache:"no-cache"});return clearTimeout(x),e==null||e.removeEventListener("abort",v),S.ok?p:null}catch{return clearTimeout(x),e==null||e.removeEventListener("abort",v),null}},m=8;for(let p=0;p<l.length;p+=m){if(e!=null&&e.aborted)return null;const y=l.slice(p,p+m),v=(await Promise.all(y.map(d))).find(S=>S!==null);if(v)return{host:v.host,port:v.port}}return null},kk=()=>{const{showToast:n}=Za(),{currentUser:e,isLoaded:s,handleLogin:r,handleUpdateUser:o,setCurrentUser:l,shouldSkipAuth:d}=SN(),[m,p]=D.useState("AUTH"),[y,x]=D.useState(!1),[v,S]=D.useState(null),[N,P]=D.useState(null),[M,j]=D.useState(!1),[V,B]=D.useState(Date.now()),[H,G]=D.useState("disconnected"),[Y,K]=D.useState(""),[I,A]=D.useState(!1),[_,C]=D.useState("idle"),[R,L]=D.useState(""),O=D.useRef(!1),xe=D.useRef(null),[ge,F]=D.useState(null),[ue,ae]=D.useState(!1),X=D.useRef(!1),[Q,T]=D.useState(!1),[z,$]=D.useState(!1),[J,pe]=D.useState(null),[de,_e]=D.useState(null),[W,le]=D.useState(null),ie=D.useCallback(()=>le(null),[]),[he,Ie]=D.useState(null),Ue=D.useCallback(()=>Ie(null),[]),[je,wt]=D.useState(null),Re=D.useCallback(()=>wt(null),[]),[we,rt]=D.useState(null),Qe=D.useCallback(()=>rt(null),[]),[oe,ze]=D.useState(null),et=D.useCallback(()=>ze(null),[]),[vt,Ye]=D.useState(null),We=D.useCallback(()=>Ye(null),[]),[it,St]=D.useState([]),[Ut,es]=D.useState(!1),Us=D.useRef(!1),[ts,Es]=D.useState(!1),[ve,Oe]=D.useState(""),{sessionWords:Ae,setSessionWords:Be,sessionType:xt,sessionFocus:Ke,startSession:dt,clearSessionState:ft}=TN({setView:p,setIsSidebarOpen:x}),{stats:zt,wotd:Tt,apiUsage:Bt,refreshGlobalStats:on,isWotdComposed:Sn,randomizeWotd:oa}=RN({currentUser:e,onUpdateUser:o}),jn=D.useCallback(async(Te=!1,$e,He=!1,Pe)=>{const Ze=Dt(),At=$e||Cn(Ze);K(At);const Yn=async nn=>{const gn=new AbortController,ua=setTimeout(()=>gn.abort(),1200),ss=()=>gn.abort();Pe==null||Pe.addEventListener("abort",ss);try{const Ln=await fetch(`${nn}/api/health`,{signal:gn.signal,mode:"cors"});return clearTimeout(ua),Pe==null||Pe.removeEventListener("abort",ss),Ln.ok}catch{return clearTimeout(ua),Pe==null||Pe.removeEventListener("abort",ss),!1}};if(!He&&(L(At),await Yn(At))){if(G("connected"),Ze.sync.autoBackupEnabled||qc({...Ze,sync:{...Ze.sync,autoBackupEnabled:!0}},!0),$e){const gn={...Ze,server:{...Ze.server,useCustomUrl:!0,customUrl:$e},sync:{...Ze.sync,autoBackupEnabled:!0}};qc(gn,!0),n(`Connected to ${$e}`,"success")}return!0}if(!$e&&Te||He){if(Pe!=null&&Pe.aborted)return!1;const nn=await jk(gn=>{L(gn)},Pe);if(nn){const gn={...Ze,server:{...Ze.server,host:nn.host,port:nn.port,useCustomUrl:!1},sync:{...Ze.sync,autoBackupEnabled:!0}};return qc(gn,!0),G("connected"),n(`Server found at ${nn.host}:${nn.port}`,"success"),!0}}return Pe!=null&&Pe.aborted||G("disconnected"),!1},[n]),kn=async Te=>{xe.current&&xe.current.abort(),xe.current=new AbortController;const $e=xe.current.signal;C("scanning");try{await new Promise((Pe,Ze)=>{const At=setTimeout(Pe,800);$e.addEventListener("abort",()=>{clearTimeout(At),Ze(new Error("aborted"))})});const He=await jn(!Te,Te,!Te,$e);return $e.aborted?!1:He?(C("success"),setTimeout(()=>A(!1),1e3),!0):(C("failed"),!1)}catch(He){return He.message==="aborted"||C("failed"),!1}},Ps=()=>{xe.current&&(xe.current.abort(),xe.current=null),C("failed")},la=D.useCallback(()=>e&&e.id===Hc&&e.name==="Vocab Master",[e]);D.useEffect(()=>{if(s&&!O.current){O.current=!0;const Te=la();Te&&(A(!0),C("scanning")),jn(!0).then(He=>{He?(G("connected"),Te&&(C("success"),setTimeout(()=>A(!1),800))):Te&&C("failed")});const $e=setInterval(()=>jn(!1),3e4);return window.addEventListener("config-updated",()=>jn(!1)),()=>{clearInterval($e),window.removeEventListener("config-updated",()=>jn(!1))}}},[s,jn,la]),D.useEffect(()=>{const $e=setTimeout(async()=>{if(!(!s||H!=="connected"||!e||X.current||I||Ut)){X.current=!0;try{const He=await Ud(),Pe=e.name||e.id,Ze=He.find(At=>At.id===Pe||At.name===Pe);if(Ze){const At=new Date(Ze.date).getTime(),Yn=Number(localStorage.getItem("vocab_pro_local_last_modified")||0),nn=2e3;At>Yn+nn?F({isOpen:!0,type:"restore",localDate:Yn===0?"Never":new Date(Yn).toLocaleString(),serverDate:new Date(At).toLocaleString(),serverId:Ze.id,serverMtime:At}):Yn>At+nn&&F({isOpen:!0,type:"push",localDate:new Date(Yn).toLocaleString(),serverDate:new Date(At).toLocaleString(),serverId:Ze.id,serverMtime:At})}}catch(He){console.warn("[Sync] Initial check failed:",He)}}},2e3);return()=>clearTimeout($e)},[s,H,e==null?void 0:e.id,I,Ut]),D.useEffect(()=>{const $e=setTimeout(async()=>{if(Us.current)return;const He=sessionStorage.getItem("vocab_pro_suppress_auto_restore")==="true";if(s&&H==="connected"&&la()&&!I&&!He){Us.current=!0;try{const Pe=await Ud();Pe&&Pe.length>0&&(St(Pe),es(!0))}catch(Pe){console.warn("[AutoRestore] Failed to fetch backups on init:",Pe)}}},1e3);return()=>clearTimeout($e)},[s,H,la,I]);const{lastBackupTime:ca,refreshBackupTime:Tr,handleBackup:Ar,restoreFromServerAction:Oa,triggerLocalRestore:Vs,handleLibraryReset:xo,deleteWord:ws,bulkDeleteWords:Ss,bulkUpdateWords:en}=ON({currentUser:e,setView:p,refreshGlobalStats:on,sessionWords:Ae,setSessionWords:Be,globalViewWord:v,setGlobalViewWord:S,onUpdateUser:o}),mn=async Te=>{F(null),es(!1),ae(!0);try{const He=(await Ud()).find(Ze=>Ze.id===Te),Pe=He?new Date(He.date).getTime():void 0;await Oa(Te,Pe),ae(!1)}catch{ae(!1),n("Restore failed.","error")}},zs=()=>{es(!1),Vs()},Ir=async()=>{sessionStorage.setItem("vocab_pro_suppress_auto_restore","true"),es(!1),Es(!0),Oe("Wiping all data and preparing new profile...");try{await Kw();const Te=await Lg(!0);Te&&(r(Te),p("SETTINGS"),n("Welcome! Your data has been wiped. Please set up your new profile.","success"))}catch{n("Failed to prepare new profile.","error")}finally{Es(!1)}},Ul=async()=>{if(!await jn(!0)){A(!0),C("failed");return}if(sessionStorage.removeItem("vocab_pro_suppress_auto_restore"),Us.current=!1,e&&e.id!==Hc){n("Syncing current profile...","info");try{await Xd(e.id,e,!0)}catch{n("Backup failed, proceeding...","error")}}try{await Jw();const $e=await Ud();St($e),es(!0)}catch{n("Failed to fetch user list from server.","error")}},bo=async()=>{if(e){ae(!0);try{await Xd(e.id,e,!0),n("Cloud backup updated!","success"),F(null)}catch{n("Push failed.","error")}finally{ae(!1)}}},vo=async()=>{if(ge){ae(!0);try{await Oa(ge.serverId,ge.serverMtime),F(null),ae(!1)}catch{n("Restore failed.","error"),ae(!1)}}};D.useEffect(()=>{const Te=()=>{window.isRestoring||T(!0)},$e=()=>{T(!1),pe(null)},He=Ze=>{const At=Ze;At.detail&&At.detail.targetTime&&pe(At.detail.targetTime)},Pe=Ze=>{const At=Ze;At.detail&&(At.detail.success?(T(!1),pe(null),Tr(),n("Cloud sync complete!","success",2e3)):T(!0))};return window.addEventListener("datastore-updated",Te),window.addEventListener("vocab-pro-restore-complete",$e),window.addEventListener("backup-scheduled",He),window.addEventListener("backup-complete",Pe),()=>{window.removeEventListener("datastore-updated",Te),window.removeEventListener("vocab-pro-restore-complete",$e),window.removeEventListener("backup-scheduled",He),window.removeEventListener("backup-complete",Pe)}},[Tr,n]);const Bs=async()=>{if(!e)return;const Te=Xw(),{learned:$e,reviewed:He}=Te.dayProgress,Pe=new Date().toISOString().split("T")[0],Ze=Math.floor($e/3),At=Math.floor(He/10),Yn=Ze+At,nn=e.adventure,gn=nn.lastDailyEnergyAwardDate||"";let ua=nn.dailyEnergyAwarded||0;if(gn!==Pe&&(ua=0),Yn>ua){const ss=Yn-ua,Ln={...e,adventure:{...nn,energy:(nn.energy||0)+ss,dailyEnergyAwarded:Yn,lastDailyEnergyAwardDate:Pe}};await o(Ln),n(`Daily Progress: +${ss} Energy `,"success",2e3)}};D.useEffect(()=>{s&&e&&Bs()},[zt,s,e==null?void 0:e.id]);const Nr=async Te=>{const $e=_v(Te.id);(!$e||$e.masteryScore!==Te.masteryScore)&&B(Date.now()),await Of(Te),Ae&&Be(He=>(He||[]).map(Pe=>Pe.id===Te.id?Te:Pe)),v&&v.id===Te.id&&S(Te)},Ts=async()=>{e&&(qm(),T(!1),pe(null),await Xd(e.id,e,!0))},fs=async()=>{H==="connected"&&e?await Ts():await Ar()},ns=async Te=>{await en(Te)},Fs=async(Te,$e)=>{await mN(Te,$e),l($e);const He=_v(Te.id);(!He||He.masteryScore!==Te.masteryScore)&&B(Date.now()),Ae&&Be(Pe=>(Pe||[]).map(Ze=>Ze.id===Te.id?Te:Ze)),v&&v.id===Te.id&&S(Te)},{gainExperienceAndLevelUp:tn,recalculateXpAndLevelUp:vi,xpGained:_i,xpToNextLevel:Hs}=IN({currentUser:e,onUpdateUser:o,onSaveWordAndUser:Fs});D.useEffect(()=>{s&&(d&&e?p("DASHBOARD"):e||p("AUTH"))},[s,d,e==null?void 0:e.id]);const Gs=async Te=>{Te.id!==Hc&&sessionStorage.removeItem("vocab_pro_suppress_auto_restore"),Te.adventure.map||(Te.adventure.map=Gc(100),await ra(Te)),l(Te),localStorage.setItem("vocab_pro_current_user_id",Te.id),localStorage.setItem("vocab_pro_current_user_name",Te.name),await ra({...Te,lastLogin:Date.now()})},Ei=()=>{l(null),localStorage.removeItem("vocab_pro_current_user_id")},ja=D.useCallback(()=>{ft(),p("DASHBOARD"),on()},[ft,on]),wi=D.useCallback(()=>{if(!Ae||Ae.length===0||!xt){ja();return}const Te=Ae.map(He=>He.id),$e=ii().filter(He=>Te.includes(He.id));$e.length>0?dt($e,xt,Ke):ja()},[Ae,xt,Ke,dt,ja]),Si=D.useCallback(async()=>{if(!e)return;const Te=ii(),$e=Date.now(),He=Te.filter(Pe=>!Pe.isPassive&&Pe.lastReview&&Pe.nextReview<=$e&&Pe.quality!=="FAILED").sort((Pe,Ze)=>Pe.nextReview-Ze.nextReview).slice(0,30);if(He.length===0){n("No words due for review!","success");return}dt(He,"due")},[e,dt,n]),Xa=D.useCallback(async()=>{if(!e)return;const $e=ii().filter(He=>!He.isPassive&&!He.lastReview&&He.quality==="VERIFIED").sort((He,Pe)=>He.createdAt-Pe.createdAt).slice(0,20);if($e.length===0){n("No new words to learn!","success");return}dt($e,"new")},[e,dt,n]);return{view:m,setView:p,currentUser:e,isLoaded:s,isResetting:ts,resetStep:ve,isSidebarOpen:y,setIsSidebarOpen:x,handleLogin:Gs,handleLogout:Ei,handleUpdateUser:o,sessionWords:Ae,sessionFocus:Ke,sessionType:xt,startSession:dt,handleSessionComplete:ja,stats:zt,wotd:Tt,refreshGlobalStats:on,isWotdComposed:Sn,randomizeWotd:oa,globalViewWord:v,setGlobalViewWord:S,lastBackupTime:ca,handleBackup:fs,triggerLocalBackup:Ar,triggerServerBackup:Ts,restoreFromServerAction:mn,triggerLocalRestore:Vs,handleLibraryReset:xo,initialListFilter:N,setInitialListFilter:P,forceExpandAdd:M,setForceExpandAdd:j,apiUsage:Bt,updateWord:Nr,deleteWord:ws,bulkDeleteWords:Ss,bulkUpdateWords:ns,handleNavigateToList:Te=>{P(Te),p("BROWSE")},openAddWordLibrary:()=>{p("BROWSE"),j(!0)},clearSessionState:ft,handleRetrySession:wi,gainExperienceAndLevelUp:tn,recalculateXpAndLevelUp:vi,xpGained:_i,xpToNextLevel:Hs,startDueReviewSession:Si,startNewLearnSession:Xa,lastMasteryScoreUpdateTimestamp:V,writingContextWord:de,handleComposeWithWord:Te=>{_e(Te),p("WRITING")},consumeWritingContext:()=>_e(null),targetLessonId:W,setTargetLessonId:le,consumeTargetLessonId:ie,targetLessonTag:he,consumeTargetLessonTag:Ue,targetLessonType:je,consumeTargetLessonType:Re,targetCourseId:we,consumeTargetCourseId:Qe,targetGameMode:oe,consumeTargetGameMode:et,planningAction:vt,setPlanningAction:Ye,consumePlanningAction:We,serverStatus:H,serverUrl:Y,hasUnsavedChanges:Q,hasWritingUnsavedChanges:z,setHasWritingUnsavedChanges:$,nextAutoBackupTime:J,isAutoRestoreOpen:Ut,setIsAutoRestoreOpen:es,autoRestoreCandidates:it,handleNewUserSetup:Ir,handleLocalRestoreSetup:zs,handleSwitchUser:Ul,isConnectionModalOpen:I,setIsConnectionModalOpen:A,connectionScanStatus:_,scanningUrl:R,handleScanAndConnect:kn,handleStopScan:Ps,syncPrompt:ge,setSyncPrompt:F,isSyncing:ue,handleSyncPush:bo,handleSyncRestore:vo,handleSpecialAction:(Te,$e)=>{switch(Te){case"REVIEW":Si();break;case"BROWSE":Xa();break;case"LESSON":$e&&$e.lessonId&&le($e.lessonId),p("LESSON");break;case"LESSON_ONLY":wt("ESSAY"),p("LESSON");break;case"LESSON_GRAMMAR":rt("grammar"),p("COURSE");break;case"LESSON_SCALE":wt("INTENSITY"),p("LESSON");break;case"LESSON_DIFF":wt("COMPARISON"),p("LESSON");break;case"IRREGULAR_VERBS":p("IRREGULAR_VERBS");break;case"MIMIC":p("MIMIC");break;case"PRONUNCIATION_ROADMAP":rt("pronunciation_roadmap"),p("COURSE");break;case"PLAN_AI":Ye("AI"),p("PLANNING");break;case"PLAN_IMPORT":Ye("IMPORT"),p("PLANNING");break;case"COLLO_CONNECT":case"DICTATION":case"SENTENCE_SCRAMBLE":case"MEANING_MATCH":case"IPA_SORTER":case"PREPOSITION_POWER":case"WORD_TRANSFORMER":case"PARAPHRASE_CONTEXT":case"IDIOM_CONNECT":case"WORD_SCATTER":case"NATURAL_EXPRESSION":case"INTENSITY_SCALE":case"COMPARISON_LAB":case"ADVENTURE":sessionStorage.setItem("dashboard_active_tab","PRACTICE"),ze(Te),p("DISCOVER");break;default:p(Te)}}}},Lk="modulepreload",Mk=function(n){return"/ielts-pro/"+n},R1={},ds=function(e,s,r){let o=Promise.resolve();if(s&&s.length>0){let d=function(y){return Promise.all(y.map(x=>Promise.resolve(x).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),p=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));o=d(s.map(y=>{if(y=Mk(y),y in R1)return;R1[y]=!0;const x=y.endsWith(".css"),v=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${v}`))return;const S=document.createElement("link");if(S.rel=x?"stylesheet":Lk,x||(S.as="script"),S.crossOrigin="",S.href=y,p&&S.setAttribute("nonce",p),document.head.appendChild(S),x)return new Promise((N,P)=>{S.addEventListener("load",N),S.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${y}`)))})}))}function l(d){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=d,window.dispatchEvent(m),!m.defaultPrevented)throw d}return o.then(d=>{for(const m of d||[])m.status==="rejected"&&l(m.reason);return e().catch(l)})};function Dk(n,e="Vietnamese"){return`You are an expert IELTS coach, examiner, and native English speaker.
    
    Analyze this list of vocabulary items: [${n.map(r=>`"${r}"`).join(", ")}].

    IMPORTANT RULES FOR HEADWORD (hw) IDENTIFICATION:
    1. FOR PHRASES/IDIOMS/EXPRESSIONS: If the input is a multi-word unit (e.g., "cut the road", "break the ice", "get over"), the headword (hw) MUST be the EXACT phrase provided. DO NOT reduce it to a single word.
    2. FOR SINGLE WORDS: If the input is a single inflected word, identify its base form and ensure it is in SINGULAR form (e.g., "running" -> "run", "cities" -> "city", "problems" -> "problem").
    3. All details (meaning, IPA, examples) MUST correspond to the identified headword (the whole phrase or the base word).
    4. If input has multiple distinct meanings as a phrase vs a single word, prioritize the meaning of the input as provided.

    LANGUAGE RULES:
    - All content in English, except "m" (Meaning) which must be in ${e}.

    FIELD GENERATION RULES:
    - If the headword (hw) is a PHRASE, PHRASAL VERB, or IDIOM (e.g., "break the ice"):
      - DO NOT generate 'fam' (word family). Return an empty object {} or null.
      - DO NOT generate 'col' (collocations). Return an empty array [].
    - Do NOT generate 'para' (paraphrase) for orthographic variants (e.g., space vs no space, hyphen vs no hyphen).

    RESPONSE OPTIMIZATION:
    - Omit "og" if it is identical to "hw".
    - Omit "ipa_uk" if "pron_sim" is "same".

    FIELD DEFINITIONS:
    - og: The EXACT string from the input list. (Include ONLY if different from "hw").
    - hw: The headword (Full phrase for expressions; base form for single words).
    - ipa_us: Primary IPA transcription (General American).
    - ipa_uk: Received Pronunciation (UK) IPA. (Omit if "pron_sim" is "same").
    - pron_sim: Similarity between US and UK pronunciation. MUST be: "same", "near", or "different".
    - ipa_m: Array of 2-4 common mispronunciation transcriptions (to test the user).
    - m: Definition of the headword in ${e}.
    - reg: Register. MUST be one of: "academic", "casual", or "neutral".
    - ex: A high-quality example sentence using the headword.
    - col: Array of 3-5 collocations. ONLY for single-word headwords. Items: {"text": "phrase", "d": "minimal descriptive cue for recall (5-10 words)"}.
    - idm: Array of 1-3 common idioms containing the headword (only if hw is a single word). Items: {"text": "phrase", "d": "descriptive cue"}.
    - prep: Array of dependent prepositions. If the headword does NOT take a fixed preposition, return an empty array []. Format: [{"p": "preposition", "c": "short usage example"}].
    - para: Controlled paraphrase system (max 5 items total). ONLY generate categories if a natural equivalent exists. Try to force all tone types but avoid unnatural versions.        - Each item MUST be an object: {"w": "word_or_phrase", "t": "tone_type", "c": "recall cue"}.
        - 't' (tone) MUST be one of: "academic", "casual", "synonym" (no hypernyms or hyponyms)
        - 'c' (context) = a short (2-5 words) situational recall cue (e.g., "job interview", "arguing with friend").
    - fam: Word family. ONLY for single-word headwords. 'n'=nouns, 'v'=verbs, 'j'=adjectives, 'adv'=adverbs. Format: [{"w": "word"}].
    - type: The grammatical classification. MUST be one of: "idiom", "phrasal_verb", "collocation", "phrase", "vocabulary", "irregular_verb".
    - is_pas: Boolean. True if the word is "Passive" (vulgar, slang, or should be archived).

    Response Example (Return in code block format Strict JSON Array):
    [{
      "hw": "unhappy",
      "ipa_us": "/nhpi/",
      "pron_sim": "same",
      "ipa_m": ["/nhepi/"],
      "m": "khng vui, bun",
      "reg": "neutral",
      "ex": "She was unhappy with the results of the experiment.",
      "col": [{"text": "deeply unhappy", "d": "extreme sadness about a life event"}],
      "idm": [],
      "prep": [{"p": "with", "c": "unhappy with the service"}], 
      "para": [
        { "w": "dissatisfied", "t": "academic", "c": "complaining about product quality" },
        { "w": "miserable", "t": "intensified", "c": "sitting alone in the rain" }
      ],
      "type": "vocabulary",
      "is_pas": false,
      "fam": { "n": [{"w": "unhappiness"}], "adv": [{"w": "unhappily"}] }
    }]`}function Uk(n){return`You are an expert English linguist.
    
    TASK: Provide the principal parts (past simple and past participle) for the following list of irregular verbs: [${n.map(s=>`"${s}"`).join(", ")}].

    RULES:
    1.  For each verb, provide its V1 (base form), V2 (past simple), and V3 (past participle).
    2.  If a verb has multiple common forms (e.g., "dreamt" / "dreamed"), provide the most common one first.
    3.  If a word is not an irregular verb, return its regular "-ed" forms.
    
    Return in code block format your analysis as a strict JSON array of objects. Each object must contain "v1", "v2", and "v3".

    Response Example (Strict JSON Array):
    [
      {
        "v1": "go",
        "v2": "went",
        "v3": "gone"
      },
      {
        "v1": "begin",
        "v2": "began",
        "v3": "begun"
      },
      {
        "v1": "dream",
        "v2": "dreamt",
        "v3": "dreamt"
      }
    ]`}function Pk(n,e){var r,o,l;const s={word:n.word,meaning:n.meaningVi,family:n.wordFamily,collocations:(r=n.collocationsArray)==null?void 0:r.map(d=>d.text),idioms:(o=n.idiomsList)==null?void 0:o.map(d=>d.text),paraphrases:(l=n.paraphrases)==null?void 0:l.map(d=>({word:d.word,tone:d.tone,context:d.context}))};return`You are an expert IELTS coach and English teacher. Your task is to provide learning recommendations for a vocabulary item based on a user's profile.

    USER PROFILE:
    - Role: ${e.role||"N/A"}
    - Current Level: ${e.currentLevel||"N/A"}
    - Target: ${e.target||"N/A"}

    VOCABULARY ITEM TO ANALYZE:
    ${JSON.stringify(s,null,2)}

    INSTRUCTIONS:
    1.  Analyze all components of the vocabulary item (word family, collocations, idioms, paraphrases).
    2.  Based on the USER PROFILE, decide whether each component is essential to learn ('learn') or can be ignored for now ('ignore').
    3.  Provide a concise, sharp 'reason' for each decision. Your reasoning is the most important part.
    4.  Be strict. For an IELTS learner, prioritize academic, high-impact, and flexible vocabulary. For a beginner, prioritize core meanings and common usage.

    EXAMPLE REASONING:
    - For an IELTS goal, if a paraphrase is "the process of a liquid turning into a gas," you should suggest 'ignore' and reason: "This is too descriptive and wordy for IELTS. A single academic term like 'evaporation' is more effective and scores higher for lexical resource."
    - For a primary school student goal, you might suggest 'learn' for the same phrase, reasoning: "This simple explanation is great for building foundational understanding before learning the scientific term."
    - For a common idiom, you might suggest 'learn' for an IELTS student: "Essential for demonstrating natural, native-like language in Speaking Part 1."

    Return in code block format a single, strict JSON object. Do not include any text outside the JSON block.

    STRICT JSON OUTPUT FORMAT:
    {
      "overall_summary": "string (A one-sentence summary of the learning strategy for this word, based on the user's goal.)",
      "wordFamily": [
        { "item": "string (the word form)", "suggestion": "learn" | "ignore", "reason": "string (your concise explanation)" }
      ],
      "collocations": [
        { "item": "string (the collocation)", "suggestion": "learn" | "ignore", "reason": "string" }
      ],
      "idioms": [
        { "item": "string (the idiom)", "suggestion": "learn" | "ignore", "reason": "string" }
      ],
      "paraphrases": [
        { "item": "string (the paraphrase word)", "suggestion": "learn" | "ignore", "reason": "string" }
      ]
    }
    `}function Vk(n,e,s){var l,d,m,p;const r=e.language||"English",o={word:n.word,meaning:n.meaningVi,family:n.wordFamily,collocations:(l=n.collocationsArray)==null?void 0:l.filter(y=>!y.isIgnored).map(y=>({text:y.text,hint:y.d})),idioms:(d=n.idiomsList)==null?void 0:d.filter(y=>!y.isIgnored).map(y=>({text:y.text,hint:y.d})),paraphrases:(m=n.paraphrases)==null?void 0:m.filter(y=>!y.isIgnored).map(y=>({word:y.word,tone:y.tone,context:y.context})),prepositions:(p=n.prepositions)==null?void 0:p.filter(y=>!y.isIgnored)};return`You are an expert IELTS coach${s?` named '${s}'`:""}. 
  
  TASK: Generate a highly structured "Usage Guide" for the word: "${n.word}".
  
  DATA: ${JSON.stringify(o)}

  INSTRUCTIONS:
  1. Create 5 distinct sections, each containing a Markdown Table:
     - **Prepositions**
     - **Word Family**
     - **Collocations**
     - **Variations (Paraphrases)**
     - **Idioms**
  
  2. Each table MUST have exactly these 3 columns:
     - **Word**: The specific form, collocation, or phrase.
     - **Context**: A brief explanation of *when* or *how* to use it (nuance, tone, or grammatical rule).
     - **Examples**: EXACTLY one high-quality, natural example sentence using that specific item.

  3. CONSTRAINTS:
     - Use ONLY Markdown tables for the usage data.
     - For line breaks WITHIN a table cell, use \`<br>\`. Do NOT use \`\\n\` or \`\\\\n\` inside table rows.
     - You MUST provide at least 1 example for every single item listed in the tables.
     - Keep the "Context" column concise (max 15 words).
     - If no data exists for a category (e.g., no idioms), you may skip that section or note it as "No common idioms".
     - All instructional text and headers should be in ${r}. All material/examples in English.

  Return in code block format a JSON object:
  {
    "content": "string (Markdown formatted with headers and tables, use \\n for newlines)"
  }`}function zk(n,e,s){var l,d,m;const r=e.language||"English",o={word:n.word,meaning:n.meaningVi,collocations:(l=n.collocationsArray)==null?void 0:l.filter(p=>!p.isIgnored).map(p=>({text:p.text,hint:p.d})),idioms:(d=n.idiomsList)==null?void 0:d.filter(p=>!p.isIgnored).map(p=>({text:p.text,hint:p.d})),paraphrases:(m=n.paraphrases)==null?void 0:m.filter(p=>!p.isIgnored).map(p=>({word:p.word,tone:p.tone,context:p.context}))};return`You are an expert IELTS examiner${s?` working with coach '${s}'`:""}. Design an interactive PRACTICE TEST for: "${n.word}".
    
    DATA: ${JSON.stringify(o)}

    AVAILABLE TAGS:
    - [Select: Correct | Wrong 1 | Wrong 2] (Dropdown)
    - [Multi: Correct | Option 2 | Option 3] (Multiple Choice Buttons)
    - [Quiz: Answer] (Fill-in)

    TASK:
    Generate 5-8 questions covering:
    1. Nuanced collocation choice.
    2. Meaning selection.
    3. Sentence completion with correct word forms.
    4. Synonym selection for specific contexts.

    LANGUAGE: Instructions in ${r}, questions in English.

    Return a JSON object:
    {
      "content": "string (Markdown with interactive tags)"
    }`}const Bk=()=>`Transcribe the text contained in this image exactly as it appears. 
    - Maintain the original language.
    - Do not add introductory or concluding remarks. 
    - If there is no text, return "No text detected."`,Fk=n=>{if(!n)return null;const e=j=>Array.isArray(j)?j.map(V=>typeof V=="string"?{word:V}:V&&(V.w||V.word)?{word:V.w||V.word,isIgnored:V.g??V.isIgnored}:null).filter(V=>V!==null&&!!V.word):[],s=j=>(j==null?void 0:j.map(V=>({word:V.w||V.word,tone:V.t||V.tone,context:V.c||V.context,isIgnored:V.g??V.isIgnored??!1})))||[],r=j=>Array.isArray(j)?j.map(V=>typeof V=="string"?{prep:V.trim(),usage:""}:{prep:(V.p||V.prep||"").trim(),usage:(V.c||V.usage||"").trim(),isIgnored:V.g??V.isIgnored??!1}).filter(V=>V.prep.length>0):[],o=j=>Array.isArray(j)?j.map(B=>{if(typeof B=="string")return{text:B,isIgnored:!1};const H=B.text||B.x;if(H){const G=B.d||B.ds;return{text:H,d:G,isIgnored:B.g??B.isIgnored??!1}}return null}).filter(B=>B!==null&&!!B.text):void 0;let l;Array.isArray(n.prepositionsArray)?l=n.prepositionsArray:Array.isArray(n.prep)&&(l=r(n.prep));const d=n.col||n.collocations;let m,p;Array.isArray(d)?(m=o(d),m&&(p=m.map(j=>j.text).join(`
`))):typeof d=="string"&&(p=d);const y=n.idm||n.idioms;let x;Array.isArray(y)&&(x=o(y));const v=n.hw||n.headword,S=n.pron_sim||n.pronSim||n.ps,N=n.ipa_us||n.ipaUs||n.ipa||n.i,P=n.type,M={isIdiom:P==="idiom",isPhrasalVerb:P==="phrasal_verb",isCollocation:P==="collocation",isStandardPhrase:P==="phrase",isIrregular:P==="irregular_verb"};return{original:n.og||n.original||v,headword:v,ipaUs:N,ipaUk:n.ipa_uk||n.ipaUk||(S==="same"?N:void 0),pronSim:S,ipaMistakes:n.ipa_m||n.ipaMistakes||n.im,meaningVi:n.m||n.meaningVi,register:n.reg||n.register,example:n.ex||n.example,collocations:p,collocationsArray:m,idioms:x?x.map(j=>j.text).join(`
`):void 0,idiomsList:x,prepositionString:typeof n.prep=="string"?n.prep:void 0,prepositionsArray:l,isIdiom:P?M.isIdiom:n.is_id??n.isIdiom,isPhrasalVerb:P?M.isPhrasalVerb:n.is_pv??n.isPhrasalVerb,isCollocation:P?M.isCollocation:n.is_col??n.isCollocation,isStandardPhrase:P?M.isStandardPhrase:n.is_phr??n.isStandardPhrase,isIrregular:P?M.isIrregular:n.is_irr??n.isIrregular,isPassive:n.is_pas??n.isPassive,paraphrases:s(n.para||n.paraphrases),wordFamily:n.fam?{nouns:e(n.fam.n||n.fam.ns||[]),verbs:e(n.fam.v||[]),adjs:e(n.fam.j||[]),advs:e(n.fam.adv||n.fam.d||[])}:n.wordFamily||void 0}},Hk=(n,e)=>{const s=Fk(e);if(!s)return n;const r={...n};r.ipaUs=s.ipaUs??n.ipaUs,r.ipaUk=s.ipaUk??n.ipaUk,r.pronSim=s.pronSim??n.pronSim,r.ipaMistakes=s.ipaMistakes??n.ipaMistakes,r.meaningVi=s.meaningVi??n.meaningVi,r.register=s.register??n.register;let l=[...n.collocationsArray||(n.collocations?n.collocations.split(`
`).map(y=>({text:y.trim(),isIgnored:!1})).filter(y=>y.text):[])];s.collocationsArray&&s.collocationsArray.forEach(y=>{const x=l.findIndex(v=>v.text.toLowerCase()===y.text.toLowerCase());x!==-1?(y.d&&!l[x].d&&(l[x].d=y.d),y.isIgnored&&(l[x].isIgnored=!0)):l.push({text:y.text,d:y.d,isIgnored:y.isIgnored||!1})}),r.collocationsArray=l,r.collocations=l.map(y=>y.text).join(`
`);let m=[...n.idiomsList||(n.idioms?n.idioms.split(`
`).map(y=>({text:y.trim(),isIgnored:!1})).filter(y=>y.text):[])];s.idiomsList&&s.idiomsList.forEach(y=>{const x=m.findIndex(v=>v.text.toLowerCase()===y.text.toLowerCase());x!==-1?(y.d&&!m[x].d&&(m[x].d=y.d),y.isIgnored&&(m[x].isIgnored=!0)):m.push({text:y.text,d:y.d,isIgnored:y.isIgnored||!1})}),r.idiomsList=m,r.idioms=m.map(y=>y.text).join(`
`);let p=n.prepositions||[];if(s.prepositionsArray&&Array.isArray(s.prepositionsArray)&&s.prepositionsArray.length>0){const y=s.prepositionsArray,x=[...p];y.forEach(v=>{v.prep&&(x.some(N=>N.prep.toLowerCase()===v.prep.toLowerCase()&&N.usage.toLowerCase()===v.usage.toLowerCase())||x.push({...v,isIgnored:v.isIgnored||!1}))}),p=x}if(r.prepositions=p.length>0?p:void 0,s.wordFamily&&(r.wordFamily=s.wordFamily),s.paraphrases&&Array.isArray(s.paraphrases)){const y=n.paraphrases||[],x=s.paraphrases,v=[...y];x.forEach(S=>{v.some(N=>N.word.toLowerCase()===S.word.toLowerCase())||v.push(S)}),r.paraphrases=v}if(s.example){let y=n.example||"";y.toLowerCase().includes(s.example.toLowerCase())||(y=y.trim()?`${y}
${s.example}`:s.example),r.example=y}return r.isIdiom=s.isIdiom!==void 0?!!s.isIdiom:n.isIdiom,r.isPhrasalVerb=s.isPhrasalVerb!==void 0?!!s.isPhrasalVerb:n.isPhrasalVerb,r.isCollocation=s.isCollocation!==void 0?!!s.isCollocation:n.isCollocation,r.isStandardPhrase=s.isStandardPhrase!==void 0?!!s.isStandardPhrase:n.isStandardPhrase,r.isIrregular=s.isIrregular!==void 0?!!s.isIrregular:n.isIrregular,r.isPassive=s.isPassive!==void 0?!!s.isPassive:n.isPassive,r.quality=Vt.REFINED,r.complexity=Ra(r),r.masteryScore=_s(r),r.gameEligibility=Ca(r),r.updatedAt=Date.now(),r},O1=({label:n,options:e,selectedId:s,onSelect:r,buttonClass:o,disabled:l=!1})=>{const[d,m]=D.useState(!1),p=D.useRef(null),y=e.find(x=>x.id===s)||e[0];return D.useEffect(()=>{const x=v=>{p.current&&!p.current.contains(v.target)&&m(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),u.jsxs("div",{className:"relative",ref:p,children:[u.jsxs("button",{type:"button",onClick:()=>m(!d),className:o,disabled:l,children:[n&&u.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-neutral-400",children:n}),y.icon,u.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:y.label}),u.jsx(NE,{size:14,className:`transition-transform duration-200 ${d?"rotate-180":""}`})]}),d&&!l&&u.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-2xl shadow-xl border border-neutral-100 z-50 p-2 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col gap-1",children:e.map(x=>u.jsxs("button",{type:"button",onClick:()=>{r(x.id),m(!1)},className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-xs font-bold transition-colors ${s===x.id?"bg-neutral-100 text-neutral-900":"text-neutral-600 hover:bg-neutral-50 hover:text-neutral-900"}`,children:[x.icon,u.jsx("span",{children:x.label})]},x.id))})]})},al=({title:n,items:e,onUpdate:s,onToggleIgnore:r,onRemove:o,onAdd:l,placeholders:d,showDescription:m=!1})=>u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:n}),u.jsxs("div",{className:"space-y-2 p-3 bg-neutral-50 border border-neutral-200 rounded-2xl",children:[(e||[]).map((p,y)=>u.jsxs("div",{className:`bg-white p-2 rounded-lg border border-neutral-100 flex items-start gap-2 group transition-opacity ${p.isIgnored?"opacity-50":""}`,children:[u.jsxs("div",{className:"flex-1 space-y-1",children:[u.jsx("div",{className:"flex items-center gap-2",children:u.jsx("input",{type:"text",value:p.text,onChange:x=>s(y,"text",x.target.value),placeholder:d.text,className:"flex-1 px-3 py-2 bg-neutral-50/50 border border-neutral-200 rounded-lg text-xs font-bold focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"})}),m&&u.jsx("input",{type:"text",value:p.d||"",onChange:x=>s(y,"d",x.target.value),placeholder:d.d,className:"w-full px-3 py-1 bg-neutral-50/50 border border-transparent rounded-lg text-[10px] font-medium text-neutral-500 focus:bg-white focus:ring-1 focus:ring-neutral-900 focus:border-neutral-200 outline-none"})]}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("button",{type:"button",onClick:()=>r(y),className:"p-2 text-neutral-400 hover:text-neutral-700 rounded-lg hover:bg-neutral-100",children:p.isIgnored?u.jsx(Pm,{size:14}):u.jsx(tu,{size:14})}),u.jsx("button",{type:"button",onClick:()=>o(y),className:"p-2 text-neutral-400 hover:text-red-500 rounded-lg hover:bg-red-50",children:u.jsx(hn,{size:14})})]})]},y)),u.jsxs("button",{type:"button",onClick:l,className:"w-full text-center py-2 bg-white hover:bg-neutral-100 text-neutral-400 hover:text-neutral-700 rounded-lg text-xs font-bold transition-colors flex items-center justify-center gap-1.5 border border-neutral-200 shadow-sm",children:[u.jsx(Ya,{size:12})," Add"]})]})]}),Gk=n=>{var Y,K,I,A;const{onClose:e,onSwitchToView:s,formData:r,setFormData:o,setFlag:l,familyHandler:d,prepList:m,collocList:p,idiomList:y,paraList:x,handleSubmit:v,onOpenAiRefine:S,onSuggestLearn:N,hasSuggestions:P}=n,[M,j]=D.useState("MAIN"),V=[{id:"MAIN",label:"Main",icon:Y2},{id:"DETAILS",label:"Details",icon:PE},{id:"CONNECTIONS",label:"Links",icon:zE},{id:"USAGE",label:"Usage & Test",icon:rf}],B=[{id:Vt.RAW,label:"Raw",icon:u.jsx(LE,{size:14,className:"text-neutral-400"})},{id:Vt.REFINED,label:"Refined",icon:u.jsx($E,{size:14,className:"text-indigo-500"})},{id:Vt.VERIFIED,label:"Verified",icon:u.jsx(HE,{size:14,className:"text-emerald-500"})},{id:Vt.FAILED,label:"Incorrect",icon:u.jsx(GE,{size:14,className:"text-rose-500"})}],H=[{id:"NEW",label:"New",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"})},{id:Ct.LEARNED,label:"Learned",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-cyan-500"})},{id:Ct.FORGOT,label:"Forgot",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-rose-500"})},{id:Ct.HARD,label:"Hard",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"})},{id:Ct.EASY,label:"Easy",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}],G=["intensified","softened","synonym","academic","casual"];return u.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-4xl rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[95vh]",children:[u.jsxs("header",{className:"px-6 py-4 border-b border-neutral-100 flex flex-col gap-4 shrink-0 bg-white/80 backdrop-blur-sm z-10",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("button",{onClick:s,className:"p-2 bg-neutral-100 hover:bg-neutral-200 rounded-lg text-neutral-500 transition-colors",children:u.jsx(AE,{size:16})}),u.jsx("h3",{className:"font-black text-lg text-neutral-900 leading-none",children:"Edit Word"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{type:"button",onClick:N,title:P?"View Suggestions":"Get Learning Suggestions",className:`px-3 py-2 border rounded-lg font-black text-[10px] flex items-center justify-center space-x-1.5 hover:bg-neutral-50 active:scale-95 transition-all shadow-sm ${P?"bg-amber-50 border-amber-200 text-amber-700":"bg-white border-neutral-200 text-neutral-600"}`,children:[u.jsx(Cg,{size:12,className:P?"text-amber-500":"text-neutral-400"}),u.jsx("span",{children:P?"View Suggestion":"Suggest"})]}),u.jsxs("button",{type:"button",onClick:S,className:"px-3 py-2 bg-white border border-neutral-200 text-neutral-600 rounded-lg font-black text-[10px] flex items-center justify-center space-x-1.5 hover:bg-neutral-50 active:scale-95 transition-all shadow-sm",children:[u.jsx(Tl,{size:12,className:"text-amber-500"}),u.jsx("span",{children:"Manual AI"})]}),u.jsxs("button",{type:"button",onClick:()=>v(),className:"px-5 py-2 bg-neutral-900 text-white rounded-lg font-black text-[10px] flex items-center justify-center space-x-1.5 hover:bg-neutral-800 active:scale-95 transition-all shadow-md shadow-neutral-900/10",children:[u.jsx(FE,{size:12}),u.jsx("span",{children:"Save"})]}),u.jsx("button",{onClick:e,className:"p-2 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 rounded-full transition-colors ml-2",children:u.jsx(hn,{size:18})})]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[u.jsx("div",{className:"flex bg-neutral-100 p-1 rounded-xl w-fit",children:V.map(({id:_,label:C,icon:R})=>u.jsxs("button",{onClick:()=>j(_),className:`px-4 py-2 text-xs font-black rounded-lg transition-all flex items-center gap-2 ${M===_?"bg-white shadow-sm text-neutral-900":"text-neutral-500 hover:text-neutral-800"}`,children:[u.jsx(R,{size:14})," ",C]},_))}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(O1,{label:"Quality",options:B,selectedId:r.quality,onSelect:_=>o("quality",_),buttonClass:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg hover:bg-neutral-100 transition-colors shadow-sm border border-neutral-200"}),u.jsx(O1,{label:"Learn Status",options:H,selectedId:r.studiedStatus,onSelect:_=>o("studiedStatus",_),buttonClass:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg hover:bg-neutral-100 transition-colors shadow-sm border border-neutral-200"})]})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto no-scrollbar bg-neutral-50/50",children:u.jsxs("div",{className:"p-6 space-y-6",children:[M==="MAIN"&&u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Headword"}),u.jsx("input",{type:"text",value:r.word,onChange:_=>o("word",_.target.value),className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-lg font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Primary IPA / US"}),u.jsx("input",{type:"text",value:r.ipaUs||"",onChange:_=>o("ipaUs",_.target.value),placeholder:"/.../",className:"w-full px-4 py-2 bg-white border border-neutral-200 rounded-xl font-mono text-base text-neutral-600 focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"IPA UK (Optional)"}),u.jsx("input",{type:"text",value:r.ipaUk||"",onChange:_=>o("ipaUk",_.target.value),placeholder:"/.../",className:"w-full px-4 py-2 bg-white border border-neutral-200 rounded-xl font-mono text-base text-neutral-600 focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Pronunciation Similarity"}),u.jsx("div",{className:"flex bg-neutral-100 p-1 rounded-xl w-full",children:["same","near","different"].map(_=>u.jsx("button",{type:"button",onClick:()=>o("pronSim",_),className:`flex-1 px-4 py-2 text-xs font-black rounded-lg transition-all flex items-center justify-center gap-2 ${r.pronSim===_?"bg-white shadow-sm text-neutral-900":"text-neutral-500 hover:text-neutral-800"}`,children:_.charAt(0).toUpperCase()+_.slice(1)},_))})]})]}),u.jsxs("div",{className:"md:col-span-2 space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Definition / Meaning"}),u.jsx("input",{type:"text",value:r.meaningVi,onChange:_=>o("meaningVi",_.target.value),className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-base font-medium focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"md:col-span-2 space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Examples"}),u.jsx("textarea",{rows:5,value:r.example,onChange:_=>o("example",_.target.value),className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm leading-relaxed resize-y focus:ring-2 focus:ring-neutral-900 outline-none"})]})]}),M==="DETAILS"&&u.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Flags"}),u.jsx("div",{className:"flex flex-wrap gap-2 p-3 bg-white border border-neutral-200 rounded-2xl",children:[{id:"isIdiom",label:"Idiom",icon:Tf},{id:"isCollocation",label:"Colloc.",icon:Sf},{id:"isStandardPhrase",label:"Phrase",icon:Rg},{id:"isPhrasalVerb",label:"Phrasal",icon:VE},{id:"isIrregular",label:"Irregular",icon:mI},{id:"isPassive",label:"Archive",icon:r.isPassive?H2:jg}].map(_=>u.jsxs("button",{type:"button",onClick:()=>l(_.id),className:`flex items-center space-x-1.5 py-1.5 px-3 rounded-lg border transition-all font-bold text-[9px] uppercase tracking-wider ${r[_.id]?"bg-neutral-900 border-neutral-900 text-white shadow-sm":"bg-white border-neutral-200 text-neutral-500 hover:border-neutral-300"}`,children:[u.jsx(_.icon,{size:10}),u.jsx("span",{children:_.label})]},_.id))})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center",children:[u.jsx(NI,{size:10,className:"mr-1"}),"User Groups"]}),u.jsx("input",{type:"text",value:r.groupsString,onChange:_=>o("groupsString",_.target.value),placeholder:"bird_species, env_academic...",className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm focus:ring-1 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"md:col-span-2 space-y-1",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Register"}),u.jsx("div",{className:"flex bg-neutral-100 p-1 rounded-xl w-fit",children:["raw","neutral","academic","casual"].map(_=>u.jsx("button",{type:"button",onClick:()=>o("register",_),className:`px-4 py-2 text-xs font-black rounded-lg transition-all flex items-center gap-2 ${r.register===_||!r.register&&_==="raw"?"bg-white shadow-sm text-neutral-900":"text-neutral-500 hover:text-neutral-800"}`,children:_.charAt(0).toUpperCase()+_.slice(1)},_))})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center",children:[u.jsx(Ig,{size:10,className:"mr-1"})," Prepositions / Patterns"]}),u.jsxs("div",{className:"space-y-2 p-3 bg-white border border-neutral-200 rounded-2xl",children:[r.prepositionsList.map((_,C)=>u.jsxs("div",{className:`flex items-center gap-2 transition-opacity ${_.isIgnored?"opacity-40":""}`,children:[u.jsx("input",{type:"text",value:_.prep,onChange:R=>m.update(C,{prep:R.target.value}),placeholder:"Prep",className:"w-24 px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-bold focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"}),u.jsx("input",{type:"text",value:_.usage,onChange:R=>m.update(C,{usage:R.target.value}),placeholder:"Usage Context",className:"flex-1 px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-medium focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"}),u.jsx("button",{type:"button",onClick:()=>m.toggleIgnore(C),className:"p-2 text-neutral-400 hover:text-neutral-700 rounded-lg hover:bg-neutral-100",children:_.isIgnored?u.jsx(Pm,{size:14}):u.jsx(tu,{size:14})}),u.jsx("button",{type:"button",onClick:()=>m.remove(C),className:"p-2 text-neutral-400 hover:text-red-500 rounded-lg hover:bg-red-50",children:u.jsx(hn,{size:14})})]},C)),u.jsxs("button",{type:"button",onClick:()=>m.add({prep:"",usage:"",isIgnored:!1}),className:"w-full text-center py-2 bg-neutral-50 hover:bg-neutral-100 text-neutral-400 hover:text-neutral-700 rounded-lg text-xs font-bold transition-colors flex items-center justify-center gap-1.5 border border-neutral-200 shadow-sm",children:[u.jsx(Ya,{size:12})," Add Pattern"]})]})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center",children:[u.jsx(EI,{size:10,className:"mr-1"})," Private Note"]}),u.jsx("textarea",{rows:3,value:r.note,onChange:_=>o("note",_.target.value),className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm text-neutral-600 resize-y focus:ring-1 focus:ring-neutral-900 outline-none"})]})]}),M==="CONNECTIONS"&&u.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[u.jsx(al,{title:"Collocations",items:r.collocationsArray,onUpdate:(_,C,R)=>p.update(_,{[C]:R}),onToggleIgnore:p.toggleIgnore,onRemove:p.remove,onAdd:()=>p.add({text:"",d:"",isIgnored:!1}),placeholders:{text:"Collocation phrase...",d:"Descriptive hint..."},showDescription:!0}),u.jsx(al,{title:"Related Idioms",items:r.idiomsList,onUpdate:(_,C,R)=>y.update(_,{[C]:R}),onToggleIgnore:y.toggleIgnore,onRemove:y.remove,onAdd:()=>y.add({text:"",d:"",isIgnored:!1}),placeholders:{text:"Idiom or phrase...",d:"Descriptive hint..."},showDescription:!0}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Word Family"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(al,{title:"Nouns",items:(((Y=r.wordFamily)==null?void 0:Y.nouns)||[]).map(_=>({text:_.word,isIgnored:_.isIgnored})),onUpdate:(_,C,R)=>{C==="text"&&d("nouns").update(_,"word",R)},onToggleIgnore:d("nouns").toggleIgnore,onRemove:d("nouns").remove,onAdd:d("nouns").add,placeholders:{text:"Noun form..."}}),u.jsx(al,{title:"Verbs",items:(((K=r.wordFamily)==null?void 0:K.verbs)||[]).map(_=>({text:_.word,isIgnored:_.isIgnored})),onUpdate:(_,C,R)=>{C==="text"&&d("verbs").update(_,"word",R)},onToggleIgnore:d("verbs").toggleIgnore,onRemove:d("verbs").remove,onAdd:d("verbs").add,placeholders:{text:"Verb form..."}}),u.jsx(al,{title:"Adjectives",items:(((I=r.wordFamily)==null?void 0:I.adjs)||[]).map(_=>({text:_.word,isIgnored:_.isIgnored})),onUpdate:(_,C,R)=>{C==="text"&&d("adjs").update(_,"word",R)},onToggleIgnore:d("adjs").toggleIgnore,onRemove:d("adjs").remove,onAdd:d("adjs").add,placeholders:{text:"Adjective form..."}}),u.jsx(al,{title:"Adverbs",items:(((A=r.wordFamily)==null?void 0:A.advs)||[]).map(_=>({text:_.word,isIgnored:_.isIgnored})),onUpdate:(_,C,R)=>{C==="text"&&d("advs").update(_,"word",R)},onToggleIgnore:d("advs").toggleIgnore,onRemove:d("advs").remove,onAdd:d("advs").add,placeholders:{text:"Adverb form..."}})]})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Nf,{size:10,className:"text-amber-500"})," Word Power & Variations"]}),u.jsxs("div",{className:"space-y-2 p-3 bg-white border border-neutral-200 rounded-2xl",children:[(r.paraphrases||[]).map((_,C)=>u.jsxs("div",{className:`grid grid-cols-[1fr,auto,1fr,auto,auto] items-center gap-2 transition-opacity ${_.isIgnored?"opacity-40":""}`,children:[u.jsx("input",{type:"text",value:_.word,onChange:R=>x.update(C,{word:R.target.value}),placeholder:"Variation...",className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-bold focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"}),u.jsx("select",{value:_.tone,onChange:R=>x.update(C,{tone:R.target.value}),className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-bold focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none appearance-none",children:G.map(R=>u.jsx("option",{value:R,children:R.charAt(0).toUpperCase()+R.slice(1)},R))}),u.jsx("input",{type:"text",value:_.context,onChange:R=>x.update(C,{context:R.target.value}),placeholder:"Context...",className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-medium focus:bg-white focus:ring-1 focus:ring-neutral-900 outline-none"}),u.jsx("button",{type:"button",onClick:()=>x.toggleIgnore(C),className:"p-2 text-neutral-400 hover:text-neutral-700 rounded-lg hover:bg-neutral-100",children:_.isIgnored?u.jsx(Pm,{size:14}):u.jsx(tu,{size:14})}),u.jsx("button",{type:"button",onClick:()=>x.remove(C),className:"p-2 text-neutral-400 hover:text-red-500 rounded-lg hover:bg-red-50",children:u.jsx(hn,{size:14})})]},C)),u.jsxs("button",{type:"button",onClick:()=>x.add({word:"",context:"",tone:"synonym",isIgnored:!1}),className:"w-full text-center py-2 bg-neutral-50 hover:bg-neutral-100 text-neutral-400 hover:text-neutral-700 rounded-lg text-xs font-bold transition-colors flex items-center justify-center gap-1.5 border border-neutral-200 shadow-sm",children:[u.jsx(Ya,{size:12})," Add Variation"]})]})]})]}),M==="USAGE"&&u.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300 h-full flex flex-col",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"flex justify-between items-center px-1",children:u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[u.jsx(rf,{size:12})," Usage Guide (Markdown)"]})}),u.jsx("textarea",{value:r.essayEdit,onChange:_=>o("essayEdit",_.target.value),rows:12,className:"w-full p-4 bg-white border border-neutral-200 rounded-2xl font-mono text-xs leading-relaxed focus:ring-2 focus:ring-neutral-900 outline-none resize-y",placeholder:"Enter the Usage Guide Markdown content here..."})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"flex justify-between items-center px-1",children:u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[u.jsx(Um,{size:12})," Practice Test (Markdown)"]})}),u.jsx("textarea",{value:r.testEdit,onChange:_=>o("testEdit",_.target.value),rows:12,className:"w-full p-4 bg-white border border-neutral-200 rounded-2xl font-mono text-xs leading-relaxed focus:ring-2 focus:ring-neutral-900 outline-none resize-y",placeholder:"Enter the Practice Test Markdown content here..."})]})]})]})})]})})};async function Hf(n){if(navigator.clipboard&&navigator.clipboard.writeText)try{return await navigator.clipboard.writeText(n),!0}catch{console.warn("Clipboard API failed, trying fallback strategy")}try{const e=document.createElement("textarea");e.value=n,e.style.position="fixed",e.style.left="-9999px",e.style.top="0",document.body.appendChild(e),e.focus(),e.select();const s=document.execCommand("copy");return document.body.removeChild(e),s}catch(e){return console.error("Copy failed",e),!1}}const qk=n=>n?n.split(/[;\n\r\t,]+/).map(e=>e.trim()).filter(Boolean):[],rM=n=>{const e=new Map;return n&&qk(n).forEach(r=>{const o=r.split(":").map(m=>m.trim()),l=o[0],d=o.length>1?o[1]:o[0];if(l&&d){const m=l.toLowerCase(),p=d.toLowerCase();e.set(m,p),e.has(p)||e.set(p,p)}}),e},iM=n=>{const e=Array.from(n.keys()).sort((r,o)=>o.length-r.length);if(e.length===0)return null;const s=e.map(r=>r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"));return new RegExp(`\\b(${s.join("|")})\\b`,"gi")},bg=({isOpen:n,onClose:e,type:s,title:r,description:o,initialData:l,onGeneratePrompt:d,onJsonReceived:m,hidePrimaryInput:p=!1,closeOnSuccess:y=!1})=>{const[x,v]=D.useState(""),[S,N]=D.useState(""),[P,M]=D.useState(""),[j,V]=D.useState(""),[B,H]=D.useState("CASUAL"),[G,Y]=D.useState(""),[K,I]=D.useState(Vm.VARIETY),[A,_]=D.useState(""),[C,R]=D.useState("Adult"),[L,O]=D.useState("English"),[xe,ge]=D.useState("friendly_elementary"),[F,ue]=D.useState(""),[ae,X]=D.useState(""),[Q,T]=D.useState(null),[z,$]=D.useState(!1),[J,pe]=D.useState(!1),[de,_e]=D.useState(!1),[W,le]=D.useState(""),ie=D.useRef(null),he=D.useRef(void 0),Ie=["GENERATE_LESSON","GENERATE_WORD_LESSON","GENERATE_AUDIO_SCRIPT"].includes(s);if(D.useEffect(()=>{if(n&&!he.current){if(v(""),N(""),M(""),V(""),H("CASUAL"),Y(""),I(Vm.VARIETY),ue(""),s==="REFINE_WORDS"&&(l!=null&&l.words)){const we=l.words.replace(/\n/g,"; ");v(we)}else Ie&&(_(""),R((l==null?void 0:l.targetAudience)||"Adult"),O((l==null?void 0:l.language)||"English"),ge((l==null?void 0:l.tone)||"friendly_elementary"));X(""),T(null),_e(!1),$(!1),pe(!1)}he.current=n},[n,s,l,Ie]),D.useEffect(()=>{let we={};s==="REFINE_WORDS"?we={words:p?l==null?void 0:l.words:x}:s==="REFINE_UNIT"?we={request:S,language:L,targetAudience:C,tone:xe,format:"reading"}:s==="GENERATE_AUDIO_SCRIPT"?we={request:S,language:L,targetAudience:C,tone:xe,format:"listening"}:s==="GENERATE_CHAPTER"?we={request:P}:s==="GENERATE_SEGMENT"?we={request:j}:s==="GENERATE_PARAPHRASE"?we={tone:B,context:G,mode:K}:s==="EVALUATE_PARAPHRASE"?we=l:s==="GENERATE_LESSON"||s==="GENERATE_WORD_LESSON"?we={topic:A,language:L,targetAudience:C,tone:xe,format:"reading"}:s==="GENERATE_UNIT"?we={request:S}:s==="GENERATE_PLAN"&&(we={request:F}),le(d(we))},[s,x,S,P,j,B,G,K,l,p,A,C,L,xe,F,d]),!n)return null;const Ue=async()=>{await Hf(W),_e(!0),setTimeout(()=>_e(!1),2e3),setTimeout(()=>{var we;return(we=ie.current)==null?void 0:we.focus()},100)},je=async()=>{z||!ae.trim()||(T(null),$(!0),setTimeout(async()=>{try{let we=ae.trim();we=we.replace(/^```json\s*/,"").replace(/^```\s*/,"").replace(/\s*```$/,"");let rt;try{rt=JSON.parse(we)}catch{try{we=we.replace(/,\s*([}\]])/g,"$1"),rt=JSON.parse(we)}catch(Qe){throw new Error("Cannot read AI response. Please ensure you copied the full code.",{cause:Qe})}}Ie?await m({result:rt,preferences:{language:L,targetAudience:C,tone:xe}}):await m(rt),y?e():($(!1),pe(!0))}catch(we){console.error(we),$(!1),T(we.message||"Failed to process.")}},50))},wt=we=>{we.key==="Enter"&&(we.metaKey||we.ctrlKey)&&(we.preventDefault(),je())},Re=()=>u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[u.jsx(ME,{size:10})," Language"]}),u.jsxs("select",{value:L,onChange:we=>O(we.target.value),className:"w-full px-3 py-2 bg-white border border-neutral-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none appearance-none cursor-pointer",children:[u.jsx("option",{value:"English",children:"English"}),u.jsx("option",{value:"Vietnamese",children:"Vietnamese"})]})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[u.jsx(SI,{size:10})," Audience"]}),u.jsxs("select",{value:C,onChange:we=>R(we.target.value),className:"w-full px-3 py-2 bg-white border border-neutral-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none appearance-none cursor-pointer",children:[u.jsx("option",{value:"Adult",children:"Adult"}),u.jsx("option",{value:"Kid",children:"Kid"})]})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[u.jsx(pI,{size:10})," Persona"]}),u.jsxs("select",{value:xe,onChange:we=>ge(we.target.value),className:"w-full px-3 py-2 bg-white border border-neutral-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none appearance-none cursor-pointer",children:[u.jsx("option",{value:"friendly_elementary",children:"Friendly"}),u.jsx("option",{value:"professional_professor",children:"Professional"})]})]})]});return u.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center p-4 bg-white/10 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl flex flex-col overflow-hidden border border-neutral-200 relative ring-4 ring-neutral-100",children:[u.jsx("button",{onClick:e,disabled:z,className:"absolute top-4 right-4 p-2 text-neutral-300 hover:text-neutral-900 hover:bg-neutral-50 rounded-full transition-all z-10 disabled:opacity-0",children:u.jsx(hn,{size:18})}),u.jsxs("div",{className:"p-6 md:p-8 flex flex-col gap-6",children:[u.jsxs("div",{className:"space-y-1 pr-8",children:[u.jsxs("div",{className:"flex items-center gap-2 text-neutral-900",children:[u.jsx("div",{className:"p-1.5 bg-neutral-900 rounded-lg text-white",children:u.jsx(Tl,{size:14})}),u.jsx("h3",{className:"font-black text-lg tracking-tight",children:r})]}),u.jsx("p",{className:"text-xs font-medium text-neutral-400 pl-9",children:o})]}),u.jsxs("div",{className:"py-2 space-y-4",children:[!p&&s==="REFINE_WORDS"&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Vocabulary List"}),u.jsx("textarea",{value:x,onChange:we=>v(we.target.value),disabled:z||J,className:"w-full h-32 p-4 bg-neutral-50/50 border border-neutral-200 rounded-2xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none resize-none shadow-inner leading-relaxed transition-all focus:bg-white disabled:opacity-50",placeholder:"word1; word2; word3..."}),u.jsx("p",{className:"text-[9px] text-neutral-400 px-2 text-right",children:"Edit freely. Separated by semicolon (;) or newline."})]}),["REFINE_UNIT","GENERATE_AUDIO_SCRIPT"].includes(s)&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Your Instructions"}),u.jsx("textarea",{value:S,onChange:we=>N(we.target.value),disabled:z||J,placeholder:s==="GENERATE_AUDIO_SCRIPT"?'e.g., "Focus on the definition of key terms"':'e.g., "Add more advanced vocabulary and examples."',className:"w-full h-24 p-4 bg-neutral-50/50 border border-neutral-200 rounded-2xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none resize-none transition-all focus:bg-white disabled:opacity-50"})]}),(s==="GENERATE_LESSON"||s==="GENERATE_WORD_LESSON")&&u.jsx(u.Fragment,{children:u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[u.jsx(wf,{size:10})," Topic"]}),u.jsx("input",{value:A,onChange:we=>_(we.target.value),placeholder:"e.g. Present Perfect Tense, Space Travel",className:"w-full px-4 py-2 bg-neutral-50/50 border border-neutral-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]})}),Ie&&Re(),s==="GENERATE_UNIT"&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Topic or Request"}),u.jsx("input",{value:S,onChange:we=>N(we.target.value),disabled:z||J,placeholder:'e.g., "Trees", "Technology", "The Ocean"',className:"w-full px-4 py-3 bg-neutral-50/50 border border-neutral-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]}),s==="GENERATE_PLAN"&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"What is your goal?"}),u.jsx("textarea",{value:F,onChange:we=>ue(we.target.value),disabled:z||J,placeholder:'e.g., "Prepare for IELTS in 30 days focusing on academic writing"',className:"w-full h-24 p-4 bg-neutral-50/50 border border-neutral-200 rounded-2xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none resize-none transition-all focus:bg-white disabled:opacity-50"})]})]}),u.jsxs("div",{className:"space-y-3 pt-4 border-t border-neutral-100",children:[u.jsx("div",{className:"space-y-2",children:u.jsx("button",{onClick:Ue,disabled:z||J,className:`w-full py-3 px-4 rounded-xl font-bold text-xs flex items-center justify-between transition-all group ${de?"bg-green-50 text-green-700 border border-green-200":"bg-neutral-50 text-neutral-600 border border-neutral-200 hover:border-neutral-300 hover:bg-white"} disabled:opacity-50`,children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:`p-1.5 rounded-md ${de?"bg-green-200 text-green-800":"bg-white text-neutral-400 shadow-sm"}`,children:de?u.jsx(wl,{size:14}):u.jsx(eI,{size:14})}),u.jsx("span",{className:"uppercase tracking-widest text-[10px]",children:de?"Command Copied":"Step 1: Copy Command"})]})})}),u.jsxs("div",{className:`relative flex items-start gap-2 p-1.5 rounded-2xl border-2 transition-all ${Q?"border-red-100 bg-red-50/30":J?"border-green-200 bg-green-50":"border-neutral-100 bg-white focus-within:border-neutral-900 focus-within:shadow-md"}`,children:[u.jsx("div",{className:"pl-3 py-3 shrink-0",children:J?u.jsx(wl,{size:18,className:"text-green-600"}):u.jsx(Q2,{size:18,className:Q?"text-red-400":"text-neutral-400"})}),u.jsx("textarea",{ref:ie,value:J?"Data applied! Success.":ae,onChange:we=>{X(we.target.value),T(null)},onKeyDown:wt,disabled:z||J,placeholder:z?"Processing data...":"Step 2: Paste AI response...",className:`w-full bg-transparent border-none text-xs font-medium placeholder:text-neutral-400 focus:ring-0 outline-none resize-none min-h-[70px] p-2 ${J?"text-green-700 font-bold":"text-neutral-800"}`,rows:3,autoComplete:"off"}),u.jsx("button",{onClick:je,disabled:!ae.trim()||z,className:"p-2.5 rounded-xl transition-all shadow-md active:scale-90 flex items-center justify-center w-10 h-10 self-end bg-neutral-900 text-white hover:bg-neutral-800 disabled:opacity-20 disabled:scale-95",children:z?u.jsx(Kt,{size:16,className:"animate-spin"}):u.jsx(tI,{size:16})})]})]})]})]})})},Hd=({title:n,icon:e,suggestions:s})=>!s||s.length===0?null:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("h4",{className:"text-xs font-black uppercase tracking-widest text-neutral-500 flex items-center gap-2 border-b border-neutral-200 pb-2",children:[e,n]}),u.jsx("ul",{className:"space-y-3",children:s.map((r,o)=>u.jsxs("li",{className:"flex items-start gap-3",children:[r.suggestion==="learn"?u.jsx(wl,{size:16,className:"text-green-500 shrink-0 mt-0.5"}):u.jsx(X2,{size:16,className:"text-neutral-400 shrink-0 mt-0.5"}),u.jsxs("div",{children:[u.jsx("p",{className:`font-bold text-sm ${r.suggestion==="ignore"?"text-neutral-500":"text-neutral-900"}`,children:r.item}),u.jsxs("p",{className:"text-xs text-neutral-600 italic",children:['"',r.reason,'"']})]})]},o))})]}),$k=({isOpen:n,onClose:e,suggestions:s})=>!n||!s?null:u.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col max-h-[90vh]",children:[u.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-start shrink-0",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-xl font-black text-neutral-900 flex items-center gap-2",children:[u.jsx(Cg,{size:20,className:"text-amber-500"})," Learning Suggestions"]}),u.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:s.overall_summary})]}),u.jsx("button",{type:"button",onClick:e,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:u.jsx(hn,{size:20})})]}),u.jsxs("main",{className:"p-8 overflow-y-auto space-y-6",children:[u.jsx(Hd,{title:"Word Family",icon:u.jsx(wf,{size:14}),suggestions:s.wordFamily}),u.jsx(Hd,{title:"Collocations",icon:u.jsx(Sf,{size:14}),suggestions:s.collocations}),u.jsx(Hd,{title:"Idioms",icon:u.jsx(Tf,{size:14}),suggestions:s.idioms}),u.jsx(Hd,{title:"Paraphrases (Word Power)",icon:u.jsx(Nf,{size:14}),suggestions:s.paraphrases})]})]})});function j1(n,e){var s,r,o;switch(e.type){case"REINITIALIZE":const l=e.payload;return{...l,register:l.register||"raw",groupsString:((s=l.groups)==null?void 0:s.join(", "))||"",studiedStatus:l.lastReview&&l.lastGrade||"NEW",collocationsArray:l.collocationsArray||(l.collocations?l.collocations.split(`
`).map(y=>({text:y.trim(),isIgnored:!1})):[]),idiomsList:l.idiomsList||(l.idioms?l.idioms.split(`
`).map(y=>({text:y.trim(),isIgnored:!1})):[]),prepositionsList:l.prepositions||[],wordFamily:l.wordFamily||{nouns:[],verbs:[],adjs:[],advs:[]},paraphrases:l.paraphrases||[],essayEdit:((r=l.lesson)==null?void 0:r.essay)||"",testEdit:((o=l.lesson)==null?void 0:o.test)||""};case"SET_FIELD":return{...n,[e.payload.field]:e.payload.value};case"SET_FLAG":const{flag:d}=e.payload,m={...n,[d]:!n[d]};return["isIdiom","isPhrasalVerb","isCollocation","isStandardPhrase"].includes(d)&&m[d]&&(d!=="isIdiom"&&(m.isIdiom=!1),d!=="isPhrasalVerb"&&(m.isPhrasalVerb=!1),d!=="isCollocation"&&(m.isCollocation=!1),d!=="isStandardPhrase"&&(m.isStandardPhrase=!1)),m;case"SET_LIST_ITEM":return{...n,[e.payload.list]:e.payload.data};case"APPLY_AI_MERGE":const p=Hk(n,e.payload);return{...n,...p,register:p.register,prepositionsList:p.prepositions||[]};default:return n}}const Yk=({word:n,user:e,onSave:s,onClose:r,onSwitchToView:o})=>{const{showToast:l}=Za(),[d,m]=D.useReducer(j1,n,L=>j1({},{type:"REINITIALIZE",payload:L})),[p,y]=D.useState(!1),[x,v]=D.useState(null),[S,N]=D.useState(!1),[P,M]=D.useState(!1);D.useEffect(()=>{m({type:"REINITIALIZE",payload:n}),v(null)},[n]);const j=L=>Dk(L.words.split(/[,\n]+/).map(O=>O.trim()).filter(Boolean),e.nativeLanguage||"Vietnamese"),V=L=>{const O=Array.isArray(L)?L[0]:L;O&&(m({type:"APPLY_AI_MERGE",payload:O}),y(!1))},B=()=>{x?N(!0):M(!0)},H=L=>Pk(d,e),G=L=>{L&&L.overall_summary?(v(L),M(!1),N(!0)):l("Invalid suggestion format from AI.","error")},Y=L=>{L&&L.preventDefault();const{groupsString:O,studiedStatus:xe,collocationsArray:ge,idiomsList:F,prepositionsList:ue,essayEdit:ae,testEdit:X,...Q}=d;let T=Q.wordFamily;if(T){const ie={};let he=!1;["nouns","verbs","adjs","advs"].forEach(Ie=>{var je;const Ue=((je=T[Ie])==null?void 0:je.filter(wt=>wt.word.trim()))||[];Ue.length>0&&(ie[Ie]=Ue,he=!0)}),T=he?ie:void 0}let z={...Q,wordFamily:T,prepositions:ue.filter(ie=>ie.prep.trim()).length>0?ue.filter(ie=>ie.prep.trim()):void 0,collocationsArray:ge.filter(ie=>ie.text.trim()),collocations:ge.filter(ie=>ie.text.trim()).map(ie=>ie.text).join(`
`),idiomsList:F.filter(ie=>ie.text.trim()),idioms:F.filter(ie=>ie.text.trim()).map(ie=>ie.text).join(`
`),lesson:{essay:ae,test:X},groups:O.split(",").map(ie=>ie.trim()).filter(Boolean),updatedAt:Date.now()};const $={...z.lastTestResults||{}},J=new Set((z.collocationsArray||[]).filter(ie=>!ie.isIgnored).map(ie=>ie.text.toLowerCase())),pe=new Set((z.idiomsList||[]).filter(ie=>!ie.isIgnored).map(ie=>ie.text.toLowerCase())),de=new Set((z.prepositions||[]).filter(ie=>!ie.isIgnored).map(ie=>ie.prep.toLowerCase())),_e=new Set((z.paraphrases||[]).filter(ie=>!ie.isIgnored).map(ie=>ie.word.toLowerCase())),W=new Set;z.wordFamily&&["nouns","verbs","adjs","advs"].forEach(ie=>{(z.wordFamily[ie]||[]).forEach(he=>{!he.isIgnored&&he.word.trim()&&W.add(he.word.trim().toLowerCase())})});for(const ie in $){const he=ie.split(":"),Ie=he[0],Ue=he.slice(1).join(":").toLowerCase();let je=!1;switch(Ie){case"COLLOCATION_QUIZ":J.has(Ue)||(je=!0);break;case"IDIOM_QUIZ":pe.has(Ue)||(je=!0);break;case"PREPOSITION_QUIZ":de.has(Ue)||(je=!0);break;case"PARAPHRASE_QUIZ":_e.has(Ue)||(je=!0);break;case"WORD_FAMILY":W.has(Ue)||(je=!0);break}je&&delete $[ie]}z.lastTestResults=$;const le=n.lastReview&&n.lastGrade||"NEW";xe!==le?xe==="NEW"?z=$w(z):z=qw(z,xe):(z.complexity=Ra(z),z.masteryScore=_s(z),z.gameEligibility=Ca(z)),s(z),l("Word saved successfully!","success")},K=L=>{const O=d[L]||[];return{update:(xe,ge)=>m({type:"SET_LIST_ITEM",payload:{list:L,data:[...O].map((F,ue)=>ue===xe?{...F,...ge}:F)}}),toggleIgnore:xe=>m({type:"SET_LIST_ITEM",payload:{list:L,data:[...O].map((ge,F)=>F===xe?{...ge,isIgnored:!ge.isIgnored}:ge)}}),remove:xe=>m({type:"SET_LIST_ITEM",payload:{list:L,data:O.filter((ge,F)=>F!==xe)}}),add:xe=>m({type:"SET_LIST_ITEM",payload:{list:L,data:[...O,xe]}})}},I=L=>{const O=d.wordFamily||{nouns:[],verbs:[],adjs:[],advs:[]},xe=ge=>m({type:"SET_LIST_ITEM",payload:{list:"wordFamily",data:{...O,...ge}}});return{update:(ge,F,ue)=>{const ae=[...O[L]||[]];ae[ge]={...ae[ge],[F]:ue},xe({[L]:ae})},toggleIgnore:ge=>{const F=[...O[L]||[]];F[ge]={...F[ge],isIgnored:!F[ge].isIgnored},xe({[L]:F})},remove:ge=>{xe({[L]:(O[L]||[]).filter((F,ue)=>ue!==ge)})},add:()=>{const ge={word:"",isIgnored:L==="advs"};xe({[L]:[...O[L]||[],ge]})}}},A=K("prepositionsList"),_=K("collocationsArray"),C=K("idiomsList"),R=K("paraphrases");return u.jsxs(u.Fragment,{children:[u.jsx(Gk,{onClose:r,onSwitchToView:()=>o(n),formData:d,setFormData:(L,O)=>m({type:"SET_FIELD",payload:{field:L,value:O}}),setFlag:L=>m({type:"SET_FLAG",payload:{flag:L}}),familyHandler:I,prepList:A,collocList:_,idiomList:C,paraList:R,handleSubmit:Y,onOpenAiRefine:()=>y(!0),onSuggestLearn:B,hasSuggestions:!!x}),u.jsx($k,{isOpen:S,onClose:()=>N(!1),suggestions:x}),p&&u.jsx(bg,{isOpen:p,onClose:()=>y(!1),type:"REFINE_WORDS",title:"Manual AI Refinement",description:`Refining details for "${d.word}"`,initialData:{words:d.word},user:e,onGeneratePrompt:j,onJsonReceived:V,actionLabel:"Apply to Word",hidePrimaryInput:!0}),P&&u.jsx(bg,{isOpen:P,onClose:()=>M(!1),type:"REFINE_WORDS",title:"Get Learning Suggestions",description:"AI will suggest what to focus on based on your profile.",initialData:{words:n.word},user:e,onGeneratePrompt:H,onJsonReceived:G,hidePrimaryInput:!0})]})},Qk=1500;let Qi=[],Gt=null,vf=!1,Nn=!1,S0=[],Uc=null,ks=!1,aa=0,dl=0,ao=1,Wi=null;function Wk(n){const e=n.numberOfChannels,s=n.length*e*2+44,r=new ArrayBuffer(s),o=new DataView(r),l=[];let d,m,p=0,y=0;for(v(1179011410),v(s-8),v(1163280727),v(544501094),v(16),x(1),x(e),v(n.sampleRate),v(n.sampleRate*2*e),x(e*2),x(16),v(1635017060),v(s-y-4),d=0;d<n.numberOfChannels;d++)l.push(n.getChannelData(d));for(;y<s;){for(d=0;d<e;d++)m=Math.max(-1,Math.min(1,l[d][p])),m=(m<0?m*32768:m*32767)|0,o.setInt16(y,m,!0),y+=2;p++}return new Blob([r],{type:"audio/wav"});function x(S){o.setUint16(y,S,!0),y+=2}function v(S){o.setUint32(y,S,!0),y+=4}}const Kk=()=>{Wi=null},T0=async n=>{if(n)return Wi=n.replace(/\/$/,""),Wi;if(Wi)return Wi;const e=Dt();return Wi=Cn(e),Wi};function Zk(){if(typeof window>"u"||!window.speechSynthesis)return;const n=()=>{const e=window.speechSynthesis.getVoices();e&&e.length>0&&(Qi=Array.from(e))};n(),window.speechSynthesis.onvoiceschanged!==void 0&&(window.speechSynthesis.onvoiceschanged=n)}Zk();const Xk=()=>new Promise(n=>{const e=window.speechSynthesis.getVoices();if(e.length>0)Qi=Array.from(e),n(Qi);else{const s=()=>{const r=window.speechSynthesis.getVoices();r.length>0&&(Qi=Array.from(r),n(Qi),window.speechSynthesis.onvoiceschanged=null)};window.speechSynthesis.onvoiceschanged=s,setTimeout(()=>{const r=window.speechSynthesis.getVoices();Qi=Array.from(r),n(Qi)},1e3)}}),Jk=async n=>{try{const s=`${await T0(n)}/voices`,r=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"},signal:AbortSignal.timeout(2e3)});if(!r.ok)throw new Error(`HTTP ${r.status}`);return await r.json()}catch{return null}},Un=n=>{vf=n,window.dispatchEvent(new CustomEvent("audio-status-changed",{detail:{isSpeaking:vf,isAudioPaused:Nn,isSingleWordPlayback:ks}}))},Gf=n=>String(n||"").trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(//g,"d").replace(//g,"D").toLowerCase().replace(/[^a-z0-9'-]/g,""),e4=n=>{if(!n)return null;const e=decodeURIComponent(n);if(!/quality_sound/i.test(e))return null;const o=(e.split("?")[0].split("#")[0].split("/").pop()||"").replace(/\.[a-z0-9]+$/i,"");if(!o)return null;const l=o.replace(/_(N|V|ADJ|ADV|PRO|PREP|CONJ|INTJ|X)_(US|UK)$/i,"").replace(/_(US|UK)$/i,"");return Gf(l)||null},t4=n=>{const e=Gf(n);return e?!/\s/.test(String(n||"").trim())&&e.length>0:!1},Jc=async n=>{const e=Gf(n);if(!e)return!1;if(vu(n)==="vi")return console.log("[VI FLOW] Skip CoachLookup because detected Vietnamese:",n),!1;const r=Dt(),o=Cn(r);try{const l=await fetch(`${o}/api/lookup/cambridge/cache?word=${encodeURIComponent(e)}`,{signal:AbortSignal.timeout(6e3),cache:"no-store"});if(l.ok){const d=await l.text(),m=d?JSON.parse(d):null;if(m!=null&&m.exists)return window.dispatchEvent(new CustomEvent("coach-cambridge-lookup-request",{detail:{word:e,data:m}})),!0}}catch{}try{const l=await fetch(`${o}/api/lookup/cambridge/simple?word=${encodeURIComponent(e)}`,{signal:AbortSignal.timeout(12e3),cache:"no-store"});if(!l.ok)return!1;const d=await l.text(),m=d?JSON.parse(d):null;if(!(m!=null&&m.exists))try{const p=await fetch(`${o}/api/convert/ipa?text=${encodeURIComponent(e)}&mode=2`,{signal:AbortSignal.timeout(6e3),cache:"no-store"});if(!p.ok)return!1;const y=await p.json().catch(()=>null);return y!=null&&y.ipa?(window.dispatchEvent(new CustomEvent("coach-ipa-fallback-request",{detail:{word:e,ipa:y.ipa}})),!0):!1}catch{return!1}return window.dispatchEvent(new CustomEvent("coach-cambridge-lookup-request",{detail:{word:e,data:m}})),!0}catch{return!1}},bu=n=>{aa+=1,dl+=1,Gt&&(Gt.pause(),Gt.src="",Gt=null),typeof window<"u"&&window.speechSynthesis&&window.speechSynthesis.cancel(),Uc=null,ks=!1,Nn=!1,S0=[],n||Un(!1)},bT=()=>{bu(!1)},Pc=()=>vf,Vc=()=>Nn,zc=()=>ks,vT=()=>S0,af=()=>ao,_T=n=>{const e=Number.isFinite(n)?Math.min(2,Math.max(.5,n)):1;ao=Math.round(e*100)/100,Gt&&(Gt.playbackRate=ao),window.dispatchEvent(new CustomEvent("audio-status-changed",{detail:{isSpeaking:vf,isAudioPaused:Nn,isSingleWordPlayback:ks,playbackRate:ao}}))},ET=()=>{!Gt||Gt.paused||(Gt.pause(),Nn=!0,Un(!0))},wT=async()=>{if(!(!Gt||!Gt.paused))try{await Gt.play(),Nn=!1,Un(!0)}catch(n){throw Un(!1),n}},n4=async(n,e)=>{const s=Dt(),r=Cn(s),o=e||vu(n),l=s.audioCoach.activeCoach,d=s.audioCoach.coaches[l],m=o==="vi"?d.viVoice:d.enVoice,p=o==="vi"?d.viAccent:d.enAccent;try{const y=`${r}/speak`,x=await fetch(y,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,language:o,accent:p,voice:m}),signal:AbortSignal.timeout(2e4)});if(x.ok)return await x.blob()}catch(y){console.error("Prefetch failed",y)}return null},ST=(n,e)=>{bu(!0);const s=++aa;Nn=!1,Uc=e!=null&&e.isSingleWord&&(e!=null&&e.word)?e.word:null,ks=!!(e!=null&&e.isSingleWord),Un(!0);const r=Uc,o=r?Jc(r):Promise.resolve(!1),l=URL.createObjectURL(n),d=new Audio(l);return d.playbackRate=ao,Gt=d,new Promise((m,p)=>{d.play().then(()=>{d.onended=()=>{if(s!==aa||Gt!==d){URL.revokeObjectURL(l),m(!0);return}URL.revokeObjectURL(l),Uc=null,Nn=!1,Un(!1),r&&o.then(y=>{y||Jc(r)}),m(!0)}}).catch(y=>{if(s!==aa||Gt!==d){URL.revokeObjectURL(l),m(!1);return}URL.revokeObjectURL(l),Uc=null,ks=!1,Nn=!1,Un(!1),p(y)})})},s4=async(n,e,s,r,o)=>{bu(!0);const l=++dl,d=e==="en"&&t4(n);ks=d,Nn=!1,Un(!0);try{const p=`${await T0(o)}/speak`,x=await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,language:e,accent:s,voice:r}),signal:AbortSignal.timeout(2e4)});if(l!==dl)return!0;if(!x.ok)throw new Error("Server unreachable");const v=x.headers.get("Content-Type");if(v&&v.includes("audio")){const S=await x.blob();if(l!==dl)return!0;const N=x.headers.get("X-TTS-Source")||void 0,P=x.headers.get("X-TTS-Word")||void 0,M=d?Gf(n):void 0;return await ST(S,{source:N,word:P||M,isSingleWord:d})}else return l!==dl||(ks=!1,Nn=!1,Un(!1)),!0}catch(m){if(l!==dl)return!0;throw Nn=!1,Un(!1),m}},a4=(n,e,s="en")=>new Promise(r=>{if(typeof window>"u"||!window.speechSynthesis)return r(!1);bu(!0);const o=++aa;Nn=!1,Un(!0);const l=new SpeechSynthesisUtterance(n);l.lang=s==="vi"?"vi-VN":"en-US";const d=window.speechSynthesis.getVoices(),m=e&&d.find(p=>p.name===e)||d.find(p=>p.lang.startsWith(s));m&&(l.voice=m),l.rate=Math.min(2,Math.max(.5,.95*ao)),l.onend=()=>{if(o!==aa)return r(!0);Nn=!1,Un(!1),r(!0)},l.onerror=()=>{if(o!==aa)return r(!1);Nn=!1,Un(!1),r(!1)},window.speechSynthesis.speak(l)}),vu=n=>/[]/i.test(n)?"vi":"en",r4=n=>n?n.substring(0,Qk).normalize("NFD").replace(/\*+/g,"").replace(//g,", ").replace(/[^a-zA-Z0-9.,!?%'\-\s\u00C0-\u1EF9]/g,"").trim():"",os=async(n,e=!1,s,r,o,l)=>{if(typeof window>"u"||!n)return;const d=r4(n);if(!d)return;if(l)try{await ST(l);return}catch{console.warn("Play preloaded failed, falling back to standard")}const m=Dt(),p=m.audioCoach.activeCoach,y=m.audioCoach.coaches[p],x=Cn(m),v=s||vu(d),S=r!==void 0?r:v==="vi"?y.viVoice:y.enVoice,N=o!==void 0?o:v==="vi"?y.viAccent:y.enAccent;try{await s4(d,v,N,S,x);return}catch{await a4(d,S,v)}},TT=async(n,e,s,r)=>{bu(!0);const o=++aa;S0=r||[];const l=e4(n);ks=!!l;const d=l?Jc(l):Promise.resolve(!1),m=await T0();let p=n;if(!n.startsWith("http")){const x=n.startsWith("/")?n.slice(1):n;x.startsWith("api/")?p=`${m}/${x}`:p=`${m}/api/audio/stream/${x}`}const y=new Audio(p);return y.playbackRate=ao,Gt=y,new Promise((x,v)=>{const S=()=>{if(e!==void 0&&(y.currentTime=e),s!==void 0){const N=(e||0)+s,P=()=>{if(y.currentTime>=N){if(o!==aa||Gt!==y){x(!0);return}y.pause(),Un(!1),y.removeEventListener("timeupdate",P),l&&d.then(M=>{M||Jc(l)}),ks=!1,x(!0)}};y.addEventListener("timeupdate",P)}Un(!0),Nn=!1,y.play().then(()=>{y.onended=()=>{if(o!==aa||Gt!==y){x(!0);return}ks=!1,Nn=!1,Un(!1),l&&d.then(N=>{N||Jc(l)}),x(!0)}}).catch(N=>{if(o!==aa||Gt!==y){x(!1);return}ks=!1,Nn=!1,Un(!1),v(N)})};y.readyState>=1?S():y.onloadedmetadata=S,y.onerror=N=>{if(o!==aa||Gt!==y){x(!1);return}ks=!1,Nn=!1,Un(!1),v(N)}})},A0=async()=>{const n=await navigator.mediaDevices.getUserMedia({audio:!0}),e=["audio/webm;codecs=opus","audio/webm","audio/mp4"].find(s=>MediaRecorder.isTypeSupported(s));sa=new MediaRecorder(n,e?{mimeType:e}:void 0),vg=[],sa.ondataavailable=s=>{s.data.size>0&&vg.push(s.data)},sa.start()};let sa=null,vg=[];const I0=()=>new Promise(n=>{if(!sa)return n(null);const e=sa.mimeType||"audio/webm";sa.onstop=()=>{const s=new Blob(vg,{type:e}),r=new FileReader;r.readAsDataURL(s),r.onloadend=()=>{const l=r.result.split(",")[1]||"";n({base64:l,mimeType:e})},sa==null||sa.stream.getTracks().forEach(o=>o.stop()),sa=null},sa.state!=="inactive"?sa.stop():n(null)}),fl=n=>{Gt&&(Gt.currentTime=n)},AT=()=>Gt?{currentTime:Gt.currentTime,duration:Gt.duration||0}:null,i4=Object.freeze(Object.defineProperty({__proto__:null,bufferToWav:Wk,detectLanguage:vu,fetchServerVoices:Jk,getAudioProgress:AT,getAvailableVoices:Xk,getIsAudioPaused:Vc,getIsSingleWordPlayback:zc,getIsSpeaking:Pc,getMarkPoints:vT,getPlaybackRate:af,pauseSpeaking:ET,playSound:TT,prefetchSpeech:n4,resetAudioProtocolCache:Kk,resumeSpeaking:wT,seekAudio:fl,setPlaybackRate:_T,speak:os,startRecording:A0,stopRecording:I0,stopSpeaking:bT},Symbol.toStringTag,{value:"Module"}));typeof window<"u"&&(window.checkMarkdownQuiz=n=>{const e=n.getAttribute("data-answer");if(!e)return;const r=n.value.trim().toLowerCase()===e.trim().toLowerCase();n.classList.remove("border-neutral-300","text-neutral-900","focus:border-indigo-600"),n.classList.remove("border-green-500","text-green-700","bg-green-50"),n.classList.remove("border-red-500","text-red-700","bg-red-50"),r?n.classList.add("border-green-500","text-green-700","bg-green-50"):n.classList.add("border-red-500","text-red-700","bg-red-50")},window.checkDropdownQuiz=n=>{const e=n.parentElement;if(!e)return;const s=e.querySelector("select");if(!s)return;const r=s.getAttribute("data-answer"),o=s.value;if(!o)return;const l=o===r;if(s.disabled=!0,n.disabled=!0,n.classList.add("opacity-0","pointer-events-none"),s.classList.remove("border-neutral-300","text-neutral-900","focus:border-indigo-600"),s.classList.remove("bg-white"),l)s.classList.add("border-green-500","text-green-700","bg-green-50","font-bold");else{s.classList.add("border-red-500","text-red-700","bg-red-50","line-through");const d=document.createElement("span");d.className="ml-2 text-xs font-bold text-green-600 bg-green-50 px-1.5 py-0.5 rounded border border-green-200 animate-in fade-in",d.innerText=r||"",e.appendChild(d)}},window.checkMultiChoice=n=>{var l;const e=n.parentElement;if(!e)return;const s=e.getAttribute("data-answer"),r=(l=n.textContent)==null?void 0:l.trim();e.querySelectorAll("button").forEach(d=>{var m;d.disabled=!0,d.classList.add("opacity-50","cursor-not-allowed"),((m=d.textContent)==null?void 0:m.trim())===s&&(d.classList.remove("bg-white","text-neutral-700","opacity-50"),d.classList.add("bg-green-500","text-white","border-green-600"))}),r===s?(n.classList.remove("opacity-50"),n.classList.add("ring-2","ring-green-300")):(n.classList.remove("bg-white","text-neutral-700","opacity-50"),n.classList.add("bg-red-500","text-white","border-red-600"))},window.handleLessonSound=(n,e,s,r)=>{TT(n,e,s,r).catch(o=>console.error("Sound play failed",o))},window.handleWordAudioSpeak=n=>{const e=window.handleLessonSpeak;typeof e=="function"?e(n):console.warn("handleLessonSpeak is not registered in current view.")},window.handleMarkdownNav=n=>{const e=String(n||"").trim().toLowerCase();if(!e)return;const s=window.resolveMarkdownNav;if(typeof s=="function"&&s(e))return;const r=Array.from(document.querySelectorAll("h1, h2, h3, h4")),o=r.find(m=>(m.textContent||"").trim().toLowerCase()===e),l=r.find(m=>(m.textContent||"").trim().toLowerCase().includes(e)),d=o||l;d&&d.scrollIntoView({behavior:"smooth",block:"start"})});const o4=n=>{if(!n[0].trim().startsWith("|"))return null;const e=[];for(const p of n)if(p.trim().startsWith("|"))e.push(p);else break;if(e.length===0)return null;const s=p=>{const y=p.split("|");return p.trim().startsWith("|")&&y.shift(),p.trim().endsWith("|")&&y.pop(),y.map(x=>x.trim())},r=/^\|?(\s*:?-+:?\s*\|)+\s*$/;let o=!1;e.length>1&&r.test(e[1].trim())&&(o=!0);let l='<div class="overflow-x-auto my-4 border border-neutral-200 rounded-xl shadow-sm"><table class="w-full text-sm text-left border-collapse">';const d=s(e[0]);l+='<thead class="bg-neutral-50 text-neutral-900 uppercase font-bold text-xs"><tr>',d.forEach(p=>l+=`<th class="px-6 py-3 border-b border-neutral-200 min-w-[100px]">${p}</th>`),l+="</tr></thead>",l+='<tbody class="divide-y divide-neutral-100 bg-white">';const m=o?2:1;for(let p=m;p<e.length;p++){const y=s(e[p]);l+='<tr class="hover:bg-neutral-50/50 transition-colors">';for(let x=0;x<d.length;x++){const v=y[x]||"";l+=`<td class="px-6 py-4 font-medium text-neutral-600 align-top">${v}</td>`}l+="</tr>"}return l+="</tbody></table></div>",{html:l,consumed:e.length}},l4=n=>n.replace(/\[HIDDEN:\s*(.*?)\]/gi,(e,s)=>`<button type="button" onclick="this.outerHTML='<span class=\\'px-1.5 py-0.5 bg-green-50 border border-green-200 text-green-800 rounded-md text-sm font-bold animate-in fade-in zoom-in-95 inline-block align-baseline mx-1\\'>${s.trim().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"\\'")}</span>'" class="inline-flex flex-nowrap whitespace-nowrap items-center gap-1.5 px-2 py-0.5 bg-indigo-50 hover:bg-indigo-100 text-indigo-600 rounded-md text-[10px] font-black uppercase tracking-wider transition-colors select-none border border-indigo-100 shadow-sm align-middle my-0.5 mx-1"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" class="shrink-0"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>Reveal</button>`),c4=n=>n.replace(/\[Quiz:\s*(.*?)\]/gi,(e,s)=>{const r=s.trim(),o=Math.max(3,r.length);return`<span class="inline-flex items-center gap-1 align-middle mx-1 whitespace-nowrap"><input type="text" data-answer="${r.replace(/"/g,"&quot;")}" placeholder="?" class="border-b-2 border-neutral-300 bg-transparent text-center font-bold text-neutral-900 outline-none focus:border-indigo-600 transition-all rounded-t-md px-1 py-0.5 text-sm" style="width: ${o}ch; min-width: 40px;" onkeydown="if(event.key==='Enter') window.checkMarkdownQuiz(this)" /><button onclick="window.checkMarkdownQuiz(this.previousElementSibling)" class="p-1 text-neutral-400 hover:text-indigo-600 transition-colors bg-neutral-100 hover:bg-indigo-50 rounded-full shadow-sm" title="Check Answer"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg></button></span>`}),u4=n=>n.replace(/\[Select:\s*(.*?)\]/gi,(e,s)=>{const r=s.split("|").map(m=>m.trim()).filter(m=>m.length>0);if(r.length<2)return`[Invalid Select: ${s}]`;const o=r[0],l=[...r];for(let m=l.length-1;m>0;m--){const p=Math.floor(Math.random()*(m+1));[l[m],l[p]]=[l[p],l[m]]}let d='<span class="inline-flex items-center gap-1 align-middle mx-1 whitespace-nowrap">';return d+=`<select data-answer="${o.replace(/"/g,"&quot;")}" class="border-b-2 border-neutral-300 bg-transparent font-bold text-neutral-900 outline-none focus:border-indigo-600 transition-all rounded-t-md px-2 py-0.5 text-sm cursor-pointer hover:bg-neutral-50 appearance-none pr-6 relative" style="min-width: 80px;">`,d+='<option value="" disabled selected>Select...</option>',l.forEach(m=>{d+=`<option value="${m.replace(/"/g,"&quot;")}">${m}</option>`}),d+="</select>",d+='<button onclick="window.checkDropdownQuiz(this)" class="p-1 text-neutral-400 hover:text-indigo-600 transition-colors bg-neutral-100 hover:bg-indigo-50 rounded-full shadow-sm" title="Check Answer"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg></button>',d+="</span>",d}),d4=n=>n.replace(/\[Multi:\s*(.*?)\]/gi,(e,s)=>{const r=s.split("|").map(m=>m.trim()).filter(m=>m.length>0);if(r.length<2)return`[Invalid Multi: ${s}]`;const o=r[0],l=[...r];for(let m=l.length-1;m>0;m--){const p=Math.floor(Math.random()*(m+1));[l[m],l[p]]=[l[p],l[m]]}let d=`<span class="inline-flex flex-wrap items-center gap-1.5 align-middle mx-1" data-answer="${o.replace(/"/g,"&quot;")}">`;return l.forEach(m=>{d+=`<button onclick="window.checkMultiChoice(this)" class="px-2 py-1 bg-white border border-neutral-200 text-neutral-700 rounded-md text-xs font-bold hover:bg-neutral-50 hover:border-neutral-300 transition-all shadow-sm select-none">${m}</button>`}),d+="</span>",d}),f4=n=>n.replace(/\[Formula:?\s*(.*?)\]/gi,(e,s)=>{const r=s.split("|").map(l=>l.trim());let o='<div class="flex flex-wrap items-center gap-2 p-3 my-3 bg-amber-50 border-l-4 border-amber-400 rounded-r-xl shadow-sm">';return o+='<span class="text-[10px] font-black text-amber-500 uppercase tracking-widest mr-1 select-none">Formula</span>',r.forEach(l=>{/^[+,.]+$/.test(l)?o+=`<span class="font-bold text-amber-700">${l}</span>`:o+=`<span class="px-2 py-1 bg-white border border-amber-200 rounded-lg text-amber-900 font-mono text-sm font-bold shadow-sm">${l}</span>`}),o+="</div>",o}),h4=n=>{const e=/\[Audio-(VN|EN)\]([\s\S]*?)\[\/(?:Audio-(?:VN|EN))?\]/gi;return n.replace(e,(s,r,o)=>`<button onclick="window.handleLessonSpeak('${o.replace(/\[HIDDEN:.*?\]/gi,"").replace(/\[Quiz:.*?\]/gi,"").replace(/\[Select:.*?\]/gi,"").replace(/\[Multi:.*?\]/gi,"").replace(/\[Formula:.*?\]/gi,"").replace(/[#*`_~[\]()]/g,"").replace(/[\u{1F600}-\u{1F64F}\u{1F300}-\u{1F5FF}\u{1F680}-\u{1F6FF}\u{2600}-\u{26FF}\u{2700}-\u{27BF}]/gu,"").replace(/\n/g," ").trim().replace(/'/g,"\\'")}')" class="inline-flex items-center justify-center w-6 h-6 mr-1.5 bg-indigo-600 text-white hover:bg-indigo-700 rounded-md transition-all active:scale-90 align-middle shadow-sm" title="Listen"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg></button>`+o.trim())},p4=n=>{const e=/\[W_AUDIO\]([\s\S]*?)\[\/\]/gi;return n.replace(e,(s,r)=>{const o=String(r||"").split(",").map(d=>d.trim()).filter(d=>d.length>0);return o.length?`<span class="inline-flex flex-wrap items-center gap-1.5 align-middle my-1">${o.map(d=>`<button onclick="window.handleWordAudioSpeak('${d.replace(/'/g,"\\'")}')" class="inline-flex items-center px-2.5 py-1 bg-white border border-neutral-200 hover:border-indigo-300 hover:bg-indigo-50 text-neutral-700 hover:text-indigo-700 rounded-lg text-xs font-bold transition-all shadow-sm active:scale-95">${d}</button>`).join("")}</span>`:""})},m4=n=>{const e=/\[NAV(?:\s+([^\]]+))?\]([\s\S]*?)\[\/\]/gi;return n.replace(e,(s,r,o)=>{const l=String(o||"").trim(),d=String(r||l).trim();return!l||!d?"":`<button onclick="window.handleMarkdownNav('${d.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/\n/g," ")}')" class="inline-flex items-center gap-1 px-2.5 py-1 bg-neutral-100 border border-neutral-200 hover:bg-neutral-900 hover:text-white hover:border-neutral-900 text-neutral-700 rounded-lg text-xs font-bold transition-all active:scale-95 my-1">${l}</button>`})},g4=n=>n.replace(/\[SOUND\s*(.*?)\]/gi,(e,s)=>{let r=[],o=s;if(s.includes("<")){const v=s.split("<");o=v[0],r=v[1].split(",").map(S=>parseFloat(S.trim())).filter(S=>!isNaN(S)).slice(0,10)}const l=o.split("|").map(v=>v.trim());if(l.length<2)return`[Invalid Sound: ${s}]`;const d=l[0],m=l[1],p=l[2]?parseFloat(l[2]):void 0,y=l[3]?parseFloat(l[3]):void 0,x=[`'${m.replace(/'/g,"\\'")}'`];return(r.length>0||y!==void 0||p!==void 0)&&x.push(p!==void 0?p.toString():"undefined"),(r.length>0||y!==void 0)&&x.push(y!==void 0?y.toString():"undefined"),r.length>0&&x.push(`[${r.join(",")}]`),`<button onclick="window.handleLessonSound(${x.join(", ")})" class="inline-flex items-center gap-2 px-3 py-1.5 bg-white border border-neutral-200 hover:border-indigo-300 hover:bg-indigo-50 text-neutral-700 hover:text-indigo-600 rounded-xl text-xs font-bold transition-all shadow-sm active:scale-95 my-1 mx-1 select-none"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-indigo-500"><path d="M11 5L6 9H2v6h4l5 4V5z"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/></svg>${d}</button>`}),y4=n=>n.replace(/\[IMG\s*(.*?)\]/gi,(e,s)=>{const r=s.split("|").map(y=>y.trim()),o=r[0],l=r[1];let d=o;if(!o.startsWith("http")){const y=Dt(),x=Cn(y),v=o.startsWith("/")?o.slice(1):o;v.startsWith("api/")?d=`${x}/${v}`:d=`${x}/api/audio/stream/${v}`}const m=l?`style="width: ${l}; max-width: 100%; height: auto;"`:"";return`<img src="${d}" ${m} ${l?'class="rounded-lg my-4 shadow-md border border-neutral-200"':'class="max-w-full h-auto rounded-lg my-4 shadow-md border border-neutral-200"'} />`}),k1=n=>{if(!n)return"";const e=n.replace(/\\n/g,`
`);let s=h4(e);s=p4(s),s=m4(s),s=g4(s),s=y4(s),s=c4(s),s=u4(s),s=d4(s),s=f4(s),s=l4(s);const r=s.split(`
`),o=[],l=[],d=(m=0)=>{for(;l.length>m;){const p=l.pop();o.push(p.type==="ul"?"</ul>":"</ol>")}};for(let m=0;m<r.length;m++){const p=r[m],y=p.trim();if(!y&&l.length===0){o.push('<br class="block my-2" />');continue}const x=o4(r.slice(m));if(x){d(0),o.push(x.html),m+=x.consumed-1;continue}if(/^([-*_])\s*(\1\s*){2,}$/.test(y)){d(0),o.push('<hr class="my-6 border-t-2 border-neutral-100" />');continue}if(y.startsWith("# ")){d(0),o.push(`<h1 class="text-3xl font-black text-neutral-900 mb-4 mt-8 pb-2 border-b border-neutral-100 leading-tight">${y.substring(2)}</h1>`);continue}if(y.startsWith("## ")){d(0),o.push(`<h2 class="text-xl font-extrabold text-neutral-800 mb-3 mt-6 leading-tight">${y.substring(3)}</h2>`);continue}if(y.startsWith("### ")){d(0),o.push(`<h3 class="text-lg font-bold text-neutral-700 mb-2 mt-4 leading-tight">${y.substring(4)}</h3>`);continue}if(y.startsWith("#### ")){d(0),o.push(`<h4 class="text-sm font-bold text-neutral-600 mb-1 mt-3 uppercase tracking-wider">${y.substring(5)}</h4>`);continue}if(y.startsWith("> ")){d(0),o.push(`<blockquote class="border-l-4 border-amber-400 bg-amber-50 pl-4 py-3 pr-2 my-4 rounded-r-lg text-sm text-neutral-700 font-medium italic shadow-sm">${y.substring(2)}</blockquote>`);continue}const v=y.match(/^\[(?!(HIDDEN:|Quiz:|Select:|QUIZ:|Multi:|Formula:|Audio-|IMG|(\/\])))(.*)\]$/);if(v){d(0);const j='<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="shrink-0 mt-0.5 text-sky-500"><path d="M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.8 1.3 1.5 1.5 2.5"/><path d="M9 18h6"/><path d="M10 22h4"/></svg>',V=v[3].trim();o.push(`
                <div class="flex items-start gap-3 my-4 p-4 bg-sky-50 border-l-4 border-sky-400 rounded-r-lg shadow-sm">
                    ${j}
                    <div class="text-sm text-sky-900 font-medium leading-relaxed">
                        ${V}
                    </div>
                </div>
            `);continue}const S=p.match(/^(\s*)/),N=S?S[0].length:0,P=p.match(/^\s*[-*]\s+(.*)/),M=p.match(/^\s*(\d+)\.\s+(.*)/);if(P||M){const j=P?"ul":"ol",V=P?P[1]:M[2],B=M?M[1]:void 0;if(l.length===0||N>l[l.length-1].indent)o.push(j==="ul"?'<ul class="list-disc list-outside pl-5 my-3 space-y-1 text-neutral-700 marker:text-neutral-400">':'<ol class="list-decimal list-outside pl-5 my-3 space-y-1 text-neutral-700 marker:font-bold marker:text-neutral-500">'),l.push({type:j,indent:N});else if(N<l[l.length-1].indent)for(;l.length>0&&N<l[l.length-1].indent;)d(l.length-1);j==="ol"&&B?o.push(`<li value="${B}" class="pl-1">${V}</li>`):o.push(`<li class="pl-1">${V}</li>`);continue}y!==""&&(d(0),o.push(`<p class="mb-2 leading-relaxed text-neutral-600">${p}</p>`))}return d(0),o.join("").replace(/!\[(.*?)\]\((.*?)\)/g,(m,p,y)=>{let x=y;if(!y.startsWith("http")){const v=Dt(),S=Cn(v),N=y.startsWith("/")?y.slice(1):y;N.startsWith("api/")?x=`${S}/${N}`:x=`${S}/api/audio/stream/${N}`}return`<img alt="${p}" src="${x}" class="max-w-full h-auto rounded-lg my-4 shadow-md border border-neutral-200" />`}).replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="text-indigo-600 font-bold hover:underline">$1</a>').replace(/\*\*(.*?)\*\*/g,'<strong class="font-black text-neutral-900">$1</strong>').replace(/\*(.*?)\*/g,'<span class="italic font-normal text-inherit">$1</span>').replace(/`([^`]+)`/g,'<code class="bg-neutral-100 text-pink-600 px-1.5 py-0.5 rounded text-xs font-mono font-bold border border-neutral-200">$1</code>')},x4=({score:n})=>{const o=2*Math.PI*16,l=o-n/100*o;let d="text-neutral-400";return n>=80?d="text-green-500":n>=50?d="text-yellow-500":n>0&&(d="text-orange-500"),u.jsxs("div",{className:"relative flex items-center justify-center",style:{width:36,height:36},children:[u.jsxs("svg",{className:"absolute",width:36,height:36,children:[u.jsx("circle",{className:"text-neutral-100",stroke:"currentColor",strokeWidth:4,fill:"transparent",r:16,cx:36/2,cy:36/2}),u.jsx("circle",{className:d,stroke:"currentColor",strokeWidth:4,fill:"transparent",r:16,cx:36/2,cy:36/2,strokeDasharray:o,strokeDashoffset:l,strokeLinecap:"round",style:{transform:"rotate(-90deg)",transformOrigin:"50% 50%",transition:"stroke-dashoffset 0.5s ease-out"}})]}),u.jsx("span",{className:`text-[10px] font-black ${d}`,children:n})]})},b4=({word:n})=>{const e=n.masteryScore??0;return u.jsxs("div",{className:"relative group/score",children:[u.jsx(x4,{score:e}),u.jsxs("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-max px-3 py-1.5 bg-neutral-800 text-white text-[10px] font-black rounded-lg opacity-0 group-hover/score:opacity-100 transition-opacity pointer-events-none z-10 uppercase tracking-wider",children:["Mastery Score",u.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 w-2 h-2 bg-neutral-800 rotate-45"})]})]})},v4=({register:n})=>{if(!n||n==="neutral"||n==="raw")return null;const e={academic:"bg-purple-100 text-purple-800 border-purple-200",casual:"bg-sky-100 text-sky-800 border-sky-200"},s={academic:"ACADEMIC",casual:"CASUAL"};return u.jsx("span",{className:`px-2 py-0.5 rounded text-[8px] font-black uppercase border ${e[n]}`,children:s[n]})},_4=n=>{const e={intensified:"bg-orange-100 text-orange-700 border-orange-200",softened:"bg-blue-100 text-blue-700 border-blue-200",synonym:"bg-neutral-100 text-neutral-600 border-neutral-200",academic:"bg-purple-100 text-purple-700 border-purple-200",casual:"bg-sky-100 text-sky-700 border-sky-200"};return u.jsx("span",{className:`px-2 py-0.5 rounded text-[8px] font-black uppercase border ${e[n]||e.synonym}`,children:n})},L1=({label:n,options:e,selectedId:s,onSelect:r,buttonClass:o,disabled:l=!1})=>{const[d,m]=D.useState(!1),p=D.useRef(null),y=e.find(x=>x.id===s)||e[0];return D.useEffect(()=>{const x=v=>{p.current&&!p.current.contains(v.target)&&m(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]),u.jsxs("div",{className:"relative",ref:p,children:[u.jsxs("button",{type:"button",onClick:()=>m(!d),className:o,disabled:l,children:[n&&u.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-neutral-400 mr-2",children:n}),y.icon,u.jsx("span",{className:"text-xs font-black uppercase tracking-wider",children:y.label}),u.jsx(NE,{size:14,className:`transition-transform duration-200 ${d?"rotate-180":""}`})]}),d&&!l&&u.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-2xl shadow-xl border border-neutral-100 z-50 p-2 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col gap-1",children:e.map(x=>u.jsxs("button",{type:"button",onClick:()=>{r(x.id),m(!1)},className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-xs font-bold transition-colors ${s===x.id?"bg-neutral-100 text-neutral-900":"text-neutral-600 hover:bg-neutral-50 hover:text-neutral-900"}`,children:[x.icon,u.jsx("span",{children:x.label})]},x.id))})]})},E4=({word:n,onClose:e,onChallengeRequest:s,onMimicRequest:r,onEditRequest:o,onUpdate:l,linkedUnits:d,relatedWords:m,relatedByGroup:p,onNavigateToWord:y,onAddVariantToLibrary:x,addingVariant:v,existingVariants:S,isViewOnly:N=!1,appliedAccent:P,initialTab:M="OVERVIEW",onGenerateLesson:j})=>{var _e,W,le,ie,he,Ie,Ue,je,wt,Re,we,rt,Qe;const[V,B]=D.useState(()=>hu("ielts_pro_word_view_settings",{showHidden:!1,highlightFailed:!0,isLearnView:!0})),[H,G]=D.useState(!1),[Y,K]=D.useState(M),[I,A]=D.useState(new Set),_=D.useRef(null),C=oe=>{os(oe)};D.useEffect(()=>{Kg("ielts_pro_word_view_settings",V)},[V]);const R=(oe,ze)=>B(et=>({...et,[oe]:ze}));D.useEffect(()=>{const oe=ze=>{_.current&&!_.current.contains(ze.target)&&G(!1)};return document.addEventListener("mousedown",oe),()=>document.removeEventListener("mousedown",oe)},[]),D.useEffect(()=>(window.handleLessonSpeak=oe=>os(oe),()=>{delete window.handleLessonSpeak}),[]);const L=[{id:"NEW",label:"New",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"})},{id:Ct.LEARNED,label:"Learned",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-cyan-500"})},{id:Ct.FORGOT,label:"Forgot",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-rose-500"})},{id:Ct.HARD,label:"Hard",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-500"})},{id:Ct.EASY,label:"Easy",icon:u.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"})}],O=n.lastReview&&n.lastGrade||"NEW",xe=oe=>{if(!N)if(oe==="NEW"){const ze=$w(n);l(ze)}else{const ze=qw(n,oe);l(ze)}},ge=[{id:Vt.RAW,label:"Raw",icon:u.jsx(LE,{size:14,className:"text-neutral-400"})},{id:Vt.REFINED,label:"Needs Review",icon:u.jsx($E,{size:14,className:"text-indigo-500"})},{id:Vt.VERIFIED,label:"Verified",icon:u.jsx(HE,{size:14,className:"text-emerald-500"})},{id:Vt.FAILED,label:"Incorrect",icon:u.jsx(GE,{size:14,className:"text-rose-500"})}],F=(oe,ze,et,vt)=>{const Ye=Array.isArray(ze)?ze.filter(We=>V.showHidden||!We.isIgnored):[];return Ye.length===0?null:u.jsxs("div",{className:"space-y-1",children:[u.jsx("span",{className:`text-[8px] font-black uppercase text-${et}-600 tracking-widest ml-1`,children:oe}),u.jsx("div",{className:"flex flex-col gap-1",children:Ye.map((We,it)=>{var Ae,Be;const St=S.has(We.word.toLowerCase()),Ut=`WORD_FAMILY:${vt}:${We.word.toLowerCase().trim()}`,es=n.lastTestResults&&Ut in n.lastTestResults,Us=es?n.lastTestResults[Ut]:void 0;let ts=!1;if(es)ts=Us===!1;else{const xt=`WORD_FAMILY_${vt.toUpperCase()}`,Ke=(Ae=n.lastTestResults)==null?void 0:Ae[xt];(Ke===!1||Ke===void 0&&((Be=n.lastTestResults)==null?void 0:Be.WORD_FAMILY)===!1)&&(ts=!0)}const Es=V.highlightFailed&&ts&&!We.isIgnored,ve=We.isIgnored;let Oe="bg-white border-neutral-100 hover:border-neutral-300";return Es?Oe="bg-red-50 border-red-200 hover:border-red-300":ve&&(Oe="bg-neutral-50/50 border-neutral-100 opacity-60"),u.jsxs("div",{className:`flex items-center justify-between px-2 py-1.5 rounded-lg border group transition-colors ${Oe}`,children:[" ",u.jsxs("div",{className:"flex flex-col overflow-hidden",children:[" ",u.jsxs("div",{className:"flex items-center gap-1.5",children:[" ",u.jsx("span",{className:`text-[10px] font-bold truncate ${Es?"text-red-700":"text-neutral-900"} ${ve?"line-through decoration-neutral-400":""}`,children:We.word})," ",u.jsx("button",{onClick:xt=>{xt.stopPropagation(),os(We.word)},className:"text-neutral-300 hover:text-indigo-500 transition-colors p-0.5",children:u.jsx(va,{size:10})})," ",Es&&u.jsx(br,{size:10,className:"text-red-500 fill-red-100 shrink-0"})," "]})," "]})," ",u.jsx("button",{type:"button",disabled:v===We.word||St,onClick:()=>x({word:We.word,ipa:""},"family"),className:`p-1 rounded-md transition-all ${St?"text-green-500 cursor-default":"text-neutral-300 hover:text-neutral-900 hover:bg-neutral-100"}`,children:v===We.word?u.jsx(Kt,{size:10,className:"animate-spin"}):St?u.jsx(ba,{size:10}):u.jsx(Ya,{size:10})})," "]},it)})})]})},ue=({title:oe,icon:ze,children:et,className:vt})=>u.jsxs("div",{className:`space-y-2 ${vt||""}`,children:[u.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] font-black uppercase tracking-widest text-neutral-400 border-b border-neutral-100 pb-1 mb-2",children:[u.jsx(ze,{size:12}),u.jsx("span",{children:oe})]}),et]}),ae=fN(n.nextReview),X=!!(n.wordFamily&&((_e=n.wordFamily.nouns)!=null&&_e.length||(W=n.wordFamily.verbs)!=null&&W.length||(le=n.wordFamily.adjs)!=null&&le.length||(ie=n.wordFamily.advs)!=null&&ie.length)),Q=(n.prepositions||[]).filter(oe=>V.showHidden||!oe.isIgnored),T=(n.collocationsArray||[]).filter(oe=>V.showHidden||!oe.isIgnored),z=(n.idiomsList||[]).filter(oe=>V.showHidden||!oe.isIgnored),$=(n.paraphrases||[]).filter(oe=>V.showHidden||!oe.isIgnored),J=V.highlightFailed&&((he=n.lastTestResults)==null?void 0:he.SPELLING)===!1;V.highlightFailed&&(((Ie=n.lastTestResults)==null?void 0:Ie.IPA_QUIZ)===!1||((Ue=n.lastTestResults)==null||Ue.PRONUNCIATION)),D.useMemo(()=>{if(!n.wordFamily)return[];const oe=[],ze=["nouns","verbs","adjs","advs"],et={nouns:"Noun",verbs:"Verb",adjs:"Adjective",advs:"Adverb"};return ze.forEach(vt=>{(n.wordFamily[vt]||[]).forEach(Ye=>{(V.showHidden||!Ye.isIgnored)&&oe.push({word:Ye.word,type:et[vt],ipa:Ye.ipaUs})})}),oe},[n.wordFamily,V.showHidden]);const pe=D.useMemo(()=>{var oe;return(oe=n.lesson)!=null&&oe.essay?k1(n.lesson.essay):null},[(je=n.lesson)==null?void 0:je.essay]),de=D.useMemo(()=>{var oe;return(oe=n.lesson)!=null&&oe.test?k1(n.lesson.test):null},[(wt=n.lesson)==null?void 0:wt.test]);return u.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[u.jsx("header",{className:"px-8 py-4 border-b border-neutral-100 bg-neutral-50/30 flex flex-col gap-1 shrink-0",children:u.jsxs("div",{className:"flex justify-between items-start w-full gap-4",children:[u.jsx("div",{className:"flex-1",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h2",{className:`text-2xl font-black tracking-tight leading-none ${J?"text-red-600":"text-neutral-900"}`,children:n.word}),J&&u.jsx(br,{size:16,className:"text-red-500 fill-red-100"}),!n.isPassive&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:oe=>{oe.stopPropagation(),C(n.word)},className:"p-2 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 rounded-full transition-colors",title:"Pronounce",children:u.jsx(va,{size:18})}),u.jsx("button",{onClick:oe=>{oe.stopPropagation(),r()},className:"p-2 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 rounded-full transition-colors",title:"Mimic",children:u.jsx(mo,{size:18})})]}),u.jsxs("div",{className:"relative group",children:[u.jsx("button",{className:"p-2 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 rounded-full transition-colors",children:u.jsx(wf,{size:18})}),u.jsxs("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 w-max max-w-xs px-3 py-2 bg-neutral-800 text-white text-xs font-bold rounded-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-10",children:[n.meaningVi,u.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 w-2 h-2 bg-neutral-800 rotate-45"})]})]}),u.jsx(b4,{word:n})]})}),u.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[u.jsx(L1,{options:L,selectedId:O,onSelect:xe,buttonClass:"flex items-center gap-2 px-3 py-2 bg-white rounded-lg hover:bg-neutral-100 transition-colors shadow-sm border border-neutral-200",disabled:N}),u.jsxs("div",{className:"relative",ref:_,children:[u.jsx("button",{onClick:()=>G(!H),className:`p-2 rounded-lg transition-colors ${H?"bg-neutral-900 text-white shadow-sm":"bg-white border border-neutral-200 text-neutral-400 hover:text-neutral-900"}`,title:"View Options",children:u.jsx(tu,{size:16})}),H&&u.jsxs("div",{className:"absolute right-0 top-full mt-2 w-56 bg-white rounded-2xl shadow-xl border border-neutral-100 z-50 p-2 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col gap-1",children:[u.jsx("div",{className:"px-3 py-2 text-[9px] font-black text-neutral-400 uppercase tracking-widest border-b border-neutral-50",children:"View Options"}),u.jsxs("button",{onClick:()=>R("isLearnView",!V.isLearnView),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-neutral-50 text-xs font-bold text-neutral-700 transition-colors",children:[u.jsx("span",{children:"Learn View"}),V.isLearnView?u.jsx(ba,{size:14,className:"text-green-500"}):u.jsx("div",{className:"w-4 h-4 rounded-full border border-neutral-200"})]}),u.jsxs("button",{onClick:()=>R("showHidden",!V.showHidden),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-neutral-50 text-xs font-bold text-neutral-700 transition-colors",children:[u.jsx("span",{children:"Show Ignored Items"}),V.showHidden?u.jsx(ba,{size:14,className:"text-green-500"}):u.jsx("div",{className:"w-4 h-4 rounded-full border border-neutral-200"})]}),u.jsxs("button",{onClick:()=>R("highlightFailed",!V.highlightFailed),className:"w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-neutral-50 text-xs font-bold text-neutral-700 transition-colors",children:[u.jsx("span",{children:"Highlight Failed"}),V.highlightFailed?u.jsx(ba,{size:14,className:"text-green-500"}):u.jsx("div",{className:"w-4 h-4 rounded-full border border-neutral-200"})]})]})]}),!N&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:s,className:"p-2 bg-amber-100 text-amber-600 hover:text-amber-900 rounded-lg hover:bg-amber-200 transition-colors",title:"Practice",children:u.jsx(IE,{size:16})}),u.jsx("button",{onClick:o,className:"p-2 bg-neutral-100 text-neutral-600 hover:text-neutral-900 rounded-lg hover:bg-neutral-200 transition-colors",children:u.jsx(fI,{size:16})})]}),u.jsx("button",{onClick:e,className:"p-2 bg-white border border-neutral-200 text-neutral-400 hover:text-neutral-900 rounded-lg transition-colors",children:u.jsx(hn,{size:16})})]})]})}),u.jsxs("nav",{className:"px-8 border-b border-neutral-100 bg-white flex items-center gap-6 shrink-0 overflow-x-auto no-scrollbar",children:[u.jsx("button",{onClick:()=>K("OVERVIEW"),className:`py-3 px-1 text-[10px] font-black uppercase tracking-widest border-b-2 transition-all ${Y==="OVERVIEW"?"border-neutral-900 text-neutral-900":"border-transparent text-neutral-400 hover:text-neutral-600"}`,children:"Overview"}),u.jsxs("button",{onClick:()=>K("USAGE"),className:`py-3 px-1 text-[10px] font-black uppercase tracking-widest border-b-2 transition-all flex items-center gap-2 ${Y==="USAGE"?"border-indigo-600 text-indigo-600":"border-transparent text-neutral-400 hover:text-neutral-600"}`,children:[u.jsx(rf,{size:14})," Usage"]}),u.jsxs("button",{onClick:()=>K("TEST"),className:`py-3 px-1 text-[10px] font-black uppercase tracking-widest border-b-2 transition-all flex items-center gap-2 ${Y==="TEST"?"border-emerald-600 text-emerald-600":"border-transparent text-neutral-400 hover:text-neutral-600"}`,children:[u.jsx(Um,{size:14})," Practice Test"]})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar px-6 pt-4 pb-8 bg-neutral-50/20",children:[Y==="OVERVIEW"&&u.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"px-2 py-3 bg-white border border-neutral-100 rounded-2xl flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 shadow-sm",children:[u.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[u.jsx("div",{className:"flex flex-col",children:u.jsx("p",{className:"px-2 py-1 bg-neutral-50 rounded-lg text-sm font-mono font-medium border border-neutral-200 text-neutral-500",children:n.ipaUs||"/?/"})}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx(v4,{register:n.register}),(!n.register||n.register==="raw")&&u.jsx("span",{className:"px-2 py-1 bg-neutral-100 text-neutral-400 rounded-lg text-[10px] font-black uppercase tracking-tighter border border-neutral-200",children:"Neutral"})]})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx(L1,{label:"Quality",options:ge,selectedId:n.quality,onSelect:oe=>l({...n,quality:oe}),buttonClass:"flex items-center gap-2 p-1.5 bg-neutral-50 border border-neutral-200 hover:bg-neutral-100 rounded-xl transition-all",disabled:N}),!n.isPassive&&u.jsx("div",{className:"flex flex-col items-end",children:u.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-neutral-50 border border-neutral-200 rounded-lg text-xs font-bold text-neutral-500",title:`Next Review: ${ae.label}`,children:[u.jsx(CE,{size:12}),u.jsx("span",{className:`text-[11px] font-black uppercase ${ae.urgency==="due"?"text-rose-500":"text-green-600"}`,children:ae.label})]})})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[n.note&&u.jsx("div",{className:"md:col-span-4",children:u.jsx("p",{className:"text-sm text-neutral-700 bg-yellow-50/50 p-4 rounded-xl border border-yellow-100 italic leading-relaxed whitespace-pre-wrap",children:n.note})}),u.jsx(ue,{title:"Examples",icon:Tf,className:"md:col-span-4",children:n.example?u.jsx("div",{className:"flex flex-col gap-2",children:n.example.split(`
`).filter(oe=>oe.trim()!=="").map((oe,ze)=>u.jsxs("div",{className:"flex items-start gap-2 px-3 py-2 bg-neutral-50 border border-neutral-100 rounded-xl group hover:border-neutral-200 transition-all",children:[u.jsx("span",{className:"text-sm font-medium text-neutral-700 leading-relaxed flex-1 select-text cursor-text",children:oe}),u.jsx("button",{onClick:()=>os(oe),className:"p-1.5 text-neutral-400 hover:text-indigo-500 hover:bg-white rounded-lg transition-all shrink-0",children:u.jsx(va,{size:14})})]},ze))}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic px-1",children:"No examples added."})}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Ig,{size:10})," Prepositions"]}),Q.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 bg-white border border-neutral-100 p-3 rounded-xl shadow-sm",children:Q.map((oe,ze)=>{var We,it;const et=`PREPOSITION_QUIZ:${oe.prep}`,vt=(We=n.lastTestResults)==null?void 0:We[et],Ye=V.highlightFailed&&(vt===!1||vt===void 0&&((it=n.lastTestResults)==null?void 0:it.PREPOSITION_QUIZ)===!1)&&!oe.isIgnored;return u.jsxs("div",{className:`flex items-center justify-between gap-3 p-2 rounded-lg border transition-colors ${Ye?"bg-red-50 border-red-200":"bg-neutral-50/30 border-neutral-100"} ${oe.isIgnored?"opacity-50":""}`,children:[u.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[Ye&&u.jsx(br,{size:10,className:"text-red-500 shrink-0"}),u.jsx("span",{className:`font-bold text-xs shrink-0 ${Ye?"text-red-700":"text-neutral-900"} ${oe.isIgnored?"line-through":""}`,children:oe.prep}),u.jsx("span",{className:`font-medium text-[10px] truncate ${Ye?"text-red-400":"text-neutral-500"}`,children:oe.usage})]}),oe.usage&&u.jsx("button",{onClick:()=>os(oe.usage),className:"text-neutral-300 hover:text-indigo-500 transition-colors p-1 shrink-0",children:u.jsx(va,{size:12})})]},ze)})}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic px-1",children:"No prepositions."})]}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(BE,{size:10})," Word Family"]}),u.jsx("div",{className:"p-3 bg-neutral-50 rounded-xl border border-neutral-100",children:X?u.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[F("Nouns",(Re=n.wordFamily)==null?void 0:Re.nouns,"blue","nouns"),F("Verbs",(we=n.wordFamily)==null?void 0:we.verbs,"green","verbs"),F("Adjectives",(rt=n.wordFamily)==null?void 0:rt.adjs,"orange","adjs"),F("Adverbs",(Qe=n.wordFamily)==null?void 0:Qe.advs,"purple","advs")]}):u.jsx("span",{className:"text-[10px] text-neutral-300 italic",children:"No family data available."})})]}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Sf,{size:10})," Collocations"]}),T.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 bg-white border border-neutral-200 p-3 rounded-xl",children:T.map((oe,ze)=>{var St,Ut;const et=S.has(oe.text.toLowerCase()),vt=`COLLOCATION_QUIZ:${oe.text}`,Ye=(St=n.lastTestResults)==null?void 0:St[vt];let We=!1;V.highlightFailed&&!oe.isIgnored&&(Ye===!1||Ye===void 0&&((Ut=n.lastTestResults)==null?void 0:Ut.COLLOCATION_QUIZ)===!1)&&(We=!0);let it="bg-indigo-50/50 border-indigo-100 text-indigo-900";return We?it="bg-red-50 border-red-200 text-red-700":oe.isIgnored&&(it="bg-neutral-50 border-neutral-100 text-neutral-400"),u.jsxs("div",{className:`flex items-start justify-between gap-2 px-3 py-2 rounded-lg border text-xs font-bold transition-colors ${it}`,children:[u.jsxs("div",{className:"flex-1 overflow-hidden",children:[We&&u.jsx(br,{size:12,className:"text-red-500 shrink-0"}),u.jsx("span",{className:`truncate ${oe.isIgnored?"line-through":""}`,title:oe.text,children:oe.text}),oe.d&&!oe.isIgnored&&u.jsx("div",{className:"text-[10px] italic text-neutral-400 mt-0.5 normal-case font-medium",children:oe.d})]}),u.jsx("button",{onClick:()=>os(oe.text),className:"text-neutral-300 hover:text-indigo-500 transition-colors p-0.5",children:u.jsx(va,{size:10})}),u.jsx("button",{type:"button",disabled:v===oe.text||et||oe.isIgnored,onClick:()=>x({word:oe.text,ipa:""},"collocation"),className:`p-1 rounded-md transition-all shrink-0 ${et?"text-green-500 cursor-default":oe.isIgnored?"text-neutral-300 cursor-not-allowed":"text-neutral-400 hover:text-neutral-900 hover:bg-white/50"}`,title:et?"Already in library":"Add to library",children:v===oe.text?u.jsx(Kt,{size:12,className:"animate-spin"}):et?u.jsx(ba,{size:12}):u.jsx(Ya,{size:12})})]},ze)})}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic px-1",children:"No collocations."})]}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Nf,{size:10,className:"text-amber-500"})," Variations"]}),$.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:$.map((oe,ze)=>{var St,Ut;const et=S.has(oe.word.toLowerCase()),vt=`PARAPHRASE_QUIZ:${oe.word}`,Ye=(St=n.lastTestResults)==null?void 0:St[vt],We=V.highlightFailed&&(Ye===!1||Ye===void 0&&((Ut=n.lastTestResults)==null?void 0:Ut.PARAPHRASE_QUIZ)===!1)&&!oe.isIgnored,it=oe.isIgnored;return u.jsxs("div",{className:`flex items-start justify-between gap-2 border px-3 py-2 rounded-xl shadow-sm ${We?"bg-red-50 border-red-200":it?"bg-neutral-50 border-neutral-100 opacity-60":"bg-white border-neutral-200"}`,children:[u.jsxs("div",{className:"flex-1 overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-1",children:[_4(oe.tone),We&&u.jsx(br,{size:12,className:"text-red-500 fill-red-100"})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("div",{className:`text-xs font-bold ${We?"text-red-800":"text-neutral-800"} ${it?"line-through":""}`,children:oe.word}),u.jsx("button",{onClick:()=>os(oe.word),className:"text-neutral-300 hover:text-indigo-500 transition-colors p-0.5",children:u.jsx(va,{size:10})})]}),u.jsx("div",{className:`text-[10px] italic truncate ${We?"text-red-400":"text-neutral-400"}`,title:oe.context,children:oe.context})]}),u.jsx("button",{type:"button",disabled:v===oe.word||et,onClick:()=>x({word:oe.word,ipa:""},"paraphrase"),className:`p-1 rounded-md transition-all mt-1 shrink-0 ${et?"text-green-500 cursor-default":"text-neutral-300 hover:text-neutral-900 hover:bg-neutral-100"}`,children:v===oe.word?u.jsx(Kt,{size:10,className:"animate-spin"}):et?u.jsx(ba,{size:10}):u.jsx(Ya,{size:10})})]},ze)})}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic",children:"No variations available."})]}),u.jsxs("div",{className:"space-y-1 md:col-span-4",children:[u.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[u.jsx(Rg,{size:10})," Related Idioms"]}),z.length>0?u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2 bg-white border border-neutral-200 p-3 rounded-xl",children:z.map((oe,ze)=>{var St,Ut;const et=S.has(oe.text.toLowerCase()),vt=`IDIOM_QUIZ:${oe.text}`,Ye=(St=n.lastTestResults)==null?void 0:St[vt];let We=!1;V.highlightFailed&&!oe.isIgnored&&(Ye===!1||Ye===void 0&&((Ut=n.lastTestResults)==null?void 0:Ut.IDIOM_QUIZ)===!1)&&(We=!0);let it="bg-amber-50/50 border-amber-100 text-amber-900";return We?it="bg-red-50 border-red-200 text-red-700":oe.isIgnored&&(it="bg-neutral-50 border-neutral-100 text-neutral-400"),u.jsxs("div",{className:`flex items-start justify-between gap-2 px-3 py-2 rounded-lg border text-xs font-bold transition-colors ${it}`,children:[u.jsxs("div",{className:"flex-1 overflow-hidden",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[We&&u.jsx(br,{size:12,className:"text-red-500 shrink-0"}),u.jsx("span",{className:`truncate ${oe.isIgnored?"line-through":""}`,title:oe.text,children:oe.text}),u.jsx("button",{onClick:()=>os(oe.text),className:"text-neutral-300 hover:text-indigo-500 transition-colors p-0.5",children:u.jsx(va,{size:10})})]}),oe.d&&!oe.isIgnored&&u.jsx("div",{className:"text-[10px] italic text-neutral-400 mt-0.5 normal-case font-medium",children:oe.d})]}),u.jsx("button",{type:"button",disabled:v===oe.text||et||oe.isIgnored,onClick:()=>x({word:oe.text,ipa:""},"idiom"),className:`p-1 rounded-md transition-all shrink-0 ${et?"text-green-500 cursor-default":oe.isIgnored?"text-neutral-300 cursor-not-allowed":"text-neutral-400 hover:text-neutral-900 hover:bg-white/50"}`,title:et?"Already in library":"Add to library",children:v===oe.text?u.jsx(Kt,{size:12,className:"animate-spin"}):et?u.jsx(ba,{size:12}):u.jsx(Ya,{size:12})})]},ze)})}):u.jsx("div",{className:"text-[10px] text-neutral-300 italic px-1",children:"No related idioms found."})]})]})]}),Y==="USAGE"&&u.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-2 duration-500 flex flex-col h-full space-y-8",children:[pe?u.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-black prose-headings:text-neutral-900 prose-p:text-neutral-600 prose-p:leading-relaxed prose-img:rounded-xl prose-img:shadow-md prose-strong:text-neutral-900 prose-a:text-indigo-600 overflow-x-auto",dangerouslySetInnerHTML:{__html:pe}}):u.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white border-2 border-dashed border-neutral-200 rounded-[2.5rem] space-y-4",children:[u.jsx("div",{className:"p-4 bg-indigo-50 rounded-full text-indigo-600",children:u.jsx(rf,{size:32})}),u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"font-black text-neutral-900",children:"No Usage Guide"}),u.jsx("p",{className:"text-xs text-neutral-400 font-medium",children:"Generate a structural guide with tables and examples."})]}),!N&&u.jsxs("button",{onClick:()=>j==null?void 0:j("ESSAY"),className:"px-6 py-3 bg-neutral-900 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center gap-2 hover:bg-neutral-800 transition-all active:scale-95 shadow-lg",children:[u.jsx(Tl,{size:16})," Generate Usage Guide"]})]}),pe&&!N&&u.jsx("div",{className:"flex justify-center border-t border-neutral-100 pt-6",children:u.jsxs("button",{onClick:()=>j==null?void 0:j("ESSAY"),className:"flex items-center gap-2 px-4 py-2 bg-neutral-50 text-neutral-500 hover:text-indigo-600 hover:bg-indigo-50 border border-neutral-200 hover:border-indigo-200 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all",children:[u.jsx(Sl,{size:12})," ",u.jsx("span",{children:"Refresh Usage Guide"})]})})]}),Y==="TEST"&&u.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-2 duration-500 flex flex-col h-full space-y-8",children:[de?u.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-black prose-headings:text-neutral-900 prose-p:text-neutral-600 prose-p:leading-relaxed prose-img:rounded-xl prose-img:shadow-md prose-strong:text-neutral-900 prose-a:text-indigo-600",dangerouslySetInnerHTML:{__html:de}}):u.jsxs("div",{className:"flex flex-col items-center justify-center py-20 bg-white border-2 border-dashed border-neutral-200 rounded-[2.5rem] space-y-4",children:[u.jsx("div",{className:"p-4 bg-emerald-50 rounded-full text-emerald-600",children:u.jsx(Um,{size:32})}),u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"font-black text-neutral-900",children:"No Practice Test"}),u.jsx("p",{className:"text-xs text-neutral-400 font-medium",children:"Create an interactive test based on this word's usage."})]}),!N&&u.jsxs("button",{onClick:()=>j==null?void 0:j("TEST"),className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs uppercase tracking-widest flex items-center gap-2 hover:bg-neutral-800 transition-all active:scale-95 shadow-lg",children:[u.jsx(Tl,{size:16})," Generate Test"]})]}),de&&!N&&u.jsx("div",{className:"flex justify-center border-t border-neutral-100 pt-6",children:u.jsxs("button",{onClick:()=>j==null?void 0:j("TEST"),className:"flex items-center gap-2 px-4 py-2 bg-neutral-50 text-neutral-500 hover:text-emerald-600 hover:bg-emerald-50 border border-neutral-200 hover:border-emerald-200 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all",children:[u.jsx(Sl,{size:12})," ",u.jsx("span",{children:"Regenerate Test"})]})})]})]})]})})},w4=({title:n,type:e,currentStep:s,totalSteps:r,onClose:o,onFinish:l,label:d="Challenge",isQuickFire:m,elapsedTime:p})=>u.jsxs("div",{className:"px-6 py-5 border-b border-neutral-100 flex items-center justify-between bg-neutral-50/50 shrink-0",children:[u.jsx("button",{onClick:o,className:"p-2 -ml-2 text-neutral-400 hover:text-neutral-900 transition-colors",title:m?"Exit to Dashboard":"Close",children:u.jsx(hn,{size:20})}),u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:[d," ",s," of ",r]}),p&&u.jsxs("div",{className:"flex items-center gap-1 bg-neutral-200/50 px-1.5 py-0.5 rounded-md",children:[u.jsx(CE,{size:10,className:"text-neutral-500"}),u.jsx("span",{className:"text-[10px] font-mono font-bold text-neutral-600",children:p})]})]}),u.jsx("span",{className:"text-xs font-black text-neutral-900",children:n})]}),u.jsx("button",{onClick:()=>l(m),className:"p-2 -mr-2 text-amber-500 hover:text-amber-700 transition-colors",title:m?"Finish Session & See Results":"Finish & Save",children:u.jsx(oI,{size:20,className:m?"fill-amber-500":""})})]});class N0{constructor(){this.recognition=null,this.finalTranscript="",this.onResultCallback=null,this.onEndCallback=null,this.initBrowserRecognition()}initBrowserRecognition(){const e=window.SpeechRecognition||window.webkitSpeechRecognition;e&&(this.recognition=new e,this.recognition.continuous=!0,this.recognition.interimResults=!0,this.recognition.lang="en-US",this.recognition.onresult=s=>{let r="",o="";for(let l=s.resultIndex;l<s.results.length;++l)s.results[l].isFinal?o+=s.results[l][0].transcript:r+=s.results[l][0].transcript;this.finalTranscript+=o,this.onResultCallback&&this.onResultCallback(this.finalTranscript,r)},this.recognition.onend=()=>{this.onEndCallback&&this.onEndCallback(this.finalTranscript)},this.recognition.onerror=s=>{console.error("Speech Recognition Error:",s.error),this.stop()})}async start(e,s){if(this.onResultCallback=e,this.onEndCallback=s,this.finalTranscript="",!this.recognition){console.error("Speech Recognition not supported in this browser.");return}try{this.recognition.start()}catch(r){console.error("Speech Recognition start failed:",r)}}stop(){if(this.recognition)try{this.recognition.stop()}catch{}}}const C0=({isListening:n,onClick:e,disabled:s,className:r})=>u.jsx("button",{onClick:e,disabled:s,className:`p-2.5 rounded-xl transition-all shadow-sm flex items-center justify-center
            ${n?"bg-red-500 text-white animate-pulse ring-2 ring-red-200 border-transparent":"bg-white border border-neutral-200 text-neutral-400 hover:text-indigo-600 hover:border-indigo-300"} ${r}`,title:n?"Stop Recording":"Use Voice Input",tabIndex:-1,children:n?u.jsx(Af,{size:18,fill:"currentColor"}):u.jsx(mo,{size:18})}),qf=()=>{const[n,e]=D.useState({});return{validationState:n,clearValidation:d=>{e(m=>{if(!m[d])return m;const p={...m};return delete p[d],p})},getValidationClass:d=>{const m=n[d];return m==="correct"?"!border-green-500 !ring-2 !ring-green-100 !bg-green-50 text-green-900":m==="incorrect"?"!border-red-500 !ring-2 !ring-red-100 !bg-red-50 text-red-900":""},handleSmartChange:(d,m,p)=>{const y=d.target.value;if(y===" ")m(p);else if(y.endsWith("  ")){const x=y.substring(0,y.length-2),v=x.length>0?" ":"";m(x+v+p)}else m(y)},handleValidationKeyDown:(d,m,p)=>{if(d.key==="Escape"){d.preventDefault(),d.stopPropagation();const y=d.currentTarget.value,x=S=>S.trim().toLowerCase().replace(/[^a-z0-9]/g,"");let v=!1;if(Array.isArray(p)){const S=y.split(",").map(x).filter(Boolean);if(S.length===0){e(P=>({...P,[m]:null}));return}const N=new Set(p.map(x));v=S.every(P=>N.has(P))}else{const S=x(y);if(!S){e(N=>({...N,[m]:null}));return}v=x(p)===S}e(S=>({...S,[m]:v?"correct":"incorrect"}))}}}},S4=({group:n,userAnswers:e,results:s,onAnswerChange:r,isFinishing:o,showHint:l,toggleListening:d,listeningId:m,containerRef:p})=>{const{clearValidation:y,handleSmartChange:x,handleValidationKeyDown:v,getValidationClass:S}=qf();return u.jsxs("div",{ref:p,className:"flex flex-col animate-in fade-in duration-300",children:[u.jsxs("div",{className:"text-center space-y-2 mb-6",children:[u.jsx("h3",{className:"text-lg font-black text-neutral-900",children:"Preposition Drill"}),u.jsx("p",{className:"text-xs text-neutral-500 font-medium max-w-xs mx-auto",children:"Complete the collocations. Type the missing preposition(s)."})]}),u.jsx("div",{className:"space-y-4",children:n.map(N=>{var I,A;const P=e[N.index]||"",M=s?s[N.index]:null,j=typeof M=="boolean"?M:M&&typeof M=="object"?M.correct:!1,V=M!==null&&!j,B=N.challenge.example.split("___"),H=(I=B[0])==null?void 0:I.trim(),G=(A=B[1])==null?void 0:A.trim(),Y=`prep-${N.index}`,K=m===Y;return u.jsxs("div",{className:"w-full bg-neutral-50 border-2 border-neutral-100 rounded-2xl p-5 flex flex-wrap items-center justify-center gap-x-2 gap-y-3 shadow-sm transition-all focus-within:border-neutral-300 focus-within:shadow-md focus-within:bg-white",children:[H&&u.jsx("span",{className:"text-lg font-medium text-neutral-600 text-right",children:H}),u.jsxs("div",{className:"relative mx-1 flex items-center gap-2",children:[u.jsx("input",{type:"text",value:P,onChange:_=>{y(Y),x(_,C=>r(N.index,C),N.challenge.answer)},onKeyDown:_=>{v(_,Y,N.challenge.answer)},disabled:o,className:`h-10 min-w-[80px] max-w-[160px] w-[12ch] text-center text-lg font-bold rounded-lg border-b-2 outline-none transition-colors ${o?j?"bg-green-50 border-green-500 text-green-700":"bg-red-50 border-red-500 text-red-700 decoration-red-500 line-through decoration-2":`bg-white border-neutral-300 text-neutral-900 focus:border-neutral-900 focus:bg-neutral-50 ${S(Y)}`}`,placeholder:"?",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"}),!o&&u.jsx(C0,{isListening:K,onClick:()=>d(Y,_=>r(N.index,_)),disabled:o}),(o&&V||l)&&u.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 top-full mt-2 z-10",children:[u.jsxs("div",{className:"bg-neutral-900 text-white text-xs font-bold py-1 px-3 rounded-lg shadow-lg whitespace-nowrap flex items-center gap-1 animate-in zoom-in-95",children:[u.jsx(Fc,{size:10,className:"text-green-400"})," ",N.challenge.answer]}),u.jsx("div",{className:"w-2 h-2 bg-neutral-900 rotate-45 absolute left-1/2 -translate-x-1/2 -top-1"})]})]}),G&&u.jsx("span",{className:"text-lg font-medium text-neutral-800 text-left",children:G})]},N.index)})})]})},cm=({challenge:n,answer:e,onAnswer:s,isFinishing:r,result:o,showHint:l,itemLabel:d,instructionText:m,containerRef:p})=>{const[y,x]=D.useState(n.contexts.map(G=>({...G}))),[v,S]=D.useState(n.items.map(G=>({...G}))),[N,P]=D.useState(null),M=(G,Y)=>{const K=new Map(e);if(Y===null)K.delete(G);else{for(const[I,A]of K.entries())A===Y&&K.delete(I);K.set(G,Y)}s(K)};D.useEffect(()=>{const G=n.contexts.map(K=>({...K})),Y=n.items.map(K=>({...K}));if(e)for(const[K,I]of e.entries()){const A=G.findIndex(_=>_.id===K);A!==-1&&(G[A].matchId=I)}x(G),S(Y)},[e,n]);const j=G=>{r||P(Y=>Y===G?null:G)},V=G=>{r||!N||(M(G,N),P(null))},B=o&&typeof o=="object"&&"details"in o?o.details:{},H=()=>{r||s(new Map)};return u.jsxs("div",{ref:p,className:"flex flex-col gap-4 animate-in fade-in duration-300",children:[u.jsx("div",{className:"text-center",children:u.jsx("p",{className:"text-xs text-neutral-500 font-medium",children:m})}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsx("div",{className:"space-y-3",children:y.map(G=>{var C;const Y=r&&B[G.id]===!0,K=r&&B[G.id]===!1,I=n.items.find(R=>R.id===G.matchId),A=(C=n.items.find(R=>R.pairId===G.pairId))==null?void 0:C.text;let _="border-neutral-200";return r?(Y&&(_="border-green-400 bg-green-50"),K&&(_="border-red-400 bg-red-50")):l?_="border-yellow-400 bg-yellow-50":G.matchId&&(_="border-neutral-400 bg-neutral-50"),u.jsxs("button",{onClick:()=>V(G.id),disabled:r||!N,className:`relative w-full p-3 rounded-xl border-2 text-left transition-all duration-200 ${_} disabled:cursor-not-allowed`,children:[d(G),u.jsx("p",{className:"font-medium text-xs leading-snug text-neutral-600",children:G.text}),G.matchId&&!r&&!l&&u.jsx("p",{className:"font-bold text-xs mt-2 pt-2 border-t border-neutral-200",children:I==null?void 0:I.text}),l&&!r&&u.jsxs("div",{className:"mt-2 pt-2 border-t flex items-center gap-2 text-yellow-700 animate-in fade-in",children:[u.jsx(wl,{size:14,className:"text-yellow-600"}),u.jsx("p",{className:"font-bold text-xs",children:A})]}),r&&u.jsxs("div",{className:"mt-2 pt-2 border-t flex items-center gap-2",children:[Y?u.jsx(wl,{size:14,className:"text-green-500"}):u.jsx(hn,{size:14,className:"text-red-500"}),u.jsx("p",{className:`font-bold text-xs ${K?"text-red-700":"text-green-700"}`,children:(I==null?void 0:I.text)||"No selection"})]}),r&&K&&u.jsxs("p",{className:"text-[10px] text-green-700 font-bold mt-1",children:["Correct: ",A]})]},G.id)})}),u.jsx("div",{className:"space-y-3",children:v.map(G=>{var A;const Y=N===G.id,K=e==null?void 0:e.has(((A=y.find(_=>_.matchId===G.id))==null?void 0:A.id)||"");let I="bg-white border-neutral-200 text-neutral-800 hover:border-neutral-900";return r&&K?I="bg-neutral-100 border-neutral-200 text-neutral-400 opacity-60":Y?I="bg-indigo-600 border-indigo-600 text-white ring-4 ring-indigo-100":K&&(I="bg-neutral-100 border-neutral-200 text-neutral-400 opacity-60"),u.jsx("button",{onClick:()=>j(G.id),disabled:r||K,className:`w-full p-3 rounded-xl border-2 text-left transition-all duration-200 disabled:cursor-not-allowed ${I}`,children:u.jsx("p",{className:"font-bold text-sm leading-snug",children:G.text})},G.id)})})]}),e&&e.size>0&&!r&&u.jsx("div",{className:"flex justify-center pt-2",children:u.jsxs("button",{onClick:H,className:"flex items-center gap-1.5 text-xs font-bold text-neutral-500 hover:text-neutral-900 transition-colors",children:[u.jsx(Sl,{size:12})," Reset"]})})]})},T4=({challenge:n,onAnswer:e,isFinishing:s,result:r,containerRef:o})=>{const[l,d]=D.useState(!1),[m,p]=D.useState(""),y=D.useRef(null);D.useEffect(()=>{try{y.current=new N0}catch(P){console.error("Speech Recognition not supported",P)}return()=>{var P;(P=y.current)==null||P.stop()}},[]);const x=()=>{y.current&&(p(""),d(!0),y.current.start((P,M)=>p(P+M),P=>{d(!1),e(P)}))},v=()=>{var P;(P=y.current)==null||P.stop()},S=()=>{l?v():x()},N=r===!0;return u.jsxs("div",{ref:o,className:"text-center space-y-8 animate-in fade-in duration-300 flex flex-col items-center",children:[u.jsx("p",{className:"text-sm font-bold text-neutral-500",children:"Press the button and pronounce the word below."}),u.jsx("h2",{className:"text-4xl font-black text-neutral-900 tracking-tight",children:n.word.word}),u.jsx("button",{onClick:S,disabled:s,className:`w-24 h-24 rounded-full flex items-center justify-center shadow-lg transition-all active:scale-95 disabled:opacity-50
                    ${l?"bg-neutral-900 text-white animate-pulse":"bg-red-600 text-white hover:scale-105 shadow-red-500/30"}`,children:l?u.jsx(Af,{size:32,fill:"white"}):u.jsx(mo,{size:32})}),u.jsx("div",{className:"w-full max-w-sm min-h-[6rem] p-4 bg-neutral-50 border border-neutral-200 rounded-xl text-lg font-medium text-neutral-600 italic",children:m||"..."}),s&&u.jsxs("div",{className:`flex items-center gap-2 font-bold text-lg animate-in fade-in slide-in-from-bottom-2 ${N?"text-green-600":"text-red-600"}`,children:[N?u.jsx(K2,{size:20}):u.jsx(J2,{size:20}),u.jsx("span",{children:N?"Correct!":`Not quite. The word was "${n.word.word}".`})]})]})},um=({word:n,title:e,cue:s,options:r,answer:o,selected:l,onAnswer:d,isFinishing:m,showHint:p,containerRef:y})=>u.jsxs("div",{ref:y,className:"text-center space-y-6 animate-in fade-in duration-300 flex flex-col",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:e}),u.jsx("h2",{className:"text-3xl font-black text-neutral-900",children:n.word}),s&&u.jsx("div",{className:"inline-flex items-center gap-2 bg-neutral-100 px-3 py-1.5 rounded-lg border border-neutral-200 max-w-sm mx-auto mt-2",children:u.jsx("span",{className:"text-xs font-bold text-neutral-700 italic",children:s})})]}),u.jsx("div",{className:"grid grid-cols-1 gap-3",children:r.map((x,v)=>{let S="bg-white border-neutral-200 hover:border-neutral-400 text-neutral-700";return m?x===o?S="bg-green-50 border-green-500 text-green-700 shadow-md ring-1 ring-green-500":x===l&&x!==o?S="bg-red-50 border-red-500 text-red-700 opacity-60":S="bg-neutral-50 border-neutral-100 text-neutral-400 opacity-40":p&&x===o?S="bg-yellow-50 border-yellow-400 text-yellow-800 shadow-md ring-1 ring-yellow-400":l===x&&(S="bg-neutral-900 border-neutral-900 text-white shadow-lg"),u.jsx("button",{disabled:m,onClick:()=>d(x),className:`p-4 rounded-2xl border-2 text-sm font-medium transition-all duration-200 text-left leading-snug active:scale-[0.98] ${S}`,children:x},v)})})]}),dm=({word:n,title:e,cue:s,contextTag:r,answer:o,userAnswer:l,onAnswer:d,isFinishing:m,result:p,showHint:y,containerRef:x,toggleListening:v,listeningId:S})=>{const{clearValidation:N,handleSmartChange:P,handleValidationKeyDown:M,getValidationClass:j}=qf(),V=p===!0,B=p===!1,H="main",G=S===H;return u.jsxs("div",{ref:x,className:"text-center space-y-8 animate-in fade-in duration-300 flex flex-col items-center",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:e}),u.jsx("h2",{className:"text-3xl font-black text-neutral-900",children:n.word}),(s||r)&&u.jsxs("div",{className:"inline-flex items-center gap-2 bg-neutral-100 px-3 py-1.5 rounded-lg border border-neutral-200 max-w-sm",children:[r&&u.jsx("span",{className:"text-[9px] font-black uppercase bg-white px-1.5 py-0.5 rounded border border-neutral-200 text-neutral-500",children:r}),s&&u.jsx("span",{className:"text-xs font-bold text-neutral-700 italic",children:s})]})]}),u.jsxs("div",{className:"w-full max-w-md flex flex-col items-center gap-3",children:[u.jsxs("div",{className:"relative w-full",children:[u.jsx("input",{type:"text",autoFocus:!0,value:l||"",onChange:Y=>{N(H),P(Y,d,n.word)},onKeyDown:Y=>{M(Y,H,o)},disabled:m,className:`w-full text-center py-4 pl-12 pr-12 rounded-2xl border-2 text-xl font-bold focus:outline-none placeholder:text-neutral-200 transition-colors duration-200 ${m?V?"bg-green-50 border-green-500 text-green-600":"bg-red-50 border-red-500 text-red-600":`bg-neutral-50 border-transparent focus:bg-white focus:border-neutral-900 text-neutral-900 shadow-sm ${j(H)}`}`,placeholder:"Type answer...",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"}),!m&&u.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:u.jsx(C0,{isListening:G,onClick:()=>v(H,d),disabled:m})})]}),(m&&B||y)&&u.jsx("div",{className:"text-green-600 font-bold text-lg animate-in slide-in-from-top-2 bg-green-50 px-3 py-1 rounded-lg border border-green-100 inline-block",children:o})]})]})},A4=({word:n,userAnswer:e,onAnswer:s,isFinishing:r,resultDetails:o,showHint:l,containerRef:d,toggleListening:m,listeningId:p})=>{const{clearValidation:y,handleSmartChange:x,handleValidationKeyDown:v,getValidationClass:S}=qf(),N=n.wordFamily,P=e||{},M=(j,V)=>{s({...P,[j]:V})};return u.jsxs("div",{ref:d,className:"space-y-6 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"text-center space-y-1",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Word Family"}),u.jsx("h2",{className:"text-3xl font-black text-neutral-900",children:n.word}),u.jsx("p",{className:"text-xs font-bold text-neutral-500",children:"Fill related forms"})]}),u.jsx("div",{className:"grid grid-cols-1 gap-4",children:["nouns","verbs","adjs","advs"].map(j=>{const V=((N==null?void 0:N[j])||[]).filter(A=>!A.isIgnored).map(A=>A.word);if(V.length===0)return null;const B={nouns:"Noun",verbs:"Verb",adjs:"Adjective",advs:"Adverb"}[j],H=P[j]||"",G=o[j],Y=r,K=`fam-${j}`,I=p===K;return u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:"w-20 text-[10px] font-black uppercase text-neutral-400 text-right",children:B}),u.jsxs("div",{className:"flex-1 relative flex items-center gap-2",children:[u.jsx("input",{type:"text",value:H,onChange:A=>{y(K),x(A,_=>M(j,_),n.word)},onKeyDown:A=>{v(A,K,V)},disabled:r,className:`w-full px-4 py-2 bg-neutral-50 border-2 rounded-xl text-sm font-bold outline-none transition-all ${Y?G?"border-green-500 bg-green-50 text-green-800":"border-red-500 bg-red-50 text-red-800":`border-neutral-100 focus:border-neutral-900 focus:bg-white ${S(K)}`}`,placeholder:"..."}),!r&&u.jsx(C0,{isListening:I,onClick:()=>m(K,A=>M(j,A)),disabled:r}),(Y&&!G||l)&&u.jsx("div",{className:"text-[10px] font-bold text-green-600 mt-1 pl-1",children:((N==null?void 0:N[j])||[]).filter(A=>!A.isIgnored).map(A=>A.word).join(", ")})]})]},j)})})]})},I4=({word:n,original:e,shuffled:s,userAnswer:r,onAnswer:o,isFinishing:l,isCorrect:d,showHint:m,containerRef:p})=>{const[y,x]=Pn.useState(0),v=r||[],S=new Set;v.forEach(j=>{const V=s.findIndex((B,H)=>B===j&&!S.has(H));V!==-1&&S.add(V)});const N=j=>{if(l)return;const V=[...v];V.splice(y,0,j),o(V),x(B=>B+1)},P=j=>{if(l)return;const V=[...v];V.splice(j,1),o(V),y>j&&x(B=>B-1)},M=({index:j})=>{const V=j===y;return l?u.jsx("div",{className:"w-1 mx-0.5"}):u.jsx("div",{onClick:()=>x(j),className:`h-8 w-2 rounded-full cursor-pointer transition-all duration-200 mx-0.5 flex items-center justify-center ${V?"bg-indigo-500 scale-110 shadow-sm":"bg-transparent hover:bg-neutral-200"}`,children:u.jsx("div",{className:`w-1 h-4 rounded-full ${V?"bg-white/50":"bg-transparent"}`})})};return u.jsxs("div",{ref:p,className:"flex flex-col space-y-6 animate-in fade-in duration-300",children:[u.jsxs("div",{className:"text-center space-y-1",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Sentence Builder"}),u.jsxs("p",{className:"text-xs text-neutral-500 font-medium",children:['Reconstruct the example sentence for "',n.word,'".']})]}),u.jsxs("div",{className:`min-h-[120px] p-6 rounded-[2rem] border-2 border-dashed flex flex-wrap gap-y-3 items-center justify-center transition-all ${l?d?"bg-green-50 border-green-200":"bg-red-50 border-red-200":"bg-neutral-50 border-neutral-200"}`,children:[v.length===0&&!l&&u.jsx("span",{className:"absolute text-sm font-bold text-neutral-300 italic pointer-events-none",children:"Click words below to build sentence..."}),u.jsx(M,{index:0}),v.map((j,V)=>u.jsxs(Pn.Fragment,{children:[u.jsxs("button",{onClick:()=>P(V),disabled:l,className:`px-3 py-2 rounded-xl text-sm font-bold shadow-sm transition-all active:scale-95 flex items-center gap-1 group ${l?d?"bg-green-600 text-white":"bg-red-500 text-white":"bg-white text-neutral-900 border border-neutral-100 hover:border-red-200 hover:text-red-500"}`,children:[j," ",!l&&u.jsx(hn,{size:14,className:"opacity-40 group-hover:opacity-100"})]}),u.jsx(M,{index:V+1})]},`${j}-${V}`))]}),(l||m)&&u.jsxs("div",{className:"p-4 bg-yellow-50 rounded-2xl border border-yellow-100 animate-in slide-in-from-top-2",children:[u.jsx("p",{className:"text-xs font-black text-yellow-600 uppercase tracking-widest mb-1",children:"Correct Sentence"}),u.jsx("p",{className:"text-sm font-bold text-yellow-900 leading-relaxed",children:e})]}),u.jsx("div",{className:"flex flex-wrap gap-2 justify-center pt-4",children:s.map((j,V)=>{const B=S.has(V);return u.jsx("button",{onClick:()=>N(j),disabled:B||l,className:`px-4 py-2.5 rounded-xl text-sm font-bold transition-all active:scale-95 ${B?"bg-neutral-100 text-neutral-300 border-transparent cursor-default":"bg-white border-2 border-neutral-100 text-neutral-700 hover:border-neutral-900 hover:text-neutral-900 shadow-sm"}`,children:j},V)})}),!l&&v.length>0&&u.jsxs("button",{onClick:()=>o([]),className:"mx-auto flex items-center space-x-1.5 text-[10px] font-black uppercase text-neutral-400 hover:text-neutral-600 transition-colors",children:[u.jsx(hn,{size:12}),u.jsx("span",{children:"Reset"})]})]})},N4=({word:n,forms:e,ipaOptions:s,userAnswer:r,onAnswer:o,isFinishing:l,result:d,showHint:m,containerRef:p})=>{const y=r||{},x=(v,S)=>{o({...y,[v]:S})};return u.jsxs("div",{ref:p,className:"text-center space-y-6 animate-in fade-in duration-300",children:[u.jsxs("p",{className:"text-sm font-bold text-neutral-500",children:["The word ",u.jsxs("span",{className:"font-black text-neutral-900",children:['"',n.word,'"']})," has different pronunciations. Match the IPA to the part of speech."]}),u.jsx("div",{className:"space-y-6",children:e.map(v=>{const S=y[v.pos];return u.jsxs("div",{className:"space-y-3",children:[u.jsxs("h4",{className:"text-sm font-black text-neutral-900 uppercase tracking-widest bg-neutral-100 py-1 rounded-md",children:["As a ",v.pos]}),u.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.map(N=>{let P="bg-white border-neutral-200 hover:border-neutral-400 text-neutral-600";return l?N===v.ipa?P="bg-green-50 border-green-500 text-green-700 shadow-md":N===S?P="bg-red-50 border-red-500 text-red-700 opacity-60":P="bg-neutral-50 border-neutral-100 text-neutral-400 opacity-50":S===N&&(P="bg-neutral-900 border-neutral-900 text-white shadow-lg"),u.jsx("button",{disabled:l,onClick:()=>x(v.pos,N),className:`p-3 rounded-xl border-2 font-mono text-base font-medium transition-all duration-200 ${P}`,children:N},N)})})]},v.pos)})}),l&&d===!1&&!m&&u.jsx("div",{className:"text-center text-rose-600 font-bold text-sm",children:"One or more selections were incorrect."})]})},C4=({word:n,userAnswer:e,onAnswer:s,isFinishing:r,result:o,showHint:l,containerRef:d})=>{const{clearValidation:m,handleSmartChange:p,handleValidationKeyDown:y,getValidationClass:x}=qf(),v=o===!0,S=o===!1,N="main";return u.jsxs("div",{ref:d,className:"text-center space-y-8 animate-in fade-in duration-300",children:[u.jsx("p",{className:"text-sm font-bold text-neutral-500",children:"Listen carefully and type the word."}),u.jsxs("div",{className:"space-y-6 flex flex-col items-center",children:[u.jsx("button",{onClick:()=>os(n.word),className:"p-6 bg-neutral-50 hover:bg-neutral-100 text-neutral-900 rounded-full shadow-sm transition-all active:scale-95",children:u.jsx(va,{size:32})}),u.jsxs("div",{className:"w-full max-w-sm flex flex-col items-center gap-4",children:[u.jsx("div",{className:"relative w-full",children:u.jsx("input",{type:"text",autoFocus:!0,value:e||"",onChange:P=>{m(N),p(P,s,n.word)},onKeyDown:P=>{y(P,N,n.word)},disabled:r,className:`w-full text-center py-4 rounded-2xl border-2 text-3xl font-bold focus:outline-none tracking-[0.1em] placeholder:text-neutral-200 transition-colors duration-200 ${r?v?"bg-green-50 border-green-500 text-green-600":"bg-red-50 border-red-500 text-red-600":`bg-neutral-50 border-transparent focus:bg-white focus:border-neutral-900 text-neutral-900 shadow-sm ${x(N)}`}`,placeholder:"TYPE HERE",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false"})}),(r&&S||l)&&u.jsx("div",{className:"text-xl font-black text-yellow-500 animate-in fade-in slide-in-from-bottom-2",children:n.word})]})]})]})},R4=({word:n,currentChallenge:e,currentChallengeIndex:s,userAnswers:r,handleAnswerChange:o,results:l,isFinishing:d,currentPrepositionGroup:m,showHint:p,onEnterPress:y})=>{const x=D.useRef(null),[v,S]=D.useState(null),N=D.useRef(null);D.useEffect(()=>{try{N.current=new N0}catch{}return()=>{var M;(M=N.current)==null||M.stop()}},[]),D.useEffect(()=>{var M;(M=N.current)==null||M.stop(),S(null)},[s,m]);const P=(M,j)=>{N.current&&(v===M?(N.current.stop(),S(null)):(v&&N.current.stop(),j(""),S(M),N.current.start((V,B)=>{const H=V+(B?(V?" ":"")+B:"");j(H)},V=>{const B=V.trim().replace(/[.]/g,"");j(B),S(null)})))};if(D.useEffect(()=>{const M=()=>{var B,H;const V=(B=x.current)==null?void 0:B.querySelector('input[type="text"]:not([disabled]), textarea:not([disabled])');V&&!((H=x.current)!=null&&H.contains(document.activeElement))&&V.focus()};setTimeout(M,50);const j=V=>{var B;if(!(V.metaKey||V.ctrlKey||V.altKey)){if(V.key==="Enter"){const H=document.activeElement;if(H&&H.tagName==="TEXTAREA"&&V.shiftKey)return;V.preventDefault(),y();return}if(V.key.length===1){const H=document.activeElement;((B=x.current)==null?void 0:B.contains(H))||M()}}};return window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j)},[s,y]),m)return u.jsx(S4,{containerRef:x,group:m.group,userAnswers:r,results:l,onAnswerChange:o,isFinishing:d,showHint:p,toggleListening:P,listeningId:v});switch(e.type){case"PARAPHRASE_CONTEXT_QUIZ":{const M=e;return u.jsx(cm,{containerRef:x,challenge:{contexts:M.contexts,items:M.paraphrases},answer:r[s],onAnswer:j=>o(s,j),isFinishing:d,result:l?l[s]:null,showHint:p,itemLabel:j=>j.tone&&u.jsx("span",{className:"inline-block text-[9px] font-black uppercase bg-neutral-100 text-neutral-500 px-1.5 py-0.5 rounded border border-neutral-200 mb-1",children:j.tone}),instructionText:"Match each phrase on the right to its correct context on the left."})}case"COLLOCATION_CONTEXT_QUIZ":{const M=e;return u.jsx(cm,{containerRef:x,challenge:{contexts:M.contexts,items:M.collocations},answer:r[s],onAnswer:j=>o(s,j),isFinishing:d,result:l?l[s]:null,showHint:p,itemLabel:()=>null,instructionText:"Match each collocation on the right to its correct definition/cue."})}case"IDIOM_CONTEXT_QUIZ":{const M=e;return u.jsx(cm,{containerRef:x,challenge:{contexts:M.contexts,items:M.idioms},answer:r[s],onAnswer:j=>o(s,j),isFinishing:d,result:l?l[s]:null,showHint:p,itemLabel:()=>null,instructionText:"Match each idiom on the right to its correct definition/cue."})}case"COLLOCATION_MULTICHOICE_QUIZ":{const M=e;return u.jsx(um,{containerRef:x,word:n,title:"Select Collocation",cue:M.cue,options:M.options,answer:M.answer,selected:r[s],onAnswer:j=>o(s,j),isFinishing:d,showHint:p})}case"COLLOCATION_QUIZ":{const M=e,j=l?l[s]:null,V=typeof j=="boolean"?j:j&&typeof j=="object"?j.correct:null;return u.jsx(dm,{containerRef:x,word:n,title:"Fill Collocation",cue:M.cue,answer:M.answer,userAnswer:r[s],onAnswer:B=>o(s,B),isFinishing:d,result:V,showHint:p,toggleListening:P,listeningId:v})}case"IDIOM_QUIZ":{const M=e,j=l?l[s]:null,V=typeof j=="boolean"?j:j&&typeof j=="object"?j.correct:null;return u.jsx(dm,{containerRef:x,word:n,title:"Fill Idiom",cue:M.cue,answer:M.answer,userAnswer:r[s],onAnswer:B=>o(s,B),isFinishing:d,result:V,showHint:p,toggleListening:P,listeningId:v})}case"PRONUNCIATION":return u.jsx(T4,{containerRef:x,challenge:e,onAnswer:M=>o(s,M),isFinishing:d,result:l?l[s]:null});case"HETERONYM_QUIZ":{const M=e,j=l?l[s]:null,V=typeof j=="boolean"?j:null;return u.jsx(N4,{containerRef:x,word:n,forms:M.forms,ipaOptions:M.ipaOptions,userAnswer:r[s],onAnswer:B=>o(s,B),isFinishing:d,result:V,showHint:p})}case"SENTENCE_SCRAMBLE":{const M=e,j=l?l[s]:null,V=typeof j=="boolean"?j:null;return u.jsx(I4,{containerRef:x,word:n,original:M.original,shuffled:M.shuffled||[],userAnswer:r[s],onAnswer:B=>o(s,B),isFinishing:d,isCorrect:V,showHint:p})}case"SPELLING":{const M=l?l[s]:null,j=typeof M=="boolean"?M:null;return u.jsx(C4,{containerRef:x,word:n,userAnswer:r[s],onAnswer:V=>o(s,V),isFinishing:d,result:j,showHint:p})}case"IPA_QUIZ":{const M=e;return u.jsx(um,{containerRef:x,word:n,title:"Select Pronunciation",options:M.options,answer:M.answer,selected:r[s],onAnswer:j=>o(s,j),isFinishing:d,showHint:p})}case"MEANING_QUIZ":{const M=e;return u.jsx(um,{containerRef:x,word:n,title:"Select Definition",options:M.options,answer:M.answer,selected:r[s],onAnswer:j=>o(s,j),isFinishing:d,showHint:p})}case"PARAPHRASE_QUIZ":{const M=e,j=l?l[s]:null,V=typeof j=="boolean"?j:null;return u.jsx(dm,{containerRef:x,word:n,title:"Fill Paraphrase",contextTag:M.tone,cue:M.context,answer:M.answer,userAnswer:r[s],onAnswer:B=>o(s,B),isFinishing:d,result:V,showHint:p,toggleListening:P,listeningId:v})}case"WORD_FAMILY":{const M=l?l[s]:null,j=M&&typeof M=="object"&&"details"in M?M.details:{};return u.jsx(A4,{containerRef:x,word:n,userAnswer:r[s],onAnswer:V=>o(s,V),isFinishing:d,resultDetails:j,showHint:p,toggleListening:P,listeningId:v})}default:return null}},O4=({onBack:n,onNext:e,onIgnore:s,onHint:r,showHint:o,isBackDisabled:l,isNextDisabled:d,isLastChallenge:m,nextLabel:p,disableHints:y})=>{const x=m&&!p;return u.jsxs("div",{className:"p-4 bg-white border-t border-neutral-100 flex items-center justify-between gap-3 shrink-0",children:[u.jsx("button",{onClick:n,disabled:l,className:"p-4 rounded-2xl bg-neutral-50 text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 disabled:opacity-30 disabled:hover:bg-neutral-50 disabled:hover:text-neutral-400 transition-all",title:"Previous Question",children:u.jsx(AE,{size:20})}),!m&&!d&&u.jsx("button",{onClick:s,className:"px-4 py-4 rounded-2xl text-neutral-400 hover:text-neutral-600 font-bold text-xs uppercase tracking-wider hover:bg-neutral-50 transition-colors",children:"Ignore"}),!d&&!y&&u.jsx("button",{onClick:r,className:`p-4 rounded-2xl transition-colors ${o?"text-yellow-500 bg-yellow-50 hover:bg-yellow-100":"text-neutral-400 hover:text-yellow-500 hover:bg-neutral-50"}`,title:"Show Hint",children:u.jsx(Cg,{size:20,className:o?"fill-yellow-500":""})}),u.jsxs("button",{onClick:e,disabled:d,className:"flex-1 py-4 rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 shadow-lg transition-all active:scale-95 bg-neutral-900 text-white hover:bg-neutral-800",children:[u.jsx("span",{children:p||(m?"Finish":"Next")}),x?u.jsx(ba,{size:16}):u.jsx(Fc,{size:16})]})]})},M1=[{id:"core",title:"Core Skills",description:"Essential accuracy",color:"text-blue-700",bg:"bg-blue-50/60",border:"border-blue-100",areas:[{id:"spelling",label:"Spelling",icon:TI,types:["SPELLING"]},{id:"sound",label:"Sound",icon:va,types:["PRONUNCIATION","IPA_QUIZ","HETERONYM_QUIZ"]},{id:"meaning",label:"Meaning",icon:wf,types:["MEANING_QUIZ"]},{id:"preposition",label:"Prep.",icon:Ig,types:["PREPOSITION_QUIZ"]}]},{id:"advanced",title:"Advanced Usage",description:"Fluency & range",color:"text-purple-700",bg:"bg-purple-50/60",border:"border-purple-100",areas:[{id:"family",label:"Word Family",icon:BE,types:["WORD_FAMILY"]},{id:"collocation",label:"Collocation",icon:Sf,types:["COLLOCATION_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ","COLLOCATION_QUIZ"]},{id:"paraphrase",label:"Paraphrase",icon:Nf,types:["PARAPHRASE_CONTEXT_QUIZ","PARAPHRASE_QUIZ"]}]},{id:"bonus",title:"Good to Have",description:"Context & Flair",color:"text-amber-700",bg:"bg-amber-50/60",border:"border-amber-100",areas:[{id:"idiom",label:"Idiom",icon:Tf,types:["IDIOM_CONTEXT_QUIZ","IDIOM_QUIZ"]},{id:"example",label:"Example",icon:_I,types:["SENTENCE_SCRAMBLE"]}]}],fm={MEANING_QUIZ:"Select",COLLOCATION_CONTEXT_QUIZ:"Match",COLLOCATION_MULTICHOICE_QUIZ:"Multi",COLLOCATION_QUIZ:"Fill",PARAPHRASE_CONTEXT_QUIZ:"Match",PARAPHRASE_QUIZ:"Fill",PREPOSITION_QUIZ:"Fill",IDIOM_QUIZ:"Fill",IDIOM_CONTEXT_QUIZ:"Match",PRONUNCIATION:"Speak",IPA_QUIZ:"IPA",HETERONYM_QUIZ:"Match",SPELLING:"Dictation",SENTENCE_SCRAMBLE:"Build",WORD_FAMILY:"Fill"},j4=[{label:"Dictation",desc:"Listen to the word and type the exact spelling."},{label:"Speak",desc:"Pronounce the word clearly into your microphone."},{label:"IPA",desc:"Identify the correct phonetic transcription."},{label:"Select",desc:"Choose the correct meaning from options."},{label:"Fill",desc:"Type missing parts (Prepositions, Idioms, Families)."},{label:"Match",desc:"Connect related items (Collocations, Idioms, Contexts)."},{label:"Build",desc:"Reorder scrambled words to form a valid sentence."},{label:"Multi",desc:"Multiple choice for collocations."}],k4=(n,e)=>{if(e===0)return{label:"N/A",color:"bg-neutral-50 text-neutral-400 border-neutral-100"};const s=n/e*100;let r="bg-neutral-50 text-neutral-400 border-neutral-100";return s===100?r="bg-green-50 text-green-700 border-green-100":n>0?r="bg-yellow-50 text-yellow-700 border-yellow-100":r="bg-red-50 text-red-600 border-red-100",{label:`${n}/${e}`,color:r}},D1=n=>{switch(n){case"NEW":return"bg-blue-100 text-blue-700 border-blue-200";case"LEARNED":return"bg-cyan-100 text-cyan-700 border-cyan-200";case"EASY":return"bg-green-100 text-green-700 border-green-200";case"HARD":return"bg-orange-100 text-orange-700 border-orange-200";case"FORGOT":return"bg-red-100 text-red-700 border-red-200";default:return"bg-neutral-100 text-neutral-600 border-neutral-200"}},L4=({isModal:n=!0,word:e,onClose:s,isSetupMode:r,isPreparing:o,availableChallenges:l,selectedChallengeTypes:d,onSetSelection:m,onStartTest:p,challengeStats:y,challenges:x,currentChallenge:v,currentChallengeIndex:S,userAnswers:N,handleAnswerChange:P,results:M,isFinishing:j,currentPrepositionGroup:V,isLastChallenge:B,handleNextClick:H,handleBackClick:G,handleIgnore:Y,handleFinishEarly:K,showHint:I,onToggleHint:A,disableHints:_,sessionPosition:C,elapsedTime:R,onSelectQuick:L,onSelectPreferred:O,onSelectZeroScore:xe,onSelectPartialScore:ge,recapData:F,onRecalculateFinish:ue,isMastered:ae})=>{const X=D.useRef(null),[Q,T]=D.useState(!1),[z,$]=D.useState(!1);D.useEffect(()=>{X.current&&(X.current.scrollTop=0)},[S,e]);const J=D.useMemo(()=>new Set(l.map(le=>le.type)),[l]),pe=(le,ie)=>{const he=new Set(d);le.forEach(Ie=>he.delete(Ie)),ie!=="none"&&he.add(ie),m(he)},de=()=>M1.flatMap(le=>le.areas),_e=()=>{const le=new Set;de().forEach(ie=>{const he=ie.types.find(Ie=>J.has(Ie));he&&le.add(he)}),m(le)};let W;if(F){const le=Math.max(0,F.newMastery-F.oldMastery),ie=Object.values(F.results.reduce((he,Ie)=>{if(!he[Ie.type]){let Ue=fm[Ie.type]||Ie.type;const je=de().find(wt=>wt.types.includes(Ie.type));je&&(Ue=`${je.label} ${fm[Ie.type]||""}`),he[Ie.type]={type:Ie.type,label:Ue.trim(),passed:0,total:0}}return he[Ie.type].total++,Ie.passed&&he[Ie.type].passed++,he},{}));W=u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-500",children:[u.jsxs("div",{className:"flex-1 overflow-y-auto p-8 text-center space-y-6 custom-scrollbar",children:[u.jsx("div",{className:"inline-flex p-4 bg-green-50 rounded-full text-green-600 mb-2 shadow-inner",children:u.jsx(ba,{size:48})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:"Session Complete!"}),u.jsx("p",{className:"text-sm text-neutral-500 font-medium",children:"Here's how you improved."})]}),u.jsxs("div",{className:"bg-neutral-50 rounded-3xl p-6 border border-neutral-100 space-y-6",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex justify-between items-end px-1",children:[u.jsx("span",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Mastery Score"}),u.jsxs("span",{className:"text-sm font-black text-neutral-900 flex items-center gap-1",children:[F.oldMastery,"%",u.jsx(Fc,{size:14,className:"text-neutral-300"}),u.jsxs("span",{className:"text-green-600",children:[F.newMastery,"%"]}),le>0&&u.jsxs("span",{className:"text-[10px] bg-green-100 text-green-700 px-1.5 rounded-full ml-1",children:["+",le]})]})]}),u.jsxs("div",{className:"h-3 w-full bg-neutral-200 rounded-full overflow-hidden relative",children:[u.jsx("div",{className:"absolute top-0 left-0 h-full bg-neutral-400",style:{width:`${F.oldMastery}%`}}),u.jsx("div",{className:"absolute top-0 h-full bg-green-500 animate-pulse",style:{left:`${F.oldMastery}%`,width:`${le}%`}})]})]}),u.jsxs("div",{className:"flex items-center justify-center gap-3",children:[u.jsx("span",{className:`px-3 py-1 rounded-xl text-xs font-black uppercase border ${D1(F.oldStatus)}`,children:F.oldStatus}),u.jsx(Fc,{size:16,className:"text-neutral-300"}),u.jsx("span",{className:`px-3 py-1 rounded-xl text-xs font-black uppercase border ${D1(F.newStatus)}`,children:F.newStatus})]})]}),u.jsxs("div",{className:"space-y-2 text-left",children:[u.jsx("h4",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest px-2",children:"Challenge Summary"}),u.jsx("div",{className:"flex flex-col gap-2",children:ie.map((he,Ie)=>{const Ue=he.passed===he.total,je=he.passed===0;let wt="bg-white border-neutral-100",Re="text-neutral-700",we=null;return Ue?(wt="bg-green-50 border-green-100",Re="text-green-800",we=u.jsx(wl,{size:14,className:"text-green-600"})):je?(wt="bg-red-50 border-red-100",Re="text-red-800",we=u.jsx(hn,{size:14,className:"text-red-600"})):(wt="bg-orange-50 border-orange-100",Re="text-orange-800",we=u.jsxs("div",{className:"text-[10px] font-black text-orange-600",children:[Math.round(he.passed/he.total*100),"%"]})),u.jsxs("div",{className:`flex items-center justify-between p-3 border rounded-xl shadow-sm ${wt}`,children:[u.jsx("span",{className:`text-xs font-bold ${Re}`,children:he.label}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("span",{className:`text-[10px] font-black uppercase tracking-wider ${Re}`,children:[he.passed," / ",he.total]}),u.jsx("div",{className:"p-1 rounded-full bg-white/50",children:we})]})]},Ie)})})]})]}),u.jsx("div",{className:"p-6 bg-white border-t border-neutral-100 shrink-0",children:u.jsxs("button",{onClick:ue,className:"w-full py-4 bg-neutral-900 text-white rounded-2xl font-black text-sm uppercase tracking-widest shadow-xl hover:bg-neutral-800 transition-all active:scale-95 flex items-center justify-center gap-2",children:[u.jsx("span",{children:"Continue"}),u.jsx(Fc,{size:18})]})})]})}else if(r){const le=d.size===0;let ie=0,he=0;y.forEach(Re=>{ie+=Re.score,he+=Re.total});const Ie=he>0?ie/he*100:0,Ue=60,je=2*Math.PI*Ue,wt=je-Ie/100*je;W=u.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[2rem] shadow-2xl overflow-hidden flex flex-col max-h-[95vh] animate-in fade-in zoom-in-95 duration-300",children:[u.jsxs("div",{className:"px-6 py-4 border-b border-neutral-100 bg-white/80 backdrop-blur-sm flex justify-between items-center shrink-0 z-20 relative",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-neutral-900 text-white rounded-xl flex items-center justify-center shadow-lg shadow-neutral-900/20",children:u.jsx(lI,{size:20})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-black text-neutral-900 leading-none tracking-tight",children:"Test Setup"}),u.jsxs("p",{className:"text-xs font-bold text-neutral-500 mt-1",children:["Target: ",u.jsx("span",{className:"text-neutral-900",children:e.word})]})]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:"flex flex-col items-end mr-2",children:[u.jsx("span",{className:"text-[9px] font-black uppercase text-neutral-400 tracking-widest",children:"Mastery"}),u.jsxs("div",{className:"flex items-baseline gap-1",children:[u.jsx("span",{className:`text-xl font-black leading-none ${ie===he&&he>0?"text-green-600":"text-neutral-900"}`,children:ie}),u.jsxs("span",{className:"text-sm font-bold text-neutral-400",children:["/",he]})]})]}),u.jsx("button",{onClick:()=>$(!z),className:`p-2.5 rounded-xl transition-all ${z?"bg-neutral-900 text-white shadow-md":"bg-neutral-100 text-neutral-500 hover:bg-neutral-200"}`,title:"Configure Test",children:u.jsx(bI,{size:20})}),u.jsx("button",{onClick:s,className:"p-2.5 text-neutral-400 hover:text-neutral-900 hover:bg-neutral-100 rounded-xl transition-colors",children:u.jsx(hn,{size:20})})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar relative",children:z?u.jsxs("div",{className:"flex flex-col h-full animate-in slide-in-from-top-4 duration-300",children:[u.jsxs("div",{className:"px-5 py-3 bg-neutral-50 border-b border-neutral-100 flex flex-wrap gap-2 shrink-0 z-10 justify-center",children:[u.jsxs("button",{onClick:_e,className:"px-3 py-2 rounded-lg bg-white border border-neutral-200 text-neutral-600 font-bold text-[10px] uppercase tracking-wider hover:bg-neutral-50 transition-colors flex items-center gap-1.5 shadow-sm",children:[u.jsx(VE,{size:12})," All"]}),u.jsxs("button",{onClick:()=>m(new Set),className:"px-3 py-2 rounded-lg bg-white border border-neutral-200 text-neutral-400 font-bold text-[10px] uppercase tracking-wider hover:bg-neutral-50 hover:text-neutral-600 transition-colors flex items-center gap-1.5 shadow-sm",children:[u.jsx(sI,{size:12})," Clear"]}),u.jsxs("button",{onClick:()=>T(!Q),className:"px-3 py-2 rounded-lg bg-white border border-neutral-200 text-neutral-500 font-bold text-[10px] uppercase tracking-wider hover:bg-neutral-50 hover:text-indigo-500 transition-colors flex items-center gap-1.5 shadow-sm ml-auto",children:[u.jsx(Z2,{size:12})," Guide"]})]}),Q&&u.jsx("div",{className:"bg-neutral-50 border-b border-neutral-100 p-4 grid grid-cols-2 gap-2 animate-in fade-in slide-in-from-top-2",children:j4.map(Re=>u.jsxs("div",{className:"text-[10px] text-neutral-500 leading-tight",children:[u.jsxs("span",{className:"font-black text-indigo-600 uppercase mr-1",children:[Re.label,":"]}),Re.desc]},Re.label))}),u.jsx("div",{className:"p-4 space-y-3",children:M1.map(Re=>{const we=Re.areas.filter(oe=>oe.types.some(ze=>J.has(ze)));if(we.length===0)return null;let rt=0,Qe=0;return we.forEach(oe=>{oe.types.forEach(ze=>{const et=y.get(ze);et&&(rt+=et.score,Qe+=et.total)})}),u.jsxs("div",{className:`rounded-2xl border ${Re.border} ${Re.bg} p-4`,children:[u.jsxs("div",{className:"flex items-baseline justify-between mb-3 border-b border-black/5 pb-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h4",{className:`text-xs font-black uppercase tracking-widest ${Re.color}`,children:Re.title}),u.jsxs("span",{className:"text-[10px] font-bold text-neutral-500 opacity-60 bg-white/50 px-1.5 py-0.5 rounded-md",children:["(",rt,"/",Qe,")"]})]}),u.jsx("span",{className:"text-[10px] font-bold text-neutral-500 opacity-60",children:Re.description})]}),u.jsx("div",{className:"space-y-2",children:we.map(oe=>{const ze=oe.types.filter(it=>J.has(it));if(ze.length===0)return null;const et=oe.types.find(it=>d.has(it));let vt=0,Ye=0;oe.types.forEach(it=>{const St=y.get(it);St&&(vt+=St.score,Ye+=St.total)});const We=k4(vt,Ye);return u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 p-2 rounded-xl bg-white/40 hover:bg-white/70 transition-colors border border-transparent hover:border-black/5",children:[u.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[u.jsx("div",{className:"p-1.5 bg-white rounded-lg shadow-sm text-neutral-600",children:u.jsx(oe.icon,{size:14})}),u.jsx("span",{className:`text-xs font-bold ${et?"text-neutral-900":"text-neutral-600"}`,children:oe.label}),u.jsx("span",{className:`text-[9px] font-black uppercase tracking-wider px-1.5 py-0.5 rounded-md border ${We.color}`,children:We.label})]}),u.jsx("div",{className:"flex flex-wrap gap-1.5 justify-end",children:ze.map(it=>{const St=et===it;return u.jsx("button",{onClick:()=>pe(oe.types,St?"none":it),className:`px-3 py-1.5 rounded-lg text-[10px] font-bold border transition-all ${St?"bg-neutral-900 border-neutral-900 text-white shadow-md transform scale-105":"bg-white border-neutral-200 text-neutral-500 hover:border-neutral-300 hover:text-neutral-700"}`,children:fm[it]||"Quiz"},it)})})]},oe.id)})})]},Re.id)})})]}):u.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-8 space-y-8 animate-in zoom-in-95 duration-500",children:[u.jsxs("div",{className:"relative w-48 h-48 flex items-center justify-center",children:[u.jsxs("svg",{className:"absolute w-full h-full transform -rotate-90",children:[u.jsx("circle",{cx:"50%",cy:"50%",r:Ue,stroke:"currentColor",strokeWidth:"12",fill:"transparent",className:"text-neutral-100"}),u.jsx("circle",{cx:"50%",cy:"50%",r:Ue,stroke:"currentColor",strokeWidth:"12",fill:"transparent",strokeDasharray:je,strokeDashoffset:wt,strokeLinecap:"round",className:`transition-all duration-1000 ease-out ${Ie===100?"text-green-500":"text-indigo-600"}`})]}),u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsxs("span",{className:"text-4xl font-black text-neutral-900 tracking-tighter",children:[Ie.toFixed(0),"%"]}),u.jsx("span",{className:"text-xs font-bold text-neutral-400 uppercase tracking-widest mt-1",children:"Mastery"})]})]}),u.jsx("p",{className:"text-center text-sm font-medium text-neutral-500 max-w-xs leading-relaxed",children:ie===he?"Incredible! You have mastered all challenges for this word. Keep practicing to maintain it.":"Ready to improve? Choose a quick mix or focus on what you haven't mastered yet."})]})}),u.jsx("div",{className:"px-6 py-5 bg-white border-t border-neutral-100 flex items-center justify-center shrink-0 z-20 gap-4",children:z?u.jsxs("button",{onClick:p,disabled:le||o,className:"w-full py-4 bg-neutral-900 text-white rounded-2xl font-black text-sm uppercase tracking-widest flex items-center justify-center gap-3 shadow-xl hover:bg-neutral-800 transition-all active:scale-95 disabled:opacity-50 disabled:active:scale-100 hover:shadow-2xl shadow-neutral-900/20",children:[o?u.jsx(Kt,{size:18,className:"animate-spin"}):u.jsx(cu,{size:18,fill:"currentColor"}),u.jsx("span",{children:o?"Preparing...":"Start Custom Test"})]}):u.jsxs(u.Fragment,{children:[ae?u.jsxs("button",{onClick:ge,className:"flex-1 py-4 bg-red-600 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-red-700 transition-all active:scale-95 shadow-lg shadow-red-200",children:[u.jsx(wI,{size:18}),u.jsx("span",{children:"Challenge"})]}):u.jsxs("button",{onClick:xe,className:"flex-1 py-4 bg-indigo-600 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-indigo-700 transition-all active:scale-95 shadow-lg shadow-indigo-200",children:[u.jsx(DE,{size:18}),u.jsx("span",{children:"Master It"})]}),u.jsxs("button",{onClick:L,className:"flex-1 py-4 bg-cyan-500 text-white rounded-2xl font-black text-xs uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-cyan-600 transition-all active:scale-95 shadow-lg shadow-cyan-200",children:[u.jsx(q2,{size:18}),u.jsx("span",{children:"Quick Test"})]})]})})]})}else{let le;C&&(C.current<C.total?le="Next Item":le="Finalize"),W=u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col max-h-[90vh] h-full",children:[u.jsx(w4,{title:v.title,type:v.type,currentStep:C?C.current:S+1,totalSteps:C?C.total:x.length,onClose:s,onFinish:K,label:C?"Item":"Challenge",isQuickFire:!!C,elapsedTime:R}),u.jsx("div",{ref:X,className:"flex-1 p-8 overflow-y-auto no-scrollbar",children:u.jsx(R4,{word:e,currentChallenge:v,currentChallengeIndex:S,userAnswers:N,handleAnswerChange:P,results:M,isFinishing:j,currentPrepositionGroup:V,showHint:I,onEnterPress:H})}),u.jsx(O4,{onBack:G,onNext:H,onIgnore:Y,onHint:A,showHint:I,isBackDisabled:C?C.current===1&&S===0:S===0,isNextDisabled:j,isLastChallenge:B,nextLabel:le,disableHints:_})]})}return n?u.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:W}):W},Zi=n=>[...n].sort(()=>Math.random()-.5),M4=n=>n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),Kn=n=>n.replace(/[^a-zA-Z0-9]/g,"").toLowerCase();function D4(n){const e=[];if(e.push({type:"SPELLING",title:"Spelling Fill",word:n}),e.push({type:"PRONUNCIATION",title:"Speak Out",word:n}),n.meaningVi&&n.meaningVi.length>0&&e.push({type:"MEANING_QUIZ",title:"Meaning Multi Choice",options:[],answer:n.meaningVi,word:n}),n.ipaMistakes&&n.ipaMistakes.length>0&&n.ipaUs&&e.push({type:"IPA_QUIZ",title:"IPA Multi Choice",options:Zi([n.ipaUs,...n.ipaMistakes]),answer:n.ipaUs,word:n}),n.collocationsArray&&n.collocationsArray.length>0){const s=n.collocationsArray.filter(r=>!r.isIgnored&&r.d);s.forEach(r=>{e.push({type:"COLLOCATION_QUIZ",title:"Collocation Fill",word:n,fullText:r.text,cue:r.d,answer:r.text}),s.length>=4&&e.push({type:"COLLOCATION_MULTICHOICE_QUIZ",title:"Collocation Multi Choice",word:n,fullText:r.text,cue:r.d,answer:r.text,options:[]})}),s.length>=2&&e.push({type:"COLLOCATION_CONTEXT_QUIZ",title:"Collocation Match",word:n,contexts:[],collocations:[]})}if(n.idiomsList&&n.idiomsList.length>0){const s=n.idiomsList.filter(r=>!r.isIgnored&&r.d);s.forEach(r=>{e.push({type:"IDIOM_QUIZ",title:"Idiom Fill",word:n,fullText:r.text,cue:r.d,answer:r.text})}),s.length>=2&&e.push({type:"IDIOM_CONTEXT_QUIZ",title:"Idiom Match",word:n,contexts:[],idioms:[]})}if(n.prepositions&&n.prepositions.length>0&&n.prepositions.filter(r=>!r.isIgnored).forEach(r=>{let o="";const l=n.word,d=r.prep,m=r.usage;if(m&&m.toLowerCase().includes(l.toLowerCase())){const p=new RegExp(`\\b${M4(d)}\\b`,"i");p.test(m)?o=m.replace(p,"___"):o=`${m} [___]`}else m?o=`${l} ___ ${m}`:o=`${l} ___`;e.push({type:"PREPOSITION_QUIZ",title:"Preposition Fill",example:o,answer:d,word:n})}),n.example&&n.example.trim().length>5){const s=n.example.trim().split(`
`).flatMap(r=>r.split(new RegExp("(?<=[.?!])\\s+"))).map(r=>r.trim()).filter(r=>r.length>5);for(const r of s){const o=r.split(/\s+/).filter(Boolean);if(o.length>=3){let d;if(o.length>10){d=[];let m=0;for(;m<o.length;){const p=Math.min(3,o.length-m);let y=1;p>1&&Math.random()<.5&&(p===2?y=2:y=Math.random()<.5?2:3);const x=o.slice(m,m+y).join(" ");d.push(x),m+=y}}else d=o;e.push({type:"SENTENCE_SCRAMBLE",title:"Sentence Builder",original:r.trim(),shuffled:Zi(d),word:n})}}}return n.wordFamily&&[...n.wordFamily.nouns||[],...n.wordFamily.verbs||[],...n.wordFamily.adjs||[],...n.wordFamily.advs||[]].filter(l=>!l.isIgnored&&l.word.trim()).some(l=>l.word.toLowerCase().trim()!==n.word.toLowerCase().trim())&&e.push({type:"WORD_FAMILY",title:"Word Family Fill",word:n}),n.paraphrases&&n.paraphrases.length>0&&n.paraphrases.filter(s=>!s.isIgnored).forEach(s=>{e.push({type:"PARAPHRASE_QUIZ",title:"Paraphrase Fill",tone:s.tone,context:s.context,answer:s.word,word:n})}),n.paraphrases&&n.paraphrases.filter(s=>!s.isIgnored&&s.context&&s.context.trim()).length>=2&&e.push({type:"PARAPHRASE_CONTEXT_QUIZ",title:"Paraphrase Match",word:n,contexts:[],paraphrases:[]}),e}async function U1(n,e){const s=[];for(const r of n)if(r.type==="MEANING_QUIZ"){const l=(await KE(3,e.id)).filter(m=>m.trim().toLowerCase()!==e.meaningVi.trim().toLowerCase()),d=Zi([e.meaningVi,...l]).slice(0,4);s.push({...r,options:d})}else if(r.type==="COLLOCATION_MULTICHOICE_QUIZ"){const l=(e.collocationsArray||[]).filter(m=>!m.isIgnored&&m.text!==r.answer).map(m=>m.text),d=Zi([r.answer,...l]).slice(0,4);s.push({...r,options:d})}else if(r.type==="PARAPHRASE_CONTEXT_QUIZ"){const o=r.word,l=(o.paraphrases||[]).filter(d=>!d.isIgnored&&d.context&&d.context.trim()).sort(()=>Math.random()-.5).slice(0,5);if(l.length>=2){const d=[],m=[];l.forEach((p,y)=>{const x=`${o.id}-${y}`;d.push({id:`context-${x}`,text:p.context,pairId:x,tone:p.tone}),m.push({id:`word-${x}`,text:p.word,pairId:x})}),s.push({...r,contexts:d,paraphrases:Zi(m)})}}else if(r.type==="COLLOCATION_CONTEXT_QUIZ"){const o=r.word,l=(o.collocationsArray||[]).filter(d=>!d.isIgnored&&d.d&&d.d.trim()).sort(()=>Math.random()-.5).slice(0,5);if(l.length>=2){const d=[],m=[];l.forEach((p,y)=>{const x=`${o.id}-col-${y}`;d.push({id:`context-${x}`,text:p.d,pairId:x}),m.push({id:`col-${x}`,text:p.text,pairId:x})}),s.push({...r,contexts:d,collocations:Zi(m)})}}else if(r.type==="IDIOM_CONTEXT_QUIZ"){const o=r.word,l=(o.idiomsList||[]).filter(d=>!d.isIgnored&&d.d&&d.d.trim()).sort(()=>Math.random()-.5).slice(0,5);if(l.length>=2){const d=[],m=[];l.forEach((p,y)=>{const x=`${o.id}-idm-${y}`;d.push({id:`context-${x}`,text:p.d,pairId:x}),m.push({id:`idm-${x}`,text:p.text,pairId:x})}),s.push({...r,contexts:d,idioms:Zi(m)})}}else s.push(r);return s}function U4(n,e){switch(n.type){case"SPELLING":return Kn(e||"")===Kn(n.word.word);case"IPA_QUIZ":return e===n.answer;case"PREPOSITION_QUIZ":return Kn(e||"")===Kn(n.answer);case"MEANING_QUIZ":return e===n.answer;case"PARAPHRASE_QUIZ":return Kn(e||"")===Kn(n.answer);case"COLLOCATION_QUIZ":return Kn(e||"")===Kn(n.answer);case"COLLOCATION_MULTICHOICE_QUIZ":return e===n.answer;case"IDIOM_QUIZ":return Kn(e||"")===Kn(n.answer);case"SENTENCE_SCRAMBLE":const s=(e||[]).join(" ");return Kn(s)===Kn(n.original);case"PRONUNCIATION":return Kn(e||"")===Kn(n.word.word);case"HETERONYM_QUIZ":{if(!e)return!1;let r=!0;for(const o of n.forms)if(e[o.pos]!==o.ipa){r=!1;break}return r}case"WORD_FAMILY":{const r={};let o=!0,l=!1;const d={nouns:"n",verbs:"v",adjs:"j",advs:"d"};return["nouns","verbs","adjs","advs"].forEach(m=>{var y;const p=(((y=n.word.wordFamily)==null?void 0:y[m])||[]).filter(x=>!x.isIgnored).map(x=>x.word);if(p.length>0){l=!0;const v=((e==null?void 0:e[m])||"").split(",").filter(Boolean).map(N=>Kn(N)),S=d[m];p.forEach(N=>{const P=Kn(N),M=v.findIndex(V=>V===P),j=M!==-1;r[`${S}:${N}`]=j,j?v.splice(M,1):o=!1}),v.length>0&&(o=!1)}}),l?{correct:o,details:r}:!0}case"PARAPHRASE_CONTEXT_QUIZ":{const r=n;if(!(e instanceof Map)||e.size===0)return{correct:!1,details:{}};const o={};let l=0;return r.contexts.forEach(d=>{const m=e.get(d.id);if(m){const p=r.paraphrases.find(y=>y.id===m);p&&p.pairId===d.pairId?(o[d.id]=!0,l++):o[d.id]=!1}else o[d.id]=!1}),{correct:l===r.contexts.length,details:o}}case"COLLOCATION_CONTEXT_QUIZ":{const r=n;if(!(e instanceof Map)||e.size===0)return{correct:!1,details:{}};const o={};let l=0;return r.contexts.forEach(d=>{const m=e.get(d.id);if(m){const p=r.collocations.find(y=>y.id===m);p&&p.pairId===d.pairId?(o[d.id]=!0,l++):o[d.id]=!1}else o[d.id]=!1}),{correct:l===r.contexts.length,details:o}}case"IDIOM_CONTEXT_QUIZ":{const r=n;if(!(e instanceof Map)||e.size===0)return{correct:!1,details:{}};const o={};let l=0;return r.contexts.forEach(d=>{const m=e.get(d.id);if(m){const p=r.idioms.find(y=>y.id===m);p&&p.pairId===d.pairId?(o[d.id]=!0,l++):o[d.id]=!1}else o[d.id]=!1}),{correct:l===r.contexts.length,details:o}}default:return!1}}const P4=()=>{const[n,e]=D.useState([]),[s,r]=D.useState(0),[o,l]=D.useState([]),[d,m]=D.useState(null),[p,y]=D.useState(!1),[x,v]=D.useState(new Set),[S,N]=D.useState(0),[P,M]=D.useState(!1);D.useEffect(()=>{let C;return P&&!p&&(C=window.setInterval(()=>{N(R=>R+1)},1e3)),()=>clearInterval(C)},[P,p]);const j=C=>{e(C),l(new Array(C.length).fill(void 0)),r(0),m(null),y(!1),v(new Set),N(0),M(!0)},V=(C,R)=>{l(L=>{const O=[...L];return O[C]=R,O})},B=n[s],H=D.useMemo(()=>{if((B==null?void 0:B.type)!=="PREPOSITION_QUIZ")return null;const C=[];let R=s;for(;R>0&&n[R-1].type==="PREPOSITION_QUIZ";)R--;for(let L=R;L<n.length&&n[L].type==="PREPOSITION_QUIZ";L++)C.push({challenge:n[L],index:L});return C.length===0?null:{startIndex:R,group:C}},[B,s,n]),G=D.useMemo(()=>H?H.startIndex+H.group.length>=n.length:s>=n.length-1,[s,n,H]),Y=()=>{G||r(H?H.startIndex+H.group.length:C=>C+1)},K=()=>{const C=H?H.startIndex-1:s-1;C>=0&&r(C)},I=()=>{v(C=>{const R=new Set(C);return H?H.group.forEach(L=>R.add(L.index)):R.add(s),R}),Y()},A=()=>{const C=[];let R=0,L=0;const O={},xe=[];n.forEach((F,ue)=>{if(x.has(ue)){C[ue]=null;return}L++;const ae=U4(F,o[ue]);C[ue]=ae;const X=typeof ae=="boolean"?ae:ae.correct;if(X&&R++,xe.push({type:F.type,passed:X}),F.type==="WORD_FAMILY"&&typeof ae=="object"&&"details"in ae)Object.entries(ae.details).forEach(([Q,T])=>{O[`WORD_FAMILY:${Q}`]=T});else if(F.type==="COLLOCATION_QUIZ")O[`COLLOCATION_QUIZ:${F.fullText}`]=X;else if(F.type==="COLLOCATION_MULTICHOICE_QUIZ")O[`COLLOCATION_MULTICHOICE_QUIZ:${F.fullText}`]=X;else if(F.type==="IDIOM_QUIZ")O[`IDIOM_QUIZ:${F.fullText}`]=X;else if(F.type==="PARAPHRASE_QUIZ")O[`PARAPHRASE_QUIZ:${F.answer}`]=X;else if(F.type==="PREPOSITION_QUIZ")O[`PREPOSITION_QUIZ:${F.answer}`]=X;else if(F.type==="PARAPHRASE_CONTEXT_QUIZ"){const Q=F;typeof ae=="object"&&ae.details&&Q.paraphrases.forEach(T=>{const z=Q.contexts.find($=>$.pairId===T.pairId);z&&ae.details[z.id]&&(O[`PARAPHRASE_CONTEXT_QUIZ:${T.text}`]=!0)}),O[F.type]=X}else if(F.type==="COLLOCATION_CONTEXT_QUIZ"){const Q=F;typeof ae=="object"&&ae.details&&Q.collocations.forEach(T=>{const z=Q.contexts.find($=>$.pairId===T.pairId);z&&ae.details[z.id]&&(O[`COLLOCATION_CONTEXT_QUIZ:${T.text}`]=!0)}),O[F.type]=X}else if(F.type==="IDIOM_CONTEXT_QUIZ"){const Q=F;typeof ae=="object"&&ae.details&&Q.idioms.forEach(T=>{const z=Q.contexts.find($=>$.pairId===T.pairId);z&&ae.details[z.id]&&(O[`IDIOM_CONTEXT_QUIZ:${T.text}`]=!0)}),O[F.type]=X}else O[F.type]=X});let ge=Ct.HARD;return L>0&&(R===L?ge=L>1?Ct.EASY:Ct.HARD:R<L/2&&(ge=Ct.FORGOT)),{finalGrade:ge,resultHistory:O,detailedResults:xe,counts:{correct:R,tested:L},newResults:C}};return{challenges:n,currentChallengeIndex:s,currentChallenge:B,userAnswers:o,results:d,isFinishing:p,elapsedSeconds:S,currentPrepositionGroup:H,isLastChallenge:G,startTest:j,setAnswer:V,handleNext:Y,handleBack:K,handleIgnore:I,checkAnswers:A,finishTest:()=>{M(!1),y(!0);const{newResults:C}=A();m(C)}}},V4={SPELLING:"sp",IPA_QUIZ:"iq",PREPOSITION_QUIZ:"pq",WORD_FAMILY:"wf",MEANING_QUIZ:"mq",PARAPHRASE_QUIZ:"prq",SENTENCE_SCRAMBLE:"sc",HETERONYM_QUIZ:"hq",PRONUNCIATION:"p",COLLOCATION_QUIZ:"cq",IDIOM_QUIZ:"idq",PARAPHRASE_CONTEXT_QUIZ:"pcq",COLLOCATION_CONTEXT_QUIZ:"ccq",COLLOCATION_MULTICHOICE_QUIZ:"cmq",IDIOM_CONTEXT_QUIZ:"icq"},z4=["PARAPHRASE_CONTEXT_QUIZ","COLLOCATION_CONTEXT_QUIZ","IDIOM_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ","HETERONYM_QUIZ"],fi={collocation:{easy:["COLLOCATION_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ","COLLOCATION_QUIZ"],hard:["COLLOCATION_QUIZ","COLLOCATION_CONTEXT_QUIZ","COLLOCATION_MULTICHOICE_QUIZ"]},paraphrase:{easy:["PARAPHRASE_CONTEXT_QUIZ","PARAPHRASE_QUIZ"],hard:["PARAPHRASE_QUIZ","PARAPHRASE_CONTEXT_QUIZ"]},idiom:{easy:["IDIOM_CONTEXT_QUIZ","IDIOM_QUIZ"],hard:["IDIOM_QUIZ","IDIOM_CONTEXT_QUIZ"]}},B4=new Set([...fi.collocation.easy,...fi.paraphrase.easy,...fi.idiom.easy]),Gd=(n,e)=>{const s=new Set;return Object.keys(fi).forEach(r=>{const o=fi[r][e];for(const l of o){const d=l;if(n.has(d)){s.add(d);break}}}),n.forEach(r=>{B4.has(r)||s.add(r)}),s},F4=({word:n,onClose:e,onComplete:s,isQuickFire:r=!1,isModal:o=!0,sessionPosition:l,onPrevWord:d,disableHints:m=!1,forceShowHint:p=!1,skipSetup:y=!1,challengeFilter:x,skipRecap:v=!1})=>{const[S,N]=D.useState(!r&&!y),[P,M]=D.useState(new Set),[j,V]=D.useState(!1),[B,H]=D.useState(!1),[G,Y]=D.useState(p),[K,I]=D.useState(null),A=P4();D.useEffect(()=>{Y(p)},[A.currentChallengeIndex,p]);const _=D.useMemo(()=>{try{return D4(n)}catch(T){return console.error("[TestModal] Error generating challenges:",T),[]}},[n]),C=D.useMemo(()=>{const T=n.lastTestResults||{},z=new Map,$=Array.from(new Set(_.map(pe=>pe.type))),J=(pe,de)=>{if(T[pe]!==void 0)return T[pe];const _e=V4[de];if(_e){const W=pe.startsWith(de)?pe.substring(de.length):"",le=_e+W;return T[le]}};return $.forEach(pe=>{const de=_.filter(W=>W.type===pe);if(pe==="WORD_FAMILY"){const W=["nouns","verbs","adjs","advs"],le={nouns:"n",verbs:"v",adjs:"j",advs:"d"};let ie=0;const he=W.flatMap(Ie=>{var Ue;return(((Ue=n.wordFamily)==null?void 0:Ue[Ie])||[]).map(je=>({...je,typeKey:Ie}))}).filter(Ie=>!Ie.isIgnored&&Ie.word);he.length>0&&he.forEach(Ie=>{const Ue=le[Ie.typeKey];(T[`WORD_FAMILY:${Ue}:${Ie.word}`]??T[`wf:${Ue}:${Ie.word}`]??T[`WORD_FAMILY_${Ie.typeKey.toUpperCase()}`])===!0&&ie++}),z.set(pe,{score:ie,total:he.length});return}if(pe==="SENTENCE_SCRAMBLE"){const W=Object.keys(T).some(le=>(le.startsWith("SENTENCE_SCRAMBLE")||le.startsWith("sc"))&&T[le]===!0);z.set(pe,{score:W?1:0,total:1});return}let _e=0;de.forEach(W=>{let le=!1,ie="";if(W.type==="COLLOCATION_QUIZ"?ie=`COLLOCATION_QUIZ:${W.fullText}`:W.type==="COLLOCATION_MULTICHOICE_QUIZ"?ie=`COLLOCATION_MULTICHOICE_QUIZ:${W.fullText}`:W.type==="IDIOM_QUIZ"?ie=`IDIOM_QUIZ:${W.fullText}`:W.type==="PREPOSITION_QUIZ"?ie=`PREPOSITION_QUIZ:${W.answer}`:W.type==="PARAPHRASE_QUIZ"?ie=`PARAPHRASE_QUIZ:${W.answer}`:W.type==="PARAPHRASE_CONTEXT_QUIZ"?ie="PARAPHRASE_CONTEXT_QUIZ":W.type==="COLLOCATION_CONTEXT_QUIZ"?ie="COLLOCATION_CONTEXT_QUIZ":W.type==="IDIOM_CONTEXT_QUIZ"?ie="IDIOM_CONTEXT_QUIZ":ie=W.type,J(ie,pe)===!0&&(le=!0),!le){if(W.type==="PARAPHRASE_QUIZ"){const he=W.answer;T[`PARAPHRASE_CONTEXT_QUIZ:${he}`]===!0&&(le=!0)}else if(W.type==="COLLOCATION_QUIZ"){const he=W.fullText;T[`COLLOCATION_CONTEXT_QUIZ:${he}`]===!0&&(le=!0),J(`COLLOCATION_MULTICHOICE_QUIZ:${he}`,"COLLOCATION_MULTICHOICE_QUIZ")===!0&&(le=!0)}else if(W.type==="IDIOM_QUIZ"){const he=W.fullText;T[`IDIOM_CONTEXT_QUIZ:${he}`]===!0&&(le=!0)}}le&&_e++}),z.set(pe,{score:_e,total:de.length})}),z},[n,_]);D.useEffect(()=>{if(r&&!j&&A.challenges.length===0){if(_.length===0){setTimeout(e,100);return}(async()=>{V(!0);let z=_;x&&(z=_.filter(x)),z.length===0&&(z=_.filter(J=>J.type!=="SPELLING")),z.length===0&&(z=_);const $=z[Math.floor(Math.random()*z.length)];if(!$){V(!1),setTimeout(e,500);return}try{const J=await U1([$],n);J.length>0?(A.startTest(J),N(!1)):setTimeout(e,500)}catch{setTimeout(e,500)}finally{V(!1)}})()}},[r,_,n,x]),D.useEffect(()=>{y&&!r&&_.length>0&&A.challenges.length===0&&!j&&O()},[y,r,_.length,A.challenges.length,j]),D.useEffect(()=>{if(r||_.length===0)return;const T=Object.keys(n.lastTestResults||{}).length>0,z=new Set;!T&&!y?(H(!1),_.forEach($=>z.add($.type))):(H(!0),["MEANING_QUIZ","PREPOSITION_QUIZ","COLLOCATION_CONTEXT_QUIZ"].forEach($=>{_.some(J=>J.type===$)&&z.add($)})),M(z)},[_,n,r,y]);const R=T=>{H(!1),M(z=>{const $=new Set(z);return $.has(T)?$.delete(T):$.add(T),$})},L=async T=>{const z=T||P;let $=_.filter(de=>z.has(de.type));if(z.has("SENTENCE_SCRAMBLE")){const de=$.filter(_e=>_e.type==="SENTENCE_SCRAMBLE");if(de.length>1){const _e=de[Math.floor(Math.random()*de.length)];$=$.filter(W=>W.type!=="SENTENCE_SCRAMBLE"),$.push(_e)}}if($.length===0)return;V(!0);const pe=(await U1($,n)).sort(()=>Math.random()-.5);A.startTest(pe),V(!1),N(!1)},O=async()=>{const T=new Set(_.map(J=>J.type)),z=new Set;T.has("MEANING_QUIZ")&&z.add("MEANING_QUIZ");for(const J of fi.collocation.easy)if(T.has(J)){z.add(J);break}for(const J of fi.paraphrase.easy)if(T.has(J)){z.add(J);break}const $=[];T.has("IPA_QUIZ")&&$.push("IPA_QUIZ"),T.has("PREPOSITION_QUIZ")&&$.push("PREPOSITION_QUIZ"),T.has("WORD_FAMILY")&&$.push("WORD_FAMILY");for(const J of fi.idiom.easy)if(T.has(J)){$.push(J);break}if($.length>0){const J=$[Math.floor(Math.random()*$.length)];z.add(J)}if(z.size===0){const J=Gd(T,"easy");if(J.size>0){H(!0),L(J);return}return}H(!0),L(z)},xe=()=>{const T=new Set,z=Wg(n),$=n.lastTestResults||{},J=z.filter(de=>!de.testKeys.some(_e=>$[_e]===!0));if(J.length===0){if(C.forEach((_e,W)=>{_e.score<_e.total&&T.add(W)}),T.size===0)return;const de=Gd(T,"easy");L(de);return}_.forEach(de=>{let _e=[];de.type==="COLLOCATION_QUIZ"?_e.push(`COLLOCATION_QUIZ:${de.fullText}`):de.type==="COLLOCATION_MULTICHOICE_QUIZ"?_e.push(`COLLOCATION_MULTICHOICE_QUIZ:${de.fullText}`):de.type==="COLLOCATION_CONTEXT_QUIZ"||(de.type==="PARAPHRASE_QUIZ"?_e.push(`PARAPHRASE_QUIZ:${de.answer}`):de.type==="PREPOSITION_QUIZ"?_e.push(`PREPOSITION_QUIZ:${de.answer}`):de.type==="SPELLING"?_e.push("SPELLING"):de.type==="PRONUNCIATION"?_e.push("PRONUNCIATION"):de.type==="MEANING_QUIZ"?_e.push("MEANING_QUIZ"):de.type==="IPA_QUIZ"?_e.push("IPA_QUIZ"):de.type==="WORD_FAMILY"?_e.push("WORD_FAMILY"):de.type==="SENTENCE_SCRAMBLE"&&_e.push("SENTENCE_SCRAMBLE")),_e.some(le=>J.some(ie=>ie.testKeys.includes(le)||ie.testKeys.some(he=>he.startsWith("WORD_FAMILY")&&le==="WORD_FAMILY")))&&T.add(de.type),de.type==="COLLOCATION_CONTEXT_QUIZ"&&J.filter(ie=>ie.key.startsWith("colloc:")).length>0&&T.add(de.type),de.type==="PARAPHRASE_CONTEXT_QUIZ"&&J.filter(ie=>ie.key.startsWith("para:")).length>0&&T.add(de.type),de.type==="IDIOM_CONTEXT_QUIZ"&&J.filter(ie=>ie.key.startsWith("idiom:")).length>0&&T.add(de.type)}),T.size===0&&C.forEach((de,_e)=>{de.score<de.total&&T.add(_e)});const pe=Gd(T,"easy");H(!1),L(pe)},ge=async()=>{const T=new Set(_.map($=>$.type)),z=Gd(T,"hard");z.size!==0&&(H(!1),L(z))},F=(T=!1)=>{const{finalGrade:z,resultHistory:$,detailedResults:J,counts:pe}=A.checkAnswers();if(A.finishTest(),v||r)setTimeout(()=>s(z,$,T,pe),1e3);else{const de=n.masteryScore||0,_e=n.lastReview&&n.lastGrade||"NEW",W={...n,lastTestResults:{...n.lastTestResults||{},...$}},le=_s(W);I({oldMastery:de,newMastery:le,oldStatus:_e,newStatus:z,results:J,finalGrade:z,resultHistory:$,counts:pe})}},ue=()=>{A.isLastChallenge?F(!1):A.handleNext()},ae=T=>{const z=Math.floor(T/60),$=T%60;return`${z}:${$.toString().padStart(2,"0")}`},X=D.useMemo(()=>{const T=new Map;return C.forEach((z,$)=>{z4.includes($)||T.set($,z)}),T},[C]),Q=D.useMemo(()=>_s(n)===100,[n]);if(!S&&!j&&!A.currentChallenge)return o?u.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:u.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-xl text-center space-y-4",children:[u.jsx("p",{className:"text-red-500 font-bold",children:"Failed to load challenge."}),u.jsx("button",{onClick:e,className:"px-4 py-2 bg-neutral-100 rounded-lg text-sm font-bold",children:"Close"})]})}):u.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-6 text-center space-y-4",children:[u.jsx(Kt,{className:"animate-spin text-neutral-400",size:32}),u.jsx("p",{className:"text-red-500 font-bold",children:"Error loading."}),u.jsx("button",{onClick:e,className:"text-xs underline text-neutral-500",children:"Return"})]});if((r||y)&&(j||!A.currentChallenge)){const T=u.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center p-8 text-center space-y-4",children:[u.jsx(Kt,{className:"animate-spin text-neutral-400",size:32}),u.jsx("p",{className:"text-xs font-black text-neutral-500 uppercase tracking-widest",children:"Preparing..."})]});return o?u.jsx("div",{className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:u.jsx("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl overflow-hidden flex flex-col h-[500px]",children:T})}):T}return u.jsx(L4,{isModal:o,word:n,onClose:e,isSetupMode:S,isPreparing:j,availableChallenges:_,selectedChallengeTypes:P,onToggleChallenge:R,onSetSelection:T=>{M(T),H(!1)},onStartTest:()=>L(),challenges:A.challenges,currentChallenge:A.currentChallenge,currentChallengeIndex:A.currentChallengeIndex,userAnswers:A.userAnswers,handleAnswerChange:A.setAnswer,results:A.results,isFinishing:A.isFinishing,currentPrepositionGroup:A.currentPrepositionGroup,isLastChallenge:A.isLastChallenge,handleNextClick:ue,handleBackClick:A.handleBack,handleIgnore:A.handleIgnore,handleFinishEarly:F,showHint:G,onToggleHint:()=>Y(!G),sessionPosition:l,challengeStats:X,disableHints:m,onSelectQuick:O,onSelectPreferred:xe,onSelectZeroScore:xe,onSelectPartialScore:ge,isQuickMode:B,elapsedTime:ae(A.elapsedSeconds),recapData:K,onRecalculateFinish:()=>K&&s(K.finalGrade,K.resultHistory,!1,K.counts),isMastered:Q})},P1=n=>n.toLowerCase().replace(/[.,!?;:]/g,"").trim();function H4(n,e){const s=n.toLowerCase(),r=e.toLowerCase(),o=[];let l=0,d=0,m=0;const p=(s.length+r.length)*2+100;for(;(l<s.length||d<r.length)&&m<p;)if(m++,l<s.length&&d<r.length&&s[l]===r[d])o.push({char:s[l],status:"correct"}),l++,d++;else if(l<s.length&&(d>=r.length||s[l]!==r[d])){const y=r.indexOf(s[l],d);y!==-1&&y-d<3?(d=y,o.push({char:s[l],status:"correct"}),l++,d++):(o.push({char:s[l],status:"wrong"}),l++)}else d++;return o}function V1(n,e){const s=n.split(/\s+/).filter(Boolean),r=P1(e).split(/\s+/).filter(Boolean);let o=0,l=0;const d=s.map(p=>{const y=P1(p);o+=y.length;let x=-1;if(r.forEach((v,S)=>{x===-1&&v===y&&(x=S)}),x===-1&&r.forEach((v,S)=>{x===-1&&v.length>=2&&(v.startsWith(y.substring(0,2))||y.startsWith(v.substring(0,2)))&&(x=S)}),x!==-1){const v=r[x];r.splice(x,1);const S=H4(p,v),N=S.filter(M=>M.status==="correct").length;l+=N;const P=N===y.length?"correct":"near";return{word:p,status:P,chars:S}}return{word:p,status:"missing",chars:p.split("").map(v=>({char:v,status:"missing"}))}});return{score:o>0?Math.round(l/o*100):0,words:d}}const qd=3e3,IT=({target:n,onClose:e,onSaveScore:s})=>{const[r,o]=D.useState(!1),l=D.useRef(!1),[d,m]=D.useState(n||""),[p,y]=D.useState(!n),[x,v]=D.useState(""),[S,N]=D.useState(null),[P,M]=D.useState(null),[j,V]=D.useState(qd),[B,H]=D.useState(null),[G,Y]=D.useState(!1),[K,I]=D.useState(!1),A=D.useRef(new N0),_=D.useRef(null),C=D.useRef(Date.now()),{showToast:R}=Za();D.useEffect(()=>{if(r&&d&&x){const Q=V1(d,x);M(Q)}},[x,r,d]);const L=D.useCallback(async()=>{if(d){if(B){I(!K);return}Y(!0);try{const Q=d.trim().toLowerCase(),T=ii().find(pe=>pe.word.toLowerCase()===Q);if(T&&T.ipaUs){H(T.ipaUs),I(!0),Y(!1);return}const z=Dt(),$=Cn(z),J=await fetch(`${$}/api/convert/ipa?text=${encodeURIComponent(d)}`);if(J.ok){const pe=await J.json();H(pe.ipa),I(!0)}else R("IPA server unavailable","error")}catch{R("Failed to fetch IPA","error")}finally{Y(!1)}}},[d,B,K,R]),O=D.useCallback(async Q=>{if(!d)return;_.current&&(clearInterval(_.current),_.current=null),A.current.stop();const T=await I0();T&&N(T),o(!1),l.current=!1;const z=V1(d,Q);M(z),s&&s(z.score)},[d,s]),xe=D.useCallback(()=>{C.current=Date.now(),V(qd)},[]),ge=D.useCallback(Q=>{_.current&&clearInterval(_.current),C.current=Date.now(),V(qd),_.current=setInterval(()=>{const z=Date.now()-C.current,$=Math.max(0,qd-z);V($),$<=0&&l.current&&O(Q)},50)},[O]);D.useEffect(()=>()=>{_.current&&clearInterval(_.current),A.current.stop()},[]);const F=async()=>{if(d)if(p&&y(!1),r)await O(x);else{v(""),M(null),N(null);try{await A0(),o(!0),l.current=!0,xe(),ge(""),A.current.start((Q,T)=>{const z=Q+T;v(z),xe()},Q=>{l.current&&(v(Q),O(Q))})}catch(Q){console.error(Q),o(!1),l.current=!1}}},ue=()=>{S&&new Audio(`data:${S.mimeType};base64,${S.base64}`).play()},ae=()=>{if(!d)return;const Q=hu("vocab_pro_mimic_practice_queue",[]);if(Q.some(z=>z.text===d)){R("Already in Pronunciation Queue","info");return}const T={id:`quick-save-${Date.now()}`,text:d,sourceWord:d.length>30?d.substring(0,30)+"...":d,type:"Quick Practice"};Kg("vocab_pro_mimic_practice_queue",[...Q,T]),R("Saved to Pronunciation Page","success")},X=Q=>{const T=Q.length;return T<40?"text-2xl md:text-3xl":T<80?"text-xl md:text-2xl":T<150?"text-lg md:text-xl":"text-base md:text-lg"};return u.jsx("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl border border-neutral-200 p-8 flex flex-col items-center gap-6 relative",children:[u.jsx("button",{onClick:e,className:"absolute top-6 right-6 p-2 text-neutral-300 hover:text-neutral-900 hover:bg-neutral-100 rounded-full transition-all",children:u.jsx(hn,{size:20})}),u.jsxs("div",{className:"text-center space-y-1 mt-2",children:[u.jsx("span",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Mimic Practice"}),u.jsx("h3",{className:"text-xl font-bold text-neutral-900 leading-tight",children:"Practice Selected Phrase"})]}),u.jsxs("div",{className:"w-full p-6 bg-neutral-50 rounded-[2rem] border border-neutral-200 flex flex-col items-center gap-3 min-h-[120px] overflow-hidden relative group",children:[p?u.jsxs("div",{className:"w-full relative",children:[u.jsx("textarea",{value:d,onChange:Q=>m(Q.target.value),placeholder:"Enter text to practice...",className:"w-full h-32 p-4 bg-white border border-neutral-200 rounded-xl font-medium resize-none focus:ring-2 focus:ring-neutral-900 outline-none text-base leading-relaxed"}),u.jsx("button",{onClick:()=>y(!1),className:"absolute bottom-4 right-4 px-3 py-1.5 bg-neutral-900 text-white rounded-lg text-xs font-bold shadow-sm",children:"Done"})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>y(!0),className:"absolute top-4 right-4 p-2 text-neutral-400 hover:text-indigo-600 opacity-0 group-hover:opacity-100 transition-opacity bg-white rounded-full shadow-sm",children:u.jsx(hI,{size:16})}),u.jsx("div",{className:"flex flex-wrap justify-center gap-x-1.5 gap-y-1 w-full",children:d.split(/\s+/).map((Q,T)=>{const z=P==null?void 0:P.words[T];let $="text-neutral-800";if(z)switch(z.status){case"correct":$="text-emerald-600";break;case"near":$="text-amber-500";break;case"wrong":$="text-rose-500";break;case"missing":$="text-neutral-300";break;default:$="text-neutral-800"}return u.jsx("span",{onClick:()=>os(Q),className:`${X(d)} font-bold cursor-pointer hover:underline decoration-neutral-200 transition-all leading-normal ${$}`,children:Q},T)})})]}),K&&B&&!p&&u.jsx("div",{className:"px-4 py-1.5 bg-white border border-neutral-200 rounded-xl text-sm font-mono font-medium text-neutral-500 animate-in slide-in-from-top-2 duration-300",children:B})]}),u.jsxs("div",{className:"flex flex-col items-center gap-4 w-full",children:[r?u.jsxs("div",{className:"flex items-center gap-2 text-rose-500 animate-pulse",children:[u.jsx(hv,{size:20}),u.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:"Listening..."})]}):x&&u.jsxs("p",{className:"text-sm font-medium italic text-neutral-500 line-clamp-2",children:['"',x,'"']}),P&&u.jsxs("div",{className:"text-center animate-in zoom-in-95",children:[u.jsxs("div",{className:`text-4xl font-black ${P.score>80?"text-emerald-500":P.score>50?"text-amber-500":"text-rose-500"}`,children:[P.score,"%"]}),u.jsx("p",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest",children:"Accuracy"})]})]}),u.jsxs("div",{className:"flex items-center gap-4 pt-2",children:[u.jsx("button",{onClick:()=>os(d),disabled:!d.trim(),className:"p-4 rounded-2xl bg-neutral-100 text-neutral-600 hover:text-neutral-900 transition-all",title:"Listen",children:u.jsx(va,{size:24})}),u.jsx("button",{onClick:L,disabled:G,className:`p-4 rounded-2xl transition-all ${K?"bg-indigo-600 text-white shadow-md":"bg-neutral-100 text-neutral-600 hover:text-indigo-600"}`,title:"Show Phonetic (IPA)",children:G?u.jsx(Kt,{size:24,className:"animate-spin"}):u.jsx(G2,{size:24})}),u.jsx("button",{onClick:F,className:`w-20 h-20 rounded-full flex items-center justify-center shadow-lg transition-all transform active:scale-105 ${r?"bg-rose-600 text-white scale-110 shadow-rose-500/50 ring-8 ring-rose-500/10":"bg-white border-4 border-neutral-100 text-neutral-900 hover:scale-105"}`,title:"Record",children:r?j<=1e3?u.jsx("span",{className:"text-2xl font-black tabular-nums animate-in fade-in duration-300",children:(j/1e3).toFixed(1)}):u.jsx(hv,{size:28,className:"animate-pulse"}):u.jsx(mo,{size:28})}),u.jsx("button",{onClick:ue,disabled:!S||r,className:`p-4 rounded-2xl transition-all ${S&&!r?"bg-indigo-100 text-indigo-600 hover:text-indigo-900":"bg-neutral-50 text-neutral-300 cursor-not-allowed"}`,title:"Play recording",children:u.jsx(cu,{size:24,fill:S&&!r?"currentColor":"none"})}),u.jsx("button",{onClick:ae,disabled:!d.trim(),className:"p-4 rounded-2xl bg-neutral-100 text-neutral-600 hover:text-indigo-600 transition-all",title:"Save to Pronunciation Page",children:u.jsx(uI,{size:24})})]})]})})},G4=({word:n,onClose:e,onNavigateToWord:s,onEditRequest:r,onUpdate:o,onGainXp:l,isViewOnly:d=!1,initialTab:m="OVERVIEW"})=>{const[p,y]=D.useState(n),[x,v]=D.useState([]),[S,N]=D.useState({}),[P,M]=D.useState({}),[j,V]=D.useState(null),[B,H]=D.useState(new Set),[G,Y]=D.useState(!1),[K,I]=D.useState(!1);D.useEffect(()=>{y(n)},[n]),D.useEffect(()=>{(async()=>{if(!p)return;const X=[],Q=p.wordFamily;Q&&X.push(...(Q.nouns||[]).map(he=>he.word.toLowerCase().trim()),...(Q.verbs||[]).map(he=>he.word.toLowerCase().trim()),...(Q.adjs||[]).map(he=>he.word.toLowerCase().trim()),...(Q.advs||[]).map(he=>he.word.toLowerCase().trim()));const T=p.paraphrases;T&&X.push(...T.map(he=>he.word.toLowerCase().trim()));const z=p.idiomsList;z&&X.push(...z.map(he=>he.text.toLowerCase().trim()));const $=p.collocationsArray;$&&X.push(...$.map(he=>he.text.toLowerCase().trim()));const J=[...new Set(X.filter(Boolean))],pe=new Set;for(const he of J){if(!he)continue;await Ym(p.userId,he)&&pe.add(he)}H(pe);const de=await bN(p.userId,p.id);v(de);const _e=ii(),W={};(p.groups||[]).filter(he=>he.toLowerCase()!=="ielts").forEach(he=>{const Ie=_e.filter(Ue=>{var je;return Ue.userId===p.userId&&Ue.id!==p.id&&((je=Ue.groups)==null?void 0:je.includes(he))});Ie.length>0&&(W[he]=Ie)}),N(W);const ie={};(p.groups||[]).forEach(he=>{const Ie=_e.filter(Ue=>{var je;return Ue.userId===p.userId&&Ue.id!==p.id&&((je=Ue.groups)==null?void 0:je.includes(he))});Ie.length>0&&(ie[he]=Ie)}),M(ie)})()},[p]);const A=async(ae,X="family")=>{if(!(!ae.word||j||B.has(ae.word.toLowerCase()))){V(ae.word);try{const Q=`From ${X} of "${p.word}"`,T=[...p.groups||[],`word-${X}`],z={...Yw(ae.word,ae.ipa||"",`Added from ${X}`,"",Q,T),userId:p.userId};await Of(z),H($=>new Set($).add(ae.word.toLowerCase()))}finally{V(null)}}},_=async(ae,X,Q,T)=>{const z={...p};X&&(z.lastTestResults={...z.lastTestResults||{},...X}),z.masteryScore=_s(z),await o(z),Y(!1),y(z)},C=ae=>{o(ae),y(ae)},[R,L]=D.useState(null),O=ae=>{L(ae)},xe=ae=>{const X=Dt(),Q=X.audioCoach.activeCoach,T=X.audioCoach.coaches[Q].name;return R==="ESSAY"?Vk(p,ae,T):zk(p,ae,T)},ge=ae=>{const{result:X}=ae,Q=X||ae,T={...p,lesson:{...p.lesson||{}}};R==="ESSAY"?T.lesson.essay=Q.content:T.lesson.test=Q.content,C(T),L(null)},ue=Dt().audio.appliedAccent;return u.jsxs(u.Fragment,{children:[G&&u.jsx(F4,{word:p,onComplete:_,onClose:()=>Y(!1)}),K&&u.jsx(IT,{target:p.word,onClose:()=>I(!1)}),u.jsx(E4,{word:p,onClose:e,onChallengeRequest:()=>Y(!0),onMimicRequest:()=>I(!0),onEditRequest:()=>r(p),onUpdate:C,linkedUnits:x,relatedWords:S,relatedByGroup:P,onNavigateToWord:s,onAddVariantToLibrary:A,addingVariant:j,existingVariants:B,appliedAccent:ue,isViewOnly:d,initialTab:m,onGenerateLesson:O}),R&&u.jsx("div",{className:"z-[2000]",children:u.jsx("div",{className:"relative z-[500]",children:u.jsx(bg,{isOpen:!!R,onClose:()=>L(null),type:"GENERATE_WORD_LESSON",title:R==="ESSAY"?`Generate Usage Guide: ${p.word}`:`Generate Practice Test: ${p.word}`,description:R==="ESSAY"?"AI will create a structured usage guide with tables and examples.":"AI will design an interactive test for this word.",initialData:{},onGeneratePrompt:xe,onJsonReceived:ge,closeOnSuccess:!0})})})]})},z1=({isOpen:n,title:e,message:s,confirmText:r,isProcessing:o,onConfirm:l,onClose:d,confirmButtonClass:m="bg-red-600 text-white hover:bg-red-700 shadow-red-200",icon:p=u.jsx(If,{size:40})})=>n?u.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsx("div",{className:"bg-white w-full max-w-sm rounded-[2.5rem] shadow-2xl border border-neutral-200 overflow-hidden animate-in zoom-in-95 duration-200",children:u.jsxs("div",{className:"p-8 text-center space-y-6",children:[u.jsx("div",{className:"mx-auto w-20 h-20 bg-neutral-50 text-neutral-500 rounded-full flex items-center justify-center border-4 border-white shadow-sm",children:p}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("h3",{className:"text-2xl font-black text-neutral-900 leading-tight",children:e}),u.jsx("p",{className:"text-neutral-500 text-sm leading-relaxed",children:s})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsxs("button",{disabled:o,onClick:l,className:`w-full py-4 rounded-2xl font-black text-sm transition-all shadow-lg active:scale-95 flex items-center justify-center space-x-2 disabled:opacity-50 ${m}`,children:[o?u.jsx(Kt,{size:18,className:"animate-spin"}):null,u.jsx("span",{children:o?"PROCESSING...":r})]}),u.jsx("button",{disabled:o,onClick:d,className:"w-full py-4 bg-neutral-100 text-neutral-500 rounded-2xl font-bold text-sm hover:bg-neutral-200 transition-all active:scale-95 disabled:opacity-50",children:"Cancel"})]})]})})}):null;var q4={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var B1;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(B1||(B1={}));var F1;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(F1||(F1={}));var H1;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(H1||(H1={}));var Xi;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(Xi||(Xi={}));var G1;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(G1||(G1={}));var q1;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(q1||(q1={}));var $1;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})($1||($1={}));var Y1;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Y1||(Y1={}));var Q1;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(Q1||(Q1={}));var W1;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(W1||(W1={}));var K1;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(K1||(K1={}));var Z1;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(Z1||(Z1={}));var X1;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(X1||(X1={}));var J1;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(J1||(J1={}));var e_;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(e_||(e_={}));var t_;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(t_||(t_={}));var n_;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(n_||(n_={}));var s_;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(s_||(s_={}));var a_;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(a_||(a_={}));var r_;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(r_||(r_={}));var i_;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(i_||(i_={}));var o_;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(o_||(o_={}));var l_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(l_||(l_={}));var c_;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(c_||(c_={}));var u_;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(u_||(u_={}));var d_;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(d_||(d_={}));var f_;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(f_||(f_={}));var h_;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(h_||(h_={}));var p_;(function(n){n.COLLECTION="COLLECTION"})(p_||(p_={}));var m_;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(m_||(m_={}));var g_;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(g_||(g_={}));var y_;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(y_||(y_={}));var x_;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(x_||(x_={}));var b_;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(b_||(b_={}));var v_;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(v_||(v_={}));var __;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(__||(__={}));var E_;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(E_||(E_={}));var w_;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(w_||(w_={}));var S_;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(S_||(S_={}));var T_;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(T_||(T_={}));var A_;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(A_||(A_={}));var I_;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(I_||(I_={}));var N_;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING",n.DISTILLATION="DISTILLATION"})(N_||(N_={}));var C_;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(C_||(C_={}));var R_;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(R_||(R_={}));var O_;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED",n.REGISTERED="REGISTERED"})(O_||(O_={}));var j_;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(j_||(j_={}));var k_;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(k_||(k_={}));var L_;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(L_||(L_={}));var M_;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.ACTIVITY_START="ACTIVITY_START",n.ACTIVITY_END="ACTIVITY_END"})(M_||(M_={}));var D_;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(D_||(D_={}));var U_;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(U_||(U_={}));var P_;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(P_||(P_={}));var V_;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(V_||(V_={}));var z_;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(z_||(z_={}));var B_;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(B_||(B_={}));var F_;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(F_||(F_={}));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var H_;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(H_||(H_={}));function _f(n,e){var s={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(s[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(s[r[o]]=n[r[o]]);return s}function G_(n){var e=typeof Symbol=="function"&&Symbol.iterator,s=e&&n[e],r=0;if(s)return s.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qt(n){return this instanceof Qt?(this.v=n,this):new Qt(n)}function eu(n,e,s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=s.apply(n,e||[]),o,l=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),m("next"),m("throw"),m("return",d),o[Symbol.asyncIterator]=function(){return this},o;function d(N){return function(P){return Promise.resolve(P).then(N,v)}}function m(N,P){r[N]&&(o[N]=function(M){return new Promise(function(j,V){l.push([N,M,j,V])>1||p(N,M)})},P&&(o[N]=P(o[N])))}function p(N,P){try{y(r[N](P))}catch(M){S(l[0][3],M)}}function y(N){N.value instanceof Qt?Promise.resolve(N.value.v).then(x,v):S(l[0][2],N)}function x(N){p("next",N)}function v(N){p("throw",N)}function S(N,P){N(P),l.shift(),l.length&&p(l[0][0],l[0][1])}}function El(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],s;return e?e.call(n):(n=typeof G_=="function"?G_(n):n[Symbol.iterator](),s={},r("next"),r("throw"),r("return"),s[Symbol.asyncIterator]=function(){return this},s);function r(l){s[l]=n[l]&&function(d){return new Promise(function(m,p){d=n[l](d),o(m,p,d.done,d.value)})}}function o(l,d,m,p){Promise.resolve(p).then(function(y){l({value:y,done:m})},d)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let NT=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return NT=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),s=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^s()&15>>+r/4).toString(16))};const $4=()=>NT();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _g(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const Eg=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ia extends Error{}class us extends ia{constructor(e,s,r,o){super(`${us.makeMessage(e,s,r)}`),this.status=e,this.headers=o,this.error=s}static makeMessage(e,s,r){const o=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):r;return e&&o?`${e} ${o}`:e?`${e} status code (no body)`:o||"(no status code or body)"}static generate(e,s,r,o){if(!e||!o)return new $f({message:r,cause:Eg(s)});const l=s;return e===400?new RT(e,l,r,o):e===401?new OT(e,l,r,o):e===403?new jT(e,l,r,o):e===404?new kT(e,l,r,o):e===409?new LT(e,l,r,o):e===422?new MT(e,l,r,o):e===429?new DT(e,l,r,o):e>=500?new UT(e,l,r,o):new us(e,l,r,o)}}class wg extends us{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class $f extends us{constructor({message:e,cause:s}){super(void 0,void 0,e||"Connection error.",void 0),s&&(this.cause=s)}}class CT extends $f{constructor({message:e}={}){super({message:e??"Request timed out."})}}class RT extends us{}class OT extends us{}class jT extends us{}class kT extends us{}class LT extends us{}class MT extends us{}class DT extends us{}class UT extends us{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Y4=/^[a-z][a-z0-9+.-]*:/i,Q4=n=>Y4.test(n);let Sg=n=>(Sg=Array.isArray,Sg(n));const W4=Sg;let K4=W4;const q_=K4;function Z4(n){if(!n)return!0;for(const e in n)return!1;return!0}function X4(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const J4=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ia(`${n} must be an integer`);if(e<0)throw new ia(`${n} must be a positive integer`);return e},eL=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const tL=n=>new Promise(e=>setTimeout(e,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hl="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nL(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const sL=()=>{var n,e,s,r,o;const l=nL();if(l==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":hl,"X-Stainless-OS":Y_(Deno.build.os),"X-Stainless-Arch":$_(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":hl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(l==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":hl,"X-Stainless-OS":Y_((s=globalThis.process.platform)!==null&&s!==void 0?s:"unknown"),"X-Stainless-Arch":$_((r=globalThis.process.arch)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(o=globalThis.process.version)!==null&&o!==void 0?o:"unknown"};const d=aL();return d?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":hl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${d.browser}`,"X-Stainless-Runtime-Version":d.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":hl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function aL(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:s}of n){const r=s.exec(navigator.userAgent);if(r){const o=r[1]||0,l=r[2]||0,d=r[3]||0;return{browser:e,version:`${o}.${l}.${d}`}}}return null}const $_=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",Y_=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let $d;const rL=()=>$d??($d=sL());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iL(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function PT(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function oL(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return PT({start(){},async pull(s){const{done:r,value:o}=await e.next();r?s.close():s.enqueue(o)},async cancel(){var s;await((s=e.return)===null||s===void 0?void 0:s.call(e))}})}function VT(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const s=await e.read();return s!=null&&s.done&&e.releaseLock(),s}catch(s){throw e.releaseLock(),s}},async return(){const s=e.cancel();return e.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function lL(n){var e,s;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((s=(e=n[Symbol.asyncIterator]()).return)===null||s===void 0?void 0:s.call(e));return}const r=n.getReader(),o=r.cancel();r.releaseLock(),await o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cL=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zT=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,s=typeof((n=e==null?void 0:e.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(s?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function hm(n,e,s){return zT(),new File(n,e??"unknown_file",s)}function uL(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const dL=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const BT=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",fL=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&BT(n),hL=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function pL(n,e,s){if(zT(),n=await n,fL(n))return n instanceof File?n:hm([await n.arrayBuffer()],n.name);if(hL(n)){const o=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),hm(await Tg(o),e,s)}const r=await Tg(n);if(e||(e=uL(n)),!(s!=null&&s.type)){const o=r.find(l=>typeof l=="object"&&"type"in l&&l.type);typeof o=="string"&&(s=Object.assign(Object.assign({},s),{type:o}))}return hm(r,e,s)}async function Tg(n){var e,s,r,o,l;let d=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)d.push(n);else if(BT(n))d.push(n instanceof Blob?n:await n.arrayBuffer());else if(dL(n))try{for(var m=!0,p=El(n),y;y=await p.next(),e=y.done,!e;m=!0){o=y.value,m=!1;const x=o;d.push(...await Tg(x))}}catch(x){s={error:x}}finally{try{!m&&!e&&(r=p.return)&&await r.call(p)}finally{if(s)throw s.error}}else{const x=(l=n==null?void 0:n.constructor)===null||l===void 0?void 0:l.name;throw new Error(`Unexpected data type: ${typeof n}${x?`; constructor: ${x}`:""}${mL(n)}`)}return d}function mL(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(s=>`"${s}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class FT{constructor(e){this._client=e}}FT._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HT(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Q_=Object.freeze(Object.create(null)),gL=(n=HT)=>(function(s,...r){if(s.length===1)return s[0];let o=!1;const l=[],d=s.reduce((x,v,S)=>{var N,P,M;/[?#]/.test(v)&&(o=!0);const j=r[S];let V=(o?encodeURIComponent:n)(""+j);return S!==r.length&&(j==null||typeof j=="object"&&j.toString===((M=Object.getPrototypeOf((P=Object.getPrototypeOf((N=j.hasOwnProperty)!==null&&N!==void 0?N:Q_))!==null&&P!==void 0?P:Q_))===null||M===void 0?void 0:M.toString))&&(V=j+"",l.push({start:x.length+v.length,length:V.length,error:`Value of type ${Object.prototype.toString.call(j).slice(8,-1)} is not a valid path parameter`})),x+v+(S===r.length?"":V)},""),m=d.split(/[?#]/,1)[0],p=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let y;for(;(y=p.exec(m))!==null;)l.push({start:y.index,length:y[0].length,error:`Value "${y[0]}" can't be safely passed as a path parameter`});if(l.sort((x,v)=>x.start-v.start),l.length>0){let x=0;const v=l.reduce((S,N)=>{const P=" ".repeat(N.start-x),M="^".repeat(N.length);return x=N.start+N.length,S+P+M},"");throw new ia(`Path parameters result in path with invalid segments:
${l.map(S=>S.error).join(`
`)}
${d}
${v}`)}return d}),Yd=gL(HT);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GT extends FT{create(e,s){var r;const{api_version:o=this._client.apiVersion}=e,l=_f(e,["api_version"]);if("model"in l&&"agent_config"in l)throw new ia("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in l&&"generation_config"in l)throw new ia("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Yd`/${o}/interactions`,Object.assign(Object.assign({body:l},s),{stream:(r=e.stream)!==null&&r!==void 0?r:!1}))}delete(e,s={},r){const{api_version:o=this._client.apiVersion}=s??{};return this._client.delete(Yd`/${o}/interactions/${e}`,r)}cancel(e,s={},r){const{api_version:o=this._client.apiVersion}=s??{};return this._client.post(Yd`/${o}/interactions/${e}/cancel`,r)}get(e,s={},r){var o;const l=s??{},{api_version:d=this._client.apiVersion}=l,m=_f(l,["api_version"]);return this._client.get(Yd`/${d}/interactions/${e}`,Object.assign(Object.assign({query:m},r),{stream:(o=s==null?void 0:s.stream)!==null&&o!==void 0?o:!1}))}}GT._key=Object.freeze(["interactions"]);class qT extends GT{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yL(n){let e=0;for(const o of n)e+=o.length;const s=new Uint8Array(e);let r=0;for(const o of n)s.set(o,r),r+=o.length;return s}let Qd;function R0(n){let e;return(Qd??(e=new globalThis.TextEncoder,Qd=e.encode.bind(e)))(n)}let Wd;function W_(n){let e;return(Wd??(e=new globalThis.TextDecoder,Wd=e.decode.bind(e)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Yf{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const s=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?R0(e):e;this.buffer=yL([this.buffer,s]);const r=[];let o;for(;(o=xL(this.buffer,this.carriageReturnIndex))!=null;){if(o.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=o.index;continue}if(this.carriageReturnIndex!=null&&(o.index!==this.carriageReturnIndex+1||o.carriage)){r.push(W_(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const l=this.carriageReturnIndex!==null?o.preceding-1:o.preceding,d=W_(this.buffer.subarray(0,l));r.push(d),this.buffer=this.buffer.subarray(o.index),this.carriageReturnIndex=null}return r}flush(){return this.buffer.length?this.decode(`
`):[]}}Yf.NEWLINE_CHARS=new Set([`
`,"\r"]);Yf.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function xL(n,e){for(let o=e??0;o<n.length;o++){if(n[o]===10)return{preceding:o,index:o+1,carriage:!1};if(n[o]===13)return{preceding:o,index:o+1,carriage:!0}}return null}function bL(n){for(let r=0;r<n.length-1;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ef={off:0,error:200,warn:300,info:400,debug:500},K_=(n,e,s)=>{if(n){if(X4(Ef,n))return n;is(s).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Ef))}`)}};function Bc(){}function Kd(n,e,s){return!e||Ef[n]>Ef[s]?Bc:e[n].bind(e)}const vL={error:Bc,warn:Bc,info:Bc,debug:Bc};let Z_=new WeakMap;function is(n){var e;const s=n.logger,r=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!s)return vL;const o=Z_.get(s);if(o&&o[0]===r)return o[1];const l={error:Kd("error",s,r),warn:Kd("warn",s,r),info:Kd("info",s,r),debug:Kd("debug",s,r)};return Z_.set(s,[r,l]),l}const Ki=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,s])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":s]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pl{constructor(e,s,r){this.iterator=e,this.controller=s,this.client=r}static fromSSEResponse(e,s,r){let o=!1;const l=r?is(r):console;function d(){return eu(this,arguments,function*(){var p,y,x,v;if(o)throw new ia("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let S=!1;try{try{for(var N=!0,P=El(_L(e,s)),M;M=yield Qt(P.next()),p=M.done,!p;N=!0){v=M.value,N=!1;const j=v;if(!S)if(j.data.startsWith("[DONE]")){S=!0;continue}else try{yield yield Qt(JSON.parse(j.data))}catch(V){throw l.error("Could not parse message into JSON:",j.data),l.error("From chunk:",j.raw),V}}}catch(j){y={error:j}}finally{try{!N&&!p&&(x=P.return)&&(yield Qt(x.call(P)))}finally{if(y)throw y.error}}S=!0}catch(j){if(_g(j))return yield Qt(void 0);throw j}finally{S||s.abort()}})}return new pl(d,s,r)}static fromReadableStream(e,s,r){let o=!1;function l(){return eu(this,arguments,function*(){var p,y,x,v;const S=new Yf,N=VT(e);try{for(var P=!0,M=El(N),j;j=yield Qt(M.next()),p=j.done,!p;P=!0){v=j.value,P=!1;const V=v;for(const B of S.decode(V))yield yield Qt(B)}}catch(V){y={error:V}}finally{try{!P&&!p&&(x=M.return)&&(yield Qt(x.call(M)))}finally{if(y)throw y.error}}for(const V of S.flush())yield yield Qt(V)})}function d(){return eu(this,arguments,function*(){var p,y,x,v;if(o)throw new ia("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let S=!1;try{try{for(var N=!0,P=El(l()),M;M=yield Qt(P.next()),p=M.done,!p;N=!0){v=M.value,N=!1;const j=v;S||j&&(yield yield Qt(JSON.parse(j)))}}catch(j){y={error:j}}finally{try{!N&&!p&&(x=P.return)&&(yield Qt(x.call(P)))}finally{if(y)throw y.error}}S=!0}catch(j){if(_g(j))return yield Qt(void 0);throw j}finally{S||s.abort()}})}return new pl(d,s,r)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],s=[],r=this.iterator(),o=l=>({next:()=>{if(l.length===0){const d=r.next();e.push(d),s.push(d)}return l.shift()}});return[new pl(()=>o(e),this.controller,this.client),new pl(()=>o(s),this.controller,this.client)]}toReadableStream(){const e=this;let s;return PT({async start(){s=e[Symbol.asyncIterator]()},async pull(r){try{const{value:o,done:l}=await s.next();if(l)return r.close();const d=R0(JSON.stringify(o)+`
`);r.enqueue(d)}catch(o){r.error(o)}},async cancel(){var r;await((r=s.return)===null||r===void 0?void 0:r.call(s))}})}}function _L(n,e){return eu(this,arguments,function*(){var r,o,l,d;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new ia("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new ia("Attempted to iterate over a response with no body");const m=new wL,p=new Yf,y=VT(n.body);try{for(var x=!0,v=El(EL(y)),S;S=yield Qt(v.next()),r=S.done,!r;x=!0){d=S.value,x=!1;const N=d;for(const P of p.decode(N)){const M=m.decode(P);M&&(yield yield Qt(M))}}}catch(N){o={error:N}}finally{try{!x&&!r&&(l=v.return)&&(yield Qt(l.call(v)))}finally{if(o)throw o.error}}for(const N of p.flush()){const P=m.decode(N);P&&(yield yield Qt(P))}})}function EL(n){return eu(this,arguments,function*(){var s,r,o,l;let d=new Uint8Array;try{for(var m=!0,p=El(n),y;y=yield Qt(p.next()),s=y.done,!s;m=!0){l=y.value,m=!1;const x=l;if(x==null)continue;const v=x instanceof ArrayBuffer?new Uint8Array(x):typeof x=="string"?R0(x):x;let S=new Uint8Array(d.length+v.length);S.set(d),S.set(v,d.length),d=S;let N;for(;(N=bL(d))!==-1;)yield yield Qt(d.slice(0,N)),d=d.slice(N)}}catch(x){r={error:x}}finally{try{!m&&!s&&(o=p.return)&&(yield Qt(o.call(p)))}finally{if(r)throw r.error}}d.length>0&&(yield yield Qt(d))})}class wL{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const l={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],l}if(this.chunks.push(e),e.startsWith(":"))return null;let[s,r,o]=SL(e,":");return o.startsWith(" ")&&(o=o.substring(1)),s==="event"?this.event=o:s==="data"&&this.data.push(o),null}}function SL(n,e){const s=n.indexOf(e);return s!==-1?[n.substring(0,s),e,n.substring(s+e.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function TL(n,e){const{response:s,requestLogID:r,retryOfRequestLogID:o,startTime:l}=e,d=await(async()=>{var m;if(e.options.stream)return is(n).debug("response",s.status,s.url,s.headers,s.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(s,e.controller,n):pl.fromSSEResponse(s,e.controller,n);if(s.status===204)return null;if(e.options.__binaryResponse)return s;const p=s.headers.get("content-type"),y=(m=p==null?void 0:p.split(";")[0])===null||m===void 0?void 0:m.trim();return(y==null?void 0:y.includes("application/json"))||(y==null?void 0:y.endsWith("+json"))?s.headers.get("content-length")==="0"?void 0:await s.json():await s.text()})();return is(n).debug(`[${r}] response parsed`,Ki({retryOfRequestLogID:o,url:s.url,status:s.status,body:d,durationMs:Date.now()-l})),d}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class O0 extends Promise{constructor(e,s,r=TL){super(o=>{o(null)}),this.responsePromise=s,this.parseResponse=r,this.client=e}_thenUnwrap(e){return new O0(this.client,this.responsePromise,async(s,r)=>e(await this.parseResponse(s,r),r))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:s}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,s){return this.parse().then(e,s)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $T=Symbol("brand.privateNullableHeaders");function*AL(n){if(!n)return;if($T in n){const{values:r,nulls:o}=n;yield*r.entries();for(const l of o)yield[l,null];return}let e=!1,s;n instanceof Headers?s=n.entries():q_(n)?s=n:(e=!0,s=Object.entries(n??{}));for(let r of s){const o=r[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const l=q_(r[1])?r[1]:[r[1]];let d=!1;for(const m of l)m!==void 0&&(e&&!d&&(d=!0,yield[o,null]),yield[o,m])}}const Oc=n=>{const e=new Headers,s=new Set;for(const r of n){const o=new Set;for(const[l,d]of AL(r)){const m=l.toLowerCase();o.has(m)||(e.delete(l),o.add(m)),d===null?(e.delete(l),s.add(m)):(e.append(l,d),s.delete(m))}}return{[$T]:!0,values:e,nulls:s}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const pm=n=>{var e,s,r,o,l,d;if(typeof globalThis.process<"u")return(r=(s=(e=q4)===null||e===void 0?void 0:e[n])===null||s===void 0?void 0:s.trim())!==null&&r!==void 0?r:void 0;if(typeof globalThis.Deno<"u")return(d=(l=(o=globalThis.Deno.env)===null||o===void 0?void 0:o.get)===null||l===void 0?void 0:l.call(o,n))===null||d===void 0?void 0:d.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var YT;class Qf{constructor(e){var s,r,o,l,d,m,p,{baseURL:y=pm("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:x=(s=pm("GEMINI_API_KEY"))!==null&&s!==void 0?s:null,apiVersion:v="v1beta"}=e,S=_f(e,["baseURL","apiKey","apiVersion"]);const N=Object.assign(Object.assign({apiKey:x,apiVersion:v},S),{baseURL:y||"https://generativelanguage.googleapis.com"});this.baseURL=N.baseURL,this.timeout=(r=N.timeout)!==null&&r!==void 0?r:Qf.DEFAULT_TIMEOUT,this.logger=(o=N.logger)!==null&&o!==void 0?o:console;const P="warn";this.logLevel=P,this.logLevel=(d=(l=K_(N.logLevel,"ClientOptions.logLevel",this))!==null&&l!==void 0?l:K_(pm("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&d!==void 0?d:P,this.fetchOptions=N.fetchOptions,this.maxRetries=(m=N.maxRetries)!==null&&m!==void 0?m:2,this.fetch=(p=N.fetch)!==null&&p!==void 0?p:iL(),this.encoder=cL,this._options=N,this.apiKey=x,this.apiVersion=v,this.clientAdapter=N.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:s}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!s.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const s=Oc([e.headers]);if(!(s.values.has("authorization")||s.values.has("x-goog-api-key"))){if(this.apiKey)return Oc([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Oc([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([s,r])=>typeof r<"u").map(([s,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(s)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(s)}=`;throw new ia(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${hl}`}defaultIdempotencyKey(){return`stainless-node-retry-${$4()}`}makeStatusError(e,s,r,o){return us.generate(e,s,r,o)}buildURL(e,s,r){const o=!this.baseURLOverridden()&&r||this.baseURL,l=Q4(e)?new URL(e):new URL(o+(o.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),d=this.defaultQuery();return Z4(d)||(s=Object.assign(Object.assign({},d),s)),typeof s=="object"&&s&&!Array.isArray(s)&&(l.search=this.stringifyQuery(s)),l.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const s=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${s}`}}async prepareRequest(e,{url:s,options:r}){}get(e,s){return this.methodRequest("get",e,s)}post(e,s){return this.methodRequest("post",e,s)}patch(e,s){return this.methodRequest("patch",e,s)}put(e,s){return this.methodRequest("put",e,s)}delete(e,s){return this.methodRequest("delete",e,s)}methodRequest(e,s,r){return this.request(Promise.resolve(r).then(o=>Object.assign({method:e,path:s},o)))}request(e,s=null){return new O0(this,this.makeRequest(e,s,void 0))}async makeRequest(e,s,r){var o,l,d;const m=await e,p=(o=m.maxRetries)!==null&&o!==void 0?o:this.maxRetries;s==null&&(s=p),await this.prepareOptions(m);const{req:y,url:x,timeout:v}=await this.buildRequest(m,{retryCount:p-s});await this.prepareRequest(y,{url:x,options:m});const S="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),N=r===void 0?"":`, retryOf: ${r}`,P=Date.now();if(is(this).debug(`[${S}] sending request`,Ki({retryOfRequestLogID:r,method:m.method,url:x,options:m,headers:y.headers})),!((l=m.signal)===null||l===void 0)&&l.aborted)throw new wg;const M=new AbortController,j=await this.fetchWithTimeout(x,y,v,M).catch(Eg),V=Date.now();if(j instanceof globalThis.Error){const H=`retrying, ${s} attempts remaining`;if(!((d=m.signal)===null||d===void 0)&&d.aborted)throw new wg;const G=_g(j)||/timed? ?out/i.test(String(j)+("cause"in j?String(j.cause):""));if(s)return is(this).info(`[${S}] connection ${G?"timed out":"failed"} - ${H}`),is(this).debug(`[${S}] connection ${G?"timed out":"failed"} (${H})`,Ki({retryOfRequestLogID:r,url:x,durationMs:V-P,message:j.message})),this.retryRequest(m,s,r??S);throw is(this).info(`[${S}] connection ${G?"timed out":"failed"} - error; no more retries left`),is(this).debug(`[${S}] connection ${G?"timed out":"failed"} (error; no more retries left)`,Ki({retryOfRequestLogID:r,url:x,durationMs:V-P,message:j.message})),G?new CT:new $f({cause:j})}const B=`[${S}${N}] ${y.method} ${x} ${j.ok?"succeeded":"failed"} with status ${j.status} in ${V-P}ms`;if(!j.ok){const H=await this.shouldRetry(j);if(s&&H){const _=`retrying, ${s} attempts remaining`;return await lL(j.body),is(this).info(`${B} - ${_}`),is(this).debug(`[${S}] response error (${_})`,Ki({retryOfRequestLogID:r,url:j.url,status:j.status,headers:j.headers,durationMs:V-P})),this.retryRequest(m,s,r??S,j.headers)}const G=H?"error; no more retries left":"error; not retryable";is(this).info(`${B} - ${G}`);const Y=await j.text().catch(_=>Eg(_).message),K=eL(Y),I=K?void 0:Y;throw is(this).debug(`[${S}] response error (${G})`,Ki({retryOfRequestLogID:r,url:j.url,status:j.status,headers:j.headers,message:I,durationMs:Date.now()-P})),this.makeStatusError(j.status,K,I,j.headers)}return is(this).info(B),is(this).debug(`[${S}] response start`,Ki({retryOfRequestLogID:r,url:j.url,status:j.status,headers:j.headers,durationMs:V-P})),{response:j,options:m,controller:M,requestLogID:S,retryOfRequestLogID:r,startTime:P}}async fetchWithTimeout(e,s,r,o){const l=s||{},{signal:d,method:m}=l,p=_f(l,["signal","method"]),y=this._makeAbort(o);d&&d.addEventListener("abort",y,{once:!0});const x=setTimeout(y,r),v=globalThis.ReadableStream&&p.body instanceof globalThis.ReadableStream||typeof p.body=="object"&&p.body!==null&&Symbol.asyncIterator in p.body,S=Object.assign(Object.assign(Object.assign({signal:o.signal},v?{duplex:"half"}:{}),{method:"GET"}),p);m&&(S.method=m.toUpperCase());try{return await this.fetch.call(void 0,e,S)}finally{clearTimeout(x)}}async shouldRetry(e){const s=e.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,s,r,o){var l;let d;const m=o==null?void 0:o.get("retry-after-ms");if(m){const y=parseFloat(m);Number.isNaN(y)||(d=y)}const p=o==null?void 0:o.get("retry-after");if(p&&!d){const y=parseFloat(p);Number.isNaN(y)?d=Date.parse(p)-Date.now():d=y*1e3}if(!(d&&0<=d&&d<60*1e3)){const y=(l=e.maxRetries)!==null&&l!==void 0?l:this.maxRetries;d=this.calculateDefaultRetryTimeoutMillis(s,y)}return await tL(d),this.makeRequest(e,s-1,r)}calculateDefaultRetryTimeoutMillis(e,s){const l=s-e,d=Math.min(.5*Math.pow(2,l),8),m=1-Math.random()*.25;return d*m*1e3}async buildRequest(e,{retryCount:s=0}={}){var r,o,l;const d=Object.assign({},e),{method:m,path:p,query:y,defaultBaseURL:x}=d,v=this.buildURL(p,y,x);"timeout"in d&&J4("timeout",d.timeout),d.timeout=(r=d.timeout)!==null&&r!==void 0?r:this.timeout;const{bodyHeaders:S,body:N}=this.buildBody({options:d}),P=await this.buildHeaders({options:e,method:m,bodyHeaders:S,retryCount:s});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:m,headers:P},d.signal&&{signal:d.signal}),globalThis.ReadableStream&&N instanceof globalThis.ReadableStream&&{duplex:"half"}),N&&{body:N}),(o=this.fetchOptions)!==null&&o!==void 0?o:{}),(l=d.fetchOptions)!==null&&l!==void 0?l:{}),url:v,timeout:d.timeout}}async buildHeaders({options:e,method:s,bodyHeaders:r,retryCount:o}){let l={};this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const d=await this.authHeaders(e);let m=Oc([l,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),rL()),this._options.defaultHeaders,r,e.headers,d]);return this.validateHeaders(m),m.values}_makeAbort(e){return()=>e.abort()}buildBody({options:{body:e,headers:s}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=Oc([s]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:oL(e)}:this.encoder({body:e,headers:r})}}Qf.DEFAULT_TIMEOUT=6e4;class $n extends Qf{constructor(){super(...arguments),this.interactions=new qT(this)}}YT=$n;$n.GeminiNextGenAPIClient=YT;$n.GeminiNextGenAPIClientError=ia;$n.APIError=us;$n.APIConnectionError=$f;$n.APIConnectionTimeoutError=CT;$n.APIUserAbortError=wg;$n.NotFoundError=kT;$n.ConflictError=LT;$n.RateLimitError=DT;$n.BadRequestError=RT;$n.AuthenticationError=OT;$n.InternalServerError=UT;$n.PermissionDeniedError=jT;$n.UnprocessableEntityError=MT;$n.toFile=pL;$n.Interactions=qT;class IL extends Error{constructor(e,s){super(e),this.name="ManualApiResponseError",this.prompt=s}}const NL=()=>{throw new Error("API_KEY_MISSING")},CL=n=>new Promise(e=>setTimeout(e,n));function RL(n){let e=n.trim();const s=e.indexOf("```json");if(s!==-1){const x=s+7,v=e.lastIndexOf("```");if(v>x)return e.substring(x,v).trim()}const r=e.indexOf("```");if(r!==-1){const x=r+3,v=e.lastIndexOf("```");if(v>x)return e.substring(x,v).trim()}const o=e.indexOf("{"),l=e.indexOf("[");let d=-1;if(o===-1?d=l:l===-1?d=o:d=Math.min(o,l),d===-1)return e;const m=e.lastIndexOf("}"),p=e.lastIndexOf("]"),y=Math.max(m,p);return y>d?e.substring(d,y+1):e}function OL(n,e){if(!n)return e;const s=RL(n);if(!s)return e;try{return JSON.parse(s)}catch(r){if(/[\u201C\u201D]/.test(s)){const d=s.replace(/"/g,'\\"').replace(/[\u201C\u201D]/g,'"');try{return JSON.parse(d)}catch{}}const o=s.replace(/[\u201C\u201D]/g,'"');try{return JSON.parse(o)}catch{}const l=o.replace(/,\s*([}\]])/g,"$1");try{return JSON.parse(l)}catch{if(/[\u201C\u201D]/.test(s)){const m=s.replace(/"/g,'\\"').replace(/[\u201C\u201D]/g,'"').replace(/,\s*([}\]])/g,"$1");try{return JSON.parse(m)}catch{}}return console.error("JSON Parse Failed:",r),e}}}const jL=()=>{const n=new Date().toISOString().split("T")[0];let e=hu("vocab_pro_api_usage",{count:0,date:"1970-01-01"});e.date!==n&&(e={count:0,date:n}),e.count+=1,Kg("vocab_pro_api_usage",e),window.dispatchEvent(new CustomEvent("apiUsageUpdated"))};async function QT(n,e=3){var r;jL();let s;for(let o=0;o<=e;o++)try{return await NL().models.generateContent(n)}catch(l){s=l;const d=((r=l.message)==null?void 0:r.toLowerCase())||"";if(d.includes("api_key_missing"))throw l;if(d.includes("429")||d.includes("quota")||d.includes("exhausted")||d.includes("503")){if(o<e){await CL(Math.pow(2,o)*1e3);continue}throw new IL("API quota exceeded.",n.contents)}throw l}throw s}async function oM(n){const e=Dt(),s=Uk(n),r=await QT({model:e.ai.modelForBasicTasks,contents:s,config:{responseMimeType:"application/json",responseSchema:{type:Xi.ARRAY,items:{type:Xi.OBJECT,properties:{v1:{type:Xi.STRING},v2:{type:Xi.STRING},v3:{type:Xi.STRING}},required:["v1","v2","v3"]}}}});return OL(r.text,[])}async function kL(n,e){Dt();const s=Bk();return(await QT({model:"gemini-2.5-flash-image",contents:{parts:[{inlineData:{mimeType:e,data:n}},{text:s}]}})).text||"No text detected."}var mm={exports:{}},X_;function LL(){return X_||(X_=1,(function(n){var e=(function(s){var r=Object.prototype,o=r.hasOwnProperty,l=Object.defineProperty||function(X,Q,T){X[Q]=T.value},d,m=typeof Symbol=="function"?Symbol:{},p=m.iterator||"@@iterator",y=m.asyncIterator||"@@asyncIterator",x=m.toStringTag||"@@toStringTag";function v(X,Q,T){return Object.defineProperty(X,Q,{value:T,enumerable:!0,configurable:!0,writable:!0}),X[Q]}try{v({},"")}catch{v=function(Q,T,z){return Q[T]=z}}function S(X,Q,T,z){var $=Q&&Q.prototype instanceof H?Q:H,J=Object.create($.prototype),pe=new F(z||[]);return l(J,"_invoke",{value:L(X,T,pe)}),J}s.wrap=S;function N(X,Q,T){try{return{type:"normal",arg:X.call(Q,T)}}catch(z){return{type:"throw",arg:z}}}var P="suspendedStart",M="suspendedYield",j="executing",V="completed",B={};function H(){}function G(){}function Y(){}var K={};v(K,p,function(){return this});var I=Object.getPrototypeOf,A=I&&I(I(ue([])));A&&A!==r&&o.call(A,p)&&(K=A);var _=Y.prototype=H.prototype=Object.create(K);G.prototype=Y,l(_,"constructor",{value:Y,configurable:!0}),l(Y,"constructor",{value:G,configurable:!0}),G.displayName=v(Y,x,"GeneratorFunction");function C(X){["next","throw","return"].forEach(function(Q){v(X,Q,function(T){return this._invoke(Q,T)})})}s.isGeneratorFunction=function(X){var Q=typeof X=="function"&&X.constructor;return Q?Q===G||(Q.displayName||Q.name)==="GeneratorFunction":!1},s.mark=function(X){return Object.setPrototypeOf?Object.setPrototypeOf(X,Y):(X.__proto__=Y,v(X,x,"GeneratorFunction")),X.prototype=Object.create(_),X},s.awrap=function(X){return{__await:X}};function R(X,Q){function T(J,pe,de,_e){var W=N(X[J],X,pe);if(W.type==="throw")_e(W.arg);else{var le=W.arg,ie=le.value;return ie&&typeof ie=="object"&&o.call(ie,"__await")?Q.resolve(ie.__await).then(function(he){T("next",he,de,_e)},function(he){T("throw",he,de,_e)}):Q.resolve(ie).then(function(he){le.value=he,de(le)},function(he){return T("throw",he,de,_e)})}}var z;function $(J,pe){function de(){return new Q(function(_e,W){T(J,pe,_e,W)})}return z=z?z.then(de,de):de()}l(this,"_invoke",{value:$})}C(R.prototype),v(R.prototype,y,function(){return this}),s.AsyncIterator=R,s.async=function(X,Q,T,z,$){$===void 0&&($=Promise);var J=new R(S(X,Q,T,z),$);return s.isGeneratorFunction(Q)?J:J.next().then(function(pe){return pe.done?pe.value:J.next()})};function L(X,Q,T){var z=P;return function(J,pe){if(z===j)throw new Error("Generator is already running");if(z===V){if(J==="throw")throw pe;return ae()}for(T.method=J,T.arg=pe;;){var de=T.delegate;if(de){var _e=O(de,T);if(_e){if(_e===B)continue;return _e}}if(T.method==="next")T.sent=T._sent=T.arg;else if(T.method==="throw"){if(z===P)throw z=V,T.arg;T.dispatchException(T.arg)}else T.method==="return"&&T.abrupt("return",T.arg);z=j;var W=N(X,Q,T);if(W.type==="normal"){if(z=T.done?V:M,W.arg===B)continue;return{value:W.arg,done:T.done}}else W.type==="throw"&&(z=V,T.method="throw",T.arg=W.arg)}}}function O(X,Q){var T=Q.method,z=X.iterator[T];if(z===d)return Q.delegate=null,T==="throw"&&X.iterator.return&&(Q.method="return",Q.arg=d,O(X,Q),Q.method==="throw")||T!=="return"&&(Q.method="throw",Q.arg=new TypeError("The iterator does not provide a '"+T+"' method")),B;var $=N(z,X.iterator,Q.arg);if($.type==="throw")return Q.method="throw",Q.arg=$.arg,Q.delegate=null,B;var J=$.arg;if(!J)return Q.method="throw",Q.arg=new TypeError("iterator result is not an object"),Q.delegate=null,B;if(J.done)Q[X.resultName]=J.value,Q.next=X.nextLoc,Q.method!=="return"&&(Q.method="next",Q.arg=d);else return J;return Q.delegate=null,B}C(_),v(_,x,"Generator"),v(_,p,function(){return this}),v(_,"toString",function(){return"[object Generator]"});function xe(X){var Q={tryLoc:X[0]};1 in X&&(Q.catchLoc=X[1]),2 in X&&(Q.finallyLoc=X[2],Q.afterLoc=X[3]),this.tryEntries.push(Q)}function ge(X){var Q=X.completion||{};Q.type="normal",delete Q.arg,X.completion=Q}function F(X){this.tryEntries=[{tryLoc:"root"}],X.forEach(xe,this),this.reset(!0)}s.keys=function(X){var Q=Object(X),T=[];for(var z in Q)T.push(z);return T.reverse(),function $(){for(;T.length;){var J=T.pop();if(J in Q)return $.value=J,$.done=!1,$}return $.done=!0,$}};function ue(X){if(X){var Q=X[p];if(Q)return Q.call(X);if(typeof X.next=="function")return X;if(!isNaN(X.length)){var T=-1,z=function $(){for(;++T<X.length;)if(o.call(X,T))return $.value=X[T],$.done=!1,$;return $.value=d,$.done=!0,$};return z.next=z}}return{next:ae}}s.values=ue;function ae(){return{value:d,done:!0}}return F.prototype={constructor:F,reset:function(X){if(this.prev=0,this.next=0,this.sent=this._sent=d,this.done=!1,this.delegate=null,this.method="next",this.arg=d,this.tryEntries.forEach(ge),!X)for(var Q in this)Q.charAt(0)==="t"&&o.call(this,Q)&&!isNaN(+Q.slice(1))&&(this[Q]=d)},stop:function(){this.done=!0;var X=this.tryEntries[0],Q=X.completion;if(Q.type==="throw")throw Q.arg;return this.rval},dispatchException:function(X){if(this.done)throw X;var Q=this;function T(_e,W){return J.type="throw",J.arg=X,Q.next=_e,W&&(Q.method="next",Q.arg=d),!!W}for(var z=this.tryEntries.length-1;z>=0;--z){var $=this.tryEntries[z],J=$.completion;if($.tryLoc==="root")return T("end");if($.tryLoc<=this.prev){var pe=o.call($,"catchLoc"),de=o.call($,"finallyLoc");if(pe&&de){if(this.prev<$.catchLoc)return T($.catchLoc,!0);if(this.prev<$.finallyLoc)return T($.finallyLoc)}else if(pe){if(this.prev<$.catchLoc)return T($.catchLoc,!0)}else if(de){if(this.prev<$.finallyLoc)return T($.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(X,Q){for(var T=this.tryEntries.length-1;T>=0;--T){var z=this.tryEntries[T];if(z.tryLoc<=this.prev&&o.call(z,"finallyLoc")&&this.prev<z.finallyLoc){var $=z;break}}$&&(X==="break"||X==="continue")&&$.tryLoc<=Q&&Q<=$.finallyLoc&&($=null);var J=$?$.completion:{};return J.type=X,J.arg=Q,$?(this.method="next",this.next=$.finallyLoc,B):this.complete(J)},complete:function(X,Q){if(X.type==="throw")throw X.arg;return X.type==="break"||X.type==="continue"?this.next=X.arg:X.type==="return"?(this.rval=this.arg=X.arg,this.method="return",this.next="end"):X.type==="normal"&&Q&&(this.next=Q),B},finish:function(X){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var T=this.tryEntries[Q];if(T.finallyLoc===X)return this.complete(T.completion,T.afterLoc),ge(T),B}},catch:function(X){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var T=this.tryEntries[Q];if(T.tryLoc===X){var z=T.completion;if(z.type==="throw"){var $=z.arg;ge(T)}return $}}throw new Error("illegal catch attempt")},delegateYield:function(X,Q,T){return this.delegate={iterator:ue(X),resultName:Q,nextLoc:T},this.method==="next"&&(this.arg=d),B}},s})(n.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(mm)),mm.exports}var gm,J_;function j0(){return J_||(J_=1,gm=(n,e)=>`${n}-${e}-${Math.random().toString(16).slice(3,8)}`),gm}var ym,eE;function WT(){if(eE)return ym;eE=1;const n=j0();let e=0;return ym=({id:s,action:r,payload:o={}})=>{let l=s;return typeof l>"u"&&(l=n("Job",e),e+=1),{id:l,action:r,payload:o}},ym}var jc={},tE;function k0(){if(tE)return jc;tE=1;let n=!1;return jc.logging=n,jc.setLogging=e=>{n=e},jc.log=(...e)=>n?console.log.apply(this,e):null,jc}var xm,nE;function ML(){if(nE)return xm;nE=1;const n=WT(),{log:e}=k0(),s=j0();let r=0;return xm=()=>{const o=s("Scheduler",r),l={},d={};let m=[];r+=1;const p=()=>m.length,y=()=>Object.keys(l).length,x=()=>{if(m.length!==0){const M=Object.keys(l);for(let j=0;j<M.length;j+=1)if(typeof d[M[j]]>"u"){m[0](l[M[j]]);break}}},v=(M,j)=>new Promise((V,B)=>{const H=n({action:M,payload:j});m.push(async G=>{m.shift(),d[G.id]=H;try{V(await G[M].apply(this,[...j,H.id]))}catch(Y){B(Y)}finally{delete d[G.id],x()}}),e(`[${o}]: Add ${H.id} to JobQueue`),e(`[${o}]: JobQueue length=${m.length}`),x()});return{addWorker:M=>(l[M.id]=M,e(`[${o}]: Add ${M.id}`),e(`[${o}]: Number of workers=${y()}`),x(),M.id),addJob:async(M,...j)=>{if(y()===0)throw Error(`[${o}]: You need to have at least one worker before adding jobs`);return v(M,j)},terminate:async()=>{Object.keys(l).forEach(async M=>{await l[M].terminate()}),m=[]},getQueueLen:p,getNumWorkers:y}},xm}function DL(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var bm,sE;function UL(){if(sE)return bm;sE=1;function n(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}return bm=n,bm}var vm,aE;function PL(){if(aE)return vm;aE=1;const n=UL();return vm=e=>{const s={};return typeof WorkerGlobalScope<"u"?s.type="webworker":n()?s.type="electron":typeof document=="object"?s.type="browser":typeof process=="object"&&typeof DL=="function"&&(s.type="node"),typeof e>"u"?s:s[e]},vm}var _m,rE;function VL(){if(rE)return _m;rE=1;const e=PL()("type")==="browser"?s=>new URL(s,window.location.href).href:s=>s;return _m=s=>{const r={...s};return["corePath","workerPath","langPath"].forEach(o=>{s[o]&&(r[o]=e(r[o]))}),r},_m}var Em,iE;function zL(){return iE||(iE=1,Em=n=>{const e=[],s=[],r=[],o=[],l=[];return n.blocks&&n.blocks.forEach(d=>{d.paragraphs.forEach(m=>{m.lines.forEach(p=>{p.words.forEach(y=>{y.symbols.forEach(x=>{l.push({...x,page:n,block:d,paragraph:m,line:p,word:y})}),o.push({...y,page:n,block:d,paragraph:m,line:p})}),r.push({...p,page:n,block:d,paragraph:m})}),s.push({...m,page:n,block:d})}),e.push({...d,page:n})}),{...n,blocks:e,paragraphs:s,lines:r,words:o,symbols:l}}),Em}var wm,oE;function KT(){return oE||(oE=1,wm={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3}),wm}const BL="5.1.1",FL={version:BL};var Sm,lE;function HL(){return lE||(lE=1,Sm={workerBlobURL:!0,logger:()=>{}}),Sm}var Tm,cE;function GL(){if(cE)return Tm;cE=1;const n=FL.version;return Tm={...HL(),workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${n}/dist/worker.min.js`},Tm}var Am,uE;function qL(){return uE||(uE=1,Am=({workerPath:n,workerBlobURL:e})=>{let s;if(Blob&&URL&&e){const r=new Blob([`importScripts("${n}");`],{type:"application/javascript"});s=new Worker(URL.createObjectURL(r))}else s=new Worker(n);return s}),Am}var Im,dE;function $L(){return dE||(dE=1,Im=n=>{n.terminate()}),Im}var Nm,fE;function YL(){return fE||(fE=1,Nm=(n,e)=>{n.onmessage=({data:s})=>{e(s)}}),Nm}var Cm,hE;function QL(){return hE||(hE=1,Cm=async(n,e)=>{n.postMessage(e)}),Cm}var Rm,pE;function WL(){if(pE)return Rm;pE=1;const n=s=>new Promise((r,o)=>{const l=new FileReader;l.onload=()=>{r(l.result)},l.onerror=({target:{error:{code:d}}})=>{o(Error(`File could not be read! Code=${d}`))},l.readAsArrayBuffer(s)}),e=async s=>{let r=s;if(typeof s>"u")return"undefined";if(typeof s=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(s)?r=atob(s.split(",")[1]).split("").map(o=>o.charCodeAt(0)):r=await(await fetch(s)).arrayBuffer();else if(typeof HTMLElement<"u"&&s instanceof HTMLElement)s.tagName==="IMG"&&(r=await e(s.src)),s.tagName==="VIDEO"&&(r=await e(s.poster)),s.tagName==="CANVAS"&&await new Promise(o=>{s.toBlob(async l=>{r=await n(l),o()})});else if(typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas){const o=await s.convertToBlob();r=await n(o)}else(s instanceof File||s instanceof Blob)&&(r=await n(s));return new Uint8Array(r)};return Rm=e,Rm}var Om,mE;function KL(){if(mE)return Om;mE=1;const n=GL(),e=qL(),s=$L(),r=YL(),o=QL(),l=WL();return Om={defaultOptions:n,spawnWorker:e,terminateWorker:s,onMessage:r,send:o,loadImage:l},Om}var jm,gE;function ZT(){if(gE)return jm;gE=1;const n=VL(),e=zL(),s=WT(),{log:r}=k0(),o=j0(),l=KT(),{defaultOptions:d,spawnWorker:m,terminateWorker:p,onMessage:y,loadImage:x,send:v}=KL();let S=0;return jm=async(N="eng",P=l.LSTM_ONLY,M={},j={})=>{const V=o("Worker",S),{logger:B,errorHandler:H,...G}=n({...d,...M}),Y={},K={},I=typeof N=="string"?N.split("+"):N;let A=P,_=j;const C=[l.DEFAULT,l.LSTM_ONLY].includes(P)&&!G.legacyCore;let R,L;const O=new Promise((Re,we)=>{L=Re,R=we}),xe=Re=>{R(Re.message)};let ge=m(G);ge.onerror=xe,S+=1;const F=(Re,we)=>{Y[Re]=we},ue=(Re,we)=>{K[Re]=we},ae=({id:Re,action:we,payload:rt})=>new Promise((Qe,oe)=>{r(`[${V}]: Start ${Re}, action=${we}`);const ze=`${we}-${Re}`;F(ze,Qe),ue(ze,oe),v(ge,{workerId:V,jobId:Re,action:we,payload:rt})}),X=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),Q=Re=>ae(s({id:Re,action:"load",payload:{options:{lstmOnly:C,corePath:G.corePath,logging:G.logging}}})),T=(Re,we,rt)=>ae(s({id:rt,action:"FS",payload:{method:"writeFile",args:[Re,we]}})),z=(Re,we)=>ae(s({id:we,action:"FS",payload:{method:"readFile",args:[Re,{encoding:"utf8"}]}})),$=(Re,we)=>ae(s({id:we,action:"FS",payload:{method:"unlink",args:[Re]}})),J=(Re,we,rt)=>ae(s({id:rt,action:"FS",payload:{method:Re,args:we}})),pe=()=>console.warn("`loadLanguage` is depreciated and should be removed from code (workers now come with language pre-loaded)"),de=(Re,we)=>ae(s({id:we,action:"loadLanguage",payload:{langs:Re,options:{langPath:G.langPath,dataPath:G.dataPath,cachePath:G.cachePath,cacheMethod:G.cacheMethod,gzip:G.gzip,lstmOnly:[l.DEFAULT,l.LSTM_ONLY].includes(A)&&!G.legacyLang}}})),_e=()=>console.warn("`initialize` is depreciated and should be removed from code (workers now come pre-initialized)"),W=(Re,we,rt,Qe)=>ae(s({id:Qe,action:"initialize",payload:{langs:Re,oem:we,config:rt}})),le=(Re="eng",we,rt,Qe)=>{if(C&&[l.TESSERACT_ONLY,l.TESSERACT_LSTM_COMBINED].includes(we))throw Error("Legacy model requested but code missing.");const oe=we||A;A=oe;const ze=rt||_;_=ze;const vt=(typeof Re=="string"?Re.split("+"):Re).filter(Ye=>!I.includes(Ye));return I.push(...vt),vt.length>0?de(vt,Qe).then(()=>W(Re,oe,ze,Qe)):W(Re,oe,ze,Qe)},ie=(Re={},we)=>ae(s({id:we,action:"setParameters",payload:{params:Re}})),he=async(Re,we={},rt={blocks:!0,text:!0,hocr:!0,tsv:!0},Qe)=>ae(s({id:Qe,action:"recognize",payload:{image:await x(Re),options:we,output:rt}})),Ie=(Re="Tesseract OCR Result",we=!1,rt)=>(console.log("`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead."),ae(s({id:rt,action:"getPDF",payload:{title:Re,textonly:we}}))),Ue=async(Re,we)=>{if(C)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return ae(s({id:we,action:"detect",payload:{image:await x(Re)}}))},je=async()=>(ge!==null&&(p(ge),ge=null),Promise.resolve());y(ge,({workerId:Re,jobId:we,status:rt,action:Qe,data:oe})=>{const ze=`${Qe}-${we}`;if(rt==="resolve"){r(`[${Re}]: Complete ${we}`);let et=oe;Qe==="recognize"?et=e(oe):Qe==="getPDF"&&(et=Array.from({...oe,length:Object.keys(oe).length})),Y[ze]({jobId:we,data:et})}else if(rt==="reject")if(K[ze](oe),Qe==="load"&&R(oe),H)H(oe);else throw Error(oe);else rt==="progress"&&B({...oe,userJobId:we})});const wt={id:V,worker:ge,setResolve:F,setReject:ue,load:X,writeText:T,readText:z,removeFile:$,FS:J,loadLanguage:pe,initialize:_e,reinitialize:le,setParameters:ie,recognize:he,getPDF:Ie,detect:Ue,terminate:je};return Q().then(()=>de(N)).then(()=>W(N,P,j)).then(()=>L(wt)).catch(()=>{}),O},jm}var km,yE;function ZL(){if(yE)return km;yE=1;const n=ZT();return km={recognize:async(r,o,l)=>{const d=await n(o,1,l);return d.recognize(r).finally(async()=>{await d.terminate()})},detect:async(r,o)=>{const l=await n("osd",0,o);return l.detect(r).finally(async()=>{await l.terminate()})}},km}var Lm,xE;function XL(){return xE||(xE=1,Lm={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"}),Lm}var Mm,bE;function JL(){return bE||(bE=1,Mm={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"}),Mm}var Dm,vE;function e5(){if(vE)return Dm;vE=1,LL();const n=ML(),e=ZT(),s=ZL(),r=XL(),o=KT(),l=JL(),{setLogging:d}=k0();return Dm={languages:r,OEM:o,PSM:l,createScheduler:n,createWorker:e,setLogging:d,...s},Dm}var t5=e5();async function _E(n){const e=await t5.createWorker("eng");try{const s=await e.recognize(n);return await e.terminate(),s.data.text}catch(s){throw await e.terminate(),s}}const n5=()=>{const[n,e]=D.useState(null),[s,r]=D.useState(""),[o,l]=D.useState(!1),[d,m]=D.useState(!1),[p,y]=D.useState(!1),[x,v]=D.useState("cloud"),S=D.useRef(null),{showToast:N}=Za();Pn.useEffect(()=>{const B=H=>{var Y;const G=(Y=H.clipboardData)==null?void 0:Y.items;if(G){for(let K=0;K<G.length;K++)if(G[K].type.indexOf("image")!==-1){const I=G[K].getAsFile();I&&P(I);break}}};return document.addEventListener("paste",B),()=>document.removeEventListener("paste",B)},[]);const P=B=>{const H=new FileReader;H.onload=G=>{var Y;typeof((Y=G.target)==null?void 0:Y.result)=="string"&&(e(G.target.result),r(""),m(!1))},H.readAsDataURL(B)},M=B=>{var G;const H=(G=B.target.files)==null?void 0:G[0];H&&P(H)},j=async()=>{if(n){l(!0),m(!1);try{if(x==="offline"){m(!0);const B=await _E(n);r(B)}else try{const B=n.split(",")[1],H=n.split(";")[0].split(":")[1],G=await kL(B,H);r(G)}catch(B){console.warn("Online extraction failed, attempting offline fallback...",B),m(!0);const H=await _E(n);r(H),N("Used offline mode (Cloud unavailable).","info")}}catch(B){console.error(B),N("Extraction failed.","error")}finally{l(!1)}}},V=async()=>{s&&(await Hf(s),y(!0),N("Text copied!","success"),setTimeout(()=>y(!1),2e3))};return u.jsxs("div",{className:"flex flex-col h-full space-y-6",children:[u.jsx("div",{className:"space-y-2 shrink-0",children:n?u.jsxs("div",{className:"relative rounded-3xl overflow-hidden border border-neutral-200 bg-neutral-100 flex justify-center max-h-[300px]",children:[u.jsx("img",{src:n,alt:"Preview",className:"max-w-full object-contain"}),u.jsx("button",{onClick:()=>{e(null),r(""),m(!1)},className:"absolute top-4 right-4 p-2 bg-black/50 text-white rounded-full hover:bg-black/70 backdrop-blur-sm transition-all",children:u.jsx(hn,{size:16})})]}):u.jsxs("div",{onClick:()=>{var B;return(B=S.current)==null?void 0:B.click()},className:"border-2 border-dashed border-neutral-200 rounded-3xl p-10 flex flex-col items-center justify-center text-neutral-400 hover:border-indigo-400 hover:text-indigo-500 hover:bg-indigo-50/30 transition-all cursor-pointer min-h-[200px]",children:[u.jsx(kg,{size:40,className:"mb-4"}),u.jsx("p",{className:"font-bold text-sm",children:"Click to upload or paste image (Ctrl+V)"}),u.jsx("input",{type:"file",ref:S,className:"hidden",accept:"image/*",onChange:M})]})}),u.jsxs("div",{className:"flex justify-center gap-3 shrink-0",children:[u.jsxs("button",{onClick:()=>v("cloud"),className:`flex items-center gap-2 px-4 py-2 rounded-xl text-xs font-bold transition-all border ${x==="cloud"?"bg-indigo-50 border-indigo-200 text-indigo-700 shadow-sm":"bg-white border-neutral-200 text-neutral-500 hover:bg-neutral-50"}`,children:[u.jsx(RE,{size:14}),u.jsx("span",{children:"Cloud (Best)"})]}),u.jsxs("button",{onClick:()=>v("offline"),className:`flex items-center gap-2 px-4 py-2 rounded-xl text-xs font-bold transition-all border ${x==="offline"?"bg-emerald-50 border-emerald-200 text-emerald-700 shadow-sm":"bg-white border-neutral-200 text-neutral-500 hover:bg-neutral-50"}`,children:[u.jsx(pv,{size:14}),u.jsx("span",{children:"Offline"})]})]}),u.jsx("div",{className:"flex justify-center shrink-0",children:u.jsx("button",{onClick:j,disabled:!n||o,className:`px-8 py-3 rounded-xl font-black text-xs uppercase tracking-widest transition-all shadow-lg flex items-center gap-2 ${o?"bg-neutral-800 text-neutral-300":"bg-neutral-900 text-white hover:bg-neutral-800"} disabled:opacity-50`,children:o?u.jsxs(u.Fragment,{children:[u.jsx(Kt,{size:16,className:"animate-spin"}),u.jsx("span",{children:"Processing..."})]}):u.jsxs(u.Fragment,{children:[u.jsx(iI,{size:16}),u.jsx("span",{children:"Extract Text"})]})})}),s&&u.jsxs("div",{className:"space-y-2 animate-in slide-in-from-bottom-4 fade-in duration-500 flex-1 flex flex-col min-h-0",children:[u.jsxs("div",{className:"flex justify-between items-center px-1 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Result"}),d&&u.jsxs("span",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-neutral-100 text-neutral-500 rounded text-[9px] font-bold border border-neutral-200",children:[u.jsx(pv,{size:10})," Offline Result"]})]}),u.jsxs("button",{onClick:V,className:`flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-wider transition-all ${p?"bg-green-100 text-green-700":"bg-neutral-100 text-neutral-600 hover:bg-neutral-200"}`,children:[p?u.jsx(ba,{size:12}):u.jsx(Ng,{size:12}),u.jsx("span",{children:p?"Copied":"Copy"})]})]}),u.jsx("textarea",{value:s,readOnly:!0,className:"w-full flex-1 p-4 bg-neutral-50 border border-neutral-200 rounded-2xl text-sm font-medium text-neutral-800 resize-none focus:outline-none focus:ring-2 focus:ring-neutral-900"})]})]})},s5=({audioBlob:n,onTrim:e,onCancel:s})=>{const r=D.useRef(null),[o,l]=D.useState(null),[d,m]=D.useState(null),[p,y]=D.useState(0),[x,v]=D.useState(1),[S,N]=D.useState(!1),P=D.useRef(null);D.useEffect(()=>((async()=>{const G=new(window.AudioContext||window.webkitAudioContext),Y=await n.arrayBuffer(),K=await G.decodeAudioData(Y);l(G),m(K),M(K,0,1)})(),()=>{o&&o.close()}),[n]);const M=(H,G,Y)=>{const K=r.current;if(!K)return;const I=K.getContext("2d");if(!I)return;const A=K.width,_=K.height;I.clearRect(0,0,A,_);const C=H.getChannelData(0),R=Math.ceil(C.length/A),L=_/2;I.fillStyle="#e5e7eb",I.fillRect(0,0,A,_),I.fillStyle="#6366f1",I.beginPath();for(let ge=0;ge<A;ge++){let F=1,ue=-1;for(let ae=0;ae<R;ae++){const X=C[ge*R+ae];X<F&&(F=X),X>ue&&(ue=X)}I.fillRect(ge,(1+F)*L,1,Math.max(1,(ue-F)*L))}I.fillStyle="rgba(0, 0, 0, 0.4)";const O=G*A,xe=Y*A;I.fillRect(0,0,O,_),I.fillRect(xe,0,A-xe,_),I.fillStyle="#ef4444",I.fillRect(O-2,0,4,_),I.fillRect(xe-2,0,4,_)};D.useEffect(()=>{d&&M(d,p,x)},[p,x,d]);const j=()=>{var A;if(!o||!d)return;if(S){(A=P.current)==null||A.stop(),N(!1);return}const H=d.duration,G=H*p,K=H*x-G,I=o.createBufferSource();I.buffer=d,I.connect(o.destination),I.start(0,G,K),I.onended=()=>N(!1),P.current=I,N(!0)},V=async()=>{if(!o||!d)return;const{bufferToWav:H}=await ds(async()=>{const{bufferToWav:_}=await Promise.resolve().then(()=>i4);return{bufferToWav:_}},void 0),G=Math.floor(p*d.length),Y=Math.floor(x*d.length),K=Y-G,I=o.createBuffer(d.numberOfChannels,K,d.sampleRate);for(let _=0;_<d.numberOfChannels;_++){const C=d.getChannelData(_);I.getChannelData(_).set(C.subarray(G,Y))}const A=H(I);e(A)},B=H=>{const G=r.current;if(!G)return;const Y=G.getBoundingClientRect(),K=H.clientX-Y.left,I=Math.max(0,Math.min(1,K/Y.width)),A=Math.abs(I-p),_=Math.abs(I-x),C=A<_,R=O=>{const xe=O.clientX-Y.left,ge=Math.max(0,Math.min(1,xe/Y.width));C?y(Math.min(ge,x-.05)):v(Math.max(ge,p+.05))},L=()=>{window.removeEventListener("mousemove",R),window.removeEventListener("mouseup",L)};window.addEventListener("mousemove",R),window.addEventListener("mouseup",L)};return u.jsxs("div",{className:"flex flex-col gap-4 p-4 bg-white rounded-2xl border border-neutral-200",children:[u.jsx("div",{className:"relative h-24 bg-neutral-100 rounded-xl overflow-hidden cursor-pointer",onMouseDown:B,children:u.jsx("canvas",{ref:r,width:600,height:100,className:"w-full h-full"})}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 bg-neutral-900 text-white rounded-xl text-xs font-bold uppercase tracking-wider hover:bg-neutral-800 transition-all",children:[S?u.jsx(Og,{size:14}):u.jsx(cu,{size:14}),S?"Stop":"Preview"]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:s,className:"px-4 py-2 text-neutral-500 hover:text-neutral-900 font-bold text-xs",children:"Cancel"}),u.jsxs("button",{onClick:V,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-xl text-xs font-bold uppercase tracking-wider hover:bg-indigo-500 transition-all",children:[u.jsx(xI,{size:14})," Trim & Use"]})]})]}),u.jsx("p",{className:"text-[10px] text-neutral-400 text-center",children:"Drag the red bars to trim audio."})]})},a5=()=>{const n=Dt(),e=Cn(n),{showToast:s}=Za(),[r,o]=D.useState({}),[l,d]=D.useState(!1),[m,p]=D.useState(null),[y,x]=D.useState(null),[v,S]=D.useState(""),[N,P]=D.useState(""),[M,j]=D.useState(!1),[V,B]=D.useState(null),[H,G]=D.useState(""),[Y,K]=D.useState([]),[I,A]=D.useState(!1),[_,C]=D.useState(null),R=D.useRef(null),[L,O]=D.useState(!1),xe=D.useRef(null),ge=async()=>{try{const W=await fetch(`${e}/api/audio/mappings`);if(W.ok){const le=await W.json();o(le);const ie=Object.keys(le);ie.length>0&&!v&&S(ie[0]),ie.length>0&&!V&&(B(ie[0]),F(ie[0],""))}}catch(W){console.error("Failed to fetch mappings",W)}};D.useEffect(()=>{ge()},[e]),D.useEffect(()=>()=>{R.current&&(R.current.pause(),R.current=null)},[]);const F=async(W,le="")=>{A(!0),K([]);try{const ie=encodeURIComponent(le),he=await fetch(`${e}/api/audio/files/${W}?path=${ie}`);if(he.ok){const Ie=await he.json();K(Ie.items),G(Ie.currentPath)}else s("Failed to load files","error")}catch{s("Connection error","error")}finally{A(!1)}},ue=W=>{B(W),S(W),G(""),F(W,"")},ae=W=>{if(!V)return;const le=H?`${H}/${W}`:W;F(V,le)},X=()=>{if(!V||!H)return;const W=H.split("/");W.pop();const le=W.join("/");F(V,le)},Q=async(W,le)=>{if(W.stopPropagation(),!V)return;const ie=H?`${H}/${le}`:le;try{const Ie=await(await fetch(`${e}/api/audio/file?mapName=${encodeURIComponent(V)}&filename=${encodeURIComponent(ie)}`,{method:"DELETE"})).json();Ie.success?(s("File deleted","success"),F(V,H)):s(Ie.error||"Delete failed","error")}catch{s("Server error","error")}},T=async()=>{await A0(),d(!0),p(null),x(null)},z=async()=>{const W=await I0();if(d(!1),W){const le=atob(W.base64),ie=new Array(le.length);for(let Ue=0;Ue<le.length;Ue++)ie[Ue]=le.charCodeAt(Ue);const he=new Uint8Array(ie),Ie=new Blob([he],{type:W.mimeType});p(Ie),x(Ie)}},$=W=>{var ie;const le=(ie=W.target.files)==null?void 0:ie[0];le&&(p(le),x(le),P(le.name))},J=async()=>{if(!y||!v||!N){s("Please select audio, target folder, and filename.","error");return}j(!0);const W=new FormData;W.append("mapName",v),W.append("filename",N),W.append("audio",y,N);try{const ie=await(await fetch(`${e}/api/audio/upload`,{method:"POST",body:W})).json();ie.success?(s("Audio uploaded successfully!","success"),p(null),x(null),P(""),V===v&&F(v,H)):s(ie.error||"Upload failed","error")}catch{s("Upload error","error")}finally{j(!1)}},pe=W=>{if(!V)return"";const le=H?`${H}/${W}`:W;return`${e}/api/audio/stream/${V}/${le}`},de=(W,le)=>{W.stopPropagation();const ie=pe(le);ie&&(Hf(ie),s("Audio URL copied!","success"))},_e=W=>{var he;const le=pe(W);if(!le)return;if(_===le&&L){(he=R.current)==null||he.pause(),O(!1);return}R.current&&R.current.pause();const ie=new Audio(le);R.current=ie,C(le),ie.play().then(()=>O(!0)).catch(()=>{s("Failed to play audio","error"),O(!1)}),ie.onended=()=>O(!1),ie.onerror=()=>{O(!1),C(null)}};return u.jsxs("div",{className:"flex flex-col h-full gap-4",children:[u.jsx("div",{className:"shrink-0 bg-white p-4 rounded-2xl border border-neutral-200 shadow-sm",children:m?u.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-top-2",children:[u.jsx(s5,{audioBlob:m,onTrim:W=>{x(W),s("Trimmed!","success")},onCancel:()=>{p(null),x(null)}}),u.jsxs("div",{className:"p-4 bg-neutral-50 rounded-xl border border-neutral-200 space-y-3",children:[u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsxs("select",{value:v,onChange:W=>S(W.target.value),className:"w-full px-3 py-2 rounded-xl border border-neutral-200 text-xs font-bold bg-white focus:ring-2 focus:ring-neutral-900 outline-none",children:[u.jsx("option",{value:"",children:"Target Folder..."}),Object.keys(r).map(W=>u.jsx("option",{value:W,children:W},W))]}),u.jsx("input",{value:N,onChange:W=>P(W.target.value),placeholder:"filename.wav",className:"w-full px-3 py-2 rounded-xl border border-neutral-200 text-xs font-bold bg-white focus:ring-2 focus:ring-neutral-900 outline-none"})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>{p(null),x(null)},className:"flex-1 py-2.5 bg-white border border-neutral-200 text-neutral-500 rounded-xl font-bold text-xs hover:bg-neutral-50 transition-all",children:"Cancel"}),u.jsxs("button",{onClick:J,disabled:M||!v||!N,className:"flex-[2] py-2.5 bg-neutral-900 text-white rounded-xl font-black text-xs uppercase tracking-widest hover:bg-neutral-800 disabled:opacity-50 transition-all flex items-center justify-center gap-2",children:[M?u.jsx(Kt,{size:14,className:"animate-spin"}):u.jsx(FE,{size:14}),u.jsx("span",{children:"Save"})]})]})]})]}):u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("button",{onClick:l?z:T,className:`flex items-center justify-center gap-2 p-3 rounded-xl border transition-all ${l?"bg-red-50 border-red-200 text-red-600 animate-pulse":"bg-neutral-50 border-neutral-200 text-neutral-600 hover:bg-white hover:border-indigo-300 hover:text-indigo-600"}`,children:[u.jsx(mo,{size:20}),u.jsx("span",{className:"font-bold text-xs",children:l?"Stop Recording":"Record Voice"})]}),u.jsxs("button",{onClick:()=>{var W;return(W=xe.current)==null?void 0:W.click()},className:"flex items-center justify-center gap-2 p-3 rounded-xl border bg-neutral-50 border-neutral-200 text-neutral-600 transition-all hover:bg-white hover:border-indigo-300 hover:text-indigo-600",children:[u.jsx(kg,{size:20}),u.jsx("span",{className:"font-bold text-xs",children:"Upload File"}),u.jsx("input",{type:"file",ref:xe,className:"hidden",accept:"audio/*",onChange:$})]})]})}),u.jsxs("div",{className:"flex-1 flex flex-col min-h-0 bg-neutral-50 rounded-2xl border border-neutral-200 overflow-hidden",children:[u.jsxs("div",{className:"p-3 border-b border-neutral-200 bg-white space-y-2 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("select",{value:V||"",onChange:W=>ue(W.target.value),className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-xl text-xs font-bold text-neutral-700 outline-none focus:ring-2 focus:ring-neutral-900",children:[u.jsx("option",{value:"",disabled:!0,children:"Select Folder..."}),Object.keys(r).map(W=>u.jsx("option",{value:W,children:W},W))]}),u.jsx("div",{className:"flex-1 flex items-center gap-1 overflow-hidden",children:H&&u.jsxs(u.Fragment,{children:[u.jsx(of,{size:14,className:"text-neutral-300 shrink-0"}),u.jsx("span",{className:"text-xs font-mono text-neutral-500 truncate",title:H,children:H})]})}),V&&u.jsx("button",{onClick:()=>F(V,H),className:"p-2 hover:bg-neutral-100 rounded-full transition-colors",children:u.jsx(Sl,{size:14,className:I?"animate-spin":""})})]}),H&&u.jsxs("button",{onClick:X,className:"flex items-center gap-1.5 px-3 py-1.5 bg-neutral-100 text-neutral-600 rounded-lg text-[10px] font-bold hover:bg-neutral-200 transition-colors w-fit",children:[u.jsx(OE,{size:12})," Up One Level"]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-2 custom-scrollbar",children:I?u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-neutral-400 space-y-2",children:[u.jsx(Kt,{size:24,className:"animate-spin"}),u.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Loading..."})]}):Y.length===0?u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-neutral-400 space-y-2",children:[u.jsx(aI,{size:32,className:"opacity-20"}),u.jsx("p",{className:"text-xs font-medium",children:"Empty folder."})]}):u.jsx("div",{className:"grid grid-cols-1 gap-1",children:Y.map((W,le)=>{if(W.type==="directory")return u.jsxs("div",{onClick:()=>ae(W.name),className:"flex items-center justify-between p-2 rounded-lg hover:bg-white hover:shadow-sm border border-transparent hover:border-neutral-100 transition-all cursor-pointer group",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"p-2 rounded-full bg-blue-50 text-blue-500",children:u.jsx(kE,{size:14,fill:"currentColor"})}),u.jsx("span",{className:"text-xs font-bold text-neutral-700 truncate",children:W.name})]}),u.jsx(of,{size:14,className:"text-neutral-300 group-hover:text-neutral-500"})]},`${W.name}-${le}`);{const ie=_==null?void 0:_.endsWith(`/${encodeURIComponent(W.name)}`);return u.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-white hover:shadow-sm border border-transparent hover:border-neutral-100 transition-all group",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0 cursor-pointer flex-1",onClick:()=>_e(W.name),children:[u.jsx("button",{className:`p-2 rounded-full transition-colors ${ie&&L?"bg-indigo-100 text-indigo-600":"bg-neutral-100 text-neutral-500 hover:bg-neutral-200 hover:text-neutral-900"}`,children:ie&&L?u.jsx(Og,{size:12,fill:"currentColor"}):u.jsx(cu,{size:12,fill:"currentColor"})}),u.jsx("span",{className:`text-xs font-medium truncate ${ie?"text-indigo-700 font-bold":"text-neutral-700"}`,children:W.name})]}),u.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[u.jsx("button",{onClick:he=>de(he,W.name),className:"p-1.5 text-neutral-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-md transition-colors",title:"Copy URL",children:u.jsx(Ng,{size:12})}),u.jsx("button",{onClick:he=>Q(he,W.name),className:"p-1.5 text-neutral-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors",title:"Delete",children:u.jsx(jg,{size:12})})]})]},`${W.name}-${le}`)}})})})]})]})},r5=()=>{const n=Dt(),e=Cn(n),{showToast:s}=Za(),[r,o]=D.useState({}),[l,d]=D.useState(null),[m,p]=D.useState(""),[y,x]=D.useState([]),[v,S]=D.useState(!1),[N,P]=D.useState(!1),M=D.useRef(null),j=async()=>{try{const _=await fetch(`${e}/api/audio/mappings`);if(_.ok){const C=await _.json();o(C);const R=Object.keys(C),L=R.find(O=>O.toLowerCase()==="image"||O.toLowerCase()==="images"||O.toLowerCase()==="icon")||R[0];L&&!l&&(d(L),V(L,""))}}catch(_){console.error("Failed to fetch mappings",_)}};D.useEffect(()=>{j()},[e]);const V=async(_,C="")=>{S(!0),x([]);try{const R=encodeURIComponent(C),L=await fetch(`${e}/api/images/files/${_}?path=${R}`);if(L.ok){const O=await L.json();x(O.items),p(O.currentPath)}else s("Failed to load images","error")}catch{s("Connection error","error")}finally{S(!1)}},B=_=>{d(_),p(""),V(_,"")},H=_=>{if(!l)return;const C=m?`${m}/${_}`:_;V(l,C)},G=()=>{if(!l||!m)return;const _=m.split("/");_.pop();const C=_.join("/");V(l,C)},Y=async(_,C)=>{if(_.stopPropagation(),!l)return;const R=m?`${m}/${C}`:C;try{const O=await(await fetch(`${e}/api/images/file?mapName=${encodeURIComponent(l)}&filename=${encodeURIComponent(R)}`,{method:"DELETE"})).json();O.success?(s("File deleted","success"),V(l,m)):s(O.error||"Delete failed","error")}catch{s("Server error","error")}},K=_=>{if(!l)return"";const C=m?`${m}/${_}`:_;return`${e}/api/images/stream/${l}/${C}`},I=(_,C)=>{_.stopPropagation();const R=K(C);R&&(Hf(R),s("Image URL copied!","success"))},A=async _=>{var L;const C=(L=_.target.files)==null?void 0:L[0];if(!C||!l)return;P(!0);const R=new FormData;R.append("mapName",l),m?`${m}${C.name}`:C.name,R.append("filename",C.name),R.append("image",C);try{const xe=await(await fetch(`${e}/api/images/upload`,{method:"POST",body:R})).json();xe.success?(s("Image uploaded!","success"),V(l,"")):s(xe.error||"Upload failed","error")}catch{s("Upload error","error")}finally{P(!1),M.current&&(M.current.value="")}};return u.jsx("div",{className:"flex flex-col h-full gap-4",children:u.jsxs("div",{className:"flex-1 flex flex-col min-h-0 bg-neutral-50 rounded-2xl border border-neutral-200 overflow-hidden",children:[u.jsxs("div",{className:"p-3 border-b border-neutral-200 bg-white space-y-2 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("select",{value:l||"",onChange:_=>B(_.target.value),className:"px-3 py-2 bg-neutral-50 border border-neutral-200 rounded-xl text-xs font-bold text-neutral-700 outline-none focus:ring-2 focus:ring-neutral-900",children:[u.jsx("option",{value:"",disabled:!0,children:"Select Folder..."}),Object.keys(r).map(_=>u.jsx("option",{value:_,children:_},_))]}),u.jsx("div",{className:"flex-1 flex items-center gap-1 overflow-hidden",children:m&&u.jsxs(u.Fragment,{children:[u.jsx(of,{size:14,className:"text-neutral-300 shrink-0"}),u.jsx("span",{className:"text-xs font-mono text-neutral-500 truncate",title:m,children:m})]})}),l&&u.jsx("button",{onClick:()=>V(l,m),className:"p-2 hover:bg-neutral-100 rounded-full transition-colors",children:u.jsx(Sl,{size:14,className:v?"animate-spin":""})})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[m?u.jsxs("button",{onClick:G,className:"flex items-center gap-1.5 px-3 py-1.5 bg-neutral-100 text-neutral-600 rounded-lg text-[10px] font-bold hover:bg-neutral-200 transition-colors w-fit",children:[u.jsx(OE,{size:12})," Up One Level"]}):u.jsx("div",{}),l&&u.jsxs("button",{onClick:()=>{var _;return(_=M.current)==null?void 0:_.click()},disabled:N,className:"flex items-center gap-1.5 px-3 py-1.5 bg-indigo-600 text-white rounded-lg text-[10px] font-bold hover:bg-indigo-700 transition-colors shadow-sm disabled:opacity-50",children:[N?u.jsx(Kt,{size:12,className:"animate-spin"}):u.jsx(kg,{size:12}),u.jsx("span",{children:"Upload Image"}),u.jsx("input",{type:"file",ref:M,className:"hidden",accept:"image/*",onChange:A})]})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:v?u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-neutral-400 space-y-2",children:[u.jsx(Kt,{size:24,className:"animate-spin"}),u.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider",children:"Loading..."})]}):y.length===0?u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-neutral-400 space-y-2",children:[u.jsx(UE,{size:32,className:"opacity-20"}),u.jsx("p",{className:"text-xs font-medium",children:"Empty folder."})]}):u.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:[y.filter(_=>_.type==="directory").map((_,C)=>u.jsxs("div",{onClick:()=>H(_.name),className:"aspect-square rounded-xl bg-blue-50 border border-blue-100 flex flex-col items-center justify-center cursor-pointer hover:bg-blue-100 transition-colors gap-2",children:[u.jsx(kE,{size:32,className:"text-blue-400"}),u.jsx("span",{className:"text-xs font-bold text-blue-800 truncate px-2 max-w-full",children:_.name})]},`dir-${C}`)),y.filter(_=>_.type==="file").map((_,C)=>{const R=K(_.name);return u.jsxs("div",{className:"group relative aspect-square rounded-xl bg-white border border-neutral-200 overflow-hidden shadow-sm hover:shadow-md transition-all",children:[u.jsx("div",{className:"absolute inset-0 bg-neutral-100 flex items-center justify-center",children:u.jsx("img",{src:R,alt:_.name,className:"w-full h-full object-cover",loading:"lazy"})}),u.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col items-center justify-center gap-2 p-2",children:[u.jsx("p",{className:"text-[10px] text-white font-medium truncate w-full text-center mb-1",children:_.name}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:L=>I(L,_.name),className:"p-2 bg-white text-indigo-600 rounded-full hover:bg-indigo-50 transition-colors",title:"Copy URL",children:u.jsx(Ng,{size:14})}),u.jsx("button",{onClick:L=>Y(L,_.name),className:"p-2 bg-white text-red-600 rounded-full hover:bg-red-50 transition-colors",title:"Delete",children:u.jsx(jg,{size:14})})]})]})]},`file-${C}`)})]})})]})})},i5=({isOpen:n,onClose:e})=>{const[s,r]=D.useState("OCR");if(!n)return null;const o=[{id:"OCR",label:"Image to Text",icon:gI},{id:"IMAGES",label:"Image Manager",icon:UE},{id:"AUDIO",label:"Audio Tool",icon:mo}];return u.jsx("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-4xl rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col h-[85vh]",children:[u.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-center shrink-0",children:[u.jsx("div",{className:"flex gap-2 p-1 bg-neutral-100 rounded-xl",children:o.map(l=>{const d=l.icon;return u.jsxs("button",{onClick:()=>r(l.id),className:`flex items-center gap-2 px-4 py-2.5 rounded-lg text-xs font-black uppercase tracking-wider transition-all ${s===l.id?"bg-white text-neutral-900 shadow-sm":"text-neutral-500 hover:text-neutral-700"}`,children:[u.jsx(d,{size:16}),u.jsx("span",{children:l.label})]},l.id)})}),u.jsx("button",{onClick:e,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full transition-colors",children:u.jsx(hn,{size:24})})]}),u.jsxs("main",{className:"flex-1 overflow-y-auto p-6 md:p-8",children:[s==="OCR"&&u.jsx(n5,{}),s==="IMAGES"&&u.jsx(r5,{}),s==="AUDIO"&&u.jsx(a5,{})]})]})})},o5=1e3,l5=300,EE=n=>{if(!Array.isArray(n)||n.length===0)return[];const e=new Map,s=[],r=o=>{const l=String(o||"").toLowerCase();return/\bnoun\b/.test(l)?"NOUN":/\bverb\b/.test(l)?"VERB":/\badjective\b/.test(l)?"ADJECTIVE":/\badverb\b/.test(l)?"ADVERB":/\bpronoun\b/.test(l)?"PRONOUN":/\bpreposition\b/.test(l)?"PREPOSITION":/\bconjunction\b/.test(l)?"CONJUNCTION":/\binterjection\b/.test(l)?"INTERJECTION":String(o||"").replace(/\s+/g," ").trim().toUpperCase()||"N/A"};for(const o of n){const l=r(o.partOfSpeech);e.has(l)||(e.set(l,{headword:o.headword||null,partOfSpeech:l,ipaUs:null,ipaUk:null,audioUs:null,audioUk:null}),s.push(l));const d=e.get(l);!d.headword&&o.headword&&(d.headword=o.headword),!d.ipaUs&&o.ipaUs&&(d.ipaUs=o.ipaUs),!d.ipaUk&&o.ipaUk&&(d.ipaUk=o.ipaUk),!d.audioUs&&o.audioUs&&(d.audioUs=o.audioUs),!d.audioUk&&o.audioUk&&(d.audioUk=o.audioUk)}return s.map(o=>e.get(o)).filter(o=>o.ipaUs||o.ipaUk||o.audioUs||o.audioUk)},wE={woman_teacher:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/People/Woman%20Teacher.png",bg:"bg-indigo-50"},man_teacher:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/People/Man%20Teacher.png",bg:"bg-blue-50"},fox:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Fox.png",bg:"bg-orange-100"},koala:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Koala.png",bg:"bg-teal-100"},pet:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Cat%20Face.png",bg:"bg-pink-100"},owl:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Owl.png",bg:"bg-yellow-100"},panda:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Panda.png",bg:"bg-emerald-100"},unicorn:{url:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Unicorn.png",bg:"bg-purple-100"}},c5=({user:n,onViewWord:e,isAnyModalOpen:s})=>{const{showToast:r}=Za(),[o,l]=D.useState(Dt()),[d,m]=D.useState(Pc()),[p,y]=D.useState(Vc()),[x,v]=D.useState(zc()),[S,N]=D.useState(!1),[P,M]=D.useState(af()),[j,V]=D.useState({currentTime:0,duration:0}),[B,H]=D.useState([]),[G,Y]=D.useState(0),[K,I]=D.useState(!1),[A,_]=D.useState(null),[C,R]=D.useState(!1),[L,O]=D.useState(null),[xe,ge]=D.useState(null),[F,ue]=D.useState(!1),[ae,X]=D.useState(!1),[Q,T]=D.useState(!1),z=D.useRef(null),$=D.useRef(null),J=D.useRef(null),pe=D.useRef(null),de=D.useRef(null),_e=D.useRef(!1),W=D.useRef(""),le=D.useRef(null),ie=D.useRef(!1),he=D.useRef(null),Ie=D.useRef({word:"",at:0}),Ue=o.audioCoach.activeCoach,je=o.audioCoach.coaches[Ue],wt=Re(je.avatar);function Re(ve){return ve.startsWith("http")||ve.startsWith("data:")?{url:ve,bg:"bg-white border-2 border-neutral-100"}:wE[ve]||wE.woman_teacher}const we=async ve=>{if(!ve||!n.id)return;const Oe=await Ym(n.id,ve);ue(!!Oe)};D.useEffect(()=>{ie.current=K},[K]),D.useEffect(()=>{if(d&&!x){de.current&&(window.clearTimeout(de.current),de.current=null),N(!0);return}de.current&&window.clearTimeout(de.current),de.current=window.setTimeout(()=>{N(!1),de.current=null},260)},[d,x]),D.useEffect(()=>{he.current=A},[A]),D.useEffect(()=>{const ve=()=>l(Dt()),Oe=xt=>{const Ke=xt.detail,dt=typeof(Ke==null?void 0:Ke.isSpeaking)=="boolean"?Ke.isSpeaking:Pc(),ft=typeof(Ke==null?void 0:Ke.isAudioPaused)=="boolean"?Ke.isAudioPaused:Vc(),zt=typeof(Ke==null?void 0:Ke.isSingleWordPlayback)=="boolean"?Ke.isSingleWordPlayback:zc(),Tt=typeof(Ke==null?void 0:Ke.playbackRate)=="number"?Ke.playbackRate:af();if(M(Tt),dt){pe.current&&(window.clearTimeout(pe.current),pe.current=null),m(!0),y(ft),v(zt);return}pe.current&&window.clearTimeout(pe.current),pe.current=window.setTimeout(()=>{m(Pc()),y(Vc()),v(zc()),pe.current=null},180)},Ae=xt=>{var Sn,oa,jn,kn,Ps,la;const Ke=xt,dt=(oa=(Sn=Ke.detail)==null?void 0:Sn.word)==null?void 0:oa.trim(),ft=(jn=Ke.detail)==null?void 0:jn.data;if(!dt||!(ft!=null&&ft.exists))return;const zt=dt.toLowerCase(),Tt=(la=(Ps=(kn=he.current)==null?void 0:kn.cambridge)==null?void 0:Ps.word)==null?void 0:la.trim().toLowerCase();if(ie.current&&Tt===zt){J.current&&(window.clearTimeout(J.current),J.current=null);const ca=Date.now();Ie.current={word:zt,at:ca};return}const Bt=Date.now(),on=Ie.current;on.word===zt&&Bt-on.at<500||(W.current=zt,R(!1),ge(null),_({actionLabel:"Go to Cambridge",actionUrl:ft.url,cambridge:{word:ft.word||zt,pronunciations:EE(ft.pronunciations)},icon:u.jsx(Wp,{size:18,className:"text-blue-500"})}),Ie.current={word:zt,at:Bt},I(!0))},Be=xt=>{var Bt,on,Sn,oa,jn,kn;const Ke=xt,dt=(on=(Bt=Ke.detail)==null?void 0:Bt.word)==null?void 0:on.trim(),ft=(Sn=Ke.detail)==null?void 0:Sn.ipa;if(!dt||!ft)return;const zt=dt.toLowerCase(),Tt=(kn=(jn=(oa=he.current)==null?void 0:oa.cambridge)==null?void 0:jn.word)==null?void 0:kn.trim().toLowerCase();ie.current&&Tt===zt||(W.current=zt,R(!1),ge(null),_({text:`**IPA:** ${ft}`,icon:u.jsx(Qp,{size:18,className:"text-purple-500"})}),Ie.current={word:zt,at:Date.now()},I(!0))};return window.addEventListener("config-updated",ve),window.addEventListener("audio-status-changed",Oe),window.addEventListener("coach-cambridge-lookup-request",Ae),window.addEventListener("coach-ipa-fallback-request",Be),m(Pc()),y(Vc()),v(zc()),M(af()),()=>{pe.current&&(window.clearTimeout(pe.current),pe.current=null),de.current&&(window.clearTimeout(de.current),de.current=null),window.removeEventListener("config-updated",ve),window.removeEventListener("audio-status-changed",Oe),window.removeEventListener("coach-cambridge-lookup-request",Ae),window.removeEventListener("coach-ipa-fallback-request",Be),le.current&&(le.current.pause(),le.current=null)}},[]),D.useEffect(()=>{const ve=Ae=>{if(!o.interface.rightClickCommandEnabled)return;const Be=window.getSelection(),xt=Be==null?void 0:Be.toString().trim();if(xt){Ae.preventDefault();const dt=Be.getRangeAt(0).getBoundingClientRect(),ft=dt.top>250?"top":"bottom";ge({x:dt.left+dt.width/2,y:ft==="top"?dt.top:dt.bottom,placement:ft}),W.current=xt,_(null),I(!0),we(xt)}else ge(null)},Oe=Ae=>{var dt;const Be=Ae.target,xt=!z.current||!z.current.contains(Be),Ke=!$.current||!$.current.contains(Be);(dt=he.current)!=null&&dt.cambridge||xt&&Ke&&K&&(I(!1),ge(null))};return document.addEventListener("contextmenu",ve),document.addEventListener("mousedown",Oe),()=>{J.current&&(window.clearTimeout(J.current),J.current=null),document.removeEventListener("contextmenu",ve),document.removeEventListener("mousedown",Oe)}},[o.interface.rightClickCommandEnabled,K,o.server,n.id]);const rt=async()=>{var Ae,Be;const ve=(Ae=window.getSelection())==null?void 0:Ae.toString().trim();if(!ve)return;if(vu(ve)==="vi"){_({text:ve,icon:u.jsx(fv,{size:18,className:"text-blue-500"})}),I(!0),os(ve,!1,"vi",je.viVoice,je.viAccent);return}R(!0),I(!1),ge(null);try{const Ke=await(await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(ve)}&langpair=en|vi`)).json();if((Be=Ke==null?void 0:Ke.responseData)!=null&&Be.translatedText){const dt=Ke.responseData.translatedText;_({text:dt,icon:u.jsx(fv,{size:18,className:"text-blue-500"})}),I(!0),os(dt,!1,"vi",je.viVoice,je.viAccent)}}catch{r("Translation error!","error")}finally{R(!1)}},Qe=async()=>{var Oe;const ve=(Oe=window.getSelection())==null?void 0:Oe.toString().trim();if(ve){ve.length>o5?r("Text is too long to read!","error"):os(ve,!1,"en",je.enVoice,je.enAccent),R(!0),I(!1),ge(null);try{const Ae=ve.toLowerCase();if(Ae.split(/\s+/).filter(Boolean).length===1){const ft=Cn(o),zt=await fetch(`${ft}/api/lookup/cambridge/simple?word=${encodeURIComponent(Ae)}`,{cache:"no-store"});if(zt.ok){const Tt=await zt.text(),Bt=Tt?JSON.parse(Tt):null;if(Bt!=null&&Bt.exists){_({actionLabel:"Go to Cambridge",actionUrl:Bt.url,cambridge:{word:Bt.word||Ae,pronunciations:EE(Bt.pronunciations)},icon:u.jsx(Wp,{size:18,className:"text-blue-500"})}),I(!0),R(!1);return}}}const xt=ii().find(ft=>ft.word.toLowerCase()===Ae);if(xt&&xt.ipaUs){_({text:`**IPA:** ${xt.ipaUs}`,icon:u.jsx(Qp,{size:18,className:"text-emerald-500"})}),I(!0),R(!1);return}const Ke=Cn(o),dt=await fetch(`${Ke}/api/convert/ipa?text=${encodeURIComponent(ve)}&mode=2`);if(dt.ok){const ft=await dt.json();_({text:`**IPA:** ${ft.ipa}`,icon:u.jsx(Qp,{size:18,className:"text-purple-500"})}),I(!0)}}catch{}finally{R(!1)}}},oe=async()=>{var Oe;const ve=(Oe=window.getSelection())==null?void 0:Oe.toString().trim();if(!(!ve||F)){X(!0);try{let Ae,Be=null;try{const xt=await EN([ve]);xt.length>0&&(Be=xt[0])}catch{}Be?(Ae={...Be,id:crypto.randomUUID?crypto.randomUUID():"id-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),userId:n.id,createdAt:Date.now(),updatedAt:Date.now(),quality:Vt.REFINED,source:"refine",nextReview:Date.now(),interval:0,easeFactor:2.5,consecutiveCorrect:0,forgotCount:0,lastReview:void 0,lastGrade:void 0,lastTestResults:{},groups:[...Be.groups||[],"coach-added"]},Ae.isPassive=!1,Ae.complexity=Ra(Ae),Ae.masteryScore=_s(Ae),Ae.gameEligibility=Ca(Ae)):(Ae={...Yw(ve,"","","","",["coach-added"],!1,!1,!1,!1,ve.includes(" ")),userId:n.id,quality:Vt.RAW},Ae.isPassive=!1),await Of(Ae),r(`"${ve}" added!`,"success"),ue(!0),I(!1),ge(null)}catch{r("Add error!","error")}finally{X(!1)}}},ze=async()=>{var Ae;const ve=W.current||((Ae=window.getSelection())==null?void 0:Ae.toString().trim());if(!ve||!n.id||!e||s)return;const Oe=await Ym(n.id,ve);Oe&&(I(!1),ge(null),e(Oe))},et=()=>{var Oe;const ve=(Oe=window.getSelection())==null?void 0:Oe.toString().trim();I(!1),ge(null),ve&&ve.length>l5?(r("Selection too long for mimic!","error"),O(null)):O(ve||"")},vt=()=>{I(!1),ge(null),T(!0)},Ye=()=>{var Be;const ve=W.current||((Be=window.getSelection())==null?void 0:Be.toString().trim());if(!ve)return;const Oe=`Example in English sentence for "${ve}"`,Ae=encodeURIComponent(Oe);window.open(`https://www.google.com/search?q=${Ae}`,"_blank"),I(!1),ge(null)},We=ve=>{if(!ve){r("Audio not available.","info");return}try{const Oe=ve.startsWith("http")?ve:`${Cn(o)}${ve.startsWith("/")?"":"/"}${ve}`;le.current&&(le.current.pause(),le.current=null);const Ae=new Audio(Oe);le.current=Ae,Ae.onerror=()=>r("Failed to play Cambridge audio.","error"),Ae.onended=()=>{le.current===Ae&&(le.current=null)},Ae.play().catch(()=>r("Failed to play Cambridge audio.","error"))}catch{r("Failed to play Cambridge audio.","error")}},it=()=>{_e.current=!0,J.current&&(window.clearTimeout(J.current),J.current=null),I(!0)},St=()=>{var ve;_e.current=!1,J.current&&window.clearTimeout(J.current),J.current=window.setTimeout(()=>{I(!1),J.current=null},(ve=he.current)!=null&&ve.cambridge?3e3:300)};D.useEffect(()=>{if(!(!K||!(A!=null&&A.cambridge))&&!_e.current)return J.current&&window.clearTimeout(J.current),J.current=window.setTimeout(()=>{_e.current||(I(!1),J.current=null)},3e3),()=>{J.current&&(window.clearTimeout(J.current),J.current=null)}},[K,A]);const Ut=()=>u.jsx("div",{ref:z,className:"bg-white/95 backdrop-blur-xl p-1.5 rounded-[1.8rem] shadow-2xl border border-neutral-200 flex flex-col gap-1 w-[160px] animate-in fade-in zoom-in-95 duration-200",children:u.jsxs("div",{className:"grid grid-cols-6 gap-1",children:[u.jsx("button",{type:"button",onClick:rt,className:"col-span-2 aspect-square bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center hover:bg-indigo-100 transition-all active:scale-90 shadow-sm font-black text-xs",title:"Ting Vit",children:"VI"}),F?u.jsx("button",{type:"button",onClick:ze,disabled:s,className:"col-span-2 aspect-square bg-sky-50 text-sky-600 rounded-2xl flex items-center justify-center hover:bg-sky-100 transition-all active:scale-90 shadow-sm",title:"View Word Details",children:u.jsx(tu,{size:15})}):u.jsx("button",{type:"button",onClick:oe,disabled:ae,className:"col-span-2 aspect-square bg-green-50 text-green-600 rounded-2xl flex items-center justify-center hover:bg-green-100 transition-all active:scale-90 shadow-sm",title:"Add to Library",children:ae?u.jsx(Kt,{size:14,className:"animate-spin"}):u.jsx(Ya,{size:15})}),u.jsx("button",{type:"button",onClick:Qe,className:"col-span-2 aspect-square bg-purple-50 text-purple-600 rounded-2xl flex items-center justify-center hover:bg-purple-100 transition-all active:scale-90 shadow-sm",title:"Read & Phonetics (EN)",children:u.jsx(va,{size:15})}),u.jsx("button",{type:"button",onClick:et,className:"col-span-2 aspect-square bg-amber-50 text-amber-500 rounded-2xl flex items-center justify-center hover:bg-amber-100 transition-all active:scale-95 shadow-sm",title:"Mimic Practice",children:u.jsx(mo,{size:15})}),u.jsx("button",{type:"button",onClick:vt,className:"col-span-2 aspect-square bg-rose-50 text-rose-500 rounded-2xl flex items-center justify-center hover:bg-rose-100 transition-all active:scale-95 shadow-sm",title:"Coach Tools",children:u.jsx(RI,{size:15})}),u.jsx("button",{type:"button",onClick:Ye,className:"col-span-2 aspect-square bg-blue-50 text-blue-600 rounded-2xl flex items-center justify-center hover:bg-blue-100 transition-all active:scale-95 shadow-sm",title:"Search Google Examples",children:u.jsx(Wp,{size:15})})]})}),es=ve=>{const Oe=new RegExp("\\*\\*(.*?)\\*\\*","g");return ve.replace(Oe,"<strong>$1</strong>")};D.useEffect(()=>{let ve;return d?(H(vT()),ve=setInterval(()=>{const Oe=AT();Oe&&V(Oe)},100)):(V({currentTime:0,duration:0}),H([]),y(!1),v(!1)),()=>clearInterval(ve)},[d]);const Us=ve=>{const Oe=parseFloat(ve.target.value);fl(Oe),V(Ae=>({...Ae,currentTime:Oe}))},ts=ve=>{const Oe=Math.floor(ve/60),Ae=Math.floor(ve%60);return`${Oe}:${Ae.toString().padStart(2,"0")}`},Es=()=>{const ve=[.6,.7,.8,.9,1,1.25,1.5],Oe=ve.findIndex(Be=>Math.abs(Be-P)<.001),Ae=ve[(Oe+1)%ve.length];_T(Ae),M(Ae)};return u.jsxs(u.Fragment,{children:[K&&xe&&u.jsx("div",{className:"fixed z-[2147483647]",style:{left:`${xe.x}px`,top:`${xe.y}px`,transform:xe.placement==="top"?"translate(-50%, -100%) translateY(-10px)":"translate(-50%, 0) translateY(10px)"},children:u.jsx(Ut,{})}),u.jsx("div",{className:"fixed bottom-0 left-6 z-[2147483646] flex flex-col items-start pointer-events-none",children:u.jsx("div",{className:"flex flex-col items-center pointer-events-auto group pb-0 pt-10",onMouseEnter:it,onMouseLeave:St,children:u.jsxs("div",{className:"relative",children:[K&&!xe&&u.jsx("div",{className:"absolute bottom-16 left-0 z-50 animate-in fade-in slide-in-from-bottom-2 duration-200",children:A?u.jsxs("div",{ref:$,className:"bg-white p-5 rounded-[2.5rem] shadow-2xl border border-neutral-200 w-[26rem] relative",children:[u.jsx("button",{onClick:()=>{_(null),I(!1),ge(null)},className:"absolute top-4 right-4 text-neutral-300 hover:text-neutral-900",children:u.jsx(hn,{size:14})}),u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"shrink-0 mt-1",children:A.icon||u.jsx(Rg,{size:18})}),u.jsxs("div",{className:"text-xs font-medium text-neutral-700 leading-relaxed space-y-2",children:[A.cambridge?u.jsx("div",{className:"space-y-4",children:Array.isArray(A.cambridge.wordFamily)&&A.cambridge.wordFamily.length>0?A.cambridge.wordFamily.map((ve,Oe)=>u.jsx("div",{className:"space-y-2",children:u.jsx("div",{className:"grid grid-cols-2 gap-2",children:(ve.pronunciations||[]).map((Ae,Be)=>u.jsxs("div",{className:"rounded-lg border border-neutral-200 bg-neutral-50 p-2 space-y-1.5",children:[Ae.headword&&u.jsx("p",{className:"text-[11px] font-extrabold text-indigo-700 break-words",children:Ae.headword}),u.jsx("p",{className:"text-[10px] font-black uppercase tracking-wide text-neutral-500",children:Ae.partOfSpeech||"N/A"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>We(Ae.audioUs||void 0),disabled:!Ae.audioUs,className:`px-2 py-0.5 text-[9px] font-black uppercase rounded-md border transition-colors ${Ae.audioUs?"bg-indigo-50 text-indigo-700 border-indigo-100 hover:bg-indigo-100":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed"}`,children:"US"}),u.jsx("p",{className:"text-[11px] text-neutral-700 leading-relaxed flex-1 break-words",children:Ae.ipaUs?`/${Ae.ipaUs}/`:"N/A"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>We(Ae.audioUk||void 0),disabled:!Ae.audioUk,className:`px-2 py-0.5 text-[9px] font-black uppercase rounded-md border transition-colors ${Ae.audioUk?"bg-emerald-50 text-emerald-700 border-emerald-100 hover:bg-emerald-100":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed"}`,children:"UK"}),u.jsx("p",{className:"text-[11px] text-neutral-700 leading-relaxed flex-1 break-words",children:Ae.ipaUk?`/${Ae.ipaUk}/`:"N/A"})]})]},Be))})},Oe)):u.jsx("div",{className:"space-y-2",children:u.jsx("div",{className:"grid grid-cols-2 gap-2",children:(A.cambridge.pronunciations||[]).map((ve,Oe)=>u.jsxs("div",{className:"rounded-lg border border-neutral-200 bg-neutral-50 p-2 space-y-1.5",children:[ve.headword&&u.jsx("p",{className:"text-[11px] font-extrabold text-indigo-700 break-words",children:ve.headword}),u.jsx("p",{className:"text-[10px] font-black uppercase tracking-wide text-neutral-500",children:ve.partOfSpeech||"N/A"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>We(ve.audioUs||void 0),disabled:!ve.audioUs,className:`px-2 py-0.5 text-[9px] font-black uppercase rounded-md border transition-colors ${ve.audioUs?"bg-indigo-50 text-indigo-700 border-indigo-100 hover:bg-indigo-100":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed"}`,children:"US"}),u.jsx("p",{className:"text-[11px] text-neutral-700 leading-relaxed flex-1 break-words",children:ve.ipaUs?`/${ve.ipaUs}/`:"N/A"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{type:"button",onClick:()=>We(ve.audioUk||void 0),disabled:!ve.audioUk,className:`px-2 py-0.5 text-[9px] font-black uppercase rounded-md border transition-colors ${ve.audioUk?"bg-emerald-50 text-emerald-700 border-emerald-100 hover:bg-emerald-100":"bg-neutral-50 text-neutral-300 border-neutral-100 cursor-not-allowed"}`,children:"UK"}),u.jsx("p",{className:"text-[11px] text-neutral-700 leading-relaxed flex-1 break-words",children:ve.ipaUk?`/${ve.ipaUk}/`:"N/A"})]})]},Oe))})})}):u.jsx("div",{dangerouslySetInnerHTML:{__html:es(A.text||"")}}),A.actionUrl&&u.jsx("button",{type:"button",onClick:()=>window.open(A.actionUrl,"_blank"),className:"px-3 py-1.5 text-[10px] font-black uppercase tracking-wide rounded-lg bg-blue-50 text-blue-700 border border-blue-100 hover:bg-blue-100 transition-colors",children:A.actionLabel||"Open"})]})]})]}):u.jsx(Ut,{})}),u.jsx("button",{onClick:ve=>{S&&(ve.stopPropagation(),bT())},className:`w-14 h-14 rounded-2xl flex items-center justify-center transition-all duration-300 transform shadow-2xl relative z-10 ${wt.bg} ${K?"ring-4 ring-white":"hover:scale-110 mb-1"}`,children:C?u.jsx(Kt,{size:20,className:"animate-spin text-neutral-400"}):u.jsxs(u.Fragment,{children:[u.jsx("img",{src:wt.url,className:`w-10 h-10 object-contain ${S?"opacity-30 scale-90 blur-[1px]":""}`,alt:"Coach"}),S&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-indigo-600 animate-in fade-in zoom-in duration-200",children:u.jsx(Af,{size:24,fill:"currentColor"})})]})}),S&&u.jsxs("div",{className:"absolute left-16 bottom-2 flex items-center gap-3 bg-white/90 backdrop-blur-md px-4 py-2 rounded-2xl shadow-xl border border-neutral-200 animate-in fade-in slide-in-from-left-4 duration-300 pointer-events-auto min-w-[24rem]",onMouseEnter:it,onMouseLeave:St,children:[u.jsx("span",{className:"text-[10px] font-mono text-neutral-500 tabular-nums w-8",children:j.duration>0?ts(j.currentTime):"--:--"}),u.jsx("input",{type:"range",min:"0",max:j.duration>0?j.duration:1,step:"0.1",value:j.duration>0?j.currentTime:0,onChange:Us,disabled:j.duration<=0,className:"flex-1 h-1.5 bg-neutral-100 rounded-full appearance-none cursor-pointer accent-indigo-600 hover:accent-indigo-700 transition-all"}),u.jsx("span",{className:"text-[10px] font-mono text-neutral-400 tabular-nums w-8",children:j.duration>0?ts(j.duration):"--:--"}),u.jsxs("div",{className:"flex items-center gap-2 w-full",children:[u.jsx("button",{onClick:()=>{const ve=Math.max(0,j.currentTime-5);fl(ve),V(Oe=>({...Oe,currentTime:ve}))},className:"w-6 h-6 rounded-lg bg-neutral-50 text-neutral-700 hover:bg-neutral-100 transition-colors flex items-center justify-center border border-neutral-200",title:"Rewind 5 seconds",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M7 8L13 12V4L7 8ZM3 8L9 12V4L3 8Z",fill:"currentColor"})})}),u.jsx("button",{onClick:()=>{const ve=Math.min(j.duration,j.currentTime+5);fl(ve),V(Oe=>({...Oe,currentTime:ve}))},className:"w-6 h-6 rounded-lg bg-neutral-50 text-neutral-700 hover:bg-neutral-100 transition-colors flex items-center justify-center border border-neutral-200",title:"Forward 5 seconds",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M9 8L3 4V12L9 8ZM13 8L7 4V12L13 8Z",fill:"currentColor"})})}),u.jsx("button",{onClick:()=>{p?wT().catch(()=>r("Cannot resume audio.","error")):ET()},className:"w-6 h-6 rounded-lg bg-indigo-50 text-indigo-600 hover:bg-indigo-100 transition-colors flex items-center justify-center border border-indigo-100",title:p?"Resume audio":"Pause audio",children:p?u.jsx(cu,{size:12,fill:"currentColor"}):u.jsx(Og,{size:12,fill:"currentColor"})}),u.jsxs("button",{onClick:Es,className:"h-6 px-2 rounded-lg bg-neutral-50 text-neutral-700 hover:bg-neutral-100 transition-colors flex items-center justify-center border border-neutral-200 text-[10px] font-black tabular-nums",title:"Playback speed",children:[P.toFixed(P%1===0?1:2),"x"]}),B.length>0&&j.duration>0&&u.jsx("div",{className:"flex items-center gap-1 ml-1 border-l border-neutral-200 pl-2",children:B.map((ve,Oe)=>u.jsx("button",{onClick:()=>{fl(ve),V(Ae=>({...Ae,currentTime:ve}))},className:"w-5 h-5 flex items-center justify-center rounded-full bg-indigo-50 text-indigo-600 text-[10px] font-bold hover:bg-indigo-600 hover:text-white transition-colors border border-indigo-100",title:`Jump to ${ts(ve)}`,children:Oe+1},Oe))}),u.jsxs("div",{className:"flex items-center gap-1 border-l border-neutral-200 pl-1 pr-0 ml-0",children:[u.jsx("button",{onClick:()=>Y(j.currentTime),className:"w-6 h-6 rounded-lg bg-yellow-50 text-yellow-700 hover:bg-yellow-100 transition-colors flex items-center justify-center border border-yellow-200",title:"Mark current time",children:u.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("circle",{cx:"8",cy:"8",r:"6",stroke:"currentColor",strokeWidth:"2"}),u.jsx("circle",{cx:"8",cy:"8",r:"2",fill:"currentColor"})]})}),u.jsx("button",{onClick:()=>{fl(G),V(ve=>({...ve,currentTime:G}))},className:"w-10 h-6 rounded-lg bg-indigo-50 text-indigo-700 hover:bg-indigo-100 transition-colors flex items-center justify-center border border-indigo-200 text-[11px] font-bold",title:`Play at marked time (${G.toFixed(1)}s)`,children:G.toFixed(1)})]})]})]})]})})}),L!==null&&u.jsx(IT,{target:L,onClose:()=>O(null)}),u.jsx(i5,{isOpen:Q,onClose:()=>T(!1)})]})},u5=({isOpen:n,onClose:e,backups:s,onRestore:r,onNewUser:o,onLocalRestore:l,isRestoring:d,title:m="Server Backups",description:p="Select a user profile to restore."})=>{if(!n)return null;const y=x=>x<1024*1024?`${(x/1024).toFixed(1)} KB`:`${(x/(1024*1024)).toFixed(1)} MB`;return u.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:u.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col max-h-[85vh]",children:[u.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-center shrink-0",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-xl font-black text-neutral-900 flex items-center gap-2",children:[u.jsx(RE,{size:20})," ",m]}),u.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:p})]}),u.jsx("button",{onClick:e,disabled:d,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:u.jsx(hn,{size:20})})]}),u.jsx("main",{className:"flex-1 overflow-y-auto p-6 space-y-3 custom-scrollbar",children:s.length===0?u.jsx("div",{className:"text-center py-10 text-neutral-400 font-medium italic",children:"No backups found on server."}):s.map(x=>u.jsxs("div",{className:"flex items-center justify-between p-4 rounded-2xl bg-neutral-50 border border-neutral-100 hover:border-neutral-300 transition-all group",children:[u.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[u.jsx("div",{className:"p-2.5 bg-white rounded-xl text-neutral-500 shadow-sm",children:u.jsx(II,{size:18})}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("h4",{className:"font-bold text-sm text-neutral-900 truncate",children:x.name}),u.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-neutral-500 font-medium",children:[u.jsx("span",{className:"font-black text-indigo-600",children:new Date(x.date).toLocaleString()}),u.jsx("span",{className:"w-1 h-1 rounded-full bg-neutral-300"}),u.jsx("span",{children:y(x.size)})]})]})]}),u.jsx("button",{onClick:()=>r(x.id),disabled:d,className:"px-4 py-2 bg-white border border-neutral-200 text-indigo-600 rounded-xl font-black text-[10px] uppercase tracking-wider hover:bg-indigo-50 hover:border-indigo-200 transition-all shadow-sm active:scale-95 disabled:opacity-50",children:d?u.jsx(Kt,{size:14,className:"animate-spin"}):"Restore"})]},x.id))}),u.jsxs("footer",{className:"px-6 py-4 border-t border-neutral-100 bg-neutral-50/30 shrink-0 flex flex-col gap-3 rounded-b-[2.5rem]",children:[u.jsxs("button",{onClick:o,disabled:d,className:"w-full py-3 bg-neutral-900 text-white rounded-xl font-bold text-xs flex items-center justify-center gap-2 shadow-lg hover:bg-neutral-800 transition-all active:scale-95",children:[u.jsx(Ya,{size:16}),u.jsx("span",{children:"I am a New User (Create Profile)"})]}),u.jsx("div",{className:"flex justify-center",children:u.jsxs("button",{onClick:l,disabled:d,className:"flex items-center gap-1.5 text-[10px] font-bold text-neutral-400 hover:text-neutral-600 transition-colors py-1 px-2 rounded-lg hover:bg-neutral-100",children:[u.jsx(rI,{size:12}),u.jsx("span",{children:"Or restore from local file"})]})})]})]})})},d5=({isOpen:n,onClose:e,onRetry:s,onStop:r,status:o,serverUrl:l,scanningUrl:d})=>{const m=Dt(),[p,y]=D.useState(o),[x,v]=D.useState(l||Cn(m));if(D.useEffect(()=>{n&&v(l||Cn(m))},[n,l]),D.useEffect(()=>{y(o)},[o]),!n)return null;const S=()=>{window.open(x,"_blank")},N=async()=>{y("scanning"),await s(x)},P=async()=>{y("scanning"),await s(void 0)},M=()=>{r(),y("failed")};return u.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-neutral-900/80 backdrop-blur-sm animate-in fade-in duration-300",children:[u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl border border-neutral-200 overflow-hidden flex flex-col animate-in zoom-in-95 duration-300",children:[u.jsxs("div",{className:`p-8 text-center space-y-4 ${p==="failed"?"bg-red-50":"bg-indigo-50"}`,children:[u.jsxs("div",{className:"mx-auto w-20 h-20 bg-white rounded-full flex items-center justify-center shadow-sm relative",children:[p==="scanning"&&u.jsxs(u.Fragment,{children:[u.jsx(Kt,{size:40,className:"text-indigo-500 animate-spin"}),u.jsx("div",{className:"absolute inset-0 rounded-full border-4 border-indigo-100 border-t-indigo-500 animate-spin"})]}),p==="failed"&&u.jsx(If,{size:40,className:"text-red-500"}),p==="success"&&u.jsx(CI,{size:40,className:"text-green-500"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("h3",{className:"text-2xl font-black text-neutral-900 tracking-tight",children:p==="scanning"?"Connecting...":p==="failed"?"Connection Failed":"Connected!"}),u.jsx("p",{className:"text-sm font-medium text-neutral-500",children:p==="scanning"?d?"Scanning network...":"Contacting Vocab Pro Server...":p==="failed"?"Could not talk to the server.":"Server found. Syncing..."})]})]}),u.jsxs("div",{className:"p-6 space-y-6",children:[p==="scanning"&&u.jsxs("div",{className:"flex flex-col gap-4",children:[u.jsx("div",{className:"h-2 w-full bg-neutral-100 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-indigo-500 animate-progress-indeterminate"})}),u.jsxs("div",{className:"bg-neutral-50 p-4 rounded-2xl border border-neutral-100 text-center animate-pulse",children:[u.jsx("p",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest mb-1",children:"Checking Endpoint"}),u.jsx("p",{className:"text-sm font-bold text-neutral-600 truncate",children:d||"..."})]}),u.jsxs("button",{onClick:M,className:"mx-auto px-6 py-2 bg-white border border-red-200 text-red-600 rounded-xl font-bold text-xs flex items-center gap-2 hover:bg-red-50 transition-colors shadow-sm",children:[u.jsx(Af,{size:12,fill:"currentColor"})," Stop"]})]}),p==="failed"&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Server Address"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",value:x,onChange:j=>v(j.target.value),className:"flex-1 px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-bold text-neutral-800 focus:outline-none focus:ring-2 focus:ring-neutral-900",placeholder:"http://localhost:3000"}),u.jsx("button",{onClick:N,className:"px-4 py-3 bg-neutral-900 text-white rounded-xl font-bold text-sm flex items-center gap-2 hover:bg-neutral-800 shadow-lg active:scale-95",children:u.jsx(zE,{size:16})})]})]}),u.jsx("div",{className:"grid grid-cols-2 gap-3 pt-2",children:u.jsxs("button",{onClick:P,className:"col-span-2 py-3 bg-white border border-neutral-200 text-neutral-600 rounded-xl font-bold text-xs flex items-center justify-center gap-2 hover:bg-neutral-50 hover:text-neutral-900 transition-colors",children:[u.jsx(yI,{size:14}),u.jsx("span",{children:"Auto-Scan Network"})]})}),u.jsxs("div",{className:"p-4 bg-amber-50 border border-amber-100 rounded-2xl flex flex-col gap-3",children:[u.jsxs("div",{className:"flex gap-3",children:[u.jsx(vI,{size:20,className:"text-amber-600 shrink-0 mt-0.5"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("h4",{className:"text-xs font-black text-amber-800 uppercase tracking-wide",children:"HTTPS Security"}),u.jsx("p",{className:"text-[10px] text-amber-700 leading-relaxed font-medium",children:"If the URL is correct but connection fails, your browser blocked it."})]})]}),u.jsxs("button",{onClick:S,className:"w-full py-2 bg-amber-100 text-amber-800 rounded-lg font-bold text-xs flex items-center justify-center gap-2 hover:bg-amber-200 transition-colors",children:[u.jsx(jE,{size:12}),u.jsx("span",{children:"Open & Trust Certificate"})]})]})]}),p==="success"&&u.jsx("div",{className:"text-center py-4",children:u.jsx("p",{className:"text-green-600 font-bold text-lg animate-bounce",children:"Ready to go!"})})]}),p==="failed"&&u.jsx("div",{className:"p-4 border-t border-neutral-100 bg-neutral-50 flex justify-center",children:u.jsxs("button",{onClick:e,className:"text-xs font-bold text-neutral-400 hover:text-neutral-600 flex items-center gap-1 transition-colors",children:[u.jsx(hn,{size:14})," Continue Offline"]})})]}),u.jsx("style",{children:`
                @keyframes progress-indeterminate {
                    0% { width: 30%; transform: translateX(-100%); }
                    50% { width: 30%; transform: translateX(150%); }
                    100% { width: 30%; transform: translateX(350%); }
                }
                .animate-progress-indeterminate {
                    animation: progress-indeterminate 1.5s infinite linear;
                }
            `})]})},f5=({isOpen:n,onClose:e,onPush:s,onRestore:r,type:o,localDate:l,serverDate:d,isProcessing:m})=>{if(!n)return null;const p=o==="restore";return u.jsx("div",{className:"fixed inset-0 z-[10000] flex items-center justify-center p-4 bg-neutral-900/80 backdrop-blur-sm animate-in fade-in duration-300",children:u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl border border-neutral-200 overflow-hidden flex flex-col animate-in zoom-in-95 duration-300",children:[u.jsxs("div",{className:`p-8 text-center space-y-4 ${p?"bg-indigo-50":"bg-emerald-50"}`,children:[u.jsxs("div",{className:"mx-auto w-20 h-20 bg-white rounded-full flex items-center justify-center shadow-sm relative",children:[p?u.jsx(uv,{size:40,className:"text-indigo-500"}):u.jsx(dv,{size:40,className:"text-emerald-500"}),u.jsx("div",{className:"absolute -top-1 -right-1 bg-amber-500 rounded-full p-1 border-2 border-white",children:u.jsx(If,{size:12,className:"text-white"})})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("h3",{className:"text-2xl font-black text-neutral-900 tracking-tight",children:p?"Update Available":"Unsaved Progress"}),u.jsx("p",{className:"text-sm font-medium text-neutral-500",children:p?"The server has a newer version of your data.":"Your local data is newer than the cloud backup."})]})]}),u.jsxs("div",{className:"p-8 space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{className:"space-y-1 p-3 bg-neutral-50 rounded-2xl border border-neutral-100",children:[u.jsx("p",{className:"text-[9px] font-black uppercase text-neutral-400 tracking-widest",children:"Local Device"}),u.jsx("p",{className:"text-xs font-bold text-neutral-700",children:l})]}),u.jsxs("div",{className:"space-y-1 p-3 bg-neutral-50 rounded-2xl border border-neutral-100",children:[u.jsx("p",{className:"text-[9px] font-black uppercase text-neutral-400 tracking-widest",children:"Cloud Server"}),u.jsx("p",{className:"text-xs font-bold text-neutral-700",children:d})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("button",{onClick:p?r:s,disabled:m,className:`w-full py-4 rounded-2xl font-black text-sm transition-all shadow-lg active:scale-95 flex items-center justify-center space-x-2 ${p?"bg-indigo-600 text-white hover:bg-indigo-700 shadow-indigo-200":"bg-emerald-600 text-white hover:bg-emerald-700 shadow-emerald-200"}`,children:[m?u.jsx(Kt,{size:18,className:"animate-spin"}):p?u.jsx(uv,{size:18}):u.jsx(dv,{size:18}),u.jsx("span",{children:p?"RESTORE FROM CLOUD":"PUSH TO CLOUD"})]}),u.jsx("button",{onClick:e,disabled:m,className:"w-full py-4 bg-neutral-100 text-neutral-500 rounded-2xl font-bold text-sm hover:bg-neutral-200 transition-all",children:"Ignore for now"})]})]}),u.jsx("div",{className:"bg-neutral-50 px-8 py-4 border-t border-neutral-100",children:u.jsx("p",{className:"text-[9px] font-medium text-neutral-400 text-center leading-relaxed",children:"Automatic synchronization helps keep your library consistent across all your devices."})})]})})},h5=Pn.lazy(()=>ds(()=>import("./Dashboard-RkEvf4BI.js"),__vite__mapDeps([0,1,2,3,4]))),p5=Pn.lazy(()=>ds(()=>import("./ReviewSession-CjXkwPxH.js"),__vite__mapDeps([5,6]))),m5=Pn.lazy(()=>ds(()=>import("./WordList-BM2C18Sv.js"),__vite__mapDeps([7,8,9,10,11,12,13,14,15]))),g5=Pn.lazy(()=>ds(()=>import("./ReadingUnitPage-X2wg1htv.js"),__vite__mapDeps([16,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,1,24])).then(n=>({default:n.ReadingUnitPage}))),y5=Pn.lazy(()=>ds(()=>import("./SettingsView-t5IY5Xwj.js"),__vite__mapDeps([25,26,27,23,9,10,11,12,13,14,15])).then(n=>({default:n.SettingsView}))),x5=Pn.lazy(()=>ds(()=>import("./Discover-lUZ6ypFf.js"),__vite__mapDeps([28,26,27,6,15,4,3,29,12,14,23]))),b5=Pn.lazy(()=>ds(()=>import("./WritingStudioPage-DdGn-_j3.js"),__vite__mapDeps([30,18,15,11,14,31,10,19,20,21])).then(n=>({default:n.WritingStudioPage}))),v5=Pn.lazy(()=>ds(()=>import("./IrregularVerbs-CmQdv4xe.js"),__vite__mapDeps([32,2,15,14,33,31]))),_5=Pn.lazy(()=>ds(()=>import("./MimicPractice-BE-NtyO-.js"),__vite__mapDeps([34,35,15])).then(n=>({default:n.MimicPractice}))),E5=Pn.lazy(()=>ds(()=>import("./LessonLibraryV2-DEMtPddE.js"),__vite__mapDeps([36,18,15,11,10,21,3,37,19,20,29])).then(n=>({default:n.LessonLibraryV2}))),w5=Pn.lazy(()=>ds(()=>import("./PlanningPage-Y4iD8sC0.js"),__vite__mapDeps([38,18,15,11,21,22,23,1,24,39])).then(n=>({default:n.PlanningPage}))),S5=Pn.lazy(()=>ds(()=>import("./SpeakingCardPage-CxgGfuuq.js"),__vite__mapDeps([40,18,15,11,10,19,20,21,22,23,1,24,39,37,29,35,13])).then(n=>({default:n.SpeakingCardPage}))),T5=Pn.lazy(()=>ds(()=>import("./WordBookPage-DDVavrzH.js"),__vite__mapDeps([41,21,15,20,27,33])).then(n=>({default:n.WordBookPage}))),A5=Pn.lazy(()=>ds(()=>import("./CourseList-BhstyBl0.js"),__vite__mapDeps([42,15,17,24])).then(n=>({default:n.CourseList}))),I5=[{id:"DASHBOARD",view:"DASHBOARD",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Mobile%20Phone.png",label:"Dashboard"},{id:"BROWSE",view:"BROWSE",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Books.png",label:"Word Library"},{id:"LESSON",view:"LESSON",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Notebook.png",label:"Knowledge Library"},{id:"COURSE",view:"COURSE",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Graduation%20Cap.png",label:"Course"},{id:"UNIT_LIBRARY",view:"UNIT_LIBRARY",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Open%20Book.png",label:"Reading"},{id:"SPEAKING",view:"SPEAKING",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Microphone.png",label:"Speaking - Listening"},{id:"WRITING",view:"WRITING",icon:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Memo.png",label:"Writing"}],N5=({controller:n,onNavigate:e,onSwitchUser:s})=>{const{currentUser:r,view:o,setView:l,sessionType:d,isSidebarOpen:m,setIsSidebarOpen:p,forceExpandAdd:y,serverStatus:x,handleBackup:v,hasUnsavedChanges:S,nextAutoBackupTime:N,triggerServerBackup:P}=n,[M,j]=D.useState(0);D.useEffect(()=>{if(!N){j(0);return}const B=setInterval(()=>{const G=Date.now(),Y=N-G,K=Math.ceil(Y/1e3);j(Math.max(0,K)),K<=0&&clearInterval(B)},1e3),H=N-Date.now();return j(Math.max(0,Math.ceil(H/1e3))),()=>clearInterval(B)},[N,x,P,S]);const V=N?`Auto-sync in ${M}s...`:S?"Unsaved Changes - Sync Now":"Sync to Server";return r?u.jsx(u.Fragment,{children:u.jsxs("aside",{className:`fixed md:relative inset-y-0 left-0 z-50 w-64 bg-white border-r border-neutral-200 transform ${m?"translate-x-0":"-translate-x-full"} md:translate-x-0 transition-transform duration-300 ease-in-out flex flex-col p-6`,children:[u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex items-center justify-between gap-2",children:[u.jsxs("div",{className:"flex items-center space-x-3 overflow-hidden flex-1",children:[u.jsx("img",{src:r.avatar,className:"w-10 h-10 rounded-2xl bg-neutral-100 shrink-0"}),u.jsxs("div",{className:"flex-1 overflow-hidden",children:[u.jsx("div",{className:"text-sm font-bold text-neutral-900 truncate",children:r.name}),u.jsx("div",{className:"text-[10px] text-neutral-400 font-bold truncate",children:r.role})]})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("button",{onClick:s,className:"p-2 rounded-full border-2 border-indigo-100 bg-white text-indigo-500 hover:border-indigo-500 hover:text-indigo-600 hover:bg-indigo-50 transition-all shadow-sm",title:"Switch User",children:u.jsx(qE,{size:16})}),u.jsx("button",{onClick:()=>p(!1),className:"md:hidden p-2 text-neutral-400",children:u.jsx(hn,{size:24})})]})]}),u.jsxs("div",{className:"mt-4 flex items-center space-x-2",children:[u.jsx("button",{onClick:()=>e("SETTINGS"),className:"p-2 bg-neutral-50 hover:bg-neutral-100 rounded-xl transition-all active:scale-90 border border-neutral-100",title:"Settings",children:u.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Gear.png",alt:"Settings",className:"w-6 h-6 object-contain"})}),u.jsx("button",{onClick:()=>e("PLANNING"),className:"p-2 bg-neutral-50 hover:bg-neutral-100 rounded-xl transition-all active:scale-90 border border-neutral-100",title:"Study Plan",children:u.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Spiral%20Calendar.png",alt:"Planning",className:"w-6 h-6 object-contain"})}),u.jsx("button",{onClick:()=>e("DISCOVER"),className:"p-2 bg-neutral-50 hover:bg-neutral-100 rounded-xl transition-all active:scale-90 border border-neutral-100",title:"Games & Discover",children:u.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Activities/Video%20Game.png",alt:"Games",className:"w-6 h-6 object-contain"})}),x==="connected"&&u.jsxs("button",{onClick:()=>v(),className:`p-2 rounded-xl transition-all active:scale-90 border animate-in fade-in relative ${S?"bg-orange-50 border-orange-200 shadow-[0_0_10px_rgba(249,115,22,0.4)]":"bg-neutral-50 border-neutral-100 hover:bg-neutral-100"}`,title:V,children:[u.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Symbols/Up%20Arrow.png",alt:"Sync",className:"w-6 h-6 object-contain"}),S&&u.jsx("span",{className:`absolute top-0 right-0 w-2.5 h-2.5 rounded-full border-2 border-white -mt-1 -mr-1 ${N?"bg-green-400":"bg-orange-500 animate-pulse"}`})]})]})]}),u.jsxs("nav",{className:"flex-1 overflow-y-auto space-y-1",children:[d&&o!=="REVIEW"&&u.jsx("div",{className:"relative group animate-in fade-in duration-300 mb-1",children:u.jsxs("button",{onClick:()=>e("REVIEW"),className:"w-full flex items-center justify-between px-4 py-3 rounded-xl font-bold text-sm bg-green-500 text-white shadow-lg shadow-green-500/20",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx($2,{size:20}),u.jsx("span",{children:"Study Now"})]}),u.jsxs("div",{className:"relative flex h-3 w-3",children:[u.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-white opacity-75"}),u.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-white"})]})]})}),I5.map(B=>{const H=o===B.view&&(B.id!=="BROWSE"||!y),G=B.id==="SPEAKING"&&o==="SPEAKING";return u.jsx("div",{className:"relative group",children:u.jsx("button",{onClick:()=>e(B.view),className:`w-full flex items-center justify-between px-4 py-3 rounded-xl font-bold text-sm transition-colors ${H||G?"bg-neutral-900 text-white shadow-sm":"text-neutral-500 hover:bg-neutral-100"}`,children:u.jsxs("div",{className:"flex items-center space-x-3",children:[typeof B.icon=="string"?u.jsx("img",{src:B.icon,className:`w-5 h-5 object-contain transition-all ${H||G?"opacity-100":"opacity-70 group-hover:opacity-100"}`,alt:B.label}):u.jsx(B.icon,{size:20}),u.jsx("span",{children:B.label})]})})},B.id)})]})]})}):null},C5=({controller:n})=>{const{view:e,currentUser:s,stats:r,xpToNextLevel:o,wotd:l,setGlobalViewWord:d,setView:m,lastBackupTime:p,handleBackup:y,restoreFromServerAction:x,triggerLocalRestore:v,triggerLocalBackup:S,triggerServerBackup:N,handleNavigateToList:P,sessionWords:M,sessionType:j,sessionFocus:V,updateWord:B,bulkUpdateWords:H,handleSessionComplete:G,gainExperienceAndLevelUp:Y,recalculateXpAndLevelUp:K,handleRetrySession:I,deleteWord:A,bulkDeleteWords:_,startSession:C,initialListFilter:R,setInitialListFilter:L,forceExpandAdd:O,setForceExpandAdd:xe,handleUpdateUser:ge,refreshGlobalStats:F,handleLibraryReset:ue,apiUsage:ae,xpGained:X,lastMasteryScoreUpdateTimestamp:Q,isWotdComposed:T,randomizeWotd:z,handleComposeWithWord:$,writingContextWord:J,consumeWritingContext:pe,serverStatus:de,serverUrl:_e,planningAction:W,consumePlanningAction:le,targetGameMode:ie,consumeTargetGameMode:he,targetCourseId:Ie,consumeTargetCourseId:Ue}=n;if(!s)return null;switch(e){case"DASHBOARD":return u.jsx(h5,{userId:s.id,user:s,totalCount:r.total,dueCount:r.due,newCount:r.new,xpToNextLevel:o,wotd:l,onViewWord:d,setView:m,lastBackupTime:p,onBackup:y,onRestore:()=>{},restoreFromServerAction:async()=>await x(),triggerLocalRestore:v,onLocalBackup:S,onServerBackup:N,onNavigateToWordList:P,isWotdComposed:T,onComposeWotd:$,onRandomizeWotd:z,serverStatus:de,serverUrl:_e,onAction:je=>{n.handleSpecialAction(je)},onStartDueReview:n.startDueReviewSession,onStartNewLearn:n.startNewLearnSession});case"WORDBOOK":return u.jsx(T5,{user:s});case"PLANNING":return u.jsx(w5,{user:s,initialAction:W,onActionConsumed:le});case"REVIEW":return M&&j?u.jsx(p5,{user:s,sessionWords:M,sessionType:j,sessionFocus:V,onUpdate:B,onBulkUpdate:H,onComplete:G,onRetry:I}):null;case"BROWSE":return u.jsx(m5,{user:s,onDelete:async je=>await A(je),onBulkDelete:async je=>await _(je),onUpdate:B,onStartSession:je=>C(je,"custom"),initialFilter:R,onInitialFilterApplied:()=>L(null),forceExpandAdd:O,onExpandAddConsumed:()=>xe(!1),onNavigate:m});case"LESSON":return u.jsx(E5,{user:s,onStartSession:je=>C(je,"custom"),onExit:()=>m("DASHBOARD"),onNavigate:m,onUpdateUser:ge,initialLessonId:n.targetLessonId,onConsumeLessonId:n.consumeTargetLessonId,initialTag:n.targetLessonTag,onConsumeTag:n.consumeTargetLessonTag,initialType:n.targetLessonType,onConsumeType:n.consumeTargetLessonType});case"COURSE":return u.jsx(A5,{initialCourseId:Ie,onConsumeInitialCourseId:Ue});case"UNIT_LIBRARY":return u.jsx(g5,{user:s,onStartSession:je=>C(je,"new_study"),onUpdateUser:ge});case"SETTINGS":return u.jsx(y5,{user:s,onUpdateUser:ge,onRefresh:F,onNuke:ue,apiUsage:ae});case"DISCOVER":return u.jsx(x5,{user:s,xpToNextLevel:o,totalWords:r.total,onExit:()=>m("DASHBOARD"),onGainXp:Y,onRecalculateXp:K,xpGained:X,onStartSession:C,onUpdateUser:ge,lastMasteryScoreUpdateTimestamp:Q,onBulkUpdate:H,initialGameMode:ie,onConsumeGameMode:he});case"SPEAKING":return u.jsx(S5,{user:s,onNavigate:m});case"WRITING":return u.jsx(b5,{controller:n,user:s,initialContextWord:J,onConsumeContext:pe});case"IRREGULAR_VERBS":return u.jsx(v5,{user:s,onGlobalViewWord:d});case"MIMIC":return u.jsx(_5,{});default:return u.jsxs("div",{children:["Unknown view: ",e]})}},R5=({controller:n})=>{const{view:e,isSidebarOpen:s,setIsSidebarOpen:r,globalViewWord:o,setGlobalViewWord:l,updateWord:d,gainExperienceAndLevelUp:m,sessionType:p,clearSessionState:y,setView:x,setForceExpandAdd:v,currentUser:S,stats:N,lastBackupTime:P,isAutoRestoreOpen:M,setIsAutoRestoreOpen:j,autoRestoreCandidates:V,restoreFromServerAction:B,handleNewUserSetup:H,handleLocalRestoreSetup:G,handleSwitchUser:Y,isConnectionModalOpen:K,setIsConnectionModalOpen:I,connectionScanStatus:A,handleScanAndConnect:_,handleStopScan:C,syncPrompt:R,setSyncPrompt:L,isSyncing:O,handleSyncPush:xe,handleSyncRestore:ge}=n,[F,ue]=D.useState(null),[ae,X]=D.useState({isOpen:!1,targetView:null,andThen:void 0}),[Q,T]=D.useState({isOpen:!1,targetView:null,action:void 0}),z=(le,ie)=>{if(n.hasWritingUnsavedChanges){T({isOpen:!0,targetView:le,action:ie});return}p&&le!=="REVIEW"?X({isOpen:!0,targetView:le,andThen:ie}):(v(!!ie),x(le),r(!1))},$=()=>{ae.targetView?(y(),x(ae.targetView),ae.andThen?ae.andThen():v(!1),r(!1)):ae.andThen&&(y(),ae.andThen()),X({isOpen:!1,targetView:null,andThen:void 0})},J=()=>X({isOpen:!1,targetView:null,andThen:void 0}),pe=le=>{l(null),ue(le)},de=le=>{d(le),ue(null)},[_e,W]=D.useState(!1);return u.jsxs("div",{className:"min-h-screen bg-neutral-50 md:flex",children:[u.jsx(N5,{controller:n,onNavigate:z,onSwitchUser:Y}),u.jsx("div",{className:`fixed inset-0 bg-black/30 z-40 md:hidden ${s?"block":"hidden"}`,onClick:()=>r(!1)}),u.jsxs("main",{className:`flex-1 overflow-y-auto relative ${e==="MIMIC"?"p-0":"p-6 md:p-10"}`,children:[u.jsx("button",{onClick:()=>r(!0),className:"md:hidden fixed top-4 left-4 p-2 bg-white/80 backdrop-blur-sm rounded-full shadow-md z-30",children:u.jsx(dI,{size:24})}),u.jsx(D.Suspense,{fallback:u.jsx("div",{className:"flex justify-center p-20",children:u.jsx(Kt,{className:"animate-spin text-neutral-300",size:32})}),children:u.jsx(C5,{controller:n})})]}),S&&u.jsx(c5,{user:S,stats:N,currentView:e,lastBackupTime:P,onNavigate:n.handleSpecialAction,onViewWord:l,isAnyModalOpen:!!o||!!F}),o&&u.jsx(G4,{word:o,onClose:()=>l(null),onNavigateToWord:l,onEditRequest:pe,onUpdate:d,onGainXp:m}),F&&u.jsx(Yk,{user:n.currentUser,word:F,onSave:de,onClose:()=>ue(null),onSwitchToView:le=>{ue(null),l(le)}}),u.jsx(z1,{isOpen:ae.isOpen,title:"End Current Session?",message:"Navigating away will end your current study session. Are you sure you want to continue?",confirmText:"End Session",isProcessing:!1,onConfirm:$,onClose:J,icon:u.jsx(If,{size:40,className:"text-orange-50"}),confirmButtonClass:"bg-orange-600 text-white hover:bg-orange-700 shadow-orange-200"}),u.jsx(z1,{isOpen:Q.isOpen,title:"Unsaved Writing Changes",message:"You have unsaved writing changes. Leave without saving?",confirmText:"Leave",isProcessing:!1,confirmButtonClass:"bg-red-600 text-white hover:bg-red-700 shadow-red-200",onConfirm:()=>{Q.targetView&&(n.setHasWritingUnsavedChanges(!1),Q.action?Q.action():v(!1),x(Q.targetView),r(!1)),T({isOpen:!1,targetView:null,action:void 0})},onClose:()=>T({isOpen:!1,targetView:null,action:void 0})}),u.jsx(u5,{isOpen:M,onClose:()=>j(!1),backups:V,onRestore:le=>{W(!0),B(le).finally(()=>W(!1))},isRestoring:_e,title:"User Selection",description:"We found existing profiles on the server. Select yours to restore.",onNewUser:H,onLocalRestore:G}),u.jsx(d5,{isOpen:K,onClose:()=>I(!1),onRetry:_,onStop:C,status:A,scanningUrl:n.scanningUrl}),R&&u.jsx(f5,{isOpen:R.isOpen,onClose:()=>L(null),onPush:xe,onRestore:ge,type:R.type,localDate:R.localDate,serverDate:R.serverDate,isProcessing:O})]})},O5=()=>u.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-neutral-950/90 backdrop-blur-md animate-in fade-in duration-500",children:u.jsxs("div",{className:"bg-white w-full max-w-md rounded-[3rem] shadow-2xl border-2 border-neutral-100 overflow-hidden animate-in zoom-in-95 duration-500",children:[u.jsxs("div",{className:"bg-neutral-900 p-8 text-white text-center space-y-4",children:[u.jsxs("div",{className:"mx-auto w-20 h-20 bg-white/10 rounded-full flex items-center justify-center border-4 border-white/20 mb-2 relative",children:[u.jsx(nI,{size:40,className:"animate-pulse"}),u.jsx("div",{className:"absolute -top-1 -right-1 bg-red-500 rounded-full p-1 border-2 border-neutral-900",children:u.jsx(br,{size:14})})]}),u.jsx("h3",{className:"text-2xl font-black tracking-tighter uppercase",children:"Connection Lost"})]}),u.jsxs("div",{className:"p-10 text-center space-y-6",children:[u.jsxs("div",{className:"space-y-3",children:[u.jsx("p",{className:"text-lg font-black text-neutral-900 leading-tight",children:"Database link interrupted"}),u.jsxs("p",{className:"text-neutral-500 text-sm leading-relaxed font-medium",children:["The connection to your local storage was closed unexpectedly by the browser.",u.jsx("br",{}),u.jsx("br",{}),"Don't worry, ",u.jsx("strong",{children:"your data is safe"}),". Refreshing the application will restore the connection immediately."]})]}),u.jsxs("button",{onClick:()=>{localStorage.setItem("vocab_pro_auto_restore","true"),window.location.reload()},className:"w-full py-5 bg-neutral-900 text-white rounded-2xl font-black text-sm hover:bg-neutral-800 transition-all shadow-xl shadow-neutral-900/20 active:scale-95 flex items-center justify-center space-x-3",children:[u.jsx(Sl,{size:20}),u.jsx("span",{children:"REFRESH APPLICATION"})]})]}),u.jsx("div",{className:"bg-neutral-50 px-8 py-4 flex items-center justify-center space-x-2 border-t border-neutral-100",children:u.jsx("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Safe Persistent Storage"})})]})}),j5=()=>{const n=kk(),{isLoaded:e,isResetting:s,resetStep:r,view:o,currentUser:l,handleLogin:d}=n,[m,p]=D.useState(!1);return D.useEffect(()=>{YE();const y=()=>p(!0);return window.addEventListener("db-connection-lost",y),()=>window.removeEventListener("db-connection-lost",y)},[]),m?u.jsx(O5,{}):e?s?u.jsxs("div",{className:"h-screen w-screen flex flex-col items-center justify-center bg-white space-y-4",children:[u.jsx(Kt,{size:40,className:"text-neutral-900 animate-spin"}),u.jsx("p",{className:"text-sm font-bold text-neutral-500",children:r})]}):o==="AUTH"||!l?u.jsx(YI,{onLogin:d}):u.jsx(R5,{controller:n}):u.jsxs("div",{className:"h-screen w-screen flex flex-col items-center justify-center bg-white space-y-4",children:[u.jsx(Tl,{size:40,className:"text-neutral-900"}),u.jsx("p",{className:"text-sm font-bold text-neutral-500",children:"Vocab Pro"})]})},k5=()=>{const[n,e]=D.useState(0),s=D.useCallback(()=>{e(r=>r+1)},[]);return D.useEffect(()=>(window.addEventListener("vocab-pro-force-ui-reload",s),()=>window.removeEventListener("vocab-pro-force-ui-reload",s)),[s]),u.jsx(QI,{children:u.jsx(j5,{},n)})},XT=document.getElementById("root");if(!XT)throw new Error("Could not find root element to mount to");const L5=V2.createRoot(XT);L5.render(u.jsx(Pn.StrictMode,{children:u.jsx(k5,{})}));export{qw as $,G2 as A,$2 as B,Z2 as C,Kt as D,os as E,rI as F,DE as G,tu as H,IE as I,Fc as J,ba as K,zE as L,mo as M,G4 as N,Yk as O,fI as P,X2 as Q,mI as R,Tl as S,F4 as T,oI as U,va as V,$E as W,hn as X,Za as Y,Nf as Z,hu as _,dv as a,VE as a$,_s as a0,Wg as a1,V5 as a2,qk as a3,EN as a4,Ym as a5,Vt as a6,Ra as a7,Ca as a8,Yw as a9,z1 as aA,fu as aB,G5 as aC,hN as aD,Fk as aE,Hk as aF,Dk as aG,II as aH,ME as aI,qE as aJ,Cn as aK,Q2 as aL,PE as aM,Kk as aN,Jk as aO,qc as aP,If as aQ,Sl as aR,BE as aS,kE as aT,vI as aU,Xk as aV,sN as aW,$w as aX,Wp as aY,Qp as aZ,Tf as a_,gN as aa,rM as ab,TI as ac,Ya as ad,iM as ae,Pn as af,Kg as ag,cu as ah,of as ai,ZE as aj,U5 as ak,P5 as al,D5 as am,B5 as an,z5 as ao,Of as ap,xN as aq,yN as ar,FE as as,iI as at,br as au,bg as av,Al as aw,MI as ax,jg as ay,SI as az,NE as b,UE as b$,Sf as b0,Rg as b1,H2 as b2,Af as b3,fN as b4,LE as b5,GE as b6,cI as b7,wI as b8,CE as b9,hI as bA,hv as bB,V1 as bC,I0 as bD,A0 as bE,Um as bF,Og as bG,dI as bH,n4 as bI,X5 as bJ,sM as bK,tM as bL,nM as bM,aI as bN,EI as bO,IT as bP,Y5 as bQ,sI as bR,AT as bS,s5 as bT,TT as bU,fl as bV,W5 as bW,$5 as bX,Q5 as bY,K5 as bZ,OE as b_,W2 as ba,M5 as bb,Gc as bc,fv as bd,bT as be,Y2 as bf,N0 as bg,q5 as bh,Z5 as bi,k1 as bj,F5 as bk,UI as bl,du as bm,J5 as bn,H5 as bo,eM as bp,K2 as bq,J2 as br,Kn as bs,Uk as bt,BI as bu,VI as bv,oM as bw,_w as bx,zI as by,Pm as bz,Se as c,Cw as c0,Rw as c1,FI as c2,RE as d,HE as e,wf as f,rf as g,_I as h,Ig as i,u as j,Dt as k,Gg as l,Rf as m,Hg as n,Pg as o,Vg as p,zg as q,D as r,PI as s,ii as t,Yg as u,Xw as v,wl as w,Ct as x,Cg as y,AE as z};
