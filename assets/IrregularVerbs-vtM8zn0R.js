import{c as Br,r as N,j as n,aj as He,ag as Yr,H as Re,at as sr,S as or,aZ as $r,i as Kr,b5 as Be,J as ar,aQ as Ge,y as Le,P as Jr,ay as ve,W as zr,az as Wr,X as Te,aL as Xr,K as qr,Z as ir,bm as Zr,bn as Qr,N as en,bo as ne,l as tn,a1 as rn,ai as nn,a0 as sn,o as on,v as an,av as ln,a6 as Ye,bp as $e,bq as ye,br as Ce,ac as cn,ad as dn,bs as un}from"./index-C2HBAOCD.js";import{F as fn}from"./file-clock-D69QsP6x.js";import{C as En}from"./chevron-left-C7dR-E_S.js";import{S as Ke}from"./square-check-big-Bkp4Zk2y.js";import{L as _n}from"./library-DYl8DoPe.js";import{C as hn}from"./chart-no-axes-column-increasing-DFNMUoAg.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=Br("Dices",[["rect",{width:"12",height:"12",x:"2",y:"10",rx:"2",ry:"2",key:"6agr2n"}],["path",{d:"m17.92 14 3.5-3.5a2.24 2.24 0 0 0 0-3l-5-4.92a2.24 2.24 0 0 0-3 0L10 6",key:"1o487t"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"M10 14h.01",key:"ssrbsk"}],["path",{d:"M15 6h.01",key:"cblpky"}],["path",{d:"M18 9h.01",key:"2061c0"}]]);function lr(e){return`You are an expert English linguist.
    
    TASK: Provide the principal parts (past simple and past participle) for the following list of irregular verbs: [${e.map(r=>`"${r}"`).join(", ")}].

    RULES:
    1.  For each verb, provide its V1 (base form), V2 (past simple), and V3 (past participle).
    2.  If a verb has multiple common forms (e.g., "dreamt" / "dreamed"), provide the most common one first.
    3.  If a word is not an irregular verb, return its regular "-ed" forms.
    
    Return your analysis as a strict JSON array of objects. Each object must contain "v1", "v2", and "v3".

    Response Example (Strict JSON Array):
    [
      {
        "v1": "go",
        "v2": "went",
        "v3": "gone"
      },
      {
        "v1": "begin",
        "v2": "began",
        "v3": "begun"
      },
      {
        "v1": "dream",
        "v2": "dreamt",
        "v3": "dreamt"
      }
    ]`}const pn=({isOpen:e,onClose:t,onSave:r,initialData:s})=>{const[o,a]=N.useState(""),[i,l]=N.useState(""),[u,f]=N.useState("");N.useEffect(()=>{e&&(a((s==null?void 0:s.v1)||""),l((s==null?void 0:s.v2)||""),f((s==null?void 0:s.v3)||""))},[e,s]);const c=_=>{_.preventDefault(),o.trim()&&r({v1:o.trim().toLowerCase(),v2:i.trim(),v3:u.trim()})};return e?n.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:n.jsxs("form",{onSubmit:c,className:"bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col",children:[n.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-start shrink-0",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-black text-neutral-900",children:s?"Edit Verb":"Add New Verb"}),n.jsx("p",{className:"text-sm text-neutral-500",children:"Define the principal parts of an irregular verb."})]}),n.jsx("button",{type:"button",onClick:t,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:n.jsx(Te,{size:20})})]}),n.jsxs("main",{className:"p-8 grid grid-cols-3 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-neutral-500 mb-1",children:"V1 (Base Form)"}),n.jsx("input",{value:o,onChange:_=>a(_.target.value),placeholder:"e.g., go",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium",required:!0,autoFocus:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-neutral-500 mb-1",children:"V2 (Past Simple)"}),n.jsx("input",{value:i,onChange:_=>l(_.target.value),placeholder:"e.g., went",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-xs font-bold text-neutral-500 mb-1",children:"V3 (Past Participle)"}),n.jsx("input",{value:u,onChange:_=>f(_.target.value),placeholder:"e.g., gone",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium"})]})]}),!s&&n.jsx("div",{className:"px-8 pb-4 -mt-2",children:n.jsxs("div",{className:"flex items-start gap-3 p-3 bg-indigo-50/50 text-indigo-900 rounded-lg border border-indigo-100",children:[n.jsx(Xr,{size:16,className:"shrink-0 mt-0.5 text-indigo-500"}),n.jsxs("p",{className:"text-xs font-medium",children:[n.jsx("strong",{children:"Pro-tip:"}),' You only need to enter the V1 (base form). You can use "Refine with AI" on the main table to fill in V2 & V3 for multiple verbs at once.']})]})}),n.jsx("footer",{className:"px-8 py-6 border-t border-neutral-100 flex justify-end shrink-0 bg-neutral-50/50 rounded-b-[2.5rem]",children:n.jsxs("button",{type:"submit",className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs flex items-center gap-2 uppercase tracking-widest",children:[n.jsx(sr,{size:14})," Save Verb"]})})]})}):null},xn=({isOpen:e,onClose:t,onStart:r,verbs:s})=>{const[o,a]=N.useState(!1);if(!e)return null;const i=s.some(c=>c.lastTestResult==="fail"),l=s.length,u=s.filter(c=>c.lastTestResult==="pass").length,f=l-u;return n.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:n.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col",children:[n.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-start shrink-0",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Start Practice"}),n.jsxs("p",{className:"text-sm text-neutral-500",children:["Choose a mode for the ",l," selected verb(s)."]})]}),n.jsx("button",{type:"button",onClick:t,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:n.jsx(Te,{size:20})})]}),n.jsxs("main",{className:"p-8 flex flex-col gap-6",children:[n.jsx("div",{className:"flex flex-col gap-2",children:n.jsxs("div",{className:"flex bg-neutral-100 p-1 rounded-xl",children:[n.jsxs("button",{onClick:()=>a(!1),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${o?"text-neutral-500 hover:text-neutral-700":"bg-white text-neutral-900 shadow-sm"}`,children:["All (",l,")"]}),n.jsxs("button",{onClick:()=>a(!0),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${o?"bg-white text-neutral-900 shadow-sm":"text-neutral-500 hover:text-neutral-700"}`,children:["Not Learned (",f,")"]})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("button",{onClick:()=>r("headword",o),className:"p-6 bg-neutral-50 border-2 border-neutral-200 rounded-2xl text-left hover:border-neutral-900 hover:bg-white hover:shadow-lg transition-all group",children:[n.jsx(qr,{size:24,className:"text-neutral-500 group-hover:text-neutral-900 mb-2"}),n.jsx("h4",{className:"font-bold",children:"Test from V1"}),n.jsx("p",{className:"text-xs text-neutral-500",children:"Recall V2 and V3 from the base form."})]}),n.jsxs("button",{onClick:()=>r("random",o),className:"p-6 bg-neutral-50 border-2 border-neutral-200 rounded-2xl text-left hover:border-neutral-900 hover:bg-white hover:shadow-lg transition-all group",children:[n.jsx(In,{size:24,className:"text-neutral-500 group-hover:text-neutral-900 mb-2"}),n.jsx("h4",{className:"font-bold",children:"Test Random Form"}),n.jsx("p",{className:"text-xs text-neutral-500",children:"Recall forms from a random V1/V2/V3."})]})]}),n.jsxs("div",{className:"p-6 bg-neutral-50 border-2 border-neutral-200 rounded-2xl text-left space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ir,{size:24,className:"text-neutral-500"}),n.jsxs("div",{children:[n.jsx("h4",{className:"font-bold",children:"Quick Review"}),n.jsx("p",{className:"text-xs text-neutral-500",children:"Rapidly mark verbs as known or forgotten."})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("button",{onClick:()=>r("quick_forgot"),disabled:!i,className:"px-4 py-2 bg-white text-rose-700 rounded-lg font-bold text-xs flex items-center justify-center gap-2 hover:bg-rose-50 border border-rose-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[n.jsx(Ge,{size:14}),n.jsx("span",{children:"Review Forgot"})]}),n.jsxs("button",{onClick:()=>r("quick_all"),className:"px-4 py-2 bg-white text-neutral-700 rounded-lg font-bold text-xs flex items-center justify-center gap-2 hover:bg-neutral-100 border border-neutral-200 transition-colors",children:[n.jsx(or,{size:14}),n.jsx("span",{children:"Review All"})]})]})]})]})]})})},Tn=e=>{const{loading:t,verbs:r,totalCount:s,searchQuery:o,onSearchChange:a,page:i,pageSize:l,onPageSizeChange:u,totalPages:f,onPageChange:c,isModalOpen:_,editingVerb:h,selectedIds:d,setSelectedIds:I,isProcessing:T,libraryWords:E,onGlobalViewWord:g,onNew:D,onEdit:P,onDelete:m,onSave:U,onCloseModal:L,onBulkDelete:G,onAddToLibrary:Y,onRefine:v,onPractice:y,onPracticeAll:M,isPracticeSetupOpen:W,onClosePracticeSetup:z,onStartPractice:H,isAddPanelOpen:X,addInput:q,onAddInputChange:Oe,onBulkAdd:C,onQuickSetStatus:Ee,practiceVerbs:$}=e,[K,ie]=N.useState(null);return n.jsxs("div",{className:"space-y-8 animate-in fade-in duration-500 pb-20",children:[n.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[n.jsxs("div",{children:[n.jsxs("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight flex items-center gap-3",children:[n.jsx(fn,{size:28})," Verb Library"]}),n.jsx("p",{className:"text-neutral-500 mt-2 font-medium",children:"A dedicated space for reviewing irregular verb forms."})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:M,disabled:s===0,className:"px-6 py-3 bg-white border border-neutral-200 text-neutral-600 rounded-xl font-black text-xs flex items-center space-x-2 transition-all hover:bg-neutral-50 active:scale-95 uppercase tracking-widest shadow-sm disabled:opacity-50",children:[n.jsx(He,{size:16}),n.jsx("span",{children:"Practice All"})]}),n.jsxs("button",{onClick:D,className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs flex items-center space-x-2 transition-all hover:bg-neutral-800 active:scale-95 uppercase tracking-widest shadow-sm",children:[n.jsx(Yr,{size:16}),n.jsx("span",{children:"New Verb"})]})]})]}),X&&n.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border-2 border-neutral-100 shadow-xl space-y-4 animate-in slide-in-from-top-4 duration-300",children:[n.jsx("textarea",{autoFocus:!0,value:q,onChange:S=>Oe(S.target.value),placeholder:"Enter base form verbs, separated by comma, semicolon, or newline...",className:"w-full h-24 p-4 bg-neutral-50 border border-neutral-200 rounded-2xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 focus:outline-none resize-y"}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsxs("button",{onClick:()=>C(!1),disabled:T||!q.trim(),className:"px-6 py-3 bg-neutral-100 text-neutral-600 rounded-xl font-black text-xs flex items-center space-x-2 hover:bg-neutral-200 transition-all disabled:opacity-50",children:[T?n.jsx(Re,{className:"animate-spin",size:14}):n.jsx(sr,{size:14}),n.jsx("span",{children:"Add Verbs"})]}),n.jsxs("button",{onClick:()=>C(!0),disabled:T||!q.trim(),className:"px-6 py-3 bg-indigo-600 text-white rounded-xl font-black text-xs flex items-center space-x-2 hover:bg-indigo-500 transition-all disabled:opacity-50 shadow-lg shadow-indigo-200",children:[T?n.jsx(Re,{className:"animate-spin",size:14}):n.jsx(or,{size:14}),n.jsx("span",{children:"Add with AI"})]})]})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[n.jsxs("div",{className:"relative flex-1 w-full",children:[n.jsx($r,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 text-neutral-400",size:16}),n.jsx("input",{type:"text",value:o,onChange:S=>a(S.target.value),placeholder:"Search verbs (V1, V2, V3)...",className:"w-full pl-10 pr-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-neutral-900 transition-all shadow-sm"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[s>l&&n.jsxs("div",{className:"flex items-center gap-2 bg-white border border-neutral-200 rounded-xl px-2 py-1.5 shadow-sm shrink-0",children:[n.jsx("button",{disabled:i===0,onClick:()=>c(i-1),className:"p-1.5 rounded-lg text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 disabled:opacity-30 disabled:hover:bg-transparent",children:n.jsx(En,{size:16})}),n.jsxs("span",{className:"text-[10px] font-black text-neutral-500 uppercase tracking-widest px-2",children:["Page ",i+1," of ",f]}),n.jsx("button",{disabled:i>=f-1,onClick:()=>c(i+1),className:"p-1.5 rounded-lg text-neutral-400 hover:bg-neutral-100 hover:text-neutral-900 disabled:opacity-30 disabled:hover:bg-transparent",children:n.jsx(Kr,{size:16})})]}),n.jsxs("div",{className:"flex items-center gap-2 bg-white border border-neutral-200 rounded-xl px-3 py-1.5 shadow-sm shrink-0",children:[n.jsx("label",{htmlFor:"pageSizeSelect",className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Size"}),n.jsxs("select",{id:"pageSizeSelect",value:l,onChange:S=>u(Number(S.target.value)),className:"bg-transparent text-xs font-bold text-neutral-800 focus:outline-none border-none p-0",children:[n.jsx("option",{value:15,children:"15"}),n.jsx("option",{value:30,children:"30"}),n.jsx("option",{value:50,children:"50"}),n.jsx("option",{value:100,children:"100"})]})]})]})]}),t?n.jsx("div",{className:"flex items-center justify-center p-20",children:n.jsx(Re,{className:"animate-spin text-neutral-300",size:32})}):r.length===0?n.jsxs("div",{className:"text-center py-20 border-2 border-dashed border-neutral-200 rounded-2xl text-neutral-400",children:[n.jsx("p",{className:"font-bold mb-2",children:o?"No verbs match your search.":"No irregular verbs added yet."}),!o&&n.jsx("p",{children:'Click "New Verb" to add verbs like "go", "went", "gone".'})]}):n.jsxs("div",{className:"bg-white rounded-[2rem] border border-neutral-200 shadow-sm overflow-hidden",children:[n.jsxs("table",{className:"w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"bg-neutral-50/50",children:[n.jsx("th",{className:"p-4 w-12",children:n.jsx("button",{onClick:()=>I(d.size===r.length&&r.length>0?new Set:new Set(r.map(S=>S.id))),className:"text-neutral-300 hover:text-neutral-900",children:d.size===r.length&&r.length>0?n.jsx(Ke,{size:18,className:"text-neutral-900"}):n.jsx(Be,{size:18})})}),n.jsx("th",{className:"p-3 text-left text-[10px] font-black uppercase tracking-wider text-neutral-400",children:"V1 (Base)"}),n.jsx("th",{className:"p-3 text-left text-[10px] font-black uppercase tracking-wider text-neutral-400",children:"V2 (Past Simple)"}),n.jsx("th",{className:"p-3 text-left text-[10px] font-black uppercase tracking-wider text-neutral-400",children:"V3 (Past Participle)"}),n.jsx("th",{className:"p-3 text-right text-[10px] font-black uppercase tracking-wider text-neutral-400",children:"Actions"})]})}),n.jsx("tbody",{children:r.map(S=>{const Q=d.has(S.id),Se=E.has(S.v1.toLowerCase()),le=new Set(S.lastTestIncorrectForms||[]);return n.jsxs("tr",{className:`border-t border-neutral-100 transition-colors ${Q?"bg-blue-50/50":"hover:bg-neutral-50/80 group"}`,children:[n.jsx("td",{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"w-4 h-4 flex items-center justify-center",children:[S.lastTestResult==="pass"&&S.lastTestTimestamp&&n.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500",title:`Known (on ${new Date(S.lastTestTimestamp).toLocaleDateString()})`}),S.lastTestResult==="fail"&&S.lastTestTimestamp&&n.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500",title:`Forgot (on ${new Date(S.lastTestTimestamp).toLocaleDateString()})`})]}),n.jsx("button",{onClick:()=>I(J=>{const re=new Set(J);return re.has(S.id)?re.delete(S.id):re.add(S.id),re}),children:Q?n.jsx(Ke,{size:18,className:"text-blue-600"}):n.jsx(Be,{size:18,className:"text-neutral-200 group-hover:text-neutral-400"})})]})}),n.jsx("td",{className:`p-3 font-bold text-sm ${le.has("v1")?"bg-rose-50/50":""}`,children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{children:S.v1}),Se&&n.jsx("button",{onClick:()=>g(E.get(S.v1.toLowerCase())),title:"View in library",children:n.jsx(ar,{size:14,className:"text-neutral-400 hover:text-neutral-800"})})]})}),n.jsx("td",{className:`p-3 font-mono text-sm text-neutral-600 ${le.has("v2")?"bg-rose-50/50":""}`,children:S.v2||"..."}),n.jsx("td",{className:`p-3 font-mono text-sm text-neutral-600 ${le.has("v3")?"bg-rose-50/50":""}`,children:S.v3||"..."}),n.jsx("td",{className:"p-3 text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity focus-within:opacity-100",children:[n.jsx("button",{onClick:J=>{J.stopPropagation(),Ee(S,"fail")},className:"p-2 text-neutral-400 hover:text-rose-600 hover:bg-rose-50 rounded-lg",title:"Mark as Forgot",children:n.jsx(Ge,{size:16})}),n.jsx("button",{onClick:J=>{J.stopPropagation(),Ee(S,"pass")},className:"p-2 text-neutral-400 hover:text-green-600 hover:bg-green-50 rounded-lg",title:"Mark as Known",children:n.jsx(Le,{size:16})}),n.jsx("div",{className:"w-px h-4 bg-neutral-200 mx-1"}),n.jsx("button",{onClick:J=>{J.stopPropagation(),P(S)},className:"p-2 text-neutral-400 hover:text-neutral-900 hover:bg-neutral-100 rounded-lg",children:n.jsx(Jr,{size:14})}),n.jsx("button",{onClick:J=>{J.stopPropagation(),ie(S)},className:"p-2 text-neutral-400 hover:text-rose-600 hover:bg-rose-50 rounded-lg",children:n.jsx(ve,{size:14})})]})})]},S.id)})})]}),d.size>0&&n.jsxs("div",{className:"p-4 bg-neutral-50 border-t border-neutral-200 flex items-center justify-between",children:[n.jsxs("div",{className:"text-xs font-bold text-neutral-500",children:[d.size," selected"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("button",{onClick:y,disabled:T,className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-lg font-bold text-xs flex items-center gap-2 hover:bg-blue-100 disabled:opacity-50",children:[n.jsx(He,{size:14}),n.jsx("span",{children:"Practice"})]}),n.jsxs("button",{onClick:v,disabled:T,className:"px-4 py-2 bg-indigo-50 text-indigo-700 rounded-lg font-bold text-xs flex items-center gap-2 hover:bg-indigo-100 disabled:opacity-50",children:[n.jsx(zr,{size:14}),n.jsx("span",{children:"Refine with AI"})]}),n.jsxs("button",{onClick:Y,disabled:T,className:"px-4 py-2 bg-green-50 text-green-700 rounded-lg font-bold text-xs flex items-center gap-2 hover:bg-green-100 disabled:opacity-50",children:[n.jsx(_n,{size:14}),n.jsx("span",{children:"Add to Library"})]}),n.jsxs("button",{onClick:G,disabled:T,className:"px-4 py-2 bg-rose-50 text-rose-700 rounded-lg font-bold text-xs flex items-center gap-2 hover:bg-rose-100 disabled:opacity-50",children:[n.jsx(ve,{size:14}),n.jsx("span",{children:"Delete"})]})]})]})]}),n.jsx(pn,{isOpen:_,onClose:L,onSave:U,initialData:h}),n.jsx(xn,{isOpen:W,onClose:z,onStart:H,verbs:$}),n.jsx(Wr,{isOpen:!!K,title:"Delete Verb?",message:n.jsxs(n.Fragment,{children:["Are you sure you want to delete ",n.jsxs("strong",{children:['"',K==null?void 0:K.v1,'"']}),"? This is permanent."]}),confirmText:"Yes, Delete",isProcessing:!1,onConfirm:()=>{K&&m(K),ie(null)},onClose:()=>ie(null),icon:n.jsx(ve,{size:40,className:"text-red-500"})})]})},Nn=({verbs:e,mode:t,currentIndex:r,practiceQueue:s,answers:o,onAnswerChange:a,onEnterPress:i,isAnswered:l,isFinished:u,isRevealed:f,sessionResults:c,onCheck:_,onNext:h,onQuickAnswer:d,onReveal:I,onFinish:T,onExit:E})=>{const g=N.useRef(null);N.useEffect(()=>{!u&&!l&&g.current&&g.current.focus()},[r,l,u]);const D=s[r],P=(m,U)=>{if(!D)return null;const{verb:L,promptType:G}=D,v=["v1","v2","v3"].find(H=>H!==G),y=m===v;if(G===m)return n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"block text-xs font-bold text-neutral-500",children:U}),n.jsx("div",{className:"w-full px-4 py-3 bg-neutral-100 border border-neutral-200 rounded-xl font-bold text-lg text-neutral-900",children:L[m]})]});const M=o[m]||"",W=(M||"").trim().toLowerCase()===L[m].toLowerCase();let z="bg-white focus:bg-white focus:border-neutral-900";return l&&(z=W?"bg-green-50 border-green-500 text-green-800":"bg-red-50 border-red-500 text-red-800"),n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"block text-xs font-bold text-neutral-500",children:U}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{ref:y?g:null,value:M,onChange:H=>a(m,H.target.value),disabled:l,onKeyDown:H=>{H.key==="Enter"&&!l&&i()},className:`w-full px-4 py-3 border-2 border-neutral-200 rounded-xl font-bold text-lg focus:ring-2 focus:ring-neutral-900 outline-none transition-colors ${z}`,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off"}),l&&!W&&n.jsx("div",{className:"absolute top-full mt-1 text-xs font-bold text-green-600 animate-in fade-in slide-in-from-top-1",children:L[m]})]})]})};if(u){const m=c.filter(U=>U.result==="pass").length;return n.jsx("div",{className:"fixed inset-0 z-[210] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:n.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col max-h-[90vh]",children:[n.jsx("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-center",children:n.jsxs("div",{children:[n.jsxs("h3",{className:"text-xl font-black text-neutral-900 flex items-center gap-2",children:[n.jsx(hn,{size:20})," Session Recap"]}),n.jsxs("p",{className:"text-sm text-neutral-500",children:["You got ",m," out of ",e.length," correct."]})]})}),n.jsx("main",{className:"p-6 overflow-y-auto space-y-2",children:e.map(U=>{const L=c.find(Y=>Y.verbId===U.id),G=(L==null?void 0:L.result)==="pass";return n.jsxs("div",{className:`p-3 rounded-lg flex items-center justify-between border ${G?"bg-green-50 border-green-100":"bg-red-50 border-red-100"}`,children:[n.jsxs("span",{className:"font-bold text-sm text-neutral-800",children:[U.v1," ",n.jsxs("span",{className:"text-neutral-400 font-normal",children:["â†’ ",U.v2,", ",U.v3]})]}),G?n.jsx(Zr,{className:"text-green-500",size:18}):n.jsx(Qr,{className:"text-red-500",size:18})]},U.id)})}),n.jsx("footer",{className:"px-8 py-6 border-t border-neutral-100 flex justify-end shrink-0 bg-neutral-50/50 rounded-b-[2.5rem]",children:n.jsx("button",{onClick:T,className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs uppercase tracking-widest hover:bg-neutral-800 transition-colors",children:"Finish"})})]})})}return t==="quick"&&D?n.jsx("div",{className:"fixed inset-0 z-[210] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:n.jsxs("div",{className:"bg-white w-full max-w-md rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col",children:[n.jsxs("header",{className:"px-8 py-4 border-b border-neutral-100 flex justify-between items-center shrink-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"p-1.5 bg-amber-100 rounded-lg text-amber-600",children:n.jsx(ir,{size:16})}),n.jsx("h3",{className:"text-lg font-black text-neutral-900",children:"Quick Review"})]}),n.jsx("button",{type:"button",onClick:E,className:"p-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:n.jsx(Te,{size:16})})]}),n.jsxs("main",{className:"p-8 flex flex-col items-center text-center space-y-6",children:[n.jsxs("p",{className:"text-[10px] font-black uppercase tracking-widest text-neutral-400 bg-neutral-100 px-2 py-1 rounded-md",children:["Verb ",r+1," of ",s.length]}),n.jsxs("div",{className:"min-h-[100px] flex flex-col justify-center w-full",children:[n.jsx("h2",{className:"text-4xl font-black text-neutral-900 mb-2",children:D.verb.v1}),f?n.jsxs("p",{className:"text-xl font-mono text-neutral-600 animate-in fade-in slide-in-from-bottom-2 bg-neutral-50 py-2 rounded-xl border border-neutral-200",children:[D.verb.v2,", ",D.verb.v3]}):n.jsx("div",{className:"h-[46px] flex items-center justify-center",children:n.jsx("div",{className:"w-16 h-2 bg-neutral-100 rounded-full animate-pulse"})})]})]}),n.jsxs("footer",{className:"px-6 pb-6 pt-2 flex items-stretch gap-3",children:[n.jsxs("button",{onClick:()=>d("fail"),className:"flex-1 py-4 bg-white border-2 border-neutral-100 text-neutral-500 hover:text-red-600 hover:border-red-200 hover:bg-red-50 rounded-2xl flex flex-col items-center justify-center space-y-1 transition-all active:scale-95 group",children:[n.jsx(Ge,{size:20,className:"group-hover:rotate-180 transition-transform"}),n.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:"Forgot"})]}),n.jsxs("button",{onClick:I,disabled:f,className:"flex-1 py-4 bg-white border-2 border-neutral-100 text-neutral-500 hover:text-neutral-900 hover:border-neutral-300 hover:bg-neutral-50 rounded-2xl flex flex-col items-center justify-center space-y-1 transition-all active:scale-95 disabled:opacity-50 disabled:bg-neutral-50",children:[n.jsx(ar,{size:20}),n.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:"Show"})]}),n.jsxs("button",{onClick:()=>d("pass"),className:"flex-1 py-4 bg-white border-2 border-neutral-100 text-neutral-500 hover:text-green-600 hover:border-green-200 hover:bg-green-50 rounded-2xl flex flex-col items-center justify-center space-y-1 transition-all active:scale-95 group",children:[n.jsx(Le,{size:20,className:"group-hover:scale-110 transition-transform"}),n.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:"Known"})]})]})]})}):n.jsx("div",{className:"fixed inset-0 z-[210] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:n.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col max-h-[90vh]",children:[n.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-start shrink-0",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Verb Practice"}),n.jsxs("p",{className:"text-sm text-neutral-500 font-medium",children:["Verb ",r+1," of ",s.length]})]}),n.jsx("button",{type:"button",onClick:E,className:"p-2 -mr-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:n.jsx(Te,{size:20})})]}),n.jsxs("main",{className:"p-8 grid grid-cols-1 gap-6",children:[P("v1","V1 (Base Form)"),P("v2","V2 (Past Simple)"),P("v3","V3 (Past Participle)")]}),n.jsx("footer",{className:"px-8 py-6 border-t border-neutral-100 flex justify-end shrink-0 bg-neutral-50/50 rounded-b-[2.5rem]",children:l?n.jsxs("button",{onClick:h,className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs flex items-center gap-2 uppercase tracking-widest hover:bg-neutral-800 transition-all active:scale-95",children:[n.jsx("span",{children:r===s.length-1?"Finish":"Next"}),n.jsx(en,{size:14})]}):n.jsxs("button",{onClick:_,className:"px-6 py-3 bg-indigo-600 text-white rounded-xl font-black text-xs flex items-center gap-2 uppercase tracking-widest hover:bg-indigo-500 transition-all active:scale-95 shadow-lg shadow-indigo-200",children:[n.jsx(Le,{size:14}),n.jsx("span",{children:"Check Answer"})]})})]})})},bn=({verbs:e,mode:t,onComplete:r,onExit:s})=>{const[o,a]=N.useState(0),[i,l]=N.useState({}),[u,f]=N.useState(!1),[c,_]=N.useState([]),[h,d]=N.useState(!1),[I,T]=N.useState(!1),E=N.useRef(r),g=N.useRef(c),D=N.useRef(h);N.useEffect(()=>{E.current=r},[r]),N.useEffect(()=>{g.current=c,D.current=h},[c,h]),N.useEffect(()=>()=>{g.current.length>0&&!D.current&&E.current(g.current)},[]);const P=N.useMemo(()=>e.map(v=>{let y="v1";if(t==="random"){const M=["v1"];v.v2&&M.push("v2"),v.v3&&M.push("v3"),y=M[Math.floor(Math.random()*M.length)]}return{verb:v,promptType:y}}).sort(()=>Math.random()-.5),[e,t]),m=P[o],U=(v,y)=>{l(M=>({...M,[v]:y}))},L=()=>{if(!m)return;const{verb:v,promptType:y}=m,M=ne(i.v1||"")===ne(v.v1),W=ne(i.v2||"")===ne(v.v2),z=ne(i.v3||"")===ne(v.v3),H=(y!=="v1"?M:!0)&&(y!=="v2"?W:!0)&&(y!=="v3"?z:!0),X=[];y!=="v1"&&!M&&X.push("v1"),y!=="v2"&&!W&&X.push("v2"),y!=="v3"&&!z&&X.push("v3"),f(!0),_(q=>[...q,{verbId:v.id,result:H?"pass":"fail",incorrectForms:X}])},G=()=>{o<P.length-1?(a(o+1),l({}),f(!1),T(!1)):d(!0)},Y=v=>{h||!m||(_(y=>[...y,{verbId:m.verb.id,result:v,incorrectForms:v==="fail"?["v1","v2","v3"]:[]}]),G())};return!m&&!h?null:n.jsx(Nn,{verbs:e,mode:t,currentIndex:o,practiceQueue:P,answers:i,onAnswerChange:U,onEnterPress:L,isAnswered:u,isFinished:h,isRevealed:I,sessionResults:c,onCheck:L,onNext:G,onQuickAnswer:Y,onReveal:()=>T(!0),onFinish:()=>r(c),onExit:s})};var An={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Je;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Je||(Je={}));var ze;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(ze||(ze={}));var We;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(We||(We={}));var te;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(te||(te={}));var Xe;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Xe||(Xe={}));var qe;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(qe||(qe={}));var Ze;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Ze||(Ze={}));var Qe;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Qe||(Qe={}));var et;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(et||(et={}));var tt;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(tt||(tt={}));var rt;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(rt||(rt={}));var nt;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.MINIMAL="MINIMAL"})(nt||(nt={}));var st;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(st||(st={}));var ot;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(ot||(ot={}));var at;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(at||(at={}));var it;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE",e.IMAGE_RECITATION="IMAGE_RECITATION",e.IMAGE_OTHER="IMAGE_OTHER"})(it||(it={}));var lt;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(lt||(lt={}));var ct;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(ct||(ct={}));var dt;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(dt||(dt={}));var ut;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(ut||(ut={}));var ft;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ft||(ft={}));var Et;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Et||(Et={}));var _t;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(_t||(_t={}));var ht;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(ht||(ht={}));var It;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(It||(It={}));var pt;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(pt||(pt={}));var xt;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(xt||(xt={}));var Tt;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",e.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(Tt||(Tt={}));var Nt;(function(e){e.COLLECTION="COLLECTION"})(Nt||(Nt={}));var bt;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(bt||(bt={}));var At;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(At||(At={}));var gt;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(gt||(gt={}));var mt;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(mt||(mt={}));var Ot;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(Ot||(Ot={}));var St;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(St||(St={}));var Rt;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Rt||(Rt={}));var vt;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(vt||(vt={}));var yt;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(yt||(yt={}));var Ct;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(Ct||(Ct={}));var wt;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(wt||(wt={}));var Dt;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(Dt||(Dt={}));var Lt;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(Lt||(Lt={}));var Ut;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING",e.DISTILLATION="DISTILLATION"})(Ut||(Ut={}));var Pt;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(Pt||(Pt={}));var jt;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(jt||(jt={}));var Mt;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED",e.REGISTERED="REGISTERED"})(Mt||(Mt={}));var Ft;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Ft||(Ft={}));var Gt;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(Gt||(Gt={}));var Vt;(function(e){e.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",e.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",e.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(Vt||(Vt={}));var kt;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.ACTIVITY_START="ACTIVITY_START",e.ACTIVITY_END="ACTIVITY_END"})(kt||(kt={}));var Ht;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Ht||(Ht={}));var Bt;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Bt||(Bt={}));var Yt;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(Yt||(Yt={}));var $t;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})($t||($t={}));var Kt;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Kt||(Kt={}));var Jt;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(Jt||(Jt={}));var zt;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(zt||(zt={}));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Wt;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(Wt||(Wt={}));function Ne(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(e);o<s.length;o++)t.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(e,s[o])&&(r[s[o]]=e[s[o]]);return r}function Xt(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],s=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function fe(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(e,t||[]),o,a=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",i),o[Symbol.asyncIterator]=function(){return this},o;function i(d){return function(I){return Promise.resolve(I).then(d,_)}}function l(d,I){s[d]&&(o[d]=function(T){return new Promise(function(E,g){a.push([d,T,E,g])>1||u(d,T)})},I&&(o[d]=I(o[d])))}function u(d,I){try{f(s[d](I))}catch(T){h(a[0][3],T)}}function f(d){d.value instanceof w?Promise.resolve(d.value.v).then(c,_):h(a[0][2],d)}function c(d){u("next",d)}function _(d){u("throw",d)}function h(d,I){d(I),a.shift(),a.length&&u(a[0][0],a[0][1])}}function ae(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Xt=="function"?Xt(e):e[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(a){r[a]=e[a]&&function(i){return new Promise(function(l,u){i=e[a](i),o(l,u,i.done,i.value)})}}function o(a,i,l,u){Promise.resolve(u).then(function(f){a({value:f,done:l})},i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let cr=function(){const{crypto:e}=globalThis;if(e!=null&&e.randomUUID)return cr=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),r=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^r()&15>>+s/4).toString(16))};const gn=()=>cr();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ue(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const Pe=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class B extends Error{}class k extends B{constructor(t,r,s,o){super(`${k.makeMessage(t,r,s)}`),this.status=t,this.headers=o,this.error=r}static makeMessage(t,r,s){const o=r!=null&&r.message?typeof r.message=="string"?r.message:JSON.stringify(r.message):r?JSON.stringify(r):s;return t&&o?`${t} ${o}`:t?`${t} status code (no body)`:o||"(no status code or body)"}static generate(t,r,s,o){if(!t||!o)return new Ae({message:s,cause:Pe(r)});const a=r;return t===400?new ur(t,a,s,o):t===401?new fr(t,a,s,o):t===403?new Er(t,a,s,o):t===404?new _r(t,a,s,o):t===409?new hr(t,a,s,o):t===422?new Ir(t,a,s,o):t===429?new pr(t,a,s,o):t>=500?new xr(t,a,s,o):new k(t,a,s,o)}}class je extends k{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class Ae extends k{constructor({message:t,cause:r}){super(void 0,void 0,t||"Connection error.",void 0),r&&(this.cause=r)}}class dr extends Ae{constructor({message:t}={}){super({message:t??"Request timed out."})}}class ur extends k{}class fr extends k{}class Er extends k{}class _r extends k{}class hr extends k{}class Ir extends k{}class pr extends k{}class xr extends k{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mn=/^[a-z][a-z0-9+.-]*:/i,On=e=>mn.test(e);let Me=e=>(Me=Array.isArray,Me(e));const Sn=Me;let Rn=Sn;const qt=Rn;function vn(e){if(!e)return!0;for(const t in e)return!1;return!0}function yn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}const Cn=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new B(`${e} must be an integer`);if(t<0)throw new B(`${e} must be a positive integer`);return t},wn=e=>{try{return JSON.parse(e)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Dn=e=>new Promise(t=>setTimeout(t,e));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const se="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ln(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Un=()=>{var e,t,r,s,o;const a=Ln();if(a==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":se,"X-Stainless-OS":Qt(Deno.build.os),"X-Stainless-Arch":Zt(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(t=(e=Deno.version)===null||e===void 0?void 0:e.deno)!==null&&t!==void 0?t:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":se,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(a==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":se,"X-Stainless-OS":Qt((r=globalThis.process.platform)!==null&&r!==void 0?r:"unknown"),"X-Stainless-Arch":Zt((s=globalThis.process.arch)!==null&&s!==void 0?s:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(o=globalThis.process.version)!==null&&o!==void 0?o:"unknown"};const i=Pn();return i?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":se,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${i.browser}`,"X-Stainless-Runtime-Version":i.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":se,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Pn(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:r}of e){const s=r.exec(navigator.userAgent);if(s){const o=s[1]||0,a=s[2]||0,i=s[3]||0;return{browser:t,version:`${o}.${a}.${i}`}}}return null}const Zt=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",Qt=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let _e;const jn=()=>_e??(_e=Un());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mn(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Tr(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function Fn(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return Tr({start(){},async pull(r){const{done:s,value:o}=await t.next();s?r.close():r.enqueue(o)},async cancel(){var r;await((r=t.return)===null||r===void 0?void 0:r.call(t))}})}function Nr(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const r=await t.read();return r!=null&&r.done&&t.releaseLock(),r}catch(r){throw t.releaseLock(),r}},async return(){const r=t.cancel();return t.releaseLock(),await r,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function Gn(e){var t,r;if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await((r=(t=e[Symbol.asyncIterator]()).return)===null||r===void 0?void 0:r.call(t));return}const s=e.getReader(),o=s.cancel();s.releaseLock(),await o}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Vn=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const br=()=>{var e;if(typeof File>"u"){const{process:t}=globalThis,r=typeof((e=t==null?void 0:t.versions)===null||e===void 0?void 0:e.node)=="string"&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(r?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function we(e,t,r){return br(),new File(e,t??"unknown_file",r)}function kn(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const Hn=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ar=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",Bn=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&Ar(e),Yn=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function $n(e,t,r){if(br(),e=await e,Bn(e))return e instanceof File?e:we([await e.arrayBuffer()],e.name);if(Yn(e)){const o=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),we(await Fe(o),t,r)}const s=await Fe(e);if(t||(t=kn(e)),!(r!=null&&r.type)){const o=s.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof o=="string"&&(r=Object.assign(Object.assign({},r),{type:o}))}return we(s,t,r)}async function Fe(e){var t,r,s,o,a;let i=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)i.push(e);else if(Ar(e))i.push(e instanceof Blob?e:await e.arrayBuffer());else if(Hn(e))try{for(var l=!0,u=ae(e),f;f=await u.next(),t=f.done,!t;l=!0){o=f.value,l=!1;const c=o;i.push(...await Fe(c))}}catch(c){r={error:c}}finally{try{!l&&!t&&(s=u.return)&&await s.call(u)}finally{if(r)throw r.error}}else{const c=(a=e==null?void 0:e.constructor)===null||a===void 0?void 0:a.name;throw new Error(`Unexpected data type: ${typeof e}${c?`; constructor: ${c}`:""}${Kn(e)}`)}return i}function Kn(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(r=>`"${r}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gr{constructor(t){this._client=t}}gr._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function mr(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const er=Object.freeze(Object.create(null)),Jn=(e=mr)=>(function(r,...s){if(r.length===1)return r[0];let o=!1;const a=[],i=r.reduce((c,_,h)=>{var d,I,T;/[?#]/.test(_)&&(o=!0);const E=s[h];let g=(o?encodeURIComponent:e)(""+E);return h!==s.length&&(E==null||typeof E=="object"&&E.toString===((T=Object.getPrototypeOf((I=Object.getPrototypeOf((d=E.hasOwnProperty)!==null&&d!==void 0?d:er))!==null&&I!==void 0?I:er))===null||T===void 0?void 0:T.toString))&&(g=E+"",a.push({start:c.length+_.length,length:g.length,error:`Value of type ${Object.prototype.toString.call(E).slice(8,-1)} is not a valid path parameter`})),c+_+(h===s.length?"":g)},""),l=i.split(/[?#]/,1)[0],u=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let f;for(;(f=u.exec(l))!==null;)a.push({start:f.index,length:f[0].length,error:`Value "${f[0]}" can't be safely passed as a path parameter`});if(a.sort((c,_)=>c.start-_.start),a.length>0){let c=0;const _=a.reduce((h,d)=>{const I=" ".repeat(d.start-c),T="^".repeat(d.length);return c=d.start+d.length,h+I+T},"");throw new B(`Path parameters result in path with invalid segments:
${a.map(h=>h.error).join(`
`)}
${i}
${_}`)}return i}),he=Jn(mr);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Or extends gr{create(t,r){var s;const{api_version:o=this._client.apiVersion}=t,a=Ne(t,["api_version"]);if("model"in a&&"agent_config"in a)throw new B("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in a&&"generation_config"in a)throw new B("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(he`/${o}/interactions`,Object.assign(Object.assign({body:a},r),{stream:(s=t.stream)!==null&&s!==void 0?s:!1}))}delete(t,r={},s){const{api_version:o=this._client.apiVersion}=r??{};return this._client.delete(he`/${o}/interactions/${t}`,s)}cancel(t,r={},s){const{api_version:o=this._client.apiVersion}=r??{};return this._client.post(he`/${o}/interactions/${t}/cancel`,s)}get(t,r={},s){var o;const a=r??{},{api_version:i=this._client.apiVersion}=a,l=Ne(a,["api_version"]);return this._client.get(he`/${i}/interactions/${t}`,Object.assign(Object.assign({query:l},s),{stream:(o=r==null?void 0:r.stream)!==null&&o!==void 0?o:!1}))}}Or._key=Object.freeze(["interactions"]);class Sr extends Or{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zn(e){let t=0;for(const o of e)t+=o.length;const r=new Uint8Array(t);let s=0;for(const o of e)r.set(o,s),s+=o.length;return r}let Ie;function Ve(e){let t;return(Ie??(t=new globalThis.TextEncoder,Ie=t.encode.bind(t)))(e)}let pe;function tr(e){let t;return(pe??(t=new globalThis.TextDecoder,pe=t.decode.bind(t)))(e)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ge{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(t){if(t==null)return[];const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?Ve(t):t;this.buffer=zn([this.buffer,r]);const s=[];let o;for(;(o=Wn(this.buffer,this.carriageReturnIndex))!=null;){if(o.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=o.index;continue}if(this.carriageReturnIndex!=null&&(o.index!==this.carriageReturnIndex+1||o.carriage)){s.push(tr(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const a=this.carriageReturnIndex!==null?o.preceding-1:o.preceding,i=tr(this.buffer.subarray(0,a));s.push(i),this.buffer=this.buffer.subarray(o.index),this.carriageReturnIndex=null}return s}flush(){return this.buffer.length?this.decode(`
`):[]}}ge.NEWLINE_CHARS=new Set([`
`,"\r"]);ge.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Wn(e,t){for(let o=t??0;o<e.length;o++){if(e[o]===10)return{preceding:o,index:o+1,carriage:!1};if(e[o]===13)return{preceding:o,index:o+1,carriage:!0}}return null}function Xn(e){for(let s=0;s<e.length-1;s++){if(e[s]===10&&e[s+1]===10||e[s]===13&&e[s+1]===13)return s+2;if(e[s]===13&&e[s+1]===10&&s+3<e.length&&e[s+2]===13&&e[s+3]===10)return s+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const be={off:0,error:200,warn:300,info:400,debug:500},rr=(e,t,r)=>{if(e){if(yn(be,e))return e;V(r).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(be))}`)}};function ue(){}function xe(e,t,r){return!t||be[e]>be[r]?ue:t[e].bind(t)}const qn={error:ue,warn:ue,info:ue,debug:ue};let nr=new WeakMap;function V(e){var t;const r=e.logger,s=(t=e.logLevel)!==null&&t!==void 0?t:"off";if(!r)return qn;const o=nr.get(r);if(o&&o[0]===s)return o[1];const a={error:xe("error",r,s),warn:xe("warn",r,s),info:xe("info",r,s),debug:xe("debug",r,s)};return nr.set(r,[s,a]),a}const ee=e=>(e.options&&(e.options=Object.assign({},e.options),delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,r])=>[t,t.toLowerCase()==="x-goog-api-key"||t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":r]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oe{constructor(t,r,s){this.iterator=t,this.controller=r,this.client=s}static fromSSEResponse(t,r,s){let o=!1;const a=s?V(s):console;function i(){return fe(this,arguments,function*(){var u,f,c,_;if(o)throw new B("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let h=!1;try{try{for(var d=!0,I=ae(Zn(t,r)),T;T=yield w(I.next()),u=T.done,!u;d=!0){_=T.value,d=!1;const E=_;if(!h)if(E.data.startsWith("[DONE]")){h=!0;continue}else try{yield yield w(JSON.parse(E.data))}catch(g){throw a.error("Could not parse message into JSON:",E.data),a.error("From chunk:",E.raw),g}}}catch(E){f={error:E}}finally{try{!d&&!u&&(c=I.return)&&(yield w(c.call(I)))}finally{if(f)throw f.error}}h=!0}catch(E){if(Ue(E))return yield w(void 0);throw E}finally{h||r.abort()}})}return new oe(i,r,s)}static fromReadableStream(t,r,s){let o=!1;function a(){return fe(this,arguments,function*(){var u,f,c,_;const h=new ge,d=Nr(t);try{for(var I=!0,T=ae(d),E;E=yield w(T.next()),u=E.done,!u;I=!0){_=E.value,I=!1;const g=_;for(const D of h.decode(g))yield yield w(D)}}catch(g){f={error:g}}finally{try{!I&&!u&&(c=T.return)&&(yield w(c.call(T)))}finally{if(f)throw f.error}}for(const g of h.flush())yield yield w(g)})}function i(){return fe(this,arguments,function*(){var u,f,c,_;if(o)throw new B("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");o=!0;let h=!1;try{try{for(var d=!0,I=ae(a()),T;T=yield w(I.next()),u=T.done,!u;d=!0){_=T.value,d=!1;const E=_;h||E&&(yield yield w(JSON.parse(E)))}}catch(E){f={error:E}}finally{try{!d&&!u&&(c=I.return)&&(yield w(c.call(I)))}finally{if(f)throw f.error}}h=!0}catch(E){if(Ue(E))return yield w(void 0);throw E}finally{h||r.abort()}})}return new oe(i,r,s)}[Symbol.asyncIterator](){return this.iterator()}tee(){const t=[],r=[],s=this.iterator(),o=a=>({next:()=>{if(a.length===0){const i=s.next();t.push(i),r.push(i)}return a.shift()}});return[new oe(()=>o(t),this.controller,this.client),new oe(()=>o(r),this.controller,this.client)]}toReadableStream(){const t=this;let r;return Tr({async start(){r=t[Symbol.asyncIterator]()},async pull(s){try{const{value:o,done:a}=await r.next();if(a)return s.close();const i=Ve(JSON.stringify(o)+`
`);s.enqueue(i)}catch(o){s.error(o)}},async cancel(){var s;await((s=r.return)===null||s===void 0?void 0:s.call(r))}})}}function Zn(e,t){return fe(this,arguments,function*(){var s,o,a,i;if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new B("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new B("Attempted to iterate over a response with no body");const l=new es,u=new ge,f=Nr(e.body);try{for(var c=!0,_=ae(Qn(f)),h;h=yield w(_.next()),s=h.done,!s;c=!0){i=h.value,c=!1;const d=i;for(const I of u.decode(d)){const T=l.decode(I);T&&(yield yield w(T))}}}catch(d){o={error:d}}finally{try{!c&&!s&&(a=_.return)&&(yield w(a.call(_)))}finally{if(o)throw o.error}}for(const d of u.flush()){const I=l.decode(d);I&&(yield yield w(I))}})}function Qn(e){return fe(this,arguments,function*(){var r,s,o,a;let i=new Uint8Array;try{for(var l=!0,u=ae(e),f;f=yield w(u.next()),r=f.done,!r;l=!0){a=f.value,l=!1;const c=a;if(c==null)continue;const _=c instanceof ArrayBuffer?new Uint8Array(c):typeof c=="string"?Ve(c):c;let h=new Uint8Array(i.length+_.length);h.set(i),h.set(_,i.length),i=h;let d;for(;(d=Xn(i))!==-1;)yield yield w(i.slice(0,d)),i=i.slice(d)}}catch(c){s={error:c}}finally{try{!l&&!r&&(o=u.return)&&(yield w(o.call(u)))}finally{if(s)throw s.error}}i.length>0&&(yield yield w(i))})}class es{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(t),t.startsWith(":"))return null;let[r,s,o]=ts(t,":");return o.startsWith(" ")&&(o=o.substring(1)),r==="event"?this.event=o:r==="data"&&this.data.push(o),null}}function ts(e,t){const r=e.indexOf(t);return r!==-1?[e.substring(0,r),t,e.substring(r+t.length)]:[e,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function rs(e,t){const{response:r,requestLogID:s,retryOfRequestLogID:o,startTime:a}=t,i=await(async()=>{var l;if(t.options.stream)return V(e).debug("response",r.status,r.url,r.headers,r.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(r,t.controller,e):oe.fromSSEResponse(r,t.controller,e);if(r.status===204)return null;if(t.options.__binaryResponse)return r;const u=r.headers.get("content-type"),f=(l=u==null?void 0:u.split(";")[0])===null||l===void 0?void 0:l.trim();return(f==null?void 0:f.includes("application/json"))||(f==null?void 0:f.endsWith("+json"))?await r.json():await r.text()})();return V(e).debug(`[${s}] response parsed`,ee({retryOfRequestLogID:o,url:r.url,status:r.status,body:i,durationMs:Date.now()-a})),i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ke extends Promise{constructor(t,r,s=rs){super(o=>{o(null)}),this.responsePromise=r,this.parseResponse=s,this.client=t}_thenUnwrap(t){return new ke(this.client,this.responsePromise,async(r,s)=>t(await this.parseResponse(r,s),s))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,r]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:r}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(this.client,t))),this.parsedPromise}then(t,r){return this.parse().then(t,r)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Rr=Symbol("brand.privateNullableHeaders");function*ns(e){if(!e)return;if(Rr in e){const{values:s,nulls:o}=e;yield*s.entries();for(const a of o)yield[a,null];return}let t=!1,r;e instanceof Headers?r=e.entries():qt(e)?r=e:(t=!0,r=Object.entries(e??{}));for(let s of r){const o=s[0];if(typeof o!="string")throw new TypeError("expected header name to be a string");const a=qt(s[1])?s[1]:[s[1]];let i=!1;for(const l of a)l!==void 0&&(t&&!i&&(i=!0,yield[o,null]),yield[o,l])}}const de=e=>{const t=new Headers,r=new Set;for(const s of e){const o=new Set;for(const[a,i]of ns(s)){const l=a.toLowerCase();o.has(l)||(t.delete(a),o.add(l)),i===null?(t.delete(a),r.add(l)):(t.append(a,i),r.delete(l))}}return{[Rr]:!0,values:t,nulls:r}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const De=e=>{var t,r,s,o,a,i;if(typeof globalThis.process<"u")return(s=(r=(t=An)===null||t===void 0?void 0:t[e])===null||r===void 0?void 0:r.trim())!==null&&s!==void 0?s:void 0;if(typeof globalThis.Deno<"u")return(i=(a=(o=globalThis.Deno.env)===null||o===void 0?void 0:o.get)===null||a===void 0?void 0:a.call(o,e))===null||i===void 0?void 0:i.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var vr;class me{constructor(t){var r,s,o,a,i,l,u,{baseURL:f=De("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:c=(r=De("GEMINI_API_KEY"))!==null&&r!==void 0?r:null,apiVersion:_="v1beta"}=t,h=Ne(t,["baseURL","apiKey","apiVersion"]);const d=Object.assign(Object.assign({apiKey:c,apiVersion:_},h),{baseURL:f||"https://generativelanguage.googleapis.com"});this.baseURL=d.baseURL,this.timeout=(s=d.timeout)!==null&&s!==void 0?s:me.DEFAULT_TIMEOUT,this.logger=(o=d.logger)!==null&&o!==void 0?o:console;const I="warn";this.logLevel=I,this.logLevel=(i=(a=rr(d.logLevel,"ClientOptions.logLevel",this))!==null&&a!==void 0?a:rr(De("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&i!==void 0?i:I,this.fetchOptions=d.fetchOptions,this.maxRetries=(l=d.maxRetries)!==null&&l!==void 0?l:2,this.fetch=(u=d.fetch)!==null&&u!==void 0?u:Mn(),this.encoder=Vn,this._options=d,this.apiKey=c,this.apiVersion=_,this.clientAdapter=d.clientAdapter}withOptions(t){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),t))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:r}){if(!(t.has("authorization")||t.has("x-goog-api-key"))&&!(this.apiKey&&t.get("x-goog-api-key"))&&!r.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(t){const r=de([t.headers]);if(!(r.values.has("authorization")||r.values.has("x-goog-api-key"))){if(this.apiKey)return de([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return de([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(t){return Object.entries(t).filter(([r,s])=>typeof s<"u").map(([r,s])=>{if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")return`${encodeURIComponent(r)}=${encodeURIComponent(s)}`;if(s===null)return`${encodeURIComponent(r)}=`;throw new B(`Cannot stringify type ${typeof s}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${se}`}defaultIdempotencyKey(){return`stainless-node-retry-${gn()}`}makeStatusError(t,r,s,o){return k.generate(t,r,s,o)}buildURL(t,r,s){const o=!this.baseURLOverridden()&&s||this.baseURL,a=On(t)?new URL(t):new URL(o+(o.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),i=this.defaultQuery();return vn(i)||(r=Object.assign(Object.assign({},i),r)),typeof r=="object"&&r&&!Array.isArray(r)&&(a.search=this.stringifyQuery(r)),a.toString()}async prepareOptions(t){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!t.path.startsWith(`/${this.apiVersion}/projects/`)){const r=t.path.slice(this.apiVersion.length+1);t.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${r}`}}async prepareRequest(t,{url:r,options:s}){}get(t,r){return this.methodRequest("get",t,r)}post(t,r){return this.methodRequest("post",t,r)}patch(t,r){return this.methodRequest("patch",t,r)}put(t,r){return this.methodRequest("put",t,r)}delete(t,r){return this.methodRequest("delete",t,r)}methodRequest(t,r,s){return this.request(Promise.resolve(s).then(o=>Object.assign({method:t,path:r},o)))}request(t,r=null){return new ke(this,this.makeRequest(t,r,void 0))}async makeRequest(t,r,s){var o,a,i;const l=await t,u=(o=l.maxRetries)!==null&&o!==void 0?o:this.maxRetries;r==null&&(r=u),await this.prepareOptions(l);const{req:f,url:c,timeout:_}=await this.buildRequest(l,{retryCount:u-r});await this.prepareRequest(f,{url:c,options:l});const h="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),d=s===void 0?"":`, retryOf: ${s}`,I=Date.now();if(V(this).debug(`[${h}] sending request`,ee({retryOfRequestLogID:s,method:l.method,url:c,options:l,headers:f.headers})),!((a=l.signal)===null||a===void 0)&&a.aborted)throw new je;const T=new AbortController,E=await this.fetchWithTimeout(c,f,_,T).catch(Pe),g=Date.now();if(E instanceof globalThis.Error){const P=`retrying, ${r} attempts remaining`;if(!((i=l.signal)===null||i===void 0)&&i.aborted)throw new je;const m=Ue(E)||/timed? ?out/i.test(String(E)+("cause"in E?String(E.cause):""));if(r)return V(this).info(`[${h}] connection ${m?"timed out":"failed"} - ${P}`),V(this).debug(`[${h}] connection ${m?"timed out":"failed"} (${P})`,ee({retryOfRequestLogID:s,url:c,durationMs:g-I,message:E.message})),this.retryRequest(l,r,s??h);throw V(this).info(`[${h}] connection ${m?"timed out":"failed"} - error; no more retries left`),V(this).debug(`[${h}] connection ${m?"timed out":"failed"} (error; no more retries left)`,ee({retryOfRequestLogID:s,url:c,durationMs:g-I,message:E.message})),m?new dr:new Ae({cause:E})}const D=`[${h}${d}] ${f.method} ${c} ${E.ok?"succeeded":"failed"} with status ${E.status} in ${g-I}ms`;if(!E.ok){const P=await this.shouldRetry(E);if(r&&P){const v=`retrying, ${r} attempts remaining`;return await Gn(E.body),V(this).info(`${D} - ${v}`),V(this).debug(`[${h}] response error (${v})`,ee({retryOfRequestLogID:s,url:E.url,status:E.status,headers:E.headers,durationMs:g-I})),this.retryRequest(l,r,s??h,E.headers)}const m=P?"error; no more retries left":"error; not retryable";V(this).info(`${D} - ${m}`);const U=await E.text().catch(v=>Pe(v).message),L=wn(U),G=L?void 0:U;throw V(this).debug(`[${h}] response error (${m})`,ee({retryOfRequestLogID:s,url:E.url,status:E.status,headers:E.headers,message:G,durationMs:Date.now()-I})),this.makeStatusError(E.status,L,G,E.headers)}return V(this).info(D),V(this).debug(`[${h}] response start`,ee({retryOfRequestLogID:s,url:E.url,status:E.status,headers:E.headers,durationMs:g-I})),{response:E,options:l,controller:T,requestLogID:h,retryOfRequestLogID:s,startTime:I}}async fetchWithTimeout(t,r,s,o){const a=r||{},{signal:i,method:l}=a,u=Ne(a,["signal","method"]);i&&i.addEventListener("abort",()=>o.abort());const f=setTimeout(()=>o.abort(),s),c=globalThis.ReadableStream&&u.body instanceof globalThis.ReadableStream||typeof u.body=="object"&&u.body!==null&&Symbol.asyncIterator in u.body,_=Object.assign(Object.assign(Object.assign({signal:o.signal},c?{duplex:"half"}:{}),{method:"GET"}),u);l&&(_.method=l.toUpperCase());try{return await this.fetch.call(void 0,t,_)}finally{clearTimeout(f)}}async shouldRetry(t){const r=t.headers.get("x-should-retry");return r==="true"?!0:r==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,r,s,o){var a;let i;const l=o==null?void 0:o.get("retry-after-ms");if(l){const f=parseFloat(l);Number.isNaN(f)||(i=f)}const u=o==null?void 0:o.get("retry-after");if(u&&!i){const f=parseFloat(u);Number.isNaN(f)?i=Date.parse(u)-Date.now():i=f*1e3}if(!(i&&0<=i&&i<60*1e3)){const f=(a=t.maxRetries)!==null&&a!==void 0?a:this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(r,f)}return await Dn(i),this.makeRequest(t,r-1,s)}calculateDefaultRetryTimeoutMillis(t,r){const a=r-t,i=Math.min(.5*Math.pow(2,a),8),l=1-Math.random()*.25;return i*l*1e3}async buildRequest(t,{retryCount:r=0}={}){var s,o,a;const i=Object.assign({},t),{method:l,path:u,query:f,defaultBaseURL:c}=i,_=this.buildURL(u,f,c);"timeout"in i&&Cn("timeout",i.timeout),i.timeout=(s=i.timeout)!==null&&s!==void 0?s:this.timeout;const{bodyHeaders:h,body:d}=this.buildBody({options:i}),I=await this.buildHeaders({options:t,method:l,bodyHeaders:h,retryCount:r});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:l,headers:I},i.signal&&{signal:i.signal}),globalThis.ReadableStream&&d instanceof globalThis.ReadableStream&&{duplex:"half"}),d&&{body:d}),(o=this.fetchOptions)!==null&&o!==void 0?o:{}),(a=i.fetchOptions)!==null&&a!==void 0?a:{}),url:_,timeout:i.timeout}}async buildHeaders({options:t,method:r,bodyHeaders:s,retryCount:o}){let a={};this.idempotencyHeader&&r!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=t.idempotencyKey);const i=await this.authHeaders(t);let l=de([a,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(o)},t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{}),jn()),this._options.defaultHeaders,s,t.headers,i]);return this.validateHeaders(l),l.values}buildBody({options:{body:t,headers:r}}){if(!t)return{bodyHeaders:void 0,body:void 0};const s=de([r]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&s.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:Fn(t)}:this.encoder({body:t,headers:s})}}me.DEFAULT_TIMEOUT=6e4;class j extends me{constructor(){super(...arguments),this.interactions=new Sr(this)}}vr=j;j.GeminiNextGenAPIClient=vr;j.GeminiNextGenAPIClientError=B;j.APIError=k;j.APIConnectionError=Ae;j.APIConnectionTimeoutError=dr;j.APIUserAbortError=je;j.NotFoundError=_r;j.ConflictError=hr;j.RateLimitError=pr;j.BadRequestError=ur;j.AuthenticationError=fr;j.InternalServerError=xr;j.PermissionDeniedError=Er;j.UnprocessableEntityError=Ir;j.toFile=$n;j.Interactions=Sr;class ss extends Error{constructor(t,r){super(t),this.name="ManualApiResponseError",this.prompt=r}}const os=()=>{throw new Error("API_KEY_MISSING")},as=e=>new Promise(t=>setTimeout(t,e));function is(e){let t=e.trim();const r=t.indexOf("```json");if(r!==-1){const c=r+7,_=t.lastIndexOf("```");if(_>c)return t.substring(c,_).trim()}const s=t.indexOf("```");if(s!==-1){const c=s+3,_=t.lastIndexOf("```");if(_>c)return t.substring(c,_).trim()}const o=t.indexOf("{"),a=t.indexOf("[");let i=-1;if(o===-1?i=a:a===-1?i=o:i=Math.min(o,a),i===-1)return t;const l=t.lastIndexOf("}"),u=t.lastIndexOf("]"),f=Math.max(l,u);return f>i?t.substring(i,f+1):t}function ls(e,t){if(!e)return t;const r=is(e);if(!r)return t;try{return JSON.parse(r)}catch(s){if(/[\u201C\u201D]/.test(r)){const i=r.replace(/"/g,'\\"').replace(/[\u201C\u201D]/g,'"');try{return JSON.parse(i)}catch{}}const o=r.replace(/[\u201C\u201D]/g,'"');try{return JSON.parse(o)}catch{}const a=o.replace(/,\s*([}\]])/g,"$1");try{return JSON.parse(a)}catch{if(/[\u201C\u201D]/.test(r)){const l=r.replace(/"/g,'\\"').replace(/[\u201C\u201D]/g,'"').replace(/,\s*([}\]])/g,"$1");try{return JSON.parse(l)}catch{}}return console.error("JSON Parse Failed:",s),t}}}const cs=()=>{const e=new Date().toISOString().split("T")[0];let t=rn("vocab_pro_api_usage",{count:0,date:"1970-01-01"});t.date!==e&&(t={count:0,date:e}),t.count+=1,nn("vocab_pro_api_usage",t),window.dispatchEvent(new CustomEvent("apiUsageUpdated"))};async function ds(e,t=3){var s;cs();let r;for(let o=0;o<=t;o++)try{return await os().models.generateContent(e)}catch(a){r=a;const i=((s=a.message)==null?void 0:s.toLowerCase())||"";if(i.includes("api_key_missing"))throw a;if(i.includes("429")||i.includes("quota")||i.includes("exhausted")||i.includes("503")){if(o<t){await as(Math.pow(2,o)*1e3);continue}throw new ss("API quota exceeded.",e.contents)}throw a}throw r}async function us(e){const t=tn(),r=lr(e),s=await ds({model:t.ai.modelForBasicTasks,contents:r,config:{responseMimeType:"application/json",responseSchema:{type:te.ARRAY,items:{type:te.OBJECT,properties:{v1:{type:te.STRING},v2:{type:te.STRING},v3:{type:te.STRING}},required:["v1","v2","v3"]}}}});return ls(s.text,[])}const xs=({user:e,onGlobalViewWord:t})=>{const[r,s]=N.useState([]),[o,a]=N.useState(!0),[i,l]=N.useState(!1),[u,f]=N.useState(null),[c,_]=N.useState(new Set),[h,d]=N.useState(!1),[I,T]=N.useState(!1),[E,g]=N.useState(!1),[D,P]=N.useState(null),[m,U]=N.useState("all"),[L,G]=N.useState(""),[Y,v]=N.useState(0),[y,M]=N.useState(15),[W,z]=N.useState(!1),[H,X]=N.useState(""),[q,Oe]=N.useState(new Map),{showToast:C}=sn(),Ee=async p=>{const A=new Map,b=[];for(const x of p){const O=x.v1.toLowerCase().trim();if(A.has(O)){const R=A.get(O),F=!!(R.v2&&R.v3),ce=!!(x.v2&&x.v3);let Z=!1;(ce&&!F||ce===F&&x.updatedAt>R.updatedAt)&&(Z=!0),Z?(b.push(R.id),A.set(O,x)):b.push(x.id)}else A.set(O,x)}return b.length>0&&(console.log(`[IrregularVerbs] Cleaning up ${b.length} duplicates...`),$e(b)),Array.from(A.values())},$=N.useCallback(async()=>{a(!0);const[p,A]=await Promise.all([on(e.id),an()]),b=await Ee(p);s(b.sort((O,R)=>O.v1.localeCompare(R.v1)));const x=new Map;A.forEach(O=>x.set(O.word.toLowerCase(),O)),Oe(x),a(!1)},[e.id]);N.useEffect(()=>{$()},[$]);const K=N.useMemo(()=>{if(!L.trim())return r;const p=L.toLowerCase().trim();return r.filter(A=>A.v1.toLowerCase().includes(p)||A.v2.toLowerCase().includes(p)||A.v3.toLowerCase().includes(p))},[r,L]),ie=N.useMemo(()=>{const p=Y*y;return K.slice(p,p+y)},[K,Y,y]),S=Math.ceil(K.length/y);N.useEffect(()=>{v(0)},[L,y]);const Q=N.useMemo(()=>r.filter(p=>c.has(p.id)&&(!p.v2||!p.v3)),[r,c]),Se=()=>{z(p=>!p)},le=p=>{f(p),l(!0)},J=async p=>{await un(p.id),C(`Deleted "${p.v1}".`,"success"),await $(),_(A=>{const b=new Set(A);return b.delete(p.id),b})},re=async p=>{const A=Date.now(),b=p.v1.trim().toLowerCase();try{if(u){const x={...u,...p,v1:b,updatedAt:A};await ye(x),C("Verb updated!","success")}else{const x={id:`iv-${A}`,userId:e.id,...p,v1:b,createdAt:A,updatedAt:A};await ye(x),C("Verb created!","success")}l(!1),await $()}catch(x){C(x.message||"Failed to save verb.","error")}},yr=async()=>{c.size!==0&&(d(!0),await $e(Array.from(c)),C(`Deleted ${c.size} verbs.`,"success"),_(new Set),await $(),d(!1))},Cr=async p=>{const A=Ye(H);if(A.length!==0){d(!0);try{let b=[];const x=Date.now(),O=new Map(r.map(R=>[R.v1.toLowerCase(),R]));if(p){const R=await us(A);for(const F of R){const ce=F.v1.toLowerCase(),Z=O.get(ce);if(Z){const Vr=!Z.v2||!Z.v3,kr=F.v2&&F.v3;if(Vr&&kr){const Hr={...Z,v2:F.v2,v3:F.v3,updatedAt:x};b.push(Hr)}}else b.push({id:`iv-${x}-${Math.random()}`,userId:e.id,v1:ce,v2:F.v2,v3:F.v3,createdAt:x,updatedAt:x})}}else A.forEach(R=>{const F=R.toLowerCase().trim();O.has(F)||(b.push({id:`iv-${x}-${Math.random()}`,userId:e.id,v1:F,v2:"",v3:"",createdAt:x,updatedAt:x}),O.set(F,b[b.length-1]))});b.length>0?(await Ce(b),C(`Processed ${b.length} verb(s) (Added or Updated).`,"success"),X(""),z(!1),await $()):C("No new or better verbs to add.","info")}catch(b){C(b.message||"Failed to add verbs.","error")}finally{d(!1)}}},wr=async()=>{if(c.size===0)return;d(!0);const p=r.filter(b=>c.has(b.id)),A=[];for(const b of p)if(!q.has(b.v1.toLowerCase())){const x=cn(b.v1,"","","","",["irregular-verb"]);x.userId=e.id,x.isIrregular=!0,A.push(x)}A.length>0?(await dn(A),C(`Added ${A.length} new verbs to your library.`,"success"),await $()):C("Selected verbs are already in your library.","info"),d(!1),_(new Set)},Dr=()=>{if(c.size===0){C("Please select verbs to refine.","info");return}if(Q.length===0){C("All selected verbs are already complete.","info");return}T(!0)},Lr=async p=>{T(!1),d(!0);try{if(!Array.isArray(p))throw new Error("AI response was not in the expected array format.");const A=new Map(p.map(x=>[x.v1.toLowerCase(),x])),b=Q.map(x=>{const O=A.get(x.v1.toLowerCase());return O?{...x,v2:O.v2,v3:O.v3,updatedAt:Date.now()}:null}).filter(x=>x!==null);b.length>0?(await Ce(b),C(`Refined ${b.length} verbs.`,"success"),await $()):C("AI could not refine the selected verbs.","info")}catch(A){C(A.message||"AI refinement failed.","error")}finally{d(!1),_(new Set)}},Ur=()=>{if(c.size===0){C("Please select verbs to practice.","info");return}U(r.filter(p=>c.has(p.id))),g(!0)},Pr=()=>{if(r.length===0){C("There are no verbs to practice.","info");return}U("all"),g(!0)},jr=(p,A)=>{const b=m==="all"?r:m;let x=b,O="headword";if(A&&(x=x.filter(R=>R.lastTestResult!=="pass")),p==="quick_forgot"?(x=b.filter(R=>R.lastTestResult==="fail"),O="quick"):p==="quick_all"||p==="quick"?(x=b,O="quick"):O=p,x.length===0){C(p==="quick_forgot"?"No forgotten verbs in this selection.":A?"No unlearned verbs in this selection.":"No verbs available for this practice session.","info");return}P({verbs:x,mode:O}),g(!1)},Mr=async p=>{const A=Date.now(),x=r.map(O=>{const R=p.find(F=>F.verbId===O.id);return R?{...O,lastTestResult:R.result,lastTestTimestamp:A,lastTestIncorrectForms:R.result==="fail"?R.incorrectForms:void 0}:O}).filter(O=>p.some(R=>R.verbId===O.id));x.length>0&&await Ce(x),P(null),_(new Set),$()},Fr=async(p,A)=>{const b=Date.now(),x={...p,lastTestResult:A,lastTestTimestamp:b,lastTestIncorrectForms:A==="fail"?["v2","v3"]:void 0};try{await ye(x),s(O=>O.map(R=>R.id===p.id?x:R)),C(`Marked "${p.v1}" as ${A==="pass"?"Known":"Forgot"}.`,"success")}catch{C("Failed to update status.","error")}},Gr=N.useMemo(()=>m==="all"?r:m,[m,r]);return n.jsxs(n.Fragment,{children:[n.jsx(Tn,{loading:o,verbs:ie,totalCount:K.length,searchQuery:L,onSearchChange:G,page:Y,pageSize:y,onPageSizeChange:M,totalPages:S,onPageChange:v,isModalOpen:i,editingVerb:u,selectedIds:c,setSelectedIds:_,isProcessing:h,libraryWords:q,onGlobalViewWord:t,onNew:Se,onEdit:le,onDelete:J,onSave:re,onCloseModal:()=>l(!1),onBulkDelete:yr,onAddToLibrary:wr,onRefine:Dr,onPractice:Ur,onPracticeAll:Pr,isPracticeSetupOpen:E,onClosePracticeSetup:()=>g(!1),onStartPractice:jr,isAddPanelOpen:W,addInput:H,onAddInputChange:X,onBulkAdd:Cr,onQuickSetStatus:Fr,practiceVerbs:Gr}),D&&n.jsx(bn,{verbs:D.verbs,mode:D.mode,onComplete:Mr,onExit:()=>P(null)}),I&&n.jsx(ln,{isOpen:I,onClose:()=>T(!1),type:"REFINE_WORDS",title:"Refine Irregular Verbs",description:`Generating V2 & V3 for ${Q.length} selected verb(s).`,initialData:{words:Q.map(p=>p.v1).join("; ")},hidePrimaryInput:!0,onGeneratePrompt:p=>lr(Ye(p.words)),onJsonReceived:Lr,actionLabel:"Update Verbs"})]})};export{xs as default};
