import{r as n,t as je,j as e,A as ce,q as re,i as ke,s as at,ac as ot,a2 as Ce,P as de,E as it,D as Ne,ae as Te,m as ye,G as lt,a0 as rt,bH as ct,bI as dt,aj as Y,ak as ut,_ as be,al as we,l as pt,am as ht,bJ as J,bK as q,bL as xt,bM as gt}from"./index-BiveeiWw.js";import{R as mt,a as ft}from"./ResourceActions-B4woXiNm.js";import{T as bt}from"./TagBrowser-DOOqQcmr.js";import{U as wt}from"./UniversalCard-86YUmIV4.js";import{p as Le}from"./markdownParser-NDCOwRTZ.js";import{u as vt,G as St,S as ve,V as jt}from"./ShelfSearchBar-B_baSwj7.js";import{F as kt,U as Ct,a as Nt,M as Tt,A as yt,R as Lt}from"./ShelfModals-LgdELrWk.js";import{M as At}from"./move-Bzko-Lqy.js";import{P as It}from"./pen-DVY228s7.js";import{L as Et}from"./library-DtjaNoDI.js";import{F as Rt}from"./file-clock-ChURmCXu.js";import"./search-AS0O4GL7.js";import"./chevron-left-NqfRbzA1.js";import"./circle-Chc6sVgt.js";import"./palette-pqXMOdHM.js";import"./square-check-big-HbIjuC7l.js";function Ae(a){const{topic:w,currentLesson:h,userRequest:y,language:r,targetAudience:k,tone:C,coachName:v}=a,E=r==="Vietnamese"?"Audio-VN":"Audio-EN",f=!!h;let u="",N="";return f&&h?(u="Refine and reformat the user's lesson notes into a structured, high-quality study resource.",N=`
    CURRENT CONTENT:
    Title: ${h.title}
    Description: ${h.description}
    Body:
    ${h.content||"(empty)"}
    
    USER INSTRUCTIONS: "${y||"Format deeply, improve structure, correct errors, and add educational value."}"
    `):(u=`Create a brand new lesson for a ${k} on topic: "${w||"General Knowledge"}".`,N=`USER REQUEST: "${y||"Create a comprehensive lesson."}"`),`You are an expert educational content designer and IELTS coach.
  ROLE: You are '${v}', acting as a ${C==="friendly_elementary"?"friendly teacher":"professional professor"}.
    
  TASK: ${u}

  ${N}

  STRICT LANGUAGE RULES:
  1. CORE MATERIAL (Vocabulary Lists, Example Sentences, Exercises): Must be in English.
  2. META CONTENT (Greetings, CONCEPT DEFINITIONS, Explanations, Strategy Tips): In ${r}.

  FORMATTING RULES (CRITICAL):
  - **VOCAB LISTS**: List simple words on a SINGLE line separated by commas.
  - **NUMBERED LISTS**: Use sequential numbering (e.g., 1., 2., 3.) for ordered lists.
  - **DEFINITIONS**: Treat definitions as explanations. They MUST be spoken in ${r}.
  - **CONCISE TITLE**: Keep the title short and direct.
  - **TITLE OVERRIDE RULE**: If it's a pattern, use the BASE form (e.g., "be associated with", not "is associated with").
  - **COMPACT SPACING**: Keep the text dense. No extra empty lines between headings and content.

  INTERACTIVE ELEMENTS SYNTAX:
  1. **Hidden Answer**: Use \`[HIDDEN: content]\` for answers that should be hidden initially.
  2. **Tips**: Use \`[Content]\` (text inside brackets on a NEW LINE) for tips and notes.
  3. **Fill-in Quiz**: Use \`[Quiz: answer]\` for a text input field checking against 'answer'.
  4. **Multiple Choice**: Use \`[Multi: Correct Answer | Wrong Option | Wrong Option]\`. The FIRST option provided must be the correct one. The system will shuffle them automatically.
  5. **Dropdown Select**: Use \`[Select: Correct Answer | Wrong Option | Wrong Option]\`. It renders as a dropdown menu. The FIRST option provided must be the correct one. The system will shuffle them automatically. Use this for "Fill in the blank" exercises where you want to give hints.

  AUDIO BLOCK RULE (TOKEN SAVER - CRITICAL):
  - **WRAP ONLY META CONTENT**: Only wrap your explanations, greetings, and definitions inside \`[${E}]\` and \`[/]\`.
  - **EXCLUDE CORE MATERIAL**: Do NOT wrap vocabulary lists, exercises, or headers (##) inside audio tags.
  
  EXAMPLE OF CORRECT STRUCTURE:
    ## Key Concepts
    [${E}]
    ${r==="Vietnamese"?"ChÃ o con! HÃ´m nay chÃºng mÃ¬nh sáº½ há»c vá»...":"Hello! Today we will learn about..."}
    [/]
    [Make sure to practice these daily!]
    * Word1, Word2, Word3
    
    1. Select the correct word:
    [Multi: Apple | Car | Sky]
    
    2. Type the missing word:
    The sky is [Quiz: blue].
    
    3. Choose the best fit:
    The ocean is [Select: deep | high | tall].

  TAGGING (STRICT): Return exactly ONE tag from: ["Writing", "Speaking", "Listening", "Reading", "Grammar", "Writing Task 1", "Writing Task 2", "Speaking Academic", "Speaking Casual", "Pattern", "Comparison"].

  STRICT JSON OUTPUT FORMAT:
  {
    "title": "string",
    "description": "string",
    "content": "string (Markdown using the tags defined above)",
    "tags": ["string"]
  }`}const Ot=a=>{const{title:w,setTitle:h,description:y,setDescription:r,tagsInput:k,setTagsInput:C,content:v,setContent:E,isSaving:f,onSave:u,onPractice:N,onCancel:L,onOpenAiRefine:P}=a,[R,$]=n.useState(!1),b=n.useMemo(()=>Le(v),[v]);return n.useEffect(()=>(window.handleLessonSpeak=x=>{je(x)},()=>{delete window.handleLessonSpeak}),[]),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 animate-in fade-in duration-300 pb-20",children:[e.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("button",{onClick:L,className:"flex items-center space-x-2 text-sm font-bold text-neutral-400 hover:text-neutral-900 transition-colors mb-1",children:[e.jsx(ce,{size:16}),e.jsx("span",{children:"Back to Lesson Library"})]}),e.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:"Edit Lesson"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:N,disabled:f,className:"px-5 py-3 bg-white border border-neutral-200 text-neutral-600 rounded-xl font-black text-xs flex items-center space-x-2 transition-all hover:bg-neutral-50 active:scale-95 uppercase tracking-widest shadow-sm",children:[e.jsx(re,{size:14}),e.jsx("span",{children:"Read Mode"})]}),e.jsxs("button",{onClick:P,className:"px-5 py-3 bg-white border border-neutral-200 text-neutral-600 rounded-xl font-black text-xs flex items-center space-x-2 transition-all hover:bg-neutral-50 active:scale-95 uppercase tracking-widest shadow-sm",children:[e.jsx(ke,{size:14,className:"text-amber-500"}),e.jsx("span",{children:"AI Refine"})]}),e.jsxs("button",{onClick:u,disabled:f,className:"px-6 py-3 bg-neutral-900 text-white rounded-xl font-black text-xs flex items-center space-x-2 transition-all active:scale-95 hover:bg-neutral-800 disabled:opacity-50 uppercase tracking-widest shadow-sm",children:[f?e.jsx(at,{size:14,className:"animate-spin"}):e.jsx(ot,{size:14}),e.jsx("span",{children:f?"Saving...":"Save Lesson"})]})]})]}),e.jsxs("div",{className:"space-y-6 bg-white p-8 rounded-3xl border border-neutral-200 shadow-sm",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Lesson Title"}),e.jsx("input",{type:"text",value:w,onChange:x=>h(x.target.value),className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-lg font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[e.jsx(Ce,{size:12})," Tags (Keywords)"]}),e.jsx("input",{type:"text",value:k,onChange:x=>C(x.target.value),placeholder:"e.g. Grammar, Writing Task 2",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-neutral-900 outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-1",children:"Short Description"}),e.jsx("textarea",{value:y,onChange:x=>r(x.target.value),rows:2,className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm leading-relaxed resize-y focus:ring-2 focus:ring-neutral-900 outline-none"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Content (Markdown)"}),e.jsxs("button",{onClick:()=>$(!R),className:"flex items-center space-x-1.5 px-3 py-1.5 rounded-lg bg-white border border-neutral-200 hover:bg-neutral-50 transition-all text-[10px] font-black uppercase text-neutral-500 hover:text-neutral-900 shadow-sm",children:[R?e.jsx(de,{size:12}):e.jsx(it,{size:12}),e.jsx("span",{children:R?"Edit":"Preview"})]})]}),e.jsx("div",{className:"bg-white border border-neutral-200 rounded-2xl shadow-sm h-[600px] relative overflow-hidden",children:R?e.jsx("div",{className:"p-6 prose prose-sm max-w-none prose-headings:font-black prose-p:text-neutral-600 prose-img:rounded-xl prose-img:shadow-md prose-strong:text-neutral-900 prose-a:text-indigo-600 overflow-y-auto absolute inset-0 bg-neutral-50/30",dangerouslySetInnerHTML:{__html:b}}):e.jsx("textarea",{value:v,onChange:x=>E(x.target.value),className:"absolute inset-0 w-full h-full p-6 resize-none focus:outline-none text-sm leading-relaxed font-medium text-neutral-900 bg-white font-mono",placeholder:`# Lesson Heading

Write your lesson content here using Markdown...`,spellCheck:!1})})]})]})]})},Mt=({lesson:a,user:w,onSave:h,onPractice:y,onCancel:r})=>{const[k,C]=n.useState(a.title),[v,E]=n.useState(a.description||""),[f,u]=n.useState(a.path||"/"),[N,L]=n.useState((a.tags||[]).join(", ")),[P,R]=n.useState(a.content),[$,b]=n.useState(!1),[x,S]=n.useState(!1),{showToast:Q}=Ne(),g=a.topic1,G=a.topic2;n.useEffect(()=>{if(a.path===void 0&&a.tags){const c=a.tags||[],T=c.find(A=>A.startsWith("/")),l=c.filter(A=>!A.startsWith("/"));u(T||"/"),L(l.join(", "))}else u(a.path||"/"),L((a.tags||[]).join(", "))},[a]);const O=()=>{const c=N.split(",").map(T=>T.trim()).filter(Boolean);return{...a,title:k,description:v,topic1:g,topic2:G,path:f.trim(),tags:c,content:P,updatedAt:Date.now()}},K=()=>{b(!0);const c=O();h(c)},V=()=>{b(!0);const c=O();y(c)},H=c=>{var j,p,B;const T=ye(),l=T.audioCoach.activeCoach,A=T.audioCoach.coaches[l].name;return Ae({currentLesson:{title:k,description:v,content:P},userRequest:c.request,language:((j=w.lessonPreferences)==null?void 0:j.language)||"English",targetAudience:((p=w.lessonPreferences)==null?void 0:p.targetAudience)||"Adult",tone:((B=w.lessonPreferences)==null?void 0:B.tone)||"professional_professor",coachName:A})},F=c=>{C(c.title),E(c.description),R(c.content),!N.trim()&&c.tags&&c.tags.length>0&&L(c.tags.join(", ")),S(!1),Q("Lesson content refined!","success")};return e.jsxs(e.Fragment,{children:[e.jsx(Ot,{title:k,setTitle:C,description:v,setDescription:E,path:f,setPath:u,tagsInput:N,setTagsInput:L,content:P,setContent:R,isSaving:$,onSave:K,onPractice:V,onCancel:r,onOpenAiRefine:()=>S(!0)}),x&&e.jsx(Te,{isOpen:x,onClose:()=>S(!1),type:"REFINE_UNIT",title:"Refine Lesson Content",description:"AI will format your notes into Markdown, fix errors, and add structure.",onGeneratePrompt:H,onJsonReceived:F,actionLabel:"Apply Changes"})]})},Ft=({lesson:a,onComplete:w,onEdit:h})=>{const y=n.useMemo(()=>Le(a.content),[a.content]);return n.useEffect(()=>(window.handleLessonSpeak=r=>{je(r)},()=>{delete window.handleLessonSpeak}),[]),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 pb-20 animate-in fade-in duration-300",children:[e.jsxs("header",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("button",{onClick:w,className:"w-fit flex items-center space-x-2 text-xs font-bold text-neutral-400 hover:text-neutral-900 transition-colors uppercase tracking-wider",children:[e.jsx(ce,{size:14}),e.jsx("span",{children:"Back to Library"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:a.title}),a.description&&e.jsx("p",{className:"text-neutral-500 font-medium",children:a.description})]})]}),e.jsx("button",{onClick:h,className:"p-2.5 bg-white border border-neutral-200 text-neutral-600 rounded-xl hover:bg-neutral-50 hover:text-neutral-900 transition-all shadow-sm active:scale-95",title:"Edit Lesson",children:e.jsx(de,{size:18})})]}),e.jsx("div",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm min-h-[400px]",children:e.jsx("div",{className:"prose prose-sm max-w-none prose-headings:font-black prose-headings:text-neutral-900 prose-p:text-neutral-600 prose-p:leading-relaxed prose-img:rounded-xl prose-img:shadow-md prose-strong:text-neutral-900 prose-a:text-indigo-600",dangerouslySetInnerHTML:{__html:y}})})]})},Bt=({lesson:a,onComplete:w,onEdit:h})=>e.jsx(Ft,{lesson:a,onComplete:w,onEdit:h}),Dt={filterSchema:[],viewSchema:[]},Se="vocab_pro_lesson_view_settings",es=({user:a,onStartSession:w,onNavigate:h,onUpdateUser:y})=>{var me;const[r,k]=n.useState([]),[C,v]=n.useState([]),[E,f]=n.useState(!0),[u,N]=n.useState(null),[L,P]=n.useState(!1),[R,$]=n.useState(!1),[b,x]=n.useState("ALL"),[S,Q]=n.useState("all"),[g,G]=n.useState("all"),[O,K]=n.useState(()=>lt(Se,{showDesc:!0,compact:!1})),[V,H]=n.useState(0),[F,c]=n.useState(12),[T,l]=n.useState("list"),[A,j]=n.useState(null),[p,B]=n.useState(null),[X,Z]=n.useState(null),[U,ee]=n.useState(null),[Ie,te]=n.useState(!1),{currentShelfName:se,booksOnCurrentShelf:ne,allShelves:W,addShelf:Ee,renameShelf:Re,removeShelf:Oe,nextShelf:Me,prevShelf:Fe,selectShelf:Be}=vt(C,"lesson_books_shelves"),[De,ae]=n.useState(!1),[Pe,oe]=n.useState(!1),[M,ie]=n.useState(null),{showToast:z}=Ne();n.useEffect(()=>{rt(Se,O)},[O]);const I=n.useCallback(async()=>{f(!0);try{const[t,s]=await Promise.all([ct(a.id),dt(a.id)]),i=[...t.map(o=>({type:"ESSAY",data:o,path:o.path,tags:o.tags,date:o.createdAt}))];k(i.sort((o,d)=>d.date-o.date)),v(s.sort((o,d)=>d.createdAt-o.createdAt))}finally{f(!1)}},[a.id]);n.useEffect(()=>{I()},[I]),n.useEffect(()=>{H(0)},[u,b,S,g,F]);const ze=n.useMemo(()=>b!=="ALL"||S!=="all"||g!=="all",[b,S,g]),D=n.useMemo(()=>r.filter(t=>{var s,i;if(b!=="ALL"&&t.type!==b||S==="focused"&&!t.data.isFocused||g!=="all"&&t.data.focusColor!==g)return!1;if(u){if(u==="Uncategorized"){const o=t.path??(t.tags||[]).find(m=>m.startsWith("/"));if(o&&o!=="/")return!1}else if(!((s=t.path)!=null&&s.startsWith(u))&&!((i=t.tags)!=null&&i.includes(u)))return!1}return!0}),[r,u,b,S,g]),Ue=n.useMemo(()=>{const t=V*F;return D.slice(t,t+F)},[D,V,F]),_e=t=>{Re(t,async(i,o)=>{f(!0);const d=C.filter(m=>{const _=m.title.split(":");return(_.length>1?_[0].trim():"General")===i});await Promise.all(d.map(m=>{const _=m.title.split(":"),fe=_.length>1?_.slice(1).join(":").trim():_[0],nt=`${o}: ${fe}`;return q({...m,title:nt,updatedAt:Date.now()})})),await I()})&&oe(!1)},ue=async()=>{const t={id:`lb-${Date.now()}`,userId:a.id,title:`${se}: New Book`,itemIds:[],createdAt:Date.now(),updatedAt:Date.now(),color:"#1a237e",icon:"ðŸ“˜"};await q(t),await I(),B(t),l("book_detail"),z("New book created.","success")},le=async t=>{if(!p)return;const s={...p,...t,updatedAt:Date.now()};v(i=>i.map(o=>o.id===s.id?s:o)),B(s),await q(s)},$e=async()=>{U&&(await xt(U.id),z("Book deleted.","success"),ee(null),await I())},Ge=async t=>{if(!M)return;const s=M.title.split(":"),i=s.length>1?s.slice(1).join(":").trim():s[0],o=`${t}: ${i}`,d={...M,title:o,updatedAt:Date.now()};await q(d),ie(null),await I(),z(`Moved to "${t}".`,"success")},Ve=async()=>{X&&(await gt(X.id),z("Lesson deleted.","success"),Z(null),I())},We=async t=>{await J(t),z("Lesson saved!","success"),l(p?"book_detail":"list"),j(null),I()},Ye=()=>{const t={id:`lesson-${Date.now()}`,userId:a.id,topic1:"",topic2:"",title:"New Lesson",description:"",content:"",tags:[],createdAt:Date.now(),updatedAt:Date.now()};j(t),l("edit_lesson")},Ke=async t=>{const{result:s,preferences:i}=t;JSON.stringify(a.lessonPreferences)!==JSON.stringify(i)&&await y({...a,lessonPreferences:i});const o={id:`lesson-ai-${Date.now()}`,userId:a.id,title:s.title,description:s.description,content:s.content,tags:s.tags||[],createdAt:Date.now(),updatedAt:Date.now(),topic1:"",topic2:""};await J(o),z("Lesson created with AI!","success"),te(!1),j(o),l("read_lesson"),I()},pe=async(t,s)=>{const i={...t.data,focusColor:s||void 0,updatedAt:Date.now()};s||delete i.focusColor,await J(i),k(o=>o.map(d=>d.data.id===t.data.id?{...d,data:{...d.data,focusColor:s||void 0,updatedAt:Date.now()}}:d))},he=async t=>{const s={...t.data,isFocused:!t.data.isFocused,updatedAt:Date.now()};await J(s),k(i=>i.map(o=>o.data.id===t.data.id?{...o,data:{...o.data,isFocused:!o.data.isFocused,updatedAt:Date.now()}}:o))},He=()=>{if(D.length===0){z("No items to randomize.","info");return}const t=D[Math.floor(Math.random()*D.length)];j(t.data),l("read_lesson")},Je=[{label:"AI Lesson",icon:ke,onClick:()=>te(!0)},{label:"New Lesson",icon:be,onClick:Ye}],qe=t=>{const s=window.CONFIG||ye(),i=s.audioCoach.activeCoach,o=s.audioCoach.coaches[i].name;return Ae({topic:t.topic,language:t.language,targetAudience:t.targetAudience,tone:t.tone,coachName:o})},Qe=n.useMemo(()=>p?p.itemIds.map(t=>{const s=r.find(i=>i.data.id===t);return s?{id:s.data.id,title:s.data.title,subtitle:"Lesson",data:s,focusColor:s.data.focusColor,isFocused:s.data.isFocused}:null}).filter(t=>t!==null):[],[p,r]),Xe=n.useMemo(()=>r.map(t=>({id:t.data.id,title:t.data.title,subtitle:"Lesson",data:t})),[r]),Ze=t=>{if(!p)return;const s=Array.from(new Set([...p.itemIds,...t]));le({itemIds:s})},et=t=>{if(!p)return;const s=p.itemIds.filter(i=>i!==t);le({itemIds:s})},tt=(t,s)=>{const i=t.data;pe(i,s)},st=t=>{const s=t.data;he(s)},xe=t=>{Be(t),l("shelf")},ge=t=>{B(t),l("book_detail")};return T==="read_lesson"&&A?e.jsx(Bt,{lesson:A,onComplete:()=>l(p?"book_detail":"list"),onEdit:()=>l("edit_lesson")}):T==="edit_lesson"&&A?e.jsx(Mt,{lesson:A,user:a,onSave:We,onPractice:t=>{j(t),l("read_lesson")},onCancel:()=>l(p?"book_detail":"list")}):T==="book_detail"&&p?e.jsx(St,{book:p,items:Qe,availableItems:Xe,onBack:()=>{B(null),l("shelf"),I()},onUpdateBook:le,onAddItem:Ze,onRemoveItem:et,onOpenItem:t=>{const s=t.data;j(s.data),l("read_lesson")},onEditItem:t=>{const s=t.data;j(s.data),l("edit_lesson")},onFocusChange:tt,onToggleFocus:st,itemIcon:e.jsx(re,{size:16})}):T==="shelf"?e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("button",{onClick:()=>l("list"),className:"w-fit flex items-center gap-2 text-sm font-bold text-neutral-400 hover:text-neutral-900 transition-colors group",children:[e.jsx(ce,{size:18,className:"group-hover:-translate-x-1 transition-transform"}),e.jsx("span",{children:"Back to Main Library"})]}),e.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:"Lesson Shelf"}),e.jsx("p",{className:"text-neutral-500 mt-1 font-medium",children:"Organize your knowledge."})]}),e.jsx(ve,{shelves:W,books:C,onNavigateShelf:xe,onNavigateBook:ge}),e.jsxs("button",{onClick:()=>ae(!0),className:"px-6 py-3 bg-white border border-neutral-200 text-neutral-600 rounded-xl font-black text-xs flex items-center gap-2 uppercase tracking-widest hover:bg-neutral-50 transition-all shadow-sm",children:[e.jsx(kt,{size:14})," Add Shelf"]})]})]}),e.jsxs(Ct,{label:se,onNext:W.length>1?Me:void 0,onPrev:W.length>1?Fe:void 0,actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>oe(!0),className:"p-2 bg-white/20 text-white/70 rounded-full hover:bg-white/40 hover:text-white",title:"Rename Shelf",children:e.jsx(It,{size:14})}),e.jsx("button",{onClick:Oe,disabled:ne.length>0,className:"p-2 bg-white/20 text-white/70 rounded-full hover:bg-white/40 hover:text-white disabled:opacity-30 disabled:hover:bg-white/20",title:"Remove Empty Shelf",children:e.jsx(Y,{size:14})})]}),isEmpty:ne.length===0,emptyAction:e.jsx("button",{onClick:ue,className:"px-6 py-3 bg-white/10 hover:bg-white/20 text-white rounded-xl font-bold text-xs uppercase tracking-widest border border-white/20",children:"Create First Book"}),children:[ne.map(t=>{const s=t.title,i=s.split(":"),o=i.length>1?i.slice(1).join(":").trim():s;return e.jsx(Nt,{id:t.id,title:o,subTitle:`${t.itemIds.length} Items`,icon:e.jsx(ut,{size:24}),color:t.color,titleColor:t.titleColor,titleSize:t.titleSize,titleTop:t.titleTop,titleLeft:t.titleLeft,iconTop:t.iconTop,iconLeft:t.iconLeft,onClick:()=>{B(t),l("book_detail")},actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:d=>{d.stopPropagation(),ie(t)},className:"p-1.5 bg-black/30 text-white/60 rounded-full hover:bg-neutral-700 hover:text-white transition-all shadow-sm",title:"Move to Shelf",children:e.jsx(At,{size:16})}),e.jsx("button",{onClick:d=>{d.stopPropagation(),ee(t)},className:"p-1.5 bg-black/30 text-white/60 rounded-full hover:bg-red-600 hover:text-white transition-all shadow-sm",title:"Delete",children:e.jsx(Y,{size:16})})]})},t.id)}),e.jsx("div",{className:"group [perspective:1000px] translate-y-0",children:e.jsx("div",{className:"relative w-full aspect-[5/7] rounded-lg bg-neutral-800/50 border-2 border-dashed border-neutral-500/50 transition-all duration-300 group-hover:border-neutral-400 group-hover:bg-neutral-800/80 group-hover:shadow-xl flex flex-col items-stretch justify-center overflow-hidden",children:e.jsxs("button",{onClick:ue,className:"flex-1 flex flex-col items-center justify-center p-2 text-center text-neutral-400 hover:bg-white/5 transition-colors",children:[e.jsx(be,{size:32,className:"mb-2 text-neutral-500"}),e.jsx("h3",{className:"font-sans text-xs font-black uppercase tracking-wider",children:"New Book"})]})})})]}),e.jsx(we,{isOpen:!!U,title:"Delete Book?",message:e.jsxs(e.Fragment,{children:["Are you sure you want to delete ",e.jsxs("strong",{children:['"',(me=U==null?void 0:U.title.split(":").pop())==null?void 0:me.trim(),'"']}),"? Items inside will not be deleted."]}),confirmText:"Delete",isProcessing:!1,onConfirm:$e,onClose:()=>ee(null),icon:e.jsx(Y,{size:40,className:"text-red-500"})}),e.jsx(Tt,{isOpen:!!M,onClose:()=>ie(null),onConfirm:Ge,shelves:W,currentShelf:M?M.title.split(":")[0].trim():"General",bookTitle:(M==null?void 0:M.title)||""}),e.jsx(yt,{isOpen:De,onClose:()=>ae(!1),onSave:t=>{Ee(t)&&ae(!1)}}),e.jsx(Lt,{isOpen:Pe,onClose:()=>oe(!1),onSave:_e,initialName:se})]}):e.jsxs(e.Fragment,{children:[e.jsx(mt,{title:"Knowledge Library",subtitle:"Your collection of lessons and comparisons.",icon:e.jsx("img",{src:"https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Objects/Notebook.png",className:"w-8 h-8 object-contain",alt:"Lessons"}),centerContent:e.jsx(ve,{shelves:W,books:C,onNavigateShelf:xe,onNavigateBook:ge}),minorSkills:e.jsxs("button",{onClick:()=>h("IRREGULAR_VERBS"),className:"flex items-center gap-2 px-3 py-2 bg-orange-50 text-orange-700 rounded-lg text-xs font-bold hover:bg-orange-100 transition-colors",children:[e.jsx(Rt,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Irregular Verbs"})]}),pagination:{page:V,totalPages:Math.ceil(D.length/F),onPageChange:H,pageSize:F,onPageSizeChange:c,totalItems:D.length},actions:e.jsx(ft,{viewMenu:e.jsx(jt,{isOpen:R,setIsOpen:$,hasActiveFilters:ze,filterOptions:[{label:"All",value:"ALL",isActive:b==="ALL",onClick:()=>x("ALL")},{label:"Lesson",value:"ESSAY",isActive:b==="ESSAY",onClick:()=>x("ESSAY")}],customSection:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-2 text-[9px] font-black text-neutral-400 uppercase tracking-widest border-b border-neutral-50 flex items-center gap-2",children:[e.jsx(ht,{size:10})," Focus & Status"]}),e.jsxs("div",{className:"p-1 flex flex-col gap-1 bg-neutral-100 rounded-xl mb-2",children:[e.jsx("button",{onClick:()=>Q(S==="all"?"focused":"all"),className:`w-full py-1.5 text-[9px] font-black rounded-lg transition-all ${S==="focused"?"bg-white shadow-sm text-red-600":"text-neutral-500 hover:text-neutral-700"}`,children:S==="focused"?"Focused Only":"All Items"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>G(g==="green"?"all":"green"),className:`flex-1 h-6 rounded-lg border-2 transition-all ${g==="green"?"bg-emerald-500 border-emerald-600":"bg-white border-neutral-200 hover:bg-emerald-50"}`}),e.jsx("button",{onClick:()=>G(g==="yellow"?"all":"yellow"),className:`flex-1 h-6 rounded-lg border-2 transition-all ${g==="yellow"?"bg-amber-400 border-amber-500":"bg-white border-neutral-200 hover:bg-amber-50"}`}),e.jsx("button",{onClick:()=>G(g==="red"?"all":"red"),className:`flex-1 h-6 rounded-lg border-2 transition-all ${g==="red"?"bg-rose-50 border-rose-600":"bg-white border-neutral-200 hover:bg-rose-50"}`})]})]})]}),viewOptions:[{label:"Show Description",checked:O.showDesc,onChange:()=>K(t=>({...t,showDesc:!t.showDesc}))},{label:"Compact",checked:O.compact,onChange:()=>K(t=>({...t,compact:!t.compact}))}]}),browseTags:{isOpen:L,onToggle:()=>{P(!L)}},addActions:Je,extraActions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:He,disabled:r.length<2,className:"p-3 bg-white border border-neutral-200 text-neutral-600 rounded-xl hover:bg-neutral-50 active:scale-95 transition-all shadow-sm disabled:opacity-50",title:"Randomize",children:e.jsx(pt,{size:16})}),e.jsxs("button",{onClick:()=>l("shelf"),className:"px-5 py-3 bg-indigo-600 text-white rounded-xl font-black text-xs flex items-center gap-2 hover:bg-indigo-700 active:scale-95 transition-all shadow-lg shadow-indigo-200",title:"Bookshelf Mode",children:[e.jsx(Et,{size:16}),e.jsx("span",{children:"Bookshelf"})]})]})}),aboveGrid:e.jsx(e.Fragment,{children:L&&e.jsx(bt,{items:r,selectedTag:u,onSelectTag:N,forcedView:"tags",title:"Browse Tags",icon:e.jsx(Ce,{size:16})})}),config:Dt,activeFilters:{},onFilterChange:()=>{},isLoading:E,isEmpty:D.length===0,emptyMessage:"No items found matching your criteria.",children:()=>e.jsx(e.Fragment,{children:Ue.map(t=>{t.type;const s=t.data.title,i=()=>{j(t.data),l("read_lesson")},o=()=>{j(t.data),l("edit_lesson")},d=()=>Z(t.data);return e.jsx(wt,{title:s,tags:t.data.tags,compact:O.compact,onClick:i,focusColor:t.data.focusColor,onFocusChange:m=>pe(t,m),isFocused:t.data.isFocused,onToggleFocus:()=>he(t),isCompleted:t.data.focusColor==="green",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:m=>{m.stopPropagation(),i()},className:"p-1.5 text-neutral-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Read",children:e.jsx(re,{size:14})}),e.jsx("button",{onClick:m=>{m.stopPropagation(),o()},className:"p-1.5 text-neutral-400 hover:text-neutral-900 hover:bg-neutral-100 rounded-lg transition-colors",title:"Edit",children:e.jsx(de,{size:14})}),e.jsx("button",{onClick:m=>{m.stopPropagation(),d()},className:"p-1.5 text-neutral-400 hover:text-rose-600 hover:bg-rose-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(Y,{size:14})})]}),children:O.showDesc&&t.data.description&&e.jsx("p",{className:"line-clamp-2",children:t.data.description})},`${t.type}-${t.data.id}`)})})}),e.jsx(we,{isOpen:!!X,title:"Delete Lesson?",message:"Confirm delete?",confirmText:"Yes, Delete",isProcessing:!1,onConfirm:Ve,onClose:()=>Z(null),icon:e.jsx(Y,{size:40,className:"text-red-500"})}),e.jsx(Te,{isOpen:Ie,onClose:()=>te(!1),type:"GENERATE_LESSON",title:"AI Lesson Creator",description:"Design a custom lesson instantly.",initialData:a.lessonPreferences,onGeneratePrompt:qe,onJsonReceived:Ke,actionLabel:"Create Lesson",closeOnSuccess:!0})]})};export{es as LessonLibraryV2,es as default};
