import{r as a,j as e,E as P,k as V,D as M,A as Q,_ as B,$ as E,q as J,P as W,ak as X,X as Z,aZ as F,b6 as H,G as K,a1 as L,a as Y}from"./index-A7igoMaK.js";import{b as U,B as R,I as ee,a as te,C as se,T as re}from"./ShelfModals-Cujas5Ax.js";import{C as le}from"./circle-CGhtPmyv.js";import{U as ne}from"./UniversalCard-DeqMoAJY.js";import{P as ae}from"./pen-CDatd0G_.js";import{P as ie}from"./palette-ksN5-M4Z.js";import{S as oe}from"./square-check-big-BJA3Bde1.js";const ge=({isOpen:s,setIsOpen:d,viewOptions:m,filterOptions:b,customSection:i,hasActiveFilters:h})=>{const u=a.useRef(null);return a.useEffect(()=>{const l=o=>{u.current&&!u.current.contains(o.target)&&d(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[d]),e.jsxs("div",{className:"relative",ref:u,children:[e.jsxs("button",{onClick:()=>d(!s),className:`p-3 rounded-xl border transition-all shadow-sm relative ${s?"bg-neutral-900 text-white border-neutral-900":"bg-white border-neutral-200 text-neutral-600 hover:bg-neutral-50"}`,title:"View & Filter",children:[e.jsx(P,{size:16}),h&&e.jsx("span",{className:"absolute top-0 right-0 w-2.5 h-2.5 bg-red-500 border-2 border-white rounded-full -mt-0.5 -mr-0.5 shadow-sm animate-in zoom-in duration-300"})]}),s&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white rounded-2xl shadow-xl border border-neutral-100 z-50 p-2 overflow-hidden animate-in fade-in zoom-in-95 flex flex-col gap-1",children:[b&&b.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"px-3 py-2 text-[9px] font-black text-neutral-400 uppercase tracking-widest border-b border-neutral-50 flex items-center gap-2",children:[e.jsx(U,{size:10})," Content Type"]}),e.jsx("div",{className:"p-1 grid grid-cols-3 gap-1 bg-neutral-100 rounded-xl mb-2",children:b.map(l=>e.jsx("button",{onClick:l.onClick,className:`py-1.5 text-[9px] font-black rounded-lg transition-all ${l.isActive?"bg-white shadow-sm text-neutral-900":"text-neutral-500 hover:text-neutral-700"}`,children:l.label},l.value))})]}),i,e.jsxs("div",{className:"px-3 py-2 text-[9px] font-black text-neutral-400 uppercase tracking-widest border-b border-neutral-50 flex items-center gap-2",children:[e.jsx(P,{size:10})," Visibility"]}),m.map((l,o)=>e.jsxs("button",{onClick:l.onChange,className:"flex items-center justify-between w-full px-3 py-2 text-xs font-bold rounded-lg hover:bg-neutral-50 transition-colors",children:[e.jsx("span",{children:l.label}),l.checked?e.jsx(V,{size:14,className:"text-green-500"}):e.jsx(le,{size:14,className:"text-neutral-300"})]},o))]})]})},ce=({isOpen:s,onClose:d,items:m,currentIds:b,onAdd:i,itemIcon:h})=>{const[u,l]=a.useState(""),[o,N]=a.useState(new Set),C=a.useMemo(()=>{const r=u.toLowerCase();return m.filter(j=>!b.has(j.id)&&j.title.toLowerCase().includes(r))},[m,u,b]),z=r=>{N(j=>{const v=new Set(j);return v.has(r)?v.delete(r):v.add(r),v})};return s?e.jsx("div",{className:"fixed inset-0 z-[250] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in",children:e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[2.5rem] shadow-2xl border border-neutral-200 flex flex-col max-h-[80vh]",children:[e.jsxs("header",{className:"px-8 py-6 border-b border-neutral-100 flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Add Content"}),e.jsx("button",{onClick:d,className:"p-2 text-neutral-400 hover:bg-neutral-100 rounded-full",children:e.jsx(Z,{size:20})})]}),e.jsx("div",{className:"p-4 border-b border-neutral-50",children:e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-neutral-300",size:14}),e.jsx("input",{value:u,onChange:r=>l(r.target.value),placeholder:"Search library...",className:"w-full pl-9 pr-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]})}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-4 space-y-2 custom-scrollbar",children:[C.map(r=>e.jsxs("div",{onClick:()=>z(r.id),className:`flex items-center justify-between p-3 rounded-xl border cursor-pointer transition-all ${o.has(r.id)?"bg-indigo-50 border-indigo-200":"bg-white border-neutral-100 hover:border-neutral-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[h&&e.jsx("div",{className:"text-neutral-400",children:h}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-sm text-neutral-900",children:r.title}),r.subtitle&&e.jsx("div",{className:"text-xs text-neutral-500",children:r.subtitle})]})]}),o.has(r.id)?e.jsx(oe,{size:20,className:"text-indigo-600"}):e.jsx(H,{size:20,className:"text-neutral-300"})]},r.id)),C.length===0&&e.jsx("p",{className:"text-center text-xs text-neutral-400 py-10",children:"No matching items found."})]}),e.jsxs("footer",{className:"px-8 py-4 border-t border-neutral-100 flex justify-end gap-3",children:[e.jsx("button",{onClick:d,className:"px-5 py-2 text-xs font-bold text-neutral-500 hover:text-neutral-900",children:"Cancel"}),e.jsxs("button",{onClick:()=>{i(Array.from(o)),d()},disabled:o.size===0,className:"px-6 py-2.5 bg-neutral-900 text-white rounded-xl font-black text-xs flex items-center gap-2 disabled:opacity-50",children:[e.jsx(E,{size:14})," Add (",o.size,")"]})]})]})}):null},be=({book:s,items:d,availableItems:m,onBack:b,onUpdateBook:i,onAddItem:h,onRemoveItem:u,onOpenItem:l,onEditItem:o,onFocusChange:N,onToggleFocus:C,itemIcon:z})=>{const[r,j]=a.useState(!1),[v,p]=a.useState(""),[c,n]=a.useState(!1),[x,f]=a.useState(""),[g,y]=a.useState(!1),[k,I]=a.useState(""),[G,A]=a.useState(!1),T=a.useRef(null),{showToast:O}=M(),$=a.useMemo(()=>{const t=s.title.split(":");return t.length>1?t.slice(1).join(":").trim():s.title},[s.title]);a.useEffect(()=>{var t,w;p($),f(s.icon||""),I((t=s.color)!=null&&t.startsWith("http")||(w=s.color)!=null&&w.startsWith("data:")?s.color:"")},[s,$]),a.useEffect(()=>{const t=w=>{T.current&&!T.current.contains(w.target)&&y(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const D=()=>{const w=`${s.title.split(":")[0].trim()}: ${v.trim()}`;w!==s.title&&i({title:w}),j(!1)},q=()=>{x!==s.icon&&i({icon:x.trim()}),n(!1)},_=t=>{h(t),O(`Added ${t.length} items.`,"success")};return e.jsxs("div",{className:"h-full flex flex-col animate-in fade-in duration-500",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center p-4 gap-4 shrink-0 bg-white border-b border-neutral-100 z-20",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:b,className:"flex items-center gap-2 text-sm font-bold text-neutral-500 hover:text-neutral-900 transition-colors",children:[" ",e.jsx(Q,{size:16})," Back "]}),e.jsxs("div",{className:"flex items-center gap-4",children:[c?e.jsx("input",{value:x,onChange:t=>f(t.target.value),onBlur:q,onKeyDown:t=>{t.key==="Enter"&&t.currentTarget.blur()},autoFocus:!0,placeholder:"Emoji",className:"text-2xl w-24 text-center bg-neutral-100 border border-neutral-300 rounded-lg py-1 outline-none ring-2 ring-indigo-300"}):e.jsx("div",{onClick:()=>n(!0),className:"p-1 rounded-lg hover:bg-neutral-100 cursor-pointer min-w-10 flex items-center justify-center",children:s.icon?e.jsx(R,{icon:s.icon,className:"text-2xl w-10 h-10 flex items-center justify-center mx-auto"}):e.jsx("div",{className:"w-10 h-10 rounded-xl border-2 border-dashed border-neutral-200 flex items-center justify-center text-neutral-300",children:e.jsx(ee,{size:18})})}),r?e.jsx("input",{value:v,onChange:t=>p(t.target.value),onBlur:D,onKeyDown:t=>{t.key==="Enter"&&t.currentTarget.blur()},autoFocus:!0,className:"text-xl font-black text-neutral-900 bg-neutral-100 border border-neutral-300 rounded-lg px-2 py-1 outline-none ring-2 ring-indigo-300"}):e.jsxs("div",{onClick:()=>j(!0),className:"group/title relative p-1 rounded-lg hover:bg-neutral-100 cursor-pointer flex items-center gap-2",children:[e.jsx("h2",{className:"text-xl font-black text-neutral-900 tracking-tight",style:{color:s.titleColor||"#171717",fontSize:s.titleSize?`${s.titleSize}px`:"inherit"},children:v}),e.jsx(ae,{size:14,className:"text-neutral-400 opacity-0 group-hover/title:opacity-100 transition-opacity"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",ref:T,children:[e.jsxs("button",{onClick:()=>y(!g),className:`p-2.5 rounded-xl transition-all border shadow-sm flex items-center justify-center gap-2 ${g?"bg-neutral-900 text-white border-neutral-900 shadow-md":"bg-white text-neutral-500 border-neutral-200 hover:bg-neutral-50 hover:text-neutral-900"}`,title:"Change Cover Design",children:[e.jsx(ie,{size:18}),g&&e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest mr-1",children:"Design"})]}),g&&e.jsxs("div",{className:"absolute top-full right-0 mt-3 p-5 bg-white rounded-3xl shadow-[0_20px_50px_-12px_rgba(0,0,0,0.25)] border border-neutral-100 z-[100] animate-in fade-in zoom-in-95 origin-top-right w-80 space-y-5",children:[e.jsx("div",{className:"flex justify-center border-b border-neutral-100 pb-4",children:e.jsx("div",{className:"w-32 h-44 shadow-lg rounded-lg overflow-hidden transform rotate-2",children:e.jsx(te,{id:s.id,title:v,icon:e.jsx(R,{icon:x||s.icon||"",className:"text-3xl"}),color:s.color,titleColor:s.titleColor,titleSize:s.titleSize,titleTop:s.titleTop,titleLeft:s.titleLeft,iconTop:s.iconTop,iconLeft:s.iconLeft,onClick:()=>{}})})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center gap-2 px-1 border-b border-neutral-50 pb-2",children:e.jsx("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Cover Color"})}),e.jsx("div",{className:"grid grid-cols-5 gap-3 justify-items-center",children:se.map(t=>e.jsx("button",{onClick:()=>i({color:t}),className:`w-8 h-8 rounded-full transition-all hover:scale-125 active:scale-90 ${s.color===t?"ring-2 ring-neutral-900 ring-offset-2 scale-110 shadow-md":"opacity-90 hover:opacity-100 shadow-sm border border-black/5"}`,style:{backgroundColor:t}},t))})]}),e.jsxs("div",{className:"space-y-3 pt-2 border-t border-neutral-50",children:[e.jsx("div",{className:"flex items-center gap-2 px-1",children:e.jsx("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Title Style"})}),e.jsxs("div",{className:"space-y-3 px-1",children:[e.jsx("div",{className:"grid grid-cols-5 gap-3 justify-items-center",children:re.map(t=>e.jsx("button",{onClick:()=>i({titleColor:t}),className:`w-6 h-6 rounded-md border transition-all ${s.titleColor===t?"ring-2 ring-indigo-500":"border-neutral-200"}`,style:{backgroundColor:t}},t))}),e.jsxs("div",{className:"flex items-center gap-3 bg-neutral-50 p-2 rounded-xl",children:[e.jsx(B,{size:14,className:"text-neutral-400"}),e.jsx("input",{type:"range",min:"12",max:"48",value:s.titleSize||24,onChange:t=>i({titleSize:parseInt(t.target.value)}),className:"flex-1 accent-neutral-900 h-1"})]})]})]}),e.jsxs("div",{className:"space-y-3 pt-2 border-t border-neutral-50",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsx("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:"Layout"}),e.jsx("button",{onClick:()=>i({titleTop:void 0,titleLeft:void 0,iconTop:void 0,iconLeft:void 0}),className:"text-[8px] font-black text-indigo-600 hover:underline uppercase",children:"Center All"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 px-1",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[8px] font-bold text-neutral-400 uppercase flex items-center gap-1",children:"Title Pos"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("input",{type:"number",value:s.titleTop??50,onChange:t=>i({titleTop:parseInt(t.target.value)}),className:"w-full px-2 py-1 bg-neutral-50 border border-neutral-200 rounded-md text-[10px] font-bold"}),e.jsx("input",{type:"number",value:s.titleLeft??50,onChange:t=>i({titleLeft:parseInt(t.target.value)}),className:"w-full px-2 py-1 bg-neutral-50 border border-neutral-200 rounded-md text-[10px] font-bold"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[8px] font-bold text-neutral-400 uppercase flex items-center gap-1",children:"Icon Pos"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("input",{type:"number",value:s.iconTop??40,onChange:t=>i({iconTop:parseInt(t.target.value)}),className:"w-full px-2 py-1 bg-neutral-50 border border-neutral-200 rounded-md text-[10px] font-bold"}),e.jsx("input",{type:"number",value:s.iconLeft??50,onChange:t=>i({iconLeft:parseInt(t.target.value)}),className:"w-full px-2 py-1 bg-neutral-50 border border-neutral-200 rounded-md text-[10px] font-bold"})]})]})]})]}),e.jsxs("div",{className:"space-y-2 pt-2 border-t border-neutral-50",children:[e.jsx("label",{className:"text-[9px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Image URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:k,onChange:t=>I(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(i({color:k.trim()}),y(!1))},placeholder:"https://...",className:"flex-1 px-3 py-1.5 bg-neutral-50 border border-neutral-200 rounded-lg text-[10px] font-medium focus:ring-1 focus:ring-neutral-900 outline-none"}),e.jsx("button",{onClick:()=>i({color:k.trim()}),className:"p-1.5 bg-neutral-900 text-white rounded-lg hover:bg-neutral-800",children:e.jsx(E,{size:14})})]})]})]})]}),e.jsxs("button",{onClick:()=>A(!0),className:"px-4 py-2 bg-white border border-neutral-200 text-neutral-600 rounded-lg font-bold text-xs flex items-center gap-2 hover:bg-neutral-50 transition-all shadow-sm",children:[e.jsx(E,{size:14})," Add Content"]})]})]}),e.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-8 bg-neutral-50/50 relative",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 relative z-10",children:[d.map((t,w)=>e.jsx(ne,{title:t.title,compact:!1,onClick:()=>l(t),isCompleted:t.isCompleted,focusColor:t.focusColor,onFocusChange:S=>N(t,S),isFocused:t.isFocused,onToggleFocus:()=>C(t),actions:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:S=>{S.stopPropagation(),l(t)},className:"p-1.5 text-neutral-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Read",children:e.jsx(J,{size:14})}),e.jsx("button",{onClick:S=>{S.stopPropagation(),o(t)},className:"p-1.5 text-neutral-400 hover:text-neutral-900 hover:bg-neutral-100 rounded-lg transition-colors",title:"Edit",children:e.jsx(W,{size:14})}),e.jsx("button",{onClick:S=>{S.stopPropagation(),u(t.id)},className:"p-1.5 text-neutral-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remove from Book",children:e.jsx(X,{size:14})})]}),children:t.subtitle&&e.jsx("p",{className:"line-clamp-2 text-xs",children:t.subtitle})},`${t.id}-${w}`)),d.length===0&&e.jsxs("div",{className:"col-span-full py-20 text-center text-neutral-400 border-2 border-dashed border-neutral-200 rounded-3xl",children:[e.jsx("p",{className:"font-bold",children:"This book is empty."}),e.jsx("p",{className:"text-sm mt-1",children:'Click "Add Content" to fill it up.'})]})]})}),e.jsx(ce,{isOpen:G,onClose:()=>A(!1),items:m,currentIds:new Set(d.map(t=>t.id)),onAdd:_,itemIcon:z})]})},je=(s,d)=>{const[m,b]=a.useState(()=>K(d,[])),[i,h]=a.useState(0),{showToast:u}=M(),l=a.useMemo(()=>{const c=new Set(s.map(f=>{const g=f.title.split(":");return g.length>1?g[0].trim():"General"})),n=new Set([...m,...Array.from(c)]),x=Array.from(n).sort((f,g)=>f==="General"?-1:g==="General"?1:f.localeCompare(g));return x.length>0?x:["General"]},[s,m]);a.useEffect(()=>{i>=l.length&&h(Math.max(0,l.length-1))},[l.length]);const o=l[i]||"General",N=a.useMemo(()=>s.filter(c=>{const n=c.title.split(":");return(n.length>1?n[0].trim():"General")===o}),[s,o]);return{allShelves:l,currentShelfName:o,booksOnCurrentShelf:N,currentShelfIndex:i,addShelf:c=>{const n=c.trim();if(l.map(f=>f.toLowerCase()).includes(n.toLowerCase()))return u("Shelf name already exists.","error"),!1;const x=[...m,n];return b(x),L(d,x),l.length,setTimeout(()=>{},0),u(`Shelf "${n}" created.`,"success"),!0},renameShelf:(c,n)=>{const x=o,f=c.trim();if(l.map(y=>y.toLowerCase()).includes(f.toLowerCase()))return u("Shelf name already exists.","error"),!1;let g;return m.includes(x)?g=m.map(y=>y===x?f:y):g=[...m,f],b(g),L(d,g),n(x,f),u(`Renamed to "${f}".`,"success"),!0},removeShelf:()=>{if(N.length>0)return u("Cannot remove a shelf that contains books.","error"),!1;if(o==="General")return u("Cannot remove General shelf.","error"),!1;const c=m.filter(n=>n!==o);return b(c),L(d,c),h(n=>Math.max(0,n-1)),!0},nextShelf:()=>h((i+1)%l.length),prevShelf:()=>h((i-1+l.length)%l.length),selectShelf:c=>{const n=l.indexOf(c);n!==-1&&h(n)}}},ve=({shelves:s,books:d,onNavigateShelf:m,onNavigateBook:b,placeholder:i="Search shelf or book..."})=>{const[h,u]=a.useState(""),[l,o]=a.useState(!1),N=a.useRef(null);a.useEffect(()=>{const r=j=>{N.current&&!N.current.contains(j.target)&&o(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]);const C=a.useMemo(()=>{if(!h.trim())return[];const r=h.toLowerCase(),j=s.filter(p=>p.toLowerCase().includes(r)).map(p=>({type:"shelf",id:p,label:p})),v=d.filter(p=>{const c=p.title||p.topic||"",n=c.split(":");return(n.length>1?n.slice(1).join(":").trim():c).toLowerCase().includes(r)}).map(p=>{const c=p.title||p.topic||"",n=c.split(":"),x=n.length>1?n.slice(1).join(":").trim():c;return{type:"book",id:p.id,label:x,shelf:n[0].trim()||"General",data:p}});return[...j,...v].slice(0,10)},[h,s,d]),z=r=>{r.type==="shelf"?m(r.id):b(r.data),u(""),o(!1)};return e.jsxs("div",{className:"flex-1 max-w-md relative mx-4",ref:N,children:[e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 text-neutral-400",size:16}),e.jsx("input",{type:"text",value:h,onChange:r=>{u(r.target.value),o(!0)},onFocus:()=>o(!0),placeholder:i,className:"w-full pl-10 pr-4 py-2.5 bg-white border border-neutral-200 rounded-2xl text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none transition-all shadow-sm"})]}),l&&C.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-neutral-100 rounded-2xl shadow-xl z-[100] overflow-hidden animate-in fade-in zoom-in-95",children:C.map((r,j)=>e.jsxs("button",{onClick:()=>z(r),className:"w-full text-left px-4 py-3 hover:bg-neutral-50 transition-colors flex items-center justify-between border-b border-neutral-50 last:border-0",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-black text-neutral-900",children:r.label}),e.jsx("span",{className:"text-[9px] font-bold text-neutral-400 uppercase tracking-widest",children:r.type==="shelf"?"Shelf":`Book â€¢ ${r.shelf}`})]}),e.jsx(Y,{size:14,className:"text-neutral-300"})]},j))})]})};export{be as G,ve as S,ge as V,je as u};
