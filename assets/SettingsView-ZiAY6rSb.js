import{c as F,r as c,j as e,an as xe,P as ie,ao as se,ap as tt,a1 as Z,K as ue,aq as Se,ar as Ae,as as at,at as ze,au as st,av as Ee,aw as nt,ax as rt,ay as oe,I as lt,C as me,D as it,F as ot,a0 as ce,az as ct,J as dt,y as xt,a9 as ut,H as mt,ac as ht,aA as he,k as X,a2 as de,aB as pt,L as gt,aC as bt,h as ft,X as jt,aD as vt,aE as Nt,aF as yt,aG as Ie,aH as wt,aI as kt,E as ve,m as Ne,ab as ne,aJ as Ct,f as St,aK as At,aL as zt,aM as Et,aN as It,aO as Tt,aP as Lt,p as ye,aQ as Pt,w as we}from"./index-CzjYEa5v.js";import{A as Te,S as Rt,T as Dt}from"./AvatarSelectionModal-BnF_KHlM.js";import{S as Ot}from"./school-DX3B8ifo.js";import{B as _t,C as Mt,A as Vt,D as re}from"./WordTable_UI-DzdHJSal.js";import{E as Ht}from"./ear-BDuAy4E2.js";import{L as Ut}from"./list-todo-Dz6wA_p8.js";import{D as Ft}from"./download-DINdxnRY.js";import{C as Bt}from"./circle-D5lELFOI.js";import{P as Jt}from"./pen-DCPBcE_g.js";import"./palette-BiTp-MRO.js";import"./TagBrowser-ePyJLDNS.js";import"./search-CCKdQC-2.js";import"./square-check-big-DjoSBntH.js";import"./chevron-left-Ce_8X7zx.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=F("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=F("LayoutTemplate",[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=F("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=F("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=F("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=F("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),Kt=["Vietnamese","Spanish","Chinese (Simplified)","Chinese (Traditional)","Japanese","Korean","French","German","Italian","Portuguese","Russian","Arabic","Hindi","Thai","Indonesian","Turkish"],Yt=[{level:1,title:"Vocab Novice"},{level:5,title:"Word Apprentice"},{level:10,title:"Lexical Explorer"},{level:20,title:"Master Grammarian"},{level:30,title:"IELTS Wordsmith"},{level:50,title:"IELTS Luminary"}],qt=({profileData:t,onProfileChange:r,onAvatarChange:l,onSaveProfile:i})=>{const[x,h]=c.useState(!1),a=Yt.some(g=>g.title===t.role),m={id:"settings-user",name:t.name,avatar:t.avatar,lastLogin:0,experience:0,level:100,peakLevel:100,adventure:{}};return e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-neutral-100 text-neutral-600 rounded-2xl",children:e.jsx(xe,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Your Profile"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Identity and learning context."})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6 p-4 bg-neutral-50 rounded-3xl border border-neutral-100",children:[e.jsxs("div",{className:"relative group shrink-0",children:[e.jsx("img",{src:t.avatar,alt:"Current Avatar",className:"w-24 h-24 rounded-2xl bg-white shadow-sm border-2 border-white object-contain"}),e.jsx("button",{onClick:()=>h(!0),className:"absolute inset-0 bg-black/40 rounded-2xl flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white font-bold text-xs",children:"Change"}),e.jsx("button",{onClick:()=>h(!0),className:"absolute -bottom-2 -right-2 p-2 bg-neutral-900 text-white rounded-full shadow-md hover:scale-110 transition-transform",title:"Edit Avatar",children:e.jsx(ie,{size:14})})]}),e.jsxs("div",{className:"flex-1 w-full md:w-auto",children:[e.jsx("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2",children:"Display Name"}),e.jsx("input",{name:"name",value:t.name,onChange:r,className:"w-full px-4 py-3 bg-white border border-neutral-200 rounded-xl font-bold text-lg focus:ring-2 focus:ring-neutral-900 outline-none",placeholder:"Enter your name"}),e.jsx("button",{onClick:()=>h(!0),className:"mt-2 text-xs font-bold text-indigo-600 hover:underline md:hidden",children:"Select Identity"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2",children:"Role / Title"}),e.jsx("input",{name:"role",value:t.role,onChange:r,placeholder:"e.g., Student",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium focus:ring-1 focus:ring-neutral-300 outline-none",readOnly:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2",children:"Current Level"}),e.jsx("input",{name:"currentLevel",value:t.currentLevel,onChange:r,placeholder:"e.g., Intermediate, Advanced",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium focus:ring-1 focus:ring-neutral-300 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2",children:"Target"}),e.jsx("input",{name:"target",value:t.target,onChange:r,placeholder:"e.g., Fluent communication",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium focus:ring-1 focus:ring-neutral-300 outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2 flex items-center gap-2",children:[e.jsx(se,{size:12})," Native Language"]}),e.jsx("select",{name:"nativeLanguage",value:t.nativeLanguage,onChange:r,className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium appearance-none focus:ring-1 focus:ring-neutral-300 outline-none",children:Kt.map(g=>e.jsx("option",{value:g,children:g},g))})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-amber-50 text-amber-600 rounded-2xl",children:e.jsx(se,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Lesson Preferences"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Settings for AI generated units in Lesson page"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t border-neutral-100",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2 flex items-center gap-2",children:[e.jsx(se,{size:12})," Content Language"]}),e.jsxs("select",{name:"lessonLanguage",value:t.lessonLanguage,onChange:r,className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium appearance-none",children:[e.jsx("option",{value:"English",children:"English"}),e.jsx("option",{value:"Vietnamese",children:"Vietnamese"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 mb-2 flex items-center gap-2",children:[e.jsx(tt,{size:12})," Target Audience"]}),e.jsxs("select",{name:"lessonAudience",value:t.lessonAudience,onChange:r,className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl font-medium appearance-none",children:[e.jsx("option",{value:"Kid",children:"Kid"}),e.jsx("option",{value:"Adult",children:"Adult"})]})]})]})]}),e.jsxs("button",{onClick:i,className:"w-full py-4 bg-neutral-900 text-white rounded-2xl font-black text-xs hover:bg-neutral-800 transition-all flex items-center justify-center space-x-2",children:[e.jsx(Z,{size:16})," ",e.jsx("span",{children:"SAVE PROFILE"})]}),e.jsx(Te,{isOpen:x,onClose:()=>h(!1),onSelectAvatar:l,currentUser:m})]})},Ce=({label:t,langCode:r,currentVoice:l,serverData:i,onChange:x,onPreview:h,filterHighQuality:a})=>{if(!i)return e.jsxs("div",{className:"space-y-1 opacity-50",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:t}),e.jsx("div",{className:"w-full bg-neutral-100 border border-neutral-200 rounded-xl px-4 py-2 text-xs font-bold text-neutral-400",children:"Server Offline"})]});const m=i.voices.filter(b=>b.language===r||b.language.toLowerCase().startsWith(r)?a?b.name.includes("Enhanced")||b.name.includes("Premium"):!0:!1),g=m.reduce((b,d)=>{const o=d.accent||"Standard";return b[o]||(b[o]=[]),b[o].push(d),b},{}),y=b=>{const d=b.target.value;if(!d){const f=r==="en"?"en_US":"vi_VN";x("",f),h("",f);return}const o=i.voices.find(f=>f.name===d);o&&(x(o.name,o.accent),setTimeout(()=>h(o.name,o.accent),100))};return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center px-1",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:t}),e.jsxs("button",{type:"button",onClick:()=>h(l,r==="en"?"en_US":"vi_VN"),className:"text-[10px] font-black text-indigo-600 uppercase tracking-widest flex items-center gap-1 hover:underline",children:[e.jsx(lt,{size:10,fill:"currentColor"})," Test"]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:l,onChange:y,className:"w-full appearance-none bg-white border border-neutral-200 rounded-xl px-4 py-3 pr-10 text-xs font-bold focus:ring-2 focus:ring-neutral-900 outline-none transition-all",children:[e.jsx("option",{value:"",children:"Default System Voice"}),Object.entries(g).map(([b,d])=>e.jsx("optgroup",{label:b.replace(/[_]/g," ").toUpperCase(),children:d.map(o=>e.jsx("option",{value:o.name,children:o.name},o.name))},b)),m.length===0&&e.jsxs("option",{disabled:!0,children:["No ",a?"high quality ":"","voices found"]})]}),e.jsx(me,{size:16,className:"absolute right-4 top-1/2 -translate-y-1/2 text-neutral-400 pointer-events-none"})]})]})},Qt=({config:t,onConfigChange:r,onSaveSettings:l})=>{const[i,x]=c.useState(null),[h,a]=c.useState(!1),[m,g]=c.useState(!1),{showToast:y}=ue(),b=Se(t),d=t.audioCoach.activeCoach,o=t.audioCoach.coaches[d],f=async()=>{nt();const p=await rt(b);x(p||null)};c.useEffect(()=>{f()},[b]);const k=(p,N=!1)=>{const A={...t.audioCoach.coaches};if(A[d]={...A[d],...p},r("audioCoach","coaches",A),N){const C={...t,audioCoach:{...t.audioCoach,coaches:A}};oe(C),y("Settings saved automatically.","success",1e3)}},S=p=>{r("interface","buddyVoiceEnabled",p);const N={...t,interface:{...t.interface,buddyVoiceEnabled:p}};oe(N)},z=(p,N,A)=>{it(p==="en"?"Hello! I am your study companion. Ready to learn?":"Xin chào! Mình là bạn đồng hành của bạn. Sẵn sàng chưa?",!0,p,N,A)},E={id:"coach-setup",name:o.name,avatar:o.avatar,level:999,peakLevel:999,experience:0,lastLogin:0,adventure:{}};return e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-8 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-neutral-100 text-neutral-600 rounded-2xl",children:e.jsx(Ae,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Audio Coach"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Customize your AI study companion."})]})]}),e.jsxs("button",{onClick:l,className:"px-5 py-2.5 bg-neutral-900 text-white rounded-xl font-black text-[10px] flex items-center space-x-2 active:scale-95 uppercase tracking-widest hover:bg-neutral-800 transition-all shadow-md",children:[e.jsx(Z,{size:14}),e.jsx("span",{children:"Save"})]})]}),e.jsx("div",{className:"space-y-4 pt-4 border-t border-neutral-100",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:[e.jsx(at,{size:12})," Interaction"]}),e.jsxs("label",{onClick:()=>S(!t.interface.buddyVoiceEnabled),className:"flex items-center justify-between px-4 py-4 bg-white border border-neutral-200 rounded-2xl cursor-pointer hover:bg-neutral-50 transition-all shadow-sm group",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-black text-neutral-900",children:"Enable Dialogue"}),e.jsx("span",{className:"text-xs text-neutral-500 font-medium mt-0.5",children:"Read advice, tips, and greetings aloud"})]}),e.jsx("div",{className:`w-11 h-6 rounded-full transition-all flex items-center p-1 ${t.interface.buddyVoiceEnabled?"bg-indigo-600":"bg-neutral-200"}`,children:e.jsx("div",{className:`w-4 h-4 bg-white rounded-full shadow-md transition-transform duration-300 ${t.interface.buddyVoiceEnabled?"translate-x-5":"translate-x-0"}`})})]})]})}),e.jsxs("div",{className:"space-y-6 pt-4 border-t border-neutral-100",children:[e.jsx("div",{className:"flex items-center justify-between px-1",children:e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(xe,{size:12})," Coach Identity"]})}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"shrink-0 flex justify-center md:justify-start",children:e.jsxs("div",{className:"relative group w-24 h-24",children:[e.jsxs("div",{className:"w-full h-full rounded-[2rem] bg-neutral-100 border-2 border-neutral-200 p-2 overflow-hidden shadow-sm relative",children:[e.jsx("img",{src:o.avatar,className:"w-full h-full object-contain",alt:"Coach Avatar"}),e.jsx("div",{onClick:()=>a(!0),className:"absolute inset-0 bg-black/10 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer z-10",children:e.jsx("div",{className:"bg-white p-2 rounded-xl shadow-sm",children:e.jsx(ie,{size:16,className:"text-neutral-900"})})})]}),e.jsx("button",{onClick:()=>a(!0),className:"absolute bottom-0 right-0 translate-x-1 translate-y-1 p-1.5 bg-neutral-900 text-white rounded-lg shadow-md hover:scale-110 transition-transform group-hover:opacity-0",title:"Change Avatar",children:e.jsx(ie,{size:10})})]})}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-wider px-1",children:"Name"}),e.jsx("input",{type:"text",value:o.name,onChange:p=>k({name:p.target.value}),onBlur:()=>k({},!0),placeholder:"Coach Name",className:"w-full px-4 py-3 bg-neutral-50 border border-neutral-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none transition-all"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] font-bold text-neutral-400 uppercase tracking-wider px-1",children:"Persona Style"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>k({persona:"friendly_elementary"},!0),className:`flex flex-col items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 transition-all ${o.persona==="friendly_elementary"?"bg-amber-50 border-amber-200 text-amber-700":"bg-white border-neutral-100 text-neutral-400 hover:border-neutral-200"}`,children:[e.jsx(Ot,{size:18}),e.jsx("span",{className:"text-[10px] font-black uppercase",children:"Teacher"})]}),e.jsxs("button",{type:"button",onClick:()=>k({persona:"professional_professor"},!0),className:`flex flex-col items-center justify-center gap-2 px-4 py-3 rounded-xl border-2 transition-all ${o.persona==="professional_professor"?"bg-indigo-50 border-indigo-200 text-indigo-700":"bg-white border-neutral-100 text-neutral-400 hover:border-neutral-200"}`,children:[e.jsx(ze,{size:18}),e.jsx("span",{className:"text-[10px] font-black uppercase",children:"Professor"})]})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6 pt-4 border-t border-neutral-100",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest",children:[e.jsx(st,{size:12})," Voice Settings"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group select-none",children:[e.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${m?"bg-indigo-600 border-indigo-600":"bg-white border-neutral-300 group-hover:border-indigo-400"}`,children:m&&e.jsx(Rt,{size:10,className:"text-white",fill:"currentColor"})}),e.jsx("input",{type:"checkbox",className:"hidden",checked:m,onChange:p=>g(p.target.checked)}),e.jsx("span",{className:`text-[10px] font-bold transition-colors ${m?"text-indigo-700":"text-neutral-500"}`,children:"Only High Quality"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(Ce,{label:"English Voice",langCode:"en",currentVoice:o.enVoice,serverData:i,onChange:(p,N)=>k({enVoice:p,enAccent:N},!0),onPreview:(p,N)=>z("en",p,N),filterHighQuality:m}),e.jsx(Ce,{label:"Vietnamese Voice",langCode:"vi",currentVoice:o.viVoice,serverData:i,onChange:(p,N)=>k({viVoice:p,viAccent:N},!0),onPreview:(p,N)=>z("vi",p,N),filterHighQuality:m})]})]}),e.jsxs("div",{className:"p-4 bg-neutral-50 rounded-2xl border border-neutral-200 flex items-start gap-3",children:[e.jsx(Ee,{size:16,className:"text-neutral-400 mt-0.5 shrink-0"}),e.jsx("p",{className:"text-[10px] text-neutral-500 leading-relaxed font-medium",children:"Pronunciation practice uses your browser's built-in recognition engine for maximum compatibility and privacy. The selected voices above are used for reading text aloud."})]}),e.jsx(Te,{isOpen:h,onClose:()=>a(!1),onSelectAvatar:p=>k({avatar:p},!0),currentUser:E})]})},Xt=({junkTags:t,onJunkTagsChange:r})=>{const[l,i]=c.useState(""),x=()=>{const a=l.trim().toLowerCase();a&&!t.includes(a)&&r([...t,a].sort()),i("")},h=a=>{r(t.filter(m=>m!==a))};return e.jsxs("div",{className:"space-y-4 pt-4 border-t border-neutral-100",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:[e.jsx(dt,{size:12})," Junk Tag List"]}),e.jsxs("div",{className:"p-4 bg-neutral-50 rounded-2xl border border-neutral-100 space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:l,onChange:a=>i(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),x())},placeholder:"Add a tag to remove...",className:"flex-1 px-3 py-2 bg-white border border-neutral-200 rounded-lg text-xs font-bold"}),e.jsx("button",{onClick:x,className:"p-2.5 bg-neutral-900 text-white rounded-lg flex items-center justify-center",children:e.jsx(xt,{size:14})})]}),t.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(a=>e.jsxs("div",{className:"flex items-center gap-1 bg-white pl-3 pr-1 py-1 rounded-full border border-neutral-200 text-xs font-bold text-neutral-700",children:[e.jsx("span",{children:a}),e.jsx("button",{onClick:()=>h(a),className:"p-1 text-neutral-400 hover:text-red-500 hover:bg-red-50 rounded-full",children:e.jsx(ut,{size:12})})]},a))}):e.jsx("p",{className:"text-center text-xs text-neutral-400 py-2",children:"No junk tags defined."})]})]})},L=({checked:t,onChange:r,label:l,icon:i})=>e.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-3 py-2 rounded-lg border transition-all ${t?"bg-indigo-50 border-indigo-200 text-indigo-800":"bg-white border-neutral-200 text-neutral-500 hover:bg-neutral-50"}`,children:[i&&e.jsx(i,{size:14}),t?e.jsx(ct,{size:14}):e.jsx(Bt,{size:14}),e.jsx("span",{className:"text-xs font-bold uppercase",children:l})]}),Zt=t=>{const{jsonInputRef:r,dataScope:l,onDataScopeChange:i,onJSONImport:x,onJSONExport:h,isNormalizing:a,onOpenNormalizeModal:m,junkTags:g,onJunkTagsChange:y,normalizeOptions:b,onNormalizeOptionsChange:d}=t,o=f=>{i({...l,[f]:!l[f]})};return e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-8",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsx("div",{className:"p-3 bg-indigo-50 text-indigo-600 rounded-2xl",children:e.jsx(ot,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Data Management"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Backup, restore, and optimize your library."})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Manual Backup / Restore"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(L,{checked:l.user,onChange:()=>o("user"),label:"User Profile"}),e.jsx(L,{checked:l.vocabulary,onChange:()=>o("vocabulary"),label:"Word Library"}),e.jsx(L,{checked:l.wordBook,onChange:()=>o("wordBook"),label:"Word Books",icon:_t}),e.jsx(L,{checked:l.lesson,onChange:()=>o("lesson"),label:"Lessons"}),e.jsx(L,{checked:l.reading,onChange:()=>o("reading"),label:"Reading"}),e.jsx(L,{checked:l.writing,onChange:()=>o("writing"),label:"Writing"}),e.jsx(L,{checked:l.speaking,onChange:()=>o("speaking"),label:"Speaking"}),e.jsx(L,{checked:l.listening,onChange:()=>o("listening"),label:"Listening"}),e.jsx(L,{checked:l.mimic,onChange:()=>o("mimic"),label:"Pronunciation Queue",icon:Ht}),e.jsx(L,{checked:l.calendar,onChange:()=>o("calendar"),label:"Calendar",icon:Mt}),e.jsx(L,{checked:l.planning,onChange:()=>o("planning"),label:"Planning",icon:Ut})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>{var f;return(f=r.current)==null?void 0:f.click()},className:"py-4 border-2 border-neutral-900 text-neutral-900 rounded-2xl font-black text-xs hover:bg-neutral-50 transition-all flex items-center justify-center space-x-2",children:[e.jsx(Gt,{size:16})," ",e.jsx("span",{children:"IMPORT"}),e.jsx("input",{type:"file",ref:r,className:"hidden",accept:".json",onChange:x})]}),e.jsxs("button",{onClick:h,className:"py-4 bg-neutral-900 text-white rounded-2xl font-black text-xs hover:bg-neutral-800 transition-all flex items-center justify-center space-x-2",children:[e.jsx(Ft,{size:16})," ",e.jsx("span",{children:"EXPORT"})]})]})]})}),e.jsx(Xt,{junkTags:g,onJunkTagsChange:y}),e.jsx("div",{className:"pt-4 border-t border-neutral-100 grid grid-cols-1 md:grid-cols-2 gap-3",children:e.jsxs("button",{onClick:m,disabled:a,className:"w-full py-4 bg-white border border-neutral-200 rounded-2xl text-neutral-600 hover:bg-neutral-50 transition-all flex items-center justify-center space-x-3 group",children:[e.jsx("div",{className:"p-2 bg-neutral-100 group-hover:bg-orange-50 rounded-lg transition-colors",children:a?e.jsx(ce,{size:16,className:"animate-spin text-orange-600"}):e.jsx(Pe,{size:16,className:"text-orange-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-xs font-black uppercase tracking-widest leading-none",children:"Normalize Data"}),e.jsx("div",{className:"text-[9px] font-bold text-neutral-400 mt-1",children:"Clean junk tags & legacy data"})]})]})})]})},ea=({srsConfig:t,onSrsConfigChange:r,onResetSrsConfig:l,onSaveSettings:i})=>e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-purple-50 text-purple-600 rounded-2xl",children:e.jsx(mt,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Spaced Repetition Algorithm"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Customize the learning intervals and multipliers."})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-6 gap-y-4 pt-4 border-t border-neutral-100",children:[e.jsx("div",{className:"col-span-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:"Initial Intervals"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"New word (Easy)"}),e.jsx("input",{type:"number",step:"1",min:"1",name:"initialEasy",value:t.initialEasy,onChange:r,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Next review in X days."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"New word (Hard)"}),e.jsx("input",{type:"number",step:"1",min:"1",name:"initialHard",value:t.initialHard,onChange:r,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Next review in X days."})]}),e.jsx("div",{className:"col-span-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 pt-2",children:"Interval Multipliers"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"'Easy' after 'Easy'"}),e.jsx("input",{type:"number",step:"0.1",min:"1",name:"easyEasy",value:t.easyEasy,onChange:r,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Grows interval fastest (e.g., 2.5x)."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"'Easy' after 'Hard'"}),e.jsx("input",{type:"number",step:"0.1",min:"1",name:"hardEasy",value:t.hardEasy,onChange:r,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Helps recover from a 'Hard' rating (e.g., 2.0x)."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"'Hard' after 'Hard'"}),e.jsx("input",{type:"number",step:"0.1",min:"1",name:"hardHard",value:t.hardHard,onChange:r,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Slowly increases interval (e.g., 1.3x)."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"'Hard' after 'Easy' (Penalty)"}),e.jsx("input",{type:"number",step:"0.1",max:"1",name:"easyHardPenalty",value:t.easyHardPenalty,onChange:r,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Reduces interval if you forget (e.g., 0.5x)."})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-neutral-100",children:[e.jsx("button",{onClick:l,type:"button",className:"flex-1 py-3 bg-neutral-100 text-neutral-500 rounded-xl font-bold text-xs uppercase tracking-widest hover:bg-neutral-200 transition-all",children:"Reset Defaults"}),e.jsx("button",{onClick:i,type:"button",className:"flex-1 py-3 bg-neutral-900 text-white rounded-xl font-bold text-xs uppercase tracking-widest hover:bg-neutral-800 transition-all",children:"Save Settings"})]})]}),ta=({goalConfig:t,onGoalConfigChange:r,onSaveSettings:l})=>e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-green-50 text-green-600 rounded-2xl",children:e.jsx(ht,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Daily Goals"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Set your daily learning and review targets."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 pt-4 border-t border-neutral-100",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"Max New Words per Day"}),e.jsx("input",{type:"number",step:"1",min:"1",name:"max_learn_per_day",value:t.max_learn_per_day,onChange:r,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Target for learning new vocabulary."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-neutral-600 mb-1",children:"Max Reviews per Day"}),e.jsx("input",{type:"number",step:"1",min:"1",name:"max_review_per_day",value:t.max_review_per_day,onChange:r,className:"w-full px-4 py-2 bg-neutral-50 border border-neutral-200 rounded-xl font-bold"}),e.jsx("p",{className:"text-[9px] text-neutral-400 mt-1",children:"Target for reviewing existing vocabulary."})]})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t border-neutral-100",children:e.jsx("button",{onClick:l,className:"w-full md:w-auto py-3 px-6 bg-neutral-900 text-white rounded-2xl font-black text-xs hover:bg-neutral-800 transition-all flex items-center justify-center space-x-2",children:e.jsx("span",{children:"SAVE GOALS"})})})]}),aa=({onOpenClearProgressModal:t,onOpenNukeModal:r,isAdmin:l,onToggleAdmin:i})=>e.jsxs("section",{className:"bg-red-50 p-8 rounded-[2.5rem] border-2 border-red-100 shadow-sm flex flex-col space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-red-100 text-red-600 rounded-2xl",children:e.jsx(he,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-red-900",children:"Danger Zone"}),e.jsx("p",{className:"text-xs text-red-500",children:"Actions in this zone are irreversible."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:i,className:`p-4 border-2 rounded-2xl text-left transition-colors group ${l?"bg-neutral-900 border-neutral-900":"bg-white border-red-100 hover:border-red-500"}`,children:[e.jsxs("div",{className:`font-black flex items-center gap-2 ${l?"text-white":"text-red-600"}`,children:[e.jsx(Dt,{size:16}),l?"Disable Developer Mode":"Enable Developer Mode"]}),e.jsx("div",{className:`text-xs mt-1 ${l?"text-neutral-400":"text-neutral-500"}`,children:l?"Admin tools enabled in Discover.":"Unlocks cheat tools for testing."})]}),e.jsx("div",{className:"hidden md:block"})," ",e.jsxs("button",{onClick:t,className:"p-4 bg-white border-2 border-red-100 rounded-2xl text-left hover:border-red-500 transition-colors group",children:[e.jsx("div",{className:"font-black text-red-600",children:"Clear All Progress"}),e.jsx("div",{className:"text-xs text-neutral-500 mt-1",children:"Reset all SRS data, but keep your words."})]}),e.jsxs("button",{onClick:r,className:"p-4 bg-white border-2 border-red-100 rounded-2xl text-left hover:border-red-500 transition-colors group",children:[e.jsx("div",{className:"font-black text-red-600",children:"Reset Full Library"}),e.jsx("div",{className:"text-xs text-neutral-500 mt-1",children:"Delete ALL your data and restore the app to its initial state."})]})]})]}),sa=["localhost","macm2.local","macm4.local"],na=({config:t,onConfigChange:r,onSaveSettings:l})=>{const[i,x]=c.useState("checking"),[h,a]=c.useState("idle"),[m,g]=c.useState(!1),[y,b]=c.useState(""),[d,o]=c.useState(!1),[f,k]=c.useState(""),[S,z]=c.useState([]),[E,p]=c.useState(!1),[N,A]=c.useState(!1),{showToast:C}=ue(),R=Se(t),I=R.startsWith("https"),$=async()=>{x("checking");try{const n=await fetch(`${R}/api/health`);if(n.ok){const w=await n.json();x("connected"),g(!1),w.backupDir&&b(w.backupDir);const U=await yt();z(U)}else x("error"),g(!0),z([])}catch{x("disconnected"),g(!0),z([])}};c.useEffect(()=>{$()},[R]),c.useEffect(()=>{i==="connected"&&!t.sync.autoBackupEnabled&&r("sync","autoBackupEnabled",!0)},[i]),c.useEffect(()=>{d&&k(y||t.server.backupPath)},[d,y,t.server.backupPath]);const D=n=>{r("server",null,{...t.server,...n})},G=n=>{D({useCustomUrl:n.target.checked})},K=()=>{k("~/Library/Mobile Documents/com~apple~CloudDocs/VocabPro")},O=()=>{window.open(R,"_blank"),C("Opened server tab. Please click 'Advanced' -> 'Proceed' to trust the certificate.","info",6e3)},H=async()=>{if(f.trim()){a("updating");try{const n=await fetch(`${R}/api/config/backup-path`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:f})}),w=await n.json();if(n.ok)a("success"),D({backupPath:f}),b(w.path||f),o(!1),setTimeout(()=>a("idle"),3e3);else throw new Error(w.error||"Server rejected path")}catch(n){a("error"),C(n.message,"error"),setTimeout(()=>a("idle"),3e3)}}},Y=async n=>{A(!0),window.isRestoring=!0;try{const w=await wt(n);w&&w.type==="success"?(C("Data restored successfully! Reloading...","success"),w.updatedUser&&(localStorage.setItem("vocab_pro_current_user_id",w.updatedUser.id),localStorage.setItem("vocab_pro_current_user_name",w.updatedUser.name),w.backupTimestamp&&localStorage.setItem("vocab_pro_last_backup_timestamp",String(w.backupTimestamp))),setTimeout(()=>window.location.reload(),1500)):(C("Restore failed.","error"),A(!1),window.isRestoring=!1)}catch{C("Restore encountered an error.","error"),A(!1),window.isRestoring=!1}},q=()=>{const n=document.createElement("input");n.type="file",n.accept=".json",n.style.display="none",n.onchange=async w=>{var Q;const U=(Q=w.target.files)==null?void 0:Q[0];if(!U)return;const ee=localStorage.getItem("vocab_pro_current_user_id")||"u-vocab-master",B=await Ie(U,ee);B.type==="success"?(C("Restore successful! Reloading...","success"),setTimeout(()=>window.location.reload(),1500)):C(`Restore failed: ${B.message}`,"error"),n.parentNode&&n.parentNode.removeChild(n)},document.body.appendChild(n),n.click()},_=n=>n?n.includes("/Library/Mobile Documents/com~apple~CloudDocs")?n.replace(/\/Users\/[^\/]+\/Library\/Mobile Documents\/com~apple~CloudDocs/g,"{iCloud}"):n.startsWith("/Users/")?n.replace(/\/Users\/[^\/]+/,"{Home}"):n.startsWith("/home/")?n.replace(/\/home\/[^\/]+/,"{Home}"):n:"Not Configured";return e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-neutral-100 text-neutral-600 rounded-2xl",children:e.jsx(Le,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Server & Connection"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Manage connection state."})]})]}),e.jsxs("button",{onClick:l,className:"px-5 py-2.5 bg-neutral-900 text-white rounded-xl font-black text-[10px] flex items-center space-x-2 active:scale-95 uppercase tracking-widest hover:bg-neutral-800 transition-all",children:[e.jsx(Z,{size:14}),e.jsx("span",{children:"Save"})]})]}),e.jsxs("div",{className:"p-6 bg-neutral-50 rounded-[2rem] border border-neutral-100 space-y-6",children:[e.jsxs("div",{className:`flex items-center justify-between px-4 py-3 rounded-xl border ${i==="connected"?"bg-emerald-50 border-emerald-200":"bg-white border-neutral-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[i==="checking"&&e.jsx(ce,{size:18,className:"animate-spin text-neutral-400"}),i==="connected"&&e.jsx(X,{size:18,className:"text-emerald-500"}),(i==="error"||i==="disconnected")&&e.jsx(de,{size:18,className:"text-red-500"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest",children:"Status"}),e.jsx("span",{className:`text-sm font-bold ${i==="connected"?"text-emerald-700":"text-red-600"}`,children:i==="checking"?"Checking...":i==="connected"?"Active":"Disconnected"})]})]}),i==="connected"?e.jsx("button",{onClick:()=>g(!m),className:"flex items-center gap-2 px-3 py-1.5 bg-white border border-neutral-200 rounded-lg text-[10px] font-black uppercase text-neutral-500 hover:text-indigo-600 hover:border-indigo-200 transition-colors",children:m?"Hide Config":"Configure"}):e.jsxs("button",{onClick:$,className:"flex items-center gap-2 px-3 py-1.5 bg-neutral-900 text-white rounded-lg text-[10px] font-black uppercase hover:bg-neutral-700 transition-colors",children:[e.jsx(pt,{size:12})," Try Connect"]})]}),(i!=="connected"||m)&&e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-top-2 pt-2 border-t border-neutral-200/50",children:[e.jsxs("div",{className:"flex items-center justify-between px-1",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest flex items-center gap-1",children:[e.jsx(gt,{size:10})," Host Details"]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("label",{className:"text-[10px] font-bold text-neutral-500 cursor-pointer flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:t.server.useCustomUrl,onChange:G,className:"accent-indigo-600 w-3 h-3"}),"Custom URL"]})})]}),t.server.useCustomUrl?e.jsx("input",{type:"text",value:t.server.customUrl,onChange:n=>D({customUrl:n.target.value}),placeholder:"https://myserver.local:3000",className:"w-full px-4 py-2.5 bg-white border border-neutral-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none"}):e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"col-span-2 relative",children:[e.jsx("select",{value:t.server.host,onChange:n=>D({host:n.target.value}),className:"w-full h-full appearance-none bg-white border border-neutral-200 rounded-xl px-4 py-2.5 text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none pr-10",children:sa.map(n=>e.jsx("option",{value:n,children:n},n))}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-neutral-400",children:e.jsx(me,{size:16})})]}),e.jsx("input",{type:"number",value:t.server.port,onChange:n=>D({port:parseInt(n.target.value)||3e3}),className:"w-full px-4 py-2.5 bg-white border border-neutral-200 rounded-xl text-sm font-bold focus:ring-2 focus:ring-neutral-900 outline-none"})]}),i!=="connected"&&I&&e.jsxs("div",{className:"p-4 bg-amber-50 rounded-xl border border-amber-200 flex flex-col gap-3 animate-in fade-in slide-in-from-top-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(de,{size:16,className:"text-amber-600 shrink-0 mt-0.5"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-[10px] font-bold text-amber-800",children:"HTTPS Connection Check"}),e.jsx("p",{className:"text-[10px] text-amber-700 leading-relaxed",children:'If the server is running but you see "Disconnected", the browser might be blocking the certificate. You must manually trust it once.'})]})]}),e.jsxs("button",{onClick:O,className:"self-end px-4 py-2 bg-amber-600 hover:bg-amber-700 text-white rounded-lg text-[10px] font-black uppercase tracking-widest flex items-center gap-2 transition-all shadow-sm",children:[e.jsx(bt,{size:12})," Open & Trust Certificate"]})]}),i!=="connected"&&!I&&e.jsxs("div",{className:"p-3 bg-blue-50 rounded-xl border border-blue-100 flex gap-2",children:[e.jsx(Ee,{size:14,className:"text-blue-500 shrink-0 mt-0.5"}),e.jsx("p",{className:"text-[10px] text-blue-700 font-medium leading-tight",children:"Using HTTP? Ensure your server is not enforcing HTTPS redirection."})]})]}),i==="connected"&&S.length>0&&e.jsxs("div",{className:"space-y-3 pt-4 border-t border-neutral-200/50 animate-in fade-in",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[e.jsx(ft,{size:10})," Server Data"]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-indigo-50 border border-indigo-100 rounded-xl",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-xs font-bold text-indigo-900",children:["Found ",S.length," user backups"]}),e.jsx("span",{className:"text-[10px] text-indigo-600",children:"You can restore a profile from the server."})]}),e.jsx("button",{onClick:()=>p(!0),className:"px-4 py-2 bg-white text-indigo-700 rounded-lg font-black text-[10px] uppercase shadow-sm hover:bg-indigo-100 transition-colors border border-indigo-200",children:"Browse & Restore"})]})]}),i==="connected"&&e.jsxs("div",{className:"space-y-5 pt-4 border-t border-neutral-200/50 animate-in fade-in",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[e.jsx(ke,{size:10})," Storage Path"]}),d?e.jsxs("div",{className:"flex gap-2 animate-in fade-in zoom-in-95",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:f,onChange:n=>k(n.target.value),className:"w-full pl-4 pr-10 py-2.5 bg-white border-2 border-indigo-500 rounded-xl text-xs font-bold text-neutral-900 focus:outline-none shadow-sm",placeholder:"Enter absolute server path...",autoFocus:!0,onKeyDown:n=>{n.key==="Enter"&&H(),n.key==="Escape"&&o(!1)}}),e.jsx("button",{onClick:()=>o(!1),className:"absolute right-2 top-1/2 -translate-y-1/2 p-1 text-neutral-400 hover:text-neutral-700",children:e.jsx(jt,{size:14})})]}),e.jsxs("button",{onClick:H,disabled:h==="updating",className:`px-4 rounded-xl font-black text-[10px] uppercase transition-all shadow-md active:scale-95 flex items-center gap-1.5 ${h==="success"?"bg-green-500 text-white":"bg-neutral-900 text-white hover:bg-neutral-800"}`,children:[h==="updating"?e.jsx(ce,{size:14,className:"animate-spin"}):e.jsx(Z,{size:14}),e.jsx("span",{children:"Save"})]})]}):e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-neutral-200 rounded-xl group",children:[e.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[e.jsx("div",{className:"p-2 bg-neutral-100 rounded-lg text-neutral-500",children:e.jsx(ke,{size:16})}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-wider",children:"Active Directory"}),e.jsx("span",{className:"text-xs font-bold text-neutral-800 truncate",title:y||t.server.backupPath,children:_(y||t.server.backupPath)})]})]}),e.jsx("button",{onClick:()=>o(!0),className:"p-2 text-neutral-400 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Change Path",children:e.jsx(Jt,{size:16})})]}),d&&e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:K,className:"text-[10px] font-bold text-sky-600 hover:underline hover:text-sky-700 transition-colors",children:"Use iCloud Documents Path"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1 flex items-center gap-1",children:[e.jsx(vt,{size:10})," Backup Debounce Time"]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border border-neutral-200 rounded-xl",children:[e.jsx("input",{type:"range",min:"5",max:"300",step:"5",value:t.sync.autoBackupInterval,onChange:n=>r("sync","autoBackupInterval",parseInt(n.target.value)),className:"flex-1 h-2 bg-neutral-100 rounded-lg appearance-none cursor-pointer accent-neutral-900"}),e.jsxs("div",{className:"w-16 text-center font-black text-sm text-neutral-900",children:[t.sync.autoBackupInterval,"s"]})]})]})]})]}),e.jsx(Nt,{isOpen:E,onClose:()=>p(!1),backups:S,onRestore:Y,onNewUser:()=>p(!1),onLocalRestore:q,isRestoring:N})]})},le=[{id:"PROFILE",label:"Profile",icon:xe},{id:"INTERFACE",label:"Interface Defaults",icon:Wt},{id:"SERVER",label:"Server & Connection",icon:Le},{id:"AUDIO_COACH",label:"Audio Coach",icon:Ae},{id:"LEARNING",label:"Learning",icon:ze},{id:"DATA",label:"Data Management",icon:kt},{id:"DANGER",label:"Danger Zone",icon:he,color:"text-red-500"}],ra=t=>{const{currentView:r,isDropdownOpen:l,notification:i,importStatus:x,setCurrentView:h,setIsDropdownOpen:a,mobileNavRef:m,children:g}=t,y=le.find(d=>d.id===r),b=()=>{var d,o,f,k,S;switch(r){case"PROFILE":return e.jsx(qt,{profileData:t.profileData,onProfileChange:t.onProfileChange,onAvatarChange:t.onAvatarChange,onSaveProfile:t.onSaveProfile});case"SERVER":return e.jsx(na,{config:t.config,onConfigChange:t.onConfigChange,onSaveSettings:t.onSaveSettings});case"AUDIO_COACH":return e.jsx(Qt,{config:t.config,onConfigChange:t.onConfigChange,onSaveSettings:t.onSaveSettings});case"DATA":return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Zt,{jsonInputRef:t.jsonInputRef,dataScope:t.dataScope,onDataScopeChange:t.onDataScopeChange,onJSONImport:t.onJSONImport,onJSONExport:t.onJSONExport,isNormalizing:t.isNormalizing,onOpenNormalizeModal:t.onOpenNormalizeModal,junkTags:t.junkTags,onJunkTagsChange:t.onJunkTagsChange,normalizeOptions:t.normalizeOptions,onNormalizeOptionsChange:t.onNormalizeOptionsChange}),e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-neutral-200 shadow-sm animate-in fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-indigo-50 text-indigo-600 rounded-xl",children:e.jsx(Vt,{size:20})}),e.jsx("h3",{className:"font-black text-lg text-neutral-900",children:"System Diagnostics"})]}),e.jsx("button",{onClick:t.onRunDiagnostics,className:"px-4 py-2 bg-neutral-900 text-white rounded-xl text-xs font-bold uppercase tracking-widest hover:bg-neutral-800 transition-all active:scale-95",children:"Run Check"})]}),t.dbStats?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest px-1",children:"Database Stores"}),e.jsx("div",{className:"bg-neutral-50 rounded-xl p-3 border border-neutral-100 text-xs font-mono space-y-1",children:Object.entries(t.dbStats).map(([z,E])=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[z,":"]}),e.jsx("span",{className:E===-1?"text-red-500 font-bold":"text-neutral-900 font-bold",children:E===-1?"ERROR":E})]},z))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-[10px] font-black uppercase text-neutral-400 tracking-widest px-1",children:"Safety Lock Status"}),e.jsxs("div",{className:`p-4 rounded-xl border ${(d=t.lsHealth)!=null&&d.hasBackup?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[(o=t.lsHealth)!=null&&o.hasBackup?e.jsx(X,{size:16,className:"text-green-600"}):e.jsx(he,{size:16,className:"text-red-600"}),e.jsx("span",{className:`font-bold text-sm ${(f=t.lsHealth)!=null&&f.hasBackup?"text-green-900":"text-red-900"}`,children:(k=t.lsHealth)!=null&&k.hasBackup?"Emergency Backup Active":"No Emergency Backup Found"})]}),((S=t.lsHealth)==null?void 0:S.hasBackup)&&e.jsxs("div",{className:"text-xs text-green-700 space-y-1",children:[e.jsxs("p",{children:["Size: ",(t.lsHealth.backupSize/1024).toFixed(1)," KB"]}),e.jsxs("p",{children:["Last Sync: ",t.lsHealth.backupTimestamp]})]})]})]})]}):e.jsx("p",{className:"text-center text-neutral-400 text-xs italic py-4",children:'Click "Run Check" to inspect internal database state.'})]})]});case"LEARNING":return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsx(ta,{goalConfig:t.goalConfig,onGoalConfigChange:t.onGoalConfigChange,onSaveSettings:t.onSaveSettings}),e.jsx(ea,{srsConfig:t.config.srs,onSrsConfigChange:t.onSrsConfigChange,onResetSrsConfig:t.onResetSrsConfig,onSaveSettings:t.onSaveSettings})]});case"DANGER":return e.jsx(aa,{onOpenClearProgressModal:t.onOpenClearProgressModal,onOpenNukeModal:t.onOpenNukeModal,isAdmin:t.isAdmin,onToggleAdmin:t.onToggleAdmin});case"INTERFACE":return null;default:return null}};return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-10 pb-20",children:[e.jsxs("header",{children:[e.jsx("h2",{className:"text-3xl font-black text-neutral-900 tracking-tight",children:"Settings"}),e.jsx("p",{className:"text-neutral-500 mt-2 font-medium",children:"Manage your data and personalize your learning experience."})]}),i&&e.jsxs("div",{className:"fixed top-10 left-1/2 -translate-x-1/2 z-[300] bg-neutral-900 text-white px-6 py-3 rounded-2xl shadow-2xl border border-neutral-800 animate-in slide-in-from-top-4 flex items-center space-x-2",children:[e.jsx(X,{size:18,className:"text-green-400"}),e.jsx("span",{className:"text-sm font-bold",children:i})]}),x&&e.jsx("div",{className:`p-6 rounded-[2rem] border-2 animate-in slide-in-from-top-4 ${x.type==="success"?"bg-green-50 border-green-100 text-green-700":"bg-red-50 border-red-100 text-red-700"}`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[x.type==="success"?e.jsx(X,{size:24}):e.jsx(de,{size:24}),e.jsxs("div",{children:[e.jsx("div",{className:"font-black text-lg",children:x.message}),x.detail&&e.jsx("div",{className:"text-sm opacity-80 mt-1 font-medium",children:x.detail})]})]})}),e.jsxs("div",{className:"relative lg:hidden mb-6",ref:m,children:[e.jsxs("button",{onClick:()=>a(!l),className:"w-full flex items-center justify-between text-left px-4 py-3 bg-white border border-neutral-200 rounded-xl text-sm font-bold text-neutral-900 hover:bg-neutral-50 transition-colors shadow-sm",children:[y&&e.jsxs("span",{className:"flex items-center space-x-3",children:[e.jsx(y.icon,{size:18,className:y.color}),e.jsx("span",{children:y.label})]}),e.jsx(me,{size:18,className:`text-neutral-400 transition-transform ${l?"rotate-180":""}`})]}),l&&e.jsx("div",{className:"absolute top-full mt-2 w-full bg-white rounded-2xl shadow-lg border border-neutral-100 z-20 p-2 animate-in fade-in duration-150",children:le.map(d=>e.jsxs("button",{onClick:()=>{h(d.id),a(!1)},className:`w-full text-left flex items-center space-x-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors ${r===d.id?"bg-neutral-900 text-white":`${d.color||"text-neutral-700"} hover:bg-neutral-50`}`,children:[e.jsx(d.icon,{size:16}),e.jsx("span",{children:d.label})]},d.id))})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-12",children:[e.jsx("aside",{className:"hidden lg:block lg:w-1/4",children:e.jsx("nav",{className:"space-y-1.5",children:le.map(d=>e.jsxs("button",{onClick:()=>h(d.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-xl font-bold text-sm transition-colors ${r===d.id?"bg-neutral-100 text-neutral-900":`${d.color||"text-neutral-500"} hover:bg-neutral-50 hover:text-neutral-900`}`,children:[e.jsx(d.icon,{size:18}),e.jsx("span",{children:d.label})]},d.id))})}),e.jsx("main",{className:"flex-1 lg:w-3/4",children:e.jsxs("div",{className:"animate-in fade-in duration-300",children:[b(),g]},r)})]})]})},P=({checked:t,onChange:r,label:l,subLabel:i,icon:x})=>e.jsxs("label",{onClick:h=>{h.preventDefault(),r(!t)},className:"flex items-center justify-between px-4 py-3 cursor-pointer group hover:bg-neutral-50 rounded-xl transition-all border border-transparent hover:border-neutral-100",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[x&&e.jsx(x,{size:14,className:t?"text-neutral-900":"text-neutral-400"}),e.jsx("span",{className:"text-xs font-bold text-neutral-700 group-hover:text-neutral-900",children:l})]}),i&&e.jsx("span",{className:"text-[10px] text-neutral-400 font-medium",children:i})]}),e.jsx("div",{className:`w-9 h-5 rounded-full transition-all flex items-center p-1 ${t?"bg-neutral-900":"bg-neutral-200"}`,children:e.jsx("div",{className:`w-3.5 h-3.5 bg-white rounded-full shadow-sm transition-transform ${t?"translate-x-4":"translate-x-0"}`})})]}),la=()=>{const[t,r]=c.useState(()=>{try{const a=localStorage.getItem("ielts_pro_library_view_settings");return a?{...re,...JSON.parse(a)}:re}catch{return re}}),[l,i]=c.useState(()=>{const a={showHidden:!1,highlightFailed:!0,isLearnView:!0};try{const m=localStorage.getItem("ielts_pro_word_view_settings");return m?{...a,...JSON.parse(m)}:a}catch{return a}}),x=(a,m)=>{const g={...t,[a]:m};r(g),localStorage.setItem("ielts_pro_library_view_settings",JSON.stringify(g))},h=(a,m)=>{const g={...l,[a]:m};i(g),localStorage.setItem("ielts_pro_word_view_settings",JSON.stringify(g))};return e.jsxs("section",{className:"bg-white p-8 rounded-[2.5rem] border border-neutral-200 shadow-sm flex flex-col space-y-8 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-teal-50 text-teal-600 rounded-2xl",children:e.jsx(ve,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-neutral-900",children:"Interface Defaults"}),e.jsx("p",{className:"text-xs text-neutral-400",children:"Customize what you see across the app library and cards."})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:[e.jsx($t,{size:12})," Word Library Columns"]}),e.jsxs("div",{className:"bg-white border border-neutral-200 rounded-2xl p-1 grid grid-cols-1 md:grid-cols-2 gap-x-4",children:[e.jsx(P,{checked:t.showMeaning,onChange:a=>x("showMeaning",a),label:"Definition / Meaning"}),e.jsx(P,{checked:t.blurMeaning,onChange:a=>x("blurMeaning",a),label:"Blur Definition (Spoiler)",subLabel:"Hide meaning until hovered"}),e.jsx(P,{checked:t.showIPA,onChange:a=>x("showIPA",a),label:"IPA Phonetic"}),e.jsx(P,{checked:t.showProgress,onChange:a=>x("showProgress",a),label:"Progress Badge"}),e.jsx(P,{checked:t.showDue,onChange:a=>x("showDue",a),label:"Due Date"}),e.jsx(P,{checked:t.showAiIcon,onChange:a=>x("showAiIcon",a),label:"AI Refined Indicator"}),e.jsx(P,{checked:t.showComplexity,onChange:a=>x("showComplexity",a),label:"Complexity Column"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[10px] font-black text-neutral-400 uppercase tracking-widest px-1",children:[e.jsx(ve,{size:12})," Word Detail View"]}),e.jsxs("div",{className:"bg-white border border-neutral-200 rounded-2xl p-1 grid grid-cols-1 md:grid-cols-2 gap-x-4",children:[e.jsx(P,{checked:l.isLearnView,onChange:a=>h("isLearnView",a),label:"Learn View by Default",subLabel:"Hides extra info like examples, tags"}),e.jsx(P,{checked:l.highlightFailed,onChange:a=>h("highlightFailed",a),label:"Highlight Failed Tests",subLabel:"Red highlight for failed drill items"}),e.jsx(P,{checked:l.showHidden,onChange:a=>h("showHidden",a),label:"Show Ignored Items",subLabel:"Show ignored collocations/family members"})]})]})]})},ya=({user:t,onUpdateUser:r,onRefresh:l,onNuke:i,apiUsage:x})=>{var be,fe;const h=c.useRef(null),a=c.useRef(null),{showToast:m}=ue(),[g,y]=c.useState(()=>{const s=sessionStorage.getItem("vocab_pro_settings_tab");return s?(sessionStorage.removeItem("vocab_pro_settings_tab"),s):"PROFILE"});c.useEffect(()=>{const s=sessionStorage.getItem("vocab_pro_settings_tab");s&&(sessionStorage.removeItem("vocab_pro_settings_tab"),y(s))},[]);const[b,d]=c.useState(!1),[o,f]=c.useState({user:!0,vocabulary:!0,lesson:!0,reading:!0,writing:!0,speaking:!0,listening:!0,mimic:!0,wordBook:!0,calendar:!0,planning:!0}),[k,S]=c.useState(null),[z,E]=c.useState(!1),[p,N]=c.useState(!1),[A,C]=c.useState(!1),[R,I]=c.useState(null),[$,D]=c.useState(!1),[G,K]=c.useState(!1),[O,H]=c.useState({removeJunkTags:!0,removeMultiWordData:!0,cleanHeadwords:!0}),[Y,q]=c.useState(""),[_,n]=c.useState(Ne()),[w,U]=c.useState([]),[ee,B]=c.useState(!0),[Q,ia]=c.useState(!1),[Re,pe]=c.useState(null),[De,ge]=c.useState(null),[M,te]=c.useState({name:t.name,avatar:t.avatar,role:t.role||"",currentLevel:t.currentLevel||"",target:t.target||"",nativeLanguage:t.nativeLanguage||"English",lessonLanguage:((be=t.lessonPreferences)==null?void 0:be.language)||"English",lessonAudience:((fe=t.lessonPreferences)==null?void 0:fe.targetAudience)||"Adult"});c.useEffect(()=>{var s,u;te({name:t.name,avatar:t.avatar,role:t.role||"",currentLevel:t.currentLevel||"",target:t.target||"",nativeLanguage:t.nativeLanguage||"English",lessonLanguage:((s=t.lessonPreferences)==null?void 0:s.language)||"English",lessonAudience:((u=t.lessonPreferences)==null?void 0:u.targetAudience)||"Adult"})},[t]),c.useEffect(()=>{const s=localStorage.getItem("gemini_api_keys")||"";if(q(s),R){const u=setTimeout(()=>I(null),4e3);return()=>clearTimeout(u)}},[R]),c.useEffect(()=>{(async()=>{B(!0);const v=await At();U(v),B(!1)})();const u=()=>{n(Ne())};return window.addEventListener("config-updated",u),()=>{window.removeEventListener("config-updated",u)}},[]),c.useEffect(()=>{const s=u=>{a.current&&!a.current.contains(u.target)&&d(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]);const J=(s,u,v)=>{n(T=>{const V={...T};return u===null&&typeof v=="object"?V[s]=v:V[s]={...T[s],[u]:v},V})},Oe=s=>{J("interface","junkTags",s)},_e=s=>{te(u=>({...u,[s.target.name]:s.target.value}))},Me=s=>{te(u=>({...u,avatar:s}))},Ve=async()=>{const s={...t,name:M.name.trim()||t.name,role:M.role.trim(),currentLevel:M.currentLevel.trim(),target:M.target.trim(),nativeLanguage:M.nativeLanguage,avatar:M.avatar,lessonPreferences:{language:M.lessonLanguage,targetAudience:M.lessonAudience.trim(),tone:_.audioCoach.coaches[_.audioCoach.activeCoach].persona}};await r(s),I("Profile & Preferences updated successfully!")},He=()=>{localStorage.setItem("gemini_api_keys",Y.trim()),I("API Keys have been saved locally.")},Ue=()=>{localStorage.removeItem("vocab_pro_api_usage"),window.dispatchEvent(new CustomEvent("apiUsageUpdated")),I("API usage counter has been reset.")},Fe=s=>{J("srs",s.target.name,parseFloat(s.target.value))},Be=s=>{const u=s.target.type==="checkbox"?s.target.checked:s.target.value;J("ai",s.target.name,u)},Je=s=>{J("dailyGoals",s.target.name,parseInt(s.target.value,10))},We=()=>{oe(_),I("Settings saved!")},$e=()=>{n(s=>({...s,srs:It})),I("SRS settings reset to defaults.")},Ge=async s=>{var T;const u=(T=s.target.files)==null?void 0:T[0];if(!u)return;S(null);const v=await Ie(u,t.id,o);S(v),v.type==="success"&&(m("Restore successful! The app will now reload.","success",2e3),v.updatedUser&&await Lt(v.updatedUser),setTimeout(()=>{window.location.reload()},2e3)),h.current&&(h.current.value="")},Ke=async()=>{await Tt(t.id,t,o)},Ye=async()=>{C(!0);try{const u=(await ye()).map(v=>Pt(v));await we(u),I("All learning progress has been reset.")}catch(s){S({type:"error",message:"Failed to clear progress",detail:s.message})}finally{C(!1),N(!1)}},qe=async()=>{K(!0),D(!1);let s=0;const u=new Set(_.interface.junkTags.map(v=>v.toLowerCase()));try{const v=ye(),T=[];for(const Ze of v){let W=!1;const j={...Ze};if(O.removeJunkTags&&u.size>0&&j.tags){const je=j.tags.length;j.tags=j.tags.filter(et=>!u.has(et.toLowerCase())),j.tags.length!==je&&(W=!0)}O.removeMultiWordData&&(j.isIdiom||j.isPhrasalVerb||j.isCollocation||j.isStandardPhrase)&&(j.wordFamily&&(j.wordFamily=void 0,W=!0),j.collocationsArray&&j.collocationsArray.length>0&&(j.collocations=void 0,j.collocationsArray=void 0,W=!0)),O.cleanHeadwords&&j.word&&j.word.includes('"')&&(j.word=j.word.replace(/"/g,"").trim(),W=!0),W&&(j.updatedAt=Date.now(),T.push(j))}s=T.length,s>0&&await we(T);let V=`Normalized ${s} item(s).`;s===0&&(V="No items needed normalization based on selected options."),m(V,"success")}catch(v){m("Failed to normalize data.","error"),console.error("Normalization Error:",v)}finally{K(!1)}},Qe=async()=>{pe(null),ge(null);const s=await zt();pe(s);const u=Et();ge(u),m("Diagnostic run complete.","info")},Xe=async()=>{await r({...t,isAdmin:!t.isAdmin}),I(`Developer Mode ${t.isAdmin?"Disabled":"Enabled"}`)},ae=({id:s,label:u,checked:v,onChange:T})=>e.jsxs("label",{htmlFor:s,className:"flex items-center gap-2 p-3 bg-neutral-50 rounded-lg border border-neutral-200 cursor-pointer",children:[e.jsx("input",{id:s,type:"checkbox",checked:v,onChange:V=>T(V.target.checked),className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx("span",{className:"text-sm font-medium",children:u})]});return e.jsxs(e.Fragment,{children:[e.jsx(ra,{currentView:g,isDropdownOpen:b,notification:R,importStatus:k,profileData:M,config:_,isVoiceLoading:ee,availableVoices:w,apiKeyInput:Y,apiUsage:x,jsonInputRef:h,dataScope:o,onDataScopeChange:f,mobileNavRef:a,setCurrentView:y,setIsDropdownOpen:d,onProfileChange:_e,onAvatarChange:Me,onSaveProfile:Ve,onConfigChange:J,onAiConfigChange:Be,onApiKeyInputChange:s=>q(s.target.value),onSaveApiKeys:He,onResetUsage:Ue,onSaveSettings:We,onJSONImport:Ge,onJSONExport:Ke,onSrsConfigChange:Fe,onResetSrsConfig:$e,onOpenClearProgressModal:()=>N(!0),onOpenNukeModal:()=>E(!0),isNormalizing:G,onOpenNormalizeModal:()=>D(!0),isApplyingAccent:Q,onApplyAccent:()=>{},isAdmin:!!t.isAdmin,onToggleAdmin:Xe,junkTags:_.interface.junkTags,onJunkTagsChange:Oe,normalizeOptions:O,onNormalizeOptionsChange:H,goalConfig:_.dailyGoals,onGoalConfigChange:Je,dbStats:Re,lsHealth:De,onRunDiagnostics:Qe,children:g==="INTERFACE"&&e.jsx(la,{})}),e.jsx(ne,{isOpen:z,title:"Delete all data?",message:e.jsxs(e.Fragment,{children:["This will permanently delete ",e.jsx("strong",{className:"text-red-600",children:"ALL"})," vocabulary, progress, and profiles. This action cannot be undone."]}),confirmText:"YES, DELETE EVERYTHING",isProcessing:!1,onConfirm:()=>{i(),E(!1)},onClose:()=>E(!1),confirmButtonClass:"bg-red-600 text-white hover:bg-red-700 shadow-red-200",icon:e.jsx(Ct,{size:40,className:"text-red-500"})}),e.jsx(ne,{isOpen:p,title:"Clear All Progress?",message:"This will reset the review schedule for ALL words in your library. Your words and their content will NOT be deleted. This action cannot be undone.",confirmText:"Yes, Clear Progress",isProcessing:A,onConfirm:Ye,onClose:()=>N(!1),icon:e.jsx(St,{size:40,className:"text-orange-500"}),confirmButtonClass:"bg-orange-50 text-white hover:bg-orange-600 shadow-orange-200"}),e.jsx(ne,{isOpen:$,title:"Normalize Data",message:e.jsxs("div",{className:"space-y-4 text-left",children:[e.jsx("p",{children:"Select normalization actions to perform. This process will update your entire library and cannot be undone."}),e.jsx(ae,{id:"norm-junk",label:"Remove junk tags from all words",checked:O.removeJunkTags,onChange:s=>H(u=>({...u,removeJunkTags:s}))}),e.jsx(ae,{id:"norm-multi",label:"Clean multi-word items (phrases, idioms)",checked:O.removeMultiWordData,onChange:s=>H(u=>({...u,removeMultiWordData:s}))}),e.jsx(ae,{id:"norm-quotes",label:"Clean headwords (remove quotes)",checked:O.cleanHeadwords,onChange:s=>H(u=>({...u,cleanHeadwords:s}))})]}),confirmText:"Yes, Normalize",isProcessing:G,onConfirm:qe,onClose:()=>D(!1),icon:e.jsx(Pe,{size:40,className:"text-orange-500"}),confirmButtonClass:"bg-orange-50 text-white hover:bg-orange-600 shadow-orange-200"})]})};export{ya as SettingsView};
